import{P as L,j as s,B as se,N as pt,a as U1,T as Yt,C as _e,b as H,A as ke,S as xt,I as $1,F as I,M as le,R as oe,c as U,O as P2,d as R2,D as kt,e as Ne,L as Aa,f as F4,g as Vt,h as Ux,i as Zh}from"./bootstrap-36CUpx7I.js";import{r as v,R as J,u as za,b as Ge,L as ad,O as M4,c as B4,d as $x,N as z4,e as Yu,f as gr,g as U4,h as $4,i as W4}from"./router-C6Ic_n8-.js";import{a as H4,g as fi,r as Wx}from"./vendor-D3F3s8fL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var nd={},W1;function V4(){if(W1)return nd;W1=1;var e=H4();return nd.createRoot=e.createRoot,nd.hydrateRoot=e.hydrateRoot,nd}var G4=V4(),q4=["color","size","title","className"];function Qh(){return Qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Qh.apply(null,arguments)}function K4(e,t){if(e==null)return{};var r,a,n=Y4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Y4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var L2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=K4(e,q4);return J.createElement("svg",Qh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-airplane",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"}))});L2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var X4=["color","size","title","className"];function e0(){return e0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},e0.apply(null,arguments)}function J4(e,t){if(e==null)return{};var r,a,n=Z4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Z4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var F2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=J4(e,X4);return J.createElement("svg",e0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-archive",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}))});F2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Q4=["color","size","title","className"];function t0(){return t0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},t0.apply(null,arguments)}function ek(e,t){if(e==null)return{};var r,a,n=tk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Yd=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=ek(e,Q4);return J.createElement("svg",t0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-clockwise",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),J.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"}))});Yd.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var rk=["color","size","title","className"];function r0(){return r0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},r0.apply(null,arguments)}function sk(e,t){if(e==null)return{};var r,a,n=ak(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ak(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var s0=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=sk(e,rk);return J.createElement("svg",r0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-down",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"}))});s0.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var nk=["color","size","title","className"];function a0(){return a0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},a0.apply(null,arguments)}function ik(e,t){if(e==null)return{};var r,a,n=lk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var At=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=ik(e,nk);return J.createElement("svg",a0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-left",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"}))});At.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var ok=["color","size","title","className"];function n0(){return n0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},n0.apply(null,arguments)}function ck(e,t){if(e==null)return{};var r,a,n=dk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var un=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=ck(e,ok);return J.createElement("svg",n0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-right",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"}))});un.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var uk=["color","size","title","className"];function i0(){return i0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},i0.apply(null,arguments)}function mk(e,t){if(e==null)return{};var r,a,n=fk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var M2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=mk(e,uk);return J.createElement("svg",i0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-award",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702z"}),J.createElement("path",{d:"M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"}))});M2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var hk=["color","size","title","className"];function l0(){return l0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},l0.apply(null,arguments)}function pk(e,t){if(e==null)return{};var r,a,n=xk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Bd=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=pk(e,hk);return J.createElement("svg",l0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-bar-chart",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M4 11H2v3h2zm5-4H7v7h2zm5-5v12h-2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1z"}))});Bd.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var gk=["color","size","title","className"];function o0(){return o0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},o0.apply(null,arguments)}function vk(e,t){if(e==null)return{};var r,a,n=bk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var It=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=vk(e,gk);return J.createElement("svg",o0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-book",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"}))});It.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var yk=["color","size","title","className"];function c0(){return c0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},c0.apply(null,arguments)}function jk(e,t){if(e==null)return{};var r,a,n=wk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var d0=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=jk(e,yk);return J.createElement("svg",c0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-box-arrow-right",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),J.createElement("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"}))});d0.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Nk=["color","size","title","className"];function u0(){return u0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},u0.apply(null,arguments)}function Sk(e,t){if(e==null)return{};var r,a,n=Ek(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ek(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ls=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=Sk(e,Nk);return J.createElement("svg",u0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-building",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"}),J.createElement("path",{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"}))});Ls.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Tk=["color","size","title","className"];function m0(){return m0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},m0.apply(null,arguments)}function Ak(e,t){if(e==null)return{};var r,a,n=Ck(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ck(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ra=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=Ak(e,Tk);return J.createElement("svg",m0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-calendar-event",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),J.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});Ra.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var _k=["color","size","title","className"];function f0(){return f0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},f0.apply(null,arguments)}function kk(e,t){if(e==null)return{};var r,a,n=Dk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Dk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var xr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=kk(e,_k);return J.createElement("svg",f0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-calendar",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});xr.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Ik=["color","size","title","className"];function h0(){return h0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},h0.apply(null,arguments)}function Ok(e,t){if(e==null)return{};var r,a,n=Pk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Pk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var B2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=Ok(e,Ik);return J.createElement("svg",h0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chat-dots",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}),J.createElement("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"}))});B2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Rk=["color","size","title","className"];function p0(){return p0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},p0.apply(null,arguments)}function Lk(e,t){if(e==null)return{};var r,a,n=Fk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Fk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var z2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=Lk(e,Rk);return J.createElement("svg",p0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-circle-fill",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"}))});z2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Mk=["color","size","title","className"];function x0(){return x0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},x0.apply(null,arguments)}function Bk(e,t){if(e==null)return{};var r,a,n=zk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Je=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=Bk(e,Mk);return J.createElement("svg",x0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-circle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"}))});Je.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Uk=["color","size","title","className"];function g0(){return g0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},g0.apply(null,arguments)}function $k(e,t){if(e==null)return{};var r,a,n=Wk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Wk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var U2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=$k(e,Uk);return J.createElement("svg",g0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-square",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),J.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});U2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Hk=["color","size","title","className"];function v0(){return v0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},v0.apply(null,arguments)}function Vk(e,t){if(e==null)return{};var r,a,n=Gk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Gk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var $2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=Vk(e,Hk);return J.createElement("svg",v0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});$2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var qk=["color","size","title","className"];function b0(){return b0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},b0.apply(null,arguments)}function Kk(e,t){if(e==null)return{};var r,a,n=Yk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Yk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ni=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=Kk(e,qk);return J.createElement("svg",b0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-down",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"}))});ni.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Xk=["color","size","title","className"];function y0(){return y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},y0.apply(null,arguments)}function Jk(e,t){if(e==null)return{};var r,a,n=Zk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Zk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Xu=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=Jk(e,Xk);return J.createElement("svg",y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-right",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"}))});Xu.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Qk=["color","size","title","className"];function j0(){return j0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},j0.apply(null,arguments)}function e3(e,t){if(e==null)return{};var r,a,n=t3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function t3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var W2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=e3(e,Qk);return J.createElement("svg",j0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-up",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"}))});W2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var r3=["color","size","title","className"];function w0(){return w0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},w0.apply(null,arguments)}function s3(e,t){if(e==null)return{};var r,a,n=a3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function a3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ht=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=s3(e,r3);return J.createElement("svg",w0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clipboard-check",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),J.createElement("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"}),J.createElement("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"}))});Ht.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var n3=["color","size","title","className"];function N0(){return N0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},N0.apply(null,arguments)}function i3(e,t){if(e==null)return{};var r,a,n=l3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var H2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=i3(e,n3);return J.createElement("svg",N0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clock-history",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"}),J.createElement("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"}),J.createElement("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"}))});H2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var o3=["color","size","title","className"];function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},S0.apply(null,arguments)}function c3(e,t){if(e==null)return{};var r,a,n=d3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function d3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Qe=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=c3(e,o3);return J.createElement("svg",S0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clock",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"}),J.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"}))});Qe.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var u3=["color","size","title","className"];function E0(){return E0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},E0.apply(null,arguments)}function m3(e,t){if(e==null)return{};var r,a,n=f3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function f3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var V2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=m3(e,u3);return J.createElement("svg",E0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-collection",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M2.5 3.5a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1zm2-2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1zM0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6zm1.5.5A.5.5 0 0 1 1 13V6a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5z"}))});V2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var h3=["color","size","title","className"];function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},T0.apply(null,arguments)}function p3(e,t){if(e==null)return{};var r,a,n=x3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function x3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ln=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=p3(e,h3);return J.createElement("svg",T0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-download",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),J.createElement("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"}))});Ln.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var g3=["color","size","title","className"];function A0(){return A0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},A0.apply(null,arguments)}function v3(e,t){if(e==null)return{};var r,a,n=b3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function b3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Gi=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=v3(e,g3);return J.createElement("svg",A0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-envelope",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"}))});Gi.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var y3=["color","size","title","className"];function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},C0.apply(null,arguments)}function j3(e,t){if(e==null)return{};var r,a,n=w3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function w3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var G2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=j3(e,y3);return J.createElement("svg",C0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-exclamation-circle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});G2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var N3=["color","size","title","className"];function _0(){return _0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},_0.apply(null,arguments)}function S3(e,t){if(e==null)return{};var r,a,n=E3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function E3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Er=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=S3(e,N3);return J.createElement("svg",_0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-exclamation-triangle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),J.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});Er.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var T3=["color","size","title","className"];function k0(){return k0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},k0.apply(null,arguments)}function A3(e,t){if(e==null)return{};var r,a,n=C3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function C3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ko=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=A3(e,T3);return J.createElement("svg",k0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-eye-slash",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"}),J.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"}),J.createElement("path",{d:"M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"}))});Ko.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var _3=["color","size","title","className"];function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},D0.apply(null,arguments)}function k3(e,t){if(e==null)return{};var r,a,n=D3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function D3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var St=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=k3(e,_3);return J.createElement("svg",D0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-eye",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),J.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"}))});St.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var I3=["color","size","title","className"];function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},I0.apply(null,arguments)}function O3(e,t){if(e==null)return{};var r,a,n=P3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function P3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Rl=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=O3(e,I3);return J.createElement("svg",I0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-excel",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"}),J.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}))});Rl.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var R3=["color","size","title","className"];function O0(){return O0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},O0.apply(null,arguments)}function L3(e,t){if(e==null)return{};var r,a,n=F3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function F3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Nc=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=L3(e,R3);return J.createElement("svg",O0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-pdf",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),J.createElement("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"}))});Nc.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var M3=["color","size","title","className"];function P0(){return P0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},P0.apply(null,arguments)}function B3(e,t){if(e==null)return{};var r,a,n=z3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var q2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=B3(e,M3);return J.createElement("svg",P0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-plus",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 6.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V11a.5.5 0 0 1-1 0V9.5H6a.5.5 0 0 1 0-1h1.5V7a.5.5 0 0 1 .5-.5"}),J.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});q2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var U3=["color","size","title","className"];function R0(){return R0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},R0.apply(null,arguments)}function $3(e,t){if(e==null)return{};var r,a,n=W3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function W3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ju=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=$3(e,U3);return J.createElement("svg",R0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-text",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"}),J.createElement("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"}))});Ju.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var H3=["color","size","title","className"];function L0(){return L0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},L0.apply(null,arguments)}function V3(e,t){if(e==null)return{};var r,a,n=G3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function G3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var qi=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=V3(e,H3);return J.createElement("svg",L0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});qi.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var q3=["color","size","title","className"];function F0(){return F0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},F0.apply(null,arguments)}function K3(e,t){if(e==null)return{};var r,a,n=Y3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Y3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var K2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=K3(e,q3);return J.createElement("svg",F0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-text-fill",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"}))});K2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var X3=["color","size","title","className"];function M0(){return M0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},M0.apply(null,arguments)}function J3(e,t){if(e==null)return{};var r,a,n=Z3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Z3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var vt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=J3(e,X3);return J.createElement("svg",M0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-text",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),J.createElement("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"}))});vt.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var Q3=["color","size","title","className"];function B0(){return B0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},B0.apply(null,arguments)}function eD(e,t){if(e==null)return{};var r,a,n=tD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ol=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=eD(e,Q3);return J.createElement("svg",B0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-funnel",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"}))});ol.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var rD=["color","size","title","className"];function z0(){return z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},z0.apply(null,arguments)}function sD(e,t){if(e==null)return{};var r,a,n=aD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Y2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=sD(e,rD);return J.createElement("svg",z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-gear",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),J.createElement("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"}))});Y2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var nD=["color","size","title","className"];function U0(){return U0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},U0.apply(null,arguments)}function iD(e,t){if(e==null)return{};var r,a,n=lD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ll=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=iD(e,nD);return J.createElement("svg",U0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-geo-alt",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"}),J.createElement("path",{d:"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});Ll.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var oD=["color","size","title","className"];function $0(){return $0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},$0.apply(null,arguments)}function cD(e,t){if(e==null)return{};var r,a,n=dD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var X2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=cD(e,oD);return J.createElement("svg",$0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-house",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"}))});X2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var uD=["color","size","title","className"];function W0(){return W0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},W0.apply(null,arguments)}function mD(e,t){if(e==null)return{};var r,a,n=fD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var J2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=mD(e,uD);return J.createElement("svg",W0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-info-circle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});J2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var hD=["color","size","title","className"];function H0(){return H0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},H0.apply(null,arguments)}function pD(e,t){if(e==null)return{};var r,a,n=xD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var zd=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=pD(e,hD);return J.createElement("svg",H0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-journal-text",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}),J.createElement("path",{d:"M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2"}),J.createElement("path",{d:"M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1z"}))});zd.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var gD=["color","size","title","className"];function V0(){return V0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},V0.apply(null,arguments)}function vD(e,t){if(e==null)return{};var r,a,n=bD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Yo=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=vD(e,gD);return J.createElement("svg",V0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-key",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),J.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});Yo.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var yD=["color","size","title","className"];function G0(){return G0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},G0.apply(null,arguments)}function jD(e,t){if(e==null)return{};var r,a,n=wD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Z2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=jD(e,yD);return J.createElement("svg",G0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list-check",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3.854 2.146a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 3.293l1.146-1.147a.5.5 0 0 1 .708 0m0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 7.293l1.146-1.147a.5.5 0 0 1 .708 0m0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0"}))});Z2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var ND=["color","size","title","className"];function q0(){return q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},q0.apply(null,arguments)}function SD(e,t){if(e==null)return{};var r,a,n=ED(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ED(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Q2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=SD(e,ND);return J.createElement("svg",q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list-ul",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});Q2.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var TD=["color","size","title","className"];function K0(){return K0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},K0.apply(null,arguments)}function AD(e,t){if(e==null)return{};var r,a,n=CD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function CD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Hx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=AD(e,TD);return J.createElement("svg",K0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"}))});Hx.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var _D=["color","size","title","className"];function Y0(){return Y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Y0.apply(null,arguments)}function kD(e,t){if(e==null)return{};var r,a,n=DD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function DD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Do=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=kD(e,_D);return J.createElement("svg",Y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-passport",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 5a3 3 0 1 0 0 6 3 3 0 0 0 0-6M6 8a2 2 0 1 1 4 0 2 2 0 0 1-4 0m-.5 4a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1z"}),J.createElement("path",{d:"M3.232 1.776A1.5 1.5 0 0 0 2 3.252v10.95c0 .445.191.838.49 1.11.367.422.908.688 1.51.688h8a2 2 0 0 0 2-2V4a2 2 0 0 0-1-1.732v-.47A1.5 1.5 0 0 0 11.232.321l-8 1.454ZM4 3h8a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1"}))});Do.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var ID=["color","size","title","className"];function X0(){return X0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},X0.apply(null,arguments)}function OD(e,t){if(e==null)return{};var r,a,n=PD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function PD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var _n=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=OD(e,ID);return J.createElement("svg",X0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pen",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))});_n.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var RD=["color","size","title","className"];function J0(){return J0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},J0.apply(null,arguments)}function LD(e,t){if(e==null)return{};var r,a,n=FD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var eS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=LD(e,RD);return J.createElement("svg",J0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pencil-square",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),J.createElement("path",{fillRule:"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"}))});eS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var MD=["color","size","title","className"];function Z0(){return Z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Z0.apply(null,arguments)}function BD(e,t){if(e==null)return{};var r,a,n=zD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ts=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=BD(e,MD);return J.createElement("svg",Z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pencil",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"}))});ts.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var UD=["color","size","title","className"];function Q0(){return Q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Q0.apply(null,arguments)}function $D(e,t){if(e==null)return{};var r,a,n=WD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var $r=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=$D(e,UD);return J.createElement("svg",Q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-people",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"}))});$r.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var HD=["color","size","title","className"];function ep(){return ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ep.apply(null,arguments)}function VD(e,t){if(e==null)return{};var r,a,n=GD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=VD(e,HD);return J.createElement("svg",ep({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-check-fill",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{fillRule:"evenodd",d:"M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"}),J.createElement("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});tS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var qD=["color","size","title","className"];function tp(){return tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},tp.apply(null,arguments)}function KD(e,t){if(e==null)return{};var r,a,n=YD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ia=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=KD(e,qD);return J.createElement("svg",tp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-check",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),J.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});Ia.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var XD=["color","size","title","className"];function rp(){return rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},rp.apply(null,arguments)}function JD(e,t){if(e==null)return{};var r,a,n=ZD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ZD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var El=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=JD(e,XD);return J.createElement("svg",rp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-circle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),J.createElement("path",{fillRule:"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"}))});El.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var QD=["color","size","title","className"];function sp(){return sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},sp.apply(null,arguments)}function eI(e,t){if(e==null)return{};var r,a,n=tI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Sc=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=eI(e,QD);return J.createElement("svg",sp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-x",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m.256 7a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}),J.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708"}))});Sc.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var rI=["color","size","title","className"];function ap(){return ap=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ap.apply(null,arguments)}function sI(e,t){if(e==null)return{};var r,a,n=aI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ft=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=sI(e,rI);return J.createElement("svg",ap({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}))});Ft.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var nI=["color","size","title","className"];function np(){return np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},np.apply(null,arguments)}function iI(e,t){if(e==null)return{};var r,a,n=lI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var rS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=iI(e,nI);return J.createElement("svg",np({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-phone",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),J.createElement("path",{d:"M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});rS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var oI=["color","size","title","className"];function ip(){return ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ip.apply(null,arguments)}function cI(e,t){if(e==null)return{};var r,a,n=dI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var sS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=cI(e,oI);return J.createElement("svg",ip({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pie-chart",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M7.5 1.018a7 7 0 0 0-4.79 11.566L7.5 7.793zm1 0V7.5h6.482A7 7 0 0 0 8.5 1.018M14.982 8.5H8.207l-4.79 4.79A7 7 0 0 0 14.982 8.5M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8"}))});sS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var uI=["color","size","title","className"];function lp(){return lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},lp.apply(null,arguments)}function mI(e,t){if(e==null)return{};var r,a,n=fI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var op=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=mI(e,uI);return J.createElement("svg",lp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-play-circle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"}))});op.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var hI=["color","size","title","className"];function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},cp.apply(null,arguments)}function pI(e,t){if(e==null)return{};var r,a,n=xI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Vx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=pI(e,hI);return J.createElement("svg",cp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-play",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"}))});Vx.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var gI=["color","size","title","className"];function dp(){return dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},dp.apply(null,arguments)}function vI(e,t){if(e==null)return{};var r,a,n=bI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var aS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=vI(e,gI);return J.createElement("svg",dp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-plus-circle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});aS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var yI=["color","size","title","className"];function up(){return up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},up.apply(null,arguments)}function jI(e,t){if(e==null)return{};var r,a,n=wI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Xr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=jI(e,yI);return J.createElement("svg",up({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-plus",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});Xr.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var NI=["color","size","title","className"];function mp(){return mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},mp.apply(null,arguments)}function SI(e,t){if(e==null)return{};var r,a,n=EI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function EI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var nS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=SI(e,NI);return J.createElement("svg",mp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-question-circle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286m1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94"}))});nS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var TI=["color","size","title","className"];function fp(){return fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},fp.apply(null,arguments)}function AI(e,t){if(e==null)return{};var r,a,n=CI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function CI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var hs=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=AI(e,TI);return J.createElement("svg",fp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-save",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z"}))});hs.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var _I=["color","size","title","className"];function hp(){return hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hp.apply(null,arguments)}function kI(e,t){if(e==null)return{};var r,a,n=DI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function DI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Gx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=kI(e,_I);return J.createElement("svg",hp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-search",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))});Gx.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var II=["color","size","title","className"];function pp(){return pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pp.apply(null,arguments)}function OI(e,t){if(e==null)return{};var r,a,n=PI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function PI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var iS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=OI(e,II);return J.createElement("svg",pp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-send",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"}))});iS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var RI=["color","size","title","className"];function xp(){return xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},xp.apply(null,arguments)}function LI(e,t){if(e==null)return{};var r,a,n=FI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var lS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=LI(e,RI);return J.createElement("svg",xp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-shield-x",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}),J.createElement("path",{d:"M6.146 5.146a.5.5 0 0 1 .708 0L8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 0 1 0-.708"}))});lS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var MI=["color","size","title","className"];function gp(){return gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gp.apply(null,arguments)}function BI(e,t){if(e==null)return{};var r,a,n=zI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var qx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=BI(e,MI);return J.createElement("svg",gp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-shield",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}))});qx.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var UI=["color","size","title","className"];function vp(){return vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},vp.apply(null,arguments)}function $I(e,t){if(e==null)return{};var r,a,n=WI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var oS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=$I(e,UI);return J.createElement("svg",vp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-square",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}))});oS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var HI=["color","size","title","className"];function bp(){return bp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},bp.apply(null,arguments)}function VI(e,t){if(e==null)return{};var r,a,n=GI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function GI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var cS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=VI(e,HI);return J.createElement("svg",bp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-star",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"}))});cS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var qI=["color","size","title","className"];function yp(){return yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},yp.apply(null,arguments)}function KI(e,t){if(e==null)return{};var r,a,n=YI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function YI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Jt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=KI(e,qI);return J.createElement("svg",yp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-three-dots-vertical",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}))});Jt.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var XI=["color","size","title","className"];function jp(){return jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jp.apply(null,arguments)}function JI(e,t){if(e==null)return{};var r,a,n=ZI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ZI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var mn=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=JI(e,XI);return J.createElement("svg",jp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-trash",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),J.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});mn.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var QI=["color","size","title","className"];function wp(){return wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},wp.apply(null,arguments)}function eO(e,t){if(e==null)return{};var r,a,n=tO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var dS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=eO(e,QI);return J.createElement("svg",wp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-trophy",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"}))});dS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var rO=["color","size","title","className"];function Np(){return Np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Np.apply(null,arguments)}function sO(e,t){if(e==null)return{};var r,a,n=aO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ts=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=sO(e,rO);return J.createElement("svg",Np({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-upload",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),J.createElement("path",{d:"M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"}))});Ts.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var nO=["color","size","title","className"];function Sp(){return Sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Sp.apply(null,arguments)}function iO(e,t){if(e==null)return{};var r,a,n=lO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var uS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=iO(e,nO);return J.createElement("svg",Sp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x-circle-fill",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"}))});uS.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var oO=["color","size","title","className"];function Ep(){return Ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ep.apply(null,arguments)}function cO(e,t){if(e==null)return{};var r,a,n=dO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var fs=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=cO(e,oO);return J.createElement("svg",Ep({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x-circle",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),J.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});fs.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};var uO=["color","size","title","className"];function Tp(){return Tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Tp.apply(null,arguments)}function mO(e,t){if(e==null)return{};var r,a,n=fO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Xe=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,l=e.title,o=l===void 0?null:l,c=e.className,u=c===void 0?"":c,d=mO(e,uO);return J.createElement("svg",Tp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x",u].filter(Boolean).join(" ")},d),o?J.createElement("title",null,o):null,J.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});Xe.propTypes={color:L.string,size:L.oneOfType([L.string,L.number]),title:L.string,className:L.string};const hO="/dsfms-template/assets/logo-light-BjNHVeeQ.png",pO="modulepreload",xO=function(e){return"/dsfms-template/"+e},H1={},gO=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){let c=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=l?.nonce||l?.getAttribute("nonce");n=c(r.map(u=>{if(u=xO(u),u in H1)return;H1[u]=!0;const d=u.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":pO,d||(f.as="script"),f.crossOrigin="",f.href=u,o&&f.setAttribute("nonce",o),document.head.appendChild(f),d)return new Promise((x,p)=>{f.addEventListener("load",x),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return n.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};function mS(e,t){return function(){return e.apply(t,arguments)}}const{toString:vO}=Object.prototype,{getPrototypeOf:Kx}=Object,{iterator:Zu,toStringTag:fS}=Symbol,Qu=(e=>t=>{const r=vO.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Qa=e=>(e=e.toLowerCase(),t=>Qu(t)===e),em=e=>t=>typeof t===e,{isArray:Ql}=Array,Fl=em("undefined");function Ec(e){return e!==null&&!Fl(e)&&e.constructor!==null&&!Fl(e.constructor)&&ea(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const hS=Qa("ArrayBuffer");function bO(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&hS(e.buffer),t}const yO=em("string"),ea=em("function"),pS=em("number"),Tc=e=>e!==null&&typeof e=="object",jO=e=>e===!0||e===!1,Ud=e=>{if(Qu(e)!=="object")return!1;const t=Kx(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(fS in e)&&!(Zu in e)},wO=e=>{if(!Tc(e)||Ec(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},NO=Qa("Date"),SO=Qa("File"),EO=Qa("Blob"),TO=Qa("FileList"),AO=e=>Tc(e)&&ea(e.pipe),CO=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ea(e.append)&&((t=Qu(e))==="formdata"||t==="object"&&ea(e.toString)&&e.toString()==="[object FormData]"))},_O=Qa("URLSearchParams"),[kO,DO,IO,OO]=["ReadableStream","Request","Response","Headers"].map(Qa),PO=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ac(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),Ql(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{if(Ec(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(a=0;a<l;a++)o=i[a],t.call(null,e[o],o,e)}}function xS(e,t){if(Ec(e))return null;t=t.toLowerCase();const r=Object.keys(e);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const ki=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,gS=e=>!Fl(e)&&e!==ki;function Ap(){const{caseless:e,skipUndefined:t}=gS(this)&&this||{},r={},a=(n,i)=>{const l=e&&xS(r,i)||i;Ud(r[l])&&Ud(n)?r[l]=Ap(r[l],n):Ud(n)?r[l]=Ap({},n):Ql(n)?r[l]=n.slice():(!t||!Fl(n))&&(r[l]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Ac(arguments[n],a);return r}const RO=(e,t,r,{allOwnKeys:a}={})=>(Ac(t,(n,i)=>{r&&ea(n)?e[i]=mS(n,r):e[i]=n},{allOwnKeys:a}),e),LO=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),FO=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},MO=(e,t,r,a)=>{let n,i,l;const o={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)l=n[i],(!a||a(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=r!==!1&&Kx(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},BO=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},zO=e=>{if(!e)return null;if(Ql(e))return e;let t=e.length;if(!pS(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},UO=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Kx(Uint8Array)),$O=(e,t)=>{const a=(e&&e[Zu]).call(e);let n;for(;(n=a.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},WO=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},HO=Qa("HTMLFormElement"),VO=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),V1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),GO=Qa("RegExp"),vS=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};Ac(r,(n,i)=>{let l;(l=t(n,i,e))!==!1&&(a[i]=l||n)}),Object.defineProperties(e,a)},qO=e=>{vS(e,(t,r)=>{if(ea(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(ea(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},KO=(e,t)=>{const r={},a=n=>{n.forEach(i=>{r[i]=!0})};return Ql(e)?a(e):a(String(e).split(t)),r},YO=()=>{},XO=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function JO(e){return!!(e&&ea(e.append)&&e[fS]==="FormData"&&e[Zu])}const ZO=e=>{const t=new Array(10),r=(a,n)=>{if(Tc(a)){if(t.indexOf(a)>=0)return;if(Ec(a))return a;if(!("toJSON"in a)){t[n]=a;const i=Ql(a)?[]:{};return Ac(a,(l,o)=>{const c=r(l,n+1);!Fl(c)&&(i[o]=c)}),t[n]=void 0,i}}return a};return r(e,0)},QO=Qa("AsyncFunction"),eP=e=>e&&(Tc(e)||ea(e))&&ea(e.then)&&ea(e.catch),bS=((e,t)=>e?setImmediate:t?((r,a)=>(ki.addEventListener("message",({source:n,data:i})=>{n===ki&&i===r&&a.length&&a.shift()()},!1),n=>{a.push(n),ki.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ea(ki.postMessage)),tP=typeof queueMicrotask<"u"?queueMicrotask.bind(ki):typeof process<"u"&&process.nextTick||bS,rP=e=>e!=null&&ea(e[Zu]),je={isArray:Ql,isArrayBuffer:hS,isBuffer:Ec,isFormData:CO,isArrayBufferView:bO,isString:yO,isNumber:pS,isBoolean:jO,isObject:Tc,isPlainObject:Ud,isEmptyObject:wO,isReadableStream:kO,isRequest:DO,isResponse:IO,isHeaders:OO,isUndefined:Fl,isDate:NO,isFile:SO,isBlob:EO,isRegExp:GO,isFunction:ea,isStream:AO,isURLSearchParams:_O,isTypedArray:UO,isFileList:TO,forEach:Ac,merge:Ap,extend:RO,trim:PO,stripBOM:LO,inherits:FO,toFlatObject:MO,kindOf:Qu,kindOfTest:Qa,endsWith:BO,toArray:zO,forEachEntry:$O,matchAll:WO,isHTMLForm:HO,hasOwnProperty:V1,hasOwnProp:V1,reduceDescriptors:vS,freezeMethods:qO,toObjectSet:KO,toCamelCase:VO,noop:YO,toFiniteNumber:XO,findKey:xS,global:ki,isContextDefined:gS,isSpecCompliantForm:JO,toJSONObject:ZO,isAsyncFn:QO,isThenable:eP,setImmediate:bS,asap:tP,isIterable:rP};function wt(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}je.inherits(wt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:je.toJSONObject(this.config),code:this.code,status:this.status}}});const yS=wt.prototype,jS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{jS[e]={value:e}});Object.defineProperties(wt,jS);Object.defineProperty(yS,"isAxiosError",{value:!0});wt.from=(e,t,r,a,n,i)=>{const l=Object.create(yS);je.toFlatObject(e,l,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return wt.call(l,o,c,r,a,n),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const sP=null;function Cp(e){return je.isPlainObject(e)||je.isArray(e)}function wS(e){return je.endsWith(e,"[]")?e.slice(0,-2):e}function G1(e,t,r){return e?e.concat(t).map(function(n,i){return n=wS(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function aP(e){return je.isArray(e)&&!e.some(Cp)}const nP=je.toFlatObject(je,{},null,function(t){return/^is[A-Z]/.test(t)});function tm(e,t,r){if(!je.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=je.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,g){return!je.isUndefined(g[h])});const a=r.metaTokens,n=r.visitor||d,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&je.isSpecCompliantForm(t);if(!je.isFunction(n))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(je.isDate(p))return p.toISOString();if(je.isBoolean(p))return p.toString();if(!c&&je.isBlob(p))throw new wt("Blob is not supported. Use a Buffer instead.");return je.isArrayBuffer(p)||je.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function d(p,h,g){let b=p;if(p&&!g&&typeof p=="object"){if(je.endsWith(h,"{}"))h=a?h:h.slice(0,-2),p=JSON.stringify(p);else if(je.isArray(p)&&aP(p)||(je.isFileList(p)||je.endsWith(h,"[]"))&&(b=je.toArray(p)))return h=wS(h),b.forEach(function(y,w){!(je.isUndefined(y)||y===null)&&t.append(l===!0?G1([h],w,i):l===null?h:h+"[]",u(y))}),!1}return Cp(p)?!0:(t.append(G1(g,h,i),u(p)),!1)}const m=[],f=Object.assign(nP,{defaultVisitor:d,convertValue:u,isVisitable:Cp});function x(p,h){if(!je.isUndefined(p)){if(m.indexOf(p)!==-1)throw Error("Circular reference detected in "+h.join("."));m.push(p),je.forEach(p,function(b,j){(!(je.isUndefined(b)||b===null)&&n.call(t,b,je.isString(j)?j.trim():j,h,f))===!0&&x(b,h?h.concat(j):[j])}),m.pop()}}if(!je.isObject(e))throw new TypeError("data must be an object");return x(e),t}function q1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Yx(e,t){this._pairs=[],e&&tm(e,this,t)}const NS=Yx.prototype;NS.append=function(t,r){this._pairs.push([t,r])};NS.toString=function(t){const r=t?function(a){return t.call(this,a,q1)}:q1;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function iP(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function SS(e,t,r){if(!t)return e;const a=r&&r.encode||iP;je.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=je.isURLSearchParams(t)?t.toString():new Yx(t,r).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class K1{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){je.forEach(this.handlers,function(a){a!==null&&t(a)})}}const ES={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},lP=typeof URLSearchParams<"u"?URLSearchParams:Yx,oP=typeof FormData<"u"?FormData:null,cP=typeof Blob<"u"?Blob:null,dP={isBrowser:!0,classes:{URLSearchParams:lP,FormData:oP,Blob:cP},protocols:["http","https","file","blob","url","data"]},Xx=typeof window<"u"&&typeof document<"u",_p=typeof navigator=="object"&&navigator||void 0,uP=Xx&&(!_p||["ReactNative","NativeScript","NS"].indexOf(_p.product)<0),mP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",fP=Xx&&window.location.href||"http://localhost",hP=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Xx,hasStandardBrowserEnv:uP,hasStandardBrowserWebWorkerEnv:mP,navigator:_p,origin:fP},Symbol.toStringTag,{value:"Module"})),Ps={...hP,...dP};function pP(e,t){return tm(e,new Ps.classes.URLSearchParams,{visitor:function(r,a,n,i){return Ps.isNode&&je.isBuffer(r)?(this.append(a,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function xP(e){return je.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function gP(e){const t={},r=Object.keys(e);let a;const n=r.length;let i;for(a=0;a<n;a++)i=r[a],t[i]=e[i];return t}function TS(e){function t(r,a,n,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&je.isArray(n)?n.length:l,c?(je.hasOwnProp(n,l)?n[l]=[n[l],a]:n[l]=a,!o):((!n[l]||!je.isObject(n[l]))&&(n[l]=[]),t(r,a,n[l],i)&&je.isArray(n[l])&&(n[l]=gP(n[l])),!o)}if(je.isFormData(e)&&je.isFunction(e.entries)){const r={};return je.forEachEntry(e,(a,n)=>{t(xP(a),n,r,0)}),r}return null}function vP(e,t,r){if(je.isString(e))try{return(t||JSON.parse)(e),je.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const Cc={transitional:ES,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,i=je.isObject(t);if(i&&je.isHTMLForm(t)&&(t=new FormData(t)),je.isFormData(t))return n?JSON.stringify(TS(t)):t;if(je.isArrayBuffer(t)||je.isBuffer(t)||je.isStream(t)||je.isFile(t)||je.isBlob(t)||je.isReadableStream(t))return t;if(je.isArrayBufferView(t))return t.buffer;if(je.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return pP(t,this.formSerializer).toString();if((o=je.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return tm(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),vP(t)):t}],transformResponse:[function(t){const r=this.transitional||Cc.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(je.isResponse(t)||je.isReadableStream(t))return t;if(t&&je.isString(t)&&(a&&!this.responseType||n)){const l=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?wt.from(o,wt.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ps.classes.FormData,Blob:Ps.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};je.forEach(["delete","get","head","post","put","patch"],e=>{Cc.headers[e]={}});const bP=je.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),yP=e=>{const t={};let r,a,n;return e&&e.split(`
`).forEach(function(l){n=l.indexOf(":"),r=l.substring(0,n).trim().toLowerCase(),a=l.substring(n+1).trim(),!(!r||t[r]&&bP[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},Y1=Symbol("internals");function bo(e){return e&&String(e).trim().toLowerCase()}function $d(e){return e===!1||e==null?e:je.isArray(e)?e.map($d):String(e)}function jP(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const wP=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ym(e,t,r,a,n){if(je.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!je.isString(t)){if(je.isString(a))return t.indexOf(a)!==-1;if(je.isRegExp(a))return a.test(t)}}function NP(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function SP(e,t){const r=je.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(n,i,l){return this[a].call(this,t,n,i,l)},configurable:!0})})}let ta=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function i(o,c,u){const d=bo(c);if(!d)throw new Error("header name must be a non-empty string");const m=je.findKey(n,d);(!m||n[m]===void 0||u===!0||u===void 0&&n[m]!==!1)&&(n[m||c]=$d(o))}const l=(o,c)=>je.forEach(o,(u,d)=>i(u,d,c));if(je.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(je.isString(t)&&(t=t.trim())&&!wP(t))l(yP(t),r);else if(je.isObject(t)&&je.isIterable(t)){let o={},c,u;for(const d of t){if(!je.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?je.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}l(o,r)}else t!=null&&i(r,t,a);return this}get(t,r){if(t=bo(t),t){const a=je.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return jP(n);if(je.isFunction(r))return r.call(this,n,a);if(je.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=bo(t),t){const a=je.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||Ym(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function i(l){if(l=bo(l),l){const o=je.findKey(a,l);o&&(!r||Ym(a,a[o],o,r))&&(delete a[o],n=!0)}}return je.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const i=r[a];(!t||Ym(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,a={};return je.forEach(this,(n,i)=>{const l=je.findKey(a,i);if(l){r[l]=$d(n),delete r[i];return}const o=t?NP(i):String(i).trim();o!==i&&delete r[i],r[o]=$d(n),a[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return je.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&je.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[Y1]=this[Y1]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=bo(l);a[o]||(SP(n,l),a[o]=!0)}return je.isArray(t)?t.forEach(i):i(t),this}};ta.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);je.reduceDescriptors(ta.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});je.freezeMethods(ta);function Xm(e,t){const r=this||Cc,a=t||r,n=ta.from(a.headers);let i=a.data;return je.forEach(e,function(o){i=o.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function AS(e){return!!(e&&e.__CANCEL__)}function eo(e,t,r){wt.call(this,e??"canceled",wt.ERR_CANCELED,t,r),this.name="CanceledError"}je.inherits(eo,wt,{__CANCEL__:!0});function CS(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new wt("Request failed with status code "+r.status,[wt.ERR_BAD_REQUEST,wt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function EP(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function TP(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=a[i];l||(l=u),r[n]=c,a[n]=u;let m=i,f=0;for(;m!==n;)f+=r[m++],m=m%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),u-l<t)return;const x=d&&u-d;return x?Math.round(f*1e3/x):void 0}}function AP(e,t){let r=0,a=1e3/t,n,i;const l=(u,d=Date.now())=>{r=d,n=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),m=d-r;m>=a?l(u,d):(n=u,i||(i=setTimeout(()=>{i=null,l(n)},a-m)))},()=>n&&l(n)]}const Xd=(e,t,r=3)=>{let a=0;const n=TP(50,250);return AP(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-a,u=n(c),d=l<=o;a=l;const m={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-l)/u:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(m)},r)},X1=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},J1=e=>(...t)=>je.asap(()=>e(...t)),CP=Ps.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Ps.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Ps.origin),Ps.navigator&&/(msie|trident)/i.test(Ps.navigator.userAgent)):()=>!0,_P=Ps.hasStandardBrowserEnv?{write(e,t,r,a,n,i){const l=[e+"="+encodeURIComponent(t)];je.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),je.isString(a)&&l.push("path="+a),je.isString(n)&&l.push("domain="+n),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function kP(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function DP(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function _S(e,t,r){let a=!kP(t);return e&&(a||r==!1)?DP(e,t):t}const Z1=e=>e instanceof ta?{...e}:e;function Ki(e,t){t=t||{};const r={};function a(u,d,m,f){return je.isPlainObject(u)&&je.isPlainObject(d)?je.merge.call({caseless:f},u,d):je.isPlainObject(d)?je.merge({},d):je.isArray(d)?d.slice():d}function n(u,d,m,f){if(je.isUndefined(d)){if(!je.isUndefined(u))return a(void 0,u,m,f)}else return a(u,d,m,f)}function i(u,d){if(!je.isUndefined(d))return a(void 0,d)}function l(u,d){if(je.isUndefined(d)){if(!je.isUndefined(u))return a(void 0,u)}else return a(void 0,d)}function o(u,d,m){if(m in t)return a(u,d);if(m in e)return a(void 0,u)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(u,d,m)=>n(Z1(u),Z1(d),m,!0)};return je.forEach(Object.keys({...e,...t}),function(d){const m=c[d]||n,f=m(e[d],t[d],d);je.isUndefined(f)&&m!==o||(r[d]=f)}),r}const kS=e=>{const t=Ki({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=t;if(t.headers=l=ta.from(l),t.url=SS(_S(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),je.isFormData(r)){if(Ps.hasStandardBrowserEnv||Ps.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(je.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,m])=>{u.includes(d.toLowerCase())&&l.set(d,m)})}}if(Ps.hasStandardBrowserEnv&&(a&&je.isFunction(a)&&(a=a(t)),a||a!==!1&&CP(t.url))){const c=n&&i&&_P.read(i);c&&l.set(n,c)}return t},IP=typeof XMLHttpRequest<"u",OP=IP&&function(e){return new Promise(function(r,a){const n=kS(e);let i=n.data;const l=ta.from(n.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=n,d,m,f,x,p;function h(){x&&x(),p&&p(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function b(){if(!g)return;const y=ta.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),N={data:!o||o==="text"||o==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:y,config:e,request:g};CS(function(E){r(E),h()},function(E){a(E),h()},N),g=null}"onloadend"in g?g.onloadend=b:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(b)},g.onabort=function(){g&&(a(new wt("Request aborted",wt.ECONNABORTED,e,g)),g=null)},g.onerror=function(w){const N=w&&w.message?w.message:"Network Error",S=new wt(N,wt.ERR_NETWORK,e,g);S.event=w||null,a(S),g=null},g.ontimeout=function(){let w=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const N=n.transitional||ES;n.timeoutErrorMessage&&(w=n.timeoutErrorMessage),a(new wt(w,N.clarifyTimeoutError?wt.ETIMEDOUT:wt.ECONNABORTED,e,g)),g=null},i===void 0&&l.setContentType(null),"setRequestHeader"in g&&je.forEach(l.toJSON(),function(w,N){g.setRequestHeader(N,w)}),je.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),o&&o!=="json"&&(g.responseType=n.responseType),u&&([f,p]=Xd(u,!0),g.addEventListener("progress",f)),c&&g.upload&&([m,x]=Xd(c),g.upload.addEventListener("progress",m),g.upload.addEventListener("loadend",x)),(n.cancelToken||n.signal)&&(d=y=>{g&&(a(!y||y.type?new eo(null,e,g):y),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const j=EP(n.url);if(j&&Ps.protocols.indexOf(j)===-1){a(new wt("Unsupported protocol "+j+":",wt.ERR_BAD_REQUEST,e));return}g.send(i||null)})},PP=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,n;const i=function(u){if(!n){n=!0,o();const d=u instanceof Error?u:this.reason;a.abort(d instanceof wt?d:new eo(d instanceof Error?d.message:d))}};let l=t&&setTimeout(()=>{l=null,i(new wt(`timeout ${t} of ms exceeded`,wt.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=a;return c.unsubscribe=()=>je.asap(o),c}},RP=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let a=0,n;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},LP=async function*(e,t){for await(const r of FP(e))yield*RP(r,t)},FP=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},Q1=(e,t,r,a)=>{const n=LP(e,t);let i=0,l,o=c=>{l||(l=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await n.next();if(u){o(),c.close();return}let m=d.byteLength;if(r){let f=i+=m;r(f)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),n.return()}},{highWaterMark:2})},eb=64*1024,{isFunction:id}=je,MP=(({Request:e,Response:t})=>({Request:e,Response:t}))(je.global),{ReadableStream:tb,TextEncoder:rb}=je.global,sb=(e,...t)=>{try{return!!e(...t)}catch{return!1}},BP=e=>{e=je.merge.call({skipUndefined:!0},MP,e);const{fetch:t,Request:r,Response:a}=e,n=t?id(t):typeof fetch=="function",i=id(r),l=id(a);if(!n)return!1;const o=n&&id(tb),c=n&&(typeof rb=="function"?(p=>h=>p.encode(h))(new rb):async p=>new Uint8Array(await new r(p).arrayBuffer())),u=i&&o&&sb(()=>{let p=!1;const h=new r(Ps.origin,{body:new tb,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!h}),d=l&&o&&sb(()=>je.isReadableStream(new a("").body)),m={stream:d&&(p=>p.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!m[p]&&(m[p]=(h,g)=>{let b=h&&h[p];if(b)return b.call(h);throw new wt(`Response type '${p}' is not supported`,wt.ERR_NOT_SUPPORT,g)})});const f=async p=>{if(p==null)return 0;if(je.isBlob(p))return p.size;if(je.isSpecCompliantForm(p))return(await new r(Ps.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(je.isArrayBufferView(p)||je.isArrayBuffer(p))return p.byteLength;if(je.isURLSearchParams(p)&&(p=p+""),je.isString(p))return(await c(p)).byteLength},x=async(p,h)=>{const g=je.toFiniteNumber(p.getContentLength());return g??f(h)};return async p=>{let{url:h,method:g,data:b,signal:j,cancelToken:y,timeout:w,onDownloadProgress:N,onUploadProgress:S,responseType:E,headers:_,withCredentials:T="same-origin",fetchOptions:C}=kS(p),A=t||fetch;E=E?(E+"").toLowerCase():"text";let D=PP([j,y&&y.toAbortSignal()],w),P=null;const R=D&&D.unsubscribe&&(()=>{D.unsubscribe()});let M;try{if(S&&u&&g!=="get"&&g!=="head"&&(M=await x(_,b))!==0){let ue=new r(h,{method:"POST",body:b,duplex:"half"}),F;if(je.isFormData(b)&&(F=ue.headers.get("content-type"))&&_.setContentType(F),ue.body){const[Y,z]=X1(M,Xd(J1(S)));b=Q1(ue.body,eb,Y,z)}}je.isString(T)||(T=T?"include":"omit");const X=i&&"credentials"in r.prototype,ie={...C,signal:D,method:g.toUpperCase(),headers:_.normalize().toJSON(),body:b,duplex:"half",credentials:X?T:void 0};P=i&&new r(h,ie);let ae=await(i?A(P,C):A(h,ie));const V=d&&(E==="stream"||E==="response");if(d&&(N||V&&R)){const ue={};["status","statusText","headers"].forEach(k=>{ue[k]=ae[k]});const F=je.toFiniteNumber(ae.headers.get("content-length")),[Y,z]=N&&X1(F,Xd(J1(N),!0))||[];ae=new a(Q1(ae.body,eb,Y,()=>{z&&z(),R&&R()}),ue)}E=E||"text";let me=await m[je.findKey(m,E)||"text"](ae,p);return!V&&R&&R(),await new Promise((ue,F)=>{CS(ue,F,{data:me,headers:ta.from(ae.headers),status:ae.status,statusText:ae.statusText,config:p,request:P})})}catch(X){throw R&&R(),X&&X.name==="TypeError"&&/Load failed|fetch/i.test(X.message)?Object.assign(new wt("Network Error",wt.ERR_NETWORK,p,P),{cause:X.cause||X}):wt.from(X,X&&X.code,p,P)}}},zP=new Map,DS=e=>{let t=e?e.env:{};const{fetch:r,Request:a,Response:n}=t,i=[a,n,r];let l=i.length,o=l,c,u,d=zP;for(;o--;)c=i[o],u=d.get(c),u===void 0&&d.set(c,u=o?new Map:BP(t)),d=u;return u};DS();const kp={http:sP,xhr:OP,fetch:{get:DS}};je.forEach(kp,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ab=e=>`- ${e}`,UP=e=>je.isFunction(e)||e===null||e===!1,IS={getAdapter:(e,t)=>{e=je.isArray(e)?e:[e];const{length:r}=e;let a,n;const i={};for(let l=0;l<r;l++){a=e[l];let o;if(n=a,!UP(a)&&(n=kp[(o=String(a)).toLowerCase()],n===void 0))throw new wt(`Unknown adapter '${o}'`);if(n&&(je.isFunction(n)||(n=n.get(t))))break;i[o||"#"+l]=n}if(!n){const l=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(ab).join(`
`):" "+ab(l[0]):"as no adapter specified";throw new wt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:kp};function Jm(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new eo(null,e)}function nb(e){return Jm(e),e.headers=ta.from(e.headers),e.data=Xm.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),IS.getAdapter(e.adapter||Cc.adapter,e)(e).then(function(a){return Jm(e),a.data=Xm.call(e,e.transformResponse,a),a.headers=ta.from(a.headers),a},function(a){return AS(a)||(Jm(e),a&&a.response&&(a.response.data=Xm.call(e,e.transformResponse,a.response),a.response.headers=ta.from(a.response.headers))),Promise.reject(a)})}const OS="1.12.2",rm={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{rm[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const ib={};rm.transitional=function(t,r,a){function n(i,l){return"[Axios v"+OS+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,o)=>{if(t===!1)throw new wt(n(l," has been removed"+(r?" in "+r:"")),wt.ERR_DEPRECATED);return r&&!ib[l]&&(ib[l]=!0,console.warn(n(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,o):!0}};rm.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function $P(e,t,r){if(typeof e!="object")throw new wt("options must be an object",wt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const i=a[n],l=t[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new wt("option "+i+" must be "+c,wt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new wt("Unknown option "+i,wt.ERR_BAD_OPTION)}}const Wd={assertOptions:$P,validators:rm},rn=Wd.validators;let Fi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new K1,response:new K1}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Ki(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:i}=r;a!==void 0&&Wd.assertOptions(a,{silentJSONParsing:rn.transitional(rn.boolean),forcedJSONParsing:rn.transitional(rn.boolean),clarifyTimeoutError:rn.transitional(rn.boolean)},!1),n!=null&&(je.isFunction(n)?r.paramsSerializer={serialize:n}:Wd.assertOptions(n,{encode:rn.function,serialize:rn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Wd.assertOptions(r,{baseUrl:rn.spelling("baseURL"),withXsrfToken:rn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&je.merge(i.common,i[r.method]);i&&je.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),r.headers=ta.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(r)===!1||(c=c&&h.synchronous,o.unshift(h.fulfilled,h.rejected))});const u=[];this.interceptors.response.forEach(function(h){u.push(h.fulfilled,h.rejected)});let d,m=0,f;if(!c){const p=[nb.bind(this),void 0];for(p.unshift(...o),p.push(...u),f=p.length,d=Promise.resolve(r);m<f;)d=d.then(p[m++],p[m++]);return d}f=o.length;let x=r;for(;m<f;){const p=o[m++],h=o[m++];try{x=p(x)}catch(g){h.call(this,g);break}}try{d=nb.call(this,x)}catch(p){return Promise.reject(p)}for(m=0,f=u.length;m<f;)d=d.then(u[m++],u[m++]);return d}getUri(t){t=Ki(this.defaults,t);const r=_S(t.baseURL,t.url,t.allowAbsoluteUrls);return SS(r,t.params,t.paramsSerializer)}};je.forEach(["delete","get","head","options"],function(t){Fi.prototype[t]=function(r,a){return this.request(Ki(a||{},{method:t,url:r,data:(a||{}).data}))}});je.forEach(["post","put","patch"],function(t){function r(a){return function(i,l,o){return this.request(Ki(o||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}Fi.prototype[t]=r(),Fi.prototype[t+"Form"]=r(!0)});let WP=class PS{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{a.subscribe(o),i=o}).then(n);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,o){a.reason||(a.reason=new eo(i,l,o),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new PS(function(n){t=n}),cancel:t}}};function HP(e){return function(r){return e.apply(null,r)}}function VP(e){return je.isObject(e)&&e.isAxiosError===!0}const Dp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Dp).forEach(([e,t])=>{Dp[t]=e});function RS(e){const t=new Fi(e),r=mS(Fi.prototype.request,t);return je.extend(r,Fi.prototype,t,{allOwnKeys:!0}),je.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return RS(Ki(e,n))},r}const Tr=RS(Cc);Tr.Axios=Fi;Tr.CanceledError=eo;Tr.CancelToken=WP;Tr.isCancel=AS;Tr.VERSION=OS;Tr.toFormData=tm;Tr.AxiosError=wt;Tr.Cancel=Tr.CanceledError;Tr.all=function(t){return Promise.all(t)};Tr.spread=HP;Tr.isAxiosError=VP;Tr.mergeConfig=Ki;Tr.AxiosHeaders=ta;Tr.formToJSON=e=>TS(je.isHTMLForm(e)?new FormData(e):e);Tr.getAdapter=IS.getAdapter;Tr.HttpStatusCode=Dp;Tr.default=Tr;const{Axios:gde,AxiosError:vde,CanceledError:bde,isCancel:yde,CancelToken:jde,VERSION:wde,all:Nde,Cancel:Sde,isAxiosError:Ede,spread:Tde,toFormData:Ade,AxiosHeaders:Cde,HttpStatusCode:_de,formToJSON:kde,getAdapter:Dde,mergeConfig:Ide}=Tr,Ml={BASE_URL:"https://dsfms.id.vn",TIMEOUT:1e4,ENDPOINTS:{AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",STATUS:"/auth/status",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"}}},he={LOGIN:"/login",RESET_PASSWORD:"/reset-password",PROFILE:"/profile",DASHBOARD:"/dashboard",USERS:"/users",USERS_DETAIL:e=>`/users/${e}`,ROLES:"/roles",ROLES_DETAIL:e=>`/roles/${e}`,DEPARTMENTS:"/departments",DEPARTMENTS_DETAIL:e=>`/departments/${e}`,COURSES:"/courses",COURSES_INSTRUCTED:"/courses/instructed",COURSES_ENROLLED:"/courses/enrolled",COURSES_DETAIL:e=>`/courses/${e}`,COURSES_ENROLL_TRAINEES:e=>`/courses/${e}/enroll-trainees`,ACADEMIC_COURSE_DETAIL:e=>`/academic/course-detail/${e}`,SUBJECTS:"/subjects",SUBJECTS_DETAIL:e=>`/subjects/${e}`,SUBJECTS_IN_COURSE:(e,t)=>`/courses/${e}/subjects/${t}`,ASSESSMENTS:"/assessments",ASSESSMENTS_UPCOMING:"/assessments/upcoming",ASSESSMENTS_MY_ASSESSMENTS:"/assessments/my-assessments",ASSESSMENTS_RESULTS:"/assessments/results",ASSESSMENTS_DETAIL:e=>`/assessments/${e}`,ASSESSMENTS_SECTIONS:e=>`/assessments/${e}/sections`,ASSESSMENTS_SECTION_FIELDS:e=>`/assessments/sections/${e}/fields`,ASSESSMENTS_ASSIGN:(e,t)=>`/assessments/assign/${e}/${t}`,ASSESSMENTS_SIGNATURE_REQUIRED:"/assessments/signature-required",ASSESSMENTS_COMPLETION_REQUIRED:"/assessments/completion-required",ASSESSMENTS_PENDING:"/assessments/pending",ASSESSMENT_EVENTS:"/assessment-events",TEMPLATES:"/templates",TEMPLATES_DETAIL:e=>`/templates/${e}`,TEMPLATES_EDITOR:"/templates/editor",TEMPLATES_DRAFTS:"/templates/drafts",TEMPLATES_HISTORY:e=>`/templates/${e}/history`,TEMPLATES_SECTIONS:e=>`/templates/${e}/sections`,TEMPLATES_FIELDS:e=>`/templates/${e}/fields`,REPORTS:"/reports",REPORTS_ISSUES:"/reports/issues",REPORTS_FEEDBACK:"/reports/feedback",REPORTS_CREATE:"/reports/create",REPORTS_DETAIL:e=>`/reports/${e}`,SYSTEM_CONFIG:"/system-config",GLOBAL_FIELDS:"/system-config/global-fields",MAIN_MENU:"/main-menu",TRAINEE_ACADEMIC_DETAILS:"/academic-details",TRAINEE_SIGNATURE_PAD:e=>`/signature-pad/${e}`,TRAINEE_ASSESSMENT_SECTION:e=>`/assessments/sections/${e}`,TRAINER_CONFIGURE_SIGNATURE:"/configure-signature",TRAINER_APPROVAL_NOTES:e=>`/assessments/approval-notes/${e}`,DEPARTMENT_MY_DETAILS:"/my-department-details",DEPARTMENT_REVIEW_REQUESTS:"/assessment-review-requests",DEPARTMENT_REVIEW_REQUEST_DETAIL:e=>`/assessment-review-requests/${e}`},lb={"/admin/users":he.USERS,"/admin/roles":he.ROLES,"/admin/departments":he.DEPARTMENTS,"/admin/forms":he.TEMPLATES,"/admin/forms/editor":he.TEMPLATES_EDITOR,"/admin/forms/drafts":he.TEMPLATES_DRAFTS,"/admin/system-config":he.SYSTEM_CONFIG,"/admin/main-menu":he.MAIN_MENU,"/trainer/instructed-courses":he.COURSES_INSTRUCTED,"/trainer/upcoming-assessments":he.ASSESSMENTS_UPCOMING,"/trainer/assessment-results":he.ASSESSMENTS_RESULTS,"/trainer/configure-signature":he.TRAINER_CONFIGURE_SIGNATURE,"/trainer/dashboard":he.DASHBOARD,"/trainee/dashboard":he.DASHBOARD,"/trainee/enrolled-courses":he.COURSES_ENROLLED,"/trainee/all-assessments":he.ASSESSMENTS_MY_ASSESSMENTS,"/trainee/your-assessments":he.ASSESSMENTS_MY_ASSESSMENTS,"/trainee/signature-required":he.ASSESSMENTS_SIGNATURE_REQUIRED,"/trainee/completion-required":he.ASSESSMENTS_COMPLETION_REQUIRED,"/trainee/create-incident-feedback-report":he.REPORTS_CREATE,"/trainee/academic-details":he.TRAINEE_ACADEMIC_DETAILS,"/academic/dashboard":he.DASHBOARD,"/academic/departments":he.COURSES,"/academic/assessment-events":he.ASSESSMENT_EVENTS,"/academic/course-detail/:courseId":e=>`/academic/course-detail/${e}`,"/department-head/dashboard":he.DASHBOARD,"/department-head/my-department-details":he.DEPARTMENT_MY_DETAILS,"/department-head/assessment-review-requests":he.DEPARTMENT_REVIEW_REQUESTS,"/sqa/issues":he.REPORTS_ISSUES,"/sqa/feedback":he.REPORTS_FEEDBACK,"/sqa/templates":he.TEMPLATES},LS=e=>{const t=e.split("?")[0].split("#")[0];return lb[t]?lb[t]:(Object.values(he).includes(t),t)},Jx=()=>"/dsfms-template/",GP=(e="/")=>{const r=`${Jx()}${e}`;window.location.href=r},Zm=()=>{GP("/")},Zx="https://dsfms.id.vn",Ce=Tr.create({baseURL:Zx,timeout:1e4,headers:{"Content-Type":"application/json"}}),_c=Tr.create({baseURL:Zx,timeout:1e4,headers:{"Content-Type":"application/json"}});let Qm=!1,Ip=[],ld=0;const ob=2,FS=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp<r}catch{return!0}},qP=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp-r<300}catch{return!0}},cb=(e,t=null)=>{Ip.forEach(r=>{e?r.reject(e):r.resolve(t)}),Ip=[]};Ce.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(FS(t)?console.log(" Token is expired, will trigger refresh in response interceptor"):qP(t)&&console.log(" Token expires soon, consider refreshing"),e.headers.Authorization=`Bearer ${t}`,e.url?.includes("/roles/")&&e.method==="put"&&console.log(" Role update request:",{url:e.url,method:e.method,data:e.data,headers:{Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}}),e.url?.includes("/assign-trainees")&&e.method==="post"&&console.log(" Assign Trainees Request (Interceptor):",{url:e.url,method:e.method,data:e.data,dataType:typeof e.data,dataIsArray:Array.isArray(e.data),dataStringified:JSON.stringify(e.data),headers:{"Content-Type":e.headers["Content-Type"],Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}})),e},e=>Promise.reject(e));Ce.interceptors.response.use(e=>e,async e=>{const t=e.config,r=e.response?.status;if(r===401&&!t._retry&&!t.url?.includes("/auth/")&&ld<ob){if(console.log(" API call failed with 401 (token expired), attempting token refresh..."),Qm)return new Promise((n,i)=>{Ip.push({resolve:n,reject:i})}).then(n=>(t.headers.Authorization=`Bearer ${n}`,Ce(t))).catch(n=>Promise.reject(n));t._retry=!0,Qm=!0,ld++;const a=localStorage.getItem("refreshToken");if(a)try{if(console.log(" Token ht hn (401), ang refresh token..."),FS(a))throw new Error("Refresh token is also expired");const n=await Tr.post(`${Zx}/auth/refresh`,{refresh_token:a}),{access_token:i,refresh_token:l}=n.data;if(!i||!l)throw new Error("Invalid token response from server");return localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",l),ld=0,console.log(" Refresh token thnh cng, retry request gc"),cb(null,i),t.headers.Authorization=`Bearer ${i}`,await Ce(t)}catch(n){return console.error(" Refresh token tht bi:",n),cb(n,null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Zm(),Promise.reject(n)}finally{Qm=!1}else console.log(" Khng c refresh token, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),Zm()}else{if(r===403)return console.log(" API call failed with 403 (insufficient permissions) - user remains logged in"),Promise.reject(e);ld>=ob&&(console.error("  vt qu s ln refresh cho php, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Zm())}return Promise.reject(e)});const KP=Object.freeze(Object.defineProperty({__proto__:null,default:Ce,publicApiClient:_c},Symbol.toStringTag,{value:"Module"})),od=Tr.create({baseURL:"https://dsfms.id.vn",timeout:1e4,headers:{"Content-Type":"application/json"}}),qn={login:async e=>{try{return(await od.post("/auth/login",e)).data}catch(t){throw t.response?.data||t.message}},refreshToken:async e=>{try{return(await od.post("/auth/refresh",{refresh_token:e})).data}catch(t){throw t.response?.data||t.message}},checkStatus:async()=>{try{return(await Ce.get("/auth/status")).data}catch(e){throw e.response?.data||e.message}},forgotPassword:async(e,t)=>{try{return(await od.post("/auth/forgot-password",{email:e,magicLink:t})).data}catch(r){throw r.response?.data||r.message}},resetPasswordWithToken:async(e,t,r)=>{try{return(await od.post("/auth/reset-password",{token:e,newPassword:t,confirmPassword:r})).data}catch(a){throw a.response?.data||a.message}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")}},$s={getUsers:async(e={})=>{try{const r=(await Ce.get("/users",{params:e})).data;if(r&&r.data){if(Array.isArray(r.data))return{data:r.data};if(r.data.users&&Array.isArray(r.data.users))return{data:r.data.users}}return Array.isArray(r)?{data:r}:r&&r.users&&Array.isArray(r.users)?{data:r.users}:r}catch(t){throw t.response?.data||t.message}},getUserById:async e=>{try{const r=(await Ce.get(`/users/${e}`)).data;return r?.data&&typeof r.data=="object"?r.data:r}catch(t){throw t.response?.data||t.message}},getProfile:async()=>{try{return(await Ce.get("/profile")).data}catch(e){throw e.response?.data||e.message}},createUser:async e=>{try{return(await Ce.post("/users",e)).data}catch(t){throw t.response?.data||t.message}},updateUser:async(e,t)=>{try{return(await Ce.put(`/users/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteUser:async e=>{try{return(await Ce.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},bulkImportUsers:async e=>{try{return(await Ce.post("/users/bulk",{users:e})).data}catch(t){throw t.response?.data||t.message}},getRoles:async()=>{try{const t=(await Ce.get("/roles")).data;return t&&t.data&&typeof t.data=="object"?t.data:t}catch(e){throw e.response?.data||e.message}},enableUser:async e=>{try{return(await Ce.patch(`/users/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableUser:async e=>{try{return(await Ce.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleUserStatus:async(e,t)=>{try{return(await Ce.patch(`/users/${e}`,{status:t})).data}catch(r){throw r.response?.data||r.message}},resetPassword:async e=>{try{return(await Ce.put("/profile/reset-password",{newPassword:e.newPassword,confirmNewPassword:e.confirmPassword})).data}catch(t){throw t.response?.data||t.message}},getTrainers:async(e={})=>{try{return(await Ce.get("/users",{params:{roleName:"TRAINER",...e}})).data}catch(t){throw t.response?.data||t.message}}},Kn=e=>e&&e.data&&typeof e.data=="object"?e.data:e,Ws={getPublicRoles:async()=>{try{const e=await _c.get("/public/roles");return e.data?.data||e.data||[]}catch(e){throw console.error("Error fetching public roles:",e),e}},getRoles:async(e={})=>{try{const t=await Ce.get("/roles",{params:e});return Kn(t.data)}catch(t){throw t.response?.data||t.message}},getRoleById:async e=>{try{const t=await Ce.get(`/roles/${e}`);return Kn(t.data)}catch(t){throw t.response?.data||t.message}},createRole:async e=>{try{const t=await Ce.post("/roles",e);return Kn(t.data)}catch(t){throw t.response?.data||t.message}},updateRole:async(e,t)=>{try{console.log(" API updateRole called with:",{id:e,roleData:t,url:`/roles/${e}`,method:"PUT"});const r=await Ce.put(`/roles/${e}`,t),a=Kn(r.data);return console.log(" API updateRole success:",a),a}catch(r){throw console.error(" API updateRole error:",{status:r.response?.status,statusText:r.response?.statusText,data:r.response?.data,message:r.message}),r.response?.data||r.message}},deleteRole:async e=>{try{const t=await Ce.delete(`/roles/${e}`);return Kn(t.data)}catch(t){throw t.response?.data||t.message}},toggleRoleStatus:async e=>{try{const t=await Ce.patch(`/roles/${e}/toggle-status`);return Kn(t.data)}catch(t){throw t.response?.data||t.message}},enableRole:async e=>{try{const t=await Ce.patch(`/roles/${e}/enable`);return Kn(t.data)}catch(t){throw t.response?.data||t.message}},disableRole:async e=>{try{const t=await Ce.delete(`/roles/${e}`);return Kn(t.data)}catch(t){throw t.response?.data||t.message}}},Mt={getPublicDepartments:async()=>{try{const e=await _c.get("/public/departments");return e.data?.data||e.data||[]}catch(e){throw console.error("Error fetching public departments:",e),e}},getDepartments:async(e={})=>{try{return(await Ce.get("/departments",{params:{includeDeleted:!0,...e}})).data}catch(t){throw console.error("Error fetching departments:",t),t}},getDepartmentById:async e=>{try{return(await Ce.get(`/departments/${e}`,{params:{includeDeleted:!0}})).data}catch(t){throw console.error("Error fetching department:",t),t}},createDepartment:async e=>{try{console.log(" API - Creating department with data:",e);const t=await Ce.post("/departments",e);return console.log(" API - Department created successfully:",t.data),t.data}catch(t){throw console.error(" API - Error creating department:",t),console.error(" API - Error response:",t.response?.data),console.error(" API - Error status:",t.response?.status),t}},updateDepartment:async(e,t)=>{try{console.log(" API - Updating department:",{id:e,departmentData:t});const r=await Ce.put(`/departments/${e}`,t);return console.log(" API - Department updated successfully:",r.data),r.data}catch(r){if(console.error(" API - Error updating department:",r),console.error(" API - Error response:",r.response?.data),console.error(" API - Error status:",r.response?.status),console.error(" API - Request config:",{url:r.config?.url,method:r.config?.method,data:r.config?.data}),r.code==="ERR_NETWORK"||r.message==="Network Error"){const a=new Error("Network error: Unable to connect to server. Please check your internet connection or contact support.");throw a.code="NETWORK_ERROR",a}else if(r.response?.status===502){const a=new Error("Server error (502): Bad Gateway. The server is temporarily unavailable. Please try again later.");throw a.code="BAD_GATEWAY",a}else if(r.response?.status===403){const a=new Error("Permission denied: You do not have permission to update this department.");throw a.code="PERMISSION_DENIED",a}throw r}},deleteDepartment:async e=>{try{return(await Ce.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error deleting department:",t),t}},disableDepartment:async e=>{try{return(await Ce.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error disabling department:",t),t}},enableDepartment:async e=>{try{return(await Ce.patch(`/departments/${e}/enable`)).data}catch(t){throw console.error("Error enabling department:",t),t}},toggleDepartmentStatus:async e=>{try{return(await Ce.patch(`/departments/${e}/toggle-status`)).data}catch(t){throw console.error("Error toggling department status:",t),t}},bulkDeleteDepartments:async e=>{try{return(await Ce.delete("/departments/bulk",{data:{ids:e}})).data}catch(t){throw console.error("Error bulk deleting departments:",t),t}},bulkToggleStatus:async(e,t)=>{try{return(await Ce.patch("/departments/bulk/toggle-status",{ids:e,status:t})).data}catch(r){throw console.error("Error bulk toggling department status:",r),r}},getDepartmentHeads:async()=>{try{return(await Ce.get("/departments/helpers/department-heads")).data}catch(e){throw console.error("Error fetching department heads:",e),e}},assignTrainersToDepartment:async(e,t)=>{try{return(await Ce.patch(`/departments/${e}/add-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error assigning trainers to department:",r),r}},removeTrainersFromDepartment:async(e,t)=>{try{return(await Ce.patch(`/departments/${e}/remove-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error removing trainers from department:",r),r}}},Yr={getPublicCourses:async()=>{try{const e=await _c.get("/public/courses");return e.data?.data||e.data||[]}catch(e){throw console.error("Error fetching public courses:",e),e}},getCourses:async(e={})=>{try{return(await Ce.get("/courses",{params:e})).data}catch(t){throw console.error("Error fetching courses:",t),t}},getCourseById:async e=>{try{return(await Ce.get(`/courses/${e}`)).data}catch(t){throw console.error("Error fetching course:",t),t}},createCourse:async e=>{try{return(await Ce.post("/courses",e)).data}catch(t){throw console.error("Error creating course:",t),t}},updateCourse:async(e,t)=>{try{return(await Ce.put(`/courses/${e}`,t)).data}catch(r){throw console.error("Error updating course:",r),r}},archiveCourse:async e=>{try{return(await Ce.delete(`/courses/${e}/archive`)).data}catch(t){throw console.error("Error archiving course:",t),t}},getCoursesByDepartment:async(e,t={})=>{try{return(await Ce.get("/courses",{params:{departmentId:e,...t}})).data}catch(r){throw console.error("Error fetching courses by department:",r),r}},getDepartmentWithCourses:async e=>{try{return(await Ce.get(`/courses/department/${e}`)).data}catch(t){throw console.error("Error fetching department with courses:",t),t}},getDepartmentById:async e=>{try{return(await Ce.get(`/departments/${e}`)).data}catch(t){throw console.error("Error fetching department by ID:",t),t}},getTraineeEnrollments:async e=>(await Ce.get(`/courses/trainees/${e}/enrollments`)).data,getCourseTrainees:async e=>{try{return(await Ce.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching course trainees:",t),t}},getCourseEnrollmentBatches:async e=>{try{return(await Ce.get(`/courses/${e}/enrollments/batches`)).data}catch(t){throw console.error("Error fetching course enrollment batches:",t),t}},deleteBatchEnrollments:async(e,t)=>{try{return(await Ce.delete(`/courses/${e}/enrollments/batches/${t}`)).data}catch(r){throw console.error("Error deleting batch enrollments:",r),r}}},Jd={getTrainees:async(e={})=>{try{return(await Ce.get("/trainees",{params:e})).data}catch(t){throw t.response?.data||t.message}},getTraineeById:async e=>{try{return(await Ce.get(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},createTrainee:async e=>{try{return(await Ce.post("/trainees",e)).data}catch(t){throw t.response?.data||t.message}},updateTrainee:async(e,t)=>{try{return(await Ce.put(`/trainees/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteTrainee:async e=>{try{return(await Ce.delete(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleTraineeStatus:async e=>{try{return(await Ce.patch(`/trainees/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},getTraineeCourses:async e=>{try{return(await Ce.get(`/trainees/${e}/courses`)).data}catch(t){throw t.response?.data||t.message}},getTraineeSubjects:async(e,t=null)=>{try{const r=t?`/trainees/${e}/subjects?courseId=${t}`:`/trainees/${e}/subjects`;return(await Ce.get(r)).data}catch(r){throw r.response?.data||r.message}},getTraineeAssessments:async e=>{try{return(await Ce.get(`/trainees/${e}/assessments`)).data}catch(t){throw t.response?.data||t.message}},enrollTrainee:async(e,t)=>{try{return(await Ce.post(`/trainees/${e}/enroll`,{courseId:t})).data}catch(r){throw r.response?.data||r.message}},unenrollTrainee:async(e,t)=>{try{return(await Ce.delete(`/trainees/${e}/enroll/${t}`)).data}catch(r){throw r.response?.data||r.message}},bulkImportTrainees:async e=>{try{return(await Ce.post("/trainees/bulk-import",e)).data}catch(t){throw t.response?.data||t.message}},getTraineesForEnrollment:async(e={})=>{try{const t=await _c.get("/public/trainees",{params:e});return t.data&&t.data.data&&Array.isArray(t.data.data)?{data:{users:t.data.data}}:t.data}catch(t){throw t.response?.data||t.message}},lookupTrainees:async e=>{try{console.log("API call - lookupTrainees with:",e);const t={traineesList:e};console.log("Sending request with format:",t);const r=await Ce.post("/subjects/trainees/lookup",t);return console.log("API response:",r.data),r.data}catch(t){throw console.error("Lookup failed:",t.response?.data),t.response?.data||t.message}},getTraineesByCourseId:async e=>{try{return(await Ce.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching trainees by course ID:",t),t}}},ws={getSubjects:async(e={})=>{try{return(await Ce.get("/subjects",{params:e})).data}catch(t){throw t}},getSubjectsByCourse:async(e,t={})=>{const r=`/subjects/course/${e}`;try{return(await Ce.get(r,{params:t})).data}catch(a){throw a}},getSubjectById:async e=>{try{const t=await Ce.get(`/subjects/${e}`,{data:void 0,transformRequest:[(r,a)=>{delete a["Content-Type"]}]});return t.data&&t.data.data?t.data.data:t.data}catch(t){throw t}},createSubject:async e=>{try{return(await Ce.post("/subjects",e)).data}catch(t){throw t}},updateSubject:async(e,t)=>{try{return(await Ce.put(`/subjects/${e}`,t)).data}catch(r){throw r}},deleteSubject:async e=>{try{return(await Ce.delete(`/subjects/${e}`)).data}catch(t){throw t}},archiveSubject:async e=>{try{return(await Ce.delete(`/subjects/${e}/archive`)).data}catch(t){throw t}},bulkImportSubjects:async e=>{try{const r={courseId:e[0]?.courseId,subjects:e.map(n=>{const{courseId:i,...l}=n;return l})},a=await Ce.post("/subjects/bulk",r);return a.status===304?{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"}:a.data}catch(t){if(t.response?.status===304)return{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"};throw t}},assignTrainees:async(e,t)=>{try{const r={batchCode:t.batchCode||t.batch_code||"",traineeUserIds:t.traineeUserIds||t.trainee_user_ids||[]};if(!r.batchCode||typeof r.batchCode!="string")throw new Error("batchCode must be a non-empty string");if(!Array.isArray(r.traineeUserIds)||r.traineeUserIds.length===0)throw new Error("traineeUserIds must be a non-empty array");const a={batchCode:String(r.batchCode).trim(),traineeUserIds:Array.isArray(r.traineeUserIds)?[...r.traineeUserIds]:[]};return(await Ce.post(`/subjects/${e}/assign-trainees`,a)).data}catch(r){throw r}},removeTraineeFromSubject:async(e,t,r)=>{try{const a={batchCode:r};return(await Ce.delete(`/subjects/${e}/trainees/${t}`,{data:a})).data}catch(a){throw a}},addTrainerToSubject:async(e,t)=>{try{if(!t||typeof t!="object")throw new Error("Trainer data is required and must be an object");if(!t.trainer_user_id)throw new Error("trainer_user_id is required");if(!t.role_in_subject)throw new Error("role_in_subject is required");const r=["EXAMINER","ASSESSMENT_REVIEWER"];if(!r.includes(t.role_in_subject))throw new Error(`Invalid role_in_subject: ${t.role_in_subject}. Must be one of: ${r.join(", ")}`);const a=String(t.trainer_user_id).trim(),n=String(t.role_in_subject).trim();if(!a||a==="")throw new Error("trainerUserId cannot be empty");if(!n||n==="")throw new Error("roleInSubject cannot be empty");const i={trainerUserId:a,roleInSubject:n};return(await Ce.post(`/subjects/${e}/trainers`,i,{headers:{"Content-Type":"application/json"}})).data}catch(r){throw r.response?.data?r.response.data:new Error(r.message||"Failed to add trainer to subject")}},getSubjectTrainers:async e=>{try{return(await Ce.get(`/subjects/${e}/trainers`)).data}catch(t){throw t.response?.data||t.message}},updateTrainerRole:async(e,t,r)=>{try{const a={roleInSubject:r.roleInSubject};return(await Ce.put(`/subjects/${e}/trainers/${t}`,a)).data}catch(a){throw a.response?.data||a.message}},removeTrainerFromSubject:async(e,t)=>{try{return(await Ce.delete(`/subjects/${e}/trainers/${t}`)).data}catch(r){throw r.response?.data||r.message}}},cr={getTemplates:async(e={})=>{try{return(await Ce.get("/templates",{params:e})).data}catch(t){throw t}},getTemplateById:async e=>{try{return(await Ce.get(`/templates/${e}`)).data}catch(t){throw t}},getTemplatesByDepartment:async(e,t={})=>{try{return(await Ce.get(`/templates/department/${e}`,{params:{status:"PUBLISHED",...t}})).data}catch(r){throw r}},createTemplate:async e=>{try{return(await Ce.post("/templates",e)).data}catch(t){throw t}},updateTemplate:async(e,t)=>{try{return(await Ce.put(`/templates/${e}`,t)).data}catch(r){throw r}},deleteTemplate:async e=>{try{return(await Ce.delete(`/templates/${e}`)).data}catch(t){throw t}},getTemplatePDF:async e=>{try{return(await Ce.get(`/templates/pdf/${e}`,{responseType:"blob"})).data}catch(t){throw t}},reviewTemplate:async(e,t)=>{try{return(await Ce.patch(`/templates/${e}/review`,t)).data}catch(r){throw r}},extractFields:async e=>{try{return(await Ce.post("/templates/extract-fields-from-url",{url:e})).data}catch(t){throw t}},createVersion:async e=>{try{return(await Ce.post("/templates/create-version",e)).data}catch(t){throw t}}},ii={uploadDocument:async(e,t)=>{console.log(" uploadDocument called - FRESH VERSION 2025-01-17");const r=["files"];for(const a of r)try{const n=new FormData;n.append(a,e),console.log(` Testing field name: "${a}"`);const i=await Ce.post(`/media/docs/upload/${t}`,n,{headers:{"Content-Type":void 0}});return console.log(` Success with field name: "${a}"`,i.data),i.data&&i.data.data&&i.data.data.length>0&&i.data.data[0].url?console.log(` File uploaded successfully! URL: ${i.data.data[0].url}`):i.data&&i.data.url?console.log(` File uploaded successfully! URL: ${i.data.url}`):i.data&&i.data.fileUrl?console.log(` File uploaded successfully! URL: ${i.data.fileUrl}`):i.data&&i.data.path?console.log(` File uploaded successfully! Path: ${i.data.path}`):console.log(" File uploaded successfully! Response:",i.data),i.data}catch(n){console.log(` Failed with field name: "${a}"`,n.response?.data?.message)}throw new Error('Upload failed with field name "files". Please check backend logs.')},getDocsType:e=>e.substring(0,3).toLowerCase(),buildUploadUrl:e=>`https://dsfms.id.vn/media/docs/upload/${e}`,uploadFromUrl:async(e,t)=>{try{console.log(" Uploading from URL:",e),console.log(" File name:",t);const r=await Ce.post("/media/docs/upload-from-url",{sourceUrl:e,fileName:t});if(r.data&&r.data.data&&r.data.data.length>0){const a=r.data.data[0].url;return console.log(" File uploaded from URL successfully! New URL:",a),a}else throw new Error("Invalid response format from upload-from-url API")}catch(r){throw console.error(" Error uploading from URL:",r),r}}},Za={getAssessmentEvents:async(e={})=>{try{return(await Ce.get("/assessments/events",{params:e})).data}catch(t){throw console.error("Error fetching assessment events:",t),t}},updateAssessmentEvent:async(e={},t={})=>{try{return(await Ce.put("/assessments/events/update",t,{params:e})).data}catch(r){throw console.error("Error updating assessment event:",r),r}},createAssessmentEvent:async e=>{try{return(await Ce.post("/assessments",e)).data}catch(t){throw console.error("Error creating assessment event:",t),t}},createBulkAssessmentEvent:async e=>{try{return(await Ce.post("/assessments/bulk",e)).data}catch(t){throw console.error("Error creating bulk assessment event:",t),t}},getUserEvents:async(e={})=>{try{return(await Ce.get("/assessments/user-events",{params:e})).data}catch(t){throw console.error("Error fetching user assessment events:",t),t}},getCourseAssessments:async(e,t={})=>{try{return(await Ce.get("/assessments/course",{params:{courseId:e,...t}})).data}catch(r){throw console.error("Error fetching course assessments:",r),r}},getSubjectAssessments:async(e,t={})=>{try{return(await Ce.get("/assessments/subject",{params:{subjectId:e,...t}})).data}catch(r){throw console.error("Error fetching subject assessments:",r),r}},getAssessmentSections:async e=>{try{return(await Ce.get(`/assessments/${e}/sections`)).data}catch(t){throw console.error("Error fetching assessment sections:",t),t}},getAssessmentFormPreview:async e=>{try{return(await Ce.get(`/assessments/${e}/preview`)).data}catch(t){throw console.error("Error fetching assessment preview:",t),t}},getAssessmentSectionFields:async e=>{try{return(await Ce.get(`/assessments/sections/${e}/fields`)).data}catch(t){throw console.error("Error fetching assessment section fields:",t),t}}},Xo={getGlobalFields:async()=>{try{return(await Ce.get("/global-fields")).data}catch(e){throw e}},getGlobalFieldDetail:async e=>{try{return(await Ce.get(`/global-fields/${e}/detail`)).data}catch(t){throw t}},getGlobalFieldById:async e=>{try{return(await Ce.get(`/global-fields/${e}`)).data}catch(t){throw t}},createGlobalField:async e=>{try{return(await Ce.post("/global-fields",e)).data}catch(t){throw t}},updateGlobalField:async(e,t)=>{try{return(await Ce.patch(`/global-fields/${e}`,t)).data}catch(r){throw r}},deleteGlobalField:async e=>{try{return(await Ce.delete(`/global-fields/${e}`)).data}catch(t){throw t}}},yo={"Validation failed":{default:"Invalid data. Please check your information and try again.",fields:{firstName:"First name is required",lastName:"Last name is required",email:"Email is invalid or already exists",phoneNumber:"Phone number is invalid",password:"Password must be at least 8 characters",role:"Role is invalid",department:"Department is invalid",address:"Address is required",gender:"Gender is invalid",dob:"Date of birth is invalid",trainingBatch:"Training batch is required",passportNo:"Passport number is invalid",nation:"Nationality is required",certificationNumber:"Certification number is invalid",specialization:"Specialization is required",yearsOfExp:"Years of experience must be a positive number"}},Unauthorized:"You do not have permission to access. Please login again.","Unauthorized access":"Wrong username or password. Please check your credentials and try again.","Access token is missing":"Your session has expired. Please login again.","Invalid refresh token":"Your session is invalid. Please login again.","User not found or inactive":"Account does not exist or has been deactivated.","Email or password is incorrect":"Email or password is incorrect.","Wrong password or username":"Wrong password or username. Please check your credentials and try again.",Forbidden:"You do not have permission to perform this action. Please contact your administrator.","Insufficient permissions":"You do not have sufficient permissions to perform this action.","Access denied":"Access denied. You do not have permission to access this resource.","User not found":"User not found.","User already exists":"User already exists.","Cannot delete user":"Cannot delete this user.","Cannot update user":"Cannot update user information.","Role not found":"Role not found.","Role already exists":"Role already exists.","Cannot delete role":"Cannot delete this role.","Prohibited action on base role":"Cannot modify base roles. Base roles are system-defined and cannot be edited.","Department not found":"Department not found.","Department already exists":"Department already exists.","Cannot delete department":"Cannot delete this department.","Internal server error":"System error. Please try again later.","Network error":"Connection error. Please check your network and try again.","Request timeout":"Request timeout. Please try again.","Not found":"Data not found.",Conflict:"Data already exists or conflicts.","Too many requests":"Too many requests. Please try again later."},Va=(e,t={})=>{if(e?.response?.status===403)return"You do not have permission to perform this action. Please contact your administrator.";if(e?.response?.status===401)return"Your session has expired. Please login again.";if(typeof e=="string")return yo[e]||e;if(e&&typeof e=="object"){const{message:r,errors:a}=e;let n=r;if(Array.isArray(r))if(r.length>0){const l=r[0];typeof l=="object"&&l!==null?n=l.message||l.field||"Validation failed":n=l}else n="Validation failed";let i=yo[n];if(i&&typeof i=="object"&&i.default?i=i.default:(!i||typeof i!="string")&&(i=n),a&&Array.isArray(a)&&a.length>0){const l=a.map(o=>{if(typeof o=="string"){const c=o.match(/(\w+)\s+(.+)/);if(c){const[,u,d]=c;return yo[n]?.fields?.[u]||d}return o}else if(typeof o=="object"&&o!==null)return o.field&&o.message?yo[n]?.fields?.[o.field]||o.message:o.property&&o.constraints?yo[n]?.fields?.[o.property]||Object.values(o.constraints)[0]||o.property:JSON.stringify(o);return String(o)});return`${i}

Details:
${l.join(`
`)}`}return i}return e?.response?.data?Va(e.response.data,t):e?.message||"An unknown error occurred. Please try again."},MS=v.createContext({user:null,setUser:()=>{},userRole:null,userPermissions:[],isAuthenticated:!1,setIsAuthenticated:()=>{},isLoading:!0,login:async()=>({success:!1}),logout:()=>{},refreshToken:async()=>({success:!1}),fetchUserRoleAndPermissions:async()=>({role:null,permissions:[]})}),YP=({children:e})=>{const[t,r]=v.useState(null),[a,n]=v.useState(null),[i,l]=v.useState([]),[o,c]=v.useState(!1),[u,d]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const b=localStorage.getItem("authToken"),j=localStorage.getItem("user"),y=localStorage.getItem("refreshToken");if(b&&j&&y)try{const w=JSON.parse(atob(b.split(".")[1])),N=Date.now()/1e3;if(w.exp<N)try{const S=await qn.refreshToken(y);localStorage.setItem("authToken",S.access_token),localStorage.setItem("refreshToken",S.refresh_token);const E=JSON.parse(j);r(E),c(!0);try{const{role:_,permissions:T}=await m(E.role,E.roleId);if(_&&T)n(_),l(T);else throw new Error("Failed to fetch role and permissions")}catch(_){console.error("Failed to fetch role and permissions on initialization:",_),qn.logout(),r(null),n(null),l([]),c(!1)}}catch{qn.logout(),r(null),n(null),l([]),c(!1)}else{const S=JSON.parse(j);r(S),c(!0);try{const{role:E,permissions:_}=await m(S.role,S.roleId);if(E&&_)n(E),l(_);else throw new Error("Failed to fetch role and permissions")}catch(E){console.error("Failed to fetch role and permissions on initialization:",E),qn.logout(),r(null),n(null),l([]),c(!1)}}}catch(w){console.error(" Error parsing token or user data:",w),qn.logout(),r(null),n(null),l([]),c(!1)}else r(null),n(null),l([]),c(!1)}catch(b){console.error("Error accessing localStorage:",b),r(null),n(null),l([]),c(!1)}finally{d(!1)}})()},[]),v.useEffect(()=>{if(!o||u)return;const g=async()=>{const j=localStorage.getItem("authToken"),y=localStorage.getItem("refreshToken");if(!j||!y){p();return}try{const w=JSON.parse(atob(j.split(".")[1])),N=Date.now()/1e3;w.exp-N<300&&((await x()).success||(console.error(" Token refresh failed in validation"),p()))}catch(w){console.error(" Token validation failed:",w);try{(await x()).success||(console.error(" Token refresh failed after validation error"),p())}catch(N){console.error(" Token refresh failed:",N),p()}}},b=setTimeout(()=>{g();const j=setInterval(g,120*1e3);return()=>clearInterval(j)},500);return()=>clearTimeout(b)},[o,u]);const m=async(g,b)=>{try{if(b)try{const j=await Ws.getRoleById(b);try{const{default:T}=await gO(async()=>{const{default:A}=await Promise.resolve().then(()=>KP);return{default:A}},void 0),C=await T.get(`/roles/${b}`);if(console.log(" ========== RAW API RESPONSE (BEFORE NORMALIZE) =========="),console.log(" Raw Response Structure:",{hasMessage:!!C.data?.message,hasData:!!C.data?.data,dataType:typeof C.data?.data,permissionsInData:C.data?.data?.permissions?.length,permissionsInRoot:C.data?.permissions?.length,permissionCount:C.data?.data?.permissionCount,permissionCountInRoot:C.data?.permissionCount,roleName:C.data?.data?.name,roleId:C.data?.data?.id}),C.data?.data?.permissions){console.log(" Raw Permissions Count:",C.data.data.permissions.length),console.log(" API permissionCount field:",C.data.data.permissionCount),console.log(" Comparison:",{permissionsArrayLength:C.data.data.permissions.length,permissionCountField:C.data.data.permissionCount,match:C.data.data.permissions.length===C.data.data.permissionCount});const A=C.data.data.permissions.map(P=>P.id),D=new Set(A);A.length!==D.size&&console.warn(" DUPLICATE PERMISSIONS DETECTED!",{total:A.length,unique:D.size,duplicates:A.length-D.size})}}catch(T){console.warn(" Could not fetch raw response:",T)}console.log(" ========== ROLE DETAIL API RESPONSE (AFTER NORMALIZE) =========="),console.log(" Role ID:",b),console.log(" Role Name:",g),console.log(" Full Role Data:",{id:j?.id,name:j?.name,description:j?.description,isActive:j?.isActive,permissionsCount:j?.permissions?.length||0,permissionCount:j?.permissionCount});const y=Array.isArray(j?.permissions)?j.permissions:[];console.log(" ========== PERMISSIONS BEFORE FILTERING =========="),console.log(" Raw Permissions Count:",y.length),console.log(" Permissions with isActive=false:",y.filter(T=>T.isActive===!1).length),console.log(" Permissions without name:",y.filter(T=>!T.name).length),console.log(" Permissions without viewName:",y.filter(T=>!T.viewName).length);const w=y.filter(T=>T.isActive===!1);w.length>0&&console.log(" Found inactive permissions:",w.map(T=>({id:T.id,name:T.name,viewName:T.viewName,isActive:T.isActive})));const N=y;console.log(" ========== PERMISSIONS DETAIL =========="),console.log(" Total Permissions:",N.length),console.log(" Expected Permission Count (from API):",j?.permissionCount||"N/A"),console.log(" Difference:",(j?.permissionCount||N.length)-N.length),console.log(" All Permissions (Full List):",N.map((T,C)=>({index:C+1,id:T.id,name:T.name,viewName:T.viewName,method:T.method,path:T.path,module:T.module,isActive:T.isActive,viewModule:T.viewModule}))),N.length>0&&console.log(" Sample Permissions (first 10):",N.slice(0,10).map(T=>({id:T.id,name:T.name,viewName:T.viewName,method:T.method,path:T.path,isActive:T.isActive}))),j?.permissionCount&&j.permissionCount!==N.length&&(console.warn(" ========== PERMISSION COUNT MISMATCH =========="),console.warn(` Expected: ${j.permissionCount}, Got: ${N.length}`),console.warn(" Missing:",j.permissionCount-N.length,"permissions"));const S=N.map(T=>T.name||T.viewName).filter(Boolean),E=S.filter(T=>/^(GET|POST|PUT|PATCH|DELETE)\s+\//.test(T)).length,_=S.length-E;return console.log(" ========== PERMISSION FORMAT ANALYSIS =========="),console.log(" BE Format (METHOD /path):",E),console.log(" Navigation Format (View All Users):",_),console.log(" All Permission Names:",S.slice(0,10)),console.log(" ========== ROLE DETAIL FETCHED SUCCESSFULLY =========="),n(j),l(N),{role:j,permissions:N}}catch(j){if(console.error("Error fetching role by ID:",j),j.response?.status===403){console.warn("User does not have permission to view role details, trying alternative approach");try{console.log(" ========== FALLBACK: Using /users/me API ==========");const w=await Ce.get("/users/me");if(console.log(" User Profile Response:",{hasRole:!!w.data?.role,hasPermissions:!!w.data?.role?.permissions,permissionsCount:w.data?.role?.permissions?.length||0}),w.data&&w.data.role&&w.data.role.permissions){const N={id:b,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:w.data.role.permissions};return console.log(" Permissions from /users/me:",N.permissions.map(S=>({id:S.id,name:S.name,viewName:S.viewName,method:S.method,path:S.path}))),n(N),l(N.permissions),{role:N,permissions:N.permissions}}}catch(w){console.error("Failed to get user profile:",w)}console.warn("Cannot fetch permissions, creating minimal role");const y={id:b,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:[]};return n(y),l([]),{role:y,permissions:[]}}throw new Error("Failed to fetch role details. Please contact administrator.")}try{const j=await Ws.getRoles(),y=j.data||j;let w;if(y&&y.roles&&Array.isArray(y.roles))w=y.roles;else if(Array.isArray(y))w=y;else throw new Error("Invalid roles data structure");const N=w.find(S=>S.name===g);if(N){const S=await Ws.getRoleById(N.id);return n(S),l(S.permissions||[]),{role:S,permissions:S.permissions||[]}}throw new Error(`Role '${g}' not found`)}catch(j){throw console.error("Fallback method failed:",j),new Error(`Role '${g}' not found. Please contact administrator.`)}}catch(j){return console.error("Error fetching user role and permissions:",j),{role:null,permissions:[]}}},f=async g=>{try{d(!0);const b=await qn.login(g);localStorage.setItem("authToken",b.access_token),localStorage.setItem("refreshToken",b.refresh_token);let j;try{const N=JSON.parse(atob(b.access_token.split(".")[1]));if(!N.userId||!N.roleName)throw new Error("Invalid token: missing required fields (userId, roleName)");j={id:N.userId,email:g.email,fullName:N.fullName||N.name||"User",role:N.roleName,roleId:N.roleId,department:N.department||"IT",lastLogin:new Date().toISOString()},g.email==="depthead@test.com"&&(j.role="DEPARTMENT_HEAD",j.roleId="dept-head-001")}catch(N){throw console.error("Error decoding token:",N),new Error("Invalid token format or missing required fields")}localStorage.setItem("user",JSON.stringify(j)),console.log(" ========== LOGIN: FETCHING ROLE & PERMISSIONS =========="),console.log(" User Info:",{id:j.id,email:j.email,role:j.role,roleId:j.roleId});const{role:y,permissions:w}=await m(j.role,j.roleId);if(!y||!w)throw console.error(" Failed to fetch user role and permissions"),new Error("Failed to fetch user role and permissions");return console.log(" ========== LOGIN: ROLE & PERMISSIONS FETCHED =========="),console.log(" Final Role:",{id:y.id,name:y.name,description:y.description,isActive:y.isActive}),console.log(" Final Permissions Count:",w.length),console.log(" Final Permissions Summary:",{total:w.length,withName:w.filter(N=>N.name).length,withViewName:w.filter(N=>N.viewName).length,withMethodPath:w.filter(N=>N.method&&N.path).length,beFormat:w.filter(N=>N.name&&/^(GET|POST|PUT|PATCH|DELETE)\s+\//.test(N.name)).length,navFormat:w.filter(N=>N.name&&!/^(GET|POST|PUT|PATCH|DELETE)\s+\//.test(N.name)).length}),r(j),n(y),l(w),c(!0),console.log(" ========== LOGIN SUCCESSFUL =========="),{success:!0,user:j,role:y,permissions:w}}catch(b){return{success:!1,error:Va(b)||"Login failed"}}finally{d(!1)}},x=async()=>{try{const g=localStorage.getItem("refreshToken");if(!g)throw new Error("No refresh token available");const b=await qn.refreshToken(g);return localStorage.setItem("authToken",b.access_token),localStorage.setItem("refreshToken",b.refresh_token),{success:!0,tokens:b}}catch(g){return console.error("Manual token refresh failed:",g),p(),{success:!1,error:g.message}}},p=()=>{qn.logout(),r(null),n(null),l([]),c(!1)},h={user:t,setUser:r,userRole:a,userPermissions:i,isAuthenticated:o,setIsAuthenticated:c,isLoading:u,login:f,logout:p,refreshToken:x,fetchUserRoleAndPermissions:m};try{return s.jsx(MS.Provider,{value:h,children:e})}catch(g){return console.error(" AuthProvider error:",g),s.jsxs("div",{style:{padding:"20px",color:"red"},children:[s.jsx("h3",{children:"Authentication Error"}),s.jsx("p",{children:"There was an error initializing the authentication system."}),s.jsxs("details",{children:[s.jsx("summary",{children:"Error Details"}),s.jsx("pre",{children:g.message})]})]})}},xs=()=>{const e=v.useContext(MS);if(!e)throw console.error("AuthContext is null or undefined. Make sure AuthProvider is properly wrapping the component tree."),new Error("useAuth must be used within an AuthProvider");return e},XP={getPermissions:async(e={})=>{try{return(await Ce.get("/permissions",{params:e})).data}catch(t){throw t.response?.data||t.message}},getPermissionById:async e=>{try{return(await Ce.get(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},createPermission:async e=>{try{return(await Ce.post("/permissions",e)).data}catch(t){throw t.response?.data||t.message}},updatePermission:async(e,t)=>{try{return(await Ce.put(`/permissions/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deletePermission:async e=>{try{return(await Ce.delete(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},enablePermission:async e=>{try{return(await Ce.patch(`/permissions/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}}},_a=e=>!e||typeof e!="string"?"":e.trim().toLowerCase().replace(/\s+/g," ").replace(/[^\w\s]/g,""),JP=(e,t)=>!e||!t?!1:_a(e)===_a(t),ZP=(e,t)=>{if(!e||!t||t.length===0)return null;const r=_a(e);for(const n of t)if(JP(e,n))return n;const a=r.split(" ").filter(n=>n.length>2);if(a.length===0)return null;for(const n of t){const i=_a(n),l=a.every(u=>i.includes(u)),o=Math.abs(i.length-r.length),c=Math.max(r.length*.3,5);if(l&&o<=c)return n}return null},BS={"UC-01":[],"UC-02":[],"UC-03":["Change Password"],"UC-04":["Create User"],"UC-05":["Bulk Create Users"],"UC-06":["View All Users","View User In Detail","Update User","Enable User","Disable User"],"UC-07":["View All Users"],"UC-08":["Update User"],"UC-09":["Enable User","Disable User"],"UC-10":["Create Role"],"UC-11":["View All Roles","View Role In Detail","Update Role","Enable Role","Disable Role"],"UC-12":["View All Roles"],"UC-13":["Update Role"],"UC-14":["Enable Role","Disable Role"],"UC-15":["View My Profile","Update My Profile","Change Password"],"UC-16":["View My Profile"],"UC-17":["Update My Profile"],"UC-18":["Update My Profile","Change Password"],"UC-19":["Create Department"],"UC-20":["View All Departments","View Department In Detail","Update Department","Enable Department","Delete Department"],"UC-21":["View All Departments"],"UC-22":["Update Department"],"UC-23":["Enable Department","Delete Department"],"UC-24":["Create Course"],"UC-25":["View All Courses","View Course In Detail","Update Course","Archive Course"],"UC-26":["View All Courses","View Course In Detail"],"UC-27":["Update Course"],"UC-28":["Archive Course"],"UC-29":["Create Bulk Subjects"],"UC-30":["Create Subject"],"UC-31":["List Subjects","View Subject Detail","Create Subject","Update Subject","Archive Subject"],"UC-32":["List Subjects"],"UC-33":["Update Subject"],"UC-34":["Archive Subject"],"UC-35":["Assign Trainees to Subject"],"UC-36":["View Trainee Subject Enrollments","Assign Trainees to Subject","Remove Trainee from Subject"],"UC-37":["View Trainee Subject Enrollments"],"UC-38":["Remove Trainee from Subject","Remove Subject Enrollments"],"UC-39":["Create Template"],"UC-40":["Edit Template Basics","Refresh Draft Template"],"UC-41":["Resubmit Rejected Template"],"UC-42":["Delete Template"],"UC-43":["View All Templates","View Template Details","Update Template Status","Create Template Version"],"UC-44":["Create Template Version"],"UC-45":["Update Template Status"],"UC-46":["Approve or Reject Template"],"UC-47":["Download Content PDF","Download Configuration PDF"],"UC-48":["Create Assessment"],"UC-49":["List Assessment Events","List Department Assessments","List Course Assessments","List Subject Assessments"],"UC-50":["Update Assessment Event"],"UC-51":["List My Assessment Events","List Assessment Events"],"UC-52":["Update Assessment Event"],"UC-53":["List Assessments","View Assessment Details"],"UC-54":["Save Section Values"],"UC-55":["Confirm Trainee Participation"],"UC-56":["Submit Assessment"],"UC-57":["Approve or Reject Assessment"],"UC-58":["List Assessments"],"UC-59":["View Assessment Details","Download Assessment Result"],"UC-60":["List All Reports","Respond to Report","Acknowledge Report Receipt"],"UC-61":["List All Reports","List My Reports","View Report Detail"],"UC-62":["Submit Report Request"],"UC-63":["Cancel Report"],"UC-64":["View Report Detail","Respond to Report","Acknowledge Report Receipt"],"UC-65":["Academic Overview Dashboard"],"UC-66":["Create Global Field"],"UC-67":["List Global Fields","View Global Field In Detail","Update Global Field","Delete Global Field"],"UC-68":["List Global Fields"],"UC-69":["Update Global Field"],"UC-70":["Delete Global Field"]},QP=(()=>{const e={};return Object.entries(BS).forEach(([t,r])=>{r.forEach(a=>{e[a]||(e[a]=[]),e[a].push(t)})}),e})(),db=e=>BS[e]||[],e6=e=>QP[e]||[],Op={"Analytics Dashboard":{"Academic Overview Dashboard":"d39507ea-3417-4ffb-aedc-68bab2d02acc"},"Assessment Execution":{"View Trainee Sections":"d7ac0aac-0b33-4d72-ac24-3e4119ed4a80","Confirm Trainee Participation":"19a0d973-8696-4666-b55f-a29aa055eab1","View Section Fields":"cc86a51c-3fab-408b-9228-f50e0441208e","List Assessments":"d730195c-4b3f-42f1-81ea-8c67f0f713d6","Download Assessment Result":"6bf804cc-0e3b-44d7-aa52-978642791676","View Assessment Details":"28b97065-11aa-4b32-b7f6-51860d8ea9dc","View Assessment Sections":"12c43171-6490-4b7e-ad22-3a771e49b578","Save Section Values":"e85c7cd1-488f-4109-a6ce-b2edc2ea70ef","Submit Assessment":"5293ed3b-81b2-48d6-9503-601ba7d31e91"},"Assessment Forms Management":{"List Department Assessments":"6ab61f21-d9f7-4ce6-a11c-36e3f20b3017","Toggle Trainee Lock":"7429fdf5-3b60-41ad-8ce1-89bb3599af21","List My Assessment Events":"322d4189-6ac6-4d35-9a8a-b25415e56a3c","Create Assessment":"22521664-7e34-4d44-b652-a342521978bc","List Course Assessments":"77688d98-7c3a-40c2-a225-70e8dbd05b62","Update Assessment Event":"169d1fca-14f6-466c-af51-761cdfadb143","Create Bulk Assessments":"a060cea0-cf43-4d21-ba36-0f86def979a4","List Subject Assessments":"67bc4807-db01-43e4-b001-824f00121342","List Assessment Events":"99afd2d0-0527-4cd4-af32-b66897fb723a"},"Assessment Results Approval":{"Approve or Reject Assessment":"cdd76da5-54cd-44e2-b19c-fc0332922750"},"Course Management":{"View Course In Detail":"a8ff820f-39f1-4333-bf93-f63c1939c4e3","Update Course":"b8447d06-9c89-4076-befc-20a313f5cf37","View All Courses":"4e4e45cc-f5ab-493c-afca-704fc5ca1c8e","View Trainee Enrollments":"435a9695-c895-460a-90e2-7eb56230ee7e","Create Course":"3ec91d90-a90c-4fd6-9155-3cfd15602310","View All Course Trainees":"b9bc685d-37b4-4f62-98f7-815a9e6ec391","Archive Course":"f133b97f-95cf-4203-baf6-6fe18888f25a"},"Department Management":{"Create Department":"93dc29ce-eee3-4db0-af26-2df69fa955ad","Update Department":"907525bd-9eda-4a82-86a2-85215ab56dce","Enable Department":"3fe34cbc-5d6a-44f2-83b1-ba0640aa37df","View all Available Department Heads":"88085c41-da90-4586-a255-bcb06c4682c2","Delete Department":"798ec1f8-16d8-4a09-8a69-2bc328e4a3ba","View Department In Detail":"2fb86d25-e540-4bcc-bc83-60235a9d3b28","View All Departments":"5c3308bf-fa48-4529-bd7f-382b79bcb3fa"},"Media Management":{"Force Save ONLYOFFICE":"b88ca282-7d4b-41e6-ba19-bee3afc3f348","Delete image/file":"6eefe640-6db5-4d4d-8a0c-1ad9b37498ab","Upload Images":"49ca5202-0fb9-46e9-b8a6-782f29cb7959","Create Image Presigned URL":"70ddf99e-8222-4fa8-a751-59ee47cae064","Upload Documents":"215d7a7b-7440-4ae9-a28c-41cacc355682","Create Document Presigned URL":"916e8af7-10d9-432d-8478-c41a32949b39","Serve Static Files":"d55e91f5-1371-4694-8091-dff4f0fd7de7","Submit OnlyOffice Document":"e81e50c1-bbf3-4b36-a117-0f3f88875f3c"},"Profile Management":{"View My Profile":"1f1dfa5d-0b16-4842-bd4a-375bd5e3507b","Update My Profile":"a2aa9602-4028-4eef-b37a-86606944cb30","Change Password":"72ab7bd5-d100-4ec0-b61d-a3f9d68f2493"},"Reports Management":{"List All Reports":"8ecff2c2-85a5-44f6-af66-0d623e631762","List My Reports":"ed674eb6-82eb-4763-8101-ac3119f91333","View Report Detail":"7fe1ddef-3687-499e-9cf1-beb47688a73d","Cancel Report":"b93626eb-9946-413c-9b07-d3b10bf0a4f7","Respond to Report":"3dc7f4db-561f-4188-a3af-87c3145f2fc0","Acknowledge Report Receipt":"315d21ec-bdbc-4779-8a37-58d1cd467034","Submit Report Request":"b818f1a6-f26c-418b-a69b-01655371fe33"},"Role Management":{"Disable Role":"c846890f-650b-489d-bb0d-ee21d10ba43e","Create Role":"b1dcd2d8-865d-485a-865e-87020331b822","Enable Role":"d53c5201-1411-4e82-b697-ea46f46a3119","View Role In Detail":"c92bd053-56e3-4008-b9ac-bcd8a88c4c0e","View All Roles":"8736fd6e-16e0-41b3-8e7b-a87913fa13d9","Update Role":"9b49fa83-deba-4581-8a34-2e4a04d76269"},"Subject Management":{"Create Bulk Subjects":"46a8e7d0-8730-44aa-9671-2505c6ac3a1d","Create Subject":"b10eaaec-18de-4c1f-bdb8-8bee7d0cc9d8","Update Subject":"7f472c31-9297-432f-a35e-02ae8034043a","List Subjects":"44ae43b3-86a5-463c-94fb-f7f8d0c1d509","View Subject Detail":"c7fdefca-e5cc-44c0-981f-c67d8f953954","Archive Subject":"4b6360f8-b35a-4f99-acd0-4623082753de"},"System Configuration":{"View Global Field":"39117be8-c2ee-45ed-9265-e64a459d7a08","View Global Field In Detail":"d9cdf419-2692-4dc5-955c-c3dc493bff47","Delete Global Field":"8d027685-95c4-4e06-aca9-e9c8b61c01a0","List Global Fields":"a73c14c5-f421-4ca8-b158-98b7bb5e9b82","Create Global Field":"4b22149d-e523-466d-a453-f63c93b3c37f","Update Global Field":"ba4ff600-a3f5-4af6-b7e9-9dd3891eef4e","View All Global Fields In Detail":"9cc56078-8397-43ec-95eb-48cddb073641"},"Template Management":{"Update Template Status":"bb0b4da6-cc88-4435-b787-07cde5d75e63","Download Content PDF":"f38448de-d098-45e3-b35a-593fdf6f25aa","Download Content & Config ZIP":"3946dc2e-7684-43b7-8a8c-394fa388ab43","Edit Template Basics":"2e52af89-13cc-4a9f-abb4-f7afb8f86a54","Approve or Reject Template":"55fdd4b1-fd32-47d8-ae03-2577844d1f35","Download Configuration PDF":"fda15717-4299-4a8a-bfcc-049aafbc7dbd","Refresh Draft Template":"19d0f64b-652d-41e5-bbf9-12596f4fd543","Test S3 PDF Export":"3aa69715-cbaa-4054-84e1-96404af597a7","Extract Fields from S3 Docx":"6239b15a-6151-4663-8608-a423df6efc05","Create Template Version":"20acccce-1602-4a52-b6ef-fba334b5469f","Resubmit Rejected Template":"92635536-34df-4219-b888-248736b0ebb0","View Template Details":"cf33a670-ad98-4009-aaf9-266db41ac071","View All Templates":"ff240b98-80c4-47f7-a9e7-177f3b2a9cda","Create Template":"73257d15-3b0c-4bbd-aaf7-3e59acc453db","View Template Schema":"07421830-1902-4faa-a730-5d8d769bb970","View Department Templates":"fa4f1f04-8e1c-42af-a06b-d8a906d513f9","Parse Template Schema":"16d267aa-24db-4575-8351-88c2dffa2bfc","Extract Fields from Upload":"331525aa-bbbc-4633-8123-eefb41b2e7b4"},"Trainee Enrollment":{"View Trainee Subject Enrollments":"a527f342-93c6-45ff-9d49-b2622aba4d6a","Remove Course-Trainee Enrollments":"17f5d26b-e7a0-4713-9118-360e592ab058","View Course Enrollment Batches":"1effc8f0-79ac-4388-a0af-282350baaaf9","Remove Course Enrollment Batch":"a8aa0342-95fa-4c7c-8fbc-ca0ba603c59e","Assign Trainees to Subject":"9b65f280-d42b-482d-8b1-f9ce726bf092","Remove Subject Enrollments":"e8e146b1-363e-4941-932f-d8bdde56c65c","Lookup Subject Trainees":"f45aa4e4-d932-450e-a823-f7ff381ca6b0","Remove Trainee from Subject":"dc19657c-3c88-471c-a18d-0114e0326b5a","Remove Trainee from Course":"d510f9d6-0c7a-4576-b3e8-cd2dd2801102"},"Trainer Enrollment":{"Assign Course Trainer":"1095457e-655b-4f3d-a813-f2a5bdf9f9ab","Change Course Trainer Role":"f57d9070-1f15-42fe-bd6e-808322399813","Remove Trainer From Course":"471dc251-274b-4fba-a0ff-6dcfe0bab528","Add Trainers to Subject":"9113ded5-d184-4927-a248-ff418be5a590","Update Subject Trainer":"d6fb2efb-eb52-4241-a602-21311697a7d6","List Available Trainers":"53195628-9391-4cb4-9fb5-4351ffc0d400","Remove Subject Trainer":"367d64d3-f1d1-41f0-a138-86097093aece"},"User Management":{"View User In Detail":"ba0ceff4-ebad-4502-b0d7-fa634422d0d9","Update User":"943fe305-c515-46c9-a37f-1c67d8d2dfff","Enable User":"09f0d24f-3579-4879-bb5f-8b90f7bcb1fa","Create User":"95526120-137a-4558-9a9b-9c51e09afe5f","View All Users":"a37fdff3-c227-4fd3-b06a-c7b4576abbd6","Disable User":"f66b25cb-3c6d-4de2-a8bb-de13b4822a27","Bulk Create Users":"97f6a122-b8fc-4e08-9c19-2ee5a64687df","Lookup Trainee Users":"63d91ccd-88f5-4976-8d1a-25c80682c426"}},ef=e=>{if(!e)return null;const t={"GET /users":"View All Users","GET /users/:userId":"View User In Detail","POST /users":"Create User","PUT /users/:userId":"Update User","DELETE /users/:userId":"Disable User","PATCH /users/:userId/enable":"Enable User","POST /users/bulk":"Bulk Create Users","GET /roles":"View All Roles","GET /roles/:roleId":"View Role In Detail","POST /roles":"Create Role","PUT /roles/:roleId":"Update Role","DELETE /roles/:roleId":"Disable Role","PATCH /roles/:roleId/enable":"Enable Role","GET /departments":"View All Departments","GET /departments/:departmentId":"View Department In Detail","POST /departments":"Create Department","PUT /departments/:departmentId":"Update Department","DELETE /departments/:departmentId":"Delete Department","PATCH /departments/:departmentId/enable":"Enable Department","GET /courses":"View All Courses","GET /courses/:id":"View Course In Detail","POST /courses":"Create Course","PUT /courses/:id":"Update Course","PATCH /courses/:courseId/archive":"Archive Course","GET /subjects":"List Subjects","GET /subjects/:id":"View Subject Detail","POST /subjects":"Create Subject","POST /subjects/bulk":"Create Bulk Subjects","PUT /subjects/:id":"Update Subject","PATCH /subjects/:subjectId/archive":"Archive Subject","GET /templates":"View All Templates","GET /templates/:id":"View Template Details","POST /templates":"Create Template","PUT /templates/:templateId":"Edit Template Basics","GET /templates/:id/schema":"View Template Schema","GET /templates/:id/pdf":"Download Content PDF","GET /templates/:id/config-pdf":"Download Configuration PDF","GET /assessments":"List Assessments","GET /assessments/user-events":"List Assessments","GET /assessments/:id":"View Assessment Details","GET /assessments/:id/sections":"View Assessment Sections","PATCH /assessments/:assessmentId/draft":"Save Section Values","POST /assessments/:assessmentId/submit":"Submit Assessment","GET /global-fields":"List Global Fields","GET /global-fields/detail":"View Global Field In Detail","POST /global-fields":"Create Global Field","PUT /global-fields/:fieldId":"Update Global Field","DELETE /global-fields/:fieldId":"Delete Global Field","GET /profile":"View My Profile","PUT /profile":"Update My Profile","PUT /profile/reset-password":"Change Password","GET /reports":"List All Reports","GET /reports/me":"List My Reports","GET /reports/:reportId":"View Report Detail","POST /reports":"Submit Report Request","PATCH /reports/:reportId/status":"Cancel Report","POST /reports/:reportId/respond":"Respond to Report","GET /dashboard":"Academic Overview Dashboard","GET /enrollments":"View Trainee Subject Enrollments","POST /enrollments":"Assign Trainees to Subject","DELETE /enrollments/:enrollmentId":"Remove Trainee from Subject","GET /trainees":"View All Users","GET /trainees/:id":"View User In Detail","PUT /trainees/:id":"Update User","DELETE /trainees/:id":"Disable User","PATCH /trainees/:id/toggle-status":"Enable User","GET /trainees/:id/courses":"View Trainee Subject Enrollments","GET /trainees/:id/subjects":"View Trainee Subject Enrollments","GET /trainees/:id/assessments":"List Assessments","POST /trainees/:id/enroll":"Assign Trainees to Subject","DELETE /trainees/:id/enroll/:courseId":"Remove Trainee from Subject","POST /trainees/bulk-import":"Bulk Create Users"};if(t[e])return t[e];for(const[r,a]of Object.entries(Op))for(const[n,i]of Object.entries(a))if(n===e)return n;for(const[r,a]of Object.entries(Op))for(const[n,i]of Object.entries(a)){const l=e.toLowerCase().replace(/\s+/g,""),o=n.toLowerCase().replace(/\s+/g,"");if(l===o||l.includes(o)||o.includes(l))return n}return null},t6=e=>{if(!e)return[];const t={"GET /users":"View All Users","GET /users/:userId":"View User In Detail","GET /roles":"View All Roles","GET /departments":"View All Departments","GET /templates":"View All Templates","GET /global-fields":"List Global Fields","GET /dashboard":"Academic Overview Dashboard","GET /profile":"View My Profile","GET /enrollments":"View Trainee Subject Enrollments","GET /assessments":"List Assessments","GET /assessments/user-events":"List Assessments","GET /assessments/:id":"View Assessment Details","GET /courses":"View All Courses","GET /departments/:departmentId":"View Department In Detail","GET /reports":"List All Reports","POST /reports":"Submit Report Request","GET /trainees":"View All Users","GET /trainees/:id":"View User In Detail","GET /trainees/:id/courses":"View Trainee Subject Enrollments","GET /trainees/:id/subjects":"View Trainee Subject Enrollments","GET /trainees/:id/assessments":"List Assessments"},r=[];for(const[a,n]of Object.entries(t))n===e&&r.push(a);for(const[a,n]of Object.entries(Op))for(const[i,l]of Object.entries(n))i===e&&r.push(i);return r},fe={ACADEMIC_OVERVIEW_DASHBOARD:"d39507ea-3417-4ffb-aedc-68bab2d02acc",VIEW_TRAINEE_SECTIONS:"d7ac0aac-0b33-4d72-ac24-3e4119ed4a80",CONFIRM_TRAINEE_PARTICIPATION:"19a0d973-8696-4666-b55f-a29aa055eab1",VIEW_SECTION_FIELDS:"cc86a51c-3fab-408b-9228-f50e0441208e",LIST_ASSESSMENTS:"d730195c-4b3f-42f1-81ea-8c67f0f713d6",DOWNLOAD_ASSESSMENT_RESULT:"6bf804cc-0e3b-44d7-aa52-978642791676",VIEW_ASSESSMENT_DETAILS:"28b97065-11aa-4b32-b7f6-51860d8ea9dc",VIEW_ASSESSMENT_SECTIONS:"12c43171-6490-4b7e-ad22-3a771e49b578",SAVE_SECTION_VALUES:"e85c7cd1-488f-4109-a6ce-b2edc2ea70ef",SUBMIT_ASSESSMENT:"5293ed3b-81b2-48d6-9503-601ba7d31e91",LIST_DEPARTMENT_ASSESSMENTS:"6ab61f21-d9f7-4ce6-a11c-36e3f20b3017",TOGGLE_TRAINEE_LOCK:"7429fdf5-3b60-41ad-8ce1-89bb3599af21",LIST_MY_ASSESSMENT_EVENTS:"322d4189-6ac6-4d35-9a8a-b25415e56a3c",CREATE_ASSESSMENT:"22521664-7e34-4d44-b652-a342521978bc",LIST_COURSE_ASSESSMENTS:"77688d98-7c3a-40c2-a225-70e8dbd05b62",UPDATE_ASSESSMENT_EVENT:"169d1fca-14f6-466c-af51-761cdfadb143",CREATE_BULK_ASSESSMENTS:"a060cea0-cf43-4d21-ba36-0f86def979a4",LIST_SUBJECT_ASSESSMENTS:"67bc4807-db01-43e4-b001-824f00121342",LIST_ASSESSMENT_EVENTS:"99afd2d0-0527-4cd4-af32-b66897fb723a",APPROVE_OR_REJECT_ASSESSMENT:"cdd76da5-54cd-44e2-b19c-fc0332922750",VIEW_COURSE_IN_DETAIL:"a8ff820f-39f1-4333-bf93-f63c1939c4e3",UPDATE_COURSE:"b8447d06-9c89-4076-befc-20a313f5cf37",VIEW_ALL_COURSES:"4e4e45cc-f5ab-493c-afca-704fc5ca1c8e",VIEW_TRAINEE_ENROLLMENTS:"435a9695-c895-460a-90e2-7eb56230ee7e",CREATE_COURSE:"3ec91d90-a90c-4fd6-9155-3cfd15602310",VIEW_ALL_COURSE_TRAINEES:"b9bc685d-37b4-4f62-98f7-815a9e6ec391",ARCHIVE_COURSE:"f133b97f-95cf-4203-baf6-6fe18888f25a",CREATE_DEPARTMENT:"93dc29ce-eee3-4db0-af26-2df69fa955ad",UPDATE_DEPARTMENT:"907525bd-9eda-4a82-86a2-85215ab56dce",ENABLE_DEPARTMENT:"3fe34cbc-5d6a-44f2-83b1-ba0640aa37df",VIEW_ALL_AVAILABLE_DEPARTMENT_HEADS:"88085c41-da90-4586-a255-bcb06c4682c2",DELETE_DEPARTMENT:"798ec1f8-16d8-4a09-8a69-2bc328e4a3ba",VIEW_DEPARTMENT_IN_DETAIL:"2fb86d25-e540-4bcc-bc83-60235a9d3b28",VIEW_ALL_DEPARTMENTS:"5c3308bf-fa48-4529-bd7f-382b79bcb3fa",FORCE_SAVE_ONLYOFFICE:"b88ca282-7d4b-41e6-ba19-bee3afc3f348",DELETE_IMAGE_FILE:"6eefe640-6db5-4d4d-8a0c-1ad9b37498ab",UPLOAD_IMAGES:"49ca5202-0fb9-46e9-b8a6-782f29cb7959",CREATE_IMAGE_PRESIGNED_URL:"70ddf99e-8222-4fa8-a751-59ee47cae064",UPLOAD_DOCUMENTS:"215d7a7b-7440-4ae9-a28c-41cacc355682",CREATE_DOCUMENT_PRESIGNED_URL:"916e8af7-10d9-432d-8478-c41a32949b39",SERVE_STATIC_FILES:"d55e91f5-1371-4694-8091-dff4f0fd7de7",SUBMIT_ONLYOFFICE_DOCUMENT:"e81e50c1-bbf3-4b36-a117-0f3f88875f3c",VIEW_MY_PROFILE:"1f1dfa5d-0b16-4842-bd4a-375bd5e3507b",UPDATE_MY_PROFILE:"a2aa9602-4028-4eef-b37a-86606944cb30",CHANGE_PASSWORD:"72ab7bd5-d100-4ec0-b61d-a3f9d68f2493",LIST_ALL_REPORTS:"8ecff2c2-85a5-44f6-af66-0d623e631762",LIST_MY_REPORTS:"ed674eb6-82eb-4763-8101-ac3119f91333",VIEW_REPORT_DETAIL:"7fe1ddef-3687-499e-9cf1-beb47688a73d",CANCEL_REPORT:"b93626eb-9946-413c-9b07-d3b10bf0a4f7",RESPOND_TO_REPORT:"3dc7f4db-561f-4188-a3af-87c3145f2fc0",ACKNOWLEDGE_REPORT_RECEIPT:"315d21ec-bdbc-4779-8a37-58d1cd467034",SUBMIT_REPORT_REQUEST:"b818f1a6-f26c-418b-a69b-01655371fe33",DISABLE_ROLE:"c846890f-650b-489d-bb0d-ee21d10ba43e",CREATE_ROLE:"b1dcd2d8-865d-485a-865e-87020331b822",ENABLE_ROLE:"d53c5201-1411-4e82-b697-ea46f46a3119",VIEW_ROLE_IN_DETAIL:"c92bd053-56e3-4008-b9ac-bcd8a88c4c0e",VIEW_ALL_ROLES:"8736fd6e-16e0-41b3-8e7b-a87913fa13d9",UPDATE_ROLE:"9b49fa83-deba-4581-8a34-2e4a04d76269",CREATE_BULK_SUBJECTS:"46a8e7d0-8730-44aa-9671-2505c6ac3a1d",CREATE_SUBJECT:"b10eaaec-18de-4c1f-bdb8-8bee7d0cc9d8",UPDATE_SUBJECT:"7f472c31-9297-432f-a35e-02ae8034043a",LIST_SUBJECTS:"44ae43b3-86a5-463c-94fb-f9f8d0c1d509",VIEW_SUBJECT_DETAIL:"c7fdefca-e5cc-44c0-981f-c67d8f953954",ARCHIVE_SUBJECT:"4b6360f8-b35a-4f99-acd0-4623082753de",VIEW_GLOBAL_FIELD:"39117be8-c2ee-45ed-9265-e64a459d7a08",VIEW_GLOBAL_FIELD_IN_DETAIL:"d9cdf419-2692-4dc5-955c-c3dc493bff47",DELETE_GLOBAL_FIELD:"8d027685-95c4-4e06-aca9-e9c8b61c01a0",LIST_GLOBAL_FIELDS:"a73c14c5-f421-4ca8-b158-98b7bb5e9b82",CREATE_GLOBAL_FIELD:"4b22149d-e523-466d-a453-f61c93b3c37f",UPDATE_GLOBAL_FIELD:"ba4ff600-a3f5-4af6-b7e9-9dd3891eef4e",VIEW_ALL_GLOBAL_FIELDS_IN_DETAIL:"9cc56078-8397-43ec-95eb-48cddb073641",UPDATE_TEMPLATE_STATUS:"bb0b4da6-cc88-4435-b787-07cde5d75e63",DOWNLOAD_CONTENT_PDF:"f38448de-d098-45e3-b35a-593fdf6f25aa",DOWNLOAD_CONTENT_CONFIG_ZIP:"3946dc2e-7684-43b7-8a8c-394fa388ab43",EDIT_TEMPLATE_BASICS:"2e52af89-13cc-4a9f-abb4-f7afb8f86a54",APPROVE_OR_REJECT_TEMPLATE:"55fdd4b1-fd32-47d8-ae03-2577844d1f35",DOWNLOAD_CONFIGURATION_PDF:"fda15717-4299-4a8a-bfcc-049aafbc7dbd",REFRESH_DRAFT_TEMPLATE:"19d0f64b-652d-41e5-bbf9-12596f4fd543",TEST_S3_PDF_EXPORT:"3aa69715-cbaa-4054-84e1-96404af597a7",EXTRACT_FIELDS_FROM_S3_DOCX:"6239b15a-6151-4663-8608-a423df6efc05",CREATE_TEMPLATE_VERSION:"20acccce-1602-4a52-b6ef-fba334b5469f",RESUBMIT_REJECTED_TEMPLATE:"92635536-34df-4219-b888-248736b0ebb0",VIEW_TEMPLATE_DETAILS:"cf33a670-ad98-4009-aaf9-266db41ac071",VIEW_ALL_TEMPLATES:"ff240b98-80c4-47f7-a9e7-177f3b2a9cda",CREATE_TEMPLATE:"73257d15-3b0c-4bbd-aaf7-3e59acc453db",VIEW_TEMPLATE_SCHEMA:"07421830-1902-4faa-a730-5d8d769bb970",VIEW_DEPARTMENT_TEMPLATES:"fa4f1f04-8e1c-42af-a06b-d8a906d513f9",PARSE_TEMPLATE_SCHEMA:"16d267aa-24db-4575-8351-88c2dffa2bfc",EXTRACT_FIELDS_FROM_UPLOAD:"331525aa-bbbc-4633-8123-eefb41b2e7b4",VIEW_TRAINEE_SUBJECT_ENROLLMENTS:"a527f342-93c6-45ff-9d49-b2622aba4d6a",REMOVE_COURSE_TRAINEE_ENROLLMENTS:"17f5d26b-e7a0-4713-9118-360e592ab058",VIEW_COURSE_ENROLLMENT_BATCHES:"1effc8f0-79ac-4388-a0af-282350baaaf9",REMOVE_COURSE_ENROLLMENT_BATCH:"a8aa0342-95fa-4c7c-8fbc-ca0ba603c59e",ASSIGN_TRAINEES_TO_SUBJECT:"9b65f280-d42b-482d-b8b1-f9ce726bf092",REMOVE_SUBJECT_ENROLLMENTS:"e8e146b1-363e-4941-932f-d8bdde56c65c",LOOKUP_SUBJECT_TRAINEES:"f45aa4e4-d932-450e-a823-f7ff381ca6b0",REMOVE_TRAINEE_FROM_SUBJECT:"dc19657c-3c88-471c-a18d-0114e0326b5a",REMOVE_TRAINEE_FROM_COURSE:"d510f9d6-0c7a-4576-b3e8-cd2dd2801102",ASSIGN_COURSE_TRAINER:"1095457e-655b-4f3d-a813-f2a5bdf9f9ab",CHANGE_COURSE_TRAINER_ROLE:"f57d9070-1f15-42fe-bd6e-808322399813",REMOVE_TRAINER_FROM_COURSE:"471dc251-274b-4fba-a0ff-6dcfe0bab528",ADD_TRAINERS_TO_SUBJECT:"9113ded5-d184-4927-a248-ff418be5a590",UPDATE_SUBJECT_TRAINER:"d6fb2efb-eb52-4241-a602-21311697a7d6",LIST_AVAILABLE_TRAINERS:"53195628-9391-4cb4-9fb5-4351ffc0d400",REMOVE_SUBJECT_TRAINER:"367d64d3-f1d1-41f0-a138-86097093aece",VIEW_USER_IN_DETAIL:"ba0ceff4-ebad-4502-b0d7-fa634422d0d9",UPDATE_USER:"943fe305-c515-46c9-a37f-1c67d8d2dfff",ENABLE_USER:"09f0d24f-3579-4879-bb5f-8b90f7bcb1fa",CREATE_USER:"95526120-137a-4558-9a9b-9c51e09afe5f",VIEW_ALL_USERS:"a37fdff3-c227-4fd3-b06a-c7b4576abbd6",DISABLE_USER:"f66b25cb-3c6d-4de2-a8bb-de13b4822a27",BULK_CREATE_USERS:"97f6a122-b8fc-4e08-9c19-2ee5a64687df",LOOKUP_TRAINEE_USERS:"63d91ccd-88f5-4976-8d1a-25c80682c426"},r6=e=>!e||typeof e!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e);Object.fromEntries(Object.entries(fe).map(([e,t])=>[t,e]));const ub=e=>{if(!e)return"";const t=e.split(" ");if(t.length>=2){const r=t[0],a=t[1],i=a.split("/").filter(c=>c&&!c.startsWith(":"))[0]||"Resource",o={GET:"View",POST:"Create",PUT:"Update",PATCH:"Update",DELETE:"Delete"}[r]||r;return a.includes("forgot-password")?"Forgot Password":a.includes("reset-password")?"Reset Password":a.includes("enable")?`Enable ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("archive")?`Archive ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("restore")?`Restore ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("add-trainers")?"Add Trainers to Department":a.includes("remove-trainers")?"Remove Trainers from Department":a.includes("new-feature")?"Create New Feature":a.includes("bulk-import")?"Bulk Import Data":a.includes("export-report")?"Export Report":s6(o,i,a)}return e},s6=(e,t,r)=>{if(r.includes("-")){const a=r.split("/").filter(l=>l&&!l.startsWith(":")),i=a[a.length-1].split("-").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ");return`${e} ${i}`}return`${e} ${t.charAt(0).toUpperCase()+t.slice(1)}`},to=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!1),[n,i]=v.useState(null),{userPermissions:l,userRole:o}=xs(),c=v.useCallback(async()=>{a(!0),i(null);try{l&&l.length>0?t(l):(t([]),console.log(" No userPermissions available"))}catch(C){console.error("Error setting permissions:",C),i(C),t([])}finally{a(!1)}},[l]),u=v.useCallback(()=>e.map(C=>({id:C.id,title:C.viewName||C.description||ub(C.name),description:C.description||"",module:C.module,method:C.method,path:C.path,isActive:C.isActive,viewName:C.viewName,viewModule:C.viewModule})),[e]),d=v.useCallback(()=>{const C=u(),A={};return C.forEach(D=>{const P=D.module,R=D.viewModule||`${D.module} Management`;A[P]||(A[P]={id:P,name:R,description:`Manage ${R.toLowerCase()} related permissions`,permissions:[]}),A[P].permissions.push({id:D.id,title:D.title,description:D.description,isActive:D.isActive,method:D.method,path:D.path})}),Object.values(A).sort((D,P)=>D.name.localeCompare(P.name))},[u]),m=v.useCallback(C=>{const A=e.find(D=>D.id===C);return A?A.isActive==="ACTIVE":!0},[e]),f=v.useCallback(C=>e.find(A=>A.id===C),[e]),x=v.useMemo(()=>!l||l.length===0?new Set:new Set(l.map(C=>C.name)),[l]),p=v.useMemo(()=>!l||l.length===0?new Set:new Set(l.map(C=>C.path)),[l]),h=v.useMemo(()=>!l||l.length===0?new Set:new Set(l.map(C=>C.id)),[l]),g=v.useCallback(C=>!l||l.length===0||!C||typeof C!="string"?!1:h.has(C),[h]),b=v.useCallback(C=>{if(!l||l.length===0||!C||typeof C!="string")return!1;if(r6(C))return h.has(C);const A=C;l.map(z=>{let k=null;return z.viewName?k=z.viewName:z.name?k=z.name:z.method&&z.path&&(k=`${z.method} ${z.path}`),k&&/^(GET|POST|PUT|PATCH|DELETE)\s+\//.test(k)&&ef(k)||k}).filter(Boolean);const D=new Set;if(l.forEach(z=>{if(z.name&&D.add(z.name),z.viewName&&D.add(z.viewName),z.method&&z.path){const k=`${z.method} ${z.path}`;D.add(k)}}),Array.from(D).some(z=>z&&_a(z)===_a(A)))return!0;const R=t6(A);if(R.length>0&&R.some(k=>!!(Array.from(D).some(G=>_a(G)===_a(k))&&ef(k)===A)))return!0;const M=Array.from(D).filter(z=>z&&/^(GET|POST|PUT|PATCH|DELETE)\s+\//.test(z));for(const z of M){const k=ef(z);if(k&&_a(k)===_a(A))return!0}if(ZP(A,Array.from(D)))return!0;const ae=(z=>{if(!z||typeof z!="string")return{method:null,path:""};const k=z.trim().split(/\s+/);if(k.length>=2){const O=k[0],G=k.slice(1).join(" ");return{method:O,path:G}}return{method:null,path:z}})(A),V=x.has(A),me=p.has(A),ue=h.has(A);if(V||me||ue||ae.method&&ae.path&&l.some(k=>{const O=k.method&&k.method.toUpperCase()===ae.method.toUpperCase();let G=!1;if(k.path)if(k.path===ae.path)G=!0;else{const Z=ee=>ee.replace(/:\w+/g,":param");(Z(k.path)===Z(ae.path)||k.name&&k.name.includes(ae.path.replace("/","")))&&(G=!0)}return O&&G}))return!0;const F=_a(A);return l.some(z=>{if(!z.name)return!1;const k=_a(z.name);if(F===k)return!0;if(/^(GET|POST|PUT|PATCH|DELETE)\s+\//.test(A)){const G=F.split(/[\s/:]+/).filter(Z=>Z.length>2&&!["get","post","put","patch","delete"].includes(Z));if(G.length>0)return G.some(ee=>k.includes(ee))}return!1})},[l,x,p,h]),j=v.useCallback(C=>{if(!l||l.length===0)return!1;const A=C.filter(D=>D&&typeof D=="string");return A.length===0?!1:A.some(D=>b(D))},[l,b]),y=v.useCallback(C=>{if(!l||l.length===0)return!1;const A=C.filter(D=>D&&typeof D=="string");return A.length===0?!1:A.every(D=>b(D))},[l,b]),w=v.useCallback(C=>!l||l.length===0?!1:l.some(A=>A.module===C),[l]),N=v.useCallback(()=>!l||l.length===0?[]:[...new Set(l.map(A=>A.module))],[l]),S=v.useCallback(()=>{if(!l||l.length===0)return[];const C=l.map(D=>({id:D.id,title:D.viewName||D.description||ub(D.name),description:D.description||"",module:D.module,method:D.method,path:D.path,isActive:D.isActive,viewName:D.viewName,viewModule:D.viewModule})),A={};return C.forEach(D=>{const P=D.module,R=D.viewModule||`${D.module} Management`;A[P]||(A[P]={id:P,name:R,description:`Manage ${R.toLowerCase()} related permissions`,permissions:[]}),A[P].permissions.push({id:D.id,title:D.title,description:D.description,isActive:D.isActive,method:D.method,path:D.path})}),Object.values(A).sort((D,P)=>D.name.localeCompare(P.name))},[l]);v.useEffect(()=>{c()},[c]);const E=v.useCallback(C=>{if(!l||l.length===0)return!1;const A=db(C);return A.length===0?!0:j(A)},[l,j]),_=v.useCallback(C=>db(C),[]),T=v.useCallback(C=>e6(C),[]);return{permissions:e,loading:r,error:n,fetchPermissions:c,getUIPermissions:u,getPermissionGroups:d,isPermissionActive:m,getApiPermission:f,hasPermission:b,hasPermissionById:g,hasAnyPermission:j,hasAllPermissions:y,hasModuleAccess:w,getAccessibleModules:N,getUserPermissionGroups:S,hasUCPermission:E,getUCPermissions:_,getPermissionUCs:T,userPermissions:l,userRole:o}},a6=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!1),[n,i]=v.useState(null),l=v.useCallback(async()=>{a(!0),i(null);try{const o=await XP.getPermissions({includeDeleted:!0});let c=null;if(o&&o.data&&o.data.modules&&Array.isArray(o.data.modules))c=o.data.modules;else if(Array.isArray(o))c=o;else if(o&&o.data&&Array.isArray(o.data))c=o.data;else if(o&&typeof o=="object"){const d=Object.keys(o).find(m=>Array.isArray(o[m]));d&&(c=o[d])}if(c&&Array.isArray(c)){const u=[];c.forEach(d=>{d.module&&d.module.listPermissions&&d.module.listPermissions.forEach(m=>{const f=m.id||m.permissionId;u.push({id:f,name:m.name,module:d.module.name,viewName:m.name,viewModule:d.module.name,isActive:!0})})}),t(u)}else t([])}catch(o){console.error("Error fetching all permissions from API:",o),i(o),t([])}finally{a(!1)}},[]);return{allPermissions:e,loading:r,error:n,fetchAllPermissions:l}};function zS(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=zS(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function Bt(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=zS(e))&&(a&&(a+=" "),a+=t);return a}function n6(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}n6(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var kc=e=>typeof e=="number"&&!isNaN(e),Yi=e=>typeof e=="string",kn=e=>typeof e=="function",i6=e=>Yi(e)||kc(e),Pp=e=>Yi(e)||kn(e)?e:null,l6=(e,t)=>e===!1||kc(e)&&e>0?e:t,Rp=e=>v.isValidElement(e)||Yi(e)||kn(e)||kc(e);function o6(e,t,r=300){let{scrollHeight:a,style:n}=e;requestAnimationFrame(()=>{n.minHeight="initial",n.height=a+"px",n.transition=`all ${r}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(t,r)})})}function c6({enter:e,exit:t,appendPosition:r=!1,collapse:a=!0,collapseDuration:n=300}){return function({children:i,position:l,preventExitTransition:o,done:c,nodeRef:u,isIn:d,playToast:m}){let f=r?`${e}--${l}`:e,x=r?`${t}--${l}`:t,p=v.useRef(0);return v.useLayoutEffect(()=>{let h=u.current,g=f.split(" "),b=j=>{j.target===u.current&&(m(),h.removeEventListener("animationend",b),h.removeEventListener("animationcancel",b),p.current===0&&j.type!=="animationcancel"&&h.classList.remove(...g))};h.classList.add(...g),h.addEventListener("animationend",b),h.addEventListener("animationcancel",b)},[]),v.useEffect(()=>{let h=u.current,g=()=>{h.removeEventListener("animationend",g),a?o6(h,c,n):c()};d||(o?g():(p.current=1,h.className+=` ${x}`,h.addEventListener("animationend",g)))},[d]),J.createElement(J.Fragment,null,i)}}function mb(e,t){return{content:US(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function US(e,t,r=!1){return v.isValidElement(e)&&!Yi(e.type)?v.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):kn(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function d6({closeToast:e,theme:t,ariaLabel:r="close"}){return J.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:a=>{a.stopPropagation(),e(!0)},"aria-label":r},J.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},J.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function u6({delay:e,isRunning:t,closeToast:r,type:a="default",hide:n,className:i,controlledProgress:l,progress:o,rtl:c,isIn:u,theme:d}){let m=n||l&&o===0,f={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};l&&(f.transform=`scaleX(${o})`);let x=Bt("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":c}),p=kn(i)?i({rtl:c,type:a,defaultClassName:x}):Bt(x,i),h={[l&&o>=1?"onTransitionEnd":"onAnimationEnd"]:l&&o<1?null:()=>{u&&r()}};return J.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":m},J.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${a}`}),J.createElement("div",{role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:p,style:f,...h}))}var m6=1,$S=()=>`${m6++}`;function f6(e,t,r){let a=1,n=0,i=[],l=[],o=t,c=new Map,u=new Set,d=j=>(u.add(j),()=>u.delete(j)),m=()=>{l=Array.from(c.values()),u.forEach(j=>j())},f=({containerId:j,toastId:y,updateId:w})=>{let N=j?j!==e:e!==1,S=c.has(y)&&w==null;return N||S},x=(j,y)=>{c.forEach(w=>{var N;(y==null||y===w.props.toastId)&&((N=w.toggle)==null||N.call(w,j))})},p=j=>{var y,w;(w=(y=j.props)==null?void 0:y.onClose)==null||w.call(y,j.removalReason),j.isActive=!1},h=j=>{if(j==null)c.forEach(p);else{let y=c.get(j);y&&p(y)}m()},g=()=>{n-=i.length,i=[]},b=j=>{var y,w;let{toastId:N,updateId:S}=j.props,E=S==null;j.staleId&&c.delete(j.staleId),j.isActive=!0,c.set(N,j),m(),r(mb(j,E?"added":"updated")),E&&((w=(y=j.props).onOpen)==null||w.call(y))};return{id:e,props:o,observe:d,toggle:x,removeToast:h,toasts:c,clearQueue:g,buildToast:(j,y)=>{if(f(y))return;let{toastId:w,updateId:N,data:S,staleId:E,delay:_}=y,T=N==null;T&&n++;let C={...o,style:o.toastStyle,key:a++,...Object.fromEntries(Object.entries(y).filter(([D,P])=>P!=null)),toastId:w,updateId:N,data:S,isIn:!1,className:Pp(y.className||o.toastClassName),progressClassName:Pp(y.progressClassName||o.progressClassName),autoClose:y.isLoading?!1:l6(y.autoClose,o.autoClose),closeToast(D){c.get(w).removalReason=D,h(w)},deleteToast(){let D=c.get(w);if(D!=null){if(r(mb(D,"removed")),c.delete(w),n--,n<0&&(n=0),i.length>0){b(i.shift());return}m()}}};C.closeButton=o.closeButton,y.closeButton===!1||Rp(y.closeButton)?C.closeButton=y.closeButton:y.closeButton===!0&&(C.closeButton=Rp(o.closeButton)?o.closeButton:!0);let A={content:j,props:C,staleId:E};o.limit&&o.limit>0&&n>o.limit&&T?i.push(A):kc(_)?setTimeout(()=>{b(A)},_):b(A)},setProps(j){o=j},setToggle:(j,y)=>{let w=c.get(j);w&&(w.toggle=y)},isToastActive:j=>{var y;return(y=c.get(j))==null?void 0:y.isActive},getSnapshot:()=>l}}var qs=new Map,Jo=[],Lp=new Set,h6=e=>Lp.forEach(t=>t(e)),WS=()=>qs.size>0;function p6(){Jo.forEach(e=>VS(e.content,e.options)),Jo=[]}var x6=(e,{containerId:t})=>{var r;return(r=qs.get(t||1))==null?void 0:r.toasts.get(e)};function HS(e,t){var r;if(t)return!!((r=qs.get(t))!=null&&r.isToastActive(e));let a=!1;return qs.forEach(n=>{n.isToastActive(e)&&(a=!0)}),a}function g6(e){if(!WS()){Jo=Jo.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||i6(e))qs.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=qs.get(e.containerId);t?t.removeToast(e.id):qs.forEach(r=>{r.removeToast(e.id)})}}var v6=(e={})=>{qs.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function VS(e,t){Rp(e)&&(WS()||Jo.push({content:e,options:t}),qs.forEach(r=>{r.buildToast(e,t)}))}function b6(e){var t;(t=qs.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function GS(e,t){qs.forEach(r=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===r.id)&&r.toggle(e,t?.id)})}function y6(e){let t=e.containerId||1;return{subscribe(r){let a=f6(t,e,h6);qs.set(t,a);let n=a.observe(r);return p6(),()=>{n(),qs.delete(t)}},setProps(r){var a;(a=qs.get(t))==null||a.setProps(r)},getSnapshot(){var r;return(r=qs.get(t))==null?void 0:r.getSnapshot()}}}function j6(e){return Lp.add(e),()=>{Lp.delete(e)}}function w6(e){return e&&(Yi(e.toastId)||kc(e.toastId))?e.toastId:$S()}function Dc(e,t){return VS(e,t),t.toastId}function sm(e,t){return{...t,type:t&&t.type||e,toastId:w6(t)}}function am(e){return(t,r)=>Dc(t,sm(e,r))}function te(e,t){return Dc(e,sm("default",t))}te.loading=(e,t)=>Dc(e,sm("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function N6(e,{pending:t,error:r,success:a},n){let i;t&&(i=Yi(t)?te.loading(t,n):te.loading(t.render,{...n,...t}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},o=(u,d,m)=>{if(d==null){te.dismiss(i);return}let f={type:u,...l,...n,data:m},x=Yi(d)?{render:d}:d;return i?te.update(i,{...f,...x}):te(x.render,{...f,...x}),m},c=kn(e)?e():e;return c.then(u=>o("success",a,u)).catch(u=>o("error",r,u)),c}te.promise=N6;te.success=am("success");te.info=am("info");te.error=am("error");te.warning=am("warning");te.warn=te.warning;te.dark=(e,t)=>Dc(e,sm("default",{theme:"dark",...t}));function S6(e){g6(e)}te.dismiss=S6;te.clearWaitingQueue=v6;te.isActive=HS;te.update=(e,t={})=>{let r=x6(e,t);if(r){let{props:a,content:n}=r,i={delay:100,...a,...t,toastId:t.toastId||e,updateId:$S()};i.toastId!==e&&(i.staleId=e);let l=i.render||n;delete i.render,Dc(l,i)}};te.done=e=>{te.update(e,{progress:1})};te.onChange=j6;te.play=e=>GS(!0,e);te.pause=e=>GS(!1,e);function E6(e){var t;let{subscribe:r,getSnapshot:a,setProps:n}=v.useRef(y6(e)).current;n(e);let i=(t=v.useSyncExternalStore(r,a,a))==null?void 0:t.slice();function l(o){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(u=>{let{position:d}=u.props;c.has(d)||c.set(d,[]),c.get(d).push(u)}),Array.from(c,u=>o(u[0],u[1]))}return{getToastToRender:l,isToastActive:HS,count:i?.length}}function T6(e){let[t,r]=v.useState(!1),[a,n]=v.useState(!1),i=v.useRef(null),l=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:c,closeToast:u,onClick:d,closeOnClick:m}=e;b6({id:e.toastId,containerId:e.containerId,fn:r}),v.useEffect(()=>{if(e.pauseOnFocusLoss)return f(),()=>{x()}},[e.pauseOnFocusLoss]);function f(){document.hasFocus()||b(),window.addEventListener("focus",g),window.addEventListener("blur",b)}function x(){window.removeEventListener("focus",g),window.removeEventListener("blur",b)}function p(E){if(e.draggable===!0||e.draggable===E.pointerType){j();let _=i.current;l.canCloseOnClick=!0,l.canDrag=!0,_.style.transition="none",e.draggableDirection==="x"?(l.start=E.clientX,l.removalDistance=_.offsetWidth*(e.draggablePercent/100)):(l.start=E.clientY,l.removalDistance=_.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function h(E){let{top:_,bottom:T,left:C,right:A}=i.current.getBoundingClientRect();E.nativeEvent.type!=="touchend"&&e.pauseOnHover&&E.clientX>=C&&E.clientX<=A&&E.clientY>=_&&E.clientY<=T?b():g()}function g(){r(!0)}function b(){r(!1)}function j(){l.didMove=!1,document.addEventListener("pointermove",w),document.addEventListener("pointerup",N)}function y(){document.removeEventListener("pointermove",w),document.removeEventListener("pointerup",N)}function w(E){let _=i.current;if(l.canDrag&&_){l.didMove=!0,t&&b(),e.draggableDirection==="x"?l.delta=E.clientX-l.start:l.delta=E.clientY-l.start,l.start!==E.clientX&&(l.canCloseOnClick=!1);let T=e.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`;_.style.transform=`translate3d(${T},0)`,_.style.opacity=`${1-Math.abs(l.delta/l.removalDistance)}`}}function N(){y();let E=i.current;if(l.canDrag&&l.didMove&&E){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance){n(!0),e.closeToast(!0),e.collapseAll();return}E.style.transition="transform 0.2s, opacity 0.2s",E.style.removeProperty("transform"),E.style.removeProperty("opacity")}}let S={onPointerDown:p,onPointerUp:h};return o&&c&&(S.onMouseEnter=b,e.stacked||(S.onMouseLeave=g)),m&&(S.onClick=E=>{d&&d(E),l.canCloseOnClick&&u(!0)}),{playToast:g,pauseToast:b,isRunning:t,preventExitTransition:a,toastRef:i,eventHandlers:S}}var A6=typeof window<"u"?v.useLayoutEffect:v.useEffect,nm=({theme:e,type:t,isLoading:r,...a})=>J.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...a});function C6(e){return J.createElement(nm,{...e},J.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function _6(e){return J.createElement(nm,{...e},J.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function k6(e){return J.createElement(nm,{...e},J.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function D6(e){return J.createElement(nm,{...e},J.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function I6(){return J.createElement("div",{className:"Toastify__spinner"})}var Fp={info:_6,warning:C6,success:k6,error:D6,spinner:I6},O6=e=>e in Fp;function P6({theme:e,type:t,isLoading:r,icon:a}){let n=null,i={theme:e,type:t};return a===!1||(kn(a)?n=a({...i,isLoading:r}):v.isValidElement(a)?n=v.cloneElement(a,i):r?n=Fp.spinner():O6(t)&&(n=Fp[t](i))),n}var R6=e=>{let{isRunning:t,preventExitTransition:r,toastRef:a,eventHandlers:n,playToast:i}=T6(e),{closeButton:l,children:o,autoClose:c,onClick:u,type:d,hideProgressBar:m,closeToast:f,transition:x,position:p,className:h,style:g,progressClassName:b,updateId:j,role:y,progress:w,rtl:N,toastId:S,deleteToast:E,isIn:_,isLoading:T,closeOnClick:C,theme:A,ariaLabel:D}=e,P=Bt("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":N},{"Toastify__toast--close-on-click":C}),R=kn(h)?h({rtl:N,position:p,type:d,defaultClassName:P}):Bt(P,h),M=P6(e),X=!!w||!c,ie={closeToast:f,type:d,theme:A},ae=null;return l===!1||(kn(l)?ae=l(ie):v.isValidElement(l)?ae=v.cloneElement(l,ie):ae=d6(ie)),J.createElement(x,{isIn:_,done:E,position:p,preventExitTransition:r,nodeRef:a,playToast:i},J.createElement("div",{id:S,tabIndex:0,onClick:u,"data-in":_,className:R,...n,style:g,ref:a,..._&&{role:y,"aria-label":D}},M!=null&&J.createElement("div",{className:Bt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!T})},M),US(o,e,!t),ae,!e.customProgressBar&&J.createElement(u6,{...j&&!X?{key:`p-${j}`}:{},rtl:N,theme:A,delay:c,isRunning:t,isIn:_,closeToast:f,hide:m,type:d,className:b,controlledProgress:X,progress:w||0})))},L6=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),F6=c6(L6("bounce",!0)),M6={position:"top-right",transition:F6,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function B6(e){let t={...M6,...e},r=e.stacked,[a,n]=v.useState(!0),i=v.useRef(null),{getToastToRender:l,isToastActive:o,count:c}=E6(t),{className:u,style:d,rtl:m,containerId:f,hotKeys:x}=t;function p(g){let b=Bt("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":m});return kn(u)?u({position:g,rtl:m,defaultClassName:b}):Bt(b,Pp(u))}function h(){r&&(n(!0),te.play())}return A6(()=>{var g;if(r){let b=i.current.querySelectorAll('[data-in="true"]'),j=12,y=(g=t.position)==null?void 0:g.includes("top"),w=0,N=0;Array.from(b).reverse().forEach((S,E)=>{let _=S;_.classList.add("Toastify__toast--stacked"),E>0&&(_.dataset.collapsed=`${a}`),_.dataset.pos||(_.dataset.pos=y?"top":"bot");let T=w*(a?.2:1)+(a?0:j*E);_.style.setProperty("--y",`${y?T:T*-1}px`),_.style.setProperty("--g",`${j}`),_.style.setProperty("--s",`${1-(a?N:0)}`),w+=_.offsetHeight,N+=.025})}},[a,c,r]),v.useEffect(()=>{function g(b){var j;let y=i.current;x(b)&&((j=y.querySelector('[tabIndex="0"]'))==null||j.focus(),n(!1),te.pause()),b.key==="Escape"&&(document.activeElement===y||y!=null&&y.contains(document.activeElement))&&(n(!0),te.play())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[x]),J.createElement("section",{ref:i,className:"Toastify",id:f,onMouseEnter:()=>{r&&(n(!1),te.pause())},onMouseLeave:h,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},l((g,b)=>{let j=b.length?{...d}:{...d,pointerEvents:"none"};return J.createElement("div",{tabIndex:-1,className:p(g),"data-stacked":r,style:j,key:`c-${g}`},b.map(({content:y,props:w})=>J.createElement(R6,{...w,stacked:r,collapseAll:h,isIn:o(w.toastId,w.containerId),key:`t-${w.key}`},y)))}))}const sn=e=>e.map(t=>({id:t.id,name:t.name,code:t.code,type:t.code,description:t.description,departmentHeadId:t.headUserId,departmentHead:t.headUser?{id:t.headUser.id,name:t.headUser.name||t.headUser.email,email:t.headUser.email,role:t.headUser.role}:null,status:t.isActive===!0?"ACTIVE":"INACTIVE",coursesCount:t.courseCount||t.coursesCount||0,traineesCount:t.traineeCount||t.traineesCount||0,trainersCount:t.trainerCount||t.trainersCount||0,createdAt:t.createdAt,updatedAt:t.updatedAt,deletedAt:t.deletedAt})),Qx=(e=!0)=>{const[t,r]=v.useState([]),[a,n]=v.useState([]),[i,l]=v.useState(!1),[o,c]=v.useState(null),[u,d]=v.useState(""),[m,f]=v.useState({type:"",status:""}),[x,p]=v.useState({key:null,direction:"asc"}),[h,g]=v.useState([]);v.useEffect(()=>{if(!e)return;(async()=>{l(!0),c(null);try{const ae=(await Mt.getDepartments()).departments||[],V=sn(ae);r(V)}catch(ie){console.error("Error loading departments:",ie),c("Failed to load departments"),r([])}finally{l(!1)}})()},[e]),v.useEffect(()=>{let X=t;u&&(X=X.filter(ie=>ie.name.toLowerCase().includes(u.toLowerCase())||ie.code.toLowerCase().includes(u.toLowerCase())||ie.description.toLowerCase().includes(u.toLowerCase()))),m.type&&(X=X.filter(ie=>ie.type===m.type)),m.status&&(X=X.filter(ie=>ie.status===m.status)),n(X)},[t,u,m]);const b=X=>{let ie="asc";x.key===X&&x.direction==="asc"&&(ie="desc"),p({key:X,direction:ie});const ae=[...a].sort((V,me)=>V[X]<me[X]?ie==="asc"?-1:1:V[X]>me[X]?ie==="asc"?1:-1:0);n(ae)},j=async X=>{l(!0),c(null);try{const ie=await Mt.createDepartment(X),V=(await Mt.getDepartments()).departments||[],me=sn(V);return r(me),ie}catch(ie){throw console.error("Error creating department:",ie),c("Failed to create department"),ie}finally{l(!1)}},y=async(X,ie)=>{l(!0),c(null);try{const ae=await Mt.updateDepartment(X,ie),me=(await Mt.getDepartments()).departments||[],ue=sn(me);return r(ue),ae}catch(ae){throw console.error("Error updating department:",ae),c("Failed to update department"),ae}finally{l(!1)}},w=async X=>{l(!0),c(null);try{await Mt.deleteDepartment(X);const ae=(await Mt.getDepartments()).departments||[],V=sn(ae);r(V)}catch(ie){throw console.error("Error deleting department:",ie),c("Failed to delete department"),ie}finally{l(!1)}},N=async X=>{l(!0),c(null);try{await Mt.toggleDepartmentStatus(X);const ae=(await Mt.getDepartments()).departments||[],V=sn(ae);r(V)}catch(ie){throw console.error("Error toggling department status:",ie),te.error("Failed to toggle department status"),ie}finally{l(!1)}},S=async X=>{l(!0),c(null);try{await Mt.disableDepartment(X);const ae=(await Mt.getDepartments()).departments||[],V=sn(ae);r(V)}catch(ie){throw console.error("Error disabling department:",ie),te.error("Failed to disable department"),ie}finally{l(!1)}},E=async X=>{l(!0),c(null);try{await Mt.enableDepartment(X);const ae=(await Mt.getDepartments()).departments||[],V=sn(ae);r(V)}catch(ie){throw console.error("Error enabling department:",ie),te.error("Failed to enable department"),ie}finally{l(!1)}},_=async X=>{l(!0),c(null);try{await Mt.bulkDeleteDepartments(X);const ae=(await Mt.getDepartments()).departments||[],V=sn(ae);r(V),g([])}catch(ie){throw console.error("Error bulk deleting departments:",ie),te.error("Failed to delete departments"),ie}finally{l(!1)}},T=async(X,ie)=>{l(!0),c(null);try{await Mt.bulkToggleStatus(X,ie);const V=(await Mt.getDepartments()).departments||[],me=sn(V);r(me),g([])}catch(ae){throw console.error("Error bulk toggling department status:",ae),te.error("Failed to update department status"),ae}finally{l(!1)}},C=X=>{g(ie=>ie.includes(X)?ie.filter(ae=>ae!==X):[...ie,X])},A=()=>{h.length===a.length?g([]):g(a.map(X=>X.id))},D=(X,ie)=>{f(ae=>({...ae,[X]:ie}))},P=()=>{f({type:"",status:""}),d("")},R=v.useCallback(async()=>{try{return(await Mt.getDepartmentHeads())?.users||[]}catch(X){return console.error("Error fetching department heads:",X),te.error("Failed to load department heads"),[]}},[]);return{departments:a,selectedDepartments:h,loading:i,error:o,searchTerm:u,setSearchTerm:d,filters:m,sortConfig:x,createDepartment:j,updateDepartment:y,deleteDepartment:w,toggleDepartmentStatus:N,disableDepartment:S,enableDepartment:E,bulkDeleteDepartments:_,bulkToggleStatus:T,sortDepartments:b,handleSelectDepartment:C,handleSelectAll:A,handleFilterChange:D,clearFilters:P,getAvailableUsers:R,refreshDepartments:async()=>{l(!0),c(null);try{const ie=(await Mt.getDepartments()).departments||[],ae=sn(ie);r(ae)}catch(X){console.error("Error refreshing departments:",X),c("Failed to refresh departments")}finally{l(!1)}},setError:c}},fb=({collapsed:e,onClose:t})=>{const{hasPermission:r,hasAnyPermission:a}=to(),{user:n}=xs(),i=za(),l=Ge(),o=r(fe.ACADEMIC_OVERVIEW_DASHBOARD),c=()=>{if(!n?.role)return!1;const _=(typeof n.role=="string"?n.role:n.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();return _==="ADMIN"||_==="ADMINISTRATOR"},u=()=>{if(!n?.role)return!1;const _=(typeof n.role=="string"?n.role:n.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();return _==="ACADEMIC_DEPARTMENT"||_==="ACADEMIC_DEPT"||_.startsWith("ACADEMIC")},d=()=>n?.role?(typeof n.role=="string"?n.role:n.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim()==="TRAINER":!1,m=()=>{if(!n?.role)return!1;const _=(typeof n.role=="string"?n.role:n.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();return _==="DEPARTMENT_HEAD"||_==="DEPT_HEAD"||_==="DEPARTMENT HEAD"},f=()=>n?.role?(typeof n.role=="string"?n.role:n.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim()==="TRAINEE":!1,{departments:x,loading:p}=Qx(o),[h,g]=v.useState(!1),[b,j]=v.useState(!1),[y,w]=v.useState(!1),N=v.useRef(null);v.useEffect(()=>{if(N.current&&h){const E=N.current,_=E.scrollHeight>E.clientHeight;w(_)}},[h,x]);const S=v.useMemo(()=>{const E=["main-menu","users","roles","departments","forms","system-config"],_=["academic-dashboard"],T=["upcoming-assessments","assessment-results","instructed-courses"],C=["department-dashboard","my-department-details","assessment-review-requests"],A=["trainee-dashboard","enrolled-courses","all-assessments","create-issue"];return[{id:"main-menu",label:"Main Menu",icon:Hx,path:he.MAIN_MENU,isAdminOnly:!0},{id:"users",label:"User Management",icon:$r,path:he.USERS,permissions:[fe.VIEW_ALL_USERS,fe.CREATE_USER,fe.UPDATE_USER,fe.DISABLE_USER,fe.ENABLE_USER],requireAll:!1},{id:"roles",label:"Role Management",icon:qx,path:he.ROLES,permission:fe.VIEW_ALL_ROLES},{id:"departments",label:"Departments",icon:Ls,path:he.DEPARTMENTS,permission:fe.VIEW_ALL_DEPARTMENTS},{id:"forms",label:"Template List",icon:vt,path:he.TEMPLATES,permission:fe.VIEW_ALL_TEMPLATES},{id:"system-config",label:"System Configuration",icon:Y2,path:he.SYSTEM_CONFIG,permission:fe.LIST_GLOBAL_FIELDS},{id:"academic-dashboard",label:"Academic Dashboard",icon:X2,path:"/academic/dashboard",permission:fe.ACADEMIC_OVERVIEW_DASHBOARD},{id:"trainee-dashboard",label:"Trainee Dashboard",icon:Ia,path:he.DASHBOARD,permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS},{id:"enrolled-courses",label:"Enrolled Course List",icon:Ia,path:he.COURSES_ENROLLED,permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS},{id:"all-assessments",label:"All Assessments",icon:Ia,path:he.ASSESSMENTS_MY_ASSESSMENTS,permissions:[fe.LIST_ASSESSMENTS,"GET /assessments/user-events"],requireAll:!1,children:[{id:"your-assessments",label:"Your Assessments",path:he.ASSESSMENTS_MY_ASSESSMENTS,permissions:[fe.LIST_ASSESSMENTS,"GET /assessments/user-events"],requireAll:!1},{id:"signature-required",label:"Signature Required List",path:he.ASSESSMENTS_SIGNATURE_REQUIRED,permissions:[fe.LIST_ASSESSMENTS,"GET /assessments/user-events"],requireAll:!1},{id:"completion-required",label:"Section Completion Required List",path:he.ASSESSMENTS_COMPLETION_REQUIRED,permissions:[fe.LIST_ASSESSMENTS,"GET /assessments/user-events"],requireAll:!1}]},{id:"create-issue",label:"Create Incident/Feedback Report",icon:Ia,path:he.REPORTS_CREATE,permission:fe.SUBMIT_REPORT_REQUEST},{id:"upcoming-assessments",label:"List Upcoming Assessment",icon:Qe,path:he.ASSESSMENTS_UPCOMING,permission:fe.LIST_ASSESSMENTS},{id:"assessment-results",label:"List Assessment Result",icon:Je,path:he.ASSESSMENTS_RESULTS,permission:fe.LIST_ASSESSMENTS},{id:"instructed-courses",label:"List Instructed Course",icon:It,path:he.COURSES_INSTRUCTED,permission:fe.VIEW_ALL_COURSES},{id:"department-dashboard",label:"Department Dashboard",icon:Ls,path:"/department-head/dashboard",permission:fe.VIEW_DEPARTMENT_IN_DETAIL},{id:"my-department-details",label:"My Department Details",icon:It,path:he.DEPARTMENT_MY_DETAILS,permission:fe.VIEW_DEPARTMENT_IN_DETAIL},{id:"assessment-review-requests",label:"List Assessment Review Requests",icon:Ht,path:he.DEPARTMENT_REVIEW_REQUESTS,permission:fe.LIST_ASSESSMENTS},{id:"issue-list",label:"Issue List",icon:Er,path:he.REPORTS_ISSUES,permission:fe.LIST_ALL_REPORTS},{id:"feedback-list",label:"Feedback List",icon:B2,path:he.REPORTS_FEEDBACK,permission:fe.LIST_ALL_REPORTS},{id:"template-list",label:"Template List",icon:Ju,path:he.TEMPLATES,permission:fe.VIEW_ALL_TEMPLATES,children:[{id:"template-history",label:"List History Version",path:"/sqa/templates/history",permission:fe.VIEW_TEMPLATE_DETAILS},{id:"template-sections",label:"Section List",path:"/sqa/templates/sections",permission:fe.VIEW_TEMPLATE_DETAILS},{id:"template-fields",label:"Field List",path:"/sqa/templates/fields",permission:fe.VIEW_TEMPLATE_DETAILS},{id:"template-export",label:"PDF Preview for Export",path:"/sqa/templates/export",permission:fe.DOWNLOAD_CONTENT_PDF}]}].filter(P=>{if(c())return P.isAdminOnly?!0:E.includes(P.id);if(u())return _.includes(P.id);if(d())return T.includes(P.id);if(m())return C.includes(P.id);if(f())return A.includes(P.id);if(P.isAdminOnly)return!1;if(!P.permission&&(!P.permissions||P.permissions.length===0))return!0;let R=!1;if(P.permissions&&P.permissions.length>0?R=P.requireAll?P.permissions.every(M=>r(M)):a(P.permissions):P.permission&&(R=r(P.permission)),P.children&&P.children.length>0){const M=P.children.some(X=>X.permissions&&X.permissions.length>0?a(X.permissions):X.permission?r(X.permission):!0);return R||M}return R}).map(P=>{if(P.id==="all-assessments"&&P.children&&P.children.length>0){const R=P.children;return{...P,children:R}}return P.children&&P.children.length>0?{...P,children:P.children.filter(R=>R.permissions&&R.permissions.length>0?a(R.permissions):R.permission?r(R.permission):!0)}:P})},[r,a,n?.role,c,u,d,m,f]);return s.jsxs("div",{className:`bg-primary-custom text-white d-flex flex-column transition-all ${e?"sidebar-collapsed":""}`,style:{width:e?"60px":"260px",minHeight:"100vh",transition:"width 0.3s ease",position:"fixed",top:0,left:0,height:"100vh",overflowY:"hidden",overflowX:"hidden",zIndex:1e3,flexShrink:0},children:[s.jsxs("div",{className:"p-3 border-bottom border-secondary bg-gradient-primary-custom position-relative",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[!e&&s.jsx(s.Fragment,{children:s.jsx("img",{src:hO,alt:"Logo",style:{width:"50%",marginRight:"0px"}})}),e&&s.jsx("div",{children:s.jsx(L2,{size:24})})]}),t&&s.jsx(se,{variant:"link",className:"position-absolute top-0 end-0 text-white p-2 d-md-none",onClick:t,style:{border:"none",background:"transparent"},children:s.jsx(Xe,{size:20})})]}),s.jsxs(pt,{className:"flex-column flex-grow-1 p-3 bg-gradient-primary-custom",children:[S.map(E=>{const _=E.icon,T=i.pathname===E.path;let C=!1;return E.id==="all-assessments"&&(E.permissions&&E.permissions.length>0?C=a(E.permissions):E.permission&&(C=r(E.permission))),E.id,E.id==="all-assessments"&&C?s.jsx(pt.Item,{className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(l(he.ASSESSMENTS_MY_ASSESSMENTS),t()):j(!b)},children:[s.jsx(_,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:E.label}),s.jsx(ni,{size:16,className:`ms-auto transition-transform ${b?"rotate-180":""}`,style:{transition:"transform 0.3s ease"}})]})]}),!e&&b&&E.children&&E.children.length>0&&s.jsx("div",{className:"mt-2 ms-4",children:E.children.map(A=>s.jsx(ad,{to:A.path,className:"sidebar-nav-link text-white d-flex align-items-center py-2 pe-1 rounded nav-link",style:{backgroundColor:i.pathname===A.path?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:"normal",overflowWrap:"break-word"},onClick:t,children:s.jsx("span",{className:"sidebar-nav-label",children:A.label})},A.id))}),!e&&b&&(!E.children||E.children.length===0)&&s.jsx("div",{className:"mt-2 ms-4 text-white-50 small",children:"No children available"})]})},E.id):s.jsx(pt.Item,{className:"mb-3",children:s.jsxs(ad,{to:E.path,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${T?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:T?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",overflowWrap:e?"normal":"break-word"},onClick:()=>{t()},children:[s.jsx(_,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsx("span",{className:"sidebar-nav-label",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:E.label})]})},E.id)}),!c()&&o&&s.jsx(pt.Item,{className:"mb-3",children:s.jsxs(ad,{to:he.ASSESSMENT_EVENTS,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname===he.ASSESSMENT_EVENTS?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname===he.ASSESSMENT_EVENTS?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",overflowWrap:e?"normal":"break-word"},onClick:()=>{t()},children:[s.jsx(Ra,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsx("span",{className:"sidebar-nav-label",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:"Assessment Event"})]})}),!c()&&o&&s.jsx(pt.Item,{className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/academic/departments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/academic/departments")?"rgba(255, 255, 255, 0.1)":"transparent"},children:[s.jsx(Ls,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{cursor:"pointer",overflowWrap:"break-word",lineHeight:"1.2"},onClick:()=>{g(!h),l("/academic/departments")},children:"Department"}),s.jsx(ni,{size:16,className:"ms-auto",style:{transition:"transform 0.3s ease",cursor:"pointer",transform:h?"rotate(180deg)":"rotate(0deg)"},onClick:()=>{g(!h)}})]})]}),!e&&h&&s.jsx("div",{ref:N,className:`position-absolute start-0 end-0 mt-1 sidebar-department-dropdown ${y?"scrollable":""}`,style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:p?s.jsx("div",{className:"px-3 py-2 text-white-50 sidebar-department-loading",children:s.jsx("small",{children:"Loading departments..."})}):x.length>0?x.map(E=>s.jsxs(ad,{to:`/academic/course/${E.id}`,className:`d-block px-3 py-2 text-white text-decoration-none d-flex align-items-center sidebar-department-item ${i.pathname===`/academic/course/${E.id}`?"active":""}`,style:{fontSize:"0.875rem",backgroundColor:i.pathname===`/academic/course/${E.id}`?"rgba(255, 255, 255, 0.15)":"transparent",overflowWrap:"break-word",whiteSpace:"normal"},onClick:()=>{t&&t()},children:[s.jsx(Xu,{size:12,className:"me-2 sidebar-department-chevron"}),E.code]},E.id)):s.jsx("div",{className:"px-3 py-2 text-white-50",children:s.jsx("small",{children:"No departments found"})})})]})})]})]})},si={getProfile:async()=>{try{const e=await Ce.get("/profile");return e.data&&e.data.data?e.data.data:e.data}catch(e){throw console.error("Error fetching profile:",e),e}},updateAvatar:async(e,t)=>{try{const a={...t||await si.getProfile(),avatarUrl:e};a.address||(a.address=""),a.phoneNumber||(a.phoneNumber=""),a.avatarUrl||(a.avatarUrl=""),a.firstName||(a.firstName=""),a.lastName||(a.lastName=""),a.middleName||(a.middleName=""),Object.keys(a).forEach(i=>{(a[i]===void 0||a[i]===null)&&delete a[i]});const n=await Ce.put("/profile",a);return n.data&&n.data.data?n.data.data:n.data}catch(r){throw console.error("Error updating avatar:",r),r}},updateProfile:async e=>{try{console.log("updateProfile - sending data:",e);const t=await Ce.put("/profile",e);return console.log("updateProfile - response:",t.data),t.data&&t.data.data?t.data.data:t.data}catch(t){throw console.error("Error updating profile:",t),console.error("Error response:",t.response?.data),t.response?.data?.errors&&console.error("Validation errors:",t.response.data.errors),t}},resetPassword:async e=>{try{return(await Ce.put("/profile/password",e)).data}catch(t){throw console.error("Error resetting password:",t),t}}},z6=()=>{const[e,t]=v.useState(null),[r,a]=v.useState(!0),[n,i]=v.useState(null),l=async()=>{try{a(!0),i(null);const d=await si.getProfile();t(d)}catch(d){console.error("Error fetching profile:",d),i(d.message||"Failed to fetch profile")}finally{a(!1)}},o=async d=>{try{a(!0),i(null);const m=await si.updateProfile(d);return t(m),m}catch(m){throw console.error("Error updating profile:",m),i(m.message||"Failed to update profile"),m}finally{a(!1)}},c=()=>{if(!e)return"Loading...";const{firstName:d,lastName:m,middleName:f}=e,x=[];return d&&x.push(d),f&&x.push(f),m&&x.push(m),x.join(" ")||"User"},u=()=>e?.role?e.role.name:"User";return v.useEffect(()=>{l()},[]),{profile:e,loading:r,error:n,fetchProfile:l,updateProfile:o,getDisplayName:c,getRoleName:u}},U6={position:"absolute",top:"100%",right:"0",zIndex:9999,minWidth:"250px",maxWidth:"300px",backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",borderRadius:"0.375rem",padding:"0.5rem 0",width:"auto",height:"auto",overflow:"visible",boxShadow:"none !important",WebkitBoxShadow:"none !important",MozBoxShadow:"none !important"},$6=({onToggleSidebar:e})=>{const t=za(),r=Ge(),[a,n]=v.useState(!1),[i,l]=v.useState(!1),o=v.useRef(null),{user:c,isLoading:u}=xs(),{profile:d,getDisplayName:m,loading:f}=z6(),x=()=>{if(!c||f)return"Loading...";if(d&&m&&m()&&m()!=="Loading..."){const w=m();if(w&&w.trim()!=="")return w}if(d&&d.firstName){const w=[d.firstName];d.middleName&&w.push(d.middleName),d.lastName&&w.push(d.lastName);const N=w.join(" ").trim();if(N)return N}if(c.fullName&&c.fullName!=="User"&&c.fullName.trim()!=="")return c.fullName;if(c.firstName&&c.lastName)return`${c.firstName} ${c.lastName}`;try{const w=localStorage.getItem("authToken");if(w){const N=JSON.parse(atob(w.split(".")[1]));if(N.fullName&&N.fullName!=="User")return N.fullName;if(N.name&&N.name!=="User")return N.name;if(N.firstName&&N.lastName)return`${N.firstName} ${N.lastName}`}}catch(w){console.error("Error parsing JWT token for display name:",w)}return c.name||"User"},p=()=>c&&c.email||"No email",h=w=>{const N=LS(w),S={"/profile":"Profile","/dashboard":"Dashboard","/users":"User Management","/roles":"Role Management","/departments":"Department Management","/templates":"Template List","/templates/editor":"Template Editor","/templates/drafts":"Your Drafts","/main-menu":"Main Menu","/system-config":"Global Field List","/courses/instructed":"Instructed Courses","/courses/enrolled":"Enrolled Course List","/assessments/upcoming":"Upcoming Assessments","/assessments/my-assessments":"Your Assessments","/assessments/results":"Assessment Results","/assessments/signature-required":"Signature Required List","/assessments/completion-required":"Section Completion Required List","/assessment-events":"Assessment Event","/reports/create":"Create Incident/Feedback Report","/reports/issues":"Issue List","/reports/feedback":"Feedback List","/configure-signature":"Configure Signature","/my-department-details":"My Department Details","/assessment-review-requests":"Assessment Review Requests","/academic-details":"Academic Details","/admin":"Dashboard","/admin/dashboard":"Dashboard","/admin/users":"User Management","/admin/roles":"Role Management","/admin/departments":"Department Management","/admin/forms":"Template List","/admin/forms/drafts":"Your Drafts","/admin/main-menu":"Main Menu","/admin/system-config":"Global Field List","/academic":"Academic Dashboard","/academic/dashboard":"Academic Dashboard","/academic/departments":"Department Management","/academic/assessment-events":"Assessment Event","/trainee":"Trainee Dashboard","/trainee/dashboard":"Trainee Dashboard","/trainee/academic-details":"Academic Details","/trainee/enrolled-courses":"Enrolled Course List","/trainee/signature-required":"Signature Required List","/trainee/completion-required":"Section Completion Required List","/trainee/your-assessments":"Your Assessments","/trainee/create-incident-feedback-report":"Create Incident/Feedback Report","/trainee/assessment-pending/section-completion":"Section Completion Required List","/trainer":"Trainer Dashboard","/trainer/dashboard":"Trainer Dashboard","/trainer/upcoming-assessments":"Upcoming Assessments","/trainer/assessment-results":"Assessment Results","/trainer/assess":"Assessments","/trainer/assessments":"Assessment Sections","/trainer/instructed-courses":"Instructed Courses","/trainer/courses":"Course Details","/trainer/configure-signature":"Configure Signature","/trainer/section-completion":"Section Completion","/trainer/assessment-details":"Assessment Result Details","/trainer/approval-notes":"Result Approval Note","/sqa":"Issue List","/sqa/issues":"Issue List","/sqa/feedback":"Feedback List","/sqa/templates":"Template List","/sqa/templates/history":"Template History","/sqa/templates/sections":"Template Sections","/sqa/templates/fields":"Template Fields","/sqa/templates/pdf-preview":"PDF Preview","/department-head":"Department Dashboard","/department-head/dashboard":"Department Dashboard","/department-head/my-department-details":"My Department Details","/department-head/assessment-review-requests":"Assessment Review Requests"};return w.startsWith("/department-head/my-department-details/")&&w!=="/department-head/my-department-details"&&!w.includes("/subjects/")?"Course Details":w.startsWith("/admin/departments/")&&w!=="/admin/departments"?"Department Details":w.startsWith("/academic/departments/")&&w!=="/academic/departments"?"Department Management":w.includes("/enroll-trainees")?"Trainee Enrollments":w.startsWith("/academic/course/")&&!w.includes("/subject/")?"Department Details":w.startsWith("/academic/course-detail/")?"Course Details":w.includes("/subject/")?"Subject Details":w.includes("/enroll-trainees")?"Enroll Trainees":w.match(/^\/trainee\/[^/]+\/course\/[^/]+$/)?"Enrolled Course Details":w.match(/^\/trainee\/[^/]+\/course\/[^/]+\/subject\/[^/]+$/)?"Enrolled Subject Details":w.startsWith("/templates/editor")||w.startsWith("/admin/forms/editor")?"Template Editor":w.match(/^\/trainee\/[^/]+\/assessment\/[^/]+$/)||w.match(/^\/trainee\/[^/]+\/assessments$/)?"Assessment Details":w.match(/^\/trainee\/[^/]+\/signature-pad\/[^/]+$/)?"Digital Signature":w.match(/^\/trainee\/[^/]+\/assessment-section\/[^/]+$/)?"Assessment Section":w.match(/^\/courses\/[^/]+$/)&&!w.includes("/enroll-trainees")&&!w.includes("/subjects/")?"Course Details":w.match(/^\/assessments\/assign\/[^/]+\/[^/]+$/)?"Assessments":w.match(/^\/assessments\/[^/]+\/sections$/)?"Assessment Sections":w.match(/^\/assessments\/sections\/[^/]+\/fields$/)?"Field":w.match(/^\/courses\/[^/]+\/enroll-trainees$/)?"Trainee Enrollments":w.match(/^\/courses\/[^/]+\/subjects\/[^/]+$/)?"Subject Details":w.match(/^\/departments\/[^/]+$/)?"Department Details":w.match(/^\/my-department-details\/[^/]+$/)&&!w.includes("/subjects/")?"Course Details":w.match(/^\/assessment-review-requests\/[^/]+$/)?"Assessment Review Request Details":w.startsWith("/sqa/templates/")&&w!=="/sqa/templates"?"Template Detail":w.startsWith("/trainer/trainees/")?"Trainee Details":w.startsWith("/trainer/subjects/")?"Subject Details":w.startsWith("/trainer/courses/")?"Course Details":w.startsWith("/trainer/assessment-details/")?"Assessment Result Details":w.match(/^\/trainer\/assessments\/sections\/[^/]+\/fields$/)?"Field":w.startsWith("/trainer/assessments/")?"Assessment Sections":w.startsWith("/trainer/assess/")?"Assessments":w.startsWith("/trainer/approval-notes/")?"Result Approval Note":w.includes("/department-head/courses/")&&w.includes("/subjects/")?"Subject Details":w.startsWith("/department-head/trainees/")||w.startsWith("/trainee/")&&w!=="/trainee"&&!w.startsWith("/trainee/dashboard")&&!w.startsWith("/trainee/academic-details")&&!w.startsWith("/trainee/enrolled-courses")&&!w.startsWith("/trainee/assessment-pending")&&!w.startsWith("/trainee/create-incident-feedback-report")&&!w.startsWith("/trainee/signature-required")&&!w.startsWith("/trainee/completion-required")&&!w.startsWith("/trainee/your-assessments")?"Trainee Details":S[N]||S[w]||"Dashboard"},g=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user");const w=()=>window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/";window.location.href=w()},b=()=>{n(!a)},j=()=>{n(!1)},y=()=>{r("/profile"),n(!1)};return v.useEffect(()=>{const w=N=>{o.current&&!o.current.contains(N.target)&&l(!1)};return i&&document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[i]),s.jsxs(s.Fragment,{children:[s.jsx(U1,{bg:"white",expand:"lg",className:"border-bottom border-neutral-200 shadow-sm",style:{minHeight:"60px"},children:s.jsxs("div",{className:"container-fluid",children:[s.jsx(se,{variant:"link",className:"text-primary-custom p-2 me-3",onClick:e,style:{border:"none",background:"transparent"},children:s.jsx(Hx,{size:20})}),s.jsx(U1.Brand,{className:"text-primary-custom fw-bold custom-title",children:h(t.pathname)}),s.jsx("div",{className:"d-none d-lg-block ms-auto",style:{position:"relative"},children:s.jsxs("div",{ref:o,style:{position:"relative"},children:[s.jsxs("button",{className:"text-primary-custom p-0 d-flex align-items-center",style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",boxShadow:"none",WebkitBoxShadow:"none",MozBoxShadow:"none"},onClick:()=>l(!i),children:[s.jsx(El,{size:32,className:"me-2"}),s.jsx("span",{children:u||f?"Loading...":x()})]}),s.jsxs("div",{className:`custom-dropdown ${i?"show":"hide"}`,style:U6,children:[s.jsxs("div",{className:"dropdown-header",style:{padding:"0.5rem 1rem",wordBreak:"break-all"},children:[s.jsx("div",{className:"fw-bold text-primary-custom",children:u||f?"Loading...":x()}),s.jsx("small",{className:"text-muted",style:{wordBreak:"break-all",whiteSpace:"normal",lineHeight:"1.2"},children:u?"Loading...":p()})]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item d-flex align-items-center text-primary-custom",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{l(!1),y()},children:[s.jsx(El,{className:"me-2",size:16}),"Profile"]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item d-flex align-items-center text-danger",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{l(!1),g()},children:[s.jsx(d0,{className:"me-2",size:16}),"Logout"]})]})]})}),s.jsx("div",{className:"d-lg-none text-primary-custom p-2",onClick:b,style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",marginLeft:"auto"},children:s.jsx(El,{size:32})})]})}),a&&s.jsx("div",{className:`profile-menu-overlay ${a?"show":""}`,onClick:j}),s.jsxs("div",{className:`profile-menu-slide ${a?"show":""}`,children:[s.jsxs("div",{className:"profile-menu-header",children:[s.jsx("button",{className:"profile-menu-close",onClick:j,"aria-label":"Close profile menu",children:s.jsx(Xe,{size:20})}),s.jsx("div",{className:"profile-avatar",children:s.jsx(El,{size:40})}),s.jsx("div",{className:"profile-name",children:u||f?"Loading...":x()}),s.jsx("div",{className:"profile-email",children:u?"Loading...":p()})]}),s.jsxs("ul",{className:"profile-menu-items",children:[s.jsx("li",{className:"profile-menu-item",children:s.jsxs("a",{href:"#",className:"profile-menu-link",onClick:w=>{w.preventDefault(),y()},children:[s.jsx(El,{className:"icon"}),"Profile"]})}),s.jsx("li",{className:"profile-menu-item",children:s.jsxs("a",{href:"#",className:"profile-menu-link danger",onClick:w=>{w.preventDefault(),j(),g()},children:[s.jsx(d0,{className:"icon"}),"Logout"]})})]})]})]})},W6=({children:e})=>{const[t,r]=v.useState(()=>{try{const u=localStorage.getItem("sidebarCollapsed");return u?u==="true":!1}catch{return!1}}),[a,n]=v.useState(!1),[i,l]=v.useState(!1);v.useEffect(()=>{const u=()=>{n(window.innerWidth<=768)};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),v.useEffect(()=>{try{localStorage.setItem("sidebarCollapsed",t)}catch{}},[t]);const o=()=>{a?l(!i):r(!t)},c=()=>{a&&l(!1)};return s.jsxs("div",{className:"d-flex",style:{height:"100vh",overflow:"hidden"},children:[s.jsx("div",{className:`sidebar-desktop ${t?"sidebar-collapsed":""}`,children:s.jsx(fb,{collapsed:t})}),a&&i&&s.jsx("div",{className:"sidebar-mobile-overlay",onClick:c}),s.jsx("div",{className:`sidebar-mobile ${i?"show":""}`,children:s.jsx(fb,{collapsed:!1,onClose:c})}),s.jsxs("div",{className:`flex-grow-1 d-flex flex-column ${a?"main-content-mobile":""} ${!a&&t?"sidebar-collapsed-active":""}`,style:{marginLeft:a?"0":t?"60px":"260px",transition:"margin-left 0.3s ease",width:a?"100%":`calc(100% - ${t?"60px":"260px"})`},children:[s.jsx($6,{onToggleSidebar:o}),s.jsx("main",{className:"flex-grow-1 bg-light-custom",style:{overflowY:"auto"},children:e})]})]})},$t=()=>s.jsx(W6,{children:s.jsx(M4,{})}),ur=(e,t=null,r="asc")=>{const[a,n]=v.useState({key:t,direction:r});return{sortedData:v.useMemo(()=>!a.key||!e?e:[...e].sort((u,d)=>{let m=u[a.key],f=d[a.key];if(a.key.includes(".")){const x=a.key.split(".");m=x.reduce((p,h)=>p?.[h],u),f=x.reduce((p,h)=>p?.[h],d)}if(a.key.includes("length")){const x=a.key.replace(".length","");m=u[x]?.length||0,f=d[x]?.length||0}return typeof m=="string"&&typeof f=="string"&&(m=m.toLowerCase(),f=f.toLowerCase()),m<f?a.direction==="asc"?-1:1:m>f?a.direction==="asc"?1:-1:0}),[e,a]),sortConfig:a,handleSort:u=>{let d="asc";if(a.key===u&&a.direction==="asc")d="desc";else if(a.key===u&&a.direction==="desc"){n({key:null,direction:"asc"});return}n({key:u,direction:d})},getSortIcon:u=>a.key!==u?"":a.direction==="asc"?"":"",getSortClass:u=>a.key!==u?"text-muted":(a.direction==="asc","text-primary")}},im=({data:e,loading:t,columns:r,renderRow:a,emptyMessage:n="No data found",emptyDescription:i="Try adjusting your search criteria."})=>{const{sortedData:l,sortConfig:o,handleSort:c}=ur(e);if(t)return s.jsx(zt,{rows:5,columns:r.length});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:n}),s.jsx("p",{children:i})]})});const u=({columnKey:d,children:m,className:f=""})=>{const x=o.key===d,p=x?o.direction:null;return s.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:h=>{h.target.style.backgroundColor="#214760",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="var(--bs-primary)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:p,size:14,color:"white"})})]}),x&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsx("tr",{children:r.map((d,m)=>d.sortable?s.jsx(u,{columnKey:d.key,className:d.className||"",children:d.title},m):s.jsx("th",{className:`fw-semibold ${d.className||""}`,style:{textTransform:"uppercase",letterSpacing:"0.5px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:d.title},m))})}),s.jsx("tbody",{children:l.map((d,m)=>a(d,m))})]})})},H6=({children:e})=>s.jsx(YP,{children:e}),_t=()=>{const e=B4(),t=Ge(),a=(l=>l?.status===404?{title:"404 - Page Not Found",message:"The page you're looking for doesn't exist.",suggestion:"Check the URL or go back to the dashboard."}:l?.status===403?{title:"403 - Access Denied",message:"You don't have permission to access this page.",suggestion:"Contact your administrator for access."}:{title:"Something went wrong",message:l?.message||"An unexpected error occurred.",suggestion:"Please try refreshing the page or contact support."})(e),n=()=>{t((window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/")+"/admin")},i=()=>{t(-1)};return s.jsx(_e,{fluid:!0,className:"py-5",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-50",children:s.jsxs("div",{className:"text-center",style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h1",{className:"display-1 text-muted",children:""}),s.jsx("h2",{className:"text-primary-custom mb-3",children:a.title}),s.jsx("p",{className:"text-muted mb-4",children:a.message}),s.jsx("p",{className:"small text-muted",children:a.suggestion})]}),s.jsxs("div",{className:"d-flex gap-3 justify-content-center",children:[s.jsx(se,{variant:"primary",onClick:n,className:"px-4",children:"Go to Dashboard"}),s.jsx(se,{variant:"outline-secondary",onClick:i,className:"px-4",children:"Go Back"})]}),!1]})})})},zt=({rows:e=5,columns:t=4})=>{const r=()=>s.jsx("tr",{children:Array.from({length:t}).map((a,n)=>s.jsx("td",{children:s.jsx("div",{className:"placeholder-glow",style:{height:"20px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px",animation:"placeholder-glow 2s ease-in-out infinite alternate"},children:s.jsx("span",{className:"placeholder col-12"})})},n))});return s.jsxs(H,{className:"border-neutral-200",children:[s.jsx(H.Header,{className:"bg-light-custom border-neutral-200",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("div",{className:"placeholder-glow",style:{height:"24px",width:"200px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})}),s.jsx("div",{className:"placeholder-glow",style:{height:"32px",width:"100px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})})]})}),s.jsx(H.Body,{className:"p-0",children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"bg-neutral-50",children:s.jsx("tr",{children:Array.from({length:t}).map((a,n)=>s.jsx("th",{className:"border-neutral-200",children:s.jsx("div",{className:"placeholder-glow",style:{height:"16px",backgroundColor:"var(--bs-neutral-300)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})})},n))})}),s.jsx("tbody",{children:Array.from({length:e}).map((a,n)=>s.jsx(r,{},n))})]})})})]})},rt=({permission:e,permissions:t=[],requireAll:r=!1,children:a,redirectTo:n=null})=>{const{hasPermission:i,hasAnyPermission:l,hasAllPermissions:o}=to(),{user:c}=xs();return(!e&&(!t||t.length===0)||c?.role==="TRAINEE"?!0:e?i(e):t&&t.length>0?r?o(t):l(t):!1)?a:s.jsxs("div",{className:"p-4 text-center text-muted",children:[s.jsx("h4",{children:"Access Denied"}),s.jsx("p",{children:"You don't have permission to access this page."}),s.jsxs("p",{className:"small text-muted",children:["Required permission: ",e||t.join(", ")]}),s.jsxs("p",{className:"small text-muted",children:["Your role: ",c?.role||"Unknown"]})]})},Ar=({permission:e,permissions:t=[],requireAll:r=!1,children:a,fallback:n=null,showMessage:i=!1,message:l="You do not have permission to access this feature."})=>{const{hasPermission:o,hasAnyPermission:c,hasAllPermissions:u}=to();return(()=>{if(!e&&(!t||t.length===0))return!0;if(e)return o(e);if(t&&t.length>0){const m=t.filter(f=>f&&typeof f=="string");return m.length===0?!0:r?u(m):c(m)}return!1})()?a:n||(i?s.jsxs(ke,{variant:"warning",className:"mt-3",children:[s.jsx(ke.Heading,{children:"Access Denied"}),s.jsx("p",{children:l})]}):null)},er=({trigger:e,items:t=[],align:r="end",className:a="",onItemClick:n,placement:i="bottom-end",disabled:l=!1,...o})=>{const[c,u]=v.useState(!1),[d,m]=v.useState({top:0,left:0}),f=v.useRef(null),x=v.useRef(null),p=()=>{if(!f.current)return;const y=f.current.getBoundingClientRect(),w=200,N=150,S=4;let E,_;switch(i){case"bottom-start":E=y.bottom+S,_=y.left;break;case"bottom-end":E=y.bottom+S,_=y.right-w;break;case"top-start":E=y.top-N-S,_=y.left;break;case"top-end":E=y.top-N-S,_=y.right-w;break;default:E=y.bottom+S,_=y.right-w}E+N>window.innerHeight&&(E=y.top-N-S),E<0&&(E=S),_+w>window.innerWidth&&(_=window.innerWidth-w-S),_<0&&(_=S),m({top:E,left:_})},h=y=>{y.preventDefault(),y.stopPropagation(),!l&&(c||p(),u(!c))},g=()=>{u(!1)},b=y=>{y.onClick&&y.onClick(),n&&n(y),g()};v.useEffect(()=>{const y=N=>{c&&f.current&&!f.current.contains(N.target)&&x.current&&!x.current.contains(N.target)&&g()},w=N=>{N.key==="Escape"&&g()};return c&&(document.addEventListener("mousedown",y),document.addEventListener("keydown",w),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",y),document.removeEventListener("keydown",w),document.body.style.overflow=""}},[c]),v.useEffect(()=>{if(c){const y=()=>p(),w=()=>p();return window.addEventListener("scroll",y,!0),window.addEventListener("resize",w),()=>{window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",w)}}},[c,i]);const j=c&&$x.createPortal(s.jsx("div",{ref:x,className:"dropdown-menu show portal-dropdown border-0",style:{position:"fixed",top:d.top,left:d.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:t.map((y,w)=>y.type==="header"?s.jsx("div",{className:`dropdown-header ${y.className||""}`,children:y.content},w):y.type==="divider"?s.jsx("div",{className:"dropdown-divider"},w):s.jsxs("button",{onClick:()=>b(y),className:`dropdown-item ${y.className||""}`,disabled:y.disabled,children:[y.icon&&s.jsx("span",{className:"me-2",children:y.icon}),y.label]},w))}),document.body);return s.jsxs("div",{className:`dropdown ${a}`,children:[s.jsx("button",{ref:f,className:`btn ${e?.variant==="link"?"btn-link":"btn-light"} ${e?.className||""}`,type:"button",onClick:h,disabled:l,"aria-expanded":c,"aria-haspopup":"true",style:e?.style||{},children:e?.children}),j]})},Wt=({children:e})=>{const{isAuthenticated:t,isLoading:r}=xs();return za(),r?s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Checking authentication..."})]})}):t?e:s.jsx(z4,{to:"/",replace:!0})},rs=({placeholder:e="Search...",value:t,onChange:r,className:a="",size:n="md"})=>s.jsxs($1,{className:a,size:n,children:[s.jsx($1.Text,{className:"bg-white border-end-0",children:s.jsx(Gx,{className:"text-primary-custom"})}),s.jsx(I.Control,{type:"text",placeholder:e,value:t,onChange:i=>r(i.target.value),className:"border-start-0",style:{borderColor:"var(--bs-neutral)",boxShadow:"none"},onFocus:i=>{i.target.style.borderColor="var(--bs-primary)",i.target.style.boxShadow="0 0 0 0.25rem rgba(27, 60, 83, 0.25)"},onBlur:i=>{i.target.style.borderColor="var(--bs-neutral)",i.target.style.boxShadow="none"}})]}),pr=({direction:e,size:t=16,color:r})=>{const a=r||"var(--bs-primary)",n={fontSize:`${t}px`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"inline-block",lineHeight:1,fontWeight:"bold"};return e==="asc"?s.jsx("span",{style:{...n,color:a,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):e==="desc"?s.jsx("span",{style:{...n,color:a,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):s.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"1px",lineHeight:1,verticalAlign:"middle"},className:r?"":"text-muted sort-icon",children:[s.jsx("span",{style:{display:"inline-block",fontSize:`${t}px`,color:r||void 0,opacity:r?.8:.5,lineHeight:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:"bold"},children:""}),s.jsx("span",{style:{display:"inline-block",fontSize:`${t}px`,color:r||void 0,opacity:r?.8:.5,lineHeight:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:"bold"},children:""})]})},ei=({name:e,value:t,onChange:r,options:a=[],placeholder:n="Select an option",disabled:i=!1,isInvalid:l=!1,className:o="",style:c={},...u})=>{const d=v.useRef(null),[m,f]=v.useState(!1),x=b=>{if(i)return;const y=b.target.getBoundingClientRect(),N=window.innerHeight*.15,E=y.top-N;E>0&&window.scrollTo({top:window.scrollY+E,behavior:"instant"}),f(!0)},p=b=>{i||setTimeout(()=>{const y=b.target.getBoundingClientRect(),N=window.innerHeight*.15,E=y.top-N;E>0&&window.scrollTo({top:window.scrollY+E,behavior:"instant"})},10)},h=b=>{f(!1),r&&r(b)},g=()=>{f(!1)};return s.jsxs(I.Select,{ref:d,name:e,value:t,onChange:h,onBlur:g,onClick:x,onFocus:p,disabled:i,isInvalid:l,className:o,style:{position:"relative",zIndex:1001,...c},...u,children:[s.jsx("option",{value:"",children:n}),a.map(b=>typeof b=="object"?s.jsx("option",{value:b.value,children:b.label},b.value):s.jsx("option",{value:b,children:b},b))]})},Dr=()=>{const e=Ge(),t=za();return v.useEffect(()=>{const r=LS(t.pathname),a=t.search||"",n=t.hash||"",i=r+a+n;r!==t.pathname&&e(i,{replace:!0,state:t.state})},[t.pathname,t.search,t.hash,t.state,e]),null},V6=()=>[{id:"main-menu",label:"Main Menu",path:he.MAIN_MENU,isAdminOnly:!0},{id:"users",label:"User Management",path:he.USERS,permissions:[fe.VIEW_ALL_USERS,fe.CREATE_USER,fe.UPDATE_USER,fe.DISABLE_USER,fe.ENABLE_USER],requireAll:!1},{id:"roles",label:"Role Management",path:he.ROLES,permission:fe.VIEW_ALL_ROLES},{id:"departments",label:"Departments",path:he.DEPARTMENTS,permission:fe.VIEW_ALL_DEPARTMENTS},{id:"forms",label:"Template List",path:he.TEMPLATES,permission:fe.VIEW_ALL_TEMPLATES},{id:"system-config",label:"System Configuration",path:he.SYSTEM_CONFIG,permission:fe.LIST_GLOBAL_FIELDS},{id:"academic-dashboard",label:"Academic Dashboard",path:"/academic/dashboard",permission:fe.ACADEMIC_OVERVIEW_DASHBOARD},{id:"trainee-dashboard",label:"Trainee Dashboard",path:he.DASHBOARD,permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS},{id:"enrolled-courses",label:"Enrolled Course List",path:he.COURSES_ENROLLED,permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS},{id:"all-assessments",label:"All Assessments",path:he.ASSESSMENTS_MY_ASSESSMENTS,permissions:[fe.LIST_ASSESSMENTS,"GET /assessments/user-events"],requireAll:!1,children:[{id:"your-assessments",label:"Your Assessments",path:he.ASSESSMENTS_MY_ASSESSMENTS,permissions:[fe.LIST_ASSESSMENTS,"GET /assessments/user-events"],requireAll:!1},{id:"signature-required",label:"Signature Required List",path:he.ASSESSMENTS_SIGNATURE_REQUIRED,permissions:[fe.LIST_ASSESSMENTS,"GET /assessments/user-events"],requireAll:!1},{id:"completion-required",label:"Section Completion Required List",path:he.ASSESSMENTS_COMPLETION_REQUIRED,permissions:[fe.LIST_ASSESSMENTS,"GET /assessments/user-events"],requireAll:!1}]},{id:"create-issue",label:"Create Incident/Feedback Report",path:he.REPORTS_CREATE,permission:fe.SUBMIT_REPORT_REQUEST},{id:"upcoming-assessments",label:"List Upcoming Assessment",path:he.ASSESSMENTS_UPCOMING,permission:fe.LIST_ASSESSMENTS},{id:"assessment-results",label:"List Assessment Result",path:he.ASSESSMENTS_RESULTS,permission:fe.LIST_ASSESSMENTS},{id:"instructed-courses",label:"List Instructed Course",path:he.COURSES_INSTRUCTED,permission:fe.VIEW_ALL_COURSES},{id:"department-dashboard",label:"Department Dashboard",path:"/department-head/dashboard",permission:fe.VIEW_DEPARTMENT_IN_DETAIL},{id:"my-department-details",label:"My Department Details",path:he.DEPARTMENT_MY_DETAILS,permission:fe.VIEW_DEPARTMENT_IN_DETAIL},{id:"assessment-review-requests",label:"List Assessment Review Requests",path:he.DEPARTMENT_REVIEW_REQUESTS,permission:fe.LIST_ASSESSMENTS},{id:"issue-list",label:"Issue List",path:he.REPORTS_ISSUES,permission:fe.LIST_ALL_REPORTS},{id:"feedback-list",label:"Feedback List",path:he.REPORTS_FEEDBACK,permission:fe.LIST_ALL_REPORTS},{id:"template-list",label:"Template List",path:he.TEMPLATES,permission:fe.VIEW_ALL_TEMPLATES,children:[{id:"template-history",label:"List History Version",path:"/sqa/templates/history",permission:fe.VIEW_TEMPLATE_DETAILS},{id:"template-sections",label:"Section List",path:"/sqa/templates/sections",permission:fe.VIEW_TEMPLATE_DETAILS},{id:"template-fields",label:"Field List",path:"/sqa/templates/fields",permission:fe.VIEW_TEMPLATE_DETAILS},{id:"template-export",label:"PDF Preview for Export",path:"/sqa/templates/export",permission:fe.DOWNLOAD_CONTENT_PDF}]}],G6=e=>{if(!e?.role)return!1;const r=(typeof e.role=="string"?e.role:e.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();return r==="ADMIN"||r==="ADMINISTRATOR"},q6=e=>{if(!e?.role)return!1;const r=(typeof e.role=="string"?e.role:e.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();return r==="ACADEMIC_DEPARTMENT"||r==="ACADEMIC_DEPT"||r.startsWith("ACADEMIC")},K6=e=>e?.role?(typeof e.role=="string"?e.role:e.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim()==="TRAINER":!1,Y6=e=>{if(!e?.role)return!1;const r=(typeof e.role=="string"?e.role:e.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();return r==="DEPARTMENT_HEAD"||r==="DEPT_HEAD"||r==="DEPARTMENT HEAD"},X6=e=>e?.role?(typeof e.role=="string"?e.role:e.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim()==="TRAINEE":!1,J6=(e,t,r,a)=>{const n=["main-menu","users","roles","departments","forms","system-config"],i=["academic-dashboard"],l=["upcoming-assessments","assessment-results","instructed-courses"],o=["department-dashboard","my-department-details","assessment-review-requests"],c=["trainee-dashboard","enrolled-courses","all-assessments","create-issue"];return V6().filter(d=>{if(G6(e))return d.isAdminOnly?!0:n.includes(d.id);if(q6(e))return i.includes(d.id);if(K6(e))return l.includes(d.id);if(Y6(e))return o.includes(d.id);if(X6(e))return c.includes(d.id);if(d.isAdminOnly)return!1;if(!d.permission&&(!d.permissions||d.permissions.length===0))return!0;let m=!1;if(d.permissions&&d.permissions.length>0?m=d.requireAll?d.permissions.every(f=>r(f)):a(d.permissions):d.permission&&(m=r(d.permission)),d.children&&d.children.length>0){const f=d.children.some(x=>x.permission?r(x.permission):!0);return m||f}return m}).map(d=>d.children&&d.children.length>0?{...d,children:d.children.filter(m=>m.permission?r(m.permission):!0)}:d)},Z6=(e,t,r,a,n=he.DASHBOARD)=>{if(!e||!t||t.length===0)return n;const i=J6(e,t,r,a);return i.length===0?n:i[0].path||n},Q6=(e=he.DASHBOARD)=>{const{user:t,userPermissions:r,isLoading:a}=xs(),{hasPermission:n,hasAnyPermission:i}=to();return{firstRoute:v.useMemo(()=>a||!t||!r||r.length===0?e:Z6(t,r,n,i,e),[t,r,n,i,a,e]),isLoading:a||!t||!r||r.length===0}},yl=()=>{const{user:e,isLoading:t}=xs(),r=Ge(),a=za(),{firstRoute:n,isLoading:i}=Q6(he.DASHBOARD),l=v.useRef(!1);return v.useEffect(()=>{if(!(t||i||!e)){if(a.pathname===n){l.current=!0;return}l.current||(l.current=!0,r(n,{replace:!0}))}},[e,t,i,n,r,a.pathname]),t||i||!e?s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Loading..."})]})}):null},eR=({show:e,onHide:t})=>{const[r,a]=v.useState(""),[n,i]=v.useState(!1),[l,o]=v.useState(""),c=async d=>{d.preventDefault(),o(""),i(!0);try{const m=await fetch(`${Ml.BASE_URL}${Ml.ENDPOINTS.AUTH.FORGOT_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,magicLink:`${window.location.origin}${Jx()}reset-password/`})});if(!m.ok){m.status===405?o("Forgot password feature is not available on this server. Please contact support."):m.status===404?o("Forgot password endpoint not found. Please contact support."):o(`Server error (${m.status}). Please try again later.`);return}try{await m.json()}catch(f){console.error("JSON parsing error:",f),o("Server returned invalid response. Please try again later.");return}te.success("Password reset link has been sent to your email!"),a(""),t()}catch(m){console.error("Forgot password error:",m),m.name==="TypeError"&&m.message.includes("fetch")?o("Cannot connect to server. Please check your internet connection."):o("An unexpected error occurred. Please try again later.")}finally{i(!1)}},u=()=>{a(""),o(""),t()};return s.jsxs(le,{show:e,onHide:u,centered:!0,children:[s.jsxs(le.Header,{className:"border-0 pb-0",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[s.jsxs(le.Title,{className:"d-flex align-items-center text-white",children:[s.jsx(Gi,{className:"me-2",size:20}),"Forgot Password"]}),s.jsx(se,{variant:"link",onClick:u,className:"p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:s.jsx(Xe,{})})]}),s.jsxs(le.Body,{className:"pt-0",children:[s.jsx("p",{className:"text-muted mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),l&&s.jsx(ke,{variant:"danger",className:"mb-3",children:l}),s.jsxs(I,{onSubmit:c,children:[s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Email Address"}),s.jsx(I.Control,{type:"email",placeholder:"Enter your email",value:r,onChange:d=>a(d.target.value),required:!0,disabled:n,className:"py-3 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}})]}),s.jsxs("div",{className:"d-grid gap-2",children:[s.jsx(se,{type:"submit",variant:"primary",size:"lg",disabled:n||!r.trim(),className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:d=>{d.target.style.transform="translateY(-2px)",d.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:d=>{d.target.style.transform="translateY(0)",d.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Sending..."]}):"Send Reset Link"}),s.jsx(se,{type:"button",variant:"outline-secondary",onClick:u,disabled:n,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:d=>{d.target.style.background="var(--bs-neutral-100)",d.target.style.borderColor="var(--bs-primary)",d.target.style.transform="translateY(-1px)"},onMouseLeave:d=>{d.target.style.background="rgba(255, 255, 255, 0.8)",d.target.style.borderColor="var(--bs-neutral-300)",d.target.style.transform="translateY(0)"},children:"Cancel"})]})]})]})]})};function tf(){const[e,t]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[c,u]=v.useState(!1),d=Ge();za();const{login:m,isAuthenticated:f,isLoading:x}=xs();if(v.useEffect(()=>{f&&d("/dashboard",{replace:!0})},[f,d]),x)return s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Loading..."})]})});if(f)return null;const p=async h=>{h.preventDefault(),o(!0);try{const g=await m({email:e,password:r});g.success?d("/dashboard",{replace:!0}):te.error(g.error||"Email or password is incorrect. Please try again.")}catch{te.error("Login failed. Please try again.")}finally{o(!1)}};return s.jsxs("div",{className:"min-vh-100 d-flex position-relative overflow-hidden",children:[s.jsx("div",{className:"position-absolute w-100 h-100",style:{backgroundImage:'url("./login-background.png")',backgroundSize:"cover",backgroundPosition:"center",filter:"blur(1px)",zIndex:-1}}),s.jsx("div",{className:"position-absolute w-100 h-100 bg-dark",style:{opacity:.3,zIndex:0}}),s.jsx(_e,{fluid:!0,className:"position-relative",style:{zIndex:1},children:s.jsxs(oe,{className:"min-vh-100",children:[s.jsx(U,{lg:6,className:"d-flex align-items-center justify-content-center p-5 d-none d-lg-flex",children:s.jsxs("div",{className:"text-white text-start",style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"d-flex align-items-center mb-4",children:[s.jsx("div",{className:"dashed-line me-3"}),s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})})]}),s.jsxs("h1",{className:"display-4 fw-bold mb-4 custom-title",style:{lineHeight:"1.1"},children:["AVIATION",s.jsx("br",{}),"ACADEMY"]}),s.jsx("p",{className:"fs-5 mb-3",style:{opacity:.9},children:"Where Your Dream Destinations Become Reality."}),s.jsx("p",{className:"fs-6",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]})}),s.jsx(U,{lg:6,xs:12,className:"d-flex align-items-center justify-content-center p-3 p-lg-5",children:s.jsxs("div",{className:"w-100 login-form-container",style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)",padding:"2rem",position:"relative",overflow:"hidden"},children:[s.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",zIndex:1}}),s.jsx("div",{style:{position:"absolute",top:"20%",left:"-50%",width:"200%",height:"60%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",transform:"rotate(-15deg)",zIndex:0}}),s.jsxs("div",{style:{position:"relative",zIndex:2},children:[s.jsxs("div",{className:"text-center mb-4 d-lg-none",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[s.jsx("div",{className:"dashed-line me-3"}),s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})}),s.jsx("div",{className:"dashed-line ms-3"})]}),s.jsxs("h1",{className:"text-white fw-bold mb-2 mobile-title",style:{lineHeight:"1.1",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:["AVIATION",s.jsx("br",{}),"ACADEMY"]}),s.jsx("p",{className:"text-white mb-2 mobile-subtitle",style:{opacity:.9,textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Where Your Dream Destinations Become Reality."}),s.jsx("p",{className:"text-white-50 mobile-description",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]}),s.jsxs(I,{onSubmit:p,children:[s.jsxs(I.Group,{className:"mb-3",controlId:"email",children:[s.jsx(I.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Email"}),s.jsx(I.Control,{type:"email",value:e,onChange:h=>t(h.target.value),placeholder:"Enter your email",className:"bg-white border-0 rounded-3 py-3",style:{fontSize:"1rem"},required:!0})]}),s.jsxs(I.Group,{className:"mb-4",controlId:"password",children:[s.jsx(I.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(I.Control,{type:n?"text":"password",value:r,onChange:h=>a(h.target.value),placeholder:"Enter your password",className:"bg-white border-0 rounded-3 py-3 pe-5",style:{fontSize:"1rem"},required:!0}),s.jsx("span",{role:"button",tabIndex:0,onClick:()=>i(h=>!h),onKeyPress:h=>{(h.key==="Enter"||h.key===" ")&&i(g=>!g)},"aria-label":"Toggle password visibility",className:"position-absolute top-50 translate-middle-y end-0 me-3 d-flex align-items-center justify-content-center",style:{width:24,height:24,cursor:"pointer"},children:n?s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#6b7280",strokeWidth:"1.5"})]}):s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"})]})})]})]}),s.jsx(se,{type:"submit",variant:"primary",className:"w-100 py-4 fw-bold rounded-3 mb-3",style:{fontSize:"1.1rem"},disabled:l,children:l?s.jsxs(s.Fragment,{children:[s.jsx(xt,{size:"sm",className:"me-2"})," Signing In..."]}):"Sign In"}),s.jsx("div",{className:"text-center mb-2",children:s.jsx("button",{type:"button",onClick:()=>u(!0),className:"btn btn-link text-decoration-none fw-semibold px-2 border-0 p-0",style:{fontSize:"0.9rem",color:"rgba(201, 212, 229, 0.8)",boxShadow:"none",textShadow:"none",cursor:"pointer",background:"none"},children:"Forgot password?"})}),s.jsx("div",{className:"text-center mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}}),s.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}})]})}),s.jsxs("div",{className:"text-center",children:[s.jsx("small",{className:"text-white-50 d-block mb-2",children:"Test Credentials:"}),s.jsx("div",{className:"text-white-50 small",children:s.jsx("div",{children:"Admin: michael.brown@admin.com / Admin@123"})})]})]})]})]})})]})}),s.jsx("style",{children:`
        .dashed-line {
          width: 60px;
          height: 2px;
          background: repeating-linear-gradient(
            to right,
            white 0px,
            white 8px,
            transparent 8px,
            transparent 16px
          );
        }
        
        /* Mobile responsive styles */
        .mobile-title {
          font-size: 1.8rem;
        }
        
        .mobile-subtitle {
          font-size: 0.9rem;
        }
        
        .mobile-description {
          font-size: 0.75rem;
        }
        
        /* Tablet styles */
        @media (min-width: 576px) and (max-width: 991.98px) {
          .mobile-title {
            font-size: 2.2rem;
          }
          
          .mobile-subtitle {
            font-size: 1rem;
          }
          
          .mobile-description {
            font-size: 0.85rem;
          }
        }
        
        /* Mobile styles */
        @media (max-width: 575.98px) {
          .dashed-line {
            width: 40px;
          }
          
          .login-form-container {
            padding: 1.5rem !important;
          }
        }
      `}),s.jsx(eR,{show:c,onHide:()=>u(!1)})]})}const tR=()=>{const[e]=Yu(),t=Ge(),[r,a]=v.useState({newPassword:"",confirmPassword:""}),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState(""),[f,x]=v.useState("");v.useEffect(()=>{const g=e.get("token");g&&x(g)},[e]);const p=g=>{const{name:b,value:j}=g.target;a(y=>({...y,[b]:j})),d&&m("")},h=async g=>{if(g.preventDefault(),m(""),!r.newPassword||!r.confirmPassword){m("Please fill in all fields.");return}if(r.newPassword!==r.confirmPassword){m("Passwords do not match.");return}u(!0);try{const b=await fetch(`${Ml.BASE_URL}${Ml.ENDPOINTS.AUTH.RESET_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:f,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!b.ok){b.status===405?m("Reset password feature is not available on this server. Please contact support."):b.status===404?m("Reset password endpoint not found. Please contact support."):b.status===400?m("Invalid token or password. Please request a new reset link."):m(`Server error (${b.status}). Please try again later.`);return}try{await b.json()}catch(j){console.error("JSON parsing error:",j),m("Server returned invalid response. Please try again later.");return}te.success("Password has been reset successfully! You can now login with your new password."),t("/login")}catch(b){console.error("Reset password error:",b),b.name==="TypeError"&&b.message.includes("fetch")?m("Cannot connect to server. Please check your internet connection."):m("An unexpected error occurred. Please try again later.")}finally{u(!1)}};return s.jsx("div",{className:"min-vh-100 d-flex align-items-center",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:s.jsx(_e,{children:s.jsx(oe,{className:"justify-content-center",children:s.jsx(U,{md:6,lg:5,xl:4,children:s.jsx(H,{className:"shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(27, 60, 83, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},children:s.jsxs(H.Body,{className:"p-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)"},children:s.jsx(Yo,{size:24,className:"text-white"})}),s.jsx("h4",{className:"fw-bold mb-2",style:{color:"var(--bs-primary)"},children:"Reset Password"}),s.jsx("p",{className:"text-muted",children:"Enter your new password below"})]}),d&&s.jsx(ke,{variant:"danger",className:"mb-3",children:d}),s.jsxs(I,{onSubmit:h,children:[s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(I.Control,{type:n?"text":"password",name:"newPassword",value:r.newPassword,onChange:p,placeholder:"Enter new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),s.jsx(se,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>i(!n),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:n?s.jsx(Ko,{size:16}):s.jsx(St,{size:16})})]})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Confirm New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(I.Control,{type:l?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:p,placeholder:"Confirm new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),s.jsx(se,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>o(!l),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:l?s.jsx(Ko,{size:16}):s.jsx(St,{size:16})})]})]}),s.jsxs("div",{className:"d-grid gap-2",children:[s.jsx(se,{type:"submit",variant:"primary",size:"lg",disabled:c||!r.newPassword||!r.confirmPassword,className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:g=>{g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resetting..."]}):"Reset Password"}),s.jsx(se,{type:"button",variant:"outline-secondary",onClick:()=>t("/login"),disabled:c,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.background="var(--bs-neutral-100)",g.target.style.borderColor="var(--bs-primary)",g.target.style.transform="translateY(-1px)"},onMouseLeave:g=>{g.target.style.background="rgba(255, 255, 255, 0.8)",g.target.style.borderColor="var(--bs-neutral-300)",g.target.style.transform="translateY(0)"},children:"Back to Login"})]})]})]})})})})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Zd={};Zd.version="0.18.5";var qS=1252,rR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],eg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tg=function(e){rR.indexOf(e)!=-1&&(qS=eg[0]=e)};function sR(){tg(1252)}var Ka=function(e){tg(e)};function rg(){Ka(1200),sR()}function hb(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function aR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function KS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Io=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?aR(e.slice(2)):t==254&&r==255?KS(e.slice(2)):t==65279?e.slice(1):e},cd=function(t){return String.fromCharCode(t)},pb=function(t){return String.fromCharCode(t)},Zo,ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qo(e){for(var t="",r=0,a=0,n=0,i=0,l=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,a=e.charCodeAt(u++),l=(r&3)<<4|a>>4,n=e.charCodeAt(u++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),t+=ti.charAt(i)+ti.charAt(l)+ti.charAt(o)+ti.charAt(c);return t}function ha(e){var t="",r=0,a=0,n=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=ti.indexOf(e.charAt(u++)),l=ti.indexOf(e.charAt(u++)),r=i<<2|l>>4,t+=String.fromCharCode(r),o=ti.indexOf(e.charAt(u++)),a=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(a)),c=ti.indexOf(e.charAt(u++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Dt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Fn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function li(e){return Dt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function xb(e){return Dt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var da=function(t){return Dt?Fn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function lm(e){if(typeof ArrayBuffer>"u")return da(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function hi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function nR(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function sg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return sg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ds=Dt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Fn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function iR(e){for(var t=[],r=0,a=e.length+250,n=li(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|o>>6&15|(l&3)<<4,n[r++]=128|o&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(t.push(n.slice(0,r)),r=0,n=li(65535),a=65530)}return t.push(n.slice(0,r)),ds(t)}var Ys=/\u0000/g,Oo=/[\u0001-\u0006]/g;function _l(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ya(e,t){var r=""+e;return r.length>=t?r:Fr("0",t-r.length)+r}function ag(e,t){var r=""+e;return r.length>=t?r:Fr(" ",t-r.length)+r}function Qd(e,t){var r=""+e;return r.length>=t?r:r+Fr(" ",t-r.length)}function lR(e,t){var r=""+Math.round(e);return r.length>=t?r:Fr("0",t-r.length)+r}function oR(e,t){var r=""+e;return r.length>=t?r:Fr("0",t-r.length)+r}var gb=Math.pow(2,32);function jl(e,t){if(e>gb||e<-gb)return lR(e,t);var r=Math.round(e);return oR(r,t)}function eu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var vb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],rf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},bb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},dR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function tu(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,l=1,o=0,c=1,u=0,d=0,m=Math.floor(n);u<t&&(m=Math.floor(n),o=m*l+i,d=m*u+c,!(n-m<5e-8));)n=1/(n-m),i=l,l=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=i):(d=u,o=l)),!r)return[0,a*o,d];var f=Math.floor(a*o/d);return[f,a*o-f*d,d]}function Di(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,l=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=xR(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var YS=new Date(1899,11,31,0,0,0),uR=YS.getTime(),mR=new Date(1900,2,1,0,0,0);function XS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=mR&&(r+=1440*60*1e3),(r-(uR+(e.getTimezoneOffset()-YS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ng(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hR(e){var t=e<0?12:11,r=ng(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function pR(e){var t=ng(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ec(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=hR(e):t===10?r=e.toFixed(10).substr(0,12):r=pR(e),ng(fR(r.toUpperCase()))}function Xi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ec(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fa(14,XS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function xR(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function gR(e,t,r,a){var n="",i=0,l=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return rf[r.m-1][1];case 5:return rf[r.m-1][0];default:return rf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return vb[r.q][0];default:return vb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ya(r.S,t.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(n=Ya(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Ya(c,u):"";return d}function ri(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var JS=/%/g;function vR(e,t,r){var a=t.replace(JS,""),n=t.length-a.length;return Sn(e,a,r*Math.pow(10,2*n))+Fr("%",n)}function bR(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Sn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function ZS(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ZS(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var QS=/# (\?+)( ?)\/( ?)(\d+)/;function yR(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),l=n-i*a,o=a;return r+(i===0?"":""+i)+" "+(l===0?Fr(" ",e[1].length+1+e[4].length):ag(l,e[1].length)+e[2]+"/"+e[3]+Ya(o,e[4].length))}function jR(e,t,r){return r+(t===0?"":""+t)+Fr(" ",e[1].length+2+e[4].length)}var eE=/^#*0*\.([0#]+)/,tE=/\).*[0#]/,rE=/\(###\) ###\\?-####/;function Hs(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function yb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function jb(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function wR(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function NR(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Na(e,t,r){if(e.charCodeAt(0)===40&&!t.match(tE)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Na("n",a,r):"("+Na("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bR(e,t,r);if(t.indexOf("%")!==-1)return vR(e,t,r);if(t.indexOf("E")!==-1)return ZS(t,r);if(t.charCodeAt(0)===36)return"$"+Na(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+jl(c,t.length);if(t.match(/^[#?]+$/))return n=jl(r,0),n==="0"&&(n=""),n.length>t.length?n:Hs(t.substr(0,t.length-n.length))+n;if(i=t.match(QS))return yR(i,c,u);if(t.match(/^#+0+$/))return u+jl(c,t.length-t.indexOf("0"));if(i=t.match(eE))return n=yb(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Hs(i[1])).replace(/\.$/,"."+Hs(i[1])).replace(/\.(\d*)$/,function(p,h){return"."+h+Fr("0",Hs(i[1]).length-h.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+yb(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+ri(jl(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Na(e,t,-r):ri(""+(Math.floor(r)+wR(r,i[1].length)))+"."+Ya(jb(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Na(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=_l(Na(e,t.replace(/[\\-]/g,""),r)),l=0,_l(_l(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<n.length?n.charAt(l++):p==="0"?"0":""}));if(t.match(rE))return n=Na(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=tu(c,Math.pow(10,l)-1,!1),n=""+u,d=Sn("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Qd(o[2],l),d.length<i[4].length&&(d=Hs(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=tu(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ag(o[1],l)+i[2]+"/"+i[3]+Qd(o[2],l):Fr(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=jl(r,0),t.length<=n.length?n:Hs(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var m=t.indexOf(".")-l,f=t.length-n.length-m;return Hs(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=jb(r,i[1].length),r<0?"-"+Na(e,t,-r):ri(NR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ya(0,3-p.length):"")+p})+"."+Ya(l,i[1].length);switch(t){case"###,##0.00":return Na(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=ri(jl(c,0));return x!=="0"?u+x:"";case"###,###.00":return Na(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Na(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function SR(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Sn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function ER(e,t,r){var a=t.replace(JS,""),n=t.length-a.length;return Sn(e,a,r*Math.pow(10,2*n))+Fr("%",n)}function sE(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+sE(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function nn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(tE)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nn("n",a,r):"("+nn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return SR(e,t,r);if(t.indexOf("%")!==-1)return ER(e,t,r);if(t.indexOf("E")!==-1)return sE(t,r);if(t.charCodeAt(0)===36)return"$"+nn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ya(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Hs(t.substr(0,t.length-n.length))+n;if(i=t.match(QS))return jR(i,c,u);if(t.match(/^#+0+$/))return u+Ya(c,t.length-t.indexOf("0"));if(i=t.match(eE))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Hs(i[1])).replace(/\.$/,"."+Hs(i[1])),n=n.replace(/\.(\d*)$/,function(p,h){return"."+h+Fr("0",Hs(i[1]).length-h.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+ri(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nn(e,t,-r):ri(""+r)+"."+Fr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return nn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=_l(nn(e,t.replace(/[\\-]/g,""),r)),l=0,_l(_l(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<n.length?n.charAt(l++):p==="0"?"0":""}));if(t.match(rE))return n=nn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=tu(c,Math.pow(10,l)-1,!1),n=""+u,d=Sn("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Qd(o[2],l),d.length<i[4].length&&(d=Hs(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=tu(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ag(o[1],l)+i[2]+"/"+i[3]+Qd(o[2],l):Fr(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Hs(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var m=t.indexOf(".")-l,f=t.length-n.length-m;return Hs(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+nn(e,t,-r):ri(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ya(0,3-p.length):"")+p})+"."+Ya(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=ri(""+c);return x!=="0"?u+x:"";default:if(t.match(/\.[0#?]*$/))return nn(e,t.slice(0,t.lastIndexOf(".")),r)+Hs(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Sn(e,t,r){return(r|0)===r?nn(e,t,r):Na(e,t,r)}function TR(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var aE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ro(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":eu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(aE))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function AR(e,t,r,a){for(var n=[],i="",l=0,o="",c="t",u,d,m,f="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!eu(e,l))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(m=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(m);n[n.length]={t:"t",v:i},++l;break;case"\\":var x=e.charAt(++l),p=x==="("||x===")"?x:"t";n[n.length]={t:p,v:x},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=Di(t,r,e.charAt(l+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Di(t,r),u==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var h={t:o,v:o};if(u==null&&(u=Di(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(h.v=u.H>=12?"P":"A"),h.t="T",f="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(h.v=u.H>=12?"PM":"AM"),h.t="T",l+=5,f="h"):e.substr(l,5).toUpperCase()==="/"?(u!=null&&(h.v=u.H>=12?"":""),h.t="T",l+=5,f="h"):(h.t="t",++l),u==null&&h.t==="T")return"";n[n.length]=h,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(aE)){if(u==null&&(u=Di(t,r),u==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",ro(e)||(n[n.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++l;break}var g=0,b=0,j;for(l=n.length-1,c="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=f,c="h",g<1&&(g=1);break;case"s":(j=n[l].v.match(/\.0+$/))&&(b=Math.max(b,j[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[l].t;break;case"m":c==="s"&&(n[l].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[l].v.match(/[Hh]/)&&(g=1),g<2&&n[l].v.match(/[Mm]/)&&(g=2),g<3&&n[l].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",w;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=gR(n[l].t.charCodeAt(0),n[l].v,u,b),n[l].t="t";break;case"n":case"?":for(w=l+1;n[w]!=null&&((o=n[w].t)==="?"||o==="D"||(o===" "||o==="t")&&n[w+1]!=null&&(n[w+1].t==="?"||n[w+1].t==="t"&&n[w+1].v==="/")||n[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[w].v==="/"||n[w].v===" "&&n[w+1]!=null&&n[w+1].t=="?"));)n[l].v+=n[w].v,n[w]={v:"",t:";"},++w;y+=n[l].v,l=w-1;break;case"G":n[l].t="t",n[l].v=Xi(t,r);break}var N="",S,E;if(y.length>0){y.charCodeAt(0)==40?(S=t<0&&y.charCodeAt(0)===45?-t:t,E=Sn("n",y,S)):(S=t<0&&a>1?-t:t,E=Sn("n",y,S),S<0&&n[0]&&n[0].t=="t"&&(E=E.substr(1),n[0].v="-"+n[0].v)),w=E.length-1;var _=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){_=l;break}var T=n.length;if(_===n.length&&E.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(w>=n[l].v.length-1?(w-=n[l].v.length,n[l].v=E.substr(w+1,n[l].v.length)):w<0?n[l].v="":(n[l].v=E.substr(0,w+1),w=-1),n[l].t="t",T=l);w>=0&&T<n.length&&(n[T].v=E.substr(0,w+1)+n[T].v)}else if(_!==n.length&&E.indexOf("E")===-1){for(w=E.indexOf(".")-1,l=_;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(d=n[l].v.indexOf(".")>-1&&l===_?n[l].v.indexOf(".")-1:n[l].v.length-1,N=n[l].v.substr(d+1);d>=0;--d)w>=0&&(n[l].v.charAt(d)==="0"||n[l].v.charAt(d)==="#")&&(N=E.charAt(w--)+N);n[l].v=N,n[l].t="t",T=l}for(w>=0&&T<n.length&&(n[T].v=E.substr(0,w+1)+n[T].v),w=E.indexOf(".")+1,l=_;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==_)){for(d=n[l].v.indexOf(".")>-1&&l===_?n[l].v.indexOf(".")+1:0,N=n[l].v.substr(0,d);d<n[l].v.length;++d)w<E.length&&(N+=E.charAt(w++));n[l].v=N,n[l].t="t",T=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(S=a>1&&t<0&&l>0&&n[l-1].v==="-"?-t:t,n[l].v=Sn(n[l].t,n[l].v,S),n[l].t="t");var C="";for(l=0;l!==n.length;++l)n[l]!=null&&(C+=n[l].v);return C}var wb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Nb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function CR(e,t){var r=TR(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(wb),o=r[1].match(wb);return Nb(t,l)?[a,r[0]]:Nb(t,o)?[a,r[1]]:[a,r[l!=null&&o!=null?2:1]]}return[a,i]}function Fa(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:ut)[e],a==null&&(a=r.table&&r.table[bb[e]]||ut[bb[e]]),a==null&&(a=dR[e]||"General");break}if(eu(a,0))return Xi(t,r);t instanceof Date&&(t=XS(t,r.date1904));var n=CR(a,t);if(eu(n[1]))return Xi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return AR(n[1],t,r,n[0])}function En(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ut[r]==null){t<0&&(t=r);continue}if(ut[r]==e){t=r;break}}t<0&&(t=391)}return ut[t]=e,t}function om(e){for(var t=0;t!=392;++t)e[t]!==void 0&&En(e[t],t)}function so(){ut=cR()}var _R={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},nE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function kR(e){var t=typeof e=="number"?ut[e]:e;return t=t.replace(nE,"(\\d+)"),new RegExp("^"+t+"$")}function DR(e,t,r){var a=-1,n=-1,i=-1,l=-1,o=-1,c=-1;(t.match(nE)||[]).forEach(function(m,f){var x=parseInt(r[f+1],10);switch(m.toLowerCase().charAt(0)){case"y":a=x;break;case"d":i=x;break;case"h":l=x;break;case"s":c=x;break;case"m":l>=0?o=x:n=x;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?u:a==-1&&n==-1&&i==-1?d:u+"T"+d}var IR=(function(){var e={};e.version="1.2.0";function t(){for(var E=0,_=new Array(256),T=0;T!=256;++T)E=T,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,_[T]=E;return typeof Int32Array<"u"?new Int32Array(_):_}var r=t();function a(E){var _=0,T=0,C=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)A[C]=E[C];for(C=0;C!=256;++C)for(T=E[C],_=256+C;_<4096;_+=256)T=A[_]=T>>>8^E[T&255];var D=[];for(C=1;C!=16;++C)D[C-1]=typeof Int32Array<"u"?A.subarray(C*256,C*256+256):A.slice(C*256,C*256+256);return D}var n=a(r),i=n[0],l=n[1],o=n[2],c=n[3],u=n[4],d=n[5],m=n[6],f=n[7],x=n[8],p=n[9],h=n[10],g=n[11],b=n[12],j=n[13],y=n[14];function w(E,_){for(var T=_^-1,C=0,A=E.length;C<A;)T=T>>>8^r[(T^E.charCodeAt(C++))&255];return~T}function N(E,_){for(var T=_^-1,C=E.length-15,A=0;A<C;)T=y[E[A++]^T&255]^j[E[A++]^T>>8&255]^b[E[A++]^T>>16&255]^g[E[A++]^T>>>24]^h[E[A++]]^p[E[A++]]^x[E[A++]]^f[E[A++]]^m[E[A++]]^d[E[A++]]^u[E[A++]]^c[E[A++]]^o[E[A++]]^l[E[A++]]^i[E[A++]]^r[E[A++]];for(C+=15;A<C;)T=T>>>8^r[(T^E[A++])&255];return~T}function S(E,_){for(var T=_^-1,C=0,A=E.length,D=0,P=0;C<A;)D=E.charCodeAt(C++),D<128?T=T>>>8^r[(T^D)&255]:D<2048?(T=T>>>8^r[(T^(192|D>>6&31))&255],T=T>>>8^r[(T^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,P=E.charCodeAt(C++)&1023,T=T>>>8^r[(T^(240|D>>8&7))&255],T=T>>>8^r[(T^(128|D>>2&63))&255],T=T>>>8^r[(T^(128|P>>6&15|(D&3)<<4))&255],T=T>>>8^r[(T^(128|P&63))&255]):(T=T>>>8^r[(T^(224|D>>12&15))&255],T=T>>>8^r[(T^(128|D>>6&63))&255],T=T>>>8^r[(T^(128|D&63))&255]);return~T}return e.table=r,e.bstr=w,e.buf=N,e.str=S,e})(),it=(function(){var t={};t.version="1.2.1";function r(W,Q){for(var q=W.split("/"),K=Q.split("/"),ne=0,re=0,xe=Math.min(q.length,K.length);ne<xe;++ne){if(re=q[ne].length-K[ne].length)return re;if(q[ne]!=K[ne])return q[ne]<K[ne]?-1:1}return q.length-K.length}function a(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:a(W.slice(0,-1));var Q=W.lastIndexOf("/");return Q===-1?W:W.slice(0,Q+1)}function n(W){if(W.charAt(W.length-1)=="/")return n(W.slice(0,-1));var Q=W.lastIndexOf("/");return Q===-1?W:W.slice(Q+1)}function i(W,Q){typeof Q=="string"&&(Q=new Date(Q));var q=Q.getHours();q=q<<6|Q.getMinutes(),q=q<<5|Q.getSeconds()>>>1,W.write_shift(2,q);var K=Q.getFullYear()-1980;K=K<<4|Q.getMonth()+1,K=K<<5|Q.getDate(),W.write_shift(2,K)}function l(W){var Q=W.read_shift(2)&65535,q=W.read_shift(2)&65535,K=new Date,ne=q&31;q>>>=5;var re=q&15;q>>>=4,K.setMilliseconds(0),K.setFullYear(q+1980),K.setMonth(re-1),K.setDate(ne);var xe=Q&31;Q>>>=5;var Ae=Q&63;return Q>>>=6,K.setHours(Q),K.setMinutes(Ae),K.setSeconds(xe<<1),K}function o(W){Ns(W,0);for(var Q={},q=0;W.l<=W.length-4;){var K=W.read_shift(2),ne=W.read_shift(2),re=W.l+ne,xe={};switch(K){case 21589:q=W.read_shift(1),q&1&&(xe.mtime=W.read_shift(4)),ne>5&&(q&2&&(xe.atime=W.read_shift(4)),q&4&&(xe.ctime=W.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}W.l=re,Q[K]=xe}return Q}var c;function u(){return c||(c={})}function d(W,Q){if(W[0]==80&&W[1]==75)return Ni(W,Q);if((W[0]|32)==109&&(W[1]|32)==105)return et(W,Q);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var q=3,K=512,ne=0,re=0,xe=0,Ae=0,ge=0,ve=[],ye=W.slice(0,512);Ns(ye,0);var Le=m(ye);switch(q=Le[0],q){case 3:K=512;break;case 4:K=4096;break;case 0:if(Le[1]==0)return Ni(W,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}K!==512&&(ye=W.slice(0,K),Ns(ye,28));var ze=W.slice(0,K);f(ye,q);var Ke=ye.read_shift(4,"i");if(q===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);ye.l+=4,xe=ye.read_shift(4,"i"),ye.l+=4,ye.chk("00100000","Mini Stream Cutoff Size: "),Ae=ye.read_shift(4,"i"),ne=ye.read_shift(4,"i"),ge=ye.read_shift(4,"i"),re=ye.read_shift(4,"i");for(var Fe=-1,We=0;We<109&&(Fe=ye.read_shift(4,"i"),!(Fe<0));++We)ve[We]=Fe;var bt=x(W,K);g(ge,re,bt,K,ve);var _r=j(bt,xe,ve,K);_r[xe].name="!Directory",ne>0&&Ae!==P&&(_r[Ae].name="!MiniFAT"),_r[ve[0]].name="!FAT",_r.fat_addrs=ve,_r.ssz=K;var kr={},As=[],xo=[],go=[];y(xe,_r,bt,As,ne,kr,xo,Ae),p(xo,go,As),As.shift();var vo={FileIndex:xo,FullPaths:go};return Q&&Q.raw&&(vo.raw={header:ze,sectors:bt}),vo}function m(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(R,"Header Signature: "),W.l+=16;var Q=W.read_shift(2,"u");return[W.read_shift(2,"u"),Q]}function f(W,Q){var q=9;switch(W.l+=2,q=W.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function x(W,Q){for(var q=Math.ceil(W.length/Q)-1,K=[],ne=1;ne<q;++ne)K[ne-1]=W.slice(ne*Q,(ne+1)*Q);return K[q-1]=W.slice(q*Q),K}function p(W,Q,q){for(var K=0,ne=0,re=0,xe=0,Ae=0,ge=q.length,ve=[],ye=[];K<ge;++K)ve[K]=ye[K]=K,Q[K]=q[K];for(;Ae<ye.length;++Ae)K=ye[Ae],ne=W[K].L,re=W[K].R,xe=W[K].C,ve[K]===K&&(ne!==-1&&ve[ne]!==ne&&(ve[K]=ve[ne]),re!==-1&&ve[re]!==re&&(ve[K]=ve[re])),xe!==-1&&(ve[xe]=K),ne!==-1&&K!=ve[K]&&(ve[ne]=ve[K],ye.lastIndexOf(ne)<Ae&&ye.push(ne)),re!==-1&&K!=ve[K]&&(ve[re]=ve[K],ye.lastIndexOf(re)<Ae&&ye.push(re));for(K=1;K<ge;++K)ve[K]===K&&(re!==-1&&ve[re]!==re?ve[K]=ve[re]:ne!==-1&&ve[ne]!==ne&&(ve[K]=ve[ne]));for(K=1;K<ge;++K)if(W[K].type!==0){if(Ae=K,Ae!=ve[Ae])do Ae=ve[Ae],Q[K]=Q[Ae]+"/"+Q[K];while(Ae!==0&&ve[Ae]!==-1&&Ae!=ve[Ae]);ve[K]=-1}for(Q[0]+="/",K=1;K<ge;++K)W[K].type!==2&&(Q[K]+="/")}function h(W,Q,q){for(var K=W.start,ne=W.size,re=[],xe=K;q&&ne>0&&xe>=0;)re.push(Q.slice(xe*D,xe*D+D)),ne-=D,xe=_i(q,xe*4);return re.length===0?Te(0):ds(re).slice(0,W.size)}function g(W,Q,q,K,ne){var re=P;if(W===P){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var xe=q[W],Ae=(K>>>2)-1;if(!xe)return;for(var ge=0;ge<Ae&&(re=_i(xe,ge*4))!==P;++ge)ne.push(re);g(_i(xe,K-4),Q-1,q,K,ne)}}function b(W,Q,q,K,ne){var re=[],xe=[];ne||(ne=[]);var Ae=K-1,ge=0,ve=0;for(ge=Q;ge>=0;){ne[ge]=!0,re[re.length]=ge,xe.push(W[ge]);var ye=q[Math.floor(ge*4/K)];if(ve=ge*4&Ae,K<4+ve)throw new Error("FAT boundary crossed: "+ge+" 4 "+K);if(!W[ye])break;ge=_i(W[ye],ve)}return{nodes:re,data:Rb([xe])}}function j(W,Q,q,K){var ne=W.length,re=[],xe=[],Ae=[],ge=[],ve=K-1,ye=0,Le=0,ze=0,Ke=0;for(ye=0;ye<ne;++ye)if(Ae=[],ze=ye+Q,ze>=ne&&(ze-=ne),!xe[ze]){ge=[];var Fe=[];for(Le=ze;Le>=0;){Fe[Le]=!0,xe[Le]=!0,Ae[Ae.length]=Le,ge.push(W[Le]);var We=q[Math.floor(Le*4/K)];if(Ke=Le*4&ve,K<4+Ke)throw new Error("FAT boundary crossed: "+Le+" 4 "+K);if(!W[We]||(Le=_i(W[We],Ke),Fe[Le]))break}re[ze]={nodes:Ae,data:Rb([ge])}}return re}function y(W,Q,q,K,ne,re,xe,Ae){for(var ge=0,ve=K.length?2:0,ye=Q[W].data,Le=0,ze=0,Ke;Le<ye.length;Le+=128){var Fe=ye.slice(Le,Le+128);Ns(Fe,64),ze=Fe.read_shift(2),Ke=mg(Fe,0,ze-ve),K.push(Ke);var We={name:Ke,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},bt=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);bt!==0&&(We.ct=w(Fe,Fe.l-8));var _r=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);_r!==0&&(We.mt=w(Fe,Fe.l-8)),We.start=Fe.read_shift(4,"i"),We.size=Fe.read_shift(4,"i"),We.size<0&&We.start<0&&(We.size=We.type=0,We.start=P,We.name=""),We.type===5?(ge=We.start,ne>0&&ge!==P&&(Q[ge].name="!StreamData")):We.size>=4096?(We.storage="fat",Q[We.start]===void 0&&(Q[We.start]=b(q,We.start,Q.fat_addrs,Q.ssz)),Q[We.start].name=We.name,We.content=Q[We.start].data.slice(0,We.size)):(We.storage="minifat",We.size<0?We.size=0:ge!==P&&We.start!==P&&Q[ge]&&(We.content=h(We,Q[ge].data,(Q[Ae]||{}).data))),We.content&&Ns(We.content,0),re[Ke]=We,xe.push(We)}}function w(W,Q){return new Date((ca(W,Q+4)/1e7*Math.pow(2,32)+ca(W,Q)/1e7-11644473600)*1e3)}function N(W,Q){return u(),d(c.readFileSync(W),Q)}function S(W,Q){var q=Q&&Q.type;switch(q||Dt&&Buffer.isBuffer(W)&&(q="buffer"),q||"base64"){case"file":return N(W,Q);case"base64":return d(da(ha(W)),Q);case"binary":return d(da(W),Q)}return d(W,Q)}function E(W,Q){var q=Q||{},K=q.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=K+"/",W.FileIndex[0]={name:K,type:5}),q.CLSID&&(W.FileIndex[0].clsid=q.CLSID),_(W)}function _(W){var Q="Sh33tJ5";if(!it.find(W,"/"+Q)){var q=Te(4);q[0]=55,q[1]=q[3]=50,q[2]=54,W.FileIndex.push({name:Q,type:2,content:q,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+Q),T(W)}}function T(W,Q){E(W);for(var q=!1,K=!1,ne=W.FullPaths.length-1;ne>=0;--ne){var re=W.FileIndex[ne];switch(re.type){case 0:K?q=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(re.R*re.L*re.C)&&(q=!0),re.R>-1&&re.L>-1&&re.R==re.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!Q)){var xe=new Date(1987,1,19),Ae=0,ge=Object.create?Object.create(null):{},ve=[];for(ne=0;ne<W.FullPaths.length;++ne)ge[W.FullPaths[ne]]=!0,W.FileIndex[ne].type!==0&&ve.push([W.FullPaths[ne],W.FileIndex[ne]]);for(ne=0;ne<ve.length;++ne){var ye=a(ve[ne][0]);K=ge[ye],K||(ve.push([ye,{name:n(ye).replace("/",""),type:1,clsid:X,ct:xe,mt:xe,content:null}]),ge[ye]=!0)}for(ve.sort(function(Ke,Fe){return r(Ke[0],Fe[0])}),W.FullPaths=[],W.FileIndex=[],ne=0;ne<ve.length;++ne)W.FullPaths[ne]=ve[ne][0],W.FileIndex[ne]=ve[ne][1];for(ne=0;ne<ve.length;++ne){var Le=W.FileIndex[ne],ze=W.FullPaths[ne];if(Le.name=n(ze).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||X,ne===0)Le.C=ve.length>1?1:-1,Le.size=0,Le.type=5;else if(ze.slice(-1)=="/"){for(Ae=ne+1;Ae<ve.length&&a(W.FullPaths[Ae])!=ze;++Ae);for(Le.C=Ae>=ve.length?-1:Ae,Ae=ne+1;Ae<ve.length&&a(W.FullPaths[Ae])!=a(ze);++Ae);Le.R=Ae>=ve.length?-1:Ae,Le.type=1}else a(W.FullPaths[ne+1]||"")==a(ze)&&(Le.R=ne+1),Le.type=2}}}function C(W,Q){var q=Q||{};if(q.fileType=="mad")return gt(W,q);switch(T(W),q.fileType){case"zip":return ce(W,q)}var K=(function(Ke){for(var Fe=0,We=0,bt=0;bt<Ke.FileIndex.length;++bt){var _r=Ke.FileIndex[bt];if(_r.content){var kr=_r.content.length;kr>0&&(kr<4096?Fe+=kr+63>>6:We+=kr+511>>9)}}for(var As=Ke.FullPaths.length+3>>2,xo=Fe+7>>3,go=Fe+127>>7,vo=xo+We+As+go,Si=vo+127>>7,Km=Si<=109?0:Math.ceil((Si-109)/127);vo+Si+Km+127>>7>Si;)Km=++Si<=109?0:Math.ceil((Si-109)/127);var vn=[1,Km,Si,go,As,We,Fe,0];return Ke.FileIndex[0].size=Fe<<6,vn[7]=(Ke.FileIndex[0].start=vn[0]+vn[1]+vn[2]+vn[3]+vn[4]+vn[5])+(vn[6]+7>>3),vn})(W),ne=Te(K[7]<<9),re=0,xe=0;{for(re=0;re<8;++re)ne.write_shift(1,M[re]);for(re=0;re<8;++re)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),re=0;re<3;++re)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,K[2]),ne.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:P),ne.write_shift(4,K[3]),ne.write_shift(-4,K[1]?K[0]-1:P),ne.write_shift(4,K[1]),re=0;re<109;++re)ne.write_shift(-4,re<K[2]?K[1]+re:-1)}if(K[1])for(xe=0;xe<K[1];++xe){for(;re<236+xe*127;++re)ne.write_shift(-4,re<K[2]?K[1]+re:-1);ne.write_shift(-4,xe===K[1]-1?P:xe+1)}var Ae=function(Ke){for(xe+=Ke;re<xe-1;++re)ne.write_shift(-4,re+1);Ke&&(++re,ne.write_shift(-4,P))};for(xe=re=0,xe+=K[1];re<xe;++re)ne.write_shift(-4,ie.DIFSECT);for(xe+=K[2];re<xe;++re)ne.write_shift(-4,ie.FATSECT);Ae(K[3]),Ae(K[4]);for(var ge=0,ve=0,ye=W.FileIndex[0];ge<W.FileIndex.length;++ge)ye=W.FileIndex[ge],ye.content&&(ve=ye.content.length,!(ve<4096)&&(ye.start=xe,Ae(ve+511>>9)));for(Ae(K[6]+7>>3);ne.l&511;)ne.write_shift(-4,ie.ENDOFCHAIN);for(xe=re=0,ge=0;ge<W.FileIndex.length;++ge)ye=W.FileIndex[ge],ye.content&&(ve=ye.content.length,!(!ve||ve>=4096)&&(ye.start=xe,Ae(ve+63>>6)));for(;ne.l&511;)ne.write_shift(-4,ie.ENDOFCHAIN);for(re=0;re<K[4]<<2;++re){var Le=W.FullPaths[re];if(!Le||Le.length===0){for(ge=0;ge<17;++ge)ne.write_shift(4,0);for(ge=0;ge<3;++ge)ne.write_shift(4,-1);for(ge=0;ge<12;++ge)ne.write_shift(4,0);continue}ye=W.FileIndex[re],re===0&&(ye.start=ye.size?ye.start-1:P);var ze=re===0&&q.root||ye.name;if(ve=2*(ze.length+1),ne.write_shift(64,ze,"utf16le"),ne.write_shift(2,ve),ne.write_shift(1,ye.type),ne.write_shift(1,ye.color),ne.write_shift(-4,ye.L),ne.write_shift(-4,ye.R),ne.write_shift(-4,ye.C),ye.clsid)ne.write_shift(16,ye.clsid,"hex");else for(ge=0;ge<4;++ge)ne.write_shift(4,0);ne.write_shift(4,ye.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,ye.start),ne.write_shift(4,ye.size),ne.write_shift(4,0)}for(re=1;re<W.FileIndex.length;++re)if(ye=W.FileIndex[re],ye.size>=4096)if(ne.l=ye.start+1<<9,Dt&&Buffer.isBuffer(ye.content))ye.content.copy(ne,ne.l,0,ye.size),ne.l+=ye.size+511&-512;else{for(ge=0;ge<ye.size;++ge)ne.write_shift(1,ye.content[ge]);for(;ge&511;++ge)ne.write_shift(1,0)}for(re=1;re<W.FileIndex.length;++re)if(ye=W.FileIndex[re],ye.size>0&&ye.size<4096)if(Dt&&Buffer.isBuffer(ye.content))ye.content.copy(ne,ne.l,0,ye.size),ne.l+=ye.size+63&-64;else{for(ge=0;ge<ye.size;++ge)ne.write_shift(1,ye.content[ge]);for(;ge&63;++ge)ne.write_shift(1,0)}if(Dt)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function A(W,Q){var q=W.FullPaths.map(function(ge){return ge.toUpperCase()}),K=q.map(function(ge){var ve=ge.split("/");return ve[ve.length-(ge.slice(-1)=="/"?2:1)]}),ne=!1;Q.charCodeAt(0)===47?(ne=!0,Q=q[0].slice(0,-1)+Q):ne=Q.indexOf("/")!==-1;var re=Q.toUpperCase(),xe=ne===!0?q.indexOf(re):K.indexOf(re);if(xe!==-1)return W.FileIndex[xe];var Ae=!re.match(Oo);for(re=re.replace(Ys,""),Ae&&(re=re.replace(Oo,"!")),xe=0;xe<q.length;++xe)if((Ae?q[xe].replace(Oo,"!"):q[xe]).replace(Ys,"")==re||(Ae?K[xe].replace(Oo,"!"):K[xe]).replace(Ys,"")==re)return W.FileIndex[xe];return null}var D=64,P=-2,R="d0cf11e0a1b11ae1",M=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:R,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(W,Q,q){u();var K=C(W,q);c.writeFileSync(Q,K)}function V(W){for(var Q=new Array(W.length),q=0;q<W.length;++q)Q[q]=String.fromCharCode(W[q]);return Q.join("")}function me(W,Q){var q=C(W,Q);switch(Q&&Q.type||"buffer"){case"file":return u(),c.writeFileSync(Q.filename,q),q;case"binary":return typeof q=="string"?q:V(q);case"base64":return Qo(typeof q=="string"?q:V(q));case"buffer":if(Dt)return Buffer.isBuffer(q)?q:Fn(q);case"array":return typeof q=="string"?da(q):q}return q}var ue;function F(W){try{var Q=W.InflateRaw,q=new Q;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)ue=W;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function Y(W,Q){if(!ue)return gn(W,Q);var q=ue.InflateRaw,K=new q,ne=K._processChunk(W.slice(W.l),K._finishFlushFlag);return W.l+=K.bytesRead,ne}function z(W){return ue?ue.deflateRawSync(W):ft(W)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Z(W){var Q=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var ee=typeof Uint8Array<"u",de=ee?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)de[Ee]=Z(Ee);function B(W,Q){var q=de[W&255];return Q<=8?q>>>8-Q:(q=q<<8|de[W>>8&255],Q<=16?q>>>16-Q:(q=q<<8|de[W>>16&255],q>>>24-Q))}function Se(W,Q){var q=Q&7,K=Q>>>3;return(W[K]|(q<=6?0:W[K+1]<<8))>>>q&3}function Re(W,Q){var q=Q&7,K=Q>>>3;return(W[K]|(q<=5?0:W[K+1]<<8))>>>q&7}function He(W,Q){var q=Q&7,K=Q>>>3;return(W[K]|(q<=4?0:W[K+1]<<8))>>>q&15}function st(W,Q){var q=Q&7,K=Q>>>3;return(W[K]|(q<=3?0:W[K+1]<<8))>>>q&31}function Pe(W,Q){var q=Q&7,K=Q>>>3;return(W[K]|(q<=1?0:W[K+1]<<8))>>>q&127}function Gt(W,Q,q){var K=Q&7,ne=Q>>>3,re=(1<<q)-1,xe=W[ne]>>>K;return q<8-K||(xe|=W[ne+1]<<8-K,q<16-K)||(xe|=W[ne+2]<<16-K,q<24-K)||(xe|=W[ne+3]<<24-K),xe&re}function yt(W,Q,q){var K=Q&7,ne=Q>>>3;return K<=5?W[ne]|=(q&7)<<K:(W[ne]|=q<<K&255,W[ne+1]=(q&7)>>8-K),Q+3}function Pt(W,Q,q){var K=Q&7,ne=Q>>>3;return q=(q&1)<<K,W[ne]|=q,Q+1}function qt(W,Q,q){var K=Q&7,ne=Q>>>3;return q<<=K,W[ne]|=q&255,q>>>=8,W[ne+1]=q,Q+8}function Ie(W,Q,q){var K=Q&7,ne=Q>>>3;return q<<=K,W[ne]|=q&255,q>>>=8,W[ne+1]=q&255,W[ne+2]=q>>>8,Q+16}function Ue(W,Q){var q=W.length,K=2*q>Q?2*q:Q+5,ne=0;if(q>=Q)return W;if(Dt){var re=xb(K);if(W.copy)W.copy(re);else for(;ne<W.length;++ne)re[ne]=W[ne];return re}else if(ee){var xe=new Uint8Array(K);if(xe.set)xe.set(W);else for(;ne<q;++ne)xe[ne]=W[ne];return xe}return W.length=K,W}function De(W){for(var Q=new Array(W),q=0;q<W;++q)Q[q]=0;return Q}function lt(W,Q,q){var K=1,ne=0,re=0,xe=0,Ae=0,ge=W.length,ve=ee?new Uint16Array(32):De(32);for(re=0;re<32;++re)ve[re]=0;for(re=ge;re<q;++re)W[re]=0;ge=W.length;var ye=ee?new Uint16Array(ge):De(ge);for(re=0;re<ge;++re)ve[ne=W[re]]++,K<ne&&(K=ne),ye[re]=0;for(ve[0]=0,re=1;re<=K;++re)ve[re+16]=Ae=Ae+ve[re-1]<<1;for(re=0;re<ge;++re)Ae=W[re],Ae!=0&&(ye[re]=ve[Ae+16]++);var Le=0;for(re=0;re<ge;++re)if(Le=W[re],Le!=0)for(Ae=B(ye[re],K)>>K-Le,xe=(1<<K+4-Le)-1;xe>=0;--xe)Q[Ae|xe<<Le]=Le&15|re<<4;return K}var Ut=ee?new Uint16Array(512):De(512),rr=ee?new Uint16Array(32):De(32);if(!ee){for(var ct=0;ct<512;++ct)Ut[ct]=0;for(ct=0;ct<32;++ct)rr[ct]=0}(function(){for(var W=[],Q=0;Q<32;Q++)W.push(5);lt(W,rr,32);var q=[];for(Q=0;Q<=143;Q++)q.push(8);for(;Q<=255;Q++)q.push(9);for(;Q<=279;Q++)q.push(7);for(;Q<=287;Q++)q.push(8);lt(q,Ut,288)})();var Et=(function(){for(var Q=ee?new Uint8Array(32768):[],q=0,K=0;q<G.length-1;++q)for(;K<G[q+1];++K)Q[K]=q;for(;K<32768;++K)Q[K]=29;var ne=ee?new Uint8Array(259):[];for(q=0,K=0;q<O.length-1;++q)for(;K<O[q+1];++K)ne[K]=q;function re(Ae,ge){for(var ve=0;ve<Ae.length;){var ye=Math.min(65535,Ae.length-ve),Le=ve+ye==Ae.length;for(ge.write_shift(1,+Le),ge.write_shift(2,ye),ge.write_shift(2,~ye&65535);ye-- >0;)ge[ge.l++]=Ae[ve++]}return ge.l}function xe(Ae,ge){for(var ve=0,ye=0,Le=ee?new Uint16Array(32768):[];ye<Ae.length;){var ze=Math.min(65535,Ae.length-ye);if(ze<10){for(ve=yt(ge,ve,+(ye+ze==Ae.length)),ve&7&&(ve+=8-(ve&7)),ge.l=ve/8|0,ge.write_shift(2,ze),ge.write_shift(2,~ze&65535);ze-- >0;)ge[ge.l++]=Ae[ye++];ve=ge.l*8;continue}ve=yt(ge,ve,+(ye+ze==Ae.length)+2);for(var Ke=0;ze-- >0;){var Fe=Ae[ye];Ke=(Ke<<5^Fe)&32767;var We=-1,bt=0;if((We=Le[Ke])&&(We|=ye&-32768,We>ye&&(We-=32768),We<ye))for(;Ae[We+bt]==Ae[ye+bt]&&bt<250;)++bt;if(bt>2){Fe=ne[bt],Fe<=22?ve=qt(ge,ve,de[Fe+1]>>1)-1:(qt(ge,ve,3),ve+=5,qt(ge,ve,de[Fe-23]>>5),ve+=3);var _r=Fe<8?0:Fe-4>>2;_r>0&&(Ie(ge,ve,bt-O[Fe]),ve+=_r),Fe=Q[ye-We],ve=qt(ge,ve,de[Fe]>>3),ve-=3;var kr=Fe<4?0:Fe-2>>1;kr>0&&(Ie(ge,ve,ye-We-G[Fe]),ve+=kr);for(var As=0;As<bt;++As)Le[Ke]=ye&32767,Ke=(Ke<<5^Ae[ye])&32767,++ye;ze-=bt-1}else Fe<=143?Fe=Fe+48:ve=Pt(ge,ve,1),ve=qt(ge,ve,de[Fe]),Le[Ke]=ye&32767,++ye}ve=qt(ge,ve,0)-1}return ge.l=(ve+7)/8|0,ge.l}return function(ge,ve){return ge.length<8?re(ge,ve):xe(ge,ve)}})();function ft(W){var Q=Te(50+Math.floor(W.length*1.1)),q=Et(W,Q);return Q.slice(0,q)}var jt=ee?new Uint16Array(32768):De(32768),Lr=ee?new Uint16Array(32768):De(32768),nt=ee?new Uint16Array(128):De(128),dt=1,sr=1;function tn(W,Q){var q=st(W,Q)+257;Q+=5;var K=st(W,Q)+1;Q+=5;var ne=He(W,Q)+4;Q+=4;for(var re=0,xe=ee?new Uint8Array(19):De(19),Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,ve=ee?new Uint8Array(8):De(8),ye=ee?new Uint8Array(8):De(8),Le=xe.length,ze=0;ze<ne;++ze)xe[k[ze]]=re=Re(W,Q),ge<re&&(ge=re),ve[re]++,Q+=3;var Ke=0;for(ve[0]=0,ze=1;ze<=ge;++ze)ye[ze]=Ke=Ke+ve[ze-1]<<1;for(ze=0;ze<Le;++ze)(Ke=xe[ze])!=0&&(Ae[ze]=ye[Ke]++);var Fe=0;for(ze=0;ze<Le;++ze)if(Fe=xe[ze],Fe!=0){Ke=de[Ae[ze]]>>8-Fe;for(var We=(1<<7-Fe)-1;We>=0;--We)nt[Ke|We<<Fe]=Fe&7|ze<<3}var bt=[];for(ge=1;bt.length<q+K;)switch(Ke=nt[Pe(W,Q)],Q+=Ke&7,Ke>>>=3){case 16:for(re=3+Se(W,Q),Q+=2,Ke=bt[bt.length-1];re-- >0;)bt.push(Ke);break;case 17:for(re=3+Re(W,Q),Q+=3;re-- >0;)bt.push(0);break;case 18:for(re=11+Pe(W,Q),Q+=7;re-- >0;)bt.push(0);break;default:bt.push(Ke),ge<Ke&&(ge=Ke);break}var _r=bt.slice(0,q),kr=bt.slice(q);for(ze=q;ze<286;++ze)_r[ze]=0;for(ze=K;ze<30;++ze)kr[ze]=0;return dt=lt(_r,jt,286),sr=lt(kr,Lr,30),Q}function wi(W,Q){if(W[0]==3&&!(W[1]&3))return[li(Q),2];for(var q=0,K=0,ne=xb(Q||1<<18),re=0,xe=ne.length>>>0,Ae=0,ge=0;(K&1)==0;){if(K=Re(W,q),q+=3,K>>>1)K>>1==1?(Ae=9,ge=5):(q=tn(W,q),Ae=dt,ge=sr);else{q&7&&(q+=8-(q&7));var ve=W[q>>>3]|W[(q>>>3)+1]<<8;if(q+=32,ve>0)for(!Q&&xe<re+ve&&(ne=Ue(ne,re+ve),xe=ne.length);ve-- >0;)ne[re++]=W[q>>>3],q+=8;continue}for(;;){!Q&&xe<re+32767&&(ne=Ue(ne,re+32767),xe=ne.length);var ye=Gt(W,q,Ae),Le=K>>>1==1?Ut[ye]:jt[ye];if(q+=Le&15,Le>>>=4,(Le>>>8&255)===0)ne[re++]=Le;else{if(Le==256)break;Le-=257;var ze=Le<8?0:Le-4>>2;ze>5&&(ze=0);var Ke=re+O[Le];ze>0&&(Ke+=Gt(W,q,ze),q+=ze),ye=Gt(W,q,ge),Le=K>>>1==1?rr[ye]:Lr[ye],q+=Le&15,Le>>>=4;var Fe=Le<4?0:Le-2>>1,We=G[Le];for(Fe>0&&(We+=Gt(W,q,Fe),q+=Fe),!Q&&xe<Ke&&(ne=Ue(ne,Ke+100),xe=ne.length);re<Ke;)ne[re]=ne[re-We],++re}}}return Q?[ne,q+7>>>3]:[ne.slice(0,re),q+7>>>3]}function gn(W,Q){var q=W.slice(W.l||0),K=wi(q,Q);return W.l+=K[1],K[0]}function Gn(W,Q){if(W)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function Ni(W,Q){var q=W;Ns(q,0);var K=[],ne=[],re={FileIndex:K,FullPaths:ne};E(re,{root:Q.root});for(var xe=q.length-4;(q[xe]!=80||q[xe+1]!=75||q[xe+2]!=5||q[xe+3]!=6)&&xe>=0;)--xe;q.l=xe+4,q.l+=4;var Ae=q.read_shift(2);q.l+=6;var ge=q.read_shift(4);for(q.l=ge,xe=0;xe<Ae;++xe){q.l+=20;var ve=q.read_shift(4),ye=q.read_shift(4),Le=q.read_shift(2),ze=q.read_shift(2),Ke=q.read_shift(2);q.l+=8;var Fe=q.read_shift(4),We=o(q.slice(q.l+Le,q.l+Le+ze));q.l+=Le+ze+Ke;var bt=q.l;q.l=Fe+4,pe(q,ve,ye,re,We),q.l=bt}return re}function pe(W,Q,q,K,ne){W.l+=2;var re=W.read_shift(2),xe=W.read_shift(2),Ae=l(W);if(re&8257)throw new Error("Unsupported ZIP encryption");for(var ge=W.read_shift(4),ve=W.read_shift(4),ye=W.read_shift(4),Le=W.read_shift(2),ze=W.read_shift(2),Ke="",Fe=0;Fe<Le;++Fe)Ke+=String.fromCharCode(W[W.l++]);if(ze){var We=o(W.slice(W.l,W.l+ze));(We[21589]||{}).mt&&(Ae=We[21589].mt),((ne||{})[21589]||{}).mt&&(Ae=ne[21589].mt)}W.l+=ze;var bt=W.slice(W.l,W.l+ve);switch(xe){case 8:bt=Y(W,ye);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var _r=!1;re&8&&(ge=W.read_shift(4),ge==134695760&&(ge=W.read_shift(4),_r=!0),ve=W.read_shift(4),ye=W.read_shift(4)),ve!=Q&&Gn(_r,"Bad compressed size: "+Q+" != "+ve),ye!=q&&Gn(_r,"Bad uncompressed size: "+q+" != "+ye),Ze(K,Ke,bt,{unsafe:!0,mt:Ae})}function ce(W,Q){var q=Q||{},K=[],ne=[],re=Te(1),xe=q.compression?8:0,Ae=0,ge=0,ve=0,ye=0,Le=0,ze=W.FullPaths[0],Ke=ze,Fe=W.FileIndex[0],We=[],bt=0;for(ge=1;ge<W.FullPaths.length;++ge)if(Ke=W.FullPaths[ge].slice(ze.length),Fe=W.FileIndex[ge],!(!Fe.size||!Fe.content||Ke=="Sh33tJ5")){var _r=ye,kr=Te(Ke.length);for(ve=0;ve<Ke.length;++ve)kr.write_shift(1,Ke.charCodeAt(ve)&127);kr=kr.slice(0,kr.l),We[Le]=IR.buf(Fe.content,0);var As=Fe.content;xe==8&&(As=z(As)),re=Te(30),re.write_shift(4,67324752),re.write_shift(2,20),re.write_shift(2,Ae),re.write_shift(2,xe),Fe.mt?i(re,Fe.mt):re.write_shift(4,0),re.write_shift(-4,We[Le]),re.write_shift(4,As.length),re.write_shift(4,Fe.content.length),re.write_shift(2,kr.length),re.write_shift(2,0),ye+=re.length,K.push(re),ye+=kr.length,K.push(kr),ye+=As.length,K.push(As),re=Te(46),re.write_shift(4,33639248),re.write_shift(2,0),re.write_shift(2,20),re.write_shift(2,Ae),re.write_shift(2,xe),re.write_shift(4,0),re.write_shift(-4,We[Le]),re.write_shift(4,As.length),re.write_shift(4,Fe.content.length),re.write_shift(2,kr.length),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(4,0),re.write_shift(4,_r),bt+=re.l,ne.push(re),bt+=kr.length,ne.push(kr),++Le}return re=Te(22),re.write_shift(4,101010256),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,Le),re.write_shift(2,Le),re.write_shift(4,bt),re.write_shift(4,ye),re.write_shift(2,0),ds([ds(K),ds(ne),re])}var we={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ve(W,Q){if(W.ctype)return W.ctype;var q=W.name||"",K=q.match(/\.([^\.]+)$/);return K&&we[K[1]]||Q&&(K=(q=Q).match(/[\.\\]([^\.\\])+$/),K&&we[K[1]])?we[K[1]]:"application/octet-stream"}function $e(W){for(var Q=Qo(W),q=[],K=0;K<Q.length;K+=76)q.push(Q.slice(K,K+76));return q.join(`\r
`)+`\r
`}function qe(W){var Q=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ve){var ye=ve.charCodeAt(0).toString(16).toUpperCase();return"="+(ye.length==1?"0"+ye:ye)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],K=Q.split(`\r
`),ne=0;ne<K.length;++ne){var re=K[ne];if(re.length==0){q.push("");continue}for(var xe=0;xe<re.length;){var Ae=76,ge=re.slice(xe,xe+Ae);ge.charAt(Ae-1)=="="?Ae--:ge.charAt(Ae-2)=="="?Ae-=2:ge.charAt(Ae-3)=="="&&(Ae-=3),ge=re.slice(xe,xe+Ae),xe+=Ae,xe<re.length&&(ge+="="),q.push(ge)}}return q.join(`\r
`)}function Ct(W){for(var Q=[],q=0;q<W.length;++q){for(var K=W[q];q<=W.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+W[++q];Q.push(K)}for(var ne=0;ne<Q.length;++ne)Q[ne]=Q[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(re){return String.fromCharCode(parseInt(re.slice(1),16))});return da(Q.join(`\r
`))}function mr(W,Q,q){for(var K="",ne="",re="",xe,Ae=0;Ae<10;++Ae){var ge=Q[Ae];if(!ge||ge.match(/^\s*$/))break;var ve=ge.match(/^(.*?):\s*([^\s].*)$/);if(ve)switch(ve[1].toLowerCase()){case"content-location":K=ve[2].trim();break;case"content-type":re=ve[2].trim();break;case"content-transfer-encoding":ne=ve[2].trim();break}}switch(++Ae,ne.toLowerCase()){case"base64":xe=da(ha(Q.slice(Ae).join("")));break;case"quoted-printable":xe=Ct(Q.slice(Ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var ye=Ze(W,K.slice(q.length),xe,{unsafe:!0});re&&(ye.ctype=re)}function et(W,Q){if(V(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=Q&&Q.root||"",K=(Dt&&Buffer.isBuffer(W)?W.toString("binary"):V(W)).split(`\r
`),ne=0,re="";for(ne=0;ne<K.length;++ne)if(re=K[ne],!!/^Content-Location:/i.test(re)&&(re=re.slice(re.indexOf("file")),q||(q=re.slice(0,re.lastIndexOf("/")+1)),re.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),re.slice(0,q.length)!=q););var xe=(K[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var Ae="--"+(xe[1]||""),ge=[],ve=[],ye={FileIndex:ge,FullPaths:ve};E(ye);var Le,ze=0;for(ne=0;ne<K.length;++ne){var Ke=K[ne];Ke!==Ae&&Ke!==Ae+"--"||(ze++&&mr(ye,K.slice(Le,ne),q),Le=ne)}return ye}function gt(W,Q){var q=Q||{},K=q.boundary||"SheetJS";K="------="+K;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],re=W.FullPaths[0],xe=re,Ae=W.FileIndex[0],ge=1;ge<W.FullPaths.length;++ge)if(xe=W.FullPaths[ge].slice(re.length),Ae=W.FileIndex[ge],!(!Ae.size||!Ae.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(bt){return"_x"+bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(bt){return"_u"+bt.charCodeAt(0).toString(16)+"_"});for(var ve=Ae.content,ye=Dt&&Buffer.isBuffer(ve)?ve.toString("binary"):V(ve),Le=0,ze=Math.min(1024,ye.length),Ke=0,Fe=0;Fe<=ze;++Fe)(Ke=ye.charCodeAt(Fe))>=32&&Ke<128&&++Le;var We=Le>=ze*4/5;ne.push(K),ne.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+xe),ne.push("Content-Transfer-Encoding: "+(We?"quoted-printable":"base64")),ne.push("Content-Type: "+Ve(Ae,xe)),ne.push(""),ne.push(We?qe(ye):$e(ye))}return ne.push(K+`--\r
`),ne.join(`\r
`)}function ot(W){var Q={};return E(Q,W),Q}function Ze(W,Q,q,K){var ne=K&&K.unsafe;ne||E(W);var re=!ne&&it.find(W,Q);if(!re){var xe=W.FullPaths[0];Q.slice(0,xe.length)==xe?xe=Q:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+Q).replace("//","/")),re={name:n(Q),type:2},W.FileIndex.push(re),W.FullPaths.push(xe),ne||it.utils.cfb_gc(W)}return re.content=q,re.size=q?q.length:0,K&&(K.CLSID&&(re.clsid=K.CLSID),K.mt&&(re.mt=K.mt),K.ct&&(re.ct=K.ct)),re}function Rt(W,Q){E(W);var q=it.find(W,Q);if(q){for(var K=0;K<W.FileIndex.length;++K)if(W.FileIndex[K]==q)return W.FileIndex.splice(K,1),W.FullPaths.splice(K,1),!0}return!1}function Lt(W,Q,q){E(W);var K=it.find(W,Q);if(K){for(var ne=0;ne<W.FileIndex.length;++ne)if(W.FileIndex[ne]==K)return W.FileIndex[ne].name=n(q),W.FullPaths[ne]=q,!0}return!1}function Us(W){T(W,!0)}return t.find=A,t.read=S,t.parse=d,t.write=me,t.writeFile=ae,t.utils={cfb_new:ot,cfb_add:Ze,cfb_del:Rt,cfb_mov:Lt,cfb_gc:Us,ReadShift:Mo,CheckField:AE,prep_blob:Ns,bconcat:ds,use_zlib:F,_deflateRaw:ft,_inflateRaw:gn,consts:ie},t})();function OR(e){return typeof e=="string"?lm(e):Array.isArray(e)?nR(e):e}function Ic(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=lm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?on(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([OR(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=hi(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function PR(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Br(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Sb(e,t){for(var r=[],a=Br(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function cm(e){for(var t=[],r=Br(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function dm(e){for(var t=[],r=Br(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function RR(e){for(var t=[],r=Br(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var ru=new Date(1899,11,30,0,0,0);function ss(e,t){var r=e.getTime(),a=ru.getTime()+(e.getTimezoneOffset()-ru.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var iE=new Date,LR=ru.getTime()+(iE.getTimezoneOffset()-ru.getTimezoneOffset())*6e4,Eb=iE.getTimezoneOffset();function um(e){var t=new Date;return t.setTime(e*24*60*60*1e3+LR),t.getTimezoneOffset()!==Eb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Eb)*6e4),t}function FR(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var Tb=new Date("2017-02-19T19:06:09.000Z"),lE=isNaN(Tb.getFullYear())?new Date("2/19/17"):Tb,MR=lE.getFullYear()==2017;function jr(e,t){var r=new Date(e);if(MR)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(lE.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ji(e,t){if(Dt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return on(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return on(KS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return on(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return on(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function wr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=wr(e[r]));return t}function Fr(e,t){for(var r="";r.length<t;)r+=e;return r}function Xa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var BR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bl(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&BR.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var zR=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),l=[i[0]],o=1;o<i.length;++o)l.push(n),l.push(i[o]);return l}})();function oE(e){return e?e.content&&e.type?Ji(e.content,!0):e.data?Io(e.data):e.asNodeBuffer&&Dt?Io(e.asNodeBuffer().toString("binary")):e.asBinary?Io(e.asBinary()):e._data&&e._data.getContent?Io(Ji(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function cE(e){if(!e)return null;if(e.data)return hb(e.data);if(e.asNodeBuffer&&Dt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?hb(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function UR(e){return e&&e.name.slice(-4)===".bin"?cE(e):oE(e)}function Ca(e,t){for(var r=e.FullPaths||Br(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function ig(e,t){var r=Ca(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function qr(e,t,r){if(!r)return UR(ig(e,t));if(!t)return null;try{return qr(e,t)}catch{return null}}function ua(e,t,r){if(!r)return oE(ig(e,t));if(!t)return null;try{return ua(e,t)}catch{return null}}function $R(e,t,r){return cE(ig(e,t))}function Ab(e){for(var t=e.FullPaths||Br(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Tt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Dt?a=Fn(r):a=iR(r),it.utils.cfb_add(e,t,a)}it.utils.cfb_add(e,t,r)}else e.file(t,r)}function lg(){return it.utils.cfb_new()}function dE(e,t){switch(t.type){case"base64":return it.read(e,{type:"base64"});case"binary":return it.read(e,{type:"binary"});case"buffer":case"array":return it.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Po(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Hr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,WR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Cb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,HR=/<[^>]*>/g,zs=Hr.match(Cb)?Cb:HR,VR=/<\w*:/,GR=/<(\/?)\w+:/;function ht(e,t,r){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var l=e.match(WR),o=0,c="",u=0,d="",m="",f=1;if(l)for(u=0;u!=l.length;++u){for(m=l[u],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(d=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(f=(n=m.charCodeAt(i+1))==34||n==39?1:0,c=m.slice(i+1+f,m.length-f),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=c,a[d.toLowerCase()]=c;else{var x=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(a[x]&&d.slice(o-3,o)=="ext")continue;a[x]=c,a[x.toLowerCase()]=c}}return a}function pn(e){return e.replace(GR,"<$1")}var uE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},og=cm(uE),Kt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return uE[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,l)+r(n.slice(l+3))}})(),cg=/[&<>'"]/g,qR=/[\u0000-\u0008\u000b-\u001f]/g;function or(e){var t=e+"";return t.replace(cg,function(r){return og[r]}).replace(qR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function _b(e){return or(e).replace(/ /g,"_x0020_")}var mE=/[\u0000-\u001f]/g;function dg(e){var t=e+"";return t.replace(cg,function(r){return og[r]}).replace(/\n/g,"<br/>").replace(mE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function KR(e){var t=e+"";return t.replace(cg,function(r){return og[r]}).replace(mE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var kb=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function YR(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function br(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sf(e){for(var t="",r=0,a=0,n=0,i=0,l=0,o=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}l=e.charCodeAt(r++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Db(e){var t=li(2*e.length),r,a,n=1,i=0,l=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Ib(e){return Fn(e,"binary").toString("utf8")}var dd="foo bar baz",dr=Dt&&(Ib(dd)==sf(dd)&&Ib||Db(dd)==sf(dd)&&Db)||sf,on=Dt?function(e){return Fn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},tc=(function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),fE=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),XR=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),JR=/<\/?(?:vt:)?variant>/g,ZR=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ob(e,t){var r=ht(e),a=e.match(XR(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var l=i.replace(JR,"").match(ZR);l&&n.push({v:dr(l[2]),t:l[1]})}),n}var hE=/(^\s|\s$|\n)/;function Es(e,t){return"<"+e+(t.match(hE)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function rc(e){return Br(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Me(e,t,r){return"<"+e+(r!=null?rc(r):"")+(t!=null?(t.match(hE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Mp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function QR(e,t){switch(typeof e){case"string":var r=Me("vt:lpwstr",or(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Me((e|0)==e?"vt:i4":"vt:r8",or(String(e)));case"boolean":return Me("vt:bool",e?"true":"false")}if(e instanceof Date)return Me("vt:filetime",Mp(e));throw new Error("Unable to serialize "+e)}function ug(e){if(Dt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return dr(hi(sg(e)));throw new Error("Bad input format: expected Buffer or string")}var sc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,es={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},cl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function e8(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function t8(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,l=a?-t:t;isFinite(l)?l==0?n=i=0:(n=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var Pb=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Rb=Dt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Fn(t)})):Pb(e)}:Pb,Lb=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(jn(e,n)));return a.join("").replace(Ys,"")},mg=Dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ys,""):Lb(e,t,r)}:Lb,Fb=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},pE=Dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Fb(e,t,r)}:Fb,Mb=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Tl(e,n)));return a.join("")},Oc=Dt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Mb(t,r,a)}:Mb,xE=function(e,t){var r=ca(e,t);return r>0?Oc(e,t+4,t+4+r-1):""},gE=xE,vE=function(e,t){var r=ca(e,t);return r>0?Oc(e,t+4,t+4+r-1):""},bE=vE,yE=function(e,t){var r=2*ca(e,t);return r>0?Oc(e,t+4,t+4+r-1):""},jE=yE,wE=function(t,r){var a=ca(t,r);return a>0?mg(t,r+4,r+4+a):""},NE=wE,SE=function(e,t){var r=ca(e,t);return r>0?Oc(e,t+4,t+4+r):""},EE=SE,TE=function(e,t){return e8(e,t)},su=TE,fg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Dt&&(gE=function(t,r){if(!Buffer.isBuffer(t))return xE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},bE=function(t,r){if(!Buffer.isBuffer(t))return vE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},jE=function(t,r){if(!Buffer.isBuffer(t))return yE(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},NE=function(t,r){if(!Buffer.isBuffer(t))return wE(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},EE=function(t,r){if(!Buffer.isBuffer(t))return SE(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},su=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):TE(t,r)},fg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Tl=function(e,t){return e[t]},jn=function(e,t){return e[t+1]*256+e[t]},r8=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ca=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},_i=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},s8=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Mo(e,t){var r="",a,n,i=[],l,o,c,u;switch(t){case"dbcs":if(u=this.l,Dt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(jn(this,u)),u+=2;e*=2;break;case"utf8":r=Oc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=mg(this,this.l,this.l+e);break;case"wstr":return Mo.call(this,e,"dbcs");case"lpstr-ansi":r=gE(this,this.l),e=4+ca(this,this.l);break;case"lpstr-cp":r=bE(this,this.l),e=4+ca(this,this.l);break;case"lpwstr":r=jE(this,this.l),e=4+2*ca(this,this.l);break;case"lpp4":e=4+ca(this,this.l),r=NE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ca(this,this.l),r=EE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Tl(this,this.l+e++))!==0;)i.push(cd(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=jn(this,this.l+e))!==0;)i.push(cd(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Tl(this,u),this.l=u+1,o=Mo.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(cd(jn(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Tl(this,u),this.l=u+1,o=Mo.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(cd(Tl(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return a=Tl(this,this.l),this.l++,a;case 2:return a=(t==="i"?r8:jn)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?_i:s8)(this,this.l),this.l+=4,a):(n=ca(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=su(this,this.l):n=su([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=pE(this,this.l,e);break}}return this.l+=e,r}var a8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},n8=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},i8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function l8(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)i8(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,a8(this,t,this.l);break;case 8:if(a=8,r==="f"){t8(this,t,this.l);break}case 16:break;case-4:a=4,n8(this,t,this.l);break}return this.l+=a,this}function AE(e,t){var r=pE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ns(e,t){e.l=t,e.read_shift=Mo,e.chk=AE,e.write_shift=l8}function Bs(e,t){e.l+=t}function Te(e){var t=li(e);return Ns(t,0),t}function Mn(e,t,r){if(e){var a,n,i;Ns(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=cc[o]||cc[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,o))return}}}function ra(){var e=[],t=Dt?256:2048,r=function(u){var d=Te(u);return Ns(d,0),d},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(u){return a&&u<a.length-a.l?a:(n(),a=r(Math.max(u+1,t)))},l=function(){return n(),ds(e)},o=function(u){n(),a=u,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:o,end:l,_bufs:e}}function Oe(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=cc[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=e.next(i);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&fg(r)&&e.push(r)}}function Bo(e,t,r){var a=wr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Bb(e,t,r){var a=wr(e);return a.s=Bo(a.s,t.s,r),a.e=Bo(a.e,t.s,r),a}function zo(e,t){if(e.cRel&&e.c<0)for(e=wr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=wr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=mt(e);return!e.cRel&&e.cRel!=null&&(r=d8(r)),!e.rRel&&e.rRel!=null&&(r=o8(r)),r}function af(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ir(e.s.c)+":"+(e.e.cRel?"":"$")+Ir(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Wr(e.s.r)+":"+(e.e.rRel?"":"$")+Wr(e.e.r):zo(e.s,t.biff)+":"+zo(e.e,t.biff)}function hg(e){return parseInt(c8(e),10)-1}function Wr(e){return""+(e+1)}function o8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function c8(e){return e.replace(/\$(\d+)$/,"$1")}function pg(e){for(var t=u8(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Ir(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function d8(e){return e.replace(/^([A-Z])/,"$$$1")}function u8(e){return e.replace(/^\$([A-Z])/,"$1")}function m8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Or(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function mt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function sa(e){var t=e.indexOf(":");return t==-1?{s:Or(e),e:Or(e)}:{s:Or(e.slice(0,t)),e:Or(e.slice(t+1))}}function Nt(e,t){return typeof t>"u"||typeof t=="number"?Nt(e.s,e.e):(typeof e!="string"&&(e=mt(e)),typeof t!="string"&&(t=mt(t)),e==t?e:e+":"+t)}function Xt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function zb(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Fa(e.z,r?ss(t):t)}catch{}try{return e.w=Fa((e.XF||{}).numFmtId||(r?14:0),r?ss(t):t)}catch{return""+t}}function Dn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Bn[e.v]||e.v:t==null?zb(e,e.v):zb(e,t))}function pi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function CE(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),l=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?Or(a.origin):a.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Xt(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[m].length;++f)if(!(typeof t[m][f]>"u")){var x={v:t[m][f]},p=l+m,h=o+f;if(u.s.r>p&&(u.s.r=p),u.s.c>h&&(u.s.c=h),u.e.r<p&&(u.e.r=p),u.e.c<h&&(u.e.c=h),t[m][f]&&typeof t[m][f]=="object"&&!Array.isArray(t[m][f])&&!(t[m][f]instanceof Date))x=t[m][f];else if(Array.isArray(x.v)&&(x.f=t[m][f][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(a.nullError)x.t="e",x.v=0;else if(a.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=a.dateNF||ut[14],a.cellDates?(x.t="d",x.w=Fa(x.z,ss(x.v))):(x.t="n",x.v=ss(x.v),x.w=Fa(x.z,x.v))):x.t="s";if(n)i[p]||(i[p]=[]),i[p][h]&&i[p][h].z&&(x.z=i[p][h].z),i[p][h]=x;else{var g=mt({c:h,r:p});i[g]&&i[g].z&&(x.z=i[g].z),i[g]=x}}}return u.s.c<1e7&&(i["!ref"]=Nt(u)),i}function ao(e,t){return CE(null,e,t)}function f8(e){return e.read_shift(4,"i")}function Ja(e,t){return t||(t=Te(4)),t.write_shift(4,e),t}function Fs(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function us(e,t){var r=!1;return t==null&&(r=!0,t=Te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function h8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function p8(e,t){return t||(t=Te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function xg(e,t){var r=e.l,a=e.read_shift(1),n=Fs(e),i=[],l={t:n,h:n};if((a&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(h8(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function x8(e,t){var r=!1;return t==null&&(r=!0,t=Te(15+4*e.t.length)),t.write_shift(1,0),us(e.t,t),r?t.slice(0,t.l):t}var g8=xg;function v8(e,t){var r=!1;return t==null&&(r=!0,t=Te(23+4*e.t.length)),t.write_shift(1,1),us(e.t,t),t.write_shift(4,1),p8({},t),r?t.slice(0,t.l):t}function Ua(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function dl(e,t){return t==null&&(t=Te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ul(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ml(e,t){return t==null&&(t=Te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var b8=Fs,_E=us;function gg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function au(e,t){var r=!1;return t==null&&(r=!0,t=Te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var y8=Fs,Bp=gg,vg=au;function bg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?su([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):_i(t,0)>>2;return r?n/100:n}function kE(e,t){t==null&&(t=Te(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function DE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function j8(e,t){return t||(t=Te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var fl=DE,no=j8;function Rs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zi(e,t){return(t||Te(8)).write_shift(8,e,"f")}function w8(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var u=Mi[n];u&&(t.rgb=nc(u));break;case 2:t.rgb=nc([l,o,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function nu(e,t){if(t||(t=Te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function N8(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function S8(e,t){t||(t=Te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function IE(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function E8(e){return IE(e,1)}function T8(e){return IE(e,2)}var yg=2,Js=3,ud=11,Ub=12,iu=19,md=64,A8=65,C8=71,_8=4108,k8=4126,os=80,OE=81,D8=[os,OE],zp={1:{n:"CodePage",t:yg},2:{n:"Category",t:os},3:{n:"PresentationFormat",t:os},4:{n:"ByteCount",t:Js},5:{n:"LineCount",t:Js},6:{n:"ParagraphCount",t:Js},7:{n:"SlideCount",t:Js},8:{n:"NoteCount",t:Js},9:{n:"HiddenCount",t:Js},10:{n:"MultimediaClipCount",t:Js},11:{n:"ScaleCrop",t:ud},12:{n:"HeadingPairs",t:_8},13:{n:"TitlesOfParts",t:k8},14:{n:"Manager",t:os},15:{n:"Company",t:os},16:{n:"LinksUpToDate",t:ud},17:{n:"CharacterCount",t:Js},19:{n:"SharedDoc",t:ud},22:{n:"HyperlinksChanged",t:ud},23:{n:"AppVersion",t:Js,p:"version"},24:{n:"DigSig",t:A8},26:{n:"ContentType",t:os},27:{n:"ContentStatus",t:os},28:{n:"Language",t:os},29:{n:"Version",t:os},255:{},2147483648:{n:"Locale",t:iu},2147483651:{n:"Behavior",t:iu},1919054434:{}},Up={1:{n:"CodePage",t:yg},2:{n:"Title",t:os},3:{n:"Subject",t:os},4:{n:"Author",t:os},5:{n:"Keywords",t:os},6:{n:"Comments",t:os},7:{n:"Template",t:os},8:{n:"LastAuthor",t:os},9:{n:"RevNumber",t:os},10:{n:"EditTime",t:md},11:{n:"LastPrinted",t:md},12:{n:"CreatedDate",t:md},13:{n:"ModifiedDate",t:md},14:{n:"PageCount",t:Js},15:{n:"WordCount",t:Js},16:{n:"CharCount",t:Js},17:{n:"Thumbnail",t:C8},18:{n:"Application",t:os},19:{n:"DocSecurity",t:Js},255:{},2147483648:{n:"Locale",t:iu},2147483651:{n:"Behavior",t:iu},1919054434:{}},$b={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},I8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function O8(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var P8=O8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Mi=wr(P8),Bn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},PE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$p={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function R8(e){var t=jg();if(!e||!e.match)return t;var r={};if((e.match(zs)||[]).forEach(function(a){var n=ht(a);switch(n[0].replace(VR,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[$p[n.ContentType]]!==void 0&&t[$p[n.ContentType]].push(n.PartName);break}}),t.xmlns!==es.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function RE(e,t){var r=RR($p),a=[],n;a[a.length]=Hr,a[a.length]=Me("Types",null,{xmlns:es.CT,"xmlns:xsd":es.xsd,"xmlns:xsi":es.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Me("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=Me("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:fd[c][t.bookType]||fd[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(u){a[a.length]=Me("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:fd[c][t.bookType]||fd[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){a[a.length]=Me("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Ot={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ac(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Uo(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(zs)||[]).forEach(function(n){var i=ht(n);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Po(i.Target,t);r[o]=l,a[i.Id]=l}}),r["!id"]=a,r}function kl(e){var t=[Hr,Me("Relationships",null,{xmlns:es.RELS})];return Br(e["!id"]).forEach(function(r){t[t.length]=Me("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ir(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[Ot.HLINK,Ot.XPATH,Ot.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var L8="application/vnd.oasis.opendocument.spreadsheet";function F8(e,t){for(var r=ug(e),a,n;a=sc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=ht(a[0],!1),n.path=="/"&&n.type!==L8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function M8(e){var t=[Hr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Wb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function B8(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function z8(e){var t=[Hr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Wb(e[r][0],e[r][1])),t.push(B8("",e[r][0]));return t.push(Wb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function LE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Zd.version+"</meta:generator></office:meta></office:document-meta>"}var La=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],U8=(function(){for(var e=new Array(La.length),t=0;t<La.length;++t){var r=La[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function FE(e){var t={};e=dr(e);for(var r=0;r<La.length;++r){var a=La[r],n=e.match(U8[r]);n!=null&&n.length>0&&(t[a[1]]=Kt(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=jr(t[a[1]]))}return t}function nf(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=or(t),a[a.length]=r?Me(e,t,r):Es(e,t))}function ME(e,t){var r=t||{},a=[Hr,Me("cp:coreProperties",null,{"xmlns:cp":es.CORE_PROPS,"xmlns:dc":es.dc,"xmlns:dcterms":es.dcterms,"xmlns:dcmitype":es.dcmitype,"xmlns:xsi":es.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&nf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Mp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&nf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Mp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=La.length;++i){var l=La[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&nf(l[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Bi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],BE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function zE(e,t,r,a){var n=[];if(typeof e=="string")n=Ob(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(d){return{v:d}}));var l=typeof t=="string"?Ob(t,a).map(function(d){return d.v}):t,o=0,c=0;if(l.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=l.slice(o,o+c);break}o+=c}}function $8(e,t,r){var a={};return t||(t={}),e=dr(e),Bi.forEach(function(n){var i=(e.match(tc(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Kt(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&zE(a.HeadingPairs,a.TitlesOfParts,t,r),t}function UE(e){var t=[],r=Me;return e||(e={}),e.Application="SheetJS",t[t.length]=Hr,t[t.length]=Me("Properties",null,{xmlns:es.EXT_PROPS,"xmlns:vt":es.vt}),Bi.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=or(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+or(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var W8=/<[^>]+>[^<]*/g;function H8(e,t){var r={},a="",n=e.match(W8);if(n)for(var i=0;i!=n.length;++i){var l=n[i],o=ht(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Kt(o.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[a]=Kt(d);break;case"bool":r[a]=br(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=jr(d);break;case"cy":case"error":r[a]=Kt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,u,c)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function $E(e){var t=[Hr,Me("Properties",null,{xmlns:es.CUST_PROPS,"xmlns:vt":es.vt})];if(!e)return t.join("");var r=1;return Br(e).forEach(function(n){++r,t[t.length]=Me("property",QR(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:or(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Wp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},lf;function V8(e,t,r){lf||(lf=cm(Wp)),t=lf[t]||t,e[t]=r}function G8(e,t){var r=[];return Br(Wp).map(function(a){for(var n=0;n<La.length;++n)if(La[n][1]==a)return La[n];for(n=0;n<Bi.length;++n)if(Bi[n][1]==a)return Bi[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Es(Wp[a[1]]||a[1],n))}}),Me("DocumentProperties",r.join(""),{xmlns:oa.o})}function q8(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Br(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<La.length;++l)if(i==La[l][1])return;for(l=0;l<Bi.length;++l)if(i==Bi[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(Me(_b(i),o,{"dt:dt":c}))}}),t&&Br(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),n.push(Me(_b(i),l,{"dt:dt":o}))}}),"<"+a+' xmlns="'+oa.o+'">'+n.join("")+"</"+a+">"}function wg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function K8(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var l=Te(8);return l.write_shift(4,a),l.write_shift(4,n),l}function WE(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function HE(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function VE(e,t,r){return t===31?HE(e):WE(e,t,r)}function Hp(e,t,r){return VE(e,t,r===!1?0:4)}function Y8(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return VE(e,t,0)}function X8(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Ys,""),e.l-n&2&&(e.l+=2)}return r}function J8(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Ys,"");return r}function Z8(e){var t=e.l,r=lu(e,OE);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=lu(e,Js);return[r,a]}function Q8(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(Z8(e));return r}function Hb(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var i=e.read_shift(4),l=e.read_shift(4);a[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Ys,"").replace(Oo,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function GE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function eL(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function lu(e,t,r){var a=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==Ub&&a!==t&&D8.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Ub?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return WE(e,a,4).replace(Ys,"");case 31:return HE(e);case 64:return wg(e);case 65:return GE(e);case 71:return eL(e);case 80:return Hp(e,a,!i.raw).replace(Ys,"");case 81:return Y8(e,a).replace(Ys,"");case 4108:return Q8(e);case 4126:case 4127:return a==4127?X8(e):J8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Vb(e,t){var r=Te(4),a=Te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Te(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=K8(t);break;case 31:case 80:for(a=Te(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ds([r,a])}function Gb(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],l=0,o=0,c=-1,u={};for(l=0;l!=n;++l){var d=e.read_shift(4),m=e.read_shift(4);i[l]=[d,m+r]}i.sort(function(j,y){return j[1]-y[1]});var f={};for(l=0;l!=n;++l){if(e.l!==i[l][1]){var x=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],x=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],x=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(x=!1,e.l=i[l][1]),x)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[i[l][0]];if(f[p.n]=lu(e,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ka(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(i[l][0]===1){if(o=f.CodePage=lu(e,yg),Ka(o),c!==-1){var h=e.l;e.l=i[c][1],u=Hb(e,o),e.l=h}}else if(i[l][0]===0){if(o===0){c=l,e.l=i[l+1][1];continue}u=Hb(e,o)}else{var g=u[i[l][0]],b;switch(e[e.l]){case 65:e.l+=4,b=GE(e);break;case 30:e.l+=4,b=Hp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=Hp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=zr(e,4);break;case 64:e.l+=4,b=jr(wg(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[g]=b}}return e.l=r+a,f}var qE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function tL(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function qb(e,t,r){var a=Te(8),n=[],i=[],l=8,o=0,c=Te(8),u=Te(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),n.push(u),l+=8+c.length,!t){u=Te(8),u.write_shift(4,0),n.unshift(u);var d=[Te(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var m=e[o][0];for(c=Te(8+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=ds(d),i.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(qE.indexOf(e[o][0])>-1||BE.indexOf(e[o][0])>-1)&&e[o][1]!=null){var f=e[o][1],x=0;if(t){x=+t[e[o][0]];var p=r[x];if(p.p=="version"&&typeof f=="string"){var h=f.split(".");f=(+h[0]<<16)+(+h[1]||0)}c=Vb(p.t,f)}else{var g=tL(f);g==-1&&(g=31,f=String(f)),c=Vb(g,f)}i.push(c),u=Te(8),u.write_shift(4,t?x:2+o),n.push(u),l+=8+c.length}var b=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,b),b+=i[o].length;return a.write_shift(4,l),a.write_shift(4,i.length),ds([a].concat(n).concat(i))}function Kb(e,t,r){var a=e.content;if(!a)return{};Ns(a,0);var n,i,l,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var u=a.read_shift(4),d=a.read_shift(16);if(d!==it.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(l=a.read_shift(16),c=a.read_shift(4));var m=Gb(a,t),f={SystemIdentifier:u};for(var x in m)f[x]=m[x];if(f.FMTID=i,n===1)return f;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var p;try{p=Gb(a,null)}catch{}for(x in p)f[x]=p[x];return f.FMTID=[i,l],f}function Yb(e,t,r,a,n,i){var l=Te(n?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,it.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,n?68:48);var c=qb(e,r,a);if(o.push(c),n){var u=qb(n,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+c.length),o.push(u)}return ds(o)}function Yn(e,t){return e.read_shift(t),null}function rL(e,t){t||(t=Te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function sL(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function zr(e,t){return e.read_shift(t)===1}function Vs(e,t){return t||(t=Te(2)),t.write_shift(2,+!!e),t}function Kr(e){return e.read_shift(2,"u")}function ka(e,t){return t||(t=Te(2)),t.write_shift(2,e),t}function KE(e,t){return sL(e,t,Kr)}function aL(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function YE(e,t,r){return r||(r=Te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Pc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?e.read_shift(a,n):"";return l}function nL(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,i=1+(r&1),l=0,o,c={};n&&(l=e.read_shift(2)),a&&(o=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*l),a&&(e.l+=o),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function iL(e){var t=e.t||"",r=Te(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Te(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return ds(n)}function Qi(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Rc(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Qi(e,a,r)}function hl(e,t,r){if(r.biff>5)return Rc(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function XE(e,t,r){return r||(r=Te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function lL(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function oL(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Ys,"");return a&&(e.l+=24),n}function cL(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(Ys,"");return r+l}function dL(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return oL(e);case"0303000000000000c000000000000046":return cL(e);default:throw new Error("Unsupported Moniker "+r)}}function hd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ys,""):"";return r}function Xb(e,t){t||(t=Te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function uL(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,l,o,c,u="",d,m;n&16&&(i=hd(e,r-e.l)),n&128&&(l=hd(e,r-e.l)),(n&257)===257&&(o=hd(e,r-e.l)),(n&257)===1&&(c=dL(e,r-e.l)),n&8&&(u=hd(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(m=wg(e)),e.l=r;var f=l||o||c||"";f&&u&&(f+="#"+u),f||(f="#"+u),n&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var x={Target:f};return d&&(x.guid=d),m&&(x.time=m),i&&(x.Tooltip=i),x}function mL(e){var t=Te(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)a=a.slice(1),Xb(a,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&Xb(n>-1?a.slice(n+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function JE(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function ZE(e,t){var r=JE(e);return r[3]=0,r}function xn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function el(e,t,r,a){return a||(a=Te(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function fL(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function hL(e,t,r){return t===0?"":hl(e,t,r)}function pL(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[n,i,l]}function QE(e){var t=e.read_shift(2),r=bg(e);return[t,r]}function xL(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=Pc(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function mm(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function eT(e,t){return t||(t=Te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function tT(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var gL=tT;function rT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function vL(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function bL(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Cs(e){e.l+=2,e.l+=e.read_shift(2)}var yL={0:Cs,4:Cs,5:Cs,6:Cs,7:bL,8:Cs,9:Cs,10:Cs,11:Cs,12:Cs,13:vL,14:Cs,15:Cs,16:Cs,17:Cs,18:Cs,19:Cs,20:Cs,21:rT};function jL(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(yL[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function pd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ng(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Te(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function wL(e,t){return t===0||e.read_shift(2),1200}function NL(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=hl(e,0,r);return e.read_shift(t+a-e.l),n}function SL(e,t){var r=!t||t.biff==8,a=Te(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function EL(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function TL(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=Pc(e,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:i,name:l}}function AL(e,t){var r=!t||t.biff>=8?2:1,a=Te(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function CL(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),i=[],l=0;l!=n&&e.l<r;++l)i.push(nL(e));return i.Count=a,i.Unique=n,i}function _L(e,t){var r=Te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=iL(e[n]);var i=ds([r].concat(a));return i.parts=[r.length].concat(a.map(function(l){return l.length})),i}function kL(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function DL(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function IL(e){var t=fL(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function OL(e){return e.read_shift(2),e.read_shift(4)}function Jb(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function PL(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:i,CurTab:l,FirstTab:o,Selected:c,TabRatio:u}}function RL(){var e=Te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function LL(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function FL(e){var t=Te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function ML(){}function BL(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Pc(e,0,r),a}function zL(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=Te(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function UL(e){var t=xn(e);return t.isst=e.read_shift(4),t}function $L(e,t,r,a){var n=Te(10);return el(e,t,a,n),n.write_shift(4,r),n}function WL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=xn(e);r.biff==2&&e.l++;var i=Rc(e,a-e.l,r);return n.val=i,n}function HL(e,t,r,a,n){var i=!n||n.biff==8,l=Te(8+ +i+(1+i)*r.length);return el(e,t,a,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function VL(e,t,r){var a=e.read_shift(2),n=hl(e,0,r);return[a,n]}function GL(e,t,r,a){var n=r&&r.biff==5;a||(a=Te(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var qL=hl;function Zb(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:o},e:{r:l,c}}}function KL(e,t){var r=t.biff==8||!t.biff?4:2,a=Te(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function YL(e){var t=e.read_shift(2),r=e.read_shift(2),a=QE(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function XL(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(QE(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:i}}function JL(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:i}}function ZL(e,t,r,a){var n={},i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=I8[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function QL(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=ZL(e,t,a.fStyle,r),a}function Qb(e,t,r,a){var n=r&&r.biff==5;a||(a=Te(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function eF(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function tF(e){var t=Te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ey(e,t,r){var a=xn(e);(r.biff==2||t==9)&&++e.l;var n=aL(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function rF(e,t,r,a,n,i){var l=Te(8);return el(e,t,a,l),YE(r,i,l),l}function sF(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=xn(e),n=Rs(e);return a.val=n,a}function aF(e,t,r,a){var n=Te(14);return el(e,t,a,n),Zi(r,n),n}var ty=hL;function nF(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Qi(e,i),o=[];a>e.l;)o.push(Rc(e));return[i,n,l,o]}function ry(e,t,r){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=xL(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var iF=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function sy(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Qi(e,l,r);n&32&&(u=iF[u.charCodeAt(0)]);var d=a-e.l;r&&r.biff==2&&--d;var m=a==e.l||o===0||!(d>0)?[]:j9(e,d,r,o);return{chKey:i,Name:u,itab:c,rgce:m}}function sT(e,t,r){if(r.biff<8)return lF(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(pL(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function lF(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Pc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function oF(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),i=Qi(e,a,r),l=Qi(e,n,r);return[i,l]}function cF(e,t,r){var a=tT(e);e.l++;var n=e.read_shift(1);return t-=8,[w9(e,t,r),n,a]}function ay(e,t,r){var a=gL(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,b9(e,t,r)]}function dF(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function uF(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=hl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},o,l,i]}}function mF(e,t,r){return uF(e,t,r)}function fF(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(mm(e));return r}function hF(e){var t=Te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)eT(e[r],t);return t}function pF(e,t,r){if(r&&r.biff<8)return gF(e,t,r);var a=rT(e),n=jL(e,t-22,a[1]);return{cmo:a,ft:n}}var xF={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function gF(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((xF[a]||Bs)(e,t,r)),{cmo:[n,a,i],ft:l}}function vF(e,t,r){var a=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=lL(e,6,r);var o=e.read_shift(2);e.read_shift(2),Kr(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-a!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],m=Qi(e,e.lens[u+1]-e.lens[u]-1);if(n+=m,n.length>=(d?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function bF(e,t){var r=mm(e);e.l+=16;var a=uL(e,t-24);return[r,a]}function yF(e){var t=Te(24),r=Or(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return ds([t,mL(e[1])])}function jF(e,t){e.read_shift(2);var r=mm(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Ys,""),[r,a]}function wF(e){var t=e[1].Tooltip,r=Te(10+2*(t.length+1));r.write_shift(2,2048);var a=Or(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function NF(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=$b[r]||r,r=e.read_shift(2),t[1]=$b[r]||r,t}function SF(e){return e||(e=Te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function EF(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ZE(e));return r}function TF(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ZE(e));return r}function AF(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function aT(e,t,r){if(!r.cellStyles)return Bs(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var u={s:n,e:i,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function CF(e,t){var r=Te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function _F(e,t){var r={};return t<32||(e.l+=16,r.header=Rs(e),r.footer=Rs(e),e.l+=2),r}function kF(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function DF(e){for(var t=Te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var IF=xn,OF=KE,PF=Rc;function RF(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function LF(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=xn(e);++e.l;var n=hl(e,t-7,r);return a.t="str",a.val=n,a}function FF(e){var t=xn(e);++e.l;var r=Rs(e);return t.t="n",t.val=r,t}function MF(e,t,r){var a=Te(15);return Bc(a,e,t),a.write_shift(8,r,"f"),a}function BF(e){var t=xn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function zF(e,t,r){var a=Te(9);return Bc(a,e,t),a.write_shift(2,r),a}function UF(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function $F(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function WF(e,t,r){var a=e.l+t,n=xn(e),i=e.read_shift(2),l=Qi(e,i,r);return e.l=a,n.t="str",n.val=l,n}var HF=[2,3,48,49,131,139,140,245],Vp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=cm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=li(1);switch(c.type){case"base64":d=da(ha(o));break;case"binary":d=da(o);break;case"buffer":case"array":d=o;break}Ns(d,0);var m=d.read_shift(1),f=!!(m&136),x=!1,p=!1;switch(m){case 2:break;case 3:break;case 48:x=!0,f=!0;break;case 49:x=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var h=0,g=521;m==2&&(h=d.read_shift(2)),d.l+=3,m!=2&&(h=d.read_shift(4)),h>1048576&&(h=1e6),m!=2&&(g=d.read_shift(2));var b=d.read_shift(2),j=c.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(j=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var y=[],w={},N=Math.min(d.length,m==2?521:g-10-(x?264:0)),S=p?32:11;d.l<N&&d[d.l]!=13;)switch(w={},w.name=Zo.utils.decode(j,d.slice(d.l,d.l+S)).replace(/[\u0000\r\n].*$/g,""),d.l+=S,w.type=String.fromCharCode(d.read_shift(1)),m!=2&&!p&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),m==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&y.push(w),m!=2&&(d.l+=p?13:14),w.type){case"B":(!x||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var E=0,_=0;for(u[0]=[],_=0;_!=y.length;++_)u[0][_]=y[_].name;for(;h-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++E]=[],_=0,_=0;_!=y.length;++_){var T=d.slice(d.l,d.l+y[_].len);d.l+=y[_].len,Ns(T,0);var C=Zo.utils.decode(j,T);switch(y[_].type){case"C":C.trim().length&&(u[E][_]=C.replace(/\s+$/,""));break;case"D":C.length===8?u[E][_]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):u[E][_]=C;break;case"F":u[E][_]=parseFloat(C.trim());break;case"+":case"I":u[E][_]=p?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":u[E][_]=!0;break;case"N":case"F":u[E][_]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[E][_]="##MEMO##"+(p?parseInt(C.trim(),10):T.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(u[E][_]=+C||0);break;case"@":u[E][_]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[E][_]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[E][_]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][_]=-T.read_shift(-8,"f");break;case"B":if(x&&y[_].len==8){u[E][_]=T.read_shift(8,"f");break}case"G":case"P":T.l+=y[_].len;break;case"0":if(y[_].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[_].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function a(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ao(r(o,u),u);return d["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,d}function n(o,c){try{return pi(a(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var u=c||{};if(+u.codepage>=0&&Ka(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ra(),m=du(o,{header:1,raw:!0,cellDates:!0}),f=m[0],x=m.slice(1),p=o["!cols"]||[],h=0,g=0,b=0,j=1;for(h=0;h<f.length;++h){if(((p[h]||{}).DBF||{}).name){f[h]=p[h].DBF.name,++b;continue}if(f[h]!=null){if(++b,typeof f[h]=="number"&&(f[h]=f[h].toString(10)),typeof f[h]!="string")throw new Error("DBF Invalid column name "+f[h]+" |"+typeof f[h]+"|");if(f.indexOf(f[h])!==h){for(g=0;g<1024;++g)if(f.indexOf(f[h]+"_"+g)==-1){f[h]+="_"+g;break}}}}var y=Xt(o["!ref"]),w=[],N=[],S=[];for(h=0;h<=y.e.c-y.s.c;++h){var E="",_="",T=0,C=[];for(g=0;g<x.length;++g)x[g][h]!=null&&C.push(x[g][h]);if(C.length==0||f[h]==null){w[h]="?";continue}for(g=0;g<C.length;++g){switch(typeof C[g]){case"number":_="B";break;case"string":_="C";break;case"boolean":_="L";break;case"object":_=C[g]instanceof Date?"D":"C";break;default:_="C"}T=Math.max(T,String(C[g]).length),E=E&&E!=_?"C":_}T>250&&(T=250),_=((p[h]||{}).DBF||{}).type,_=="C"&&p[h].DBF.len>T&&(T=p[h].DBF.len),E=="B"&&_=="N"&&(E="N",S[h]=p[h].DBF.dec,T=p[h].DBF.len),N[h]=E=="C"||_=="N"?T:i[E]||0,j+=N[h],w[h]=E}var A=d.next(32);for(A.write_shift(4,318902576),A.write_shift(4,x.length),A.write_shift(2,296+32*b),A.write_shift(2,j),h=0;h<4;++h)A.write_shift(4,0);for(A.write_shift(4,0|(+t[qS]||3)<<8),h=0,g=0;h<f.length;++h)if(f[h]!=null){var D=d.next(32),P=(f[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,P,"sbcs"),D.write_shift(1,w[h]=="?"?"C":w[h],"sbcs"),D.write_shift(4,g),D.write_shift(1,N[h]||i[w[h]]||0),D.write_shift(1,S[h]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),g+=N[h]||i[w[h]]||0}var R=d.next(264);for(R.write_shift(4,13),h=0;h<65;++h)R.write_shift(4,0);for(h=0;h<x.length;++h){var M=d.next(j);for(M.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(w[g]){case"L":M.write_shift(1,x[h][g]==null?63:x[h][g]?84:70);break;case"B":M.write_shift(8,x[h][g]||0,"f");break;case"N":var X="0";for(typeof x[h][g]=="number"&&(X=x[h][g].toFixed(S[g]||0)),b=0;b<N[g]-X.length;++b)M.write_shift(1,32);M.write_shift(1,X,"sbcs");break;case"D":x[h][g]?(M.write_shift(4,("0000"+x[h][g].getFullYear()).slice(-4),"sbcs"),M.write_shift(2,("00"+(x[h][g].getMonth()+1)).slice(-2),"sbcs"),M.write_shift(2,("00"+x[h][g].getDate()).slice(-2),"sbcs")):M.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(x[h][g]!=null?x[h][g]:"").slice(0,N[g]);for(M.write_shift(1,ie,"sbcs"),b=0;b<N[g]-ie.length;++b)M.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),nT=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Br(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,x){var p=e[x];return typeof p=="number"?pb(p):p},a=function(f,x,p){var h=x.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return h==59?f:pb(h)};e["|"]=254;function n(f,x){switch(x.type){case"base64":return i(ha(f),x);case"binary":return i(f,x);case"buffer":return i(Dt&&Buffer.isBuffer(f)?f.toString("binary"):hi(f),x);case"array":return i(Ji(f),x)}throw new Error("Unrecognized type "+x.type)}function i(f,x){var p=f.split(/[\n\r]+/),h=-1,g=-1,b=0,j=0,y=[],w=[],N=null,S={},E=[],_=[],T=[],C=0,A;for(+x.codepage>=0&&Ka(+x.codepage);b!==p.length;++b){C=0;var D=p[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),P=D.replace(/;;/g,"\0").split(";").map(function(k){return k.replace(/\u0000/g,";")}),R=P[0],M;if(D.length>0)switch(R){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&w.push(D.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,ie=!1,ae=!1,V=!1,me=-1,ue=-1;for(j=1;j<P.length;++j)switch(P[j].charAt(0)){case"A":break;case"X":g=parseInt(P[j].slice(1))-1,ie=!0;break;case"Y":for(h=parseInt(P[j].slice(1))-1,ie||(g=0),A=y.length;A<=h;++A)y[A]=[];break;case"K":M=P[j].slice(1),M.charAt(0)==='"'?M=M.slice(1,M.length-1):M==="TRUE"?M=!0:M==="FALSE"?M=!1:isNaN(Xa(M))?isNaN(Bl(M).getDate())||(M=jr(M)):(M=Xa(M),N!==null&&ro(N)&&(M=um(M))),X=!0;break;case"E":V=!0;var F=Dl(P[j].slice(1),{r:h,c:g});y[h][g]=[y[h][g],F];break;case"S":ae=!0,y[h][g]=[y[h][g],"S5S"];break;case"G":break;case"R":me=parseInt(P[j].slice(1))-1;break;case"C":ue=parseInt(P[j].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+D)}if(X&&(y[h][g]&&y[h][g].length==2?y[h][g][0]=M:y[h][g]=M,N=null),ae){if(V)throw new Error("SYLK shared formula cannot have own formula");var Y=me>-1&&y[me][ue];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");y[h][g][1]=NT(Y[1],{r:h-me,c:g-ue})}break;case"F":var z=0;for(j=1;j<P.length;++j)switch(P[j].charAt(0)){case"X":g=parseInt(P[j].slice(1))-1,++z;break;case"Y":for(h=parseInt(P[j].slice(1))-1,A=y.length;A<=h;++A)y[A]=[];break;case"M":C=parseInt(P[j].slice(1))/20;break;case"F":break;case"G":break;case"P":N=w[parseInt(P[j].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=P[j].slice(1).split(" "),A=parseInt(T[0],10);A<=parseInt(T[1],10);++A)C=parseInt(T[2],10),_[A-1]=C===0?{hidden:!0}:{wch:C},oi(_[A-1]);break;case"C":g=parseInt(P[j].slice(1))-1,_[g]||(_[g]={});break;case"R":h=parseInt(P[j].slice(1))-1,E[h]||(E[h]={}),C>0?(E[h].hpt=C,E[h].hpx=Ul(C)):C===0&&(E[h].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+D)}z<1&&(N=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+D)}}return E.length>0&&(S["!rows"]=E),_.length>0&&(S["!cols"]=_),x&&x.sheetRows&&(y=y.slice(0,x.sheetRows)),[y,S]}function l(f,x){var p=n(f,x),h=p[0],g=p[1],b=ao(h,x);return Br(g).forEach(function(j){b[j]=g[j]}),b}function o(f,x){return pi(l(f,x),x)}function c(f,x,p,h){var g="C;Y"+(p+1)+";X"+(h+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+_g(f.f,{r:p,c:h}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(f,x){x.forEach(function(p,h){var g="F;W"+(h+1)+" "+(h+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=ic(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=lc(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function d(f,x){x.forEach(function(p,h){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*oc(p.hpx)+";"),g.length>2&&f.push(g+"R"+(h+1))})}function m(f,x){var p=["ID;PWXL;N;E"],h=[],g=Xt(f["!ref"]),b,j=Array.isArray(f),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&u(p,f["!cols"]),f["!rows"]&&d(p,f["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var w=g.s.r;w<=g.e.r;++w)for(var N=g.s.c;N<=g.e.c;++N){var S=mt({r:w,c:N});b=j?(f[w]||[])[N]:f[S],!(!b||b.v==null&&(!b.f||b.F))&&h.push(c(b,f,w,N))}return p.join(y)+y+h.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:l,from_sheet:m}})(),iT=(function(){function e(i,l){switch(l.type){case"base64":return t(ha(i),l);case"binary":return t(i,l);case"buffer":return t(Dt&&Buffer.isBuffer(i)?i.toString("binary"):hi(i),l);case"array":return t(Ji(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var o=i.split(`
`),c=-1,u=-1,d=0,m=[];d!==o.length;++d){if(o[d].trim()==="BOT"){m[++c]=[],u=0;continue}if(!(c<0)){var f=o[d].trim().split(","),x=f[0],p=f[1];++d;for(var h=o[d]||"";(h.match(/["]/g)||[]).length&1&&d<o.length-1;)h+=`
`+o[++d];switch(h=h.trim(),+x){case-1:if(h==="BOT"){m[++c]=[],u=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?m[c][u]=!0:h==="FALSE"?m[c][u]=!1:isNaN(Xa(p))?isNaN(Bl(p).getDate())?m[c][u]=p:m[c][u]=jr(p):m[c][u]=Xa(p),++u;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),m[c][u++]=h!==""?h:null;break}if(h==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function r(i,l){return ao(e(i,l),l)}function a(i,l){return pi(r(i,l),l)}var n=(function(){var i=function(c,u,d,m,f){c.push(u),c.push(d+","+m),c.push('"'+f.replace(/"/g,'""')+'"')},l=function(c,u,d,m){c.push(u+","+d),c.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var u=[],d=Xt(c["!ref"]),m,f=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){l(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var h=mt({r:x,c:p});if(m=f?(c[x]||[])[p]:c[h],!m){l(u,1,0,"");continue}switch(m.t){case"n":var g=m.w;!g&&m.v!=null&&(g=m.v),g==null?m.f&&!m.F?l(u,1,0,"="+m.f):l(u,1,0,""):l(u,0,g,"V");break;case"b":l(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Fa(m.z||ut[14],ss(jr(m.v)))),l(u,0,m.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var b=`\r
`,j=u.join(b);return j}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),lT=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,f){for(var x=m.split(`
`),p=-1,h=-1,g=0,b=[];g!==x.length;++g){var j=x[g].trim().split(":");if(j[0]==="cell"){var y=Or(j[1]);if(b.length<=y.r)for(p=b.length;p<=y.r;++p)b[p]||(b[p]=[]);switch(p=y.r,h=y.c,j[2]){case"t":b[p][h]=e(j[3]);break;case"v":b[p][h]=+j[3];break;case"vtf":var w=j[j.length-1];case"vtc":switch(j[3]){case"nl":b[p][h]=!!+j[4];break;default:b[p][h]=+j[4];break}j[2]=="vtf"&&(b[p][h]=[b[p][h],w])}}}return f&&f.sheetRows&&(b=b.slice(0,f.sheetRows)),b}function a(m,f){return ao(r(m,f),f)}function n(m,f){return pi(a(m,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var f=[],x=[],p,h="",g=sa(m["!ref"]),b=Array.isArray(m),j=g.s.r;j<=g.e.r;++j)for(var y=g.s.c;y<=g.e.c;++y)if(h=mt({r:j,c:y}),p=b?(m[j]||[])[y]:m[h],!(!p||p.v==null||p.t==="z")){switch(x=["cell",h,"t"],p.t){case"s":case"str":x.push(t(p.v));break;case"n":p.f?(x[2]="vtf",x[3]="n",x[4]=p.v,x[5]=t(p.f)):(x[2]="v",x[3]=p.v);break;case"b":x[2]="vt"+(p.f?"f":"c"),x[3]="nl",x[4]=p.v?"1":"0",x[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var w=ss(jr(p.v));x[2]="vtc",x[3]="nd",x[4]=""+w,x[5]=p.w||Fa(p.z||ut[14],w);break;case"e":continue}f.push(x.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(m){return[i,l,o,l,u(m),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:d}})(),zl=(function(){function e(d,m,f,x,p){p.raw?m[f][x]=d:d===""||(d==="TRUE"?m[f][x]=!0:d==="FALSE"?m[f][x]=!1:isNaN(Xa(d))?isNaN(Bl(d).getDate())?m[f][x]=d:m[f][x]=jr(d):m[f][x]=Xa(d))}function t(d,m){var f=m||{},x=[];if(!d||d.length===0)return x;for(var p=d.split(/[\r\n]/),h=p.length-1;h>=0&&p[h].length===0;)--h;for(var g=10,b=0,j=0;j<=h;++j)b=p[j].indexOf(" "),b==-1?b=p[j].length:b++,g=Math.max(g,b);for(j=0;j<=h;++j){x[j]=[];var y=0;for(e(p[j].slice(0,g).trim(),x,j,y,f),y=1;y<=(p[j].length-g)/10+1;++y)e(p[j].slice(g+(y-1)*10,g+y*10).trim(),x,j,y,f)}return f.sheetRows&&(x=x.slice(0,f.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(d){for(var m={},f=!1,x=0,p=0;x<d.length;++x)(p=d.charCodeAt(x))==34?f=!f:!f&&p in r&&(m[p]=(m[p]||0)+1);p=[];for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&p.push([m[x],x]);if(!p.length){m=a;for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&p.push([m[x],x])}return p.sort(function(h,g){return h[0]-g[0]||a[h[1]]-a[g[1]]}),r[p.pop()[1]]||44}function i(d,m){var f=m||{},x="",p=f.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=n(d.slice(0,1024)):f&&f.FS?x=f.FS:x=n(d.slice(0,1024));var g=0,b=0,j=0,y=0,w=0,N=x.charCodeAt(0),S=!1,E=0,_=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var T=f.dateNF!=null?kR(f.dateNF):null;function C(){var A=d.slice(y,w),D={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)D.t="z";else if(f.raw)D.t="s",D.v=A;else if(A.trim().length===0)D.t="s",D.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(D.t="s",D.v=A.slice(2,-1).replace(/""/g,'"')):nB(A)?(D.t="n",D.f=A.slice(1)):(D.t="s",D.v=A);else if(A=="TRUE")D.t="b",D.v=!0;else if(A=="FALSE")D.t="b",D.v=!1;else if(!isNaN(j=Xa(A)))D.t="n",f.cellText!==!1&&(D.w=A),D.v=j;else if(!isNaN(Bl(A).getDate())||T&&A.match(T)){D.z=f.dateNF||ut[14];var P=0;T&&A.match(T)&&(A=DR(A,f.dateNF,A.match(T)||[]),P=1),f.cellDates?(D.t="d",D.v=jr(A,P)):(D.t="n",D.v=ss(jr(A,P))),f.cellText!==!1&&(D.w=Fa(D.z,D.v instanceof Date?ss(D.v):D.v)),f.cellNF||delete D.z}else D.t="s",D.v=A;if(D.t=="z"||(f.dense?(p[g]||(p[g]=[]),p[g][b]=D):p[mt({c:b,r:g})]=D),y=w+1,_=d.charCodeAt(y),h.e.c<b&&(h.e.c=b),h.e.r<g&&(h.e.r=g),E==N)++b;else if(b=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;w<d.length;++w)switch(E=d.charCodeAt(w)){case 34:_===34&&(S=!S);break;case N:case 10:case 13:if(!S&&C())break e;break}return w-y>0&&C(),p["!ref"]=Nt(h),p}function l(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,m):ao(t(d,m),m)}function o(d,m){var f="",x=m.type=="string"?[0,0,0,0]:Fg(d,m);switch(m.type){case"base64":f=ha(d);break;case"binary":f=d;break;case"buffer":m.codepage==65001?f=d.toString("utf8"):m.codepage&&typeof Zo<"u"||(f=Dt&&Buffer.isBuffer(d)?d.toString("binary"):hi(d));break;case"array":f=Ji(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+m.type)}return x[0]==239&&x[1]==187&&x[2]==191?f=dr(f.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?f=dr(f):m.type=="binary"&&typeof Zo<"u",f.slice(0,19)=="socialcalc:version:"?lT.to_sheet(m.type=="string"?f:dr(f),m):l(f,m)}function c(d,m){return pi(o(d,m),m)}function u(d){for(var m=[],f=Xt(d["!ref"]),x,p=Array.isArray(d),h=f.s.r;h<=f.e.r;++h){for(var g=[],b=f.s.c;b<=f.e.c;++b){var j=mt({r:h,c:b});if(x=p?(d[h]||[])[b]:d[j],!x||x.v==null){g.push("          ");continue}for(var y=(x.w||(Dn(x),x.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(b===0?" ":""))}m.push(g.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function VF(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=nT.to_workbook(e,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return zl.to_workbook(e,t)}}var zi=(function(){function e(F,Y,z){if(F){Ns(F,F.l||0);for(var k=z.Enum||me;F.l<F.length;){var O=F.read_shift(2),G=k[O]||k[65535],Z=F.read_shift(2),ee=F.l+Z,de=G.f&&G.f(F,Z,z);if(F.l=ee,Y(de,G,O))return}}}function t(F,Y){switch(Y.type){case"base64":return r(da(ha(F)),Y);case"binary":return r(da(F),Y);case"buffer":case"array":return r(F,Y)}throw"Unsupported type "+Y.type}function r(F,Y){if(!F)return F;var z=Y||{},k=z.dense?[]:{},O="Sheet1",G="",Z=0,ee={},de=[],Ee=[],B={s:{r:0,c:0},e:{r:0,c:0}},Se=z.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)z.Enum=me,e(F,function(Pe,Gt,yt){switch(yt){case 0:z.vers=Pe,Pe>=4096&&(z.qpro=!0);break;case 6:B=Pe;break;case 204:Pe&&(G=Pe);break;case 222:G=Pe;break;case 15:case 51:z.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:yt==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=z.dateNF||ut[14],z.cellDates&&(Pe[1].t="d",Pe[1].v=um(Pe[1].v))),z.qpro&&Pe[3]>Z&&(k["!ref"]=Nt(B),ee[O]=k,de.push(O),k=z.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},Z=Pe[3],O=G||"Sheet"+(Z+1),G="");var Pt=z.dense?(k[Pe[0].r]||[])[Pe[0].c]:k[mt(Pe[0])];if(Pt){Pt.t=Pe[1].t,Pt.v=Pe[1].v,Pe[1].z!=null&&(Pt.z=Pe[1].z),Pe[1].f!=null&&(Pt.f=Pe[1].f);break}z.dense?(k[Pe[0].r]||(k[Pe[0].r]=[]),k[Pe[0].r][Pe[0].c]=Pe[1]):k[mt(Pe[0])]=Pe[1];break}},z);else if(F[2]==26||F[2]==14)z.Enum=ue,F[2]==14&&(z.qpro=!0,F.l=0),e(F,function(Pe,Gt,yt){switch(yt){case 204:O=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>Z&&(k["!ref"]=Nt(B),ee[O]=k,de.push(O),k=z.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},Z=Pe[3],O="Sheet"+(Z+1)),Se>0&&Pe[0].r>=Se)break;z.dense?(k[Pe[0].r]||(k[Pe[0].r]=[]),k[Pe[0].r][Pe[0].c]=Pe[1]):k[mt(Pe[0])]=Pe[1],B.e.c<Pe[0].c&&(B.e.c=Pe[0].c),B.e.r<Pe[0].r&&(B.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(Ee[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:Ee[Pe[0]]=Pe[1],Pe[0]==Z&&(O=Pe[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(k["!ref"]=Nt(B),ee[G||O]=k,de.push(G||O),!Ee.length)return{SheetNames:de,Sheets:ee};for(var Re={},He=[],st=0;st<Ee.length;++st)ee[de[st]]?(He.push(Ee[st]||de[st]),Re[Ee[st]]=ee[Ee[st]]||ee[de[st]]):(He.push(Ee[st]),Re[Ee[st]]={"!ref":"A1"});return{SheetNames:He,Sheets:Re}}function a(F,Y){var z=Y||{};if(+z.codepage>=0&&Ka(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var k=ra(),O=Xt(F["!ref"]),G=Array.isArray(F),Z=[];Be(k,0,i(1030)),Be(k,6,c(O));for(var ee=Math.min(O.e.r,8191),de=O.s.r;de<=ee;++de)for(var Ee=Wr(de),B=O.s.c;B<=O.e.c;++B){de===O.s.r&&(Z[B]=Ir(B));var Se=Z[B]+Ee,Re=G?(F[de]||[])[B]:F[Se];if(!(!Re||Re.t=="z"))if(Re.t=="n")(Re.v|0)==Re.v&&Re.v>=-32768&&Re.v<=32767?Be(k,13,x(de,B,Re.v)):Be(k,14,h(de,B,Re.v));else{var He=Dn(Re);Be(k,15,m(de,B,He.slice(0,239)))}}return Be(k,1),k.end()}function n(F,Y){var z=Y||{};if(+z.codepage>=0&&Ka(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var k=ra();Be(k,0,l(F));for(var O=0,G=0;O<F.SheetNames.length;++O)(F.Sheets[F.SheetNames[O]]||{})["!ref"]&&Be(k,27,V(F.SheetNames[O],G++));var Z=0;for(O=0;O<F.SheetNames.length;++O){var ee=F.Sheets[F.SheetNames[O]];if(!(!ee||!ee["!ref"])){for(var de=Xt(ee["!ref"]),Ee=Array.isArray(ee),B=[],Se=Math.min(de.e.r,8191),Re=de.s.r;Re<=Se;++Re)for(var He=Wr(Re),st=de.s.c;st<=de.e.c;++st){Re===de.s.r&&(B[st]=Ir(st));var Pe=B[st]+He,Gt=Ee?(ee[Re]||[])[st]:ee[Pe];if(!(!Gt||Gt.t=="z"))if(Gt.t=="n")Be(k,23,C(Re,st,Z,Gt.v));else{var yt=Dn(Gt);Be(k,22,E(Re,st,Z,yt.slice(0,239)))}}++Z}}return Be(k,1),k.end()}function i(F){var Y=Te(2);return Y.write_shift(2,F),Y}function l(F){var Y=Te(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var z=0,k=0,O=0,G=0;G<F.SheetNames.length;++G){var Z=F.SheetNames[G],ee=F.Sheets[Z];if(!(!ee||!ee["!ref"])){++O;var de=sa(ee["!ref"]);z<de.e.r&&(z=de.e.r),k<de.e.c&&(k=de.e.c)}}return z>8191&&(z=8191),Y.write_shift(2,z),Y.write_shift(1,O),Y.write_shift(1,k),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function o(F,Y,z){var k={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&z.qpro?(k.s.c=F.read_shift(1),F.l++,k.s.r=F.read_shift(2),k.e.c=F.read_shift(1),F.l++,k.e.r=F.read_shift(2),k):(k.s.c=F.read_shift(2),k.s.r=F.read_shift(2),Y==12&&z.qpro&&(F.l+=2),k.e.c=F.read_shift(2),k.e.r=F.read_shift(2),Y==12&&z.qpro&&(F.l+=2),k.s.c==65535&&(k.s.c=k.e.c=k.s.r=k.e.r=0),k)}function c(F){var Y=Te(8);return Y.write_shift(2,F.s.c),Y.write_shift(2,F.s.r),Y.write_shift(2,F.e.c),Y.write_shift(2,F.e.r),Y}function u(F,Y,z){var k=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(k[0].c=F.read_shift(1),k[3]=F.read_shift(1),k[0].r=F.read_shift(2),F.l+=2):(k[2]=F.read_shift(1),k[0].c=F.read_shift(2),k[0].r=F.read_shift(2)),k}function d(F,Y,z){var k=F.l+Y,O=u(F,Y,z);if(O[1].t="s",z.vers==20768){F.l++;var G=F.read_shift(1);return O[1].v=F.read_shift(G,"utf8"),O}return z.qpro&&F.l++,O[1].v=F.read_shift(k-F.l,"cstr"),O}function m(F,Y,z){var k=Te(7+z.length);k.write_shift(1,255),k.write_shift(2,Y),k.write_shift(2,F),k.write_shift(1,39);for(var O=0;O<k.length;++O){var G=z.charCodeAt(O);k.write_shift(1,G>=128?95:G)}return k.write_shift(1,0),k}function f(F,Y,z){var k=u(F,Y,z);return k[1].v=F.read_shift(2,"i"),k}function x(F,Y,z){var k=Te(7);return k.write_shift(1,255),k.write_shift(2,Y),k.write_shift(2,F),k.write_shift(2,z,"i"),k}function p(F,Y,z){var k=u(F,Y,z);return k[1].v=F.read_shift(8,"f"),k}function h(F,Y,z){var k=Te(13);return k.write_shift(1,255),k.write_shift(2,Y),k.write_shift(2,F),k.write_shift(8,z,"f"),k}function g(F,Y,z){var k=F.l+Y,O=u(F,Y,z);if(O[1].v=F.read_shift(8,"f"),z.qpro)F.l=k;else{var G=F.read_shift(2);w(F.slice(F.l,F.l+G),O),F.l+=G}return O}function b(F,Y,z){var k=Y&32768;return Y&=-32769,Y=(k?F:0)+(Y>=8192?Y-16384:Y),(k?"":"$")+(z?Ir(Y):Wr(Y))}var j={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(F,Y){Ns(F,0);for(var z=[],k=0,O="",G="",Z="",ee="";F.l<F.length;){var de=F[F.l++];switch(de){case 0:z.push(F.read_shift(8,"f"));break;case 1:G=b(Y[0].c,F.read_shift(2),!0),O=b(Y[0].r,F.read_shift(2),!1),z.push(G+O);break;case 2:{var Ee=b(Y[0].c,F.read_shift(2),!0),B=b(Y[0].r,F.read_shift(2),!1);G=b(Y[0].c,F.read_shift(2),!0),O=b(Y[0].r,F.read_shift(2),!1),z.push(Ee+B+":"+G+O)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(F.read_shift(2));break;case 6:{for(var Se="";de=F[F.l++];)Se+=String.fromCharCode(de);z.push('"'+Se.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:ee=z.pop(),Z=z.pop(),z.push(["AND","OR"][de-20]+"("+Z+","+ee+")");break;default:if(de<32&&y[de])ee=z.pop(),Z=z.pop(),z.push(Z+y[de]+ee);else if(j[de]){if(k=j[de][1],k==69&&(k=F[F.l++]),k>z.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+z.join("|")+"|");return}var Re=z.slice(-k);z.length-=k,z.push(j[de][0]+"("+Re.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}z.length==1?Y[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function N(F){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=F.read_shift(2),Y[3]=F[F.l++],Y[0].c=F[F.l++],Y}function S(F,Y){var z=N(F);return z[1].t="s",z[1].v=F.read_shift(Y-4,"cstr"),z}function E(F,Y,z,k){var O=Te(6+k.length);O.write_shift(2,F),O.write_shift(1,z),O.write_shift(1,Y),O.write_shift(1,39);for(var G=0;G<k.length;++G){var Z=k.charCodeAt(G);O.write_shift(1,Z>=128?95:Z)}return O.write_shift(1,0),O}function _(F,Y){var z=N(F);z[1].v=F.read_shift(2);var k=z[1].v>>1;if(z[1].v&1)switch(k&7){case 0:k=(k>>3)*5e3;break;case 1:k=(k>>3)*500;break;case 2:k=(k>>3)/20;break;case 3:k=(k>>3)/200;break;case 4:k=(k>>3)/2e3;break;case 5:k=(k>>3)/2e4;break;case 6:k=(k>>3)/16;break;case 7:k=(k>>3)/64;break}return z[1].v=k,z}function T(F,Y){var z=N(F),k=F.read_shift(4),O=F.read_shift(4),G=F.read_shift(2);if(G==65535)return k===0&&O===3221225472?(z[1].t="e",z[1].v=15):k===0&&O===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var Z=G&32768;return G=(G&32767)-16446,z[1].v=(1-Z*2)*(O*Math.pow(2,G+32)+k*Math.pow(2,G)),z}function C(F,Y,z,k){var O=Te(14);if(O.write_shift(2,F),O.write_shift(1,z),O.write_shift(1,Y),k==0)return O.write_shift(4,0),O.write_shift(4,0),O.write_shift(2,65535),O;var G=0,Z=0,ee=0,de=0;return k<0&&(G=1,k=-k),Z=Math.log2(k)|0,k/=Math.pow(2,Z-31),de=k>>>0,(de&2147483648)==0&&(k/=2,++Z,de=k>>>0),k-=de,de|=2147483648,de>>>=0,k*=Math.pow(2,32),ee=k>>>0,O.write_shift(4,ee),O.write_shift(4,de),Z+=16383+(G?32768:0),O.write_shift(2,Z),O}function A(F,Y){var z=T(F);return F.l+=Y-14,z}function D(F,Y){var z=N(F),k=F.read_shift(4);return z[1].v=k>>6,z}function P(F,Y){var z=N(F),k=F.read_shift(8,"f");return z[1].v=k,z}function R(F,Y){var z=P(F);return F.l+=Y-10,z}function M(F,Y){return F[F.l+Y-1]==0?F.read_shift(Y,"cstr"):""}function X(F,Y){var z=F[F.l++];z>Y-1&&(z=Y-1);for(var k="";k.length<z;)k+=String.fromCharCode(F[F.l++]);return k}function ie(F,Y,z){if(!(!z.qpro||Y<21)){var k=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var O=F.read_shift(Y-21,"cstr");return[k,O]}}function ae(F,Y){for(var z={},k=F.l+Y;F.l<k;){var O=F.read_shift(2);if(O==14e3){for(z[O]=[0,""],z[O][0]=F.read_shift(2);F[F.l];)z[O][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return z}function V(F,Y){var z=Te(5+F.length);z.write_shift(2,14e3),z.write_shift(2,Y);for(var k=0;k<F.length;++k){var O=F.charCodeAt(k);z[z.l++]=O>127?95:O}return z[z.l++]=0,z}var me={0:{n:"BOF",f:Kr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:M},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:_},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:R},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:M},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}})();function GF(e){var t={},r=e.match(zs),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=ht(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=eg[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var qF=(function(){var e=tc("t"),t=tc("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:Kt(l[1])},c=i.match(t);return c&&(o.s=GF(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(o){return o.v})}})(),KF=(function(){var t=/(\r\n|\n)/g;function r(n,i,l){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),l.push("</b>")),n.i&&(i.push("<i>"),l.push("</i>")),n.strike&&(i.push("<s>"),l.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),YF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,XF=/<(?:\w+:)?r>/,JF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Sg(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Kt(dr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=dr(e),r&&(a.h=dg(a.t))):e.match(XF)&&(a.r=dr(e),a.t=Kt(dr((e.replace(JF,"").match(YF)||[]).join("").replace(zs,""))),r&&(a.h=KF(qF(a.r)))),a):{t:""}}var ZF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,QF=/<(?:\w+:)?(?:si|sstItem)>/g,eM=/<\/(?:\w+:)?(?:si|sstItem)>/;function tM(e,t){var r=[],a="";if(!e)return r;var n=e.match(ZF);if(n){a=n[2].replace(QF,"").split(eM);for(var i=0;i!=a.length;++i){var l=Sg(a[i].trim(),t);l!=null&&(r[r.length]=l)}n=ht(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var rM=/^\s|\s$|[\t\n\r]/;function oT(e,t){if(!t.bookSST)return"";var r=[Hr];r[r.length]=Me("sst",null,{xmlns:cl[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(rM)&&(i+=' xml:space="preserve"'),i+=">"+or(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function sM(e){return[e.read_shift(4),e.read_shift(4)]}function aM(e,t){var r=[],a=!1;return Mn(e,function(i,l,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function nM(e,t){return t||(t=Te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var iM=x8;function lM(e){var t=ra();Oe(t,159,nM(e));for(var r=0;r<e.length;++r)Oe(t,19,iM(e[r]));return Oe(t,160),t.end()}function cT(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Tn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function oM(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Tn(e,4),t.U=Tn(e,4),t.W=Tn(e,4),t}function cM(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function dM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(cM(e));return t}function uM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function mM(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Tn(e,4),t.U=Tn(e,4),t.W=Tn(e,4),t}function fM(e){var t=mM(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function dT(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function uT(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function hM(e){var t=Tn(e);switch(t.Minor){case 2:return[t.Minor,pM(e)];case 3:return[t.Minor,xM()];case 4:return[t.Minor,gM(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function pM(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=dT(e,r),n=uT(e,e.length-e.l);return{t:"Std",h:a,v:n}}function xM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function gM(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(zs,function(i){var l=ht(i);switch(pn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){a[o]=l[o]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function vM(e,t){var r={},a=r.EncryptionVersionInfo=Tn(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=dT(e,n),t-=n,r.EncryptionVerifier=uT(e,t),r}function bM(e){var t={},r=t.EncryptionVersionInfo=Tn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Eg(e){var t=0,r,a=cT(e),n=a.length+1,i,l,o,c,u;for(r=li(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)l=r[i],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^l;return t^52811}var mT=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,o){return a(l^o)},i=function(l){for(var o=t[l.length-1],c=104,u=l.length-1;u>=0;--u)for(var d=l[u],m=0;m!=7;++m)d&64&&(o^=r[c]),d*=2,--c;return o};return function(l){for(var o=cT(l),c=i(o),u=o.length,d=li(16),m=0;m!=16;++m)d[m]=0;var f,x,p;for((u&1)===1&&(f=c>>8,d[u]=n(e[0],f),--u,f=c&255,x=o[o.length-1],d[u]=n(x,f));u>0;)--u,f=c>>8,d[u]=n(o[u],f),--u,f=c&255,d[u]=n(o[u],f);for(u=15,p=15-o.length;p>0;)f=c>>8,d[u]=n(e[p],f),--u,--p,f=c&255,d[u]=n(o[u],f),--u,--p;return d}})(),yM=function(e,t,r,a,n){n||(n=t),a||(a=mT(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=a[r],l=(l>>5|l<<3)&255,n[i]=l,++r;return[n,r,a]},jM=function(e){var t=0,r=mT(e);return function(a){var n=yM("",a,t,r);return t=n[1],n[0]}};function wM(e,t,r,a){var n={key:Kr(e),verificationBytes:Kr(e)};return r.password&&(n.verifier=Eg(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=jM(r.password)),n}function NM(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=bM(e):a.Data=vM(e,t),a}function SM(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?NM(e,t-2,a):wM(e,r.biff>=8?t:t-2,r,a),a}var fT=(function(){function e(n,i){switch(i.type){case"base64":return t(ha(n),i);case"binary":return t(n,i);case"buffer":return t(Dt&&Buffer.isBuffer(n)?n.toString("binary"):hi(n),i);case"array":return t(Ji(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var l=i||{},o=l.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,m){Array.isArray(o)&&(o[m]=[]);for(var f=/\\\w+\b/g,x=0,p,h=-1;p=f.exec(d);){switch(p[0]){case"\\cell":var g=d.slice(x,f.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++h,g.length){var b={v:g,t:"s"};Array.isArray(o)?o[m][h]=b:o[mt({r:m,c:h})]=b}break}x=f.lastIndex}h>u.e.c&&(u.e.c=h)}),o["!ref"]=Nt(u),o}function r(n,i){return pi(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],l=Xt(n["!ref"]),o,c=Array.isArray(n),u=l.s.r;u<=l.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var m=mt({r:u,c:d});o=c?(n[u]||[])[d]:n[m],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Dn(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function EM(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function nc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function TM(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),i=Math.min(t,r,a),l=n-i;if(l===0)return[0,0,t];var o=0,c=0,u=n+i;switch(c=l/(u>1?2-u:u),n){case t:o=((r-a)/l+6)%6;break;case r:o=(a-t)/l+2;break;case a:o=(t-r)/l+4;break}return[o/6,c,u/2]}function AM(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),i=a-n/2,l=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=n*o,l[0]+=n,l[1]+=c;break;case 1:c=n*(2-o),l[0]+=c,l[1]+=n;break;case 2:c=n*(o-2),l[1]+=n,l[2]+=c;break;case 3:c=n*(4-o),l[1]+=c,l[2]+=n;break;case 4:c=n*(o-4),l[2]+=n,l[0]+=c;break;case 5:c=n*(6-o),l[2]+=c,l[0]+=n;break}for(var u=0;u!=3;++u)l[u]=Math.round(l[u]*255);return l}function ou(e,t){if(t===0)return e;var r=TM(EM(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),nc(AM(r))}var hT=6,CM=15,_M=1,Is=hT;function ic(e){return Math.floor((e+Math.round(128/Is)/256)*Is)}function lc(e){return Math.floor((e-5)/Is*100+.5)/100}function cu(e){return Math.round((e*Is+5)/Is*256)/256}function of(e){return cu(lc(ic(e)))}function Tg(e){var t=Math.abs(e-of(e)),r=Is;if(t>.005)for(Is=_M;Is<CM;++Is)Math.abs(e-of(e))<=t&&(t=Math.abs(e-of(e)),r=Is);Is=r}function oi(e){e.width?(e.wpx=ic(e.width),e.wch=lc(e.wpx),e.MDW=Is):e.wpx?(e.wch=lc(e.wpx),e.width=cu(e.wch),e.MDW=Is):typeof e.wch=="number"&&(e.width=cu(e.wch),e.wpx=ic(e.width),e.MDW=Is),e.customWidth&&delete e.customWidth}var kM=96,pT=kM;function oc(e){return e*96/pT}function Ul(e){return e*pT/96}var DM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IM(e,t,r,a){t.Borders=[];var n={},i=!1;(e[0].match(zs)||[]).forEach(function(l){var o=ht(l);switch(pn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=br(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=br(o.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function OM(e,t,r,a){t.Fills=[];var n={},i=!1;(e[0].match(zs)||[]).forEach(function(l){var o=ht(l);switch(pn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function PM(e,t,r,a){t.Fonts=[];var n={},i=!1;(e[0].match(zs)||[]).forEach(function(l){var o=ht(l);switch(pn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=dr(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?br(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?br(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?br(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?br(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?br(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?br(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?br(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=eg[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=br(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=Mi[n.color.index];n.color.index==81&&(c=Mi[1]),c||(c=Mi[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=ou(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function RM(e,t,r){t.NumberFmt=[];for(var a=Br(ut),n=0;n<a.length;++n)t.NumberFmt[a[n]]=ut[a[n]];var i=e[0].match(zs);if(i)for(n=0;n<i.length;++n){var l=ht(i[n]);switch(pn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Kt(dr(l.formatCode)),c=parseInt(l.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}En(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function LM(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Me("numFmt",null,{numFmtId:a,formatCode:or(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Me("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var xd=["numFmtId","fillId","fontId","borderId","xfId"],gd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function FM(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(zs)||[]).forEach(function(i){var l=ht(i),o=0;switch(pn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],o=0;o<xd.length;++o)a[xd[o]]&&(a[xd[o]]=parseInt(a[xd[o]],10));for(o=0;o<gd.length;++o)a[gd[o]]&&(a[gd[o]]=br(a[gd[o]]));if(t.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[o]){a.numFmtId=o;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=br(l.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function MM(e){var t=[];return t[t.length]=Me("cellXfs",null),e.forEach(function(r){t[t.length]=Me("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Me("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var BM=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=o.match(t))&&RM(m,d,u),(m=o.match(n))&&PM(m,d,c,u),(m=o.match(a))&&OM(m,d,c,u),(m=o.match(i))&&IM(m,d,c,u),(m=o.match(r))&&FM(m,d,u),d}})();function xT(e,t){var r=[Hr,Me("styleSheet",null,{xmlns:cl[0],"xmlns:vt":es.vt})],a;return e.SSF&&(a=LM(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=MM(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function zM(e,t){var r=e.read_shift(2),a=Fs(e);return[r,a]}function UM(e,t,r){r||(r=Te(6+4*t.length)),r.write_shift(2,e),us(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function $M(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=N8(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=w8(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Fs(e),a}function WM(e,t){t||(t=Te(153)),t.write_shift(2,e.sz*20),S8(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),nu(e.color,t);var a=0;return a=2,t.write_shift(1,a),us(e.name,t),t.length>t.l?t.slice(0,t.l):t}var HM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],cf,VM=Bs;function ny(e,t){t||(t=Te(84)),cf||(cf=cm(HM));var r=cf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(nu({auto:1},t),nu({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function GM(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function gT(e,t,r){r||(r=Te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function jo(e,t){return t||(t=Te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var qM=Bs;function KM(e,t){return t||(t=Te(51)),t.write_shift(1,0),jo(null,t),jo(null,t),jo(null,t),jo(null,t),jo(null,t),t.length>t.l?t.slice(0,t.l):t}function YM(e,t){return t||(t=Te(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),au(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function XM(e,t,r){var a=Te(2052);return a.write_shift(4,e),au(t,a),au(r,a),a.length>a.l?a.slice(0,a.l):a}function JM(e,t,r){var a={};a.NumberFmt=[];for(var n in ut)a.NumberFmt[n]=ut[n];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return Mn(e,function(c,u,d){switch(d){case 44:a.NumberFmt[c[0]]=c[1],En(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=ou(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(d),l=!0;break;case 38:i.pop(),l=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function ZM(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(Oe(e,615,Ja(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Oe(e,44,UM(n,t[n]))}),Oe(e,616))}}function QM(e){var t=1;Oe(e,611,Ja(t)),Oe(e,43,WM({sz:12,color:{theme:1},name:"Calibri",family:2})),Oe(e,612)}function e7(e){var t=2;Oe(e,603,Ja(t)),Oe(e,45,ny({patternType:"none"})),Oe(e,45,ny({patternType:"gray125"})),Oe(e,604)}function t7(e){var t=1;Oe(e,613,Ja(t)),Oe(e,46,KM()),Oe(e,614)}function r7(e){var t=1;Oe(e,626,Ja(t)),Oe(e,47,gT({numFmtId:0},65535)),Oe(e,627)}function s7(e,t){Oe(e,617,Ja(t.length)),t.forEach(function(r){Oe(e,47,gT(r,0))}),Oe(e,618)}function a7(e){var t=1;Oe(e,619,Ja(t)),Oe(e,48,YM({xfId:0,name:"Normal"})),Oe(e,620)}function n7(e){var t=0;Oe(e,505,Ja(t)),Oe(e,506)}function i7(e){var t=0;Oe(e,508,XM(t,"TableStyleMedium9","PivotStyleMedium4")),Oe(e,509)}function l7(e,t){var r=ra();return Oe(r,278),ZM(r,e.SSF),QM(r),e7(r),t7(r),r7(r),s7(r,t.cellXfs),a7(r),n7(r),i7(r),Oe(r,279),r.end()}var o7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function c7(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(zs)||[]).forEach(function(n){var i=ht(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[o7.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function d7(){}function u7(){}var m7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,f7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,h7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function p7(e,t,r){t.themeElements={};var a;[["clrScheme",m7,c7],["fontScheme",f7,d7],["fmtScheme",h7,u7]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var x7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function vT(e,t){(!e||e.length===0)&&(e=Ag());var r,a={};if(!(r=e.match(x7)))throw new Error("themeElements not found in theme");return p7(r[0],a,t),a.raw=e,a}function Ag(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Hr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function g7(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var l;try{l=dE(i,{type:"array"})}catch{return}var o=ua(l,"theme/theme/theme1.xml",!0);if(o)return vT(o,r)}}function v7(e){return e.read_shift(4)}function b7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=y7(e,4);break;case 2:t.xclrValue=JE(e);break;case 3:t.xclrValue=v7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function y7(e,t){return Bs(e,t)}function j7(e,t){return Bs(e,t)}function w7(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=b7(e);break;case 6:a[1]=j7(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function N7(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(w7(e,r-e.l));return{ixfe:a,ext:i}}function S7(e,t){t.forEach(function(r){r[0]})}function E7(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Fs(e)}}function T7(e){var t=Te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),us(e.name,t),t.slice(0,t.l)}function A7(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function C7(e){var t=Te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function _7(e,t){var r=Te(8+2*t.length);return r.write_shift(4,e),us(t,r),r.slice(0,r.l)}function k7(e){return e.l+=4,e.read_shift(4)!=0}function D7(e,t){var r=Te(8);return r.write_shift(4,e),r.write_shift(4,1),r}function I7(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],l=!1,o=2;return Mn(e,function(c,u,d){switch(d){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(m){o==1?a.Cell.push({type:a.Types[m[0]-1].name,index:m[1]}):o==0&&a.Value.push({type:a.Types[m[0]-1].name,index:m[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(d),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!u.T){if(!l||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function O7(){var e=ra();return Oe(e,332),Oe(e,334,Ja(1)),Oe(e,335,T7({name:"XLDAPR",version:12e4,flags:3496657072})),Oe(e,336),Oe(e,339,_7(1,"XLDAPR")),Oe(e,52),Oe(e,35,Ja(514)),Oe(e,4096,Ja(0)),Oe(e,4097,ka(1)),Oe(e,36),Oe(e,53),Oe(e,340),Oe(e,337,D7(1)),Oe(e,51,C7([[1,0]])),Oe(e,338),Oe(e,333),e.end()}function P7(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,l;return e.replace(zs,function(o){var c=ht(o);switch(pn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<a.Types.length;++u)a.Types[u].name==c.name&&(l=a.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function bT(){var e=[Hr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function R7(e){var t=[];if(!e)return t;var r=1;return(e.match(zs)||[]).forEach(function(a){var n=ht(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function L7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=mt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function F7(e,t,r){var a=[];return Mn(e,function(i,l,o){switch(o){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function M7(e,t,r,a){if(!e)return e;var n=a||{},i=!1;Mn(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function B7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Al=1024;function yT(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Me("xml",null,{"xmlns:v":oa.v,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:mv":oa.mv}).replace(/\/>/,">"),Me("o:shapelayout",Me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Me("v:shapetype",[Me("v:stroke",null,{joinstyle:"miter"}),Me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Al<e*1e3;)Al+=1e3;return t.forEach(function(i){var l=Or(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Me("v:fill",c,o),d={on:"t",obscured:"t"};++Al,n=n.concat(["<v:shape"+rc({id:"_x0000_s"+Al,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Me("v:shadow",null,d),Me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Es("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Es("x:AutoFill","False"),Es("x:Row",String(l.r)),Es("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function iy(e,t,r,a){var n=Array.isArray(e),i;t.forEach(function(l){var o=Or(l.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[l.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[l.ref]=i;var c=Xt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Nt(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&a){for(m=0;m<a.length;++m)if(d.a==a[m].id){d.a=a[m].name||d.a;break}}i.c.push(d)})}function z7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=ht(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Or(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!m&&!!m[1]&&Sg(m[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),a.push(u)}}}}),a}function jT(e){var t=[Hr,Me("comments",null,{xmlns:cl[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=or(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf(or(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(Es("t",or(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;t.push(Es("t",or(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function U7(e,t){var r=[],a=!1,n={},i=0;return e.replace(zs,function(o,c){var u=ht(o);switch(pn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function $7(e,t,r){var a=[Hr,Me("ThreadedComments",null,{xmlns:es.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),a.push(Me("threadedComment",Es("text",l.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function W7(e,t){var r=[],a=!1;return e.replace(zs,function(i){var l=ht(i);switch(pn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function H7(e){var t=[Hr,Me("personList",null,{xmlns:es.TCMNT,"xmlns:x":cl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Me("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function V7(e){var t={};t.iauthor=e.read_shift(4);var r=fl(e);return t.rfx=r.s,t.ref=mt(r.s),e.l+=16,t}function G7(e,t){return t==null&&(t=Te(36)),t.write_shift(4,e[1].iauthor),no(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var q7=Fs;function K7(e){return us(e.slice(0,54))}function Y7(e,t){var r=[],a=[],n={},i=!1;return Mn(e,function(o,c,u){switch(u){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function X7(e){var t=ra(),r=[];return Oe(t,628),Oe(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Oe(t,632,K7(n.a)))})}),Oe(t,631),Oe(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:Or(a[0]),e:Or(a[0])};Oe(t,635,G7([i,n])),n.t&&n.t.length>0&&Oe(t,637,v8(n)),Oe(t,636),delete n.iauthor})}),Oe(t,634),Oe(t,629),t.end()}var J7="application/vnd.ms-office.vbaProject";function Z7(e){var t=it.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");it.utils.cfb_add(t,n,e.FileIndex[a].content)}}),it.write(t)}function Q7(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&it.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var wT=["xlsb","xlsm","xlam","biff8","xla"];function eB(){return{"!type":"dialog"}}function tB(){return{"!type":"dialog"}}function rB(){return{"!type":"macro"}}function sB(){return{"!type":"macro"}}var Dl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,n+(o?"":"$")+Ir(d)+(c?"":"$")+Wr(u)}return function(n,i){return t=i,n.replace(e,r)}})(),Cg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_g=(function(){return function(t,r){return t.replace(Cg,function(a,n,i,l,o,c){var u=pg(l)-(i?0:r.c),d=hg(c)-(o?0:r.r),m=d==0?"":o?d+1:"["+d+"]",f=u==0?"":i?u+1:"["+u+"]";return n+"R"+m+"C"+f})}})();function NT(e,t){return e.replace(Cg,function(r,a,n,i,l,o){return a+(n=="$"?n+i:Ir(pg(i)+t.c))+(l=="$"?l+o:Wr(hg(o)+t.r))})}function aB(e,t,r){var a=sa(t),n=a.s,i=Or(r),l={r:i.r-n.r,c:i.c-n.c};return NT(e,l)}function nB(e){return e.length!=1}function ly(e){return e.replace(/_xlfn\./g,"")}function Gr(e){e.l+=1}function ci(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ST(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return ET(e);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),l=ci(e),o=ci(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function ET(e){var t=ci(e),r=ci(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function iB(e,t,r){if(r.biff<8)return ET(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=ci(e),l=ci(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function TT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return lB(e);var a=e.read_shift(r&&r.biff==12?4:2),n=ci(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function lB(e){var t=ci(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function oB(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function cB(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return dB(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:l,rRel:o}}function dB(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function uB(e,t,r){var a=(e[e.l++]&96)>>5,n=ST(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function mB(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=ST(e,i,r);return[a,n,l]}function fB(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function hB(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function pB(e,t,r){var a=(e[e.l++]&96)>>5,n=iB(e,t-1,r);return[a,n]}function xB(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function oy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function gB(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function vB(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function bB(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function yB(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function jB(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function AT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function wB(e){return e.read_shift(2),AT(e)}function NB(e){return e.read_shift(2),AT(e)}function SB(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=TT(e,0,r);return[a,n]}function EB(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=cB(e,0,r);return[a,n]}function TB(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=TT(e,0,r);return[a,n,i]}function AB(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[k9[n],kT[n],a]}function CB(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:_B(e);return[n,(i[0]===0?kT:_9)[i[1]]]}function _B(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function kB(e,t,r){e.l+=r&&r.biff==2?3:4}function DB(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function IB(e){return e.l++,Bn[e.read_shift(1)]}function OB(e){return e.l++,e.read_shift(2)}function PB(e){return e.l++,e.read_shift(1)!==0}function RB(e){return e.l++,Rs(e)}function LB(e,t,r){return e.l++,Pc(e,t-1,r)}function FB(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Bn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Rs(e);break;case 2:r[1]=hl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function MB(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?fl:mm)(e));return n}function BB(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var o=0;o!=n;++o)l[i][o]=FB(e,r.biff);return l}function zB(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function UB(e,t,r){if(r.biff==5)return $B(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function $B(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function WB(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function HB(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function VB(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function GB(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var qB=Bs,KB=Bs,YB=Bs;function Lc(e,t,r){return e.l+=2,[oB(e)]}function kg(e){return e.l+=6,[]}var XB=Lc,JB=kg,ZB=kg,QB=Lc;function CT(e){return e.l+=2,[Kr(e),e.read_shift(2)&1]}var e9=Lc,t9=CT,r9=kg,s9=Lc,a9=Lc,n9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function i9(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),l=n9[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:a,c:n,C:i}}function l9(e){return e.l+=2,[e.read_shift(4)]}function o9(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function c9(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function d9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function u9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function m9(e){return e.l+=4,[0,0]}var cy={1:{n:"PtgExp",f:DB},2:{n:"PtgTbl",f:YB},3:{n:"PtgAdd",f:Gr},4:{n:"PtgSub",f:Gr},5:{n:"PtgMul",f:Gr},6:{n:"PtgDiv",f:Gr},7:{n:"PtgPower",f:Gr},8:{n:"PtgConcat",f:Gr},9:{n:"PtgLt",f:Gr},10:{n:"PtgLe",f:Gr},11:{n:"PtgEq",f:Gr},12:{n:"PtgGe",f:Gr},13:{n:"PtgGt",f:Gr},14:{n:"PtgNe",f:Gr},15:{n:"PtgIsect",f:Gr},16:{n:"PtgUnion",f:Gr},17:{n:"PtgRange",f:Gr},18:{n:"PtgUplus",f:Gr},19:{n:"PtgUminus",f:Gr},20:{n:"PtgPercent",f:Gr},21:{n:"PtgParen",f:Gr},22:{n:"PtgMissArg",f:Gr},23:{n:"PtgStr",f:LB},26:{n:"PtgSheet",f:o9},27:{n:"PtgEndSheet",f:c9},28:{n:"PtgErr",f:IB},29:{n:"PtgBool",f:PB},30:{n:"PtgInt",f:OB},31:{n:"PtgNum",f:RB},32:{n:"PtgArray",f:xB},33:{n:"PtgFunc",f:AB},34:{n:"PtgFuncVar",f:CB},35:{n:"PtgName",f:zB},36:{n:"PtgRef",f:SB},37:{n:"PtgArea",f:uB},38:{n:"PtgMemArea",f:WB},39:{n:"PtgMemErr",f:qB},40:{n:"PtgMemNoMem",f:KB},41:{n:"PtgMemFunc",f:HB},42:{n:"PtgRefErr",f:VB},43:{n:"PtgAreaErr",f:fB},44:{n:"PtgRefN",f:EB},45:{n:"PtgAreaN",f:pB},46:{n:"PtgMemAreaN",f:d9},47:{n:"PtgMemNoMemN",f:u9},57:{n:"PtgNameX",f:UB},58:{n:"PtgRef3d",f:TB},59:{n:"PtgArea3d",f:mB},60:{n:"PtgRefErr3d",f:GB},61:{n:"PtgAreaErr3d",f:hB},255:{}},f9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},h9={1:{n:"PtgElfLel",f:CT},2:{n:"PtgElfRw",f:s9},3:{n:"PtgElfCol",f:XB},6:{n:"PtgElfRwV",f:a9},7:{n:"PtgElfColV",f:QB},10:{n:"PtgElfRadical",f:e9},11:{n:"PtgElfRadicalS",f:r9},13:{n:"PtgElfColS",f:JB},15:{n:"PtgElfColSV",f:ZB},16:{n:"PtgElfRadicalLel",f:t9},25:{n:"PtgList",f:i9},29:{n:"PtgSxName",f:l9},255:{}},p9={0:{n:"PtgAttrNoop",f:m9},1:{n:"PtgAttrSemi",f:jB},2:{n:"PtgAttrIf",f:bB},4:{n:"PtgAttrChoose",f:gB},8:{n:"PtgAttrGoto",f:vB},16:{n:"PtgAttrSum",f:kB},32:{n:"PtgAttrBaxcel",f:oy},33:{n:"PtgAttrBaxcel",f:oy},64:{n:"PtgAttrSpace",f:wB},65:{n:"PtgAttrSpaceSemi",f:NB},128:{n:"PtgAttrIfError",f:yB},255:{}};function Fc(e,t,r,a){if(a.biff<8)return Bs(e,t);for(var n=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=BB(e,0,a),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=MB(e,r[l][1],a),i.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=n-e.l,t!==0&&i.push(Bs(e,t)),i}function Mc(e,t,r){for(var a=e.l+t,n,i,l=[];a!=e.l;)t=a-e.l,i=e[e.l],n=cy[i]||cy[f9[i]],(i===24||i===25)&&(n=(i===24?h9:p9)[e[e.l+1]]),!n||!n.f?Bs(e,t):l.push([n.n,n.f(e,t,r)]);return l}function x9(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var g9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function v9(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function _T(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function dy(e,t,r){var a=_T(e,t,r);return a=="#REF"?a:v9(a,r)}function Ds(e,t,r,a,n){var i=n&&n.biff||8,l={s:{c:0,r:0}},o=[],c,u,d,m=0,f=0,x,p="";if(!e[0]||!e[0][0])return"";for(var h=-1,g="",b=0,j=e[0].length;b<j;++b){var y=e[0][b];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),h>=0){switch(e[0][h][1][0]){case 0:g=Fr(" ",e[0][h][1][1]);break;case 1:g=Fr("\r",e[0][h][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}u=u+g,h=-1}o.push(u+g9[y[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Bo(y[1][1],l,n),o.push(zo(d,i));break;case"PtgRefN":d=r?Bo(y[1][1],r,n):y[1][1],o.push(zo(d,i));break;case"PtgRef3d":m=y[1][1],d=Bo(y[1][2],l,n),p=dy(a,m,n),o.push(p+"!"+zo(d,i));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],N=y[1][1];w||(w=0),w&=127;var S=w==0?[]:o.slice(-w);o.length-=w,N==="User"&&(N=S.shift()),o.push(N+"("+S.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":x=Bb(y[1][1],r?{s:r}:l,n),o.push(af(x,n));break;case"PtgArea":x=Bb(y[1][1],l,n),o.push(af(x,n));break;case"PtgArea3d":m=y[1][1],x=y[1][2],p=dy(a,m,n),o.push(p+"!"+af(x,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var E=(a.names||[])[f-1]||(a[0]||[])[f],_=E?E.Name:"SH33TJSNAME"+String(f);_&&_.slice(0,6)=="_xlfn."&&!n.xlfn&&(_=_.slice(6)),o.push(_);break;case"PtgNameX":var T=y[1][1];f=y[1][2];var C;if(n.biff<=5)T<0&&(T=-T),a[T]&&(C=a[T][f]);else{var A="";if(((a[T]||[])[0]||[])[0]==14849||(((a[T]||[])[0]||[])[0]==1025?a[T][f]&&a[T][f].itab>0&&(A=a.SheetNames[a[T][f].itab-1]+"!"):A=a.SheetNames[f-1]+"!"),a[T]&&a[T][f])A+=a[T][f].Name;else if(a[0]&&a[0][f])A+=a[0][f].Name;else{var D=(_T(a,T,n)||"").split(";;");D[f-1]?A=D[f-1]:A+="SH33TJSERRX"}o.push(A);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var P="(",R=")";if(h>=0){switch(g="",e[0][h][1][0]){case 2:P=Fr(" ",e[0][h][1][1])+P;break;case 3:P=Fr("\r",e[0][h][1][1])+P;break;case 4:R=Fr(" ",e[0][h][1][1])+R;break;case 5:R=Fr("\r",e[0][h][1][1])+R;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}h=-1}o.push(P+o.pop()+R);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var M={c:r.c,r:r.r};if(a.sharedf[mt(d)]){var X=a.sharedf[mt(d)];o.push(Ds(X,l,M,a,n))}else{var ie=!1;for(c=0;c!=a.arrayf.length;++c)if(u=a.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Ds(u[1],l,M,a,n)),ie=!0;break}ie||o.push(y[1])}break;case"PtgArray":o.push("{"+x9(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&h>=0&&ae.indexOf(e[0][b][0])==-1){y=e[0][h];var V=!0;switch(y[1][0]){case 4:V=!1;case 0:g=Fr(" ",y[1][1]);break;case 5:V=!1;case 1:g=Fr("\r",y[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((V?g:"")+o.pop()+(V?"":g)),h=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function b9(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],Bs(e,t-2)];var o=Mc(e,l,r);return t!==l+n&&(i=Fc(e,t-l-n,o,r)),e.l=a,[o,i]}function y9(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],Bs(e,t-2)];var o=Mc(e,l,r);return t!==l+n&&(i=Fc(e,t-l-n,o,r)),e.l=a,[o,i]}function j9(e,t,r,a){var n=e.l+t,i=Mc(e,a,r),l;return n!==e.l&&(l=Fc(e,n-e.l,i,r)),[i,l]}function w9(e,t,r){var a=e.l+t,n,i=e.read_shift(2),l=Mc(e,i,r);return i==65535?[[],Bs(e,t-2)]:(t!==i+2&&(n=Fc(e,a-i-2,l,r)),[l,n])}function N9(e){var t;if(jn(e,e.l+6)!==65535)return[Rs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function S9(e){if(e==null){var t=Te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zi(e);return Zi(0)}function df(e,t,r){var a=e.l+t,n=xn(e);r.biff==2&&++e.l;var i=N9(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=y9(e,a-e.l,r);return{cell:n,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function E9(e,t,r,a,n){var i=el(t,r,n),l=S9(e.v),o=Te(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=Te(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var m=ds([i,l,o,u]);return m}function fm(e,t,r){var a=e.read_shift(4),n=Mc(e,a,r),i=e.read_shift(4),l=i>0?Fc(e,i,n,r):null;return[n,l]}var T9=fm,hm=fm,A9=fm,C9=fm,_9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},kT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},k9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function D9(e){var t="of:="+e.replace(Cg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function uf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function I9(e){return e.replace(/\./,"!")}var $o={},Il={},Wo=typeof Map<"u";function Dg(e,t,r){var a=0,n=e.length;if(r){if(Wo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Wo?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(Wo?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function pm(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Is=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=lc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=cu(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ui(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function xi(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){En(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function DT(e,t,r,a,n,i){try{a.cellNF&&(e.z=ut[t])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=jr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ut[t]==null&&En(_R[t]||"General",t),e.t==="e")e.w=e.w||Bn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ec(e.v);else if(e.t==="d"){var l=ss(e.v);(l|0)===l?e.w=l.toString(10):e.w=ec(l)}else{if(e.v===void 0)return"";e.w=Xi(e.v,Il)}else e.t==="d"?e.w=Fa(t,ss(e.v),Il):e.w=Fa(t,e.v,Il)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ou(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ou(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function O9(e,t,r){if(e&&e["!ref"]){var a=Xt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function P9(e,t){var r=Xt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Nt(r))}var R9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,L9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,F9=/<(?:\w:)?hyperlink [^>]*>/mg,M9=/"(\w*:\w*)"/,B9=/<(?:\w:)?col\b[^>]*[\/]?>/g,z9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,U9=/<(?:\w:)?pageMargins[^>]*\/>/g,IT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,$9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,W9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function H9(e,t,r,a,n,i,l){if(!e)return e;a||(a={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",m=e.match(L9);m?(u=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):u=d=e;var f=u.match(IT);f?Ig(f[0],o,n,r):(f=u.match($9))&&G9(f[0],f[1]||"",o,n,r);var x=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var p=u.slice(x,x+50).match(M9);p&&P9(o,p[1])}var h=u.match(W9);h&&h[1]&&nz(h[1],n);var g=[];if(t.cellStyles){var b=u.match(B9);b&&ez(g,b)}m&&oz(m[1],o,t,c,i,l);var j=d.match(z9);j&&(o["!autofilter"]=rz(j[0]));var y=[],w=d.match(R9);if(w)for(x=0;x!=w.length;++x)y[x]=Xt(w[x].slice(w[x].indexOf('"')+1));var N=d.match(F9);N&&J9(o,N,a);var S=d.match(U9);if(S&&(o["!margins"]=Z9(ht(S[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Nt(c)),t.sheetRows>0&&o["!ref"]){var E=Xt(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Nt(E))}return g.length>0&&(o["!cols"]=g),y.length>0&&(o["!merges"]=y),o}function V9(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Nt(e[r])+'"/>';return t+"</mergeCells>"}function Ig(e,t,r,a){var n=ht(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Kt(dr(n.codeName)))}function G9(e,t,r,a,n){Ig(e.slice(0,e.indexOf(">")),r,a,n)}function q9(e,t,r,a,n){var i=!1,l={},o=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,l.codeName=on(or(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Me("outlinePr",null,u)}!i&&!o||(n[n.length]=Me("sheetPr",o,l))}var K9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Y9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function X9(e){var t={sheet:1};return K9.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Y9.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Eg(e.password).toString(16).toUpperCase()),Me("sheetProtection",null,t)}function J9(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var i=ht(dr(t[n]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Kt(i.location))):(i.Target="#"+Kt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Xt(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=mt({c:u,r:c});a?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function Z9(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Q9(e){return Ui(e),Me("pageMargins",null,e)}function ez(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=ht(t[a],!0);n.hidden&&(n.hidden=br(n.hidden));var i=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Tg(n.width)),oi(n);i<=l;)e[i++]=wr(n)}}function tz(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Me("col",null,pm(n,a)));return r[r.length]="</cols>",r.join("")}function rz(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function sz(e,t,r,a){var n=typeof e.ref=="string"?e.ref:Nt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=sa(n);l.s.r==l.e.r&&(l.e.r=sa(t["!ref"]).e.r,n=Nt(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Me("autoFilter",null,{ref:n})}var az=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nz(e,t){t.Views||(t.Views=[{}]),(e.match(az)||[]).forEach(function(r,a){var n=ht(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),br(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function iz(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Me("sheetViews",Me("sheetView",null,n),{})}function lz(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Bn[e.v];break;case"d":a&&a.cellDates?n=jr(e.v,-1).toISOString():(e=wr(e),e.t="n",n=""+(e.v=ss(jr(e.v)))),typeof e.z>"u"&&(e.z=ut[14]);break;default:n=e.v;break}var o=Es("v",or(n)),c={r:t},u=xi(a.cellXfs,e,a);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=Es("v",""+Dg(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Me("f",or(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Me("c",o,c)}var oz=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=tc("v"),l=tc("f");return function(c,u,d,m,f,x){for(var p=0,h="",g=[],b=[],j=0,y=0,w=0,N="",S,E,_=0,T=0,C,A,D=0,P=0,R=Array.isArray(x.CellXf),M,X=[],ie=[],ae=Array.isArray(u),V=[],me={},ue=!1,F=!!d.sheetStubs,Y=c.split(t),z=0,k=Y.length;z!=k;++z){h=Y[z].trim();var O=h.length;if(O!==0){var G=0;e:for(p=0;p<O;++p)switch(h[p]){case">":if(h[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(E=ht(h.slice(G,p),!0),_=E.r!=null?parseInt(E.r,10):_+1,T=-1,d.sheetRows&&d.sheetRows<_)continue;me={},ue=!1,E.ht&&(ue=!0,me.hpt=parseFloat(E.ht),me.hpx=Ul(me.hpt)),E.hidden=="1"&&(ue=!0,me.hidden=!0),E.outlineLevel!=null&&(ue=!0,me.level=+E.outlineLevel),ue&&(V[_-1]=me)}break;case"<":G=p;break}if(G>=p)break;if(E=ht(h.slice(G,p),!0),_=E.r!=null?parseInt(E.r,10):_+1,T=-1,!(d.sheetRows&&d.sheetRows<_)){m.s.r>_-1&&(m.s.r=_-1),m.e.r<_-1&&(m.e.r=_-1),d&&d.cellStyles&&(me={},ue=!1,E.ht&&(ue=!0,me.hpt=parseFloat(E.ht),me.hpx=Ul(me.hpt)),E.hidden=="1"&&(ue=!0,me.hidden=!0),E.outlineLevel!=null&&(ue=!0,me.level=+E.outlineLevel),ue&&(V[_-1]=me)),g=h.slice(p).split(e);for(var Z=0;Z!=g.length&&g[Z].trim().charAt(0)=="<";++Z);for(g=g.slice(Z),p=0;p!=g.length;++p)if(h=g[p].trim(),h.length!==0){if(b=h.match(r),j=p,y=0,w=0,h="<c "+(h.slice(0,1)=="<"?">":"")+h,b!=null&&b.length===2){for(j=0,N=b[1],y=0;y!=N.length&&!((w=N.charCodeAt(y)-64)<1||w>26);++y)j=26*j+w;--j,T=j}else++T;for(y=0;y!=h.length&&h.charCodeAt(y)!==62;++y);if(++y,E=ht(h.slice(0,y),!0),E.r||(E.r=mt({r:_-1,c:T})),N=h.slice(y),S={t:""},(b=N.match(i))!=null&&b[1]!==""&&(S.v=Kt(b[1])),d.cellFormula){if((b=N.match(l))!=null&&b[1]!==""){if(S.f=Kt(dr(b[1])).replace(/\r\n/g,`
`),d.xlfn||(S.f=ly(S.f)),b[0].indexOf('t="array"')>-1)S.F=(N.match(n)||[])[1],S.F.indexOf(":")>-1&&X.push([Xt(S.F),S.F]);else if(b[0].indexOf('t="shared"')>-1){A=ht(b[0]);var ee=Kt(dr(b[1]));d.xlfn||(ee=ly(ee)),ie[parseInt(A.si,10)]=[A,ee,E.r]}}else(b=N.match(/<f[^>]*\/>/))&&(A=ht(b[0]),ie[A.si]&&(S.f=aB(ie[A.si][1],ie[A.si][2],E.r)));var de=Or(E.r);for(y=0;y<X.length;++y)de.r>=X[y][0].s.r&&de.r<=X[y][0].e.r&&de.c>=X[y][0].s.c&&de.c<=X[y][0].e.c&&(S.F=X[y][1])}if(E.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(F)S.t="z";else continue;else S.t=E.t||"n";switch(m.s.c>T&&(m.s.c=T),m.e.c<T&&(m.e.c=T),S.t){case"n":if(S.v==""||S.v==null){if(!F)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!F)continue;S.t="z"}else C=$o[parseInt(S.v,10)],S.v=C.t,S.r=C.r,d.cellHTML&&(S.h=C.h);break;case"str":S.t="s",S.v=S.v!=null?dr(S.v):"",d.cellHTML&&(S.h=dg(S.v));break;case"inlineStr":b=N.match(a),S.t="s",b!=null&&(C=Sg(b[1]))?(S.v=C.t,d.cellHTML&&(S.h=C.h)):S.v="";break;case"b":S.v=br(S.v);break;case"d":d.cellDates?S.v=jr(S.v,1):(S.v=ss(jr(S.v,1)),S.t="n");break;case"e":(!d||d.cellText!==!1)&&(S.w=S.v),S.v=PE[S.v];break}if(D=P=0,M=null,R&&E.s!==void 0&&(M=x.CellXf[E.s],M!=null&&(M.numFmtId!=null&&(D=M.numFmtId),d.cellStyles&&M.fillId!=null&&(P=M.fillId))),DT(S,D,P,d,f,x),d.cellDates&&R&&S.t=="n"&&ro(ut[D])&&(S.t="d",S.v=um(S.v)),E.cm&&d.xlmeta){var Ee=(d.xlmeta.Cell||[])[+E.cm-1];Ee&&Ee.type=="XLDAPR"&&(S.D=!0)}if(ae){var B=Or(E.r);u[B.r]||(u[B.r]=[]),u[B.r][B.c]=S}else u[E.r]=S}}}}V.length>0&&(u["!rows"]=V)}})();function cz(e,t,r,a){var n=[],i=[],l=Xt(e["!ref"]),o="",c,u="",d=[],m=0,f=0,x=e["!rows"],p=Array.isArray(e),h={r:u},g,b=-1;for(f=l.s.c;f<=l.e.c;++f)d[f]=Ir(f);for(m=l.s.r;m<=l.e.r;++m){for(i=[],u=Wr(m),f=l.s.c;f<=l.e.c;++f){c=d[f]+u;var j=p?(e[m]||[])[f]:e[c];j!==void 0&&(o=lz(j,c,e,t))!=null&&i.push(o)}(i.length>0||x&&x[m])&&(h={r:u},x&&x[m]&&(g=x[m],g.hidden&&(h.hidden=1),b=-1,g.hpx?b=oc(g.hpx):g.hpt&&(b=g.hpt),b>-1&&(h.ht=b,h.customHeight=1),g.level&&(h.outlineLevel=g.level)),n[n.length]=Me("row",i.join(""),h))}if(x)for(;m<x.length;++m)x&&x[m]&&(h={r:m+1},g=x[m],g.hidden&&(h.hidden=1),b=-1,g.hpx?b=oc(g.hpx):g.hpt&&(b=g.hpt),b>-1&&(h.ht=b,h.customHeight=1),g.level&&(h.outlineLevel=g.level),n[n.length]=Me("row","",h));return n.join("")}function OT(e,t,r,a){var n=[Hr,Me("worksheet",null,{xmlns:cl[0],"xmlns:r":es.r})],i=r.SheetNames[e],l=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=Xt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Nt(d)}a||(a={}),c["!comments"]=[];var m=[];q9(c,r,e,t,n),n[n.length]=Me("dimension",null,{ref:u}),n[n.length]=iz(c,t,e,r),t.sheetFormat&&(n[n.length]=Me("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=tz(c,c["!cols"])),n[l=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=cz(c,t),o.length>0&&(n[n.length]=o)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),c["!protect"]&&(n[n.length]=X9(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=sz(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=V9(c["!merges"]));var f=-1,x,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(h){h[1].Target&&(x={ref:h[0]},h[1].Target.charAt(0)!="#"&&(p=ir(a,-1,or(h[1].Target).replace(/#.*$/,""),Ot.HLINK),x["r:id"]="rId"+p),(f=h[1].Target.indexOf("#"))>-1&&(x.location=or(h[1].Target.slice(f+1))),h[1].Tooltip&&(x.tooltip=or(h[1].Tooltip)),n[n.length]=Me("hyperlink",null,x))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=Q9(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Es("ignoredErrors",Me("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(p=ir(a,-1,"../drawings/drawing"+(e+1)+".xml",Ot.DRAW),n[n.length]=Me("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=m),c["!comments"].length>0&&(p=ir(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ot.VML),n[n.length]=Me("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function dz(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function uz(e,t,r){var a=Te(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=oc(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,f=-1,x=d<<10;x<d+1<<10;++x){u.c=x;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[mt(u)];p&&(m<0&&(m=x),f=x)}m<0||(++o,a.write_shift(4,m),a.write_shift(4,f))}var h=a.l;return a.l=c,a.write_shift(4,o),a.l=h,a.length>a.l?a.slice(0,a.l):a}function mz(e,t,r,a){var n=uz(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&Oe(e,0,n)}var fz=fl,hz=no;function pz(){}function xz(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=b8(e),r}function gz(e,t,r){r==null&&(r=Te(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return nu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),_E(e,r),r.slice(0,r.l)}function vz(e){var t=Ua(e);return[t]}function bz(e,t,r){return r==null&&(r=Te(8)),dl(t,r)}function yz(e){var t=ul(e);return[t]}function jz(e,t,r){return r==null&&(r=Te(4)),ml(t,r)}function wz(e){var t=Ua(e),r=e.read_shift(1);return[t,r,"b"]}function Nz(e,t,r){return r==null&&(r=Te(9)),dl(t,r),r.write_shift(1,e.v?1:0),r}function Sz(e){var t=ul(e),r=e.read_shift(1);return[t,r,"b"]}function Ez(e,t,r){return r==null&&(r=Te(5)),ml(t,r),r.write_shift(1,e.v?1:0),r}function Tz(e){var t=Ua(e),r=e.read_shift(1);return[t,r,"e"]}function Az(e,t,r){return r==null&&(r=Te(9)),dl(t,r),r.write_shift(1,e.v),r}function Cz(e){var t=ul(e),r=e.read_shift(1);return[t,r,"e"]}function _z(e,t,r){return r==null&&(r=Te(8)),ml(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function kz(e){var t=Ua(e),r=e.read_shift(4);return[t,r,"s"]}function Dz(e,t,r){return r==null&&(r=Te(12)),dl(t,r),r.write_shift(4,t.v),r}function Iz(e){var t=ul(e),r=e.read_shift(4);return[t,r,"s"]}function Oz(e,t,r){return r==null&&(r=Te(8)),ml(t,r),r.write_shift(4,t.v),r}function Pz(e){var t=Ua(e),r=Rs(e);return[t,r,"n"]}function Rz(e,t,r){return r==null&&(r=Te(16)),dl(t,r),Zi(e.v,r),r}function PT(e){var t=ul(e),r=Rs(e);return[t,r,"n"]}function Lz(e,t,r){return r==null&&(r=Te(12)),ml(t,r),Zi(e.v,r),r}function Fz(e){var t=Ua(e),r=bg(e);return[t,r,"n"]}function Mz(e,t,r){return r==null&&(r=Te(12)),dl(t,r),kE(e.v,r),r}function Bz(e){var t=ul(e),r=bg(e);return[t,r,"n"]}function zz(e,t,r){return r==null&&(r=Te(8)),ml(t,r),kE(e.v,r),r}function Uz(e){var t=Ua(e),r=xg(e);return[t,r,"is"]}function $z(e){var t=Ua(e),r=Fs(e);return[t,r,"str"]}function Wz(e,t,r){return r==null&&(r=Te(12+4*e.v.length)),dl(t,r),us(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Hz(e){var t=ul(e),r=Fs(e);return[t,r,"str"]}function Vz(e,t,r){return r==null&&(r=Te(8+4*e.v.length)),ml(t,r),us(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Gz(e,t,r){var a=e.l+t,n=Ua(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"b"];if(r.cellFormula){e.l+=2;var o=hm(e,a-e.l,r);l[3]=Ds(o,null,n,r.supbooks,r)}else e.l=a;return l}function qz(e,t,r){var a=e.l+t,n=Ua(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"e"];if(r.cellFormula){e.l+=2;var o=hm(e,a-e.l,r);l[3]=Ds(o,null,n,r.supbooks,r)}else e.l=a;return l}function Kz(e,t,r){var a=e.l+t,n=Ua(e);n.r=r["!row"];var i=Rs(e),l=[n,i,"n"];if(r.cellFormula){e.l+=2;var o=hm(e,a-e.l,r);l[3]=Ds(o,null,n,r.supbooks,r)}else e.l=a;return l}function Yz(e,t,r){var a=e.l+t,n=Ua(e);n.r=r["!row"];var i=Fs(e),l=[n,i,"str"];if(r.cellFormula){e.l+=2;var o=hm(e,a-e.l,r);l[3]=Ds(o,null,n,r.supbooks,r)}else e.l=a;return l}var Xz=fl,Jz=no;function Zz(e,t){return t==null&&(t=Te(4)),t.write_shift(4,e),t}function Qz(e,t){var r=e.l+t,a=fl(e),n=gg(e),i=Fs(e),l=Fs(e),o=Fs(e);e.l=r;var c={rfx:a,relId:n,loc:i,display:o};return l&&(c.Tooltip=l),c}function eU(e,t){var r=Te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));no({s:Or(e[0]),e:Or(e[0])},r),vg("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return us(n||"",r),us(e[1].Tooltip||"",r),us("",r),r.slice(0,r.l)}function tU(){}function rU(e,t,r){var a=e.l+t,n=DE(e),i=e.read_shift(1),l=[n];if(l[2]=i,r.cellFormula){var o=T9(e,a-e.l,r);l[1]=o}else e.l=a;return l}function sU(e,t,r){var a=e.l+t,n=fl(e),i=[n];if(r.cellFormula){var l=C9(e,a-e.l,r);i[1]=l,e.l=a}else e.l=a;return i}function aU(e,t,r){r==null&&(r=Te(18));var a=pm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var RT=["left","right","top","bottom","header","footer"];function nU(e){var t={};return RT.forEach(function(r){t[r]=Rs(e)}),t}function iU(e,t){return t==null&&(t=Te(48)),Ui(e),RT.forEach(function(r){Zi(e[r],t)}),t}function lU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function oU(e,t,r){r==null&&(r=Te(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function cU(e){var t=Te(24);return t.write_shift(4,4),t.write_shift(4,1),no(e,t),t}function dU(e,t){return t==null&&(t=Te(66)),t.write_shift(2,e.password?Eg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function uU(){}function mU(){}function fU(e,t,r,a,n,i,l){if(!e)return e;var o=t||{};a||(a={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,f=!1,x,p,h,g,b,j,y,w,N,S=[];o.biff=12,o["!row"]=0;var E=0,_=!1,T=[],C={},A=o.supbooks||n.supbooks||[[]];if(A.sharedf=C,A.arrayf=T,A.SheetNames=n.SheetNames||n.Sheets.map(function(ae){return ae.name}),!o.supbooks&&(o.supbooks=A,n.Names))for(var D=0;D<n.Names.length;++D)A[0][D+1]=n.Names[D];var P=[],R=[],M=!1;cc[16]={n:"BrtShortReal",f:PT};var X;if(Mn(e,function(V,me,ue){if(!f)switch(ue){case 148:u=V;break;case 0:x=V,o.sheetRows&&o.sheetRows<=x.r&&(f=!0),w=Wr(g=x.r),o["!row"]=x.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=Ul(V.hpt)),R[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:V[2]},V[2]){case"n":p.v=V[1];break;case"s":y=$o[V[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!V[1];break;case"e":p.v=V[1],o.cellText!==!1&&(p.w=Bn[p.v]);break;case"str":p.t="s",p.v=V[1];break;case"is":p.t="s",p.v=V[1].t;break}if((h=l.CellXf[V[0].iStyleRef])&&DT(p,h.numFmtId,null,o,i,l),b=V[0].c==-1?b+1:V[0].c,o.dense?(c[g]||(c[g]=[]),c[g][b]=p):c[Ir(b)+w]=p,o.cellFormula){for(_=!1,E=0;E<T.length;++E){var F=T[E];x.r>=F[0].s.r&&x.r<=F[0].e.r&&b>=F[0].s.c&&b<=F[0].e.c&&(p.F=Nt(F[0]),_=!0)}!_&&V.length>3&&(p.f=V[3])}if(d.s.r>x.r&&(d.s.r=x.r),d.s.c>b&&(d.s.c=b),d.e.r<x.r&&(d.e.r=x.r),d.e.c<b&&(d.e.c=b),o.cellDates&&h&&p.t=="n"&&ro(ut[h.numFmtId])){var Y=Di(p.v);Y&&(p.t="d",p.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}X&&(X.type=="XLDAPR"&&(p.D=!0),X=void 0);break;case 1:case 12:if(!o.sheetStubs||m)break;p={t:"z",v:void 0},b=V[0].c==-1?b+1:V[0].c,o.dense?(c[g]||(c[g]=[]),c[g][b]=p):c[Ir(b)+w]=p,d.s.r>x.r&&(d.s.r=x.r),d.s.c>b&&(d.s.c=b),d.e.r<x.r&&(d.e.r=x.r),d.e.c<b&&(d.e.c=b),X&&(X.type=="XLDAPR"&&(p.D=!0),X=void 0);break;case 176:S.push(V);break;case 49:X=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var z=a["!id"][V.relId];for(z?(V.Target=z.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=z):V.relId==""&&(V.Target="#"+V.loc),g=V.rfx.s.r;g<=V.rfx.e.r;++g)for(b=V.rfx.s.c;b<=V.rfx.e.c;++b)o.dense?(c[g]||(c[g]=[]),c[g][b]||(c[g][b]={t:"z",v:void 0}),c[g][b].l=V):(j=mt({c:b,r:g}),c[j]||(c[j]={t:"z",v:void 0}),c[j].l=V);break;case 426:if(!o.cellFormula)break;T.push(V),N=o.dense?c[g][b]:c[Ir(b)+w],N.f=Ds(V[1],d,{r:x.r,c:b},A,o),N.F=Nt(V[0]);break;case 427:if(!o.cellFormula)break;C[mt(V[0].s)]=V[1],N=o.dense?c[g][b]:c[Ir(b)+w],N.f=Ds(V[1],d,{r:x.r,c:b},A,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)P[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},M||(M=!0,Tg(V.w/256)),oi(P[V.e+1]);break;case 161:c["!autofilter"]={ref:Nt(V)};break;case 476:c["!margins"]=V;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),V.name&&(n.Sheets[r].CodeName=V.name),(V.above||V.left)&&(c["!outline"]={above:V.above,left:V.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),V.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!me.T){if(!m||o.WTF)throw new Error("Unexpected record 0x"+ue.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Nt(u||d)),o.sheetRows&&c["!ref"]){var ie=Xt(c["!ref"]);o.sheetRows<=+ie.e.r&&(ie.e.r=o.sheetRows-1,ie.e.r>d.e.r&&(ie.e.r=d.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>d.e.c&&(ie.e.c=d.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Nt(ie))}return S.length>0&&(c["!merges"]=S),P.length>0&&(c["!cols"]=P),R.length>0&&(c["!rows"]=R),c}function hU(e,t,r,a,n,i,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=wr(t),t.z=t.z||ut[14],t.v=ss(jr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:a};switch(c.s=xi(n.cellXfs,t,n),t.l&&i["!links"].push([mt(c),t.l]),t.c&&i["!comments"].push([mt(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=Dg(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,l?Oe(e,18,Oz(t,c)):Oe(e,7,Dz(t,c))):(c.t="str",l?Oe(e,17,Vz(t,c)):Oe(e,6,Wz(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Oe(e,13,zz(t,c)):Oe(e,2,Mz(t,c)):l?Oe(e,16,Lz(t,c)):Oe(e,5,Rz(t,c)),!0;case"b":return c.t="b",l?Oe(e,15,Ez(t,c)):Oe(e,4,Nz(t,c)),!0;case"e":return c.t="e",l?Oe(e,14,_z(t,c)):Oe(e,3,Az(t,c)),!0}return l?Oe(e,12,jz(t,c)):Oe(e,1,bz(t,c)),!0}function pU(e,t,r,a){var n=Xt(t["!ref"]||"A1"),i,l="",o=[];Oe(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){l=Wr(d),mz(e,t,n,d);var m=!1;if(d<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){d===n.s.r&&(o[f]=Ir(f)),i=o[f]+l;var x=c?(t[d]||[])[f]:t[i];if(!x){m=!1;continue}m=hU(e,x,d,f,a,t,m)}}Oe(e,146)}function xU(e,t){!t||!t["!merges"]||(Oe(e,177,Zz(t["!merges"].length)),t["!merges"].forEach(function(r){Oe(e,176,Jz(r))}),Oe(e,178))}function gU(e,t){!t||!t["!cols"]||(Oe(e,390),t["!cols"].forEach(function(r,a){r&&Oe(e,60,aU(a,r))}),Oe(e,391))}function vU(e,t){!t||!t["!ref"]||(Oe(e,648),Oe(e,649,cU(Xt(t["!ref"]))),Oe(e,650))}function bU(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=ir(r,-1,a[1].Target.replace(/#.*$/,""),Ot.HLINK);Oe(e,494,eU(a,n))}}),delete t["!links"]}function yU(e,t,r,a){if(t["!comments"].length>0){var n=ir(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ot.VML);Oe(e,551,vg("rId"+n)),t["!legacy"]=n}}function jU(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:Nt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=sa(i);o.s.r==o.e.r&&(o.e.r=sa(t["!ref"]).e.r,i=Nt(o));for(var c=0;c<l.length;++c){var u=l[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),Oe(e,161,no(Xt(i))),Oe(e,162)}}function wU(e,t,r){Oe(e,133),Oe(e,137,oU(t,r)),Oe(e,138),Oe(e,134)}function NU(e,t){t["!protect"]&&Oe(e,535,dU(t["!protect"]))}function SU(e,t,r,a){var n=ra(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Xt(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Oe(n,129),(r.vbaraw||l["!outline"])&&Oe(n,147,gz(o,l["!outline"])),Oe(n,148,hz(c)),wU(n,l,r.Workbook),gU(n,l),pU(n,l,e,t),NU(n,l),jU(n,l,r,e),xU(n,l),bU(n,l,a),l["!margins"]&&Oe(n,476,iU(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&vU(n,l),yU(n,l,e,a),Oe(n,130),n.end()}function EU(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var n=Kt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,n,a]}function TU(e,t,r,a,n,i){var l=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var f=EU(m);d.s.r=d.s.c=0,d.e.c=o,u=Ir(o),f[0].forEach(function(x,p){l[u+Wr(p)]={t:"n",v:x,z:f[1]},c=p}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(l["!ref"]=Nt(d)),l}function AU(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(IT);return o&&Ig(o[0],i,n,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function CU(e,t){e.l+=10;var r=Fs(e);return{name:r}}function _U(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Mn(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Og=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],kU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],DU=[],IU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function my(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var i=t[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=br(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function fy(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=br(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function LT(e){fy(e.WBProps,Og),fy(e.CalcPr,IU),my(e.WBView,kU),my(e.Sheets,DU),Il.date1904=br(e.WBProps.date1904)}function OU(e){return!e.Workbook||!e.Workbook.WBProps?"false":br(e.Workbook.WBProps.date1904)?"true":"false"}var PU="][*?/\\".split("");function FT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return PU.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function RU(e,t,r){e.forEach(function(a,n){FT(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=t&&t[n]&&t[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function LU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];RU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)O9(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var FU=/<\w+:workbook/;function MU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},l=0;if(e.replace(zs,function(c,u){var d=ht(c);switch(pn(d[0])){case"<?xml":break;case"<workbook":c.match(FU)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Og.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=br(d[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:r.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(r.WBProps.CodeName=dr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Kt(dr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=dr(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),br(d.hidden||"0")&&(i.Hidden=!0),l=u+c.length;break;case"</definedName>":i.Ref=Kt(dr(e.slice(l,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),cl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return LT(r),r}function MT(e){var t=[Hr];t[t.length]=Me("workbook",null,{xmlns:cl[0],"xmlns:r":es.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Og.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Me("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:or(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Me("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Me("definedName",or(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function BU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Bp(e),r.name=Fs(e),r}function zU(e,t){return t||(t=Te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),vg(e.strRelID,t),us(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function UU(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Fs(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function $U(e,t){t||(t=Te(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),_E(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function WU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function HU(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=y8(e),l=A9(e,0,r),o=gg(e);e.l=a;var c={Name:i,Ptg:l};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function VU(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],cc[16]={n:"BrtFRTArchID$",f:WU},Mn(e,function(c,u,d){switch(d){case 156:l.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Ds(c.Ptg,null,null,l,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,c]):l[0]=[d,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(d),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),LT(r),r.Names=i,r.supbooks=l,r}function GU(e,t){Oe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Oe(e,156,zU(n))}Oe(e,144)}function qU(e,t){t||(t=Te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return us("SheetJS",t),us(Zd.version,t),us(Zd.version,t),us("7262",t),t.length>t.l?t.slice(0,t.l):t}function KU(e,t){t||(t=Te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function YU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(Oe(e,135),Oe(e,158,KU(n)),Oe(e,136))}}function XU(e,t){var r=ra();return Oe(r,131),Oe(r,128,qU()),Oe(r,153,$U(e.Workbook&&e.Workbook.WBProps||null)),YU(r,e),GU(r,e),Oe(r,132),r.end()}function JU(e,t,r){return t.slice(-4)===".bin"?VU(e,r):MU(e,r)}function ZU(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?fU(e,a,r,n,i,l,o):H9(e,a,r,n,i,l,o)}function QU(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?_U(e,a,r,n,i):AU(e,a,r,n,i)}function e$(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?rB():sB()}function t$(e,t,r,a,n,i,l,o){return t.slice(-4)===".bin"?eB():tB()}function r$(e,t,r,a){return t.slice(-4)===".bin"?JM(e,r,a):BM(e,r,a)}function s$(e,t,r){return vT(e,r)}function a$(e,t,r){return t.slice(-4)===".bin"?aM(e,r):tM(e,r)}function n$(e,t,r){return t.slice(-4)===".bin"?Y7(e,r):z7(e,r)}function i$(e,t,r){return t.slice(-4)===".bin"?F7(e):R7(e)}function l$(e,t,r,a){return r.slice(-4)===".bin"?M7(e,t,r,a):void 0}function o$(e,t,r){return t.slice(-4)===".bin"?I7(e,t,r):P7(e,t,r)}function c$(e,t,r){return(t.slice(-4)===".bin"?XU:MT)(e)}function d$(e,t,r,a,n){return(t.slice(-4)===".bin"?SU:OT)(e,r,a,n)}function u$(e,t,r){return(t.slice(-4)===".bin"?l7:xT)(e,r)}function m$(e,t,r){return(t.slice(-4)===".bin"?lM:oT)(e,r)}function f$(e,t,r){return(t.slice(-4)===".bin"?X7:jT)(e)}function h$(e){return(e.slice(-4)===".bin"?O7:bT)()}var BT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ha(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(BT),i,l,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(zT),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),a[o]=i[2].slice(1,i[2].length-1));return a}function p$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(BT),n,i,l,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(zT),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(i+1),r[l]=n[2].slice(1,n[2].length-1));return r}var Ho;function x$(e,t){var r=Ho[e]||Kt(e);return r==="General"?Xi(t):Fa(r,t)}function g$(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=br(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=jr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Kt(t)]=n}function v$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Bn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ec(e.v):e.w=Xi(e.v):e.w=x$(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=Ho[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&ro(a)){var n=Di(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function b$(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=DM[a.Pattern]||a.Pattern)}e[t.ID]=t}function y$(e,t,r,a,n,i,l,o,c,u){var d="General",m=a.StyleID,f={};u=u||{};var x=[],p=0;for(m===void 0&&o&&(m=o.StyleID),m===void 0&&l&&(m=l.StyleID);i[m]!==void 0&&(i[m].nf&&(d=i[m].nf),i[m].Interior&&x.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=br(e);break;case"String":a.t="s",a.r=kb(Kt(e)),a.v=e.indexOf("<")>-1?Kt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(jr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Kt(e):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=PE[e],u.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=kb(t||e));break}if(v$(a,d,u),u.cellFormula!==!1)if(a.Formula){var h=Kt(a.Formula);h.charCodeAt(0)==61&&(h=h.slice(1)),a.f=Dl(h,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Dl("RC:RC",n):a.ArrayRange&&(a.F=Dl(a.ArrayRange,n),c.push([Xt(a.F),a.F]))}else for(p=0;p<c.length;++p)n.r>=c[p][0].s.r&&n.r<=c[p][0].e.r&&n.c>=c[p][0].s.c&&n.c<=c[p][0].e.c&&(a.F=c[p][1]);u.cellStyles&&(x.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),a.s=f),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function j$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function mf(e,t){var r=t||{};so();var a=Io(ug(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=dr(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=wr(r);return l.type="string",zl.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Gt){n.indexOf("<"+Gt)>=0&&(i=!0)}),i)return iW(a,r);Ho={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},m=[],f=r.dense?[]:{},x="",p={},h={},g=Ha('<Data ss:Type="String">'),b=0,j=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},S={},E="",_=0,T=[],C={},A={},D=0,P=[],R=[],M={},X=[],ie,ae=!1,V=[],me=[],ue={},F=0,Y=0,z={Sheets:[],WBProps:{date1904:!1}},k={};sc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var O="";o=sc.exec(a);)switch(o[3]=(O=o[3]).toLowerCase()){case"data":if(O=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?y$(a.slice(b,o.index),E,g,c[c.length-1][0]=="comment"?M:p,{c:j,r:y},N,X[j],h,V,r):(E="",g=Ha(o[0]),b=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(R.length>0&&(p.c=R),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(f[y]||(f[y]=[]),f[y][j]=p):f[Ir(j)+Wr(y)]=p),p.HRef&&(p.l={Target:Kt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(F=j+(parseInt(p.MergeAcross,10)|0),Y=y+(parseInt(p.MergeDown,10)|0),T.push({s:{c:j,r:y},e:{c:F,r:Y}})),!r.sheetStubs)p.MergeAcross?j=F+1:++j;else if(p.MergeAcross||p.MergeDown){for(var G=j;G<=F;++G)for(var Z=y;Z<=Y;++Z)(G>j||Z>y)&&(r.dense?(f[Z]||(f[Z]=[]),f[Z][G]={t:"z"}):f[Ir(G)+Wr(Z)]={t:"z"});j=F+1}else++j;else p=p$(o[0]),p.Index&&(j=+p.Index-1),j<w.s.c&&(w.s.c=j),j>w.e.c&&(w.e.c=j),o[0].slice(-2)==="/>"&&++j,R=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),o[0].slice(-2)==="/>"&&(h=Ha(o[0]),h.Index&&(y=+h.Index-1)),j=0,++y):(h=Ha(o[0]),h.Index&&(y=+h.Index-1),ue={},(h.AutoFitHeight=="0"||h.Height)&&(ue.hpx=parseInt(h.Height,10),ue.hpt=oc(ue.hpx),me[y]=ue),h.Hidden=="1"&&(ue.hidden=!0,me[y]=ue));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));m.push(x),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=Nt(w),r.sheetRows&&r.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=r.sheetRows-1,f["!ref"]=Nt(w))),T.length&&(f["!merges"]=T),X.length>0&&(f["!cols"]=X),me.length>0&&(f["!rows"]=me),d[x]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=j=0,c.push([o[3],!1]),u=Ha(o[0]),x=Kt(u.Name),f=r.dense?[]:{},T=[],V=[],me=[],k={name:x,Hidden:0},z.Sheets.push(k);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),X=[],ae=!1}break;case"style":o[1]==="/"?b$(N,S,r):S=Ha(o[0]);break;case"numberformat":S.nf=Kt(Ha(o[0]).Format||"General"),Ho[S.nf]&&(S.nf=Ho[S.nf]);for(var ee=0;ee!=392&&ut[ee]!=S.nf;++ee);if(ee==392){for(ee=57;ee!=392;++ee)if(ut[ee]==null){En(S.nf,ee);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=Ha(o[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!ae&&ie.wpx>10){ae=!0,Is=hT;for(var de=0;de<X.length;++de)X[de]&&oi(X[de])}ae&&oi(ie),X[ie.Index-1||X.length]=ie;for(var Ee=0;Ee<+ie.Span;++Ee)X[X.length]=wr(ie);break;case"namedrange":if(o[1]==="/")break;z.Names||(z.Names=[]);var B=ht(o[0]),Se={Name:B.Name,Ref:Dl(B.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(Se.Sheet=z.Sheets.length-1),z.Names.push(Se);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=a.slice(_,o.index):_=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=Ha(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?V8(C,O,a.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));j$(M),R.push(M)}else c.push([o[3],!1]),u=Ha(o[0]),M={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Re=Ha(o[0]);f["!autofilter"]={ref:Dl(Re.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return vy(a,r);var He=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(o[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(D,o.index)){case"SheetHidden":k.Hidden=1;break;case"SheetVeryHidden":k.Hidden=2;break}else D=o.index+o[0].length;break;case"header":f["!margins"]||Ui(f["!margins"]={},"xlml"),isNaN(+ht(o[0]).Margin)||(f["!margins"].header=+ht(o[0]).Margin);break;case"footer":f["!margins"]||Ui(f["!margins"]={},"xlml"),isNaN(+ht(o[0]).Margin)||(f["!margins"].footer=+ht(o[0]).Margin);break;case"pagemargins":var st=ht(o[0]);f["!margins"]||Ui(f["!margins"]={},"xlml"),isNaN(+st.Top)||(f["!margins"].top=+st.Top),isNaN(+st.Left)||(f["!margins"].left=+st.Left),isNaN(+st.Right)||(f["!margins"].right=+st.Right),isNaN(+st.Bottom)||(f["!margins"].bottom=+st.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?g$(A,O,P,a.slice(D,o.index)):(P=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=d),Pe.SheetNames=m,Pe.Workbook=z,Pe.SSF=wr(ut),Pe.Props=C,Pe.Custprops=A,Pe}function Gp(e,t){switch(Rg(t=t||{}),t.type||"base64"){case"base64":return mf(ha(e),t);case"binary":case"buffer":case"file":return mf(e,t);case"array":return mf(hi(e),t)}}function w$(e,t){var r=[];return e.Props&&r.push(G8(e.Props,t)),e.Custprops&&r.push(q8(e.Props,e.Custprops)),r.join("")}function N$(){return""}function S$(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(Me("NumberFormat",null,{"ss:Format":or(ut[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(Me("Style",i.join(""),l))}),Me("Styles",r.join(""))}function UT(e){return Me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+_g(e.Ref,{r:0,c:0})})}function E$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(UT(n)))}return Me("Names",r.join(""))}function T$(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],l=0;l<n.length;++l){var o=n[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(UT(o)))}return i.join("")}function A$(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Me("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Me("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Es("ProtectContents","True")),e["!protect"].objects&&n.push(Es("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Es("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Es("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Es("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":Me("WorksheetOptions",n.join(""),{xmlns:oa.x})}function C$(e){return e.map(function(t){var r=YR(t.t||""),a=Me("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Me("Comment",a,{"ss:Author":t.a})}).join("")}function _$(e,t,r,a,n,i,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+or(_g(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=Or(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=or(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=or(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=l.c||u[d].s.r!=l.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var m="",f="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":m="Number",f=String(e.v);break;case"b":m="Boolean",f=e.v?"1":"0";break;case"e":m="Error",f=Bn[e.v];break;case"d":m="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ut[14]);break;case"s":m="String",f=KR(e.v||"");break}var x=xi(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=l.c+1;var p=e.v!=null?f:"",h=e.t=="z"?"":'<Data ss:Type="'+m+'">'+p+"</Data>";return(e.c||[]).length>0&&(h+=C$(e.c)),Me("Cell",h,o)}function k$(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ul(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function D$(e,t,r,a){if(!e["!ref"])return"";var n=Xt(e["!ref"]),i=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,b){oi(g);var j=!!g.width,y=pm(b,g),w={"ss:Index":b+1};j&&(w["ss:Width"]=ic(y.width)),g.hidden&&(w["ss:Hidden"]="1"),o.push(Me("Column",null,w))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[k$(u,(e["!rows"]||[])[u])],m=n.s.c;m<=n.e.c;++m){var f=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>m)&&!(i[l].s.r>u)&&!(i[l].e.c<m)&&!(i[l].e.r<u)){(i[l].s.c!=m||i[l].s.r!=u)&&(f=!0);break}if(!f){var x={r:u,c:m},p=mt(x),h=c?(e[u]||[])[m]:e[p];d.push(_$(h,p,e,t,r,a,x))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function I$(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],l=i?T$(i,t,e,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?D$(i,t,e,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(A$(i,t,e,r)),a.join("")}function O$(e,t){t||(t={}),e.SSF||(e.SSF=wr(ut)),e.SSF&&(so(),om(e.SSF),t.revssf=dm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(w$(e,t)),r.push(N$()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Me("Worksheet",I$(a,t,e),{"ss:Name":or(e.SheetNames[a])}));return r[2]=S$(e,t),r[3]=E$(e),Hr+Me("Workbook",r.join(""),{xmlns:oa.ss,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:ss":oa.ss,"xmlns:dt":oa.dt,"xmlns:html":oa.html})}function P$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=E8(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=T8(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var R$=[60,1084,2066,2165,2175];function L$(e,t,r,a,n){var i=a,l=[],o=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}l.push(o),r.l+=i;for(var c=jn(r,r.l),u=qp[c],d=0;u!=null&&R$.indexOf(c)>-1;)i=jn(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+i),l.push(o),r.l+=4+i,u=qp[c=jn(r,r.l)];var m=ds(l);Ns(m,0);var f=0;m.lens=[];for(var x=0;x<l.length;++x)m.lens.push(f),f+=l[x].length;if(m.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+a;return t.f(m,m.length,n)}function an(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ut[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Bn[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ec(e.v):e.w=Xi(e.v):e.w=Fa(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&ro(ut[a]||String(a))){var n=Di(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function vd(e,t,r){return{v:e,ixfe:t,t:r}}function F$(e,t){var r={opts:{}},a={},n=t.dense?[]:{},i={},l={},o=null,c=[],u="",d={},m,f="",x,p,h,g,b={},j=[],y,w,N=[],S=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},T=function(ft){return ft<8?Mi[ft]:ft<64&&S[ft-8]||Mi[ft]},C=function(ft,jt,Lr){var nt=jt.XF.data;if(!(!nt||!nt.patternType||!Lr||!Lr.cellStyles)){jt.s={},jt.s.patternType=nt.patternType;var dt;(dt=nc(T(nt.icvFore)))&&(jt.s.fgColor={rgb:dt}),(dt=nc(T(nt.icvBack)))&&(jt.s.bgColor={rgb:dt})}},A=function(ft,jt,Lr){if(!(ue>1)&&!(Lr.sheetRows&&ft.r>=Lr.sheetRows)){if(Lr.cellStyles&&jt.XF&&jt.XF.data&&C(ft,jt,Lr),delete jt.ixfe,delete jt.XF,m=ft,f=mt(ft),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ft.r<l.s.r&&(l.s.r=ft.r),ft.c<l.s.c&&(l.s.c=ft.c),ft.r+1>l.e.r&&(l.e.r=ft.r+1),ft.c+1>l.e.c&&(l.e.c=ft.c+1),Lr.cellFormula&&jt.f){for(var nt=0;nt<j.length;++nt)if(!(j[nt][0].s.c>ft.c||j[nt][0].s.r>ft.r)&&!(j[nt][0].e.c<ft.c||j[nt][0].e.r<ft.r)){jt.F=Nt(j[nt][0]),(j[nt][0].s.c!=ft.c||j[nt][0].s.r!=ft.r)&&delete jt.f,jt.f&&(jt.f=""+Ds(j[nt][1],l,ft,V,D));break}}Lr.dense?(n[ft.r]||(n[ft.r]=[]),n[ft.r][ft.c]=jt):n[f]=jt}},D={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:j,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var P,R=[],M=[],X=[],ie=[],ae=!1,V=[];V.SheetNames=D.snames,V.sharedf=D.sharedf,V.arrayf=D.arrayf,V.names=[],V.XTI=[];var me=0,ue=0,F=0,Y=[],z=[],k;D.codepage=1200,Ka(1200);for(var O=!1;e.l<e.length-1;){var G=e.l,Z=e.read_shift(2);if(Z===0&&me===10)break;var ee=e.l===e.length?0:e.read_shift(2),de=qp[Z];if(de&&de.f){if(t.bookSheets&&me===133&&Z!==133)break;if(me=Z,de.r===2||de.r==12){var Ee=e.read_shift(2);if(ee-=2,!D.enc&&Ee!==Z&&((Ee&255)<<8|Ee>>8)!==Z)throw new Error("rt mismatch: "+Ee+"!="+Z);de.r==12&&(e.l+=10,ee-=10)}var B={};if(Z===10?B=de.f(e,ee,D):B=L$(Z,de,e,ee,D),ue==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(Z){case 34:r.opts.Date1904=E.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=B,!t.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=B;break;case 66:var Se=Number(B);switch(Se){case 21010:Se=1200;break;case 32768:Se=1e4;break;case 32769:Se=1252;break}Ka(D.codepage=Se),O=!0;break;case 317:D.rrtabid=B;break;case 25:D.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:D.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(n["!type"]="dialog"),B.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),B.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:N.push(B);break;case 430:V.push([B]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(B);break;case 24:case 536:k={Name:B.Name,Ref:Ds(B.rgce,l,null,V,D)},B.itab>0&&(k.Sheet=B.itab-1),V.names.push(k),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(z[B.itab-1]={ref:Nt(B.rgce[0][0][1][2])});break;case 22:D.ExternCount=B;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(B),V.XTI=V.XTI.concat(B);break;case 2196:if(D.biff<8)break;k!=null&&(k.Comment=B[1]);break;case 18:n["!protect"]=B;break;case 19:B!==0&&D.WTF&&console.error("Password verifier: "+B);break;case 133:i[B.pos]=B,D.snames.push(B.name);break;case 10:{if(--ue)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=Nt(l),t.sheetRows&&t.sheetRows<=l.e.r){var Re=l.e.r;l.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Nt(l),l.e.r=Re}l.e.r++,l.e.c++}R.length>0&&(n["!merges"]=R),M.length>0&&(n["!objects"]=M),X.length>0&&(n["!cols"]=X),ie.length>0&&(n["!rows"]=ie),E.Sheets.push(_)}u===""?d=n:a[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Z]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),D.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(D.biff=5,O=!0,Ka(D.codepage=28591)),D.biff==8&&B.BIFFVer==0&&B.dt==16&&(D.biff=2),ue++)break;if(n=t.dense?[]:{},D.biff<8&&!O&&(O=!0,Ka(D.codepage=t.codepage||1252)),D.biff<5||B.BIFFVer==0&&B.dt==4096){u===""&&(u="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var He={pos:e.l-ee,name:u};i[He.pos]=He,D.snames.push(u)}else u=(i[G]||{name:""}).name;B.dt==32&&(n["!type"]="chart"),B.dt==64&&(n["!type"]="macro"),R=[],M=[],D.arrayf=j=[],X=[],ie=[],ae=!1,_={Hidden:(i[G]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[B.r]||[])[B.c]:n[mt({c:B.c,r:B.r})])&&++B.c,y={ixfe:B.ixfe,XF:N[B.ixfe]||{},v:B.val,t:"n"},F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 5:case 517:y={ixfe:B.ixfe,XF:N[B.ixfe],v:B.val,t:B.t},F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 638:y={ixfe:B.ixfe,XF:N[B.ixfe],v:B.rknum,t:"n"},F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 189:for(var st=B.c;st<=B.C;++st){var Pe=B.rkrec[st-B.c][0];y={ixfe:Pe,XF:N[Pe],v:B.rkrec[st-B.c][1],t:"n"},F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A({c:st,r:B.r},y,t)}break;case 6:case 518:case 1030:{if(B.val=="String"){o=B;break}if(y=vd(B.val,B.cell.ixfe,B.tt),y.XF=N[y.ixfe],t.cellFormula){var Gt=B.formula;if(Gt&&Gt[0]&&Gt[0][0]&&Gt[0][0][0]=="PtgExp"){var yt=Gt[0][0][1][0],Pt=Gt[0][0][1][1],qt=mt({r:yt,c:Pt});b[qt]?y.f=""+Ds(B.formula,l,B.cell,V,D):y.F=((t.dense?(n[yt]||[])[Pt]:n[qt])||{}).F}else y.f=""+Ds(B.formula,l,B.cell,V,D)}F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A(B.cell,y,t),o=B}break;case 7:case 519:if(o)o.val=B,y=vd(B,o.cell.ixfe,"s"),y.XF=N[y.ixfe],t.cellFormula&&(y.f=""+Ds(o.formula,l,o.cell,V,D)),F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{j.push(B);var Ie=mt(B[0].s);if(x=t.dense?(n[B[0].s.r]||[])[B[0].s.c]:n[Ie],t.cellFormula&&x){if(!o||!Ie||!x)break;x.f=""+Ds(B[1],l,B[0],V,D),x.F=Nt(B[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!o)break;b[mt(o.cell)]=B[0],x=t.dense?(n[o.cell.r]||[])[o.cell.c]:n[mt(o.cell)],(x||{}).f=""+Ds(B[0],l,m,V,D)}}break;case 253:y=vd(c[B.isst].t,B.ixfe,"s"),c[B.isst].h&&(y.h=c[B.isst].h),y.XF=N[y.ixfe],F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:B.ixfe,XF:N[B.ixfe],t:"z"},F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t));break;case 190:if(t.sheetStubs)for(var Ue=B.c;Ue<=B.C;++Ue){var De=B.ixfe[Ue-B.c];y={ixfe:De,XF:N[De],t:"z"},F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A({c:Ue,r:B.r},y,t)}break;case 214:case 516:case 4:y=vd(B.val,B.ixfe,"s"),y.XF=N[y.ixfe],F>0&&(y.z=Y[y.ixfe>>8&63]),an(y,t,r.opts.Date1904),A({c:B.c,r:B.r},y,t);break;case 0:case 512:ue===1&&(l=B);break;case 252:c=B;break;case 1054:if(D.biff==4){Y[F++]=B[1];for(var lt=0;lt<F+163&&ut[lt]!=B[1];++lt);lt>=163&&En(B[1],F+163)}else En(B[1],B[0]);break;case 30:{Y[F++]=B;for(var Ut=0;Ut<F+163&&ut[Ut]!=B;++Ut);Ut>=163&&En(B,F+163)}break;case 229:R=R.concat(B);break;case 93:M[B.cmo[0]]=D.lastobj=B;break;case 438:D.lastobj.TxO=B;break;case 127:D.lastobj.ImData=B;break;case 440:for(g=B[0].s.r;g<=B[0].e.r;++g)for(h=B[0].s.c;h<=B[0].e.c;++h)x=t.dense?(n[g]||[])[h]:n[mt({c:h,r:g})],x&&(x.l=B[1]);break;case 2048:for(g=B[0].s.r;g<=B[0].e.r;++g)for(h=B[0].s.c;h<=B[0].e.c;++h)x=t.dense?(n[g]||[])[h]:n[mt({c:h,r:g})],x&&x.l&&(x.l.Tooltip=B[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;x=t.dense?(n[B[0].r]||[])[B[0].c]:n[mt(B[0])];var rr=M[B[2]];x||(t.dense?(n[B[0].r]||(n[B[0].r]=[]),x=n[B[0].r][B[0].c]={t:"z"}):x=n[mt(B[0])]={t:"z"},l.e.r=Math.max(l.e.r,B[0].r),l.s.r=Math.min(l.s.r,B[0].r),l.e.c=Math.max(l.e.c,B[0].c),l.s.c=Math.min(l.s.c,B[0].c)),x.c||(x.c=[]),p={a:B[1],t:rr.TxO.t},x.c.push(p)}break;case 2173:S7(N[B.ixfe],B.ext);break;case 125:{if(!D.cellStyles)break;for(;B.e>=B.s;)X[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},ae||(ae=!0,Tg(B.w/256)),oi(X[B.e+1])}break;case 520:{var ct={};B.level!=null&&(ie[B.r]=ct,ct.level=B.level),B.hidden&&(ie[B.r]=ct,ct.hidden=!0),B.hpt&&(ie[B.r]=ct,ct.hpt=B.hpt,ct.hpx=Ul(B.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Ui(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Z]]=B;break;case 161:n["!margins"]||Ui(n["!margins"]={}),n["!margins"].header=B.header,n["!margins"].footer=B.footer;break;case 574:B.RTL&&(E.Views[0].RTL=!0);break;case 146:S=B;break;case 2198:P=B;break;case 140:w=B;break;case 442:u?_.CodeName=B||_.name:E.WBProps.CodeName=B||"ThisWorkbook";break}}else de||console.error("Missing Info for XLS Record 0x"+Z.toString(16)),e.l+=ee}return r.SheetNames=Br(i).sort(function(Et,ft){return Number(Et)-Number(ft)}).map(function(Et){return i[Et].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&z.forEach(function(Et,ft){r.Sheets[r.SheetNames[ft]]["!autofilter"]=Et}),r.Strings=c,r.SSF=wr(ut),D.enc&&(r.Encryption=D.enc),P&&(r.Themes=P),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),V.names.length>0&&(E.Names=V.names),r.Workbook=E,r}var Vo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function M$(e,t,r){var a=it.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Kb(a,zp,Vo.DSI);for(var i in n)t[i]=n[i]}catch(u){if(r.WTF)throw u}var l=it.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=Kb(l,Up,Vo.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(zE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function B$(e,t){var r=[],a=[],n=[],i=0,l,o=Sb(zp,"n"),c=Sb(Up,"n");if(e.Props)for(l=Br(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?a:n).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=Br(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?a:n).push([l[i],e.Custprops[l[i]]]);var u=[];for(i=0;i<n.length;++i)qE.indexOf(n[i][0])>-1||BE.indexOf(n[i][0])>-1||n[i][1]!=null&&u.push(n[i]);a.length&&it.utils.cfb_add(t,"/SummaryInformation",Yb(a,Vo.SI,c,Up)),(r.length||u.length)&&it.utils.cfb_add(t,"/DocumentSummaryInformation",Yb(r,Vo.DSI,o,zp,u.length?u:null,Vo.UDI))}function $T(e,t){t||(t={}),Rg(t),rg(),t.codepage&&tg(t.codepage);var r,a;if(e.FullPaths){if(it.find(e,"/encryption"))throw new Error("File is password-protected");r=it.find(e,"!CompObj"),a=it.find(e,"/Workbook")||it.find(e,"/Book")}else{switch(t.type){case"base64":e=da(ha(e));break;case"binary":e=da(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ns(e,0),a={content:e}}var n,i;if(r&&P$(r),t.bookProps&&!t.bookSheets)n={};else{var l=Dt?"buffer":"array";if(a&&a.content)n=F$(a.content,t);else if((i=it.find(e,"PerfectOffice_MAIN"))&&i.content)n=zi.to_workbook(i.content,(t.type=l,t));else if((i=it.find(e,"NativeContent_MAIN"))&&i.content)n=zi.to_workbook(i.content,(t.type=l,t));else throw(i=it.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&it.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Z7(e))}var o={};return e.FullPaths&&M$(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}function z$(e,t){var r=t||{},a=it.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return it.utils.cfb_add(a,n,WT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&B$(e,a),r.biff==8&&e.vbaraw&&Q7(a,it.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var cc={0:{f:dz},1:{f:vz},2:{f:Fz},3:{f:Tz},4:{f:wz},5:{f:Pz},6:{f:$z},7:{f:kz},8:{f:Yz},9:{f:Kz},10:{f:Gz},11:{f:qz},12:{f:yz},13:{f:Bz},14:{f:Cz},15:{f:Sz},16:{f:PT},17:{f:Hz},18:{f:Iz},19:{f:xg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:HU},40:{},42:{},43:{f:$M},44:{f:zM},45:{f:VM},46:{f:qM},47:{f:GM},48:{},49:{f:f8},50:{},51:{f:A7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:aT},62:{f:Uz},63:{f:L7},64:{f:uU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Bs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xz},148:{f:fz,p:16},151:{f:tU},152:{},153:{f:UU},154:{},155:{},156:{f:BU},157:{},158:{},159:{T:1,f:sM},160:{T:-1},161:{T:1,f:fl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Xz},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:E7},336:{T:-1},337:{f:k7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:rU},427:{f:sU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:pz},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Qz},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:q7},633:{T:1},634:{T:-1},635:{T:1,f:V7},636:{T:-1},637:{f:g8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:CU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:mU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},qp={6:{f:df},10:{f:Yn},12:{f:Kr},13:{f:Kr},14:{f:zr},15:{f:zr},16:{f:Rs},17:{f:zr},18:{f:zr},19:{f:Kr},20:{f:ty},21:{f:ty},23:{f:sT},24:{f:sy},25:{f:zr},26:{},27:{},28:{f:mF},29:{},34:{f:zr},35:{f:ry},38:{f:Rs},39:{f:Rs},40:{f:Rs},41:{f:Rs},42:{f:zr},43:{f:zr},47:{f:SM},49:{f:BL},51:{f:Kr},60:{},61:{f:PL},64:{f:zr},65:{f:ML},66:{f:Kr},77:{},80:{},81:{},82:{},85:{f:Kr},89:{},90:{},91:{},92:{f:NL},93:{f:pF},94:{},95:{f:zr},96:{},97:{},99:{f:zr},125:{f:aT},128:{f:eF},129:{f:EL},130:{f:Kr},131:{f:zr},132:{f:zr},133:{f:TL},134:{},140:{f:NF},141:{f:Kr},144:{},146:{f:TF},151:{},152:{},153:{},154:{},155:{},156:{f:Kr},157:{},158:{},160:{f:OF},161:{f:_F},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:XL},190:{f:JL},193:{f:Yn},197:{},198:{},199:{},200:{},201:{},202:{f:zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Kr},220:{},221:{f:zr},222:{},224:{f:QL},225:{f:wL},226:{f:Yn},227:{},229:{f:fF},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:CL},253:{f:UL},255:{f:kL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:KE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zr},353:{f:Yn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:nF},431:{f:zr},432:{},433:{},434:{},437:{},438:{f:vF},439:{f:zr},440:{f:bF},441:{},442:{f:Rc},443:{},444:{f:Kr},445:{},446:{},448:{f:Yn},449:{f:OL,r:2},450:{f:Yn},512:{f:Zb},513:{f:IF},515:{f:sF},516:{f:WL},517:{f:ey},519:{f:PF},520:{f:DL},523:{},545:{f:ay},549:{f:Jb},566:{},574:{f:LL},638:{f:YL},659:{},1048:{},1054:{f:VL},1084:{},1212:{f:cF},2048:{f:jF},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:pd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Yn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:AF,r:12},2173:{f:N7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:oF,r:12},2197:{},2198:{f:g7,r:12},2199:{},2200:{},2201:{},2202:{f:dF,r:12},2203:{f:Yn},2204:{},2205:{},2206:{},2207:{},2211:{f:IL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Kr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:kF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:EF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zb},1:{},2:{f:BF},3:{f:FF},4:{f:LF},5:{f:ey},7:{f:UF},8:{},9:{f:pd},11:{},22:{f:Kr},30:{f:qL},31:{},32:{},33:{f:ay},36:{},37:{f:Jb},50:{f:$F},62:{},52:{},67:{},68:{f:Kr},69:{},86:{},126:{},127:{f:RF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:WF},223:{},234:{},354:{},421:{},518:{f:df},521:{f:pd},536:{f:sy},547:{f:ry},561:{},579:{},1030:{f:df},1033:{f:pd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Be(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,i),i>0&&fg(r)&&e.push(r)}}function U$(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Be(e,t,r,n);var i=t;if(!isNaN(i)){for(var l=r.parts||[],o=0,c=0,u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Bc(e,t,r){return e||(e=Te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function $$(e,t,r,a){var n=Te(9);return Bc(n,e,t),YE(r,a||"b",n),n}function W$(e,t,r){var a=Te(8+2*r.length);return Bc(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function H$(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?ss(jr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Be(e,2,zF(r,a,n)):Be(e,3,MF(r,a,n));return;case"b":case"e":Be(e,5,$$(r,a,t.v,t.t));return;case"s":case"str":Be(e,4,W$(r,a,(t.v||"").slice(0,255)));return}Be(e,1,Bc(null,r,a))}function V$(e,t,r,a){var n=Array.isArray(t),i=Xt(t["!ref"]||"A1"),l,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=Nt(i)}for(var u=i.s.r;u<=i.e.r;++u){o=Wr(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=Ir(d)),l=c[d]+o;var m=n?(t[u]||[])[d]:t[l];m&&H$(e,m,u,d)}}}function G$(e,t){for(var r=t||{},a=ra(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Be(a,r.biff==4?1033:r.biff==3?521:9,Ng(e,16,r)),V$(a,e.Sheets[e.SheetNames[n]],n,r),Be(a,10),a.end()}function q$(e,t,r){Be(e,49,zL({sz:12,name:"Arial"},r))}function K$(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Be(e,1054,GL(n,t[n],r))})}function Y$(e,t){var r=Te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Be(e,2151,r),r=Te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),eT(Xt(t["!ref"]||"A1"),r),r.write_shift(4,4),Be(e,2152,r)}function X$(e,t){for(var r=0;r<16;++r)Be(e,224,Qb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Be(e,224,Qb(a,0,t))})}function J$(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Be(e,440,yF(a)),a[1].Tooltip&&Be(e,2048,wF(a))}delete t["!links"]}function Z$(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Be(e,125,CF(pm(n,a),n))})}}function Q$(e,t,r,a,n){var i=16+xi(n.cellXfs,t,n);if(t.v==null&&!t.bf){Be(e,513,el(r,a,i));return}if(t.bf)Be(e,6,E9(t,r,a,n,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?ss(jr(t.v)):t.v;Be(e,515,aF(r,a,l,i));break;case"b":case"e":Be(e,517,rF(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var o=Dg(n.Strings,t.v,n.revStrings);Be(e,253,$L(r,a,o,i))}else Be(e,516,HL(r,a,(t.v||"").slice(0,255),i,n));break;default:Be(e,513,el(r,a,i))}}function eW(e,t,r){var a=ra(),n=r.SheetNames[e],i=r.Sheets[n]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,m="",f=[],x=Xt(i["!ref"]||"A1"),p=u?65536:16384;if(x.e.c>255||x.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,p-1)}Be(a,2057,Ng(r,16,t)),Be(a,13,ka(1)),Be(a,12,ka(100)),Be(a,15,Vs(!0)),Be(a,17,Vs(!1)),Be(a,16,Zi(.001)),Be(a,95,Vs(!0)),Be(a,42,Vs(!1)),Be(a,43,Vs(!1)),Be(a,130,ka(1)),Be(a,128,tF()),Be(a,131,Vs(!1)),Be(a,132,Vs(!1)),u&&Z$(a,i["!cols"]),Be(a,512,KL(x,t)),u&&(i["!links"]=[]);for(var h=x.s.r;h<=x.e.r;++h){m=Wr(h);for(var g=x.s.c;g<=x.e.c;++g){h===x.s.r&&(f[g]=Ir(g)),d=f[g]+m;var b=c?(i[h]||[])[g]:i[d];b&&(Q$(a,b,h,g,t),u&&b.l&&i["!links"].push([d,b.l]))}}var j=o.CodeName||o.name||n;return u&&Be(a,574,FL((l.Views||[])[0])),u&&(i["!merges"]||[]).length&&Be(a,229,hF(i["!merges"])),u&&J$(a,i),Be(a,442,XE(j)),u&&Y$(a,i),Be(a,10),a.end()}function tW(e,t,r){var a=ra(),n=(e||{}).Workbook||{},i=n.Sheets||[],l=n.WBProps||{},o=r.biff==8,c=r.biff==5;if(Be(a,2057,Ng(e,5,r)),r.bookType=="xla"&&Be(a,135),Be(a,225,o?ka(1200):null),Be(a,193,rL(2)),c&&Be(a,191),c&&Be(a,192),Be(a,226),Be(a,92,SL("SheetJS",r)),Be(a,66,ka(o?1200:1252)),o&&Be(a,353,ka(0)),o&&Be(a,448),Be(a,317,DF(e.SheetNames.length)),o&&e.vbaraw&&Be(a,211),o&&e.vbaraw){var u=l.CodeName||"ThisWorkbook";Be(a,442,XE(u))}Be(a,156,ka(17)),Be(a,25,Vs(!1)),Be(a,18,Vs(!1)),Be(a,19,ka(0)),o&&Be(a,431,Vs(!1)),o&&Be(a,444,ka(0)),Be(a,61,RL()),Be(a,64,Vs(!1)),Be(a,141,ka(0)),Be(a,34,Vs(OU(e)=="true")),Be(a,14,Vs(!0)),o&&Be(a,439,Vs(!1)),Be(a,218,ka(0)),q$(a,e,r),K$(a,e.SSF,r),X$(a,r),o&&Be(a,352,Vs(!1));var d=a.end(),m=ra();o&&Be(m,140,SF()),o&&r.Strings&&U$(m,252,_L(r.Strings)),Be(m,10);var f=m.end(),x=ra(),p=0,h=0;for(h=0;h<e.SheetNames.length;++h)p+=(o?12:11)+(o?2:1)*e.SheetNames[h].length;var g=d.length+p+f.length;for(h=0;h<e.SheetNames.length;++h){var b=i[h]||{};Be(x,133,AL({pos:g,hs:b.Hidden||0,dt:0,name:e.SheetNames[h]},r)),g+=t[h].length}var j=x.end();if(p!=j.length)throw new Error("BS8 "+p+" != "+j.length);var y=[];return d.length&&y.push(d),j.length&&y.push(j),f.length&&y.push(f),ds(y)}function rW(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=wr(ut)),e&&e.SSF&&(so(),om(e.SSF),r.revssf=dm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Lg(r),r.cellXfs=[],xi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=eW(n,r,e);return a.unshift(tW(e,a,r)),ds(a)}function WT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=sa(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return rW(e,t);case 4:case 3:case 2:return G$(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function hy(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=n.index,o=i&&i.index||e.length,c=zR(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,m=0,f=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<c.length;++l){var h=c[l].trim(),g=h.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var b=h.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var j=b[o].trim();if(j.match(/<t[dh]/i)){for(var y=j,w=0;y.charAt(0)=="<"&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var N=0;N<p.length;++N){var S=p[N];S.s.c==d&&S.s.r<u&&u<=S.e.r&&(d=S.e.c+1,N=-1)}var E=ht(j.slice(0,j.indexOf(">")));f=E.colspan?+E.colspan:1,((m=+E.rowspan)>1||f>1)&&p.push({s:{r:u,c:d},e:{r:u+(m||1)-1,c:d+f-1}});var _=E.t||E["data-t"]||"";if(!y.length){d+=f;continue}if(y=fE(y),x.s.r>u&&(x.s.r=u),x.e.r<u&&(x.e.r=u),x.s.c>d&&(x.s.c=d),x.e.c<d&&(x.e.c=d),!y.length){d+=f;continue}var T={t:"s",v:y};r.raw||!y.trim().length||_=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(Xa(y))?isNaN(Bl(y).getDate())||(T={t:"d",v:jr(y)},r.cellDates||(T={t:"n",v:ss(T.v)}),T.z=r.dateNF||ut[14]):T={t:"n",v:Xa(y)}),r.dense?(a[u]||(a[u]=[]),a[u][d]=T):a[mt({r:u,c:d})]=T,d+=f}}}}return a["!ref"]=Nt(x),p.length&&(a["!merges"]=p),a}function sW(e,t,r,a){for(var n=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>l)&&!(n[u].e.r<r||n[u].e.c<l)){if(n[u].s.r<r||n[u].s.c<l){o=-1;break}o=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(o<0)){var d=mt({r,c:l}),m=a.dense?(e[r]||[])[l]:e[d],f=m&&m.v!=null&&(m.h||dg(m.w||(Dn(m),m.w)||""))||"",x={};o>1&&(x.rowspan=o),c>1&&(x.colspan=c),a.editable?f='<span contenteditable="true">'+f+"</span>":m&&(x["data-t"]=m&&m.t||"z",m.v!=null&&(x["data-v"]=m.v),m.z!=null&&(x["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+m.l.Target+'">'+f+"</a>")),x.id=(a.id||"sjs")+"-"+d,i.push(Me("td",f,x))}}var p="<tr>";return p+i.join("")+"</tr>"}var aW='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nW="</body></html>";function iW(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return pi(hy(r[0],t),t);var a=zg();return r.forEach(function(n,i){Ug(a,hy(n,t),"Sheet"+(i+1))}),a}function lW(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function HT(e,t){var r=t||{},a=r.header!=null?r.header:aW,n=r.footer!=null?r.footer:nW,i=[a],l=sa(e["!ref"]);r.dense=Array.isArray(e),i.push(lW(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(sW(e,l,o,r));return i.push("</table>"+n),i.join("")}function VT(e,t,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?Or(a.origin):a.origin;n=l.r,i=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var d=sa(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var m=[],f=0,x=e["!rows"]||(e["!rows"]=[]),p=0,h=0,g=0,b=0,j=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&h<c;++p){var w=o[p];if(py(w)){if(a.display)continue;x[h]={hidden:!0}}var N=w.children;for(g=b=0;g<N.length;++g){var S=N[g];if(!(a.display&&py(S))){var E=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):fE(S.innerHTML),_=S.getAttribute("data-z")||S.getAttribute("z");for(f=0;f<m.length;++f){var T=m[f];T.s.c==b+i&&T.s.r<h+n&&h+n<=T.e.r&&(b=T.e.c+1-i,f=-1)}y=+S.getAttribute("colspan")||1,((j=+S.getAttribute("rowspan")||1)>1||y>1)&&m.push({s:{r:h+n,c:b+i},e:{r:h+n+(j||1)-1,c:b+i+(y||1)-1}});var C={t:"s",v:E},A=S.getAttribute("data-t")||S.getAttribute("t")||"";E!=null&&(E.length==0?C.t=A||"z":a.raw||E.trim().length==0||A=="s"||(E==="TRUE"?C={t:"b",v:!0}:E==="FALSE"?C={t:"b",v:!1}:isNaN(Xa(E))?isNaN(Bl(E).getDate())||(C={t:"d",v:jr(E)},a.cellDates||(C={t:"n",v:ss(C.v)}),C.z=a.dateNF||ut[14]):C={t:"n",v:Xa(E)})),C.z===void 0&&_!=null&&(C.z=_);var D="",P=S.getElementsByTagName("A");if(P&&P.length)for(var R=0;R<P.length&&!(P[R].hasAttribute("href")&&(D=P[R].getAttribute("href"),D.charAt(0)!="#"));++R);D&&D.charAt(0)!="#"&&(C.l={Target:D}),a.dense?(e[h+n]||(e[h+n]=[]),e[h+n][b+i]=C):e[mt({c:b+i,r:h+n})]=C,u.e.c<b+i&&(u.e.c=b+i),b+=y}}++h}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,h-1+n),e["!ref"]=Nt(u),h>=c&&(e["!fullref"]=Nt((u.e.r=o.length-p+h-1+n,u))),e}function GT(e,t){var r=t||{},a=r.dense?[]:{};return VT(a,e,t)}function oW(e,t){return pi(GT(e,t),t)}function py(e){var t="",r=cW(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function cW(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function dW(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Kt(t.replace(/<[^>]*>/g,""));return[r]}var xy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qT(e,t){var r=t||{},a=ug(e),n=[],i,l,o={name:""},c="",u=0,d,m,f={},x=[],p=r.dense?[]:{},h,g,b={value:""},j="",y=0,w=[],N=-1,S=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},_=0,T={},C=[],A={},D=0,P=0,R=[],M=1,X=1,ie=[],ae={Names:[]},V={},me=["",""],ue=[],F={},Y="",z=0,k=!1,O=!1,G=0;for(sc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");h=sc.exec(a);)switch(h[3]=h[3].replace(/_.*$/,"")){case"table":case"":h[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?p["!ref"]=Nt(E):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=Nt(E)),C.length&&(p["!merges"]=C),R.length&&(p["!rows"]=R),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),x.push(d.name),f[d.name]=p,O=!1):h[0].charAt(h[0].length-2)!=="/"&&(d=ht(h[0],!1),N=S=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,p=r.dense?[]:{},C=[],R=[],O=!0);break;case"table-row-group":h[1]==="/"?--_:++_;break;case"table-row":case"":if(h[1]==="/"){N+=M,M=1;break}if(m=ht(h[0],!1),m.?N=m.-1:N==-1&&(N=0),M=+m["number-rows-repeated"]||1,M<10)for(G=0;G<M;++G)_>0&&(R[N+G]={level:_});S=-1;break;case"covered-table-cell":h[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(p[N]||(p[N]=[]),p[N][S]={t:"z"}):p[mt({r:N,c:S})]={t:"z"}),j="",w=[];break;case"table-cell":case"":if(h[0].charAt(h[0].length-2)==="/")++S,b=ht(h[0],!1),X=parseInt(b["number-columns-repeated"]||"1",10),g={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(g.f=uy(Kt(b.formula))),(b.||b["value-type"])=="string"&&(g.t="s",g.v=Kt(b["string-value"]||""),r.dense?(p[N]||(p[N]=[]),p[N][S]=g):p[mt({r:N,c:S})]=g),S+=X-1;else if(h[1]!=="/"){++S,j="",y=0,w=[],X=1;var Z=M?N+M-1:N;if(S>E.e.c&&(E.e.c=S),S<E.s.c&&(E.s.c=S),N<E.s.r&&(E.s.r=N),Z>E.e.r&&(E.e.r=Z),b=ht(h[0],!1),ue=[],F={},g={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Kt(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(D=parseInt(b["number-matrix-rows-spanned"],10)||0,P=parseInt(b["number-matrix-columns-spanned"],10)||0,A={s:{r:N,c:S},e:{r:N+D-1,c:S+P-1}},g.F=Nt(A),ie.push([A,g.F])),b.formula)g.f=uy(b.formula);else for(G=0;G<ie.length;++G)N>=ie[G][0].s.r&&N<=ie[G][0].e.r&&S>=ie[G][0].s.c&&S<=ie[G][0].e.c&&(g.F=ie[G][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(D=parseInt(b["number-rows-spanned"],10)||0,P=parseInt(b["number-columns-spanned"],10)||0,A={s:{r:N,c:S},e:{r:N+D-1,c:S+P-1}},C.push(A)),b["number-columns-repeated"]&&(X=parseInt(b["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=br(b["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(b.value);break;case"percentage":g.t="n",g.v=parseFloat(b.value);break;case"currency":g.t="n",g.v=parseFloat(b.value);break;case"date":g.t="d",g.v=jr(b["date-value"]),r.cellDates||(g.t="n",g.v=ss(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=FR(b["time-value"])/86400,r.cellDates&&(g.t="d",g.v=um(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(b.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",b["string-value"]!=null&&(j=Kt(b["string-value"]),w=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(k=!1,g.t==="s"&&(g.v=j||"",w.length&&(g.R=w),k=y==0),V.Target&&(g.l=V),ue.length>0&&(g.c=ue,ue=[]),j&&r.cellText!==!1&&(g.w=j),k&&(g.t="z",delete g.v),(!k||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=N))for(var ee=0;ee<M;++ee){if(X=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(p[N+ee]||(p[N+ee]=[]),p[N+ee][S]=ee==0?g:wr(g);--X>0;)p[N+ee][S+X]=wr(g);else for(p[mt({r:N+ee,c:S})]=g;--X>0;)p[mt({r:N+ee,c:S+X})]=wr(g);E.e.c<=S&&(E.e.c=S)}X=parseInt(b["number-columns-repeated"]||"1",10),S+=X-1,X=0,g={},j="",w=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!0]);break;case"annotation":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i;F.t=j,w.length&&(F.R=w),F.a=Y,ue.push(F)}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!1]);Y="",z=0,j="",y=0,w=[];break;case"creator":h[1]==="/"?Y=a.slice(z,h.index):z=h.index+h[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!1]);j="",y=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(h[1]==="/"){if(T[o.name]=c,(i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&(c="",o=ht(h[0],!1),n.push([h[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=ht(h[0],!1),c+=xy[h[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=ht(h[0],!1),c+=xy[h[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(h[0].slice(-2)==="/>")break;if(h[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(u,h.index);break}else u=h.index+h[0].length;break;case"named-range":l=ht(h[0],!1),me=uf(l["cell-range-address"]);var de={Name:l.name,Ref:me[0]+"!"+me[1]};O&&(de.Sheet=x.length),ae.Names.push(de);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(h[1]==="/"&&(!b||!b["string-value"])){var Ee=dW(a.slice(y,h.index));j=(j.length>0?j+`
`:"")+Ee[0]}else ht(h[0],!1),y=h.index+h[0].length;break;case"s":break;case"database-range":if(h[1]==="/")break;try{me=uf(ht(h[0])["target-range-address"]),f[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(h[1]!=="/"){if(V=ht(h[0],!1),!V.href)break;V.Target=Kt(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(me=uf(V.Target.slice(1)),V.Target="#"+me[0]+"!"+me[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(h[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(h)}}var B={Sheets:f,SheetNames:x,Workbook:ae};return r.bookSheets&&delete B.Sheets,B}function gy(e,t){t=t||{},Ca(e,"META-INF/manifest.xml")&&F8(qr(e,"META-INF/manifest.xml"),t);var r=ua(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=qT(dr(r),t);return Ca(e,"meta.xml")&&(a.Props=FE(qr(e,"meta.xml"))),a}function vy(e,t){return qT(e,t)}var uW=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Hr+t}})(),by=(function(){var e=function(i){return or(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,l,o){var c=[];c.push('      <table:table table:name="'+or(l.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,m=sa(i["!ref"]||"A1"),f=i["!merges"]||[],x=0,p=Array.isArray(i);if(i["!cols"])for(d=0;d<=m.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var h="",g=i["!rows"]||[];for(u=0;u<m.s.r;++u)h=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+h+`></table:table-row>
`);for(;u<=m.e.r;++u){for(h=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+h+`>
`),d=0;d<m.s.c;++d)c.push(t);for(;d<=m.e.c;++d){var b=!1,j={},y="";for(x=0;x!=f.length;++x)if(!(f[x].s.c>d)&&!(f[x].s.r>u)&&!(f[x].e.c<d)&&!(f[x].e.r<u)){(f[x].s.c!=d||f[x].s.r!=u)&&(b=!0),j["table:number-columns-spanned"]=f[x].e.c-f[x].s.c+1,j["table:number-rows-spanned"]=f[x].e.r-f[x].s.r+1;break}if(b){c.push(r);continue}var w=mt({r:u,c:d}),N=p?(i[u]||[])[d]:i[w];if(N&&N.f&&(j["table:formula"]=or(D9(N.f)),N.F&&N.F.slice(0,w.length)==w)){var S=sa(N.F);j["table:number-matrix-columns-spanned"]=S.e.c-S.s.c+1,j["table:number-matrix-rows-spanned"]=S.e.r-S.s.r+1}if(!N){c.push(t);continue}switch(N.t){case"b":y=N.v?"TRUE":"FALSE",j["office:value-type"]="boolean",j["office:boolean-value"]=N.v?"true":"false";break;case"n":y=N.w||String(N.v||0),j["office:value-type"]="float",j["office:value"]=N.v||0;break;case"s":case"str":y=N.v==null?"":N.v,j["office:value-type"]="string";break;case"d":y=N.w||jr(N.v).toISOString(),j["office:value-type"]="date",j["office:date-value"]=jr(N.v).toISOString(),j["table:style-name"]="ce1";break;default:c.push(t);continue}var E=e(y);if(N.l&&N.l.Target){var _=N.l.Target;_=_.charAt(0)=="#"?"#"+I9(_.slice(1)):_,_.charAt(0)!="#"&&!_.match(/^\w+:/)&&(_="../"+_),E=Me("text:a",E,{"xlink:href":_.replace(/&/g,"&amp;")})}c.push("          "+Me("table:table-cell",Me("text:p",E,{}),j)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var m=u["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;oi(m),m.ods=o;var f=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var m=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var c=[Hr],u=rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=rc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(LE().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=l.SheetNames.length;++m)c.push(a(l.Sheets[l.SheetNames[m]],l,m));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function KT(e,t){if(t.bookType=="fods")return by(e,t);var r=lg(),a="",n=[],i=[];return a="mimetype",Tt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Tt(r,a,by(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Tt(r,a,uW(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Tt(r,a,Hr+LE()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Tt(r,a,z8(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Tt(r,a,M8(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Kp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):dr(hi(e))}function mW(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):da(on(e))}function fW(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function di(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function yy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function hW(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function pW(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function dc(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function nr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Mr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Zt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=dc(e,r),i=n&7;n=Math.floor(n/8);var l=0,o;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=dc(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var u={data:o,type:i};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function bs(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(nr(a*8+n.type)),n.type==2&&t.push(nr(n.data.length)),t.push(n.data))})}),di(t)}function Pg(e,t){return e?.map(function(r){return t(r.data)})||[]}function Sa(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=dc(e,a),i=Zt(e.slice(a[0],a[0]+n));a[0]+=n;var l={id:Mr(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Zt(o.data),u=Mr(c[3][0].data);l.messages.push({meta:c,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=i[3])!=null&&t[0]&&(l.merge=Mr(i[3][0].data)>>>0>0),r.push(l)}return r}function wl(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:nr(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:nr(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:nr(l.data.length)}],a[2].push({data:bs(l.meta),type:2})});var i=bs(a);t.push(nr(i.length)),t.push(i),n.forEach(function(l){return t.push(l)})}),di(t)}function xW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=dc(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}n.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[di(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=di(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function Ea(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(xW(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return di(t)}function Nl(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=nr(a),l=i.length;t.push(i),a<=60?(l++,t.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return di(t)}function gW(e,t,r,a){var n=tl(e),i=n.getUint32(4,!0),l=(a>1?12:8)+yy(i&(a>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(o=n.getUint32(l,!0),l+=4),l+=yy(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(l,!0),l+=4),i&32&&(u=n.getFloat64(l,!0),l+=8),i&64&&(d.setTime(d.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:u>0};break;case 7:m={t:"n",v:u/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else if(c>-1)m={t:"s",v:t[c]};else if(!isNaN(u))m={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function vW(e,t,r){var a=tl(e),n=a.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=hW(e,i),i+=16),n&2&&(u=a.getFloat64(i,!0),i+=8),n&4&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(l=a.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:c};break;case 3:m={t:"s",v:t[o]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:u>0};break;case 7:m={t:"n",v:u/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return m}function ff(e,t){var r=new Uint8Array(32),a=tl(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,pW(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function hf(e,t){var r=new Uint8Array(32),a=tl(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function bW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return gW(e,t,r,e[0]);case 5:return vW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ks(e){var t=Zt(e);return dc(t[1][0].data)}function jy(e,t){var r=Zt(t.data),a=Mr(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(l){var o=Zt(l.data),c=Mr(o[1][0].data)>>>0;switch(a){case 1:i[c]=Kp(o[3][0].data);break;case 8:{var u=e[ks(o[9][0].data)][0],d=Zt(u.data),m=e[ks(d[1][0].data)][0],f=Mr(m.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var x=Zt(m.data);i[c]=x[3].map(function(p){return Kp(p.data)}).join("")}break}}),i}function yW(e,t){var r,a,n,i,l,o,c,u,d,m,f,x,p,h,g=Zt(e),b=Mr(g[1][0].data)>>>0,j=Mr(g[2][0].data)>>>0,y=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&Mr(g[8][0].data)>0||!1,w,N;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&t!=0)w=(o=(l=g[7])==null?void 0:l[0])==null?void 0:o.data,N=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((m=(d=g[4])==null?void 0:d[0])!=null&&m.data&&t!=1)w=(x=(f=g[4])==null?void 0:f[0])==null?void 0:x.data,N=(h=(p=g[3])==null?void 0:p[0])==null?void 0:h.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=y?4:1,E=tl(w),_=[],T=0;T<w.length/2;++T){var C=E.getUint16(T*2,!0);C<65535&&_.push([T,C])}if(_.length!=j)throw"Expected ".concat(j," cells, found ").concat(_.length);var A=[];for(T=0;T<_.length-1;++T)A[_[T][0]]=N.subarray(_[T][1]*S,_[T+1][1]*S);return _.length>=1&&(A[_[_.length-1][0]]=N.subarray(_[_.length-1][1]*S)),{R:b,cells:A}}function jW(e,t){var r,a=Zt(t.data),n=(r=a?.[7])!=null&&r[0]?Mr(a[7][0].data)>>>0>0?1:0:-1,i=Pg(a[5],function(l){return yW(l,n)});return{nrows:Mr(a[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,u){if(l[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));l[o.R][u]=c}),l},[])}}function wW(e,t,r){var a,n=Zt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Mr(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Mr(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Nt(i);var l=Zt(n[4][0].data),o=jy(e,e[ks(l[4][0].data)][0]),c=(a=l[17])!=null&&a[0]?jy(e,e[ks(l[17][0].data)][0]):[],u=Zt(l[3][0].data),d=0;u[1].forEach(function(m){var f=Zt(m.data),x=e[ks(f[2][0].data)][0],p=Mr(x.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var h=jW(e,x);h.data.forEach(function(g,b){g.forEach(function(j,y){var w=mt({r:d+b,c:y}),N=bW(j,o,c);N&&(r[w]=N)})}),d+=h.nrows})}function NW(e,t){var r=Zt(t.data),a={"!ref":"A1"},n=e[ks(r[2][0].data)],i=Mr(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return wW(e,n[0],a),a}function SW(e,t){var r,a=Zt(t.data),n={name:(r=a[1])!=null&&r[0]?Kp(a[1][0].data):"",sheets:[]},i=Pg(a[2],ks);return i.forEach(function(l){e[l].forEach(function(o){var c=Mr(o.meta[1][0].data);c==6e3&&n.sheets.push(NW(e,o))})}),n}function EW(e,t){var r=zg(),a=Zt(t.data),n=Pg(a[1],ks);if(n.forEach(function(i){e[i].forEach(function(l){var o=Mr(l.meta[1][0].data);if(o==2){var c=SW(e,l);c.sheets.forEach(function(u,d){Ug(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function pf(e){var t,r,a,n,i={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Ea(c.content)}catch(m){return console.log("?? "+c.content.length+" "+(m.message||m))}var d;try{d=Sa(u)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){i[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var o=((n=(a=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Mr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(c){i[c].forEach(function(u){var d=Mr(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return EW(i,o)}function TW(e,t,r){var a,n,i,l;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&Mr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=tl(e[7][0].data),d=0,m=[],f=tl(e[4][0].data),x=0,p=[],h=0;h<t.length;++h){if(t[h]==null){u.setUint16(h*2,65535,!0),f.setUint16(h*2,65535);continue}u.setUint16(h*2,d,!0),f.setUint16(h*2,x,!0);var g,b;switch(typeof t[h]){case"string":g=ff({t:"s",v:t[h]},r),b=hf({t:"s",v:t[h]},r);break;case"number":g=ff({t:"n",v:t[h]},r),b=hf({t:"n",v:t[h]},r);break;case"boolean":g=ff({t:"b",v:t[h]},r),b=hf({t:"b",v:t[h]},r);break;default:throw new Error("Unsupported value "+t[h])}m.push(g),d+=g.length,p.push(b),x+=b.length,++c}for(e[2][0].data=nr(c);h<e[7][0].data.length/2;++h)u.setUint16(h*2,65535,!0),f.setUint16(h*2,65535,!0);return e[6][0].data=di(m),e[3][0].data=di(p),c}function AW(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=sa(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Nt(a)));var i=du(r,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(Y){return Y.forEach(function(z){typeof z=="string"&&l.push(z)})});var o={},c=[],u=it.read(t.numbers,{type:"base64"});u.FileIndex.map(function(Y,z){return[Y,u.FullPaths[z]]}).forEach(function(Y){var z=Y[0],k=Y[1];if(z.type==2&&z.name.match(/\.iwa/)){var O=z.content,G=Ea(O),Z=Sa(G);Z.forEach(function(ee){c.push(ee.id),o[ee.id]={deps:[],location:k,type:Mr(ee.messages[0].meta[1][0].data)}})}}),c.sort(function(Y,z){return Y-z});var d=c.filter(function(Y){return Y>1}).map(function(Y){return[Y,nr(Y)]});u.FileIndex.map(function(Y,z){return[Y,u.FullPaths[z]]}).forEach(function(Y){var z=Y[0];if(Y[1],!!z.name.match(/\.iwa/)){var k=Sa(Ea(z.content));k.forEach(function(O){O.messages.forEach(function(G){d.forEach(function(Z){O.messages.some(function(ee){return Mr(ee.meta[1][0].data)!=11006&&fW(ee.data,Z[1])})&&o[Z[0]].deps.push(O.id)})})})}});for(var m=it.find(u,o[1].location),f=Sa(Ea(m.content)),x,p=0;p<f.length;++p){var h=f[p];h.id==1&&(x=h)}var g=ks(Zt(x.messages[0].data)[1][0].data);for(m=it.find(u,o[g].location),f=Sa(Ea(m.content)),p=0;p<f.length;++p)h=f[p],h.id==g&&(x=h);for(g=ks(Zt(x.messages[0].data)[2][0].data),m=it.find(u,o[g].location),f=Sa(Ea(m.content)),p=0;p<f.length;++p)h=f[p],h.id==g&&(x=h);for(g=ks(Zt(x.messages[0].data)[2][0].data),m=it.find(u,o[g].location),f=Sa(Ea(m.content)),p=0;p<f.length;++p)h=f[p],h.id==g&&(x=h);var b=Zt(x.messages[0].data);{b[6][0].data=nr(a.e.r+1),b[7][0].data=nr(a.e.c+1);var j=ks(b[46][0].data),y=it.find(u,o[j].location),w=Sa(Ea(y.content));{for(var N=0;N<w.length&&w[N].id!=j;++N);if(w[N].id!=j)throw"Bad ColumnRowUIDMapArchive";var S=Zt(w[N].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var E=0;E<=a.e.c;++E){var _=[];_[1]=_[2]=[{type:0,data:nr(E+420690)}],S[1].push({type:2,data:bs(_)}),S[2].push({type:0,data:nr(E)}),S[3].push({type:0,data:nr(E)})}S[4]=[],S[5]=[],S[6]=[];for(var T=0;T<=a.e.r;++T)_=[],_[1]=_[2]=[{type:0,data:nr(T+726270)}],S[4].push({type:2,data:bs(_)}),S[5].push({type:0,data:nr(T)}),S[6].push({type:0,data:nr(T)});w[N].messages[0].data=bs(S)}y.content=Nl(wl(w)),y.size=y.content.length,delete b[46];var C=Zt(b[4][0].data);{C[7][0].data=nr(a.e.r+1);var A=Zt(C[1][0].data),D=ks(A[2][0].data);y=it.find(u,o[D].location),w=Sa(Ea(y.content));{if(w[0].id!=D)throw"Bad HeaderStorageBucket";var P=Zt(w[0].messages[0].data);for(T=0;T<i.length;++T){var R=Zt(P[2][0].data);R[1][0].data=nr(T),R[4][0].data=nr(i[T].length),P[2][T]={type:P[2][0].type,data:bs(R)}}w[0].messages[0].data=bs(P)}y.content=Nl(wl(w)),y.size=y.content.length;var M=ks(C[2][0].data);y=it.find(u,o[M].location),w=Sa(Ea(y.content));{if(w[0].id!=M)throw"Bad HeaderStorageBucket";for(P=Zt(w[0].messages[0].data),E=0;E<=a.e.c;++E)R=Zt(P[2][0].data),R[1][0].data=nr(E),R[4][0].data=nr(a.e.r+1),P[2][E]={type:P[2][0].type,data:bs(R)};w[0].messages[0].data=bs(P)}y.content=Nl(wl(w)),y.size=y.content.length;var X=ks(C[4][0].data);(function(){for(var Y=it.find(u,o[X].location),z=Sa(Ea(Y.content)),k,O=0;O<z.length;++O){var G=z[O];G.id==X&&(k=G)}var Z=Zt(k.messages[0].data);{Z[3]=[];var ee=[];l.forEach(function(B,Se){ee[1]=[{type:0,data:nr(Se)}],ee[2]=[{type:0,data:nr(1)}],ee[3]=[{type:2,data:mW(B)}],Z[3].push({type:2,data:bs(ee)})})}k.messages[0].data=bs(Z);var de=wl(z),Ee=Nl(de);Y.content=Ee,Y.size=Y.content.length})();var ie=Zt(C[3][0].data);{var ae=ie[1][0];delete ie[2];var V=Zt(ae.data);{var me=ks(V[2][0].data);(function(){for(var Y=it.find(u,o[me].location),z=Sa(Ea(Y.content)),k,O=0;O<z.length;++O){var G=z[O];G.id==me&&(k=G)}var Z=Zt(k.messages[0].data);{delete Z[6],delete ie[7];var ee=new Uint8Array(Z[5][0].data);Z[5]=[];for(var de=0,Ee=0;Ee<=a.e.r;++Ee){var B=Zt(ee);de+=TW(B,i[Ee],l),B[1][0].data=nr(Ee),Z[5].push({data:bs(B),type:2})}Z[1]=[{type:0,data:nr(a.e.c+1)}],Z[2]=[{type:0,data:nr(a.e.r+1)}],Z[3]=[{type:0,data:nr(de)}],Z[4]=[{type:0,data:nr(a.e.r+1)}]}k.messages[0].data=bs(Z);var Se=wl(z),Re=Nl(Se);Y.content=Re,Y.size=Y.content.length})()}ae.data=bs(V)}C[3][0].data=bs(ie)}b[4][0].data=bs(C)}x.messages[0].data=bs(b);var ue=wl(f),F=Nl(ue);return m.content=F,m.size=m.content.length,u}function YT(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Rg(e){YT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Lg(e){YT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function CW(e){return Ot.WS.indexOf(e)>-1?"sheet":e==Ot.CS?"chart":e==Ot.DS?"dialog":e==Ot.MS?"macro":e&&e.length?e:"sheet"}function _W(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,CW(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function kW(e,t,r,a,n,i,l,o,c,u,d,m){try{i[a]=Uo(ua(e,r,!0),t);var f=qr(e,t),x;switch(o){case"sheet":x=ZU(f,t,n,c,i[a],u,d,m);break;case"chart":if(x=QU(f,t,n,c,i[a],u,d,m),!x||!x["!drawel"])break;var p=Po(x["!drawel"].Target,t),h=ac(p),g=B7(ua(e,p,!0),Uo(ua(e,h,!0),p)),b=Po(g,p),j=ac(b);x=TU(ua(e,b,!0),b,c,Uo(ua(e,j,!0),b),u,x);break;case"macro":x=e$(f,t,n,c,i[a],u,d,m);break;case"dialog":x=t$(f,t,n,c,i[a],u,d,m);break;default:throw new Error("Unrecognized sheet type "+o)}l[a]=x;var y=[];i&&i[a]&&Br(i[a]).forEach(function(w){var N="";if(i[a][w].Type==Ot.CMNT){N=Po(i[a][w].Target,t);var S=n$(qr(e,N,!0),N,c);if(!S||!S.length)return;iy(x,S,!1)}i[a][w].Type==Ot.TCMNT&&(N=Po(i[a][w].Target,t),y=y.concat(U7(qr(e,N,!0),c)))}),y&&y.length&&iy(x,y,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function ba(e){return e.charAt(0)=="/"?e.slice(1):e}function DW(e,t){if(so(),t=t||{},Rg(t),Ca(e,"META-INF/manifest.xml")||Ca(e,"objectdata.xml"))return gy(e,t);if(Ca(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof pf<"u"){if(e.FileIndex)return pf(e);var r=it.utils.cfb_new();return Ab(e).forEach(function(R){Tt(r,R,$R(e,R))}),pf(r)}throw new Error("Unsupported NUMBERS file")}if(!Ca(e,"[Content_Types].xml"))throw Ca(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ca(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Ab(e),n=R8(ua(e,"[Content_Types].xml")),i=!1,l,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",qr(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!qr(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if($o=[],n.sst)try{$o=a$(qr(e,ba(n.sst)),n.sst,t)}catch(R){if(t.WTF)throw R}t.cellStyles&&n.themes.length&&(c=s$(ua(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=r$(qr(e,ba(n.style)),n.style,c,t))}n.links.map(function(R){try{var M=Uo(ua(e,ac(ba(R))),R);return l$(qr(e,ba(R)),M,R,t)}catch{}});var d=JU(qr(e,ba(n.workbooks[0])),n.workbooks[0],t),m={},f="";n.coreprops.length&&(f=qr(e,ba(n.coreprops[0]),!0),f&&(m=FE(f)),n.extprops.length!==0&&(f=qr(e,ba(n.extprops[0]),!0),f&&$8(f,m,t)));var x={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(f=ua(e,ba(n.custprops[0]),!0),f&&(x=H8(f,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(M){return M.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),t.bookProps&&(p.Props=m,p.Custprops=x),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var h={};t.bookDeps&&n.calcchain&&(h=i$(qr(e,ba(n.calcchain)),n.calcchain));var g=0,b={},j,y;{var w=d.Sheets;m.Worksheets=w.length,m.SheetNames=[];for(var N=0;N!=w.length;++N)m.SheetNames[N]=w[N].name}var S=i?"bin":"xml",E=n.workbooks[0].lastIndexOf("/"),_=(n.workbooks[0].slice(0,E+1)+"_rels/"+n.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Ca(e,_)||(_="xl/_rels/workbook."+S+".rels");var T=Uo(ua(e,_,!0),_.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=o$(qr(e,ba(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=W7(qr(e,ba(n.people[0])),t)),T&&(T=_W(T,d.Sheets));var C=qr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=m.Worksheets;++g){var A="sheet";if(T&&T[g]?(j="xl/"+T[g][1].replace(/[\/]?xl\//,""),Ca(e,j)||(j=T[g][1]),Ca(e,j)||(j=_.replace(/_rels\/.*$/,"")+T[g][1]),A=T[g][2]):(j="xl/worksheets/sheet"+(g+1-C)+"."+S,j=j.replace(/sheet0\./,"sheet.")),y=j.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(m.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,P=0;P!=t.sheets.length;++P)typeof t.sheets[P]=="number"&&t.sheets[P]==g&&(D=1),typeof t.sheets[P]=="string"&&t.sheets[P].toLowerCase()==m.SheetNames[g].toLowerCase()&&(D=1);if(!D)continue e}}kW(e,j,y,m.SheetNames[g],g,b,l,A,t,d,c,u)}return p={Directory:n,Workbook:d,Props:m,Custprops:x,Deps:h,Sheets:l,SheetNames:m.SheetNames,Strings:$o,Styles:u,Themes:c,SSF:wr(ut)},t&&t.bookFiles&&(e.files?(p.keys=a,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(R,M){R=R.replace(/^Root Entry[\/]/,""),p.keys.push(R),p.files[R]=e.FileIndex[M]}))),t&&t.bookVBA&&(n.vba.length>0?p.vbaraw=qr(e,ba(n.vba[0]),!0):n.defaults&&n.defaults.bin===J7&&(p.vbaraw=qr(e,"xl/vbaProject.bin",!0))),p}function IW(e,t){var r=t||{},a="Workbook",n=it.find(e,a);try{if(a="/!DataSpaces/Version",n=it.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(oM(n.content),a="/!DataSpaces/DataSpaceMap",n=it.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=dM(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=it.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=uM(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=it.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);fM(n.content)}catch{}if(a="/EncryptionInfo",n=it.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=hM(n.content);if(a="/EncryptedPackage",n=it.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function OW(e,t){return t.bookType=="ods"?KT(e,t):t.bookType=="numbers"?AW(e,t):t.bookType=="xlsb"?PW(e,t):RW(e,t)}function PW(e,t){Al=1024,e&&!e.SSF&&(e.SSF=wr(ut)),e&&e.SSF&&(so(),om(e.SSF),t.revssf=dm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Wo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=wT.indexOf(t.bookType)>-1,n=jg();Lg(t=t||{});var i=lg(),l="",o=0;if(t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Tt(i,l,ME(e.Props,t)),n.coreprops.push(l),ir(t.rels,2,l,Ot.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Tt(i,l,UE(e.Props)),n.extprops.push(l),ir(t.rels,3,l,Ot.EXT_PROPS),e.Custprops!==e.Props&&Br(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(i,l,$E(e.Custprops)),n.custprops.push(l),ir(t.rels,4,l,Ot.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Tt(i,l,d$(o-1,l,t,e,d)),n.sheets.push(l),ir(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ot.WS[0])}if(m){var x=m["!comments"],p=!1,h="";x&&x.length>0&&(h="xl/comments"+o+"."+r,Tt(i,h,f$(x,h)),n.comments.push(h),ir(d,-1,"../comments"+o+"."+r,Ot.CMNT),p=!0),m["!legacy"]&&p&&Tt(i,"xl/drawings/vmlDrawing"+o+".vml",yT(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&Tt(i,ac(l),kl(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Tt(i,l,m$(t.Strings,l,t)),n.strs.push(l),ir(t.wbrels,-1,"sharedStrings."+r,Ot.SST)),l="xl/workbook."+r,Tt(i,l,c$(e,l)),n.workbooks.push(l),ir(t.rels,1,l,Ot.WB),l="xl/theme/theme1.xml",Tt(i,l,Ag(e.Themes,t)),n.themes.push(l),ir(t.wbrels,-1,"theme/theme1.xml",Ot.THEME),l="xl/styles."+r,Tt(i,l,u$(e,l,t)),n.styles.push(l),ir(t.wbrels,-1,"styles."+r,Ot.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",Tt(i,l,e.vbaraw),n.vba.push(l),ir(t.wbrels,-1,"vbaProject.bin",Ot.VBA)),l="xl/metadata."+r,Tt(i,l,h$(l)),n.metadata.push(l),ir(t.wbrels,-1,"metadata."+r,Ot.XLMETA),Tt(i,"[Content_Types].xml",RE(n,t)),Tt(i,"_rels/.rels",kl(t.rels)),Tt(i,"xl/_rels/workbook."+r+".rels",kl(t.wbrels)),delete t.revssf,delete t.ssf,i}function RW(e,t){Al=1024,e&&!e.SSF&&(e.SSF=wr(ut)),e&&e.SSF&&(so(),om(e.SSF),t.revssf=dm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Wo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=wT.indexOf(t.bookType)>-1,n=jg();Lg(t=t||{});var i=lg(),l="",o=0;if(t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Tt(i,l,ME(e.Props,t)),n.coreprops.push(l),ir(t.rels,2,l,Ot.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Tt(i,l,UE(e.Props)),n.extprops.push(l),ir(t.rels,3,l,Ot.EXT_PROPS),e.Custprops!==e.Props&&Br(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(i,l,$E(e.Custprops)),n.custprops.push(l),ir(t.rels,4,l,Ot.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],x=(f||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Tt(i,l,OT(o-1,t,e,m)),n.sheets.push(l),ir(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ot.WS[0])}if(f){var p=f["!comments"],h=!1,g="";if(p&&p.length>0){var b=!1;p.forEach(function(j){j[1].forEach(function(y){y.T==!0&&(b=!0)})}),b&&(g="xl/threadedComments/threadedComment"+o+"."+r,Tt(i,g,$7(p,d,t)),n.threadedcomments.push(g),ir(m,-1,"../threadedComments/threadedComment"+o+"."+r,Ot.TCMNT)),g="xl/comments"+o+"."+r,Tt(i,g,jT(p)),n.comments.push(g),ir(m,-1,"../comments"+o+"."+r,Ot.CMNT),h=!0}f["!legacy"]&&h&&Tt(i,"xl/drawings/vmlDrawing"+o+".vml",yT(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&Tt(i,ac(l),kl(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Tt(i,l,oT(t.Strings,t)),n.strs.push(l),ir(t.wbrels,-1,"sharedStrings."+r,Ot.SST)),l="xl/workbook."+r,Tt(i,l,MT(e)),n.workbooks.push(l),ir(t.rels,1,l,Ot.WB),l="xl/theme/theme1.xml",Tt(i,l,Ag(e.Themes,t)),n.themes.push(l),ir(t.wbrels,-1,"theme/theme1.xml",Ot.THEME),l="xl/styles."+r,Tt(i,l,xT(e,t)),n.styles.push(l),ir(t.wbrels,-1,"styles."+r,Ot.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",Tt(i,l,e.vbaraw),n.vba.push(l),ir(t.wbrels,-1,"vbaProject.bin",Ot.VBA)),l="xl/metadata."+r,Tt(i,l,bT()),n.metadata.push(l),ir(t.wbrels,-1,"metadata."+r,Ot.XLMETA),d.length>1&&(l="xl/persons/person.xml",Tt(i,l,H7(d)),n.people.push(l),ir(t.wbrels,-1,"persons/person.xml",Ot.PEOPLE)),Tt(i,"[Content_Types].xml",RE(n,t)),Tt(i,"_rels/.rels",kl(t.rels)),Tt(i,"xl/_rels/workbook."+r+".rels",kl(t.wbrels)),delete t.revssf,delete t.ssf,i}function Fg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ha(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function LW(e,t){return it.find(e,"EncryptedPackage")?IW(e,t):$T(e,t)}function FW(e,t){var r,a=e,n=t||{};return n.type||(n.type=Dt&&Buffer.isBuffer(e)?"buffer":"base64"),r=dE(a,n),DW(r,n)}function XT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Gp(e.slice(r),t);default:break e}return zl.to_workbook(e,t)}function MW(e,t){var r="",a=Fg(e,t);switch(t.type){case"base64":r=ha(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ji(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=dr(r)),t.type="binary",XT(r,t)}function BW(e,t){var r=e;return t.type=="base64"&&(r=ha(r)),r=Zo.utils.decode(1200,r.slice(2),"str"),t.type="binary",XT(r,t)}function zW(e){return e.match(/[^\x00-\x7F]/)?on(e):e}function xf(e,t,r,a){return a?(r.type="string",zl.to_workbook(e,r)):zl.to_workbook(t,r)}function uc(e,t){rg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return uc(new Uint8Array(e),(r=wr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Il={},r.dateNF&&(Il.dateNF=r.dateNF),r.type||(r.type=Dt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Dt?"buffer":"binary",a=PR(e),typeof Uint8Array<"u"&&!Dt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=zW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=wr(r),r.type="array",uc(sg(a),r)}switch((n=Fg(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return LW(it.read(a,r),r);break;case 9:if(n[1]<=8)return $T(a,r);break;case 60:return Gp(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return VF(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return iT.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?FW(a,r):xf(e,a,r,i);case 239:return n[3]===60?Gp(a,r):xf(e,a,r,i);case 255:if(n[1]===254)return BW(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return zi.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return zi.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Vp.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return fT.to_workbook(a,r);break;case 10:case 13:case 32:return MW(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return HF.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Vp.to_workbook(a,r):xf(e,a,r,i)}function JT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ic(t.file,it.write(e,{type:Dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return it.write(e,t)}function UW(e,t){var r=wr(t||{}),a=OW(e,r);return $W(a,r)}function $W(e,t){var r={},a=Dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?it.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(lm(n))}return t.password&&typeof encrypt_agile<"u"?JT(encrypt_agile(n,t.password),t):t.type==="file"?Ic(t.file,n):t.type=="string"?dr(n):n}function WW(e,t){var r=t||{},a=z$(e,r);return JT(a,r)}function ln(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Qo(on(a));case"binary":return on(a);case"string":return e;case"file":return Ic(t.file,a,"utf8");case"buffer":return Dt?Fn(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ln(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function HW(e,t){switch(t.type){case"base64":return Qo(e);case"binary":return e;case"string":return e;case"file":return Ic(t.file,e,"binary");case"buffer":return Dt?Fn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Qo(r):t.type=="string"?dr(r):r;case"file":return Ic(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function ZT(e,t){rg(),LU(e);var r=wr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=ZT(e,r);return r.type="array",lm(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ln(O$(e,r),r);case"slk":case"sylk":return ln(nT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return ln(HT(e.Sheets[e.SheetNames[n]],r),r);case"txt":return HW(QT(e.Sheets[e.SheetNames[n]],r),r);case"csv":return ln(Bg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return ln(iT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return bd(Vp.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return ln(zl.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return ln(fT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return ln(lT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return ln(KT(e,r),r);case"wk1":return bd(zi.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return bd(zi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),bd(WT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),WW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return UW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function VW(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Mg(e,t,r){var a=r||{};return a.type="file",a.file=t,VW(a),ZT(e,a)}function GW(e,t,r,a,n,i,l,o){var c=Wr(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),m=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!l||e[r])for(var x=t.s.c;x<=t.e.c;++x){var p=l?e[r][x]:e[a[x]+c];if(p===void 0||p.t===void 0){if(u===void 0)continue;i[x]!=null&&(f[i[x]]=u);continue}var h=p.v;switch(p.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[x]!=null){if(h==null)if(p.t=="e"&&h===null)f[i[x]]=null;else if(u!==void 0)f[i[x]]=u;else if(d&&h===null)f[i[x]]=null;else continue;else f[i[x]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?h:Dn(p,h,o);h!=null&&(m=!1)}}return{row:f,isempty:m}}function du(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof d){case"string":c=Xt(d);break;case"number":c=Xt(e["!ref"]),c.s.r=d;break;default:c=d}a>0&&(n=0);var m=Wr(c.s.r),f=[],x=[],p=0,h=0,g=Array.isArray(e),b=c.s.r,j=0,y={};g&&!e[b]&&(e[b]=[]);var w=u.skipHidden&&e["!cols"]||[],N=u.skipHidden&&e["!rows"]||[];for(j=c.s.c;j<=c.e.c;++j)if(!(w[j]||{}).hidden)switch(f[j]=Ir(j),r=g?e[b][j]:e[f[j]+m],a){case 1:i[j]=j-c.s.c;break;case 2:i[j]=f[j];break;case 3:i[j]=u.header[j-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=Dn(r,null,u),h=y[l]||0,!h)y[l]=1;else{do o=l+"_"+h++;while(y[o]);y[l]=h,y[o]=1}i[j]=o}for(b=c.s.r+n;b<=c.e.r;++b)if(!(N[b]||{}).hidden){var S=GW(e,c,b,f,a,i,g,u);(S.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(x[p++]=S.row)}return x.length=p,x}var wy=/"/g;function qW(e,t,r,a,n,i,l,o){for(var c=!0,u=[],d="",m=Wr(r),f=t.s.c;f<=t.e.c;++f)if(a[f]){var x=o.dense?(e[r]||[])[f]:e[a[f]+m];if(x==null)d="";else if(x.v!=null){c=!1,d=""+(o.rawNumbers&&x.t=="n"?x.v:Dn(x,null,o));for(var p=0,h=0;p!==d.length;++p)if((h=d.charCodeAt(p))===n||h===i||h===34||o.forceQuotes){d='"'+d.replace(wy,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(c=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(wy,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(l)}function Bg(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Xt(e["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",m=[];a.dense=Array.isArray(e);for(var f=a.skipHidden&&e["!cols"]||[],x=a.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(f[p]||{}).hidden||(m[p]=Ir(p));for(var h=0,g=n.s.r;g<=n.e.r;++g)(x[g]||{}).hidden||(d=qW(e,n,g,m,l,c,i,a),d!=null&&(a.strip&&(d=d.replace(u,"")),(d||a.blankrows!==!1)&&r.push((h++?o:"")+d)));return delete a.dense,r.join("")}function QT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Bg(e,t);return r}function KW(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Xt(e["!ref"]),i="",l=[],o,c=[],u=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)l[o]=Ir(o);for(var d=n.s.r;d<=n.e.r;++d)for(i=Wr(d),o=n.s.c;o<=n.e.c;++o)if(t=l[o]+i,r=u?(e[d]||[])[o]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function eA(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},l=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var c=typeof a.origin=="string"?Or(a.origin):a.origin;l=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+n}};if(i["!ref"]){var m=Xt(i["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(l=m.e.r+1,d.e.r=l+t.length-1+n)}else l==-1&&(l=0,d.e.r=t.length-1+n);var f=a.header||[],x=0;t.forEach(function(h,g){Br(h).forEach(function(b){(x=f.indexOf(b))==-1&&(f[x=f.length]=b);var j=h[b],y="z",w="",N=mt({c:o+x,r:l+g+n});u=mc(i,N),j&&typeof j=="object"&&!(j instanceof Date)?i[N]=j:(typeof j=="number"?y="n":typeof j=="boolean"?y="b":typeof j=="string"?y="s":j instanceof Date?(y="d",a.cellDates||(y="n",j=ss(j)),w=a.dateNF||ut[14]):j===null&&a.nullError&&(y="e",j=0),u?(u.t=y,u.v=j,delete u.w,delete u.R,w&&(u.z=w)):i[N]=u={t:y,v:j},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,o+f.length-1);var p=Wr(l);if(n)for(x=0;x<f.length;++x)i[Ir(x+o)+p]={t:"s",v:f[x]};return i["!ref"]=Nt(d),i}function YW(e,t){return eA(null,e,t)}function mc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Or(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?mc(e,mt(t)):mc(e,mt({r:t,c:r||0}))}function XW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function zg(){return{SheetNames:[],Sheets:{}}}function Ug(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var l=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=l+n)!=-1;++n);}if(FT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function JW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=XW(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function ZW(e,t){return e.z=t,e}function tA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function QW(e,t,r){return tA(e,"#"+t,r)}function eH(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function tH(e,t,r,a){for(var n=typeof t!="string"?t:Xt(t),i=typeof t=="string"?t:Nt(t),l=n.s.r;l<=n.e.r;++l)for(var o=n.s.c;o<=n.e.c;++o){var c=mc(e,l,o);c.t="n",c.F=i,delete c.v,l==n.s.r&&o==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var Oa={encode_col:Ir,encode_row:Wr,encode_cell:mt,encode_range:Nt,decode_col:pg,decode_row:hg,split_cell:m8,decode_cell:Or,decode_range:sa,format_cell:Dn,sheet_add_aoa:CE,sheet_add_json:eA,sheet_add_dom:VT,aoa_to_sheet:ao,json_to_sheet:YW,table_to_sheet:GT,table_to_book:oW,sheet_to_csv:Bg,sheet_to_txt:QT,sheet_to_json:du,sheet_to_html:HT,sheet_to_formulae:KW,sheet_to_row_object_array:du,sheet_get_cell:mc,book_new:zg,book_append_sheet:Ug,book_set_sheet_visibility:JW,cell_set_number_format:ZW,cell_set_hyperlink:tA,cell_set_internal_link:QW,cell_add_comment:eH,sheet_set_array_formula:tH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const rH=({show:e,onClose:t,onImport:r,loading:a=!1})=>{const[n,i]=v.useState(!1),[l,o]=v.useState(null),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,x]=v.useState([]),[p,h]=v.useState([]),[g,b]=v.useState(!1),j=v.useRef(null),y=["first_name","last_name","email","role"],w=["first_name","middle_name","last_name","address","email","phone_number","avatar_url","gender","role","department","certification_number","specialization","years_of_experience","bio","date_of_birth","enrollment_date","training_batch","passport_no","nation"];v.useEffect(()=>{e&&N()},[e]);const N=async()=>{try{b(!0);const F=await roleAPI.getPublicRoles();console.log(" Roles fetched from public API:",{rolesCount:F.length,roles:F.map(Y=>({id:Y.id,name:Y.name}))}),h(F)}catch(F){console.error("Failed to fetch roles:",F),m(["Failed to load roles. Please refresh the page."]),h([])}finally{b(!1)}},S=F=>{if(!F)return"";try{return decodeURIComponent(escape(F)).trim()}catch{return F.toString().trim()}},E=F=>{if(!F)return"";try{let Y;if(F instanceof Date)Y=F;else{const k=F.toString().trim();if(!k||k===""||k==="null"||k==="undefined")return"";if(k.includes("/")){const O=k.split("/");O.length===3&&(Y=new Date(O[2],O[0]-1,O[1]))}else if(k.includes("-")){const O=k.split("-");O.length===3&&(O[0].length===4?Y=new Date(O[0],O[1]-1,O[2]):Y=new Date(O[2],O[1]-1,O[0]))}else Y=new Date(k)}if(isNaN(Y.getTime()))return"";const z=Y.getFullYear();return z<1900||z>2100?"":Y.toISOString()}catch(Y){return console.error("Error formatting date:",Y,"Input:",F),""}},_=F=>{if(!F)return"MALE";const Y=F.toString().toUpperCase().trim();return Y==="MALE"||Y==="FEMALE"?Y:{M:"MALE",F:"FEMALE"}[Y]||"MALE"},T=F=>{if(!F)return null;const Y=F.toString().toUpperCase().trim();return["MALE","FEMALE","M","F"].includes(Y)?null:"Invalid gender value. Accepted values: MALE, FEMALE, M, F"},C=F=>F?F.toString().toUpperCase().trim().replace(/\s+/g,"_"):"",A=F=>{if(!F||!p.length)return console.warn(" findRoleId: No roleName or roles not loaded",{roleName:F,rolesCount:p.length}),null;const Y=C(F);console.log(" Finding role:",{input:F,normalized:Y,availableRoles:p.map(Z=>({name:Z.name,normalized:C(Z.name),id:Z.id}))});const z=p.find(Z=>{const ee=C(Z.name),de=ee===Y;return de&&console.log(" Direct match:",{input:F,inputNormalized:Y,dbRole:Z.name,dbRoleNormalized:ee,match:de}),de});if(z)return console.log(" Direct match found:",z.name,z.id),z.id;console.log(" Direct match failed, checking normalization..."),p.forEach(Z=>{const ee=C(Z.name);ee===Y&&console.log(" Found potential match:",{input:F,inputNormalized:Y,dbRole:Z.name,dbRoleNormalized:ee,match:ee===Y})});const O={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE"}[Y];if(O){const Z=p.find(ee=>C(ee.name)===O);if(Z)return console.log(" Partial match found:",Z.name,Z.id),Z.id}const G=p.find(Z=>{const ee=C(Z.name),de=ee.includes(Y)||Y.includes(ee);return de&&console.log(" Fuzzy match candidate:",{input:F,inputNormalized:Y,dbRole:Z.name,dbRoleNormalized:ee}),de});return G?(console.log(" Fuzzy match found:",G.name,G.id),G.id):(console.warn(" No role match found for:",{input:F,normalized:Y,availableRoles:p.map(Z=>({name:Z.name,normalized:C(Z.name)}))}),null)},D=F=>{if(!F||!p.length)return null;const Y=C(F),z=p.find(Z=>C(Z.name)===Y);if(z)return z.name;const O={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPARTMENT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT","ACADEMIC DEPARTMENT":"ACADEMIC_DEPARTMENT"}[Y];if(O){const Z=p.find(ee=>C(ee.name)===O);if(Z)return Z.name}const G=p.find(Z=>{const ee=C(Z.name);return ee.includes(Y)||Y.includes(ee)});return G?G.name:null},P=()=>{const F=[w,["Trn","Th","Hoa","456 L Vn S, Qun 3, TP.HCM","tran.thi.hoa.trainer@example.com","+84 912 345 678","","FEMALE","TRAINER","","CERT555","Cabin Safety","7","Hun luyn vin Cabin Safety vi 7 nm kinh nghim quc t","1988-06-21","","","B987654321","Vietnam"]],Y=Oa.aoa_to_sheet(F),z=Oa.book_new();Oa.book_append_sheet(z,Y,"Users"),Mg(z,"User_Upload_Template.xlsx",{bookType:"xlsx",type:"binary"})},R=F=>{F.preventDefault(),F.stopPropagation(),F.type==="dragenter"||F.type==="dragover"?i(!0):F.type==="dragleave"&&i(!1)},M=F=>{F.preventDefault(),F.stopPropagation(),i(!1),F.dataTransfer.files&&F.dataTransfer.files[0]&&ie(F.dataTransfer.files[0])},X=F=>{F.target.files&&F.target.files[0]&&ie(F.target.files[0])},ie=F=>{if(!F.name.match(/\.(xlsx|xls)$/)){m(["Please upload an Excel file (.xlsx or .xls)"]);return}if(F.size>100*1024*1024){m(["File size must be less than 100MB"]);return}if(o(F),m([]),x([]),u([]),g){x(["Roles are still loading. Please wait a moment and try again."]);return}if(p.length===0){x(["Roles are not loaded yet. Please refresh the page and try again."]);return}console.log(" Processing file with roles loaded:",{rolesCount:p.length,roles:p.map(z=>z.name)});const Y=new FileReader;Y.onload=z=>{try{const k=new Uint8Array(z.target.result),O=uc(k,{type:"array",cellText:!1,cellDates:!0,raw:!1}),G=O.SheetNames[0],Z=O.Sheets[G],ee=Oa.sheet_to_json(Z,{header:1,defval:"",raw:!1});if(ee.length<2){m(["File must contain at least a header row and one data row"]);return}const de=ee[0].map(Pe=>Pe?Pe.toString().trim().toLowerCase().replace(/\s+/g,"_"):""),Ee=ee.slice(1),B={first_name:"first_name",firstname:"first_name","first name":"first_name",middle_name:"middle_name",middlename:"middle_name","middle name":"middle_name",last_name:"last_name",lastname:"last_name","last name":"last_name",full_name:"full_name",fullname:"full_name","full name":"full_name",name:"full_name",address:"address",email:"email",phone_number:"phone_number",phonenumber:"phone_number","phone number":"phone_number",phone:"phone_number",role:"role",department:"department",dept:"department",dept_id:"department",department_id:"department",certification_number:"certification_number",certificationnumber:"certification_number","certification number":"certification_number",certification:"certification_number",specialization:"specialization",years_of_experience:"years_of_experience",yearsofexperience:"years_of_experience","years of experience":"years_of_experience",experience:"years_of_experience",date_of_birth:"date_of_birth",dateofbirth:"date_of_birth","date of birth":"date_of_birth",dob:"date_of_birth",training_batch:"training_batch",trainingbatch:"training_batch","training batch":"training_batch",batch:"training_batch",passport_no:"passport_no",passportno:"passport_no","passport no":"passport_no",passport:"passport_no",nation:"nation",nationality:"nation",country:"nation",gender:"gender",sex:"gender"},Re=de.map(Pe=>B[Pe]||Pe).filter(Pe=>w.includes(Pe)),He=y.filter(Pe=>!Re.includes(Pe));if(He.length>0){x([`Your file is missing these essential data to create a user: ${He.join(", ")}`]);return}p.length===0&&(console.warn(" Roles not loaded yet, validation may fail"),x([" Roles are still loading. Role validation may fail. Please wait and try again if you see role errors."]));const st=Ee.map((Pe,Gt)=>{const yt={};let Pt=!1;const qt=[];de.forEach((Ue,De)=>{const lt=B[Ue]||Ue;if(w.includes(lt)){let Ut="";Pe[De]!==null&&Pe[De]!==void 0&&(typeof Pe[De]=="string"?Ut=S(Pe[De]):typeof Pe[De]=="number"?Ut=Pe[De].toString():Ut=S(Pe[De].toString())),lt==="gender"&&(Ut=_(Ut)),yt[lt]=Ut}}),Re.forEach(Ue=>{const De=yt[Ue]||"";if(y.includes(Ue)&&!De&&(Pt=!0,qt.push("Required field missing")),Ue==="email"&&De&&!/\S+@\S+\.\S+/.test(De)&&(Pt=!0,qt.push("Invalid email")),Ue==="role"&&De)if(p.length>0){const lt=A(De);if(lt)console.log(" Role validated successfully:",De,"",lt);else{Pt=!0;const Ut=C(De),rr=p.map(ct=>({original:ct.name,normalized:C(ct.name)}));console.error(" Role validation failed:",{input:De,normalizedInput:Ut,availableRoles:p.map(ct=>ct.name),availableNormalized:rr}),qt.push(`Invalid role: "${De}". Available roles: ${p.map(ct=>ct.name).join(", ")}`)}}else console.warn(" Roles not loaded, cannot validate role:",De);if(Ue==="phone_number"&&De&&De.length>15&&(Pt=!0,qt.push("Phone number too long (max 15 characters)")),Ue==="years_of_experience"&&De&&isNaN(De)&&(Pt=!0,qt.push("Invalid experience value")),Ue==="gender"&&De){const lt=T(De);lt&&(Pt=!0,qt.push(lt))}});const Ie=D(yt.role);return Ie==="TRAINER"?((!yt.specialization||yt.specialization.trim()==="")&&(Pt=!0,qt.push("Trainer requires specialization")),(!yt.years_of_experience||yt.years_of_experience.trim()==="")&&(Pt=!0,qt.push("Trainer requires years of experience")),yt.department&&yt.department.trim()!==""&&yt.department.trim()!=="-"&&(Pt=!0,qt.push("Department is not allowed for Trainer role"))):Ie==="TRAINEE"&&(!yt.date_of_birth||yt.date_of_birth.trim()===""?(Pt=!0,qt.push("Trainee requires date of birth")):E(yt.date_of_birth)||(Pt=!0,qt.push(`Invalid date format for date of birth: "${yt.date_of_birth}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)),(!yt.training_batch||yt.training_batch.trim()==="")&&(Pt=!0,qt.push("Trainee requires training batch")),(!yt.passport_no||yt.passport_no.trim()==="")&&(Pt=!0,qt.push("Trainee requires passport number")),(!yt.nation||yt.nation.trim()==="")&&(Pt=!0,qt.push("Trainee requires nation")),yt.enrollment_date&&yt.enrollment_date.trim()!==""&&(E(yt.enrollment_date)||(Pt=!0,qt.push(`Invalid date format for enrollment date: "${yt.enrollment_date}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)))),{id:Gt+1,...yt,hasError:Pt,errors:qt,status:Pt?"error":"valid"}});u(st)}catch{m(["Error reading file. Please make sure it's a valid Excel file."])}},Y.readAsArrayBuffer(F)},ae=async()=>{const F=c.filter(z=>!z.hasError);if(F.length===0){m(["No valid users to import"]);return}if(!p.length){m(["Roles not loaded. Please wait and try again."]);return}const Y=F.map(z=>{const k=z.phone_number?z.phone_number.substring(0,15):"",O=A(z.role),G=D(z.role);if(!O||!G)throw new Error(`Role "${z.role}" not found in system`);const Z={firstName:z.first_name||"",middleName:z.middle_name||"",lastName:z.last_name||"",address:z.address||"",email:z.email||"",phoneNumber:k,avatarUrl:z.avatar_url||"",gender:_(z.gender),role:{id:O,name:G}};if(G==="DEPARTMENT_HEAD"?z.department&&z.department.trim()!==""&&z.department.trim()!=="-"?Z.departmentId=z.department:Z.departmentId=null:G!=="TRAINER"&&z.department&&z.department.trim()!==""&&z.department.trim()!=="-"&&(Z.departmentId=z.department),G==="TRAINER")Z.trainerProfile={specialization:z.specialization||"",yearsOfExp:z.years_of_experience?parseInt(z.years_of_experience):0,certificationNumber:z.certification_number||"",bio:z.bio||""};else if(G==="TRAINEE"){const ee={trainingBatch:z.training_batch||"",passportNo:z.passport_no||"",nation:z.nation||""},de=E(z.date_of_birth);de&&(ee.dob=de);const Ee=E(z.enrollment_date);Ee?ee.enrollmentDate=Ee:ee.enrollmentDate=new Date().toISOString(),Z.traineeProfile=ee}return Z});try{await r(Y),V()}catch(z){m([z.message||"Failed to import users. Please try again."])}},V=()=>{o(null),u([]),m([]),x([]),i(!1),t()},me=F=>{u(Y=>Y.filter(z=>z.id!==F))},ue=F=>F==="valid"?s.jsx(Je,{className:"text-success",size:16}):s.jsx(fs,{className:"text-danger",size:16});return s.jsxs(le,{show:e,onHide:V,size:"xl",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Ts,{className:"me-2",size:20}),"Bulk Import Users"]}),s.jsx(se,{variant:"link",onClick:V,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[g&&s.jsxs("div",{className:"text-center mb-3",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",style:{width:"1.5rem",height:"1.5rem",borderWidth:"0.2em"},children:s.jsx("span",{className:"visually-hidden",children:"Loading roles..."})}),s.jsx("span",{className:"ms-2 text-muted",children:"Loading roles..."})]}),s.jsx(H,{className:"mb-4",children:s.jsxs(H.Body,{children:[s.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:R,onDragLeave:R,onDragOver:R,onDrop:M,onClick:()=>j.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Rl,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:j,type:"file",accept:".xlsx,.xls",onChange:X,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[l&&s.jsxs("p",{className:"text-success mb-1",children:[s.jsx("strong",{children:"Uploaded file:"})," ",l.name]}),s.jsx("p",{className:"text-muted mb-0",children:"Up to 100 records per upload."}),s.jsxs("small",{className:"text-info d-block mt-1",children:[s.jsx("strong",{children:"Gender format:"})," M/F or MALE/FEMALE"]})]}),s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:P,className:"d-flex align-items-center",children:[s.jsx(Ln,{className:"me-1",size:14}),"Download Template"]})]})]})}),d.length>0&&s.jsx("div",{className:"alert alert-danger mb-3",children:s.jsx("ul",{className:"mb-0",children:d.map((F,Y)=>s.jsx("li",{children:F},Y))})}),f.length>0&&s.jsx(ke,{variant:"warning",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:f.map((F,Y)=>s.jsx("li",{children:F},Y))})}),c.length>0&&s.jsxs(H,{children:[s.jsx(H.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),s.jsx(H.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(Yt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"120px"},children:"FIRST NAME"}),s.jsx("th",{style:{minWidth:"120px"},children:"MIDDLE NAME"}),s.jsx("th",{style:{minWidth:"120px"},children:"LAST NAME"}),s.jsx("th",{style:{minWidth:"200px"},children:"EMAIL"}),s.jsx("th",{style:{minWidth:"120px"},children:"ROLE"}),s.jsx("th",{style:{minWidth:"100px"},children:"DEPARTMENT"}),s.jsx("th",{style:{minWidth:"150px"},children:"PHONE NUMBER"}),s.jsx("th",{style:{minWidth:"100px"},children:"GENDER"}),s.jsx("th",{style:{minWidth:"150px"},children:"CERTIFICATION"}),s.jsx("th",{style:{minWidth:"150px"},children:"SPECIALIZATION"}),s.jsx("th",{style:{minWidth:"100px"},children:"EXPERIENCE"}),s.jsx("th",{style:{minWidth:"120px"},children:"DATE OF BIRTH"}),s.jsx("th",{style:{minWidth:"120px"},children:"TRAINING BATCH"}),s.jsx("th",{style:{minWidth:"120px"},children:"PASSPORT NO"}),s.jsx("th",{style:{minWidth:"100px"},children:"NATION"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),s.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),s.jsx("tbody",{children:c.map(F=>s.jsxs("tr",{className:F.hasError?"table-danger":"",children:[s.jsx("td",{children:F.id}),s.jsx("td",{children:F.first_name||F.full_name||"-"}),s.jsx("td",{children:F.middle_name||"-"}),s.jsx("td",{children:F.last_name||"-"}),s.jsx("td",{children:F.email||"-"}),s.jsx("td",{children:F.role||"-"}),s.jsx("td",{children:F.department||"-"}),s.jsx("td",{children:F.phone_number||"-"}),s.jsx("td",{children:F.gender?s.jsx("span",{title:`Original: ${F.gender}`,children:_(F.gender)}):"-"}),s.jsx("td",{children:F.certification_number||"-"}),s.jsx("td",{children:F.specialization||"-"}),s.jsx("td",{children:F.years_of_experience||"-"}),s.jsx("td",{children:F.date_of_birth||"-"}),s.jsx("td",{children:F.training_batch||"-"}),s.jsx("td",{children:F.passport_no||"-"}),s.jsx("td",{children:F.nation||"-"}),s.jsx("td",{className:"text-center",children:ue(F.status)}),s.jsx("td",{children:F.errors.length>0&&s.jsx("small",{className:"text-danger",children:F.errors.length>1?`${F.errors[0]} (+${F.errors.length-1} more)`:F.errors[0]})}),s.jsx("td",{children:s.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>me(F.id),children:s.jsx(mn,{size:14})})})]},F.id))})]})})})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:V,disabled:a,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),c.length>0&&s.jsx(P2,{placement:"top",overlay:s.jsxs(R2,{id:"import-tooltip",children:["Only ",c.filter(F=>!F.hasError).length,"/",c.length," users will be imported into DSFMS"]}),children:s.jsx(se,{variant:"primary",onClick:ae,disabled:a||c.filter(F=>!F.hasError).length===0,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ts,{className:"me-2",size:16}),"Import All (",c.filter(F=>!F.hasError).length," users)"]})})})]})]})},sH=({show:e,user:t,onConfirm:r,onCancel:a,loading:n=!1})=>{if(!t)return null;const i=t.status==="ACTIVE",l=i?"Disable":"Enable",c=i?Sc:Je;return s.jsxs(le,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(le.Header,{closeButton:!0,className:`border-0 ${i?"bg-warning-subtle":"bg-success-subtle"}`,children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Er,{className:`me-2 ${i?"text-warning":"text-success"}`,size:20}),l," User"]})}),s.jsxs(le.Body,{className:"py-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:`rounded-circle d-inline-flex align-items-center justify-content-center mb-3 ${i?"bg-warning-subtle":"bg-success-subtle"}`,style:{width:"64px",height:"64px"},children:s.jsx(c,{size:32,className:i?"text-warning":"text-success"})}),s.jsx("h5",{className:"mb-3",children:i?"Disable User Account":"Enable User Account"}),s.jsx("p",{className:"text-muted mb-4",children:i?"Are you sure you want to disable this user account? This action will:":"Are you sure you want to enable this user account? This action will:"})]}),s.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("div",{className:"me-3",children:s.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:t.fullName}),s.jsx("small",{className:"text-muted",children:t.email})]})]}),s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"EID"}),s.jsx("div",{className:"fw-medium",children:t.eid})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"Role"}),s.jsx("div",{className:"fw-medium",children:t.role})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"Department"}),s.jsx("div",{className:"fw-medium",children:t.department})]})]})]}),i?s.jsxs(ke,{variant:"warning",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" What happens when disabled:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsx("li",{children:"User cannot log into the system"}),s.jsx("li",{children:"All active sessions will be terminated"}),s.jsx("li",{children:"User data will be preserved but access restricted"}),s.jsx("li",{children:"User can be re-enabled later by an administrator"})]})]}):s.jsxs(ke,{variant:"success",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" What happens when enabled:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsx("li",{children:"User can log into the system normally"}),s.jsx("li",{children:"All permissions and access will be restored"}),s.jsx("li",{children:"User will receive notification of account activation"}),s.jsx("li",{children:"Previous data and settings will be available"})]})]})]}),s.jsxs(le.Footer,{className:"border-0 bg-light",children:[s.jsx(se,{variant:"outline-secondary",onClick:a,disabled:n,children:"Cancel"}),s.jsx(se,{variant:i?"warning":"success",onClick:r,disabled:n,className:"d-flex align-items-center",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"me-2",size:16}),l," User"]})})]})]})},aH=({uniqueRoles:e,uniqueDepartments:t,selectedRoles:r,selectedDepartments:a,onRoleToggle:n,onDepartmentToggle:i,onClearFilters:l,className:o=""})=>{const c=r.length>0||a.length>0;return s.jsxs(kt,{className:`filter-panel-dropdown ${o}`,children:[s.jsx(kt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ol,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(kt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Roles"}),r.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(u=>s.jsx(I.Check,{type:"checkbox",id:`role-${u}`,label:u,checked:r.includes(u),onChange:()=>n(u),className:"mb-1"},u))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Departments"}),a.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(u=>s.jsx(I.Check,{type:"checkbox",id:`dept-${u}`,label:u,checked:a.includes(u),onChange:()=>i(u),className:"mb-1"},u))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:l,children:[s.jsx(Xe,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},nH=({show:e,user:t,newRole:r,onConfirm:a,onCancel:n,loading:i=!1})=>{if(!t)return null;const l=u=>{switch(u){case"ADMIN":return"AD";case"ACADEMIC_DEPT":return"AC";case"DEPT_HEAD":return"DH";case"TRAINER":return"TR";case"TRAINEE":return"TN";case"SQA_AUDITOR":return"QA";default:return"EM"}},o=l(t.role),c=l(r);return s.jsxs(le,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(le.Header,{closeButton:!0,className:"bg-warning-subtle border-0",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Er,{className:"me-2 text-warning",size:20}),"Role Change Confirmation"]})}),s.jsxs(le.Body,{className:"py-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"bg-warning-subtle rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"64px",height:"64px"},children:s.jsx(Er,{size:32,className:"text-warning"})}),s.jsx("h5",{className:"mb-3",children:"Role Change Will Update EID"}),s.jsx("p",{className:"text-muted mb-4",children:"Changing the user's role will automatically update their Employee ID (EID) to match the new role prefix."})]}),s.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("div",{className:"me-3",children:s.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:t.fullName}),s.jsx("small",{className:"text-muted",children:t.email})]})]}),s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"text-muted small",children:"Current Role"}),s.jsx("div",{className:"fw-medium",children:t.role})]}),s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"text-muted small",children:"New Role"}),s.jsx("div",{className:"fw-medium text-primary",children:r})]})]})]}),s.jsxs(ke,{variant:"warning",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" EID Change Details:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Current EID:"})," ",t.eid," (Prefix: ",o,")"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"New EID:"})," ",c,"XXXXXX (Prefix: ",c,")"]}),s.jsx("li",{children:"The EID will be automatically updated to reflect the new role"}),s.jsx("li",{children:"This change cannot be undone easily"})]})]})]}),s.jsxs(le.Footer,{className:"border-0 bg-light",children:[s.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:i,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"warning",onClick:()=>{a()},disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Je,{className:"me-2",size:16}),"Confirm Role Change"]})})]})]})},iH=({show:e,user:t,mode:r,onSave:a,onClose:n})=>{const[i,l]=v.useState({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",bio:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),[o,c]=v.useState({}),[u,d]=v.useState(!1),[m,f]=v.useState([]),[x,p]=v.useState(!1),[h,g]=v.useState([]),[b,j]=v.useState(!1),[y,w]=v.useState([]),N=async()=>{p(!0);try{const M=(await Mt.getPublicDepartments()).map(X=>X.name);f(M)}catch(R){console.error("Error fetching departments:",R),te.error("Failed to load departments"),f([])}finally{p(!1)}},S=async()=>{j(!0);try{const M=(await Ws.getPublicRoles()).map(X=>X.name);g(M)}catch(R){console.error("Error fetching roles:",R),te.error("Failed to load roles"),g([])}finally{j(!1)}},E=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Egypt","Estonia","Finland","France","Georgia","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Jordan","Kazakhstan","Kuwait","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Uzbekistan","Vietnam","Yemen"],_=async()=>{try{const R=await Mt.getPublicDepartments();w([])}catch(R){console.error("Error fetching departments with heads:",R),w([])}};v.useEffect(()=>{e&&(N(),S(),_())},[e]),v.useEffect(()=>{t&&r!=="add"?l({firstName:t.firstName||"",middleName:t.middleName||"",lastName:t.lastName||"",address:t.address||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:t.role||"",roleId:t.roleId||"",certificationNumber:t.certificationNumber||"",specialization:t.specialization||"",yearsOfExperience:t.yearsOfExperience||"",bio:t.bio||"",dateOfBirth:t.dateOfBirth||"",trainingBatch:t.trainingBatch||"",passportNo:t.passportNo||"",nation:t.nation||"",department:t.department||""}):r==="add"&&l({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",certificationNumber:"",specialization:"",yearsOfExperience:"",bio:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),c({})},[t,r,e]);const T=()=>{const R={};if(i.firstName.trim()?/^[a-zA-Z\s]+$/.test(i.firstName.trim())||(R.firstName="First name can only contain letters and spaces"):R.firstName="First name is required",i.lastName.trim()?/^[a-zA-Z\s]+$/.test(i.lastName.trim())||(R.lastName="Last name can only contain letters and spaces"):R.lastName="Last name is required",i.middleName.trim()&&!/^[a-zA-Z\s]+$/.test(i.middleName.trim())&&(R.middleName="Middle name can only contain letters and spaces"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(R.email="Email is invalid"):R.email="Email is required",!i.phoneNumber.trim())R.phoneNumber="Phone number is required";else if(!/^[+]?[0-9\s\-()]+$/.test(i.phoneNumber))R.phoneNumber="Phone number cannot contain letters";else{const M=i.phoneNumber.replace(/[^\d+]/g,"");(M.length<7||M.length>16)&&(R.phoneNumber="Phone number must be 7-16 digits")}if(i.role||(R.role="Role is required"),i.role==="DEPARTMENT_HEAD"&&i.department&&i.department.trim()){const M=y.find(X=>{const ie=X.name,ae=i.department,V=X.headUser?.id,me=ie&&ae&&ie.toLowerCase()===ae.toLowerCase(),ue=r!=="edit"||V!==t?.id;return me&&ue});if(M){const X=`${M.headUser?.firstName||""} ${M.headUser?.lastName||""}`.trim();R.department=`Department "${i.department}" already has a head: ${X}`}}return i.role==="TRAINER"&&(i.specialization.trim()||(R.specialization="Specialization is required for trainers"),i.certificationNumber.trim()||(R.certificationNumber="Certification number is required for trainers"),!i.bio||!i.bio.trim()?R.bio="Bio is required for trainers":i.bio.trim().length<1&&(R.bio="Bio must be at least 1 character"),i.department&&i.department.trim()!==""&&(R.department="Department is not allowed for Trainer role")),i.role==="TRAINEE"&&(i.trainingBatch.trim()||(R.trainingBatch="Training batch is required for trainees"),i.passportNo.trim()?/^\d{1,20}$/.test(i.passportNo.trim())||(R.passportNo="Passport number must be 1-20 digits only"):R.passportNo="Passport number is required for trainees",i.dateOfBirth.trim()?i.dateOfBirth.length!==10||!/^\d{4}-\d{2}-\d{2}$/.test(i.dateOfBirth)?R.dateOfBirth="Please enter date in YYYY-MM-DD format":new Date(i.dateOfBirth)>=new Date&&(R.dateOfBirth="Date of birth must be in the past"):R.dateOfBirth="Date of birth is required for trainees"),c(R),Object.keys(R).length===0},C=async R=>{if(R.preventDefault(),!!T()&&!u){d(!0);try{await a(i)}catch(M){console.error("Error in handleSubmit:",M)}finally{d(!1)}}},A=(R,M)=>{l(X=>({...X,[R]:M})),c(X=>{const ie={...X};if(ie[R]&&delete ie[R],R==="role"&&(delete ie.specialization,delete ie.certificationNumber,delete ie.bio,delete ie.trainingBatch,delete ie.passportNo,delete ie.dateOfBirth,delete ie.department),R==="department"){if(delete ie.department,i.role==="TRAINER")M&&M.trim()!==""&&(ie.department="Department is not allowed for Trainer role");else if(i.role==="DEPARTMENT_HEAD"&&M&&M.trim()){const ae=y.find(V=>{const me=V.name,ue=M,F=V.headUser?.id;return me&&ue&&me.toLowerCase()===ue.toLowerCase()&&(r!=="edit"||F!==t?.id)});if(ae){const V=`${ae.headUser?.firstName||""} ${ae.headUser?.lastName||""}`.trim();ie.department=`Department "${M}" already has a head: ${V}`}}}return R==="role"&&M==="TRAINER"&&l(ae=>({...ae,department:""})),ie})},D=()=>{switch(r){case"add":return"Add New User";case"edit":return"Edit User";case"view":return"User Details";default:return"User"}},P=r==="view";return s.jsxs(le,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(le.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(St,{className:"me-2",size:20}):s.jsx(hs,{className:"me-2",size:20}),D()]})}),s.jsxs(I,{onSubmit:C,children:[s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(o).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(o).map(([R,M])=>s.jsx("li",{children:M},R))})]}),s.jsxs(oe,{children:[s.jsx(U,{md:4,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"First Name *"}),s.jsx(I.Control,{type:"text",value:i.firstName,onChange:R=>A("firstName",R.target.value),isInvalid:!!o.firstName,readOnly:P,style:{borderColor:o.firstName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.firstName})]})}),s.jsx(U,{md:4,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Middle Name"}),s.jsx(I.Control,{type:"text",value:i.middleName,onChange:R=>A("middleName",R.target.value),isInvalid:!!o.middleName,readOnly:P,style:{borderColor:o.middleName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.middleName})]})}),s.jsx(U,{md:4,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Last Name *"}),s.jsx(I.Control,{type:"text",value:i.lastName,onChange:R=>A("lastName",R.target.value),isInvalid:!!o.lastName,readOnly:P,style:{borderColor:o.lastName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.lastName})]})})]}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Email *"}),s.jsx(I.Control,{type:"email",value:i.email,onChange:R=>A("email",R.target.value),isInvalid:!!o.email,readOnly:P,style:{borderColor:o.email?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.email})]})})}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Phone Number *"}),s.jsx(I.Control,{type:"tel",value:i.phoneNumber,onChange:R=>A("phoneNumber",R.target.value),isInvalid:!!o.phoneNumber,readOnly:P,placeholder:"Enter phone number",style:{borderColor:o.phoneNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.phoneNumber})]})})}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Address (optional)"}),s.jsx(I.Control,{as:"textarea",rows:3,value:i.address,onChange:R=>A("address",R.target.value),readOnly:P,placeholder:"Enter address (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),s.jsxs(oe,{children:[s.jsx(U,{md:i.role==="DEPT_HEAD"||i.role==="TRAINER"?6:12,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Role *"}),s.jsxs(I.Select,{value:i.role,onChange:R=>A("role",R.target.value),isInvalid:!!o.role,disabled:P||b,style:{borderColor:o.role?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:b?"Loading roles...":"Select a role"}),h.map(R=>s.jsx("option",{value:R,children:R},R))]}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.role})]})}),i.role==="DEPARTMENT_HEAD"&&s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Department"}),s.jsxs(I.Select,{value:i.department,onChange:R=>A("department",R.target.value),isInvalid:!!o.department,disabled:P||x,style:{borderColor:o.department?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:x?"Loading departments...":"Select a department"}),m.map(R=>s.jsx("option",{value:R,children:R},R))]}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.department})]})})]}),i.role==="TRAINER"&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Specialization *"}),s.jsx(I.Control,{type:"text",value:i.specialization,onChange:R=>A("specialization",R.target.value),isInvalid:!!o.specialization,readOnly:P,placeholder:"Enter specialization",style:{borderColor:o.specialization?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.specialization})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Certification Number *"}),s.jsx(I.Control,{type:"text",value:i.certificationNumber,onChange:R=>A("certificationNumber",R.target.value),isInvalid:!!o.certificationNumber,readOnly:P,placeholder:"Enter certification number",style:{borderColor:o.certificationNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.certificationNumber})]})})]}),s.jsx(oe,{children:s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Years of Experience"}),s.jsx(I.Control,{type:"number",value:i.yearsOfExperience,onChange:R=>A("yearsOfExperience",R.target.value),readOnly:P,placeholder:"Enter years of experience",min:"0",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Bio *"}),s.jsx(I.Control,{as:"textarea",rows:4,value:i.bio,onChange:R=>A("bio",R.target.value),isInvalid:!!o.bio,readOnly:P,placeholder:"Enter trainer bio (at least 1 character, no unsupported characters)",style:{borderColor:o.bio?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.bio}),s.jsx(I.Text,{className:"text-muted",children:"Bio is required and must contain at least 1 character. Only letters, numbers, spaces, and common punctuation are allowed."})]})})})]}),i.role==="TRAINEE"&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Date of Birth *"}),s.jsx(I.Control,{type:"date",value:i.dateOfBirth,onChange:R=>{const M=R.target.value;(M===""||M.length===10&&/^\d{4}-\d{2}-\d{2}$/.test(M))&&A("dateOfBirth",M)},isInvalid:!!o.dateOfBirth,readOnly:P,max:"2024-12-31",min:"1900-01-01",style:{borderColor:o.dateOfBirth?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.dateOfBirth})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Training Batch *"}),s.jsx(I.Control,{type:"text",value:i.trainingBatch,onChange:R=>A("trainingBatch",R.target.value),isInvalid:!!o.trainingBatch,readOnly:P,placeholder:"Enter training batch",style:{borderColor:o.trainingBatch?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.trainingBatch})]})})]}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Passport No *"}),s.jsx(I.Control,{type:"text",value:i.passportNo,onChange:R=>A("passportNo",R.target.value),isInvalid:!!o.passportNo,readOnly:P,placeholder:"Enter passport number",style:{borderColor:o.passportNo?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.passportNo})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Nation"}),s.jsxs(I.Select,{value:i.nation,onChange:R=>A("nation",R.target.value),disabled:P,style:{borderColor:"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:"Select a nation"}),E.map(R=>s.jsx("option",{value:R,children:R},R))]})]})})]})]}),r==="view"&&t&&s.jsx(oe,{children:s.jsx(U,{children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Employee ID"}),s.jsx(I.Control,{type:"text",value:t.eid,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:u,children:[s.jsx(Xe,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(se,{variant:"primary-custom",type:"submit",disabled:u,children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),r==="add"?"Add User":"Save Changes"]})})]})]})]})},lH=({user:e,index:t,onView:r,onEdit:a,onDisable:n})=>{const i=o=>o==="ACTIVE"?"success":"secondary",l=o=>o==="ACTIVE"?"":"";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"fw-semibold text-primary-custom",children:e.eid})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:e.fullName})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:e.email})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx(Ne,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.role})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.department})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs(Ne,{bg:i(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:l(e.status)}),e.status]})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.VIEW_USER_IN_DETAIL,fe.UPDATE_USER],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>r(e),permission:fe.VIEW_USER_IN_DETAIL},{label:"Edit User",icon:s.jsx(ts,{}),onClick:()=>a(e),permission:fe.UPDATE_USER},{type:"divider"},{label:e.status==="ACTIVE"?"Disable User":"Enable User",icon:s.jsx(Sc,{}),className:"text-danger",onClick:()=>n(e),permission:fe.UPDATE_USER}]})})})]})},oH=({users:e,loading:t,onView:r,onEdit:a,onDisable:n})=>{const{sortedData:i,sortConfig:l,handleSort:o}=ur(e);if(t)return s.jsx(zt,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No users found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new user."})]})});const c=({columnKey:u,children:d,className:m=""})=>{const f=l.key===u,x=f?l.direction:null;return s.jsxs("th",{className:`fw-semibold ${m}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(u),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:f?"600":"500",color:"white"},children:d}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:x,size:14,color:"white"})})]}),f&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive user-management-table",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(c,{columnKey:"eid",className:"show-mobile",children:"EID"}),s.jsx(c,{columnKey:"fullName",className:"show-mobile",children:"Full Name"}),s.jsx(c,{columnKey:"email",className:"show-mobile",children:"Email"}),s.jsx(c,{columnKey:"role",className:"show-mobile",children:"Role"}),s.jsx(c,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:i.map((u,d)=>s.jsx(lH,{user:u,index:d,onView:r,onEdit:a,onDisable:n},u.id))})]})})},cH=()=>{const[e,t]=v.useState([]),[r,a]=v.useState([]),[n,i]=v.useState(""),[l,o]=v.useState([]),[c,u]=v.useState([]),[d,m]=v.useState(!1),[f,x]=v.useState(null),[p,h]=v.useState("view"),[g,b]=v.useState(!1),[j,y]=v.useState(null),[w,N]=v.useState(!1),[S,E]=v.useState(null);v.useEffect(()=>{(async()=>{b(!0);try{const O=await $s.getUsers();let G=[];Array.isArray(O)?G=O:Array.isArray(O?.data)?G=O.data:O?.users&&Array.isArray(O.users)?G=O.users:(console.warn(" Unexpected users response format:",O),G=[]);const Z=G.map(ee=>({id:ee.id,eid:ee.eid,fullName:[ee.firstName,ee.middleName,ee.lastName].filter(Boolean).join(" "),firstName:ee.firstName,middleName:ee.middleName,lastName:ee.lastName,role:ee.role?.name||"N/A",roleId:ee.role?.id||"",department:ee.department?.name||"N/A",status:ee.status,email:ee.email,phoneNumber:ee.phoneNumber||"",address:ee.address||"",certificationNumber:ee.certificationNumber||"",specialization:ee.specialization||"",yearsOfExperience:ee.yearsOfExperience||"",bio:ee.bio||"",dateOfBirth:ee.dateOfBirth||"",trainingBatch:ee.trainingBatch||"",passportNo:ee.passportNo||"",nation:ee.nation||"",createdAt:ee.createdAt,lastLogin:ee.lastLogin||""}));t(Z),y(null);try{const de=(await Mt.getPublicDepartments()).map(Ee=>({id:Ee.id,name:Ee.name,description:Ee.description,isActive:Ee.isActive}));a(de)}catch(ee){console.warn(" Failed to fetch public departments, will use departments from users:",ee?.message||ee);const de=[...new Set(Z.map(Ee=>Ee.department).filter(Ee=>Ee&&Ee!=="N/A"))].map(Ee=>({name:Ee,id:null}));a(de)}}catch(O){const G=Va(O,{});y(G)}finally{b(!1)}})()},[]);const _=[...new Set(e.map(k=>k.role).filter(Boolean))],T=[...new Set(r.map(k=>k.name||k).filter(Boolean)),...new Set(e.map(k=>k.department).filter(Boolean))].filter((k,O,G)=>k&&k!=="N/A"&&G.indexOf(k)===O),C=e.filter(k=>{const O=!n||k.fullName.toLowerCase().includes(n.toLowerCase())||k.eid.toLowerCase().includes(n.toLowerCase())||k.email.toLowerCase().includes(n.toLowerCase()),G=l.length===0||l.includes(k.role),Z=c.length===0||c.includes(k.department);return O&&G&&Z}),A=k=>i(k),D=k=>{o(O=>O.includes(k)?O.filter(G=>G!==k):[...O,k])},P=k=>{u(O=>O.includes(k)?O.filter(G=>G!==k):[...O,k])},R=()=>{o([]),u([]),i("")},M=async k=>{try{b(!0);const O=await $s.getUserById(k.id),G={id:O.id,eid:O.eid,fullName:[O.firstName,O.middleName,O.lastName].filter(Boolean).join(" "),firstName:O.firstName,middleName:O.middleName,lastName:O.lastName,role:O.role?.name||"N/A",roleId:O.role?.id||"",department:O.department?.name||"N/A",status:O.status,email:O.email,phoneNumber:O.phoneNumber||"",address:O.address||"",certificationNumber:O.trainerProfile?.certificationNumber||"",specialization:O.trainerProfile?.specialization||"",yearsOfExperience:O.trainerProfile?.yearsOfExp||"",bio:O.trainerProfile?.bio||"",dateOfBirth:O.traineeProfile?.dob?O.traineeProfile.dob.split("T")[0]:"",trainingBatch:O.traineeProfile?.trainingBatch||"",passportNo:O.traineeProfile?.passportNo||"",nation:O.traineeProfile?.nation||"",createdAt:O.createdAt,lastLogin:O.lastLogin||""};x(G),h("view"),m(!0)}catch{y("Unable to load user details")}finally{b(!1)}},X=async k=>{try{b(!0);const O=await $s.getUserById(k.id),G={id:O.id,eid:O.eid,fullName:[O.firstName,O.middleName,O.lastName].filter(Boolean).join(" "),firstName:O.firstName,middleName:O.middleName,lastName:O.lastName,role:O.role?.name||"N/A",roleId:O.role?.id||"",department:O.department?.name||"N/A",status:O.status,email:O.email,phoneNumber:O.phoneNumber||"",address:O.address||"",certificationNumber:O.trainerProfile?.certificationNumber||"",specialization:O.trainerProfile?.specialization||"",yearsOfExperience:O.trainerProfile?.yearsOfExp||"",bio:O.trainerProfile?.bio||"",dateOfBirth:O.traineeProfile?.dob?O.traineeProfile.dob.split("T")[0]:"",trainingBatch:O.traineeProfile?.trainingBatch||"",passportNo:O.traineeProfile?.passportNo||"",nation:O.traineeProfile?.nation||"",createdAt:O.createdAt,lastLogin:O.lastLogin||""};x(G),h("edit"),m(!0)}catch{y("Unable to load user details")}finally{b(!1)}},ie=()=>{x(null),h("add"),m(!0)},ae=async k=>{try{b(!0);let O,G;k.status==="ACTIVE"?(O=await $s.disableUser(k.id),G="disabled"):(O=await $s.enableUser(k.id),G="enabled");const Z=await $s.getUsers();let ee=[];Array.isArray(Z)?ee=Z:Array.isArray(Z?.data)?ee=Z.data:Z?.users&&Array.isArray(Z.users)?ee=Z.users:(console.warn(" Unexpected users response format:",Z),ee=[]);const de=ee.map(B=>({id:B.id,eid:B.eid,fullName:[B.firstName,B.middleName,B.lastName].filter(Boolean).join(" "),firstName:B.firstName,middleName:B.middleName,lastName:B.lastName,role:B.role?.name||"N/A",roleId:B.role?.id||"",department:B.department?.name||"N/A",status:B.status,email:B.email,phoneNumber:B.phoneNumber||"",address:B.address||"",certificationNumber:B.trainerProfile?.certificationNumber||"",specialization:B.trainerProfile?.specialization||"",yearsOfExperience:B.trainerProfile?.yearsOfExp||"",bio:B.trainerProfile?.bio||"",dateOfBirth:B.traineeProfile?.dob?B.traineeProfile.dob.split("T")[0]:"",trainingBatch:B.traineeProfile?.trainingBatch||"",passportNo:B.traineeProfile?.passportNo||"",nation:B.traineeProfile?.nation||"",createdAt:B.createdAt,lastLogin:B.lastLogin||""}));t(de);try{const Se=(await Mt.getPublicDepartments()).map(Re=>({id:Re.id,name:Re.name,description:Re.description,isActive:Re.isActive}));a(Se)}catch(B){console.warn(" Failed to refresh public departments, will use departments from users:",B?.message||B);const Se=[...new Set(de.map(Re=>Re.department).filter(Re=>Re&&Re!=="N/A"))].map(Re=>({name:Re,id:null}));a(Se)}const Ee=O?.message||`User has been ${G} successfully!`;te.success(Ee)}catch(O){const G=Va(O,{});y(G),te.error(G)}finally{b(!1)}},V=async k=>{try{if(b(!0),p==="edit"&&f&&f.role!==k.role){E(k),N(!0),b(!1);return}await me(k)}catch{b(!1)}},me=async k=>{try{b(!0);let O=null;try{const Re=(await Ws.getPublicRoles()).find(He=>He.name===k.role);if(Re)O=Re.id;else throw new Error(`Role '${k.role}' not found in backend`)}catch(Se){throw new Error(`Failed to get role ID for '${k.role}': ${Se.message}`)}const G={firstName:k.firstName,middleName:k.middleName||"",lastName:k.lastName,address:k.address||"",email:k.email,gender:"MALE",avatarUrl:"",phoneNumber:k.phoneNumber||"",role:{id:O,name:k.role}};if(k.role==="TRAINER")G.trainerProfile={specialization:k.specialization||"",certificationNumber:k.certificationNumber||"",yearsOfExp:k.yearsOfExperience?parseInt(k.yearsOfExperience):0,bio:k.bio||""};else if(k.role==="DEPARTMENT_HEAD")if(k.department&&k.department.trim()){const Se=r.find(Re=>Re.name===k.department);if(Se)G.departmentId=Se.id;else throw new Error(`Department '${k.department}' not found`)}else G.departmentId=null;else k.role==="TRAINEE"&&(k.dateOfBirth||k.trainingBatch||k.passportNo||k.nation)&&(G.traineeProfile={dob:k.dateOfBirth?new Date(k.dateOfBirth).toISOString():null,enrollmentDate:new Date().toISOString(),trainingBatch:k.trainingBatch||"",passportNo:k.passportNo||"",nation:k.nation||""});p==="add"?(await $s.createUser(G),te.success("User created successfully!")):p==="edit"&&(await $s.updateUser(f.id,G),te.success("User updated successfully!")),m(!1);const[Z,ee]=await Promise.all([$s.getUsers(),Mt.getPublicDepartments()]);let de=[];if(Array.isArray(Z)?de=Z:Array.isArray(Z?.data)?de=Z.data:Z?.users&&Array.isArray(Z.users)?de=Z.users:(console.warn(" Unexpected users response format:",Z),de=[]),p==="edit"&&f?.id){const Se=de.find(Re=>Re.id===f.id)}const Ee=de.map(Se=>({id:Se.id,eid:Se.eid,fullName:[Se.firstName,Se.middleName,Se.lastName].filter(Boolean).join(" "),firstName:Se.firstName,middleName:Se.middleName,lastName:Se.lastName,role:Se.role?.name||"N/A",roleId:Se.role?.id||"",department:Se.department?.name||"N/A",status:Se.status,email:Se.email,phoneNumber:Se.phoneNumber||"",address:Se.address||"",certificationNumber:Se.trainerProfile?.certificationNumber||"",specialization:Se.trainerProfile?.specialization||"",yearsOfExperience:Se.trainerProfile?.yearsOfExp||"",bio:Se.trainerProfile?.bio||"",dateOfBirth:Se.traineeProfile?.dob?Se.traineeProfile.dob.split("T")[0]:"",trainingBatch:Se.traineeProfile?.trainingBatch||"",passportNo:Se.traineeProfile?.passportNo||"",nation:Se.traineeProfile?.nation||"",createdAt:Se.createdAt,lastLogin:Se.lastLogin||""})),B=Array.isArray(ee)?ee.map(Se=>({id:Se.id,name:Se.name,description:Se.description,isActive:Se.isActive})):[];t(Ee),a(B)}catch(O){const G=Va(O,{});throw y(G),new Error(G)}finally{b(!1)}};return{users:C,searchTerm:n,selectedRoles:l,selectedDepartments:c,uniqueRoles:_,uniqueDepartments:T,modalShow:d,selectedUser:f,modalMode:p,loading:g,error:j,confirmRoleChange:w,pendingUserData:S,handleSearch:A,handleRoleToggle:D,handleDepartmentToggle:P,handleClearFilters:R,handleView:M,handleEdit:X,handleAdd:ie,handleDisable:ae,handleSave:V,handleBulkImport:async k=>{try{b(!0);const O=await $s.bulkImportUsers(k),G=O?.success??O?.data?.success??[],Z=O?.failed??O?.data?.failed??[],ee=O?.summary??O?.data?.summary;if(G.length>0){const Se=ee?.successful?`Successfully imported ${ee.successful} / ${ee.total} users`:`Successfully imported ${G.length} users!`;te.success(Se)}if(Z.length>0){const Se=Z.map(He=>`User ${He.index+1}: ${He.error}`),Re=ee?.failed?`Failed to import ${ee.failed} user(s): ${Se.join(", ")}`:`Failed to import ${Z.length} user(s): ${Se.join(", ")}`;te.error(Re)}const de=await $s.getUsers();let Ee=[];Array.isArray(de)?Ee=de:Array.isArray(de?.data)?Ee=de.data:de?.users&&Array.isArray(de.users)?Ee=de.users:(console.warn(" Unexpected users response format:",de),Ee=[]);const B=Ee.map(Se=>({id:Se.id,eid:Se.eid,fullName:[Se.firstName,Se.middleName,Se.lastName].filter(Boolean).join(" "),firstName:Se.firstName,middleName:Se.middleName,lastName:Se.lastName,role:Se.role?.name||"N/A",roleId:Se.role?.id||"",department:Se.department?.name||"N/A",status:Se.status,email:Se.email,phoneNumber:Se.phoneNumber||"",address:Se.address||"",certificationNumber:Se.trainerProfile?.certificationNumber||"",specialization:Se.trainerProfile?.specialization||"",yearsOfExperience:Se.trainerProfile?.yearsOfExp||"",bio:Se.trainerProfile?.bio||"",dateOfBirth:Se.traineeProfile?.dob?Se.traineeProfile.dob.split("T")[0]:"",trainingBatch:Se.traineeProfile?.trainingBatch||"",passportNo:Se.traineeProfile?.passportNo||"",nation:Se.traineeProfile?.nation||"",createdAt:Se.createdAt,lastLogin:Se.lastLogin||""}));t(B);try{const Re=(await Mt.getPublicDepartments()).map(He=>({id:He.id,name:He.name,description:He.description,isActive:He.isActive}));a(Re)}catch(Se){console.warn(" Failed to refresh public departments, will use departments from users:",Se?.message||Se);const Re=[...new Set(B.map(He=>He.department).filter(He=>He&&He!=="N/A"))].map(He=>({name:He,id:null}));a(Re)}}catch(O){const G=Va(O,{});y(G),te.error(G)}finally{b(!1)}},handleModalClose:()=>{m(!1),x(null)},handleConfirmRoleChange:async()=>{N(!1),S&&(await me(S),E(null))},handleCancelRoleChange:()=>{N(!1),E(null)},setError:y}},dH=()=>{const[e,t]=Yu();Ge();const[r,a]=v.useState(!1),[n,i]=v.useState(null),[l,o]=v.useState(!1),[c,u]=v.useState(!1);v.useEffect(()=>{if(e.get("action")==="bulk-import"){u(!0);const z=new URLSearchParams(e);z.delete("action"),t(z,{replace:!0})}},[e,t]);const{users:d,loading:m,error:f,searchTerm:x,selectedRoles:p,selectedDepartments:h,uniqueRoles:g,uniqueDepartments:b,modalShow:j,selectedUser:y,modalMode:w,confirmRoleChange:N,pendingUserData:S,handleSearch:E,handleRoleToggle:_,handleDepartmentToggle:T,handleClearFilters:C,handleView:A,handleEdit:D,handleAdd:P,handleDisable:R,handleSave:M,handleBulkImport:X,handleModalClose:ie,handleConfirmRoleChange:ae,handleCancelRoleChange:V}=cH(),me=Y=>{i(Y),a(!0)},ue=async()=>{if(n){o(!0);try{await R(n),a(!1),i(null)}catch(Y){console.error("Error disabling user:",Y)}finally{o(!1)}}},F=()=>{a(!1),i(null)};return J.useEffect(()=>{f&&te.error(f)},[f]),s.jsx(_e,{fluid:!0,className:"py-4 user-management-page",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(oe,{className:"align-items-center",children:s.jsx(U,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(Ar,{permission:fe.BULK_CREATE_USERS,fallback:null,children:s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>u(!0),className:"d-flex align-items-center",children:[s.jsx(Ts,{className:"me-1",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Bulk Import"}),s.jsx("span",{className:"d-sm-none",children:"Import"})]})}),s.jsx(Ar,{permission:fe.CREATE_USER,fallback:null,children:s.jsxs(se,{variant:"primary-custom",size:"sm",onClick:P,className:"d-flex align-items-center",children:[s.jsx(Xr,{className:"me-1",size:16}),"Add User"]})})]})})})}),s.jsxs(H.Body,{children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search users by name, EID, or email...",value:x,onChange:E,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(aH,{uniqueRoles:g,uniqueDepartments:b,selectedRoles:p,selectedDepartments:h,onRoleToggle:_,onDepartmentToggle:T,onClearFilters:C,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[d.length," user",d.length!==1?"s":""]})})})]}),s.jsxs("div",{className:"position-relative user-management-table-wrapper",children:[s.jsx(oH,{users:d,loading:m,onView:A,onEdit:D,onDisable:me}),d.length>8&&s.jsxs("div",{className:"scroll-indicator",children:[s.jsx(ni,{size:12,className:"me-1"}),"Scroll to see more users"]})]}),s.jsx(iH,{show:j,user:y,mode:w,onSave:M,onClose:ie}),s.jsx(rH,{show:c,onClose:()=>{if(u(!1),e.get("action")==="bulk-import"){const Y=new URLSearchParams(e);Y.delete("action"),t(Y,{replace:!0})}},onImport:X,loading:m}),s.jsx(sH,{show:r,user:n,onConfirm:ue,onCancel:F,loading:l}),s.jsx(nH,{show:N,user:y,newRole:S?.role,onConfirm:ae,onCancel:V,loading:m})]})]})})},uH=({show:e,role:t,onConfirm:r,onCancel:a,loading:n})=>{if(!t)return null;const i=t.status==="Active",l=i?"Disable":"Enable",c=i?lS:Je;return s.jsxs(le,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(le.Header,{closeButton:!0,className:"text-white border-0",style:{backgroundColor:i?"var(--bs-secondary)":"#28a745",borderBottom:"none"},children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(c,{size:24,className:"me-2"}),l," Role: ",t.name]})}),s.jsxs(le.Body,{className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 text-white",style:{width:"50px",height:"50px",backgroundColor:i?"var(--bs-secondary)":"#28a745",fontSize:"1.5rem",fontWeight:"bold"},children:t.name.charAt(0).toUpperCase()}),s.jsx("div",{children:s.jsx("h6",{className:"mb-0",children:t.name})})]}),i?s.jsxs(ke,{variant:"warning",className:"mb-3",style:{backgroundColor:"#f0e8e0",borderColor:"var(--bs-secondary)",color:"var(--bs-dark)"},children:[s.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[s.jsx(Er,{className:"me-2",style:{color:"var(--bs-secondary)"}})," Warning: Disabling Role"]}),s.jsxs("p",{className:"mb-1",children:["This action will disable the ",s.jsx("span",{className:"fw-bold",children:t.name})," role."]}),s.jsxs("ul",{className:"mb-0 ps-3",children:[s.jsx("li",{children:"Users with this role will lose access to associated permissions."}),s.jsx("li",{children:"Role data will be preserved but access will be restricted."}),s.jsx("li",{children:"Role can be re-enabled later by an administrator."}),s.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}):s.jsxs(ke,{variant:"success",className:"mb-3",children:[s.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[s.jsx(Je,{className:"me-2"})," Confirm: Enabling Role"]}),s.jsxs("p",{className:"mb-1",children:["This action will restore the ",s.jsx("span",{className:"fw-bold",children:t.name})," role."]}),s.jsxs("ul",{className:"mb-0 ps-3",children:[s.jsx("li",{children:"Users with this role will regain access to associated permissions."}),s.jsx("li",{children:"All role permissions and access will be restored."}),s.jsx("li",{children:"Role will be available for assignment to new users."}),s.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(se,{variant:"outline-secondary",onClick:a,disabled:n,children:"Cancel"}),s.jsx(se,{variant:i?"secondary":"success",onClick:r,disabled:n,className:"d-flex align-items-center",style:i?{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#fff"}:{},children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{size:16,className:"me-2"}),l," Role"]})})]})]})]})},mH=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:a,className:n=""})=>{const i=t.length>0;return s.jsxs(kt,{className:`filter-panel-dropdown ${n}`,children:[s.jsx(kt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ol,{size:14,className:"me-2"}),"Filters",i&&s.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),s.jsxs(kt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"280px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(l=>s.jsx(I.Check,{type:"checkbox",id:`status-${l}`,label:l,checked:t.includes(l),onChange:()=>r(l),className:"mb-1"},l))})]}),i&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:a,children:[s.jsx(Xe,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},fH=["ADMINISTRATOR"],Ny=e=>fH.includes(e?.toUpperCase()),hH=({show:e,role:t,mode:r,onSave:a,onClose:n})=>{const[i,l]=v.useState({name:"",description:"",permissionIds:[]}),[o,c]=v.useState({}),[u,d]=v.useState(!1),[m,f]=v.useState({}),{allPermissions:x,loading:p,error:h,fetchAllPermissions:g}=a6(),b=v.useMemo(()=>{if(!x||x.length===0)return[];const C={};return x.forEach(A=>{const D=A.module,P=A.viewModule||`${A.module} Management`;C[D]||(C[D]={id:D,name:P,description:`Manage ${P.toLowerCase()} related permissions`,permissions:[]});const R=A.id||A.permissionId;R&&C[D].permissions.push({id:R,title:A.viewName||A.name,description:A.description||"",isActive:A.isActive,method:A.method,path:A.path})}),Object.values(C).sort((A,D)=>A.name.localeCompare(D.name))},[x]),j=v.useMemo(()=>{const C=b;if(r==="view"&&t?.permissions){const A=t.permissions.map(D=>D.id||D);return C.map(D=>({...D,permissions:D.permissions.filter(P=>A.includes(P.id))})).filter(D=>D.permissions.length>0)}return C},[b,r,t?.permissions]);v.useEffect(()=>{if(t&&r!=="add"){const C=t.permissions?t.permissions.map(A=>A.id||A):[];l({name:t.name||"",description:t.description||"",permissionIds:C})}else r==="add"&&l({name:"",description:"",permissionIds:[]});c({})},[t,r,e]),v.useEffect(()=>{e&&g()},[e,g]),v.useEffect(()=>{if(r==="view"){const C={};j.map(D=>D.id).forEach(D=>{C[D]=!0}),f(C)}else if(r==="edit"){const C={};j.map(D=>D.id).forEach(D=>{C[D]=!0}),f(C)}else f({})},[r,j]);const y=()=>{const C={};return i.name.trim()?/^[a-zA-Z0-9\s_]+$/.test(i.name.trim())||(C.name="Role name cannot contain special characters"):C.name="Role name is required",i.permissionIds.length===0&&(C.permissionIds="At least one permission is required"),c(C),Object.keys(C).length===0},w=async C=>{if(C.preventDefault(),!!y()){d(!0);try{await a(i)}catch(A){console.error("Error saving role:",A)}finally{d(!1)}}},N=(C,A)=>{l(D=>({...D,[C]:A})),o[C]&&c(D=>({...D,[C]:""}))},S=C=>{!C||C===null||C===void 0||(l(A=>{const D=A.permissionIds||[],P=D.some(R=>String(R)===String(C));return{...A,permissionIds:P?D.filter(R=>String(R)!==String(C)):[...D,C]}}),o.permissionIds&&c(A=>({...A,permissionIds:""})))},E=C=>{f(A=>({...A,[C]:!A[C]}))},_=()=>{switch(r){case"add":return"Add New Role";case"edit":return"Edit Role";case"view":return"Role Details";default:return"Role"}},T=r==="view";return s.jsxs(le,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(le.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(St,{className:"me-2",size:20}):s.jsx(qx,{className:"me-2",size:20}),_()]})}),s.jsxs(I,{onSubmit:w,children:[s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t&&Ny(t.name)&&r==="edit"&&s.jsxs(ke,{variant:"warning",className:"mb-3",children:[s.jsx(Er,{className:"me-2"}),s.jsx("strong",{children:"Base Role Warning:"})," This role cannot be modified."]}),Object.keys(o).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(o).map(([C,A])=>s.jsx("li",{children:A},C))})]}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsx(I.Group,{className:"mb-3",children:s.jsxs(oe,{className:"align-items-center",children:[s.jsx(U,{md:2,children:s.jsx(I.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Role Name *"})}),s.jsxs(U,{md:4,children:[s.jsx(I.Control,{type:"text",size:"sm",value:i.name,onChange:C=>{const A=C.target.value;/^[a-zA-Z0-9\s_]*$/.test(A)&&N("name",A)},isInvalid:!!o.name,readOnly:T,style:{borderColor:o.name?"#dc3545":"var(--bs-primary)",borderWidth:"1px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.name})]})]})})})}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsx(I.Group,{className:"mb-3",children:s.jsxs(oe,{className:"align-items-start",children:[s.jsx(U,{md:2,children:s.jsx(I.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Description"})}),s.jsx(U,{md:4,children:s.jsx(I.Control,{as:"textarea",rows:2,size:"sm",value:i.description,onChange:C=>N("description",C.target.value),readOnly:T,placeholder:"Enter role description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"1px",resize:"none"}})})]})})})}),s.jsx(oe,{children:s.jsx(U,{children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold fs-5 mb-3",children:"Permissions *"}),o.permissionIds&&s.jsx("div",{className:"text-danger small mb-2",children:o.permissionIds}),h&&s.jsxs("div",{className:"text-danger small mb-2",children:["Error loading permissions: ",h.message||"Unknown error"]}),s.jsx("div",{className:"border rounded p-4 bg-light",style:{maxHeight:"300px",overflowY:"auto",borderColor:"var(--bs-primary)",borderWidth:"2px"},children:p?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(xt,{animation:"border",size:"sm",className:"me-2"}),"Loading permissions..."]}):j.length>0?s.jsx(s.Fragment,{children:j.map(C=>{const A=m[C.id];return s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:`d-flex align-items-center p-2 bg-light rounded permission-group-header ${T?"":"cursor-pointer"}`,onClick:()=>!T&&E(C.id),role:T?void 0:"button",tabIndex:T?void 0:0,onKeyDown:T?void 0:D=>{(D.key==="Enter"||D.key===" ")&&(D.preventDefault(),E(C.id))},"aria-expanded":T?void 0:A,children:s.jsxs("div",{className:"d-flex align-items-center",children:[!T&&(A?s.jsx(ni,{className:"me-2",size:16}):s.jsx(Xu,{className:"me-2",size:16})),s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold text-primary-custom",children:C.name}),s.jsx("small",{className:"text-muted",children:C.description})]})]})}),A&&C.permissions.length>0&&s.jsx("div",{className:"ms-3 mt-2",children:s.jsx(Aa,{variant:"flush",children:C.permissions.map(D=>{const P=D.id;return P?s.jsx(Aa.Item,{className:"border-0 px-0 py-2 permission-item",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"form-check me-3",children:s.jsx("input",{type:"checkbox",className:"form-check-input",id:`permission-${P}`,checked:i.permissionIds.some(R=>String(R)===String(P)),onChange:R=>{R.stopPropagation(),!T&&P&&S(P)},onClick:R=>{R.stopPropagation()},disabled:T,style:{cursor:T?"not-allowed":"pointer",width:"1.25rem",height:"1.25rem"}})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("div",{className:"fw-medium text-dark",children:D.title}),s.jsx("small",{className:"text-muted",children:D.description})]}),!T&&i.permissionIds.some(R=>String(R)===String(P))&&s.jsx(Ne,{bg:"primary",className:"ms-2",children:"Selected"})]})},`${C.id}-${P}`):null})})})]},C.id)})}):s.jsx("div",{className:"text-center py-4 text-muted",children:"No permissions available"})}),s.jsx("div",{className:"mt-2",children:s.jsxs("small",{className:"text-muted",children:[i.permissionIds.length," of ",j.reduce((C,A)=>C+A.permissions.length,0)," permissions assigned"]})})]})})}),r==="view"&&t&&s.jsx(oe,{children:s.jsx(U,{children:s.jsxs("div",{className:"bg-light-custom p-3 rounded",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Role Information"}),s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Assigned Users:"}),s.jsx("div",{className:"fw-medium",children:t.assignedUsers||0})]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Total Permissions:"}),s.jsx("div",{className:"fw-medium",children:i.permissionIds.length})]})]})]})})})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:u,children:[s.jsx(Xe,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(se,{variant:"primary-custom",type:"submit",disabled:u||t&&Ny(t.name),children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),r==="add"?"Add Role":"Save Changes"]})})]})]})]})},pH=({roles:e,loading:t,actionsComponent:r,onView:a,onEdit:n,onDisable:i})=>{const{sortedData:l,sortConfig:o,handleSort:c}=ur(e);if(t)return s.jsx(zt,{rows:4,columns:4});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No roles found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new role."})]})});const u=({columnKey:d,children:m,className:f=""})=>{const x=o.key===d,p=x?o.direction:null;return s.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:h=>{h.target.style.backgroundColor="#214760",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="var(--bs-primary)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:x?"700":"600",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:p,size:14,color:"white"})})]}),x&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(u,{columnKey:"name",className:"show-mobile",children:"Role Name"}),s.jsx(u,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(u,{columnKey:"assignedUsers",className:"show-mobile",children:"Assigned Users"}),s.jsx(u,{columnKey:"lastModified",className:"show-mobile",children:"Last Modified"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:l.map((d,m)=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:d.name}),s.jsx("td",{className:"show-mobile",children:s.jsxs(Ne,{bg:d.status==="Active"?"success":"secondary",className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:d.status==="Active"?"":""}),d.status]})}),s.jsx("td",{className:"show-mobile",children:d.assignedUsers}),s.jsx("td",{className:"show-mobile",children:d.lastModified}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(r,{role:d})})]},d.id))})]})})},wo=e=>e===!0||e==="ACTIVE",xH=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1),[c,u]=v.useState(null),[d,m]=v.useState("view"),[f,x]=v.useState(!1),[p,h]=v.useState(null);v.useEffect(()=>{(async()=>{x(!0);try{const D=await Ws.getRoles({includeDeleted:!0}),R=(Array.isArray(D)?D:D?.roles||[]).map(M=>({id:M.id,name:M.name,description:M.description||"",assignedUsers:M.userCount||0,status:wo(M.isActive)?"Active":"Inactive",createdAt:M.createdAt?M.createdAt.split("T")[0]:"",lastModified:M.updatedAt?M.updatedAt.split("T")[0]:"",isActive:M.isActive,permissions:M.permissions||[],originalData:M}));t(R),h(null)}catch(D){const P=Va(D,{});h(P),console.error("Error fetching roles:",D)}finally{x(!1)}})()},[]);const g=A=>a(A),b=A=>{i(A==="clear"?[]:D=>D.includes(A)?D.filter(P=>P!==A):[...D,A])},j=()=>{i([])},y=async A=>{try{x(!0);const D=await Ws.getRoleById(A.id);u(D),m("view"),o(!0)}catch(D){const P=Va(D,{});h(P),console.error("Error fetching role details:",D)}finally{x(!1)}},w=async A=>{try{x(!0);const D=await Ws.getRoleById(A.id),P={id:D.id,name:D.name,description:D.description||"",assignedUsers:D.userCount||0,status:wo(D.isActive)?"Active":"Inactive",createdAt:D.createdAt?D.createdAt.split("T")[0]:"",lastModified:D.updatedAt?D.updatedAt.split("T")[0]:"",isActive:D.isActive,permissions:D.permissions||[],originalData:D};u(P),m("edit"),o(!0),h(null)}catch(D){const P=Va(D,{});h(P)}finally{x(!1)}},N=()=>{u(null),m("add"),o(!0)},S=async A=>{if(window.confirm("Are you sure you want to delete this role?")){x(!0);try{await new Promise(D=>setTimeout(D,1e3)),t(D=>D.filter(P=>P.id!==A)),h(null)}catch{h("Failed to delete role")}finally{x(!1)}}},E=async A=>{x(!0);try{d==="add"?(await Ws.createRole(A),te.success("Role created successfully!")):(await Ws.updateRole(c.id,A),te.success("Role updated successfully!"));const D=await Ws.getRoles({includeDeleted:!0}),R=(Array.isArray(D)?D:D?.roles||[]).map(M=>({id:M.id,name:M.name,description:M.description||"",assignedUsers:M.userCount||0,status:wo(M.isActive)?"Active":"Inactive",createdAt:M.createdAt?M.createdAt.split("T")[0]:"",lastModified:M.updatedAt?M.updatedAt.split("T")[0]:"",isActive:M.isActive,originalData:M}));t(R),o(!1),u(null),h(null)}catch(D){const P=Va(D,{});h(P),te.error(P)}finally{x(!1)}},_=async A=>{x(!0);try{const D=e.find(me=>me.id===A);if(!D)throw new Error("Role not found");let P,R;wo(D.isActive)?(P=await Ws.disableRole(A),R="disabled"):(P=await Ws.enableRole(A),R="enabled");const X=await Ws.getRoles({includeDeleted:!0}),ae=(Array.isArray(X)?X:X?.roles||[]).map(me=>({id:me.id,name:me.name,description:me.description||"",assignedUsers:me.userCount||0,status:wo(me.isActive)?"Active":"Inactive",createdAt:me.createdAt?me.createdAt.split("T")[0]:"",lastModified:me.updatedAt?me.updatedAt.split("T")[0]:"",isActive:me.isActive,originalData:me}));t(ae);const V=P?.message||`Role has been ${R} successfully!`;te.success(V),h(null)}catch(D){const P=Va(D,{});h(P)}finally{x(!1)}},T=[...new Set(e.map(A=>A.status))];return{roles:e.filter(A=>{const D=A.name.toLowerCase().includes(r.toLowerCase()),P=n.length===0||n.includes(A.status);return D&&P}),loading:f,error:p,searchTerm:r,selectedStatuses:n,uniqueStatuses:T,modalShow:l,selectedRole:c,modalMode:d,handleSearch:g,handleStatusToggle:b,handleClearFilters:j,handleView:y,handleEdit:w,handleAdd:N,handleDelete:S,handleSave:E,handleDisable:_,handleModalClose:()=>o(!1),setError:h}},gH=()=>{const[e,t]=v.useState(!1),[r,a]=v.useState(null),[n,i]=v.useState(!1),{roles:l,loading:o,error:c,searchTerm:u,selectedStatuses:d,uniqueStatuses:m,modalShow:f,selectedRole:x,modalMode:p,handleSearch:h,handleStatusToggle:g,handleClearFilters:b,handleView:j,handleEdit:y,handleAdd:w,handleSave:N,handleDisable:S,handleModalClose:E}=xH(),_=D=>{a(D),t(!0)},T=async()=>{if(r){i(!0);try{await S(r.id),t(!1),a(null)}catch(D){console.error("Error disabling role:",D)}finally{i(!1)}}},C=()=>{t(!1),a(null)},A=({role:D})=>s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>j(D)},{label:"Edit Role",icon:s.jsx(ts,{}),onClick:()=>y(D)},...D.name.toUpperCase()!=="ADMINISTRATOR"?[{type:"divider"},{label:D.status==="Active"?"Disable Role":"Enable Role",icon:s.jsx(Sc,{}),className:D.status==="Active"?"text-warning":"text-success",onClick:()=>_(D)}]:[]]});return J.useEffect(()=>{c&&te.error(c)},[c]),s.jsx(_e,{fluid:!0,className:"py-4 role-management-page",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(oe,{className:"align-items-center",children:s.jsx(U,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(Ar,{permission:fe.CREATE_ROLE,fallback:null,children:s.jsxs(se,{variant:"primary-custom",size:"sm",onClick:w,className:"d-flex align-items-center",children:[s.jsx(Xr,{className:"me-1",size:16}),"Add Role"]})})})})})}),s.jsxs(H.Body,{children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search roles by name...",value:u,onChange:h,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(mH,{uniqueStatuses:m,selectedStatuses:d,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[l.length," role",l.length!==1?"s":""]})})})]}),s.jsx(pH,{roles:l,loading:o,actionsComponent:A,onView:j,onEdit:y,onDisable:S}),s.jsx(hH,{show:f,role:x,mode:p,onSave:N,onClose:E}),s.jsx(uH,{show:e,role:r,onConfirm:T,onCancel:C,loading:n})]})]})})},vH=({show:e,department:t,onClose:r})=>{if(!e||!t)return null;const a=n=>{switch(n){case"CCT":return"bg-info";case"FCTD":return"bg-success";case"GOT":return"bg-warning";case"SQA":return"bg-secondary";default:return"bg-dark"}};return s.jsxs(le,{show:e,onHide:r,size:"lg",centered:!0,style:{maxHeight:"100vh"},children:[s.jsx(le.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Ls,{className:"me-2",size:20}),"Department Details"]})}),s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(oe,{className:"mb-4",children:[s.jsxs(U,{md:8,children:[s.jsx("h3",{className:"fw-bold text-dark mb-2",children:t.name}),s.jsx("p",{className:"text-muted mb-3",children:t.description})]}),s.jsx(U,{md:4,className:"text-end",children:s.jsx(Ne,{bg:t.status==="ACTIVE"?"success":"secondary",className:"px-3 py-2 fs-6",children:t.status})})]}),s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Code"}),s.jsx("div",{className:"p-3 bg-light rounded",children:s.jsx(Ne,{bg:"primary",className:"px-3 py-2 fs-6",children:t.code})})]})}),s.jsx(U,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Type"}),s.jsx("div",{className:"p-3 bg-light rounded",children:s.jsx(Ne,{bg:a(t.type).replace("bg-",""),className:"px-3 py-2 fs-6",children:t.type})})]})})]}),s.jsx(oe,{className:"mb-4",children:s.jsx(U,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Head"}),s.jsx("div",{className:"p-3 bg-light rounded",children:t.departmentHead?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ia,{className:"me-3 text-primary",size:24}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold text-dark",children:t.departmentHead.name}),s.jsx("div",{className:"text-muted",children:t.departmentHead.email})]})]}):s.jsx("span",{className:"text-muted italic",children:"Not assigned"})})]})})}),s.jsx(oe,{className:"mb-4",children:s.jsxs(U,{md:12,children:[s.jsx("label",{className:"form-label fw-semibold text-dark mb-3",children:"Department Statistics"}),s.jsxs(oe,{children:[s.jsx(U,{md:4,children:s.jsxs("div",{className:"bg-primary bg-opacity-10 p-4 rounded text-center",children:[s.jsx(It,{className:"text-primary mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-primary mb-1",children:t.coursesCount||0}),s.jsx("div",{className:"text-primary fw-semibold",children:"Courses"})]})}),s.jsx(U,{md:4,children:s.jsxs("div",{className:"bg-success bg-opacity-10 p-4 rounded text-center",children:[s.jsx($r,{className:"text-success mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-success mb-1",children:t.traineesCount||0}),s.jsx("div",{className:"text-success fw-semibold",children:"Trainees"})]})}),s.jsx(U,{md:4,children:s.jsxs("div",{className:"bg-info bg-opacity-10 p-4 rounded text-center",children:[s.jsx(Ia,{className:"text-info mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-info mb-1",children:t.trainersCount||0}),s.jsx("div",{className:"text-info fw-semibold",children:"Trainers"})]})})]})]})}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Created Date"}),s.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.createdAt).toLocaleDateString()})]})}),s.jsx(U,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Last Updated"}),s.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.updatedAt).toLocaleDateString()})]})})]})]}),s.jsx(le.Footer,{className:"border-0 p-4",children:s.jsxs("button",{className:"btn btn-secondary",onClick:r,children:[s.jsx(Xe,{className:"me-2",size:16}),"Close"]})})]})},bH=({uniqueTypes:e,uniqueStatuses:t,selectedTypes:r,selectedStatuses:a,onTypeToggle:n,onStatusToggle:i,onClearFilters:l,className:o=""})=>{const c=r.length>0||a.length>0;return s.jsxs(kt,{className:`filter-panel-dropdown ${o}`,children:[s.jsx(kt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ol,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(kt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Department Code"}),r.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(u=>s.jsx(I.Check,{type:"checkbox",id:`type-${u}`,label:u,checked:r.includes(u),onChange:()=>n(u),className:"mb-1"},u))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),a.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(u=>s.jsx(I.Check,{type:"checkbox",id:`status-${u}`,label:u,checked:a.includes(u),onChange:()=>i(u),className:"mb-1"},u))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:l,children:[s.jsx(Xe,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},yH=({show:e,department:t,mode:r,onSave:a,onClose:n,availableUsers:i})=>{const[l,o]=v.useState({name:"",code:"",description:"",departmentHeadId:""}),[c,u]=v.useState({}),[d,m]=v.useState(!1);v.useEffect(()=>{t&&r!=="add"?o({name:t.name||"",code:t.code||"",description:t.description||"",departmentHeadId:t.departmentHeadId||""}):r==="add"&&o({name:"",code:"",description:"",departmentHeadId:""}),u({})},[t,r,e]);const f=()=>{const b={};return l.name.trim()?l.name.trim().length<3?b.name="Department name must be at least 3 characters":/^[a-zA-Z0-9\s]+$/.test(l.name.trim())||(b.name="Department name cannot contain special characters"):b.name="Department name is required",l.code.trim()||(b.code="Department code is required"),l.departmentHeadId||(b.departmentHeadId="Department head is required"),u(b),Object.keys(b).length===0},x=async b=>{if(b.preventDefault(),!!f()){m(!0);try{const j={name:l.name.trim(),code:l.code.trim(),description:l.description.trim(),headUserId:l.departmentHeadId};console.log(" Department data being sent:",j),await a(j)}catch(j){console.error("Error saving department:",j)}finally{m(!1)}}},p=(b,j)=>{o(y=>({...y,[b]:j})),c[b]&&u(y=>({...y,[b]:""}))},h=()=>{switch(r){case"add":return"Add New Department";case"edit":return"Edit Department";case"view":return"Department Details";default:return"Department"}},g=r==="view";return s.jsxs(le,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(le.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(St,{className:"me-2",size:20}):s.jsx(hs,{className:"me-2",size:20}),h()]})}),s.jsxs(I,{onSubmit:x,children:[s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(c).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(c).map(([b,j])=>s.jsx("li",{children:j},b))})]}),s.jsxs(oe,{children:[s.jsx(U,{md:8,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Department Name *"}),s.jsx(I.Control,{type:"text",value:l.name,onChange:b=>p("name",b.target.value),isInvalid:!!c.name,readOnly:g,placeholder:"Enter department name",style:{borderColor:c.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:c.name})]})}),s.jsx(U,{md:4,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Department Code *"}),s.jsx(I.Control,{type:"text",value:l.code,onChange:b=>p("code",b.target.value.toUpperCase()),isInvalid:!!c.code,readOnly:g,placeholder:"e.g., CCT",style:{borderColor:c.code?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(I.Control.Feedback,{type:"invalid",children:c.code})]})})]}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Department Head *"}),s.jsxs(I.Select,{value:l.departmentHeadId,onChange:b=>p("departmentHeadId",b.target.value),isInvalid:!!c.departmentHeadId,disabled:g,style:{borderColor:c.departmentHeadId?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:"Select department head"}),i.map(b=>s.jsxs("option",{value:b.id,children:[b.firstName," ",b.lastName," (",b.eid,")"]},b.id))]}),s.jsx(I.Control.Feedback,{type:"invalid",children:c.departmentHeadId})]})})}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Description"}),s.jsx(I.Control,{as:"textarea",rows:4,value:l.description,onChange:b=>p("description",b.target.value),readOnly:g,placeholder:"Enter department description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),r==="view"&&t&&s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Courses Count"}),s.jsx(I.Control,{type:"text",value:t.coursesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Trainees Count"}),s.jsx(I.Control,{type:"text",value:t.traineesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Trainers Count"}),s.jsx(I.Control,{type:"text",value:t.trainersCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"text-primary-custom fw-semibold",children:"Created Date"}),s.jsx(I.Control,{type:"text",value:new Date(t.createdAt).toLocaleDateString(),readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:d,children:[s.jsx(Xe,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(se,{variant:"primary-custom",type:"submit",disabled:d,children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),r==="add"?"Add Department":"Save Changes"]})})]})]})]})},jH=({department:e,index:t,onView:r,onToggleStatus:a})=>{const n=l=>l==="ACTIVE"?"success":"secondary",i=l=>l==="ACTIVE"?"":"";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:e.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ne,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.code})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.departmentHead?.name||"Not assigned"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.coursesCount})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.traineesCount})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.trainersCount})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs(Ne,{bg:n(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:i(e.status)}),e.status]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.VIEW_DEPARTMENT_IN_DETAIL,fe.UPDATE_DEPARTMENT],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[...e.status==="ACTIVE"?[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>r(e),permission:fe.VIEW_DEPARTMENT_IN_DETAIL}]:[],...e.status==="ACTIVE"?[{type:"divider"}]:[],{label:e.status==="ACTIVE"?"Deactivate":"Activate",icon:s.jsx(Sc,{}),className:e.status==="ACTIVE"?"text-danger":"text-success",onClick:()=>a(e),permission:fe.UPDATE_DEPARTMENT}]})})})]})},wH=({departments:e,loading:t,onView:r,onToggleStatus:a})=>{const{sortedData:n,sortConfig:i,handleSort:l}=ur(e);if(t)return s.jsx(zt,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No departments found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new department."})]})});const o=({columnKey:c,children:u,className:d=""})=>{const m=i.key===c,f=m?i.direction:null;return s.jsxs("th",{className:`fw-semibold ${d}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>l(c),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"600":"500",color:"white"},children:u}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:f,size:14,color:"white"})})]}),m&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive table-padded",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(o,{columnKey:"name",className:"show-mobile",children:"Department Name"}),s.jsx(o,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(o,{columnKey:"departmentHead.name",className:"hide-mobile",children:"Department Head"}),s.jsx(o,{columnKey:"coursesCount",className:"hide-mobile",children:"Courses"}),s.jsx(o,{columnKey:"traineesCount",className:"hide-mobile",children:"Trainees"}),s.jsx(o,{columnKey:"trainersCount",className:"hide-mobile",children:"Trainers"}),s.jsx(o,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:n.map((c,u)=>s.jsx(jH,{department:c,index:u,onView:r,onToggleStatus:a},c.id))})]})})},NH=({show:e,department:t,onConfirm:r,onCancel:a,isProcessing:n})=>{const[i,l]=v.useState({courseCount:0,traineeCount:0,trainerCount:0}),[o,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(null);v.useEffect(()=>{e&&t?.id&&x()},[e,t?.id]);const x=async()=>{if(t?.id){c(!0);try{const j=await Mt.getDepartmentById(t.id);console.log(" DisableDepartmentModal - Full API response:",j),console.log(" DisableDepartmentModal - Department Head data:",j.departmentHead||j.headUser),d(j);const y=j.departmentHead||j.headUser;if(y&&y.id&&!y.eid)try{const w=await $s.getUserById(y.id);console.log(" DisableDepartmentModal - Head User detail from API:",w),f(w)}catch(w){console.warn(" Could not fetch headUser detail:",w)}l({courseCount:j.courseCount||j.coursesCount||0,traineeCount:j.traineeCount||j.traineesCount||0,trainerCount:j.trainerCount||j.trainersCount||0})}catch(j){console.error("Error fetching department statistics:",j),d(null),f(null),l({courseCount:t.courseCount||t.coursesCount||0,traineeCount:t.traineeCount||t.traineesCount||0,trainerCount:t.trainerCount||t.trainersCount||0})}finally{c(!1)}}};if(!t)return null;const p=t.status==="ACTIVE",h=p?"deactivate":"activate",g=p?"Deactivate":"Activate",b=!p||i.courseCount===0&&i.traineeCount===0&&i.trainerCount===0;return s.jsxs(le,{show:e,onHide:a,centered:!0,children:[s.jsx(le.Header,{className:"border-0 pb-0",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Er,{className:"me-2 text-warning",size:20}),g," Department"]})}),s.jsxs(le.Body,{className:"pt-0",children:[s.jsx(ke,{variant:p?"warning":"info",className:"mb-3",style:{backgroundColor:"#e3f2fd",borderColor:"#1b3c53",color:"#1b3c53"},children:s.jsx("div",{className:"d-flex align-items-start",children:s.jsxs("div",{children:[s.jsxs("strong",{children:["Are you sure you want to ",h," this department?"]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Department:"})," ",t.name," (",t.code,")"]}),p&&s.jsx("div",{className:"mt-2",children:b?s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Warning:"})," Deactivating this department will:",s.jsxs("ul",{className:"mb-0 mt-1",children:[s.jsx("li",{children:"Make it unavailable for new course assignments"}),s.jsx("li",{children:"Hide it from department selection dropdowns"}),s.jsx("li",{children:"Not affect existing courses and users"})]})]}):s.jsxs("div",{className:"text-danger",children:[s.jsx("strong",{children:"Cannot deactivate:"})," This department has active courses, trainees, or trainers. Please remove all courses, trainees, and trainers before deactivating."]})}),!p&&s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Note:"})," Activating this department will make it available for:",s.jsxs("ul",{className:"mb-0 mt-1",children:[s.jsx("li",{children:"New course assignments"}),s.jsx("li",{children:"Department selection in forms"}),s.jsx("li",{children:"User management operations"})]})]})]})})}),s.jsxs("div",{className:"bg-light p-4 rounded",children:[s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("strong",{className:"mb-1",children:"Department Head:"}),s.jsx("span",{className:"text-muted text-break",children:(()=>{const j=u||t;let y=j.departmentHead||j.headUser;if(y&&m&&(y={...y,...m}),y){console.log(" Department Head object:",y);let w="";if(y.name)w=y.name;else if(y.firstName||y.lastName){const S=[];y.firstName&&S.push(y.firstName),y.middleName&&S.push(y.middleName),y.lastName&&S.push(y.lastName),w=S.join(" ").trim()}else y.fullName&&(w=y.fullName);const N=m?.eid||m?.employeeId||y.eid||y.employeeId||"";if(console.log(" Name:",w,"EID:",N||"NOT FOUND"),w&&N)return`${w} [${N}]`;if(w)return w;if(N)return`[${N}]`;if(y.email)return console.warn(" No name or EID found in headUser object, showing email as fallback"),console.warn(" headUser object keys:",Object.keys(y)),y.email}return"N/A"})()})]})}),s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("strong",{className:"mb-1",children:"Current Status:"}),s.jsx("span",{className:`badge ${t.status==="ACTIVE"?"bg-success":"bg-secondary"}`,style:{width:"fit-content",backgroundColor:t.status==="ACTIVE"?"#28a745":"#1b3c53"},children:t.status})]})})]}),s.jsx("hr",{className:"my-3"}),s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[o?s.jsx(xt,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.courseCount}),s.jsx("small",{className:"text-muted",children:"Courses"})]})}),s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[o?s.jsx(xt,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.traineeCount}),s.jsx("small",{className:"text-muted",children:"Trainees"})]})}),s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[o?s.jsx(xt,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.trainerCount}),s.jsx("small",{className:"text-muted",children:"Trainers"})]})})]})]})]}),s.jsxs(le.Footer,{className:"border-0",children:[s.jsxs(se,{variant:"outline-secondary",onClick:a,disabled:n,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:p?"warning":"success",onClick:r,disabled:n||p&&!b,style:{backgroundColor:p?"#ffc107":"#28a745",borderColor:p?"#ffc107":"#28a745",opacity:p&&!b?.5:1},children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"me-2",size:16}),p&&!b?"Cannot Deactivate":`${g} Department`]})})]})]})},SH=()=>{const e=Ge(),{departments:t,loading:r,searchTerm:a,setSearchTerm:n,createDepartment:i,updateDepartment:l,disableDepartment:o,enableDepartment:c,getAvailableUsers:u}=Qx(),[d,m]=v.useState(!1),[f,x]=v.useState(!1),[p,h]=v.useState(!1),[g,b]=v.useState("add"),[j,y]=v.useState(null),[w,N]=v.useState([]),[S,E]=v.useState([]),[_,T]=v.useState([]);v.useEffect(()=>{(async()=>{try{const O=await u();T(O)}catch(O){console.error("Error loading available users:",O),T([])}})()},[u]);const C=()=>{y(null),b("add"),m(!0)},A=k=>{e(he.DEPARTMENTS_DETAIL(k.id))},D=k=>{y(k),x(!0)},P=()=>{m(!1),y(null),b("add")},R=()=>{x(!1),y(null)},M=()=>{h(!1),y(null)},X=async k=>{try{g==="add"?(await i(k),te.success("Department created successfully")):g==="edit"&&(await l(j.id,k),te.success("Department updated successfully")),P()}catch(O){console.error("Error saving department:",O);const G=O?.response?.data;let Z=O?.message||"Failed to save department";if(G?.message&&(Array.isArray(G.message)?Z=G.message.map(ee=>ee.message||ee).join(", "):Z=G.message),G?.errors&&Array.isArray(G.errors)){const ee=G.errors.map(de=>de.message||JSON.stringify(de)).filter(Boolean).join(", ");ee&&(Z=ee)}te.error(Z)}},ie=async()=>{try{j&&(j.status==="ACTIVE"?(await o(j.id),te.success("Department disabled successfully")):(await c(j.id),te.success("Department enabled successfully")),R())}catch(k){console.error("Error toggling department status:",k),te.error("Failed to toggle department status")}},ae=k=>{n(k)},V=k=>{N(k==="clear"?[]:O=>O.includes(k)?O.filter(G=>G!==k):[...O,k])},me=k=>{E(k==="clear"?[]:O=>O.includes(k)?O.filter(G=>G!==k):[...O,k])},ue=()=>{N([]),E([])},F=[...new Set(t.map(k=>k.type).filter(Boolean))],Y=["ACTIVE","INACTIVE"],z=t.filter(k=>{const O=w.length===0||w.includes(k.type),G=S.length===0||S.includes(k.status);return O&&G});return s.jsxs(_e,{fluid:!0,className:"py-4 department-management-page",children:[s.jsxs(H,{className:"shadow-sm",children:[s.jsx(H.Header,{className:"bg-white border-0 pb-0",children:s.jsx(oe,{className:"align-items-center",children:s.jsx(U,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(Ar,{permission:fe.CREATE_DEPARTMENT,fallback:null,children:s.jsxs(se,{variant:"primary-custom",size:"sm",onClick:C,className:"d-flex align-items-center",children:[s.jsx(Xr,{className:"me-1",size:16}),"Add Department"]})})})})})}),s.jsxs(H.Body,{children:[s.jsxs(oe,{className:"mb-4 form-mobile-stack",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search departments by name, code, or description...",value:a,onChange:ae,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(bH,{uniqueTypes:F,uniqueStatuses:Y,selectedTypes:w,selectedStatuses:S,onTypeToggle:V,onStatusToggle:me,onClearFilters:ue,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[z.length," department",z.length!==1?"s":""]})})})]}),s.jsx("div",{className:"position-relative mt-3",children:s.jsx(wH,{departments:z,loading:r,onView:A,onToggleStatus:D})})]})]}),d&&s.jsx(yH,{show:d,department:j,mode:g,onSave:X,onClose:P,availableUsers:_}),f&&j&&s.jsx(NH,{show:f,department:j,onConfirm:ie,onCancel:R,isProcessing:r}),p&&j&&s.jsx(vH,{show:p,department:j,onClose:M})]})},EH=({department:e,onBack:t})=>s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-start mb-3",children:[s.jsx(se,{variant:"outline-secondary",onClick:t,className:"me-3 mt-1",size:"sm",children:s.jsx(At,{})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:e.name}),s.jsx("p",{className:"text-muted mb-0",children:e.description})]})]})})}),TH=({activeTab:e,onTabChange:t})=>{const r=[{id:"info",label:"Department Info",icon:J2,description:"View department overview"},{id:"edit",label:"Edit Details",icon:ts,description:"Modify department information"}];return s.jsxs("div",{className:"department-tabs",children:[s.jsx("div",{className:"tab-navigation",children:r.map(a=>{const n=a.icon,i=e===a.id;return s.jsxs("button",{className:`tab-button ${i?"active":""}`,onClick:()=>t(a.id),children:[s.jsx("div",{className:"tab-icon",children:s.jsx(n,{size:20})}),s.jsxs("div",{className:"tab-content",children:[s.jsx("div",{className:"tab-label",children:a.label}),s.jsx("div",{className:"tab-description",children:a.description})]}),i&&s.jsx("div",{className:"tab-indicator"})]},a.id)})}),s.jsx("div",{className:"tab-separator"})]})},AH=e=>({id:e.id,name:e.name,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),CH=({department:e,onUpdate:t})=>{const[r,a]=v.useState({name:e.name||"",description:e.description||"",headUserId:e.headUserId||""}),[n,i]=v.useState(!1),[l,o]=v.useState([]);v.useEffect(()=>{(async()=>{try{o([])}catch(m){console.error("Error loading department heads:",m),te.error("Failed to load department heads"),o([])}})()},[]);const c=d=>{const{name:m,value:f}=d.target;a(x=>({...x,[m]:f}))},u=async d=>{d.preventDefault(),i(!0);try{if(!r.name||r.name.trim()===""){te.error("Department name is required"),i(!1);return}console.log(" Submitting department update:",{departmentId:e.id,formData:r});const m=await Mt.updateDepartment(e.id,r),f=AH(m);t(f),te.success("Department updated successfully!")}catch(m){console.error(" Error updating department:",m);let f="Failed to update department";m.code==="NETWORK_ERROR"?f="Network error: Unable to connect to server. Please check your connection.":m.code==="BAD_GATEWAY"?f="Server error (502): The server is temporarily unavailable. Please try again later.":m.code==="PERMISSION_DENIED"?f="Permission denied: You do not have permission to update this department.":m.response?.data?.message?f=m.response.data.message:m.message&&(f=m.message),te.error(f)}finally{i(!1)}};return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Edit Department Details"}),s.jsxs("form",{onSubmit:u,children:[s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"name",className:"form-label",children:"Department Name"}),s.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",value:r.name,onChange:c,required:!0})]})})}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"headUserId",className:"form-label",children:"Department Head"}),s.jsxs("select",{className:"form-select",id:"headUserId",name:"headUserId",value:r.headUserId,onChange:c,children:[s.jsx("option",{value:"",children:"Select Department Head"}),Array.isArray(l)&&l.map(d=>s.jsxs("option",{value:d.id,children:["[",d.eid,"] - ",d.firstName," ",d.lastName]},d.id))]})]})})}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),s.jsx("textarea",{className:"form-control",id:"description",name:"description",rows:"4",value:r.description,onChange:c})]}),s.jsx("div",{className:"d-flex gap-2",children:s.jsx(se,{type:"submit",variant:"primary",disabled:n,children:n?"Updating...":"Update Department"})})]})]})},Sy=({department:e})=>{const t=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return s.jsxs("div",{className:"department-info",children:[s.jsx("h4",{className:"mb-4",children:"Department Overview"}),s.jsxs(oe,{className:"g-4",children:[s.jsx(U,{md:6,children:s.jsxs("div",{className:"info-card info-card-basic",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(It,{className:"info-icon"}),s.jsx("h6",{children:"Basic Information"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Name:"}),s.jsx("span",{className:"info-value",children:e.name})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Code:"}),s.jsx("span",{className:"info-value",children:e.code||"N/A"})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Description:"}),s.jsx("span",{className:"info-value",children:e.description||"No description provided"})]})]})]})}),s.jsx(U,{md:6,children:s.jsxs("div",{className:"info-card info-card-statistics",children:[s.jsxs("div",{className:"info-header",children:[s.jsx($r,{className:"info-icon"}),s.jsx("h6",{children:"Department Statistics"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Courses:"}),s.jsx("span",{className:"info-value",children:e.courseCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Trainees:"}),s.jsx("span",{className:"info-value",children:e.traineeCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Trainers:"}),s.jsx("span",{className:"info-value",children:e.trainerCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Head of Department:"}),s.jsx("span",{className:"info-value",children:e.headUser?`${e.headUser.firstName} ${e.headUser.lastName}`:"Not assigned"})]})]})]})}),s.jsx(U,{md:6,children:s.jsxs("div",{className:"info-card info-card-timeline",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(xr,{className:"info-icon"}),s.jsx("h6",{children:"Timeline"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Created:"}),s.jsx("span",{className:"info-value",children:t(e.createdAt)})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Last Updated:"}),s.jsx("span",{className:"info-value",children:t(e.updatedAt)})]}),e.deletedAt&&s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Deleted:"}),s.jsx("span",{className:"info-value",children:t(e.deletedAt)})]})]})]})})]})]})},_H=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,trainers:e.trainers||[],createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),kH=()=>{const{id:e}=gr(),t=Ge(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState("info"),d=v.useCallback(async()=>{if(!e){te.error("Department ID is required"),i(!1);return}i(!0),o(null);try{const p=await Mt.getDepartmentById(e),h=_H(p);a(h)}catch(p){console.error("Error loading department:",p),te.error("Failed to load department details"),o("Failed to load department details")}finally{i(!1)}},[e]);v.useEffect(()=>{d()},[d]);const m=()=>{t(he.DEPARTMENTS)},f=p=>{u(p)};if(n)return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:s.jsx(xt,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(l)return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsxs("div",{className:"text-danger mb-3",children:[s.jsx("h5",{children:"Unable to load department"}),s.jsx("p",{className:"text-muted",children:"Please try again or contact support if the problem persists."})]}),s.jsxs(se,{variant:"outline-primary",onClick:m,children:[s.jsx(At,{className:"me-2"}),"Back to Departments"]})]})});if(!r)return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsxs("div",{className:"text-warning mb-3",children:[s.jsx("h5",{children:"Department not found"}),s.jsx("p",{className:"text-muted",children:"The department you're looking for doesn't exist or has been removed."})]}),s.jsxs(se,{variant:"outline-primary",onClick:m,children:[s.jsx(At,{className:"me-2"}),"Back to Departments"]})]})});const x=()=>{switch(c){case"info":return s.jsx(Sy,{department:r});case"edit":return s.jsx(CH,{department:r,onUpdate:a});default:return s.jsx(Sy,{department:r})}};return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(EH,{department:r,onBack:m}),s.jsx(TH,{activeTab:c,onTabChange:f}),s.jsx(oe,{children:s.jsx(U,{children:s.jsx(H,{className:"shadow-sm",children:s.jsx(H.Body,{className:"p-4",children:x()})})})})]})},DH=({show:e,onClose:t,onSave:r,loading:a=!1})=>{const[n,i]=v.useState({newPassword:"",confirmPassword:""}),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState({show:!1,message:"",variant:"success"}),f=h=>{const{name:g,value:b}=h.target;i(j=>({...j,[g]:b})),d.show&&m({show:!1,message:"",variant:"success"})},x=async h=>{if(h.preventDefault(),n.newPassword!==n.confirmPassword){m({show:!0,message:"New password and confirm password do not match.",variant:"danger"});return}if(n.newPassword.length<6){m({show:!0,message:"New password must be at least 6 characters long.",variant:"danger"});return}try{await r(n),m({show:!0,message:"Password updated successfully!",variant:"success"}),i({newPassword:"",confirmPassword:""}),setTimeout(()=>{t(),m({show:!1,message:"",variant:"success"})},1500)}catch{m({show:!0,message:"Failed to update password. Please check your current password.",variant:"danger"})}},p=()=>{i({newPassword:"",confirmPassword:""}),m({show:!1,message:"",variant:"success"}),t()};return s.jsxs(le,{show:e,onHide:p,size:"md",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary text-white",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Yo,{className:"me-2",size:20}),"Reset Password"]}),s.jsx(se,{variant:"link",className:"text-white p-0",onClick:p,style:{textDecoration:"none"},children:s.jsx(Xe,{size:20})})]}),s.jsxs(le.Body,{className:"p-4",children:[d.show&&s.jsx(ke,{variant:d?.variant,className:"mb-3",children:d?.message}),s.jsxs(I,{onSubmit:x,children:[s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"fw-semibold",children:"New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(I.Control,{type:l?"text":"password",name:"newPassword",value:n.newPassword,onChange:f,required:!0,minLength:6,placeholder:"Enter new password"}),s.jsx(se,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>o(!l),type:"button",children:l?s.jsx(Ko,{size:16}):s.jsx(St,{size:16})})]})]}),s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{className:"fw-semibold",children:"Confirm New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(I.Control,{type:c?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:f,required:!0,minLength:6,placeholder:"Confirm new password"}),s.jsx(se,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>u(!c),type:"button",children:c?s.jsx(Ko,{size:16}):s.jsx(St,{size:16})})]})]}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(se,{variant:"outline-secondary",onClick:p,disabled:a,children:"Cancel"}),s.jsx(se,{type:"submit",variant:"secondary",disabled:a,children:a?"Updating...":s.jsxs(s.Fragment,{children:[s.jsx(Yo,{size:16,className:"me-1"}),"Update Password"]})})]})]})]})]})},IH=({profileData:e,user:t,onResetPassword:r,onAvatarUpdated:a,onConfigureSignature:n})=>{const i=v.useRef(null),[l,o]=v.useState(!1),[c,u]=v.useState(null),d=j=>({ADMIN:"danger",DEPT_HEAD:"primary",TRAINER:"info",TRAINEE:"success",ACADEMIC_DEPT:"warning",ACADEMIC_DEPARTMENT:"warning",SQA_AUDITOR:"secondary"})[j]||"secondary",m=()=>e&&[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||"User Name",f=()=>e?.email||t?.email||"user@example.com",x=()=>{const j=e?.role?.name||t?.role||"USER";return j==="ACADEMIC_DEPARTMENT"||j==="ACADEMIC_DEPT"?"ACADEMIC_DEPT":j},p=c||e?.avatarUrl||"",h=()=>{i.current&&i.current.click()},g=(j,y=200,w=200,N=.8)=>new Promise(S=>{const E=document.createElement("canvas"),_=E.getContext("2d"),T=new window.Image;T.onload=()=>{let{width:C,height:A}=T;C>A?C>y&&(A=A*y/C,C=y):A>w&&(C=C*w/A,A=w),E.width=C,E.height=A,_.drawImage(T,0,0,C,A);const D=E.toDataURL("image/jpeg",N);S(D)},T.src=URL.createObjectURL(j)}),b=async j=>{const y=j.target.files&&j.target.files[0];if(y){if(y.size>5*1024*1024){te.error("File size too large. Please choose an image smaller than 5MB.");return}try{o(!0);const w=await g(y,200,200,.7);u(w);const N=await si.updateAvatar(w,e);te.success("Avatar updated successfully"),a&&a(N)}catch(w){console.error("Update avatar failed:",w),w.response?.status===422?te.error("Invalid avatar format. Please try a different image."):w.response?.status===413?te.error("Image too large. Please choose a smaller image."):te.error("Failed to update avatar. Please try again."),u(null)}finally{o(!1),i.current&&(i.current.value="")}}};return s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[p?s.jsx(F4,{roundedCircle:!0,src:p,alt:"Avatar",style:{width:"120px",height:"120px",objectFit:"cover"}}):s.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center",style:{width:"120px",height:"120px",margin:"0 auto"},children:s.jsx(Ft,{size:48,className:"text-white"})}),s.jsx("button",{className:"position-absolute rounded-circle border border-2 border-white shadow-sm",style:{width:"36px",height:"36px",bottom:"0px",right:"0px",transform:"translate(40%, 30%)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",cursor:"pointer",fontSize:"18px",color:"#456882",fontWeight:"bold",backgroundColor:"#d2c1b6",lineHeight:"1"},onClick:h,disabled:l,children:l?s.jsx(xt,{animation:"border",size:"sm"}):""}),s.jsx("input",{ref:i,type:"file",accept:"image/*",className:"d-none",onChange:b})]}),s.jsx("h4",{className:"mb-1",children:m()}),s.jsx("p",{className:"text-muted mb-2",children:f()}),s.jsx(Ne,{bg:d(x()),className:"mb-3",children:x()}),s.jsxs("div",{className:"text-start",children:[e?.address&&s.jsxs("div",{className:"mb-3",children:[s.jsx("strong",{children:"Address:"}),s.jsx("br",{}),s.jsx("span",{className:"text-muted",children:e.address})]}),s.jsxs("div",{className:"d-flex flex-column gap-2",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:r,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[s.jsx(Yo,{size:14,className:"me-2"}),"Reset Password"]}),x()==="TRAINER"&&s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:n,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[s.jsx(_n,{size:14,className:"me-2"}),"Configure Signature"]})]})]})]})})},OH=({profileData:e,user:t,onUpdate:r})=>{const[a,n]=v.useState(!1),[i,l]=v.useState({firstName:"",lastName:"",middleName:"",email:"",phoneNumber:"",address:"",gender:"",avatarUrl:""}),[o,c]=v.useState(!1);v.useEffect(()=>{if(e&&e.firstName){const m={firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",email:e.email||"",phoneNumber:e.phoneNumber||"",address:e.address||"",gender:e.gender||"",avatarUrl:e.avatarUrl||""};l(m),c(!0)}},[e,o]);const u=m=>{const{name:f,value:x}=m.target;l(p=>({...p,[f]:x}))},d=async m=>{m.preventDefault(),n(!0);try{r?await r(i):(await si.updateProfile(i),te.success("Personal information updated successfully!"))}catch(f){console.error("Error updating personal info:",f),r||te.error("Failed to update personal information. Please try again.")}finally{n(!1)}};return s.jsxs(H,{children:[s.jsx(H.Header,{className:"bg-primary text-white border-0",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{size:20,className:"me-2 text-white"}),s.jsx("h5",{className:"mb-0 text-white",children:"Personal Information"})]})}),s.jsx(H.Body,{children:s.jsxs(I,{onSubmit:d,children:[s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"First Name"}),s.jsx(I.Control,{type:"text",name:"firstName",value:i.firstName,onChange:u,required:!0})]})}),s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Middle Name"}),s.jsx(I.Control,{type:"text",name:"middleName",value:i.middleName,onChange:u})]})}),s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Last Name"}),s.jsx(I.Control,{type:"text",name:"lastName",value:i.lastName,onChange:u,required:!0})]})})]}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Email"}),s.jsx(I.Control,{type:"email",name:"email",value:i.email,onChange:u,required:!0})]})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Phone Number"}),s.jsx(I.Control,{type:"tel",name:"phoneNumber",value:i.phoneNumber,onChange:u})]})})]}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Gender"}),s.jsxs(I.Select,{name:"gender",value:i.gender,onChange:u,children:[s.jsx("option",{value:"",children:"Select Gender"}),s.jsx("option",{value:"MALE",children:"Male"}),s.jsx("option",{value:"FEMALE",children:"Female"})]})]})})}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-12 mb-3",children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Address"}),s.jsx(I.Control,{as:"textarea",rows:3,name:"address",value:i.address,onChange:u,placeholder:"Enter your address"})]})})}),s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(se,{type:"submit",variant:"primary",disabled:a,children:a?"Saving...":s.jsxs(s.Fragment,{children:[s.jsx(hs,{size:16,className:"me-1"}),"Save Changes"]})})})]})})]})},PH=()=>{const{user:e}=xs(),t=Ge(),[r,a]=v.useState(!1),[n,i]=v.useState(!1),[l,o]=v.useState(null),[c,u]=v.useState(!0),d=async()=>{try{u(!0);const p=await si.getProfile();o(p)}catch(p){console.error("Failed to refresh profile:",p)}finally{u(!1)}};v.useEffect(()=>{d()},[]);const m=async p=>{a(!0);try{const h=await si.updateProfile(p);o(h),te.success("Personal information updated successfully!")}catch(h){throw console.error("Error updating profile:",h),te.error("Failed to update personal information. Please try again."),h}finally{a(!1)}},f=async p=>{a(!0);try{const h=await si.resetPassword(p);te.success(h.message||"Password updated successfully!")}catch(h){throw te.error(h.message||"Failed to update password. Please check your current password."),h}finally{a(!1)}},x=()=>{e?.role,t(he.TRAINER_CONFIGURE_SIGNATURE)};return c?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(oe,{children:s.jsx(U,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading profile data..."})]})})})}):s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsxs(oe,{children:[s.jsx(U,{lg:4,className:"mb-4",children:s.jsx(IH,{profileData:l,user:e,onResetPassword:()=>i(!0),onAvatarUpdated:d,onConfigureSignature:x})}),s.jsx(U,{lg:8,className:"mb-4",children:s.jsx(OH,{profileData:l,user:e,onUpdate:m})})]}),s.jsx(DH,{show:n,onClose:()=>i(!1),onSave:f,loading:r})]})},RH=()=>{const{user:e}=xs(),t=Ge(),{departments:r,loading:a,error:n}=Qx(),i=r.filter(o=>o.status==="ACTIVE"),l=o=>{t(`/academic/course/${o}`)};return s.jsx("div",{className:"course-selection",style:{paddingBottom:"2rem"},children:s.jsxs(_e,{className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ls,{size:48,className:"text-primary mb-3"}),s.jsx("h2",{className:"mb-2",children:"Academic Department Management"}),s.jsx("p",{className:"text-muted",children:"Select a department to view its details, including list of courses and related subjects"}),s.jsxs("p",{className:"text-muted small",children:["Total Departments: ",s.jsx("strong",{children:i.length})]})]})})}),s.jsx(oe,{className:"mb-5",children:a?s.jsxs(U,{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading departments..."})]}):n?s.jsx(U,{className:"text-center py-5",children:s.jsxs("p",{className:"text-danger",children:["Error loading departments: ",n.message]})}):i.map(o=>s.jsx(U,{md:6,lg:4,className:"mb-4",children:s.jsx(H,{className:"h-100 border-0 shadow-sm course-card d-flex flex-column",children:s.jsxs(H.Body,{className:"p-4 d-flex flex-column h-100",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"course-icon me-3",children:s.jsx(It,{size:24,className:"text-primary"})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h5",{className:"mb-1",children:o.name}),s.jsx(Ne,{bg:"secondary",className:"text-white",children:o.code})]})]}),s.jsx("div",{className:"text-muted description-container",children:o.description||s.jsx("span",{className:"text-muted fst-italic",children:"No description available"})}),s.jsxs(se,{variant:"outline-primary",className:"w-100",onClick:()=>l(o.id),children:["View Details",s.jsx(un,{size:16,className:"ms-2"})]})]})})},o.id))})]})})};var gf={},vf={},Ey;function LH(){return Ey||(Ey=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(vf)),vf}var bf={},Ty;function rA(){return Ty||(Ty=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(bf)),bf}var yf={},Ay;function $g(){return Ay||(Ay=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(yf)),yf}var jf={},wf={},Cy;function FH(){return Cy||(Cy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const a=String(r);return a==="0"&&Object.is(Number(r),-0)?"-0":a}e.toString=t})(wf)),wf}var _y;function Wg(){return _y||(_y=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FH(),r=$g();function a(n){if(Array.isArray(n))return n.map(r.toKey);if(typeof n=="symbol")return[n];n=t.toString(n);const i=[],l=n.length;if(l===0)return i;let o=0,c="",u="",d=!1;for(n.charCodeAt(0)===46&&(i.push(""),o++);o<l;){const m=n[o];u?m==="\\"&&o+1<l?(o++,c+=n[o]):m===u?u="":c+=m:d?m==='"'||m==="'"?u=m:m==="]"?(d=!1,i.push(c),c=""):c+=m:m==="["?(d=!0,c&&(i.push(c),c="")):m==="."?c&&(i.push(c),c=""):c+=m,o++}return c&&i.push(c),i}e.toPath=a})(jf)),jf}var ky;function Hg(){return ky||(ky=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LH(),r=rA(),a=$g(),n=Wg();function i(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?i(o,n.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=a.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return l(o,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function l(o,c,u){if(c.length===0)return u;let d=o;for(let m=0;m<c.length;m++){if(d==null||t.isUnsafeProperty(c[m]))return u;d=d[c[m]]}return d===void 0?u:d}e.get=i})(gf)),gf}var Nf,Dy;function MH(){return Dy||(Dy=1,Nf=Hg().get),Nf}var BH=MH();const rl=fi(BH);var Sf={exports:{}},ar={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iy;function zH(){if(Iy)return ar;Iy=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,m=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,x=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,h=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,j=e?Symbol.for("react.scope"):60119;function y(N){if(typeof N=="object"&&N!==null){var S=N.$$typeof;switch(S){case t:switch(N=N.type,N){case c:case u:case a:case i:case n:case m:return N;default:switch(N=N&&N.$$typeof,N){case o:case d:case p:case x:case l:return N;default:return S}}case r:return S}}}function w(N){return y(N)===u}return ar.AsyncMode=c,ar.ConcurrentMode=u,ar.ContextConsumer=o,ar.ContextProvider=l,ar.Element=t,ar.ForwardRef=d,ar.Fragment=a,ar.Lazy=p,ar.Memo=x,ar.Portal=r,ar.Profiler=i,ar.StrictMode=n,ar.Suspense=m,ar.isAsyncMode=function(N){return w(N)||y(N)===c},ar.isConcurrentMode=w,ar.isContextConsumer=function(N){return y(N)===o},ar.isContextProvider=function(N){return y(N)===l},ar.isElement=function(N){return typeof N=="object"&&N!==null&&N.$$typeof===t},ar.isForwardRef=function(N){return y(N)===d},ar.isFragment=function(N){return y(N)===a},ar.isLazy=function(N){return y(N)===p},ar.isMemo=function(N){return y(N)===x},ar.isPortal=function(N){return y(N)===r},ar.isProfiler=function(N){return y(N)===i},ar.isStrictMode=function(N){return y(N)===n},ar.isSuspense=function(N){return y(N)===m},ar.isValidElementType=function(N){return typeof N=="string"||typeof N=="function"||N===a||N===u||N===i||N===n||N===m||N===f||typeof N=="object"&&N!==null&&(N.$$typeof===p||N.$$typeof===x||N.$$typeof===l||N.$$typeof===o||N.$$typeof===d||N.$$typeof===g||N.$$typeof===b||N.$$typeof===j||N.$$typeof===h)},ar.typeOf=y,ar}var Oy;function UH(){return Oy||(Oy=1,Sf.exports=zH()),Sf.exports}var $H=UH(),ms=e=>e===0?0:e>0?1:-1,pa=e=>typeof e=="number"&&e!=+e,Ii=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,at=e=>(typeof e=="number"||e instanceof Number)&&!pa(e),fn=e=>at(e)||typeof e=="string",WH=0,fc=e=>{var t=++WH;return"".concat(e||"").concat(t)},Ms=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!at(t)&&typeof t!="string")return a;var i;if(Ii(t)){if(r==null)return a;var l=t.indexOf("%");i=r*parseFloat(t.slice(0,l))/100}else i=+t;return pa(i)&&(i=a),n&&r!=null&&i>r&&(i=r),i},sA=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},a=0;a<t;a++)if(!r[e[a]])r[e[a]]=!0;else return!0;return!1};function Ss(e,t,r){return at(e)&&at(t)?e+r*(t-e):t}function HH(e,t,r){if(!(!e||!e.length))return e.find(a=>a&&(typeof t=="function"?t(a):rl(a,t))===r)}var ps=e=>e===null||typeof e>"u",zc=e=>ps(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),VH=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Vg(e){if(typeof e!="string")return!1;var t=VH;return t.includes(e)}var GH=["viewBox","children"],Py=["points","pathLength"],Ef={svg:GH,polygon:Py,polyline:Py},qH=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var a={};return Object.keys(r).forEach(n=>{Vg(n)&&(a[n]=(i=>r[n](r,i)))}),a},KH=(e,t,r)=>a=>(e(t,r,a),null),Uc=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(n=>{var i=e[n];Vg(n)&&typeof i=="function"&&(a||(a={}),a[n]=KH(i,t,r))}),a},YH=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function aA(e){if(typeof e!="string")return!1;var t=YH;return t.includes(e)}function gi(e){var t=Object.entries(e).filter(r=>{var[a]=r;return aA(a)});return Object.fromEntries(t)}var Ry=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",Ly=null,Tf=null,nA=e=>{if(e===Ly&&Array.isArray(Tf))return Tf;var t=[];return v.Children.forEach(e,r=>{ps(r)||($H.isFragment(r)?t=t.concat(nA(r.props.children)):t.push(r))}),Tf=t,Ly=e,t};function Gg(e,t){var r=[],a=[];return Array.isArray(t)?a=t.map(n=>Ry(n)):a=[Ry(t)],nA(e).forEach(n=>{var i=rl(n,"type.displayName")||rl(n,"type.name");a.indexOf(i)!==-1&&r.push(n)}),r}var XH=(e,t,r,a)=>{var n;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(n=a&&Ef?.[a])!==null&&n!==void 0?n:[],l=t.startsWith("data-"),o=typeof e!="function"&&(!!a&&i.includes(t)||aA(t)),c=!!r&&Vg(t);return l||o||c},as=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var a=e;if(v.isValidElement(e)&&(a=e.props),typeof a!="object"&&typeof a!="function")return null;var n={};return Object.keys(a).forEach(i=>{var l;XH((l=a)===null||l===void 0?void 0:l[i],i,t,r)&&(n[i]=a[i])}),n},JH=["children","width","height","viewBox","className","style","title","desc"];function Yp(){return Yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Yp.apply(null,arguments)}function ZH(e,t){if(e==null)return{};var r,a,n=QH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function QH(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var qg=v.forwardRef((e,t)=>{var{children:r,width:a,height:n,viewBox:i,className:l,style:o,title:c,desc:u}=e,d=ZH(e,JH),m=i||{width:a,height:n,x:0,y:0},f=Bt("recharts-surface",l);return v.createElement("svg",Yp({},as(d,!0,"svg"),{className:f,width:a,height:n,style:o,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),v.createElement("title",null,c),v.createElement("desc",null,u),r)}),eV=["children","className"];function Xp(){return Xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Xp.apply(null,arguments)}function tV(e,t){if(e==null)return{};var r,a,n=rV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function rV(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var aa=v.forwardRef((e,t)=>{var{children:r,className:a}=e,n=tV(e,eV),i=Bt("recharts-layer",a);return v.createElement("g",Xp({className:i},as(n,!0),{ref:t}),r)}),iA=v.createContext(null),sV=()=>v.useContext(iA);function hr(e){return function(){return e}}const lA=Math.cos,uu=Math.sin,en=Math.sqrt,mu=Math.PI,xm=2*mu,Jp=Math.PI,Zp=2*Jp,Ti=1e-6,aV=Zp-Ti;function oA(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function nV(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return oA;const r=10**t;return function(a){this._+=a[0];for(let n=1,i=a.length;n<i;++n)this._+=Math.round(arguments[n]*r)/r+a[n]}}class iV{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?oA:nV(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,n){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+n}`}bezierCurveTo(t,r,a,n,i,l){this._append`C${+t},${+r},${+a},${+n},${this._x1=+i},${this._y1=+l}`}arcTo(t,r,a,n,i){if(t=+t,r=+r,a=+a,n=+n,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,o=this._y1,c=a-t,u=n-r,d=l-t,m=o-r,f=d*d+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>Ti)if(!(Math.abs(m*c-u*d)>Ti)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let x=a-l,p=n-o,h=c*c+u*u,g=x*x+p*p,b=Math.sqrt(h),j=Math.sqrt(f),y=i*Math.tan((Jp-Math.acos((h+f-g)/(2*b*j)))/2),w=y/j,N=y/b;Math.abs(w-1)>Ti&&this._append`L${t+w*d},${r+w*m}`,this._append`A${i},${i},0,0,${+(m*x>d*p)},${this._x1=t+N*c},${this._y1=r+N*u}`}}arc(t,r,a,n,i,l){if(t=+t,r=+r,a=+a,l=!!l,a<0)throw new Error(`negative radius: ${a}`);let o=a*Math.cos(n),c=a*Math.sin(n),u=t+o,d=r+c,m=1^l,f=l?n-i:i-n;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Ti||Math.abs(this._y1-d)>Ti)&&this._append`L${u},${d}`,a&&(f<0&&(f=f%Zp+Zp),f>aV?this._append`A${a},${a},0,1,${m},${t-o},${r-c}A${a},${a},0,1,${m},${this._x1=u},${this._y1=d}`:f>Ti&&this._append`A${a},${a},0,${+(f>=Jp)},${m},${this._x1=t+a*Math.cos(i)},${this._y1=r+a*Math.sin(i)}`)}rect(t,r,a,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+n}h${-a}Z`}toString(){return this._}}function Kg(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return e},()=>new iV(t)}function Yg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function cA(e){this._context=e}cA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function gm(e){return new cA(e)}function dA(e){return e[0]}function uA(e){return e[1]}function mA(e,t){var r=hr(!0),a=null,n=gm,i=null,l=Kg(o);e=typeof e=="function"?e:e===void 0?dA:hr(e),t=typeof t=="function"?t:t===void 0?uA:hr(t);function o(c){var u,d=(c=Yg(c)).length,m,f=!1,x;for(a==null&&(i=n(x=l())),u=0;u<=d;++u)!(u<d&&r(m=c[u],u,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(m,u,c),+t(m,u,c));if(x)return i=null,x+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:hr(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:hr(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:hr(!!c),o):r},o.curve=function(c){return arguments.length?(n=c,a!=null&&(i=n(a)),o):n},o.context=function(c){return arguments.length?(c==null?a=i=null:i=n(a=c),o):a},o}function yd(e,t,r){var a=null,n=hr(!0),i=null,l=gm,o=null,c=Kg(u);e=typeof e=="function"?e:e===void 0?dA:hr(+e),t=typeof t=="function"?t:hr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?uA:hr(+r);function u(m){var f,x,p,h=(m=Yg(m)).length,g,b=!1,j,y=new Array(h),w=new Array(h);for(i==null&&(o=l(j=c())),f=0;f<=h;++f){if(!(f<h&&n(g=m[f],f,m))===b)if(b=!b)x=f,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=f-1;p>=x;--p)o.point(y[p],w[p]);o.lineEnd(),o.areaEnd()}b&&(y[f]=+e(g,f,m),w[f]=+t(g,f,m),o.point(a?+a(g,f,m):y[f],r?+r(g,f,m):w[f]))}if(j)return o=null,j+""||null}function d(){return mA().defined(n).curve(l).context(i)}return u.x=function(m){return arguments.length?(e=typeof m=="function"?m:hr(+m),a=null,u):e},u.x0=function(m){return arguments.length?(e=typeof m=="function"?m:hr(+m),u):e},u.x1=function(m){return arguments.length?(a=m==null?null:typeof m=="function"?m:hr(+m),u):a},u.y=function(m){return arguments.length?(t=typeof m=="function"?m:hr(+m),r=null,u):t},u.y0=function(m){return arguments.length?(t=typeof m=="function"?m:hr(+m),u):t},u.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:hr(+m),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(a).y(t)},u.defined=function(m){return arguments.length?(n=typeof m=="function"?m:hr(!!m),u):n},u.curve=function(m){return arguments.length?(l=m,i!=null&&(o=l(i)),u):l},u.context=function(m){return arguments.length?(m==null?i=o=null:o=l(i=m),u):i},u}class fA{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function lV(e){return new fA(e,!0)}function oV(e){return new fA(e,!1)}const Xg={draw(e,t){const r=en(t/mu);e.moveTo(r,0),e.arc(0,0,r,0,xm)}},cV={draw(e,t){const r=en(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},hA=en(1/3),dV=hA*2,uV={draw(e,t){const r=en(t/dV),a=r*hA;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},mV={draw(e,t){const r=en(t),a=-r/2;e.rect(a,a,r,r)}},fV=.8908130915292852,pA=uu(mu/10)/uu(7*mu/10),hV=uu(xm/10)*pA,pV=-lA(xm/10)*pA,xV={draw(e,t){const r=en(t*fV),a=hV*r,n=pV*r;e.moveTo(0,-r),e.lineTo(a,n);for(let i=1;i<5;++i){const l=xm*i/5,o=lA(l),c=uu(l);e.lineTo(c*r,-o*r),e.lineTo(o*a-c*n,c*a+o*n)}e.closePath()}},Af=en(3),gV={draw(e,t){const r=-en(t/(Af*3));e.moveTo(0,r*2),e.lineTo(-Af*r,-r),e.lineTo(Af*r,-r),e.closePath()}},ya=-.5,ja=en(3)/2,Qp=1/en(12),vV=(Qp/2+1)*3,bV={draw(e,t){const r=en(t/vV),a=r/2,n=r*Qp,i=a,l=r*Qp+r,o=-i,c=l;e.moveTo(a,n),e.lineTo(i,l),e.lineTo(o,c),e.lineTo(ya*a-ja*n,ja*a+ya*n),e.lineTo(ya*i-ja*l,ja*i+ya*l),e.lineTo(ya*o-ja*c,ja*o+ya*c),e.lineTo(ya*a+ja*n,ya*n-ja*a),e.lineTo(ya*i+ja*l,ya*l-ja*i),e.lineTo(ya*o+ja*c,ya*c-ja*o),e.closePath()}};function yV(e,t){let r=null,a=Kg(n);e=typeof e=="function"?e:hr(e||Xg),t=typeof t=="function"?t:hr(t===void 0?64:+t);function n(){let i;if(r||(r=i=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return n.type=function(i){return arguments.length?(e=typeof i=="function"?i:hr(i),n):e},n.size=function(i){return arguments.length?(t=typeof i=="function"?i:hr(+i),n):t},n.context=function(i){return arguments.length?(r=i??null,n):r},n}function fu(){}function hu(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function xA(e){this._context=e}xA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:hu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:hu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function jV(e){return new xA(e)}function gA(e){this._context=e}gA.prototype={areaStart:fu,areaEnd:fu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:hu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function wV(e){return new gA(e)}function vA(e){this._context=e}vA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:hu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function NV(e){return new vA(e)}function bA(e){this._context=e}bA.prototype={areaStart:fu,areaEnd:fu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function SV(e){return new bA(e)}function Fy(e){return e<0?-1:1}function My(e,t,r){var a=e._x1-e._x0,n=t-e._x1,i=(e._y1-e._y0)/(a||n<0&&-0),l=(r-e._y1)/(n||a<0&&-0),o=(i*n+l*a)/(a+n);return(Fy(i)+Fy(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(o))||0}function By(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Cf(e,t,r){var a=e._x0,n=e._y0,i=e._x1,l=e._y1,o=(i-a)/3;e._context.bezierCurveTo(a+o,n+o*t,i-o,l-o*r,i,l)}function pu(e){this._context=e}pu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Cf(this,this._t0,By(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Cf(this,By(this,r=My(this,e,t)),r);break;default:Cf(this,this._t0,r=My(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function yA(e){this._context=new jA(e)}(yA.prototype=Object.create(pu.prototype)).point=function(e,t){pu.prototype.point.call(this,t,e)};function jA(e){this._context=e}jA.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,n,i){this._context.bezierCurveTo(t,e,a,r,i,n)}};function EV(e){return new pu(e)}function TV(e){return new yA(e)}function wA(e){this._context=e}wA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var a=zy(e),n=zy(t),i=0,l=1;l<r;++i,++l)this._context.bezierCurveTo(a[0][i],n[0][i],a[1][i],n[1][i],e[l],t[l]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function zy(e){var t,r=e.length-1,a,n=new Array(r),i=new Array(r),l=new Array(r);for(n[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<r-1;++t)n[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(n[r-1]=2,i[r-1]=7,l[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)a=n[t]/i[t-1],i[t]-=a,l[t]-=a*l[t-1];for(n[r-1]=l[r-1]/i[r-1],t=r-2;t>=0;--t)n[t]=(l[t]-n[t+1])/i[t];for(i[r-1]=(e[r]+n[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-n[t+1];return[n,i]}function AV(e){return new wA(e)}function vm(e,t){this._context=e,this._t=t}vm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function CV(e){return new vm(e,.5)}function _V(e){return new vm(e,0)}function kV(e){return new vm(e,1)}function $l(e,t){if((l=e.length)>1)for(var r=1,a,n,i=e[t[0]],l,o=i.length;r<l;++r)for(n=i,i=e[t[r]],a=0;a<o;++a)i[a][1]+=i[a][0]=isNaN(n[a][1])?n[a][0]:n[a][1]}function ex(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function DV(e,t){return e[t]}function IV(e){const t=[];return t.key=e,t}function OV(){var e=hr([]),t=ex,r=$l,a=DV;function n(i){var l=Array.from(e.apply(this,arguments),IV),o,c=l.length,u=-1,d;for(const m of i)for(o=0,++u;o<c;++o)(l[o][u]=[0,+a(m,l[o].key,u,i)]).data=m;for(o=0,d=Yg(t(l));o<c;++o)l[d[o]].index=o;return r(l,d),l}return n.keys=function(i){return arguments.length?(e=typeof i=="function"?i:hr(Array.from(i)),n):e},n.value=function(i){return arguments.length?(a=typeof i=="function"?i:hr(+i),n):a},n.order=function(i){return arguments.length?(t=i==null?ex:typeof i=="function"?i:hr(Array.from(i)),n):t},n.offset=function(i){return arguments.length?(r=i??$l,n):r},n}function PV(e,t){if((a=e.length)>0){for(var r,a,n=0,i=e[0].length,l;n<i;++n){for(l=r=0;r<a;++r)l+=e[r][n][1]||0;if(l)for(r=0;r<a;++r)e[r][n][1]/=l}$l(e,t)}}function RV(e,t){if((n=e.length)>0){for(var r=0,a=e[t[0]],n,i=a.length;r<i;++r){for(var l=0,o=0;l<n;++l)o+=e[l][r][1]||0;a[r][1]+=a[r][0]=-o/2}$l(e,t)}}function LV(e,t){if(!(!((l=e.length)>0)||!((i=(n=e[t[0]]).length)>0))){for(var r=0,a=1,n,i,l;a<i;++a){for(var o=0,c=0,u=0;o<l;++o){for(var d=e[t[o]],m=d[a][1]||0,f=d[a-1][1]||0,x=(m-f)/2,p=0;p<o;++p){var h=e[t[p]],g=h[a][1]||0,b=h[a-1][1]||0;x+=g-b}c+=m,u+=x*m}n[a-1][1]+=n[a-1][0]=r,c&&(r-=u/c)}n[a-1][1]+=n[a-1][0]=r,$l(e,t)}}var FV=["type","size","sizeType"];function tx(){return tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},tx.apply(null,arguments)}function Uy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function $y(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uy(Object(r),!0).forEach(function(a){MV(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uy(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function MV(e,t,r){return(t=BV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BV(e){var t=zV(e,"string");return typeof t=="symbol"?t:t+""}function zV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UV(e,t){if(e==null)return{};var r,a,n=$V(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function $V(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var NA={symbolCircle:Xg,symbolCross:cV,symbolDiamond:uV,symbolSquare:mV,symbolStar:xV,symbolTriangle:gV,symbolWye:bV},WV=Math.PI/180,HV=e=>{var t="symbol".concat(zc(e));return NA[t]||Xg},VV=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*WV;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},GV=(e,t)=>{NA["symbol".concat(zc(e))]=t},Jg=e=>{var{type:t="circle",size:r=64,sizeType:a="area"}=e,n=UV(e,FV),i=$y($y({},n),{},{type:t,size:r,sizeType:a}),l="circle";typeof t=="string"&&(l=t);var o=()=>{var f=HV(l),x=yV().type(f).size(VV(r,a,l));return x()},{className:c,cx:u,cy:d}=i,m=as(i,!0);return u===+u&&d===+d&&r===+r?v.createElement("path",tx({},m,{className:Bt("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:o()})):null};Jg.registerSymbol=GV;function rx(){return rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},rx.apply(null,arguments)}function Wy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function qV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wy(Object(r),!0).forEach(function(a){Zg(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wy(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Zg(e,t,r){return(t=KV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KV(e){var t=YV(e,"string");return typeof t=="symbol"?t:t+""}function YV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wa=32;class Qg extends v.PureComponent{renderIcon(t,r){var{inactiveColor:a}=this.props,n=wa/2,i=wa/6,l=wa/3,o=t.inactive?a:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return v.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:n,x2:wa,y2:n,className:"recharts-legend-icon"});if(c==="line")return v.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(n,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(n,`
            H`).concat(wa,"M").concat(2*l,",").concat(n,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(n),className:"recharts-legend-icon"});if(c==="rect")return v.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(wa/8,"h").concat(wa,"v").concat(wa*3/4,"h").concat(-wa,"z"),className:"recharts-legend-icon"});if(v.isValidElement(t.legendIcon)){var u=qV({},t);return delete u.legendIcon,v.cloneElement(t.legendIcon,u)}return v.createElement(Jg,{fill:o,cx:n,cy:n,size:wa,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:a,formatter:n,inactiveColor:i,iconType:l}=this.props,o={x:0,y:0,width:wa,height:wa},c={display:a==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,m)=>{var f=d.formatter||n,x=Bt({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:d.inactive});if(d.type==="none")return null;var p=d.inactive?i:d.color,h=f?f(d.value,d,m):d.value;return v.createElement("li",rx({className:x,style:c,key:"legend-item-".concat(m)},Uc(this.props,d,m)),v.createElement(qg,{width:r,height:r,viewBox:o,style:u,"aria-label":"".concat(h," legend icon")},this.renderIcon(d,l)),v.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},h))})}render(){var{payload:t,layout:r,align:a}=this.props;if(!t||!t.length)return null;var n={padding:0,margin:0,textAlign:r==="horizontal"?a:"left"};return v.createElement("ul",{className:"recharts-default-legend",style:n},this.renderItems())}}Zg(Qg,"displayName","Legend");Zg(Qg,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var _f={},kf={},Hy;function XV(){return Hy||(Hy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){const n=new Map;for(let i=0;i<r.length;i++){const l=r[i],o=a(l);n.has(o)||n.set(o,l)}return Array.from(n.values())}e.uniqBy=t})(kf)),kf}var Df={},Vy;function SA(){return Vy||(Vy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Df)),Df}var If={},Of={},Pf={},Gy;function JV(){return Gy||(Gy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Pf)),Pf}var qy;function ev(){return qy||(qy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JV();function r(a){return a!=null&&typeof a!="function"&&t.isLength(a.length)}e.isArrayLike=r})(Of)),Of}var Rf={},Ky;function ZV(){return Ky||(Ky=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Rf)),Rf}var Yy;function QV(){return Yy||(Yy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ev(),r=ZV();function a(n){return r.isObjectLike(n)&&t.isArrayLike(n)}e.isArrayLikeObject=a})(If)),If}var Lf={},Ff={},Xy;function eG(){return Xy||(Xy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hg();function r(a){return function(n){return t.get(n,a)}}e.property=r})(Ff)),Ff}var Mf={},Bf={},zf={},Uf={},Jy;function EA(){return Jy||(Jy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Uf)),Uf}var $f={},Zy;function TA(){return Zy||(Zy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})($f)),$f}var Wf={},Qy;function AA(){return Qy||(Qy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){return r===a||Number.isNaN(r)&&Number.isNaN(a)}e.eq=t})(Wf)),Wf}var ej;function tG(){return ej||(ej=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tv(),r=EA(),a=TA(),n=AA();function i(m,f,x){return typeof x!="function"?t.isMatch(m,f):l(m,f,function p(h,g,b,j,y,w){const N=x(h,g,b,j,y,w);return N!==void 0?!!N:l(h,g,p,w)},new Map)}function l(m,f,x,p){if(f===m)return!0;switch(typeof f){case"object":return o(m,f,x,p);case"function":return Object.keys(f).length>0?l(m,{...f},x,p):n.eq(m,f);default:return r.isObject(m)?typeof f=="string"?f==="":!0:n.eq(m,f)}}function o(m,f,x,p){if(f==null)return!0;if(Array.isArray(f))return u(m,f,x,p);if(f instanceof Map)return c(m,f,x,p);if(f instanceof Set)return d(m,f,x,p);const h=Object.keys(f);if(m==null)return h.length===0;if(h.length===0)return!0;if(p&&p.has(f))return p.get(f)===m;p&&p.set(f,m);try{for(let g=0;g<h.length;g++){const b=h[g];if(!a.isPrimitive(m)&&!(b in m)||f[b]===void 0&&m[b]!==void 0||f[b]===null&&m[b]!==null||!x(m[b],f[b],b,m,f,p))return!1}return!0}finally{p&&p.delete(f)}}function c(m,f,x,p){if(f.size===0)return!0;if(!(m instanceof Map))return!1;for(const[h,g]of f.entries()){const b=m.get(h);if(x(b,g,h,m,f,p)===!1)return!1}return!0}function u(m,f,x,p){if(f.length===0)return!0;if(!Array.isArray(m))return!1;const h=new Set;for(let g=0;g<f.length;g++){const b=f[g];let j=!1;for(let y=0;y<m.length;y++){if(h.has(y))continue;const w=m[y];let N=!1;if(x(w,b,g,m,f,p)&&(N=!0),N){h.add(y),j=!0;break}}if(!j)return!1}return!0}function d(m,f,x,p){return f.size===0?!0:m instanceof Set?u([...m],[...f],x,p):!1}e.isMatchWith=i,e.isSetMatch=d})(zf)),zf}var tj;function tv(){return tj||(tj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tG();function r(a,n){return t.isMatchWith(a,n,()=>{})}e.isMatch=r})(Bf)),Bf}var Hf={},Vf={},Gf={},rj;function rG(){return rj||(rj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(a=>Object.prototype.propertyIsEnumerable.call(r,a))}e.getSymbols=t})(Gf)),Gf}var qf={},sj;function CA(){return sj||(sj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(qf)),qf}var Kf={},aj;function _A(){return aj||(aj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",a="[object Number]",n="[object Boolean]",i="[object Arguments]",l="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",m="[object Function]",f="[object ArrayBuffer]",x="[object Object]",p="[object Error]",h="[object DataView]",g="[object Uint8Array]",b="[object Uint8ClampedArray]",j="[object Uint16Array]",y="[object Uint32Array]",w="[object BigUint64Array]",N="[object Int8Array]",S="[object Int16Array]",E="[object Int32Array]",_="[object BigInt64Array]",T="[object Float32Array]",C="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=f,e.arrayTag=d,e.bigInt64ArrayTag=_,e.bigUint64ArrayTag=w,e.booleanTag=n,e.dataViewTag=h,e.dateTag=o,e.errorTag=p,e.float32ArrayTag=T,e.float64ArrayTag=C,e.functionTag=m,e.int16ArrayTag=S,e.int32ArrayTag=E,e.int8ArrayTag=N,e.mapTag=c,e.numberTag=a,e.objectTag=x,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=l,e.uint16ArrayTag=j,e.uint32ArrayTag=y,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=b})(Kf)),Kf}var Yf={},nj;function sG(){return nj||(nj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Yf)),Yf}var ij;function kA(){return ij||(ij=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rG(),r=CA(),a=_A(),n=TA(),i=sG();function l(d,m){return o(d,void 0,d,new Map,m)}function o(d,m,f,x=new Map,p=void 0){const h=p?.(d,m,f,x);if(h!==void 0)return h;if(n.isPrimitive(d))return d;if(x.has(d))return x.get(d);if(Array.isArray(d)){const g=new Array(d.length);x.set(d,g);for(let b=0;b<d.length;b++)g[b]=o(d[b],b,f,x,p);return Object.hasOwn(d,"index")&&(g.index=d.index),Object.hasOwn(d,"input")&&(g.input=d.input),g}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const g=new RegExp(d.source,d.flags);return g.lastIndex=d.lastIndex,g}if(d instanceof Map){const g=new Map;x.set(d,g);for(const[b,j]of d)g.set(b,o(j,b,f,x,p));return g}if(d instanceof Set){const g=new Set;x.set(d,g);for(const b of d)g.add(o(b,void 0,f,x,p));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const g=new(Object.getPrototypeOf(d)).constructor(d.length);x.set(d,g);for(let b=0;b<d.length;b++)g[b]=o(d[b],b,f,x,p);return g}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const g=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return x.set(d,g),c(g,d,f,x,p),g}if(typeof File<"u"&&d instanceof File){const g=new File([d],d.name,{type:d.type});return x.set(d,g),c(g,d,f,x,p),g}if(typeof Blob<"u"&&d instanceof Blob){const g=new Blob([d],{type:d.type});return x.set(d,g),c(g,d,f,x,p),g}if(d instanceof Error){const g=new d.constructor;return x.set(d,g),g.message=d.message,g.name=d.name,g.stack=d.stack,g.cause=d.cause,c(g,d,f,x,p),g}if(d instanceof Boolean){const g=new Boolean(d.valueOf());return x.set(d,g),c(g,d,f,x,p),g}if(d instanceof Number){const g=new Number(d.valueOf());return x.set(d,g),c(g,d,f,x,p),g}if(d instanceof String){const g=new String(d.valueOf());return x.set(d,g),c(g,d,f,x,p),g}if(typeof d=="object"&&u(d)){const g=Object.create(Object.getPrototypeOf(d));return x.set(d,g),c(g,d,f,x,p),g}return d}function c(d,m,f=d,x,p){const h=[...Object.keys(m),...t.getSymbols(m)];for(let g=0;g<h.length;g++){const b=h[g],j=Object.getOwnPropertyDescriptor(d,b);(j==null||j.writable)&&(d[b]=o(m[b],b,f,x,p))}}function u(d){switch(r.getTag(d)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=l,e.cloneDeepWithImpl=o,e.copyProperties=c})(Vf)),Vf}var lj;function aG(){return lj||(lj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kA();function r(a){return t.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=r})(Hf)),Hf}var oj;function nG(){return oj||(oj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tv(),r=aG();function a(n){return n=r.cloneDeep(n),i=>t.isMatch(i,n)}e.matches=a})(Mf)),Mf}var Xf={},Jf={},Zf={},cj;function iG(){return cj||(cj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kA(),r=_A();function a(n,i){return t.cloneDeepWith(n,(l,o,c,u)=>{const d=i?.(l,o,c,u);if(d!==void 0)return d;if(typeof n=="object")switch(Object.prototype.toString.call(n)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new n.constructor(n?.valueOf());return t.copyProperties(m,n),m}case r.argumentsTag:{const m={};return t.copyProperties(m,n),m.length=n.length,m[Symbol.iterator]=n[Symbol.iterator],m}default:return}})}e.cloneDeepWith=a})(Zf)),Zf}var dj;function lG(){return dj||(dj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iG();function r(a){return t.cloneDeepWith(a)}e.cloneDeep=r})(Jf)),Jf}var Qf={},eh={},uj;function DA(){return uj||(uj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(a,n=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<n;case"symbol":return!1;case"string":return t.test(a)}}e.isIndex=r})(eh)),eh}var th={},mj;function oG(){return mj||(mj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CA();function r(a){return a!==null&&typeof a=="object"&&t.getTag(a)==="[object Arguments]"}e.isArguments=r})(th)),th}var fj;function cG(){return fj||(fj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rA(),r=DA(),a=oG(),n=Wg();function i(l,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&l?.[o]==null?c=n.toPath(o):c=[o],c.length===0)return!1;let u=l;for(let d=0;d<c.length;d++){const m=c[d];if((u==null||!Object.hasOwn(u,m))&&!((Array.isArray(u)||a.isArguments(u))&&r.isIndex(m)&&m<u.length))return!1;u=u[m]}return!0}e.has=i})(Qf)),Qf}var hj;function dG(){return hj||(hj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tv(),r=$g(),a=lG(),n=Hg(),i=cG();function l(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=a.cloneDeep(c),function(u){const d=n.get(u,o);return d===void 0?i.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=l})(Xf)),Xf}var pj;function uG(){return pj||(pj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SA(),r=eG(),a=nG(),n=dG();function i(l){if(l==null)return t.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?n.matchesProperty(l[0],l[1]):a.matches(l);case"string":case"symbol":case"number":return r.property(l)}}e.iteratee=i})(Lf)),Lf}var xj;function mG(){return xj||(xj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=XV(),r=SA(),a=QV(),n=uG();function i(l,o=r.identity){return a.isArrayLikeObject(l)?t.uniqBy(Array.from(l),n.iteratee(o)):[]}e.uniqBy=i})(_f)),_f}var rh,gj;function fG(){return gj||(gj=1,rh=mG().uniqBy),rh}var hG=fG();const vj=fi(hG);function IA(e,t,r){return t===!0?vj(e,r):typeof t=="function"?vj(e,t):e}var sh={exports:{}},ah={},nh={exports:{}},ih={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bj;function pG(){if(bj)return ih;bj=1;var e=Wx();function t(m,f){return m===f&&(m!==0||1/m===1/f)||m!==m&&f!==f}var r=typeof Object.is=="function"?Object.is:t,a=e.useState,n=e.useEffect,i=e.useLayoutEffect,l=e.useDebugValue;function o(m,f){var x=f(),p=a({inst:{value:x,getSnapshot:f}}),h=p[0].inst,g=p[1];return i(function(){h.value=x,h.getSnapshot=f,c(h)&&g({inst:h})},[m,x,f]),n(function(){return c(h)&&g({inst:h}),m(function(){c(h)&&g({inst:h})})},[m]),l(x),x}function c(m){var f=m.getSnapshot;m=m.value;try{var x=f();return!r(m,x)}catch{return!0}}function u(m,f){return f()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return ih.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,ih}var yj;function xG(){return yj||(yj=1,nh.exports=pG()),nh.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jj;function gG(){if(jj)return ah;jj=1;var e=Wx(),t=xG();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var a=typeof Object.is=="function"?Object.is:r,n=t.useSyncExternalStore,i=e.useRef,l=e.useEffect,o=e.useMemo,c=e.useDebugValue;return ah.useSyncExternalStoreWithSelector=function(u,d,m,f,x){var p=i(null);if(p.current===null){var h={hasValue:!1,value:null};p.current=h}else h=p.current;p=o(function(){function b(S){if(!j){if(j=!0,y=S,S=f(S),x!==void 0&&h.hasValue){var E=h.value;if(x(E,S))return w=E}return w=S}if(E=w,a(y,S))return E;var _=f(S);return x!==void 0&&x(E,_)?(y=S,E):(y=S,w=_)}var j=!1,y,w,N=m===void 0?null:m;return[function(){return b(d())},N===null?void 0:function(){return b(N())}]},[d,m,f,x]);var g=n(u,p[0],p[1]);return l(function(){h.hasValue=!0,h.value=g},[g]),c(g),g},ah}var wj;function vG(){return wj||(wj=1,sh.exports=gG()),sh.exports}var bG=vG(),rv=v.createContext(null),yG=e=>e,Rr=()=>{var e=v.useContext(rv);return e?e.store.dispatch:yG},Hd=()=>{},jG=()=>Hd,wG=(e,t)=>e===t;function tt(e){var t=v.useContext(rv);return bG.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:jG,t?t.store.getState:Hd,t?t.store.getState:Hd,t?e:Hd,wG)}function NG(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function SG(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function EG(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${t}[${r}]`)}}var Nj=e=>Array.isArray(e)?e:[e];function TG(e){const t=Array.isArray(e[0])?e[0]:e;return EG(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function AG(e,t){const r=[],{length:a}=e;for(let n=0;n<a;n++)r.push(e[n].apply(null,t));return r}var CG=class{constructor(e){this.value=e}deref(){return this.value}},_G=typeof WeakRef<"u"?WeakRef:CG,kG=0,Sj=1;function jd(){return{s:kG,v:void 0,o:null,p:null}}function OA(e,t={}){let r=jd();const{resultEqualityCheck:a}=t;let n,i=0;function l(){let o=r;const{length:c}=arguments;for(let m=0,f=c;m<f;m++){const x=arguments[m];if(typeof x=="function"||typeof x=="object"&&x!==null){let p=o.o;p===null&&(o.o=p=new WeakMap);const h=p.get(x);h===void 0?(o=jd(),p.set(x,o)):o=h}else{let p=o.p;p===null&&(o.p=p=new Map);const h=p.get(x);h===void 0?(o=jd(),p.set(x,o)):o=h}}const u=o;let d;if(o.s===Sj)d=o.v;else if(d=e.apply(null,arguments),i++,a){const m=n?.deref?.()??n;m!=null&&a(m,d)&&(d=m,i!==0&&i--),n=typeof d=="object"&&d!==null||typeof d=="function"?new _G(d):d}return u.s=Sj,u.v=d,d}return l.clearCache=()=>{r=jd(),l.resetResultsCount()},l.resultsCount=()=>i,l.resetResultsCount=()=>{i=0},l}function DG(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,a=(...n)=>{let i=0,l=0,o,c={},u=n.pop();typeof u=="object"&&(c=u,u=n.pop()),NG(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:m,memoizeOptions:f=[],argsMemoize:x=OA,argsMemoizeOptions:p=[]}=d,h=Nj(f),g=Nj(p),b=TG(n),j=m(function(){return i++,u.apply(null,arguments)},...h),y=x(function(){l++;const N=AG(b,arguments);return o=j.apply(null,N),o},...g);return Object.assign(y,{resultFunc:u,memoizedResultFunc:j,dependencies:b,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:x})};return Object.assign(a,{withTypes:()=>a}),a}var be=DG(OA),IG=Object.assign((e,t=be)=>{SG(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),a=r.map(i=>e[i]);return t(a,(...i)=>i.reduce((l,o,c)=>(l[r[c]]=o,l),{}))},{withTypes:()=>IG}),lh={},oh={},ch={},Ej;function OG(){return Ej||(Ej=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const r=(a,n,i)=>{if(a!==n){const l=t(a),o=t(n);if(l===o&&l===0){if(a<n)return i==="desc"?1:-1;if(a>n)return i==="desc"?-1:1}return i==="desc"?o-l:l-o}return 0};e.compareValues=r})(ch)),ch}var dh={},uh={},Tj;function PA(){return Tj||(Tj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(uh)),uh}var Aj;function PG(){return Aj||(Aj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PA(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function n(i,l){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(a.test(i)||!r.test(i))||l!=null&&Object.hasOwn(l,i)}e.isKey=n})(dh)),dh}var Cj;function RG(){return Cj||(Cj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OG(),r=PG(),a=Wg();function n(i,l,o,c){if(i==null)return[];o=c?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(x=>String(x));const u=(x,p)=>{let h=x;for(let g=0;g<p.length&&h!=null;++g)h=h[p[g]];return h},d=(x,p)=>p==null||x==null?p:typeof x=="object"&&"key"in x?Object.hasOwn(p,x.key)?p[x.key]:u(p,x.path):typeof x=="function"?x(p):Array.isArray(x)?u(p,x):typeof p=="object"?p[x]:p,m=l.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||r.isKey(x)?x:{key:x,path:a.toPath(x)}));return i.map(x=>({original:x,criteria:m.map(p=>d(p,x))})).slice().sort((x,p)=>{for(let h=0;h<m.length;h++){const g=t.compareValues(x.criteria[h],p.criteria[h],o[h]);if(g!==0)return g}return 0}).map(x=>x.original)}e.orderBy=n})(oh)),oh}var mh={},_j;function LG(){return _j||(_j=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a=1){const n=[],i=Math.floor(a),l=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<i?l(d,c+1):n.push(d)}};return l(r,0),n}e.flatten=t})(mh)),mh}var fh={},kj;function RA(){return kj||(kj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DA(),r=ev(),a=EA(),n=AA();function i(l,o,c){return a.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?n.eq(c[o],l):!1}e.isIterateeCall=i})(fh)),fh}var Dj;function FG(){return Dj||(Dj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RG(),r=LG(),a=RA();function n(i,...l){const o=l.length;return o>1&&a.isIterateeCall(i,l[0],l[1])?l=[]:o>2&&a.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),t.orderBy(i,r.flatten(l),["asc"])}e.sortBy=n})(lh)),lh}var hh,Ij;function MG(){return Ij||(Ij=1,hh=FG().sortBy),hh}var BG=MG();const bm=fi(BG);var LA=e=>e.legend.settings,zG=e=>e.legend.size,UG=e=>e.legend.payload,$G=be([UG,LA],(e,t)=>{var{itemSorter:r}=t,a=e.flat(1);return r?bm(a,r):a});function WG(){return tt($G)}var wd=1;function FA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),a=v.useCallback(n=>{if(n!=null){var i=n.getBoundingClientRect(),l={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(l.height-t.height)>wd||Math.abs(l.left-t.left)>wd||Math.abs(l.top-t.top)>wd||Math.abs(l.width-t.width)>wd)&&r({height:l.height,left:l.left,top:l.top,width:l.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function ys(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var HG=typeof Symbol=="function"&&Symbol.observable||"@@observable",Oj=HG,ph=()=>Math.random().toString(36).substring(7).split("").join("."),VG={INIT:`@@redux/INIT${ph()}`,REPLACE:`@@redux/REPLACE${ph()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${ph()}`},xu=VG;function sv(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function MA(e,t,r){if(typeof e!="function")throw new Error(ys(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ys(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ys(1));return r(MA)(e,t)}let a=e,n=t,i=new Map,l=i,o=0,c=!1;function u(){l===i&&(l=new Map,i.forEach((g,b)=>{l.set(b,g)}))}function d(){if(c)throw new Error(ys(3));return n}function m(g){if(typeof g!="function")throw new Error(ys(4));if(c)throw new Error(ys(5));let b=!0;u();const j=o++;return l.set(j,g),function(){if(b){if(c)throw new Error(ys(6));b=!1,u(),l.delete(j),i=null}}}function f(g){if(!sv(g))throw new Error(ys(7));if(typeof g.type>"u")throw new Error(ys(8));if(typeof g.type!="string")throw new Error(ys(17));if(c)throw new Error(ys(9));try{c=!0,n=a(n,g)}finally{c=!1}return(i=l).forEach(j=>{j()}),g}function x(g){if(typeof g!="function")throw new Error(ys(10));a=g,f({type:xu.REPLACE})}function p(){const g=m;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(ys(11));function j(){const w=b;w.next&&w.next(d())}return j(),{unsubscribe:g(j)}},[Oj](){return this}}}return f({type:xu.INIT}),{dispatch:f,subscribe:m,getState:d,replaceReducer:x,[Oj]:p}}function GG(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:xu.INIT})>"u")throw new Error(ys(12));if(typeof r(void 0,{type:xu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ys(13))})}function BA(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const l=t[i];typeof e[l]=="function"&&(r[l]=e[l])}const a=Object.keys(r);let n;try{GG(r)}catch(i){n=i}return function(l={},o){if(n)throw n;let c=!1;const u={};for(let d=0;d<a.length;d++){const m=a[d],f=r[m],x=l[m],p=f(x,o);if(typeof p>"u")throw o&&o.type,new Error(ys(14));u[m]=p,c=c||p!==x}return c=c||a.length!==Object.keys(l).length,c?u:l}}function gu(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...a)=>t(r(...a)))}function qG(...e){return t=>(r,a)=>{const n=t(r,a);let i=()=>{throw new Error(ys(15))};const l={getState:n.getState,dispatch:(c,...u)=>i(c,...u)},o=e.map(c=>c(l));return i=gu(...o)(n.dispatch),{...n,dispatch:i}}}function zA(e){return sv(e)&&"type"in e&&typeof e.type=="string"}var UA=Symbol.for("immer-nothing"),Pj=Symbol.for("immer-draftable"),xa=Symbol.for("immer-state");function Ga(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Wl=Object.getPrototypeOf;function sl(e){return!!e&&!!e[xa]}function In(e){return e?$A(e)||Array.isArray(e)||!!e[Pj]||!!e.constructor?.[Pj]||$c(e)||jm(e):!1}var KG=Object.prototype.constructor.toString();function $A(e){if(!e||typeof e!="object")return!1;const t=Wl(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===KG}function vu(e,t){ym(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,a)=>t(a,r,e))}function ym(e){const t=e[xa];return t?t.type_:Array.isArray(e)?1:$c(e)?2:jm(e)?3:0}function sx(e,t){return ym(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function WA(e,t,r){const a=ym(e);a===2?e.set(t,r):a===3?e.add(r):e[t]=r}function YG(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function $c(e){return e instanceof Map}function jm(e){return e instanceof Set}function Ai(e){return e.copy_||e.base_}function ax(e,t){if($c(e))return new Map(e);if(jm(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=$A(e);if(t===!0||t==="class_only"&&!r){const a=Object.getOwnPropertyDescriptors(e);delete a[xa];let n=Reflect.ownKeys(a);for(let i=0;i<n.length;i++){const l=n[i],o=a[l];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(a[l]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[l]})}return Object.create(Wl(e),a)}else{const a=Wl(e);if(a!==null&&r)return{...e};const n=Object.create(a);return Object.assign(n,e)}}function av(e,t=!1){return wm(e)||sl(e)||!In(e)||(ym(e)>1&&Object.defineProperties(e,{set:{value:Nd},add:{value:Nd},clear:{value:Nd},delete:{value:Nd}}),Object.freeze(e),t&&Object.values(e).forEach(r=>av(r,!0))),e}function Nd(){Ga(2)}function wm(e){return Object.isFrozen(e)}var XG={};function al(e){const t=XG[e];return t||Ga(0,e),t}var hc;function HA(){return hc}function JG(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Rj(e,t){t&&(al("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function nx(e){ix(e),e.drafts_.forEach(ZG),e.drafts_=null}function ix(e){e===hc&&(hc=e.parent_)}function Lj(e){return hc=JG(hc,e)}function ZG(e){const t=e[xa];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Fj(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[xa].modified_&&(nx(t),Ga(4)),In(e)&&(e=bu(t,e),t.parent_||yu(t,e)),t.patches_&&al("Patches").generateReplacementPatches_(r[xa].base_,e,t.patches_,t.inversePatches_)):e=bu(t,r,[]),nx(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==UA?e:void 0}function bu(e,t,r){if(wm(t))return t;const a=t[xa];if(!a)return vu(t,(n,i)=>Mj(e,a,t,n,i,r)),t;if(a.scope_!==e)return t;if(!a.modified_)return yu(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const n=a.copy_;let i=n,l=!1;a.type_===3&&(i=new Set(n),n.clear(),l=!0),vu(i,(o,c)=>Mj(e,a,n,o,c,r,l)),yu(e,n,!1),r&&e.patches_&&al("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function Mj(e,t,r,a,n,i,l){if(sl(n)){const o=i&&t&&t.type_!==3&&!sx(t.assigned_,a)?i.concat(a):void 0,c=bu(e,n,o);if(WA(r,a,c),sl(c))e.canAutoFreeze_=!1;else return}else l&&r.add(n);if(In(n)&&!wm(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;bu(e,n),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&($c(r)?r.has(a):Object.prototype.propertyIsEnumerable.call(r,a))&&yu(e,n)}}function yu(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&av(t,r)}function QG(e,t){const r=Array.isArray(e),a={type_:r?1:0,scope_:t?t.scope_:HA(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=a,i=nv;r&&(n=[a],i=pc);const{revoke:l,proxy:o}=Proxy.revocable(n,i);return a.draft_=o,a.revoke_=l,o}var nv={get(e,t){if(t===xa)return e;const r=Ai(e);if(!sx(r,t))return eq(e,r,t);const a=r[t];return e.finalized_||!In(a)?a:a===xh(e.base_,t)?(gh(e),e.copy_[t]=ox(a,e)):a},has(e,t){return t in Ai(e)},ownKeys(e){return Reflect.ownKeys(Ai(e))},set(e,t,r){const a=VA(Ai(e),t);if(a?.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){const n=xh(Ai(e),t),i=n?.[xa];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(YG(r,n)&&(r!==void 0||sx(e.base_,t)))return!0;gh(e),lx(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return xh(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,gh(e),lx(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ai(e),a=Reflect.getOwnPropertyDescriptor(r,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:r[t]}},defineProperty(){Ga(11)},getPrototypeOf(e){return Wl(e.base_)},setPrototypeOf(){Ga(12)}},pc={};vu(nv,(e,t)=>{pc[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});pc.deleteProperty=function(e,t){return pc.set.call(this,e,t,void 0)};pc.set=function(e,t,r){return nv.set.call(this,e[0],t,r,e[0])};function xh(e,t){const r=e[xa];return(r?Ai(r):e)[t]}function eq(e,t,r){const a=VA(t,r);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}function VA(e,t){if(!(t in e))return;let r=Wl(e);for(;r;){const a=Object.getOwnPropertyDescriptor(r,t);if(a)return a;r=Wl(r)}}function lx(e){e.modified_||(e.modified_=!0,e.parent_&&lx(e.parent_))}function gh(e){e.copy_||(e.copy_=ax(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var tq=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,a)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const l=this;return function(c=i,...u){return l.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&Ga(6),a!==void 0&&typeof a!="function"&&Ga(7);let n;if(In(t)){const i=Lj(this),l=ox(t,void 0);let o=!0;try{n=r(l),o=!1}finally{o?nx(i):ix(i)}return Rj(i,a),Fj(n,i)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===UA&&(n=void 0),this.autoFreeze_&&av(n,!0),a){const i=[],l=[];al("Patches").generateReplacementPatches_(t,n,i,l),a(i,l)}return n}else Ga(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(l,...o)=>this.produceWithPatches(l,c=>t(c,...o));let a,n;return[this.produce(t,r,(l,o)=>{a=l,n=o}),a,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){In(e)||Ga(8),sl(e)&&(e=An(e));const t=Lj(this),r=ox(e,void 0);return r[xa].isManual_=!0,ix(t),r}finishDraft(e,t){const r=e&&e[xa];(!r||!r.isManual_)&&Ga(9);const{scope_:a}=r;return Rj(a,t),Fj(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const a=al("Patches").applyPatches_;return sl(e)?a(e,t):this.produce(e,n=>a(n,t))}};function ox(e,t){const r=$c(e)?al("MapSet").proxyMap_(e,t):jm(e)?al("MapSet").proxySet_(e,t):QG(e,t);return(t?t.scope_:HA()).drafts_.push(r),r}function An(e){return sl(e)||Ga(10,e),GA(e)}function GA(e){if(!In(e)||wm(e))return e;const t=e[xa];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=ax(e,t.scope_.immer_.useStrictShallowCopy_)}else r=ax(e,!0);return vu(r,(a,n)=>{WA(r,a,GA(n))}),t&&(t.finalized_=!1),r}var rq=new tq,qA=rq.produce;function KA(e){return({dispatch:r,getState:a})=>n=>i=>typeof i=="function"?i(r,a,e):n(i)}var sq=KA(),aq=KA,nq=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?gu:gu.apply(null,arguments)};function Ma(e,t){function r(...a){if(t){let n=t(...a);if(!n)throw new Error(fa(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:a[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=a=>zA(a)&&a.type===e,r}var YA=class Ro extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Ro.prototype)}static get[Symbol.species](){return Ro}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Ro(...t[0].concat(this)):new Ro(...t.concat(this))}};function Bj(e){return In(e)?qA(e,()=>{}):e}function Sd(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function iq(e){return typeof e=="boolean"}var lq=()=>function(t){const{thunk:r=!0,immutableCheck:a=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=t??{};let l=new YA;return r&&(iq(r)?l.push(sq):l.push(aq(r.extraArgument))),l},oq="RTK_autoBatch",zj=e=>t=>{setTimeout(t,e)},cq=(e={type:"raf"})=>t=>(...r)=>{const a=t(...r);let n=!0,i=!1,l=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:zj(10):e.type==="callback"?e.queueNotification:zj(e.timeout),u=()=>{l=!1,i&&(i=!1,o.forEach(d=>d()))};return Object.assign({},a,{subscribe(d){const m=()=>n&&d(),f=a.subscribe(m);return o.add(d),()=>{f(),o.delete(d)}},dispatch(d){try{return n=!d?.meta?.[oq],i=!n,i&&(l||(l=!0,c(u))),a.dispatch(d)}finally{n=!0}}})},dq=e=>function(r){const{autoBatch:a=!0}=r??{};let n=new YA(e);return a&&n.push(cq(typeof a=="object"?a:void 0)),n};function uq(e){const t=lq(),{reducer:r=void 0,middleware:a,devTools:n=!0,preloadedState:i=void 0,enhancers:l=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(sv(r))o=BA(r);else throw new Error(fa(1));let c;typeof a=="function"?c=a(t):c=t();let u=gu;n&&(u=nq({trace:!1,...typeof n=="object"&&n}));const d=qG(...c),m=dq(d);let f=typeof l=="function"?l(m):m();const x=u(...f);return MA(o,i,x)}function XA(e){const t={},r=[];let a;const n={addCase(i,l){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(fa(28));if(o in t)throw new Error(fa(29));return t[o]=l,n},addAsyncThunk(i,l){return l.pending&&(t[i.pending.type]=l.pending),l.rejected&&(t[i.rejected.type]=l.rejected),l.fulfilled&&(t[i.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:i.settled,reducer:l.settled}),n},addMatcher(i,l){return r.push({matcher:i,reducer:l}),n},addDefaultCase(i){return a=i,n}};return e(n),[t,r,a]}function mq(e){return typeof e=="function"}function fq(e,t){let[r,a,n]=XA(t),i;if(mq(e))i=()=>Bj(e());else{const o=Bj(e);i=()=>o}function l(o=i(),c){let u=[r[c.type],...a.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[n]),u.reduce((d,m)=>{if(m)if(sl(d)){const x=m(d,c);return x===void 0?d:x}else{if(In(d))return qA(d,f=>m(f,c));{const f=m(d,c);if(f===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return d},o)}return l.getInitialState=i,l}var hq="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",pq=(e=21)=>{let t="",r=e;for(;r--;)t+=hq[Math.random()*64|0];return t},xq=Symbol.for("rtk-slice-createasyncthunk");function gq(e,t){return`${e}/${t}`}function vq({creators:e}={}){const t=e?.asyncThunk?.[xq];return function(a){const{name:n,reducerPath:i=n}=a;if(!n)throw new Error(fa(11));const l=(typeof a.reducers=="function"?a.reducers(yq()):a.reducers)||{},o=Object.keys(l),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(y,w){const N=typeof y=="string"?y:y.type;if(!N)throw new Error(fa(12));if(N in c.sliceCaseReducersByType)throw new Error(fa(13));return c.sliceCaseReducersByType[N]=w,u},addMatcher(y,w){return c.sliceMatchers.push({matcher:y,reducer:w}),u},exposeAction(y,w){return c.actionCreators[y]=w,u},exposeCaseReducer(y,w){return c.sliceCaseReducersByName[y]=w,u}};o.forEach(y=>{const w=l[y],N={reducerName:y,type:gq(n,y),createNotation:typeof a.reducers=="function"};wq(w)?Sq(N,w,u,t):jq(N,w,u)});function d(){const[y={},w=[],N=void 0]=typeof a.extraReducers=="function"?XA(a.extraReducers):[a.extraReducers],S={...y,...c.sliceCaseReducersByType};return fq(a.initialState,E=>{for(let _ in S)E.addCase(_,S[_]);for(let _ of c.sliceMatchers)E.addMatcher(_.matcher,_.reducer);for(let _ of w)E.addMatcher(_.matcher,_.reducer);N&&E.addDefaultCase(N)})}const m=y=>y,f=new Map,x=new WeakMap;let p;function h(y,w){return p||(p=d()),p(y,w)}function g(){return p||(p=d()),p.getInitialState()}function b(y,w=!1){function N(E){let _=E[y];return typeof _>"u"&&w&&(_=Sd(x,N,g)),_}function S(E=m){const _=Sd(f,w,()=>new WeakMap);return Sd(_,E,()=>{const T={};for(const[C,A]of Object.entries(a.selectors??{}))T[C]=bq(A,E,()=>Sd(x,E,g),w);return T})}return{reducerPath:y,getSelectors:S,get selectors(){return S(N)},selectSlice:N}}const j={name:n,reducer:h,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,...b(i),injectInto(y,{reducerPath:w,...N}={}){const S=w??i;return y.inject({reducerPath:S,reducer:h},N),{...j,...b(S,!0)}}};return j}}function bq(e,t,r,a){function n(i,...l){let o=t(i);return typeof o>"u"&&a&&(o=r()),e(o,...l)}return n.unwrapped=e,n}var va=vq();function yq(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function jq({type:e,reducerName:t,createNotation:r},a,n){let i,l;if("reducer"in a){if(r&&!Nq(a))throw new Error(fa(17));i=a.reducer,l=a.prepare}else i=a;n.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,l?Ma(e,l):Ma(e))}function wq(e){return e._reducerDefinitionType==="asyncThunk"}function Nq(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Sq({type:e,reducerName:t},r,a,n){if(!n)throw new Error(fa(18));const{payloadCreator:i,fulfilled:l,pending:o,rejected:c,settled:u,options:d}=r,m=n(e,i,d);a.exposeAction(t,m),l&&a.addCase(m.fulfilled,l),o&&a.addCase(m.pending,o),c&&a.addCase(m.rejected,c),u&&a.addMatcher(m.settled,u),a.exposeCaseReducer(t,{fulfilled:l||Ed,pending:o||Ed,rejected:c||Ed,settled:u||Ed})}function Ed(){}var Eq="task",JA="listener",ZA="completed",iv="cancelled",Tq=`task-${iv}`,Aq=`task-${ZA}`,cx=`${JA}-${iv}`,Cq=`${JA}-${ZA}`,Nm=class{constructor(e){this.code=e,this.message=`${Eq} ${iv} (reason: ${e})`}name="TaskAbortError";message},lv=(e,t)=>{if(typeof e!="function")throw new TypeError(fa(32))},ju=()=>{},QA=(e,t=ju)=>(e.catch(t),e),eC=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),$i=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Wi=e=>{if(e.aborted){const{reason:t}=e;throw new Nm(t)}};function tC(e,t){let r=ju;return new Promise((a,n)=>{const i=()=>n(new Nm(e.reason));if(e.aborted){i();return}r=eC(e,i),t.finally(()=>r()).then(a,n)}).finally(()=>{r=ju})}var _q=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Nm?"cancelled":"rejected",error:r}}finally{t?.()}},wu=e=>t=>QA(tC(e,t).then(r=>(Wi(e),r))),rC=e=>{const t=wu(e);return r=>t(new Promise(a=>setTimeout(a,r)))},{assign:Ol}=Object,Uj={},Sm="listenerMiddleware",kq=(e,t)=>{const r=a=>eC(e,()=>$i(a,e.reason));return(a,n)=>{lv(a);const i=new AbortController;r(i);const l=_q(async()=>{Wi(e),Wi(i.signal);const o=await a({pause:wu(i.signal),delay:rC(i.signal),signal:i.signal});return Wi(i.signal),o},()=>$i(i,Aq));return n?.autoJoin&&t.push(l.catch(ju)),{result:wu(e)(l),cancel(){$i(i,Tq)}}}},Dq=(e,t)=>{const r=async(a,n)=>{Wi(t);let i=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:a,effect:(m,f)=>{f.unsubscribe(),c([m,f.getState(),f.getOriginalState()])}});i=()=>{d(),u()}})];n!=null&&o.push(new Promise(c=>setTimeout(c,n,null)));try{const c=await tC(t,Promise.race(o));return Wi(t),c}finally{i()}};return(a,n)=>QA(r(a,n))},sC=e=>{let{type:t,actionCreator:r,matcher:a,predicate:n,effect:i}=e;if(t)n=Ma(t).match;else if(r)t=r.type,n=r.match;else if(a)n=a;else if(!n)throw new Error(fa(21));return lv(i),{predicate:n,type:t,effect:i}},aC=Ol(e=>{const{type:t,predicate:r,effect:a}=sC(e);return{id:pq(),effect:a,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(fa(22))}}},{withTypes:()=>aC}),$j=(e,t)=>{const{type:r,effect:a,predicate:n}=sC(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===a)},dx=e=>{e.pending.forEach(t=>{$i(t,cx)})},Iq=e=>()=>{e.forEach(dx),e.clear()},Wj=(e,t,r)=>{try{e(t,r)}catch(a){setTimeout(()=>{throw a},0)}},nC=Ol(Ma(`${Sm}/add`),{withTypes:()=>nC}),Oq=Ma(`${Sm}/removeAll`),iC=Ol(Ma(`${Sm}/remove`),{withTypes:()=>iC}),Pq=(...e)=>{console.error(`${Sm}/error`,...e)},Wc=(e={})=>{const t=new Map,{extra:r,onError:a=Pq}=e;lv(a);const n=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),m=>{d.unsubscribe(),m?.cancelActive&&dx(d)}),i=d=>{const m=$j(t,d)??aC(d);return n(m)};Ol(i,{withTypes:()=>i});const l=d=>{const m=$j(t,d);return m&&(m.unsubscribe(),d.cancelActive&&dx(m)),!!m};Ol(l,{withTypes:()=>l});const o=async(d,m,f,x)=>{const p=new AbortController,h=Dq(i,p.signal),g=[];try{d.pending.add(p),await Promise.resolve(d.effect(m,Ol({},f,{getOriginalState:x,condition:(b,j)=>h(b,j).then(Boolean),take:h,delay:rC(p.signal),pause:wu(p.signal),extra:r,signal:p.signal,fork:kq(p.signal,g),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((b,j,y)=>{b!==p&&($i(b,cx),y.delete(b))})},cancel:()=>{$i(p,cx),d.pending.delete(p)},throwIfCancelled:()=>{Wi(p.signal)}})))}catch(b){b instanceof Nm||Wj(a,b,{raisedBy:"effect"})}finally{await Promise.all(g),$i(p,Cq),d.pending.delete(p)}},c=Iq(t);return{middleware:d=>m=>f=>{if(!zA(f))return m(f);if(nC.match(f))return i(f.payload);if(Oq.match(f)){c();return}if(iC.match(f))return l(f.payload);let x=d.getState();const p=()=>{if(x===Uj)throw new Error(fa(23));return x};let h;try{if(h=m(f),t.size>0){const g=d.getState(),b=Array.from(t.values());for(const j of b){let y=!1;try{y=j.predicate(f,g,x)}catch(w){y=!1,Wj(a,w,{raisedBy:"predicate"})}y&&o(j,f,d,p)}}}finally{x=Uj}return h},startListening:i,stopListening:l,clearListeners:c}};function fa(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Rq={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},lC=va({name:"chartLayout",initialState:Rq,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,a,n,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(a=t.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(n=t.payload.bottom)!==null&&n!==void 0?n:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Lq,setLayout:Fq,setChartSize:Mq,setScale:Bq}=lC.actions,zq=lC.reducer;function Hj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Vj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hj(Object(r),!0).forEach(function(a){Uq(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Uq(e,t,r){return(t=$q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $q(e){var t=Wq(e,"string");return typeof t=="symbol"?t:t+""}function Wq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nu=Math.PI/180,Hq=e=>e*180/Math.PI,Jr=(e,t,r,a)=>({x:e+Math.cos(-Nu*a)*r,y:t+Math.sin(-Nu*a)*r}),oC=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(r-(a.top||0)-(a.bottom||0)))/2},Vq=(e,t)=>{var{x:r,y:a}=e,{x:n,y:i}=t;return Math.sqrt((r-n)**2+(a-i)**2)},Gq=(e,t)=>{var{x:r,y:a}=e,{cx:n,cy:i}=t,l=Vq({x:r,y:a},{x:n,y:i});if(l<=0)return{radius:l,angle:0};var o=(r-n)/l,c=Math.acos(o);return a>i&&(c=2*Math.PI-c),{radius:l,angle:Hq(c),angleInRadian:c}},qq=e=>{var{startAngle:t,endAngle:r}=e,a=Math.floor(t/360),n=Math.floor(r/360),i=Math.min(a,n);return{startAngle:t-i*360,endAngle:r-i*360}},Kq=(e,t)=>{var{startAngle:r,endAngle:a}=t,n=Math.floor(r/360),i=Math.floor(a/360),l=Math.min(n,i);return e+l*360},Yq=(e,t)=>{var{x:r,y:a}=e,{radius:n,angle:i}=Gq({x:r,y:a},t),{innerRadius:l,outerRadius:o}=t;if(n<l||n>o||n===0)return null;var{startAngle:c,endAngle:u}=qq(t),d=i,m;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;m=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;m=d>=u&&d<=c}return m?Vj(Vj({},t),{},{radius:n,angle:Kq(d,t)}):null};function cC(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Gj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gj(Object(r),!0).forEach(function(a){Xq(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Xq(e,t,r){return(t=Jq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jq(e){var t=Zq(e,"string");return typeof t=="symbol"?t:t+""}function Zq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pr(e,t,r){return ps(e)||ps(t)?r:fn(t)?rl(e,t,r):typeof t=="function"?t(e):r}var Qq=(e,t,r,a,n)=>{var i,l=-1,o=(i=t?.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(a==="angleAxis"&&n!=null&&Math.abs(Math.abs(n[1]-n[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,m=c>=o-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(ms(d-u)!==ms(m-d)){var x=[];if(ms(m-d)===ms(n[1]-n[0])){f=m;var p=d+n[1]-n[0];x[0]=Math.min(p,(p+u)/2),x[1]=Math.max(p,(p+u)/2)}else{f=u;var h=m+n[1]-n[0];x[0]=Math.min(d,(h+d)/2),x[1]=Math.max(d,(h+d)/2)}var g=[Math.min(d,(f+d)/2),Math.max(d,(f+d)/2)];if(e>g[0]&&e<=g[1]||e>=x[0]&&e<=x[1]){({index:l}=r[c]);break}}else{var b=Math.min(u,m),j=Math.max(u,m);if(e>(b+d)/2&&e<=(j+d)/2){({index:l}=r[c]);break}}}else if(t){for(var y=0;y<o;y++)if(y===0&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y>0&&y<o-1&&e>(t[y].coordinate+t[y-1].coordinate)/2&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y===o-1&&e>(t[y].coordinate+t[y-1].coordinate)/2){({index:l}=t[y]);break}}return l},eK=(e,t,r)=>{if(t&&r){var{width:a,height:n}=r,{align:i,verticalAlign:l,layout:o}=t;if((o==="vertical"||o==="horizontal"&&l==="middle")&&i!=="center"&&at(e[i]))return Da(Da({},e),{},{[i]:e[i]+(a||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&l!=="middle"&&at(e[l]))return Da(Da({},e),{},{[l]:e[l]+(n||0)})}return e},pl=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",dC=(e,t,r,a)=>{if(a)return e.map(o=>o.coordinate);var n,i,l=e.map(o=>(o.coordinate===t&&(n=!0),o.coordinate===r&&(i=!0),o.coordinate));return n||l.push(t),i||l.push(r),l},uC=(e,t,r)=>{if(!e)return null;var{duplicateDomain:a,type:n,range:i,scale:l,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:m,niceTicks:f,axisType:x}=e;if(!l)return null;var p=o==="scaleBand"&&l.bandwidth?l.bandwidth()/2:2,h=n==="category"&&l.bandwidth?l.bandwidth()/p:0;if(h=x==="angleAxis"&&i&&i.length>=2?ms(i[0]-i[1])*2*h:h,m||f){var g=(m||f||[]).map((b,j)=>{var y=a?a.indexOf(b):b;return{coordinate:l(y)+h,value:b,offset:h,index:j}});return g.filter(b=>!pa(b.coordinate))}return c&&u?u.map((b,j)=>({coordinate:l(b)+h,value:b,index:j,offset:h})):l.ticks&&d!=null?l.ticks(d).map((b,j)=>({coordinate:l(b)+h,value:b,offset:h,index:j})):l.domain().map((b,j)=>({coordinate:l(b)+h,value:a?a[b]:b,index:j,offset:h}))},qj=1e-4,tK=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,a=e.range(),n=Math.min(a[0],a[1])-qj,i=Math.max(a[0],a[1])+qj,l=e(t[0]),o=e(t[r-1]);(l<n||l>i||o<n||o>i)&&e.domain([t[0],t[r-1]])}},rK=(e,t)=>{if(!t||t.length!==2||!at(t[0])||!at(t[1]))return e;var r=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]),n=[e[0],e[1]];return(!at(e[0])||e[0]<r)&&(n[0]=r),(!at(e[1])||e[1]>a)&&(n[1]=a),n[0]>a&&(n[0]=a),n[1]<r&&(n[1]=r),n},sK=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var n=0,i=0,l=0;l<t;++l){var o=pa(e[l][r][1])?e[l][r][0]:e[l][r][1];o>=0?(e[l][r][0]=n,e[l][r][1]=n+o,n=e[l][r][1]):(e[l][r][0]=i,e[l][r][1]=i+o,i=e[l][r][1])}},aK=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var n=0,i=0;i<t;++i){var l=pa(e[i][r][1])?e[i][r][0]:e[i][r][1];l>=0?(e[i][r][0]=n,e[i][r][1]=n+l,n=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},nK={sign:sK,expand:PV,none:$l,silhouette:RV,wiggle:LV,positive:aK},iK=(e,t,r)=>{var a=nK[r],n=OV().keys(t).value((i,l)=>+Pr(i,l,0)).order(ex).offset(a);return n(e)};function lK(e){return e==null?void 0:String(e)}var Kj=e=>{var{axis:t,ticks:r,offset:a,bandSize:n,entry:i,index:l}=e;if(t.type==="category")return r[l]?r[l].coordinate+a:null;var o=Pr(i,t.dataKey,t.scale.domain()[l]);return ps(o)?null:t.scale(o)-n/2+a},oK=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var a=Math.min(r[0],r[1]),n=Math.max(r[0],r[1]);return a<=0&&n>=0?0:n<0?n:a}return r[0]},cK=e=>{var t=e.flat(2).filter(at);return[Math.min(...t),Math.max(...t)]},dK=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],uK=(e,t,r)=>{if(e!=null)return dK(Object.keys(e).reduce((a,n)=>{var i=e[n],{stackedData:l}=i,o=l.reduce((c,u)=>{var d=cC(u,t,r),m=cK(d);return[Math.min(c[0],m[0]),Math.max(c[1],m[1])]},[1/0,-1/0]);return[Math.min(o[0],a[0]),Math.max(o[1],a[1])]},[1/0,-1/0]))},Yj=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Xj=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ov=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!r||a>0)return a}if(e&&t&&t.length>=2){for(var n=bm(t,d=>d.coordinate),i=1/0,l=1,o=n.length;l<o;l++){var c=n[l],u=n[l-1];i=Math.min((c.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function Jj(e){var{tooltipEntrySettings:t,dataKey:r,payload:a,value:n,name:i}=e;return Da(Da({},t),{},{dataKey:r,payload:a,value:n,name:i})}function Em(e,t){if(e)return String(e);if(typeof t=="string")return t}function mK(e,t,r,a,n){if(r==="horizontal"||r==="vertical"){var i=e>=n.left&&e<=n.left+n.width&&t>=n.top&&t<=n.top+n.height;return i?{x:e,y:t}:null}return a?Yq({x:e,y:t},a):null}var fK=(e,t,r,a)=>{var n=t.find(u=>u&&u.index===r);if(n){if(e==="horizontal")return{x:n.coordinate,y:a.y};if(e==="vertical")return{x:a.x,y:n.coordinate};if(e==="centric"){var i=n.coordinate,{radius:l}=a;return Da(Da(Da({},a),Jr(a.cx,a.cy,l,i)),{},{angle:i,radius:l})}var o=n.coordinate,{angle:c}=a;return Da(Da(Da({},a),Jr(a.cx,a.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},hK=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,zn=e=>e.layout.width,Un=e=>e.layout.height,pK=e=>e.layout.scale,mC=e=>e.layout.margin,Tm=be(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Am=be(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),fC="data-recharts-item-index",hC="data-recharts-item-data-key",Hc=60;function Zj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Td(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zj(Object(r),!0).forEach(function(a){xK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function xK(e,t,r){return(t=gK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=vK(e,"string");return typeof t=="symbol"?t:t+""}function vK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bK=e=>e.brush.height;function yK(e){var t=Am(e);return t.reduce((r,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var n=typeof a.width=="number"?a.width:Hc;return r+n}return r},0)}function jK(e){var t=Am(e);return t.reduce((r,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var n=typeof a.width=="number"?a.width:Hc;return r+n}return r},0)}function wK(e){var t=Tm(e);return t.reduce((r,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?r+a.height:r,0)}function NK(e){var t=Tm(e);return t.reduce((r,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?r+a.height:r,0)}var ns=be([zn,Un,mC,bK,yK,jK,wK,NK,LA,zG],(e,t,r,a,n,i,l,o,c,u)=>{var d={left:(r.left||0)+n,right:(r.right||0)+i},m={top:(r.top||0)+l,bottom:(r.bottom||0)+o},f=Td(Td({},m),d),x=f.bottom;f.bottom+=a,f=eK(f,c,u);var p=e-f.left-f.right,h=t-f.top-f.bottom;return Td(Td({brushBottom:x},f),{},{width:Math.max(p,0),height:Math.max(h,0)})}),SK=be(ns,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),cv=be(zn,Un,(e,t)=>({x:0,y:0,width:e,height:t})),EK=v.createContext(null),$a=()=>v.useContext(EK)!=null,Cm=e=>e.brush,_m=be([Cm,ns,mC],(e,t,r)=>({height:e.height,x:at(e.x)?e.x:t.left,y:at(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:at(e.width)?e.width:t.width})),dv=()=>{var e,t=$a(),r=tt(SK),a=tt(_m),n=(e=tt(Cm))===null||e===void 0?void 0:e.padding;return!t||!a||!n?r:{width:a.width-n.left-n.right,height:a.height-n.top-n.bottom,x:n.left,y:n.top}},TK={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},pC=()=>{var e;return(e=tt(ns))!==null&&e!==void 0?e:TK},uv=()=>tt(zn),mv=()=>tt(Un),AK=()=>tt(e=>e.layout.margin),tr=e=>e.layout.layoutType,fv=()=>tt(tr),CK={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},xC=va({name:"legend",initialState:CK,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=An(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:Qj,setLegendSettings:_K,addLegendPayload:gC,removeLegendPayload:vC}=xC.actions,kK=xC.reducer,DK=["contextPayload"];function ux(){return ux=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ux.apply(null,arguments)}function ew(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Hl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ew(Object(r),!0).forEach(function(a){hv(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ew(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function hv(e,t,r){return(t=IK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IK(e){var t=OK(e,"string");return typeof t=="symbol"?t:t+""}function OK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PK(e,t){if(e==null)return{};var r,a,n=RK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function RK(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function LK(e){return e.value}function FK(e){var{contextPayload:t}=e,r=PK(e,DK),a=IA(t,e.payloadUniqBy,LK),n=Hl(Hl({},r),{},{payload:a});return v.isValidElement(e.content)?v.cloneElement(e.content,n):typeof e.content=="function"?v.createElement(e.content,n):v.createElement(Qg,n)}function MK(e,t,r,a,n,i){var{layout:l,align:o,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(o==="center"&&l==="vertical"?u={left:((a||0)-i.width)/2}:u=o==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((n||0)-i.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Hl(Hl({},u),d)}function BK(e){var t=Rr();return v.useEffect(()=>{t(_K(e))},[t,e]),null}function zK(e){var t=Rr();return v.useEffect(()=>(t(Qj(e)),()=>{t(Qj({width:0,height:0}))}),[t,e]),null}function UK(e){var t=WG(),r=sV(),a=AK(),{width:n,height:i,wrapperStyle:l,portal:o}=e,[c,u]=FA([t]),d=uv(),m=mv();if(d==null||m==null)return null;var f=d-(a.left||0)-(a.right||0),x=Oi.getWidthOrHeight(e.layout,i,n,f),p=o?l:Hl(Hl({position:"absolute",width:x?.width||n||"auto",height:x?.height||i||"auto"},MK(l,e,a,d,m,c)),l),h=o??r;if(h==null)return null;var g=v.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:u},v.createElement(BK,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),v.createElement(zK,{width:c.width,height:c.height}),v.createElement(FK,ux({},e,x,{margin:a,chartWidth:d,chartHeight:m,contextPayload:t})));return $x.createPortal(g,h)}class Oi extends v.PureComponent{static getWidthOrHeight(t,r,a,n){return t==="vertical"&&at(r)?{height:r}:t==="horizontal"?{width:a||n}:null}render(){return v.createElement(UK,this.props)}}hv(Oi,"displayName","Legend");hv(Oi,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function mx(){return mx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},mx.apply(null,arguments)}function tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function vh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tw(Object(r),!0).forEach(function(a){$K(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function $K(e,t,r){return(t=WK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WK(e){var t=HK(e,"string");return typeof t=="symbol"?t:t+""}function HK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VK(e){return Array.isArray(e)&&fn(e[0])&&fn(e[1])?e.join(" ~ "):e}var GK=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:a={},labelStyle:n={},payload:i,formatter:l,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:m,accessibilityLayer:f=!1}=e,x=()=>{if(i&&i.length){var N={padding:0,margin:0},S=(o?bm(i,o):i).map((E,_)=>{if(E.type==="none")return null;var T=E.formatter||l||VK,{value:C,name:A}=E,D=C,P=A;if(T){var R=T(C,A,E,_,i);if(Array.isArray(R))[D,P]=R;else if(R!=null)D=R;else return null}var M=vh({display:"block",paddingTop:4,paddingBottom:4,color:E.color||"#000"},a);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(_),style:M},fn(P)?v.createElement("span",{className:"recharts-tooltip-item-name"},P):null,fn(P)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},D),v.createElement("span",{className:"recharts-tooltip-item-unit"},E.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:N},S)}return null},p=vh({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),h=vh({margin:0},n),g=!ps(d),b=g?d:"",j=Bt("recharts-default-tooltip",c),y=Bt("recharts-tooltip-label",u);g&&m&&i!==void 0&&i!==null&&(b=m(d,i));var w=f?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",mx({className:j,style:p},w),v.createElement("p",{className:y,style:h},v.isValidElement(b)?b:"".concat(b)),x())},No="recharts-tooltip-wrapper",qK={visibility:"hidden"};function KK(e){var{coordinate:t,translateX:r,translateY:a}=e;return Bt(No,{["".concat(No,"-right")]:at(r)&&t&&at(t.x)&&r>=t.x,["".concat(No,"-left")]:at(r)&&t&&at(t.x)&&r<t.x,["".concat(No,"-bottom")]:at(a)&&t&&at(t.y)&&a>=t.y,["".concat(No,"-top")]:at(a)&&t&&at(t.y)&&a<t.y})}function rw(e){var{allowEscapeViewBox:t,coordinate:r,key:a,offsetTopLeft:n,position:i,reverseDirection:l,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(i&&at(i[a]))return i[a];var d=r[a]-o-(n>0?n:0),m=r[a]+n;if(t[a])return l[a]?d:m;var f=c[a];if(f==null)return 0;if(l[a]){var x=d,p=f;return x<p?Math.max(m,f):Math.max(d,f)}if(u==null)return 0;var h=m+o,g=f+u;return h>g?Math.max(d,f):Math.max(m,f)}function YK(e){var{translateX:t,translateY:r,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function XK(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:a,position:n,reverseDirection:i,tooltipBox:l,useTranslate3d:o,viewBox:c}=e,u,d,m;return l.height>0&&l.width>0&&r?(d=rw({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:a,position:n,reverseDirection:i,tooltipDimension:l.width,viewBox:c,viewBoxDimension:c.width}),m=rw({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:a,position:n,reverseDirection:i,tooltipDimension:l.height,viewBox:c,viewBoxDimension:c.height}),u=YK({translateX:d,translateY:m,useTranslate3d:o})):u=qK,{cssProperties:u,cssClasses:KK({translateX:d,translateY:m,coordinate:r})}}function sw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ad(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sw(Object(r),!0).forEach(function(a){fx(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function fx(e,t,r){return(t=JK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JK(e){var t=ZK(e,"string");return typeof t=="symbol"?t:t+""}function ZK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class QK extends v.PureComponent{constructor(){super(...arguments),fx(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),fx(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,a,n,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&r!==void 0?r:0,y:(n=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&n!==void 0?n:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:a,animationEasing:n,children:i,coordinate:l,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:m,useTranslate3d:f,viewBox:x,wrapperStyle:p,lastBoundingBox:h,innerRef:g,hasPortalFromProps:b}=this.props,{cssClasses:j,cssProperties:y}=XK({allowEscapeViewBox:r,coordinate:l,offsetTopLeft:u,position:d,reverseDirection:m,tooltipBox:{height:h.height,width:h.width},useTranslate3d:f,viewBox:x}),w=b?{}:Ad(Ad({transition:c&&t?"transform ".concat(a,"ms ").concat(n):void 0},y),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),N=Ad(Ad({},w),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},p);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:j,style:N,ref:g},i)}}var eY=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),xl={devToolsEnabled:!1,isSsr:eY()},bC=()=>tt(e=>e.rootProps.accessibilityLayer);function ga(e){return Number.isFinite(e)}function Vl(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function hx(){return hx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hx.apply(null,arguments)}function aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function nw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aw(Object(r),!0).forEach(function(a){tY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function tY(e,t,r){return(t=rY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rY(e){var t=sY(e,"string");return typeof t=="symbol"?t:t+""}function sY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iw={curveBasisClosed:wV,curveBasisOpen:NV,curveBasis:jV,curveBumpX:lV,curveBumpY:oV,curveLinearClosed:SV,curveLinear:gm,curveMonotoneX:EV,curveMonotoneY:TV,curveNatural:AV,curveStep:CV,curveStepAfter:kV,curveStepBefore:_V},Cd=e=>ga(e.x)&&ga(e.y),So=e=>e.x,Eo=e=>e.y,aY=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(zc(e));return(r==="curveMonotone"||r==="curveBump")&&t?iw["".concat(r).concat(t==="vertical"?"Y":"X")]:iw[r]||gm},nY=e=>{var{type:t="linear",points:r=[],baseLine:a,layout:n,connectNulls:i=!1}=e,l=aY(t,n),o=i?r.filter(Cd):r,c;if(Array.isArray(a)){var u=i?a.filter(m=>Cd(m)):a,d=o.map((m,f)=>nw(nw({},m),{},{base:u[f]}));return n==="vertical"?c=yd().y(Eo).x1(So).x0(m=>m.base.x):c=yd().x(So).y1(Eo).y0(m=>m.base.y),c.defined(Cd).curve(l),c(d)}return n==="vertical"&&at(a)?c=yd().y(Eo).x1(So).x0(a):at(a)?c=yd().x(So).y1(Eo).y0(a):c=mA().x(So).y(Eo),c.defined(Cd).curve(l),c(o)},yC=e=>{var{className:t,points:r,path:a,pathRef:n}=e;if((!r||!r.length)&&!a)return null;var i=r&&r.length?nY(e):a;return v.createElement("path",hx({},gi(e),qH(e),{className:Bt("recharts-curve",t),d:i===null?void 0:i,ref:n}))},iY=["x","y","top","left","width","height","className"];function px(){return px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},px.apply(null,arguments)}function lw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function lY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lw(Object(r),!0).forEach(function(a){oY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function oY(e,t,r){return(t=cY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cY(e){var t=dY(e,"string");return typeof t=="symbol"?t:t+""}function dY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uY(e,t){if(e==null)return{};var r,a,n=mY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mY(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var fY=(e,t,r,a,n,i)=>"M".concat(e,",").concat(n,"v").concat(a,"M").concat(i,",").concat(t,"h").concat(r),hY=e=>{var{x:t=0,y:r=0,top:a=0,left:n=0,width:i=0,height:l=0,className:o}=e,c=uY(e,iY),u=lY({x:t,y:r,top:a,left:n,width:i,height:l},c);return!at(t)||!at(r)||!at(i)||!at(l)||!at(a)||!at(n)?null:v.createElement("path",px({},as(u,!0),{className:Bt("recharts-cross",o),d:fY(t,r,i,l,a,n)}))};function pY(e,t,r,a){var n=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-n:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-n,width:e==="horizontal"?a:r.width-1,height:e==="horizontal"?r.height-1:a}}function ow(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function xY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ow(Object(r),!0).forEach(function(a){gY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ow(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function gY(e,t,r){return(t=vY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vY(e){var t=bY(e,"string");return typeof t=="symbol"?t:t+""}function bY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xs(e,t){var r=xY({},e),a=t,n=Object.keys(t),i=n.reduce((l,o)=>(l[o]===void 0&&a[o]!==void 0&&(l[o]=a[o]),l),r);return i}function yY(){}function cw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function dw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cw(Object(r),!0).forEach(function(a){jY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function jY(e,t,r){return(t=wY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wY(e){var t=NY(e,"string");return typeof t=="symbol"?t:t+""}function NY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SY=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),jC=(e,t,r)=>e.map(a=>"".concat(SY(a)," ").concat(t,"ms ").concat(r)).join(","),EY=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,a)=>r.filter(n=>a.includes(n))),xc=(e,t)=>Object.keys(t).reduce((r,a)=>dw(dw({},r),{},{[a]:e(a,t[a])}),{});function uw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function js(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uw(Object(r),!0).forEach(function(a){TY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function TY(e,t,r){return(t=AY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AY(e){var t=CY(e,"string");return typeof t=="symbol"?t:t+""}function CY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Su=(e,t,r)=>e+(t-e)*r,xx=e=>{var{from:t,to:r}=e;return t!==r},wC=(e,t,r)=>{var a=xc((n,i)=>{if(xx(i)){var[l,o]=e(i.from,i.to,i.velocity);return js(js({},i),{},{from:l,velocity:o})}return i},t);return r<1?xc((n,i)=>xx(i)?js(js({},i),{},{velocity:Su(i.velocity,a[n].velocity,r),from:Su(i.from,a[n].from,r)}):i,t):wC(e,a,r-1)};function _Y(e,t,r,a,n,i){var l,o=a.reduce((f,x)=>js(js({},f),{},{[x]:{from:e[x],velocity:0,to:t[x]}}),{}),c=()=>xc((f,x)=>x.from,o),u=()=>!Object.values(o).filter(xx).length,d=null,m=f=>{l||(l=f);var x=f-l,p=x/r.dt;o=wC(r,o,p),n(js(js(js({},e),t),c())),l=f,u()||(d=i.setTimeout(m))};return()=>(d=i.setTimeout(m),()=>{d()})}function kY(e,t,r,a,n,i,l){var o=null,c=n.reduce((m,f)=>js(js({},m),{},{[f]:[e[f],t[f]]}),{}),u,d=m=>{u||(u=m);var f=(m-u)/a,x=xc((h,g)=>Su(...g,r(f)),c);if(i(js(js(js({},e),t),x)),f<1)o=l.setTimeout(d);else{var p=xc((h,g)=>Su(...g,r(1)),c);i(js(js(js({},e),t),p))}};return()=>(o=l.setTimeout(d),()=>{o()})}const DY=(e,t,r,a,n,i)=>{var l=EY(e,t);return r.isStepper===!0?_Y(e,t,r,l,n,i):kY(e,t,r,a,l,n,i)};var Eu=1e-4,NC=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],SC=(e,t)=>e.map((r,a)=>r*t**a).reduce((r,a)=>r+a),mw=(e,t)=>r=>{var a=NC(e,t);return SC(a,r)},IY=(e,t)=>r=>{var a=NC(e,t),n=[...a.map((i,l)=>i*l).slice(1),0];return SC(n,r)},fw=function(){for(var t,r,a,n,i=arguments.length,l=new Array(i),o=0;o<i;o++)l[o]=arguments[o];if(l.length===1)switch(l[0]){case"linear":[t,a,r,n]=[0,0,1,1];break;case"ease":[t,a,r,n]=[.25,.1,.25,1];break;case"ease-in":[t,a,r,n]=[.42,0,1,1];break;case"ease-out":[t,a,r,n]=[.42,0,.58,1];break;case"ease-in-out":[t,a,r,n]=[0,0,.58,1];break;default:{var c=l[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,a,r,n]=c[1].split(")")[0].split(",").map(p=>parseFloat(p)))}}else l.length===4&&([t,a,r,n]=l);var u=mw(t,r),d=mw(a,n),m=IY(t,r),f=p=>p>1?1:p<0?0:p,x=p=>{for(var h=p>1?1:p,g=h,b=0;b<8;++b){var j=u(g)-h,y=m(g);if(Math.abs(j-h)<Eu||y<Eu)return d(g);g=f(g-j/y)}return d(g)};return x.isStepper=!1,x},OY=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:a=8,dt:n=17}=t,i=(l,o,c)=>{var u=-(l-o)*r,d=c*a,m=c+(u-d)*n/1e3,f=c*n/1e3+l;return Math.abs(f-o)<Eu&&Math.abs(m)<Eu?[o,0]:[f,m]};return i.isStepper=!0,i.dt=n,i},PY=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return fw(e);case"spring":return OY();default:if(e.split("(")[0]==="cubic-bezier")return fw(e)}return typeof e=="function"?e:null};function RY(e){var t,r=()=>null,a=!1,n=null,i=l=>{if(!a){if(Array.isArray(l)){if(!l.length)return;var o=l,[c,...u]=o;if(typeof c=="number"){n=e.setTimeout(i.bind(null,u),c);return}i(c),n=e.setTimeout(i.bind(null,u));return}typeof l=="string"&&(t=l,r(t)),typeof l=="object"&&(t=l,r(t)),typeof l=="function"&&l()}};return{stop:()=>{a=!0},start:l=>{a=!1,n&&(n(),n=null),i(l)},subscribe:l=>(r=l,()=>{r=()=>null}),getTimeoutController:()=>e}}class LY{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),n=null,i=l=>{l-a>=r?t(l):typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(i))};return n=requestAnimationFrame(i),()=>{cancelAnimationFrame(n)}}}function FY(){return RY(new LY)}var MY=v.createContext(FY);function BY(e,t){var r=v.useContext(MY);return v.useMemo(()=>t??r(e),[e,t,r])}var zY={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},hw={t:0},bh={t:1};function km(e){var t=Xs(e,zY),{isActive:r,canBegin:a,duration:n,easing:i,begin:l,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=BY(t.animationId,t.animationManager),[m,f]=v.useState(r?hw:bh),x=v.useRef(null);return v.useEffect(()=>{r||f(bh)},[r]),v.useEffect(()=>{if(!r||!a)return yY;var p=DY(hw,bh,PY(i),n,f,d.getTimeoutController()),h=()=>{x.current=p()};return d.start([c,l,h,n,o]),()=>{d.stop(),x.current&&x.current(),o()}},[r,a,n,i,l,c,o,d]),u(m.t)}function Dm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(fc(t)),a=v.useRef(e);return a.current!==e&&(r.current=fc(t),a.current=e),r.current}function pw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function xw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pw(Object(r),!0).forEach(function(a){UY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function UY(e,t,r){return(t=$Y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Y(e){var t=WY(e,"string");return typeof t=="symbol"?t:t+""}function WY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tu(){return Tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Tu.apply(null,arguments)}var gw=(e,t,r,a,n)=>{var i=Math.min(Math.abs(r)/2,Math.abs(a)/2),l=a>=0?1:-1,o=r>=0?1:-1,c=a>=0&&r>=0||a<0&&r<0?1:0,u;if(i>0&&n instanceof Array){for(var d=[0,0,0,0],m=0,f=4;m<f;m++)d[m]=n[m]>i?i:n[m];u="M".concat(e,",").concat(t+l*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+l*d[1])),u+="L ".concat(e+r,",").concat(t+a-l*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+a)),u+="L ".concat(e+o*d[3],",").concat(t+a),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+a-l*d[3])),u+="Z"}else if(i>0&&n===+n&&n>0){var x=Math.min(i,n);u="M ".concat(e,",").concat(t+l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+o*x,",").concat(t,`
            L `).concat(e+r-o*x,",").concat(t,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+r,",").concat(t+l*x,`
            L `).concat(e+r,",").concat(t+a-l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+r-o*x,",").concat(t+a,`
            L `).concat(e+o*x,",").concat(t+a,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e,",").concat(t+a-l*x," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return u},HY={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},EC=e=>{var t=Xs(e,HY),r=v.useRef(null),[a,n]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var R=r.current.getTotalLength();R&&n(R)}catch{}},[]);var{x:i,y:l,width:o,height:c,radius:u,className:d}=t,{animationEasing:m,animationDuration:f,animationBegin:x,isAnimationActive:p,isUpdateAnimationActive:h}=t,g=v.useRef(o),b=v.useRef(c),j=v.useRef(i),y=v.useRef(l),w=v.useMemo(()=>({x:i,y:l,width:o,height:c,radius:u}),[i,l,o,c,u]),N=Dm(w,"rectangle-");if(i!==+i||l!==+l||o!==+o||c!==+c||o===0||c===0)return null;var S=Bt("recharts-rectangle",d);if(!h)return v.createElement("path",Tu({},as(t,!0),{className:S,d:gw(i,l,o,c,u)}));var E=g.current,_=b.current,T=j.current,C=y.current,A="0px ".concat(a===-1?1:a,"px"),D="".concat(a,"px 0px"),P=jC(["strokeDasharray"],f,typeof m=="string"?m:void 0);return v.createElement(km,{animationId:N,key:N,canBegin:a>0,duration:f,easing:m,isActive:h,begin:x},R=>{var M=Ss(E,o,R),X=Ss(_,c,R),ie=Ss(T,i,R),ae=Ss(C,l,R);r.current&&(g.current=M,b.current=X,j.current=ie,y.current=ae);var V;return p?R>0?V={transition:P,strokeDasharray:D}:V={strokeDasharray:A}:V={strokeDasharray:D},v.createElement("path",Tu({},as(t,!0),{className:S,d:gw(ie,ae,M,X,u),ref:r,style:xw(xw({},V),t.style)}))})};function TC(e){var{cx:t,cy:r,radius:a,startAngle:n,endAngle:i}=e,l=Jr(t,r,a,n),o=Jr(t,r,a,i);return{points:[l,o],cx:t,cy:r,radius:a,startAngle:n,endAngle:i}}function gx(){return gx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gx.apply(null,arguments)}var VY=(e,t)=>{var r=ms(t-e),a=Math.min(Math.abs(t-e),359.999);return r*a},_d=e=>{var{cx:t,cy:r,radius:a,angle:n,sign:i,isExternal:l,cornerRadius:o,cornerIsExternal:c}=e,u=o*(l?1:-1)+a,d=Math.asin(o/u)/Nu,m=c?n:n+i*d,f=Jr(t,r,u,m),x=Jr(t,r,a,m),p=c?n-i*d:n,h=Jr(t,r,u*Math.cos(d*Nu),p);return{center:f,circleTangency:x,lineTangency:h,theta:d}},AC=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:n,startAngle:i,endAngle:l}=e,o=VY(i,l),c=i+o,u=Jr(t,r,n,i),d=Jr(t,r,n,c),m="M ".concat(u.x,",").concat(u.y,`
    A `).concat(n,",").concat(n,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(a>0){var f=Jr(t,r,a,i),x=Jr(t,r,a,c);m+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},GY=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:n,cornerRadius:i,forceCornerRadius:l,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=ms(u-c),{circleTangency:m,lineTangency:f,theta:x}=_d({cx:t,cy:r,radius:n,angle:c,sign:d,cornerRadius:i,cornerIsExternal:o}),{circleTangency:p,lineTangency:h,theta:g}=_d({cx:t,cy:r,radius:n,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:o}),b=o?Math.abs(c-u):Math.abs(c-u)-x-g;if(b<0)return l?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):AC({cx:t,cy:r,innerRadius:a,outerRadius:n,startAngle:c,endAngle:u});var j="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(n,",").concat(n,",0,").concat(+(b>180),",").concat(+(d<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(h.x,",").concat(h.y,`
  `);if(a>0){var{circleTangency:y,lineTangency:w,theta:N}=_d({cx:t,cy:r,radius:a,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:S,lineTangency:E,theta:_}=_d({cx:t,cy:r,radius:a,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),T=o?Math.abs(c-u):Math.abs(c-u)-N-_;if(T<0&&i===0)return"".concat(j,"L").concat(t,",").concat(r,"Z");j+="L".concat(E.x,",").concat(E.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(S.x,",").concat(S.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(T>180),",").concat(+(d>0),",").concat(y.x,",").concat(y.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(w.x,",").concat(w.y,"Z")}else j+="L".concat(t,",").concat(r,"Z");return j},qY={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},CC=e=>{var t=Xs(e,qY),{cx:r,cy:a,innerRadius:n,outerRadius:i,cornerRadius:l,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:m}=t;if(i<n||u===d)return null;var f=Bt("recharts-sector",m),x=i-n,p=Ms(l,x,0,!0),h;return p>0&&Math.abs(u-d)<360?h=GY({cx:r,cy:a,innerRadius:n,outerRadius:i,cornerRadius:Math.min(p,x/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):h=AC({cx:r,cy:a,innerRadius:n,outerRadius:i,startAngle:u,endAngle:d}),v.createElement("path",gx({},as(t,!0),{className:f,d:h}))};function KY(e,t,r){var a,n,i,l;if(e==="horizontal")a=t.x,i=a,n=r.top,l=r.top+r.height;else if(e==="vertical")n=t.y,l=n,a=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:d,angle:m}=t,f=Jr(o,c,u,m),x=Jr(o,c,d,m);a=f.x,n=f.y,i=x.x,l=x.y}else return TC(t);return[{x:a,y:n},{x:i,y:l}]}var yh={},jh={},wh={},vw;function YY(){return vw||(vw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PA();function r(a){return t.isSymbol(a)?NaN:Number(a)}e.toNumber=r})(wh)),wh}var bw;function XY(){return bw||(bw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YY();function r(a){return a?(a=t.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=r})(jh)),jh}var yw;function JY(){return yw||(yw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RA(),r=XY();function a(n,i,l){l&&typeof l!="number"&&t.isIterateeCall(n,i,l)&&(i=l=void 0),n=r.toFinite(n),i===void 0?(i=n,n=0):i=r.toFinite(i),l=l===void 0?n<i?1:-1:r.toFinite(l);const o=Math.max(Math.ceil((i-n)/(l||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=n,n+=l;return c}e.range=a})(yh)),yh}var Nh,jw;function ZY(){return jw||(jw=1,Nh=JY().range),Nh}var QY=ZY();const _C=fi(QY);function ai(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function eX(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function pv(e){let t,r,a;e.length!==2?(t=ai,r=(o,c)=>ai(e(o),c),a=(o,c)=>e(o)-c):(t=e===ai||e===eX?e:tX,r=e,a=e);function n(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const m=u+d>>>1;r(o[m],c)<0?u=m+1:d=m}while(u<d)}return u}function i(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const m=u+d>>>1;r(o[m],c)<=0?u=m+1:d=m}while(u<d)}return u}function l(o,c,u=0,d=o.length){const m=n(o,c,u,d-1);return m>u&&a(o[m-1],c)>-a(o[m],c)?m-1:m}return{left:n,center:l,right:i}}function tX(){return 0}function kC(e){return e===null?NaN:+e}function*rX(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const sX=pv(ai),Vc=sX.right;pv(kC).center;class ww extends Map{constructor(t,r=iX){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[a,n]of t)this.set(a,n)}get(t){return super.get(Nw(this,t))}has(t){return super.has(Nw(this,t))}set(t,r){return super.set(aX(this,t),r)}delete(t){return super.delete(nX(this,t))}}function Nw({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):r}function aX({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}function nX({_intern:e,_key:t},r){const a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}function iX(e){return e!==null&&typeof e=="object"?e.valueOf():e}function lX(e=ai){if(e===ai)return DC;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const a=e(t,r);return a||a===0?a:(e(r,r)===0)-(e(t,t)===0)}}function DC(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const oX=Math.sqrt(50),cX=Math.sqrt(10),dX=Math.sqrt(2);function Au(e,t,r){const a=(t-e)/Math.max(0,r),n=Math.floor(Math.log10(a)),i=a/Math.pow(10,n),l=i>=oX?10:i>=cX?5:i>=dX?2:1;let o,c,u;return n<0?(u=Math.pow(10,-n)/l,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,n)*l,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?Au(e,t,r*2):[o,c,u]}function vx(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const a=t<e,[n,i,l]=a?Au(t,e,r):Au(e,t,r);if(!(i>=n))return[];const o=i-n+1,c=new Array(o);if(a)if(l<0)for(let u=0;u<o;++u)c[u]=(i-u)/-l;else for(let u=0;u<o;++u)c[u]=(i-u)*l;else if(l<0)for(let u=0;u<o;++u)c[u]=(n+u)/-l;else for(let u=0;u<o;++u)c[u]=(n+u)*l;return c}function bx(e,t,r){return t=+t,e=+e,r=+r,Au(e,t,r)[2]}function yx(e,t,r){t=+t,e=+e,r=+r;const a=t<e,n=a?bx(t,e,r):bx(e,t,r);return(a?-1:1)*(n<0?1/-n:n)}function Sw(e,t){let r;for(const a of e)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);return r}function Ew(e,t){let r;for(const a of e)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);return r}function IC(e,t,r=0,a=1/0,n){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(e.length-1,a)),!(r<=t&&t<=a))return e;for(n=n===void 0?DC:lX(n);a>r;){if(a-r>600){const c=a-r+1,u=t-r+1,d=Math.log(c),m=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*m*(c-m)/c)*(u-c/2<0?-1:1),x=Math.max(r,Math.floor(t-u*m/c+f)),p=Math.min(a,Math.floor(t+(c-u)*m/c+f));IC(e,t,x,p,n)}const i=e[t];let l=r,o=a;for(To(e,r,t),n(e[a],i)>0&&To(e,r,a);l<o;){for(To(e,l,o),++l,--o;n(e[l],i)<0;)++l;for(;n(e[o],i)>0;)--o}n(e[r],i)===0?To(e,r,o):(++o,To(e,o,a)),o<=t&&(r=o+1),t<=o&&(a=o-1)}return e}function To(e,t,r){const a=e[t];e[t]=e[r],e[r]=a}function uX(e,t,r){if(e=Float64Array.from(rX(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return Ew(e);if(t>=1)return Sw(e);var a,n=(a-1)*t,i=Math.floor(n),l=Sw(IC(e,i).subarray(0,i+1)),o=Ew(e.subarray(i+1));return l+(o-l)*(n-i)}}function mX(e,t,r=kC){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,n=(a-1)*t,i=Math.floor(n),l=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return l+(o-l)*(n-i)}}function fX(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var a=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(n);++a<n;)i[a]=e+a*r;return i}function Wa(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function $n(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const jx=Symbol("implicit");function xv(){var e=new ww,t=[],r=[],a=jx;function n(i){let l=e.get(i);if(l===void 0){if(a!==jx)return a;e.set(i,l=t.push(i)-1)}return r[l%r.length]}return n.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new ww;for(const l of i)e.has(l)||e.set(l,t.push(l)-1);return n},n.range=function(i){return arguments.length?(r=Array.from(i),n):r.slice()},n.unknown=function(i){return arguments.length?(a=i,n):a},n.copy=function(){return xv(t,r).unknown(a)},Wa.apply(n,arguments),n}function gv(){var e=xv().unknown(void 0),t=e.domain,r=e.range,a=0,n=1,i,l,o=!1,c=0,u=0,d=.5;delete e.unknown;function m(){var f=t().length,x=n<a,p=x?n:a,h=x?a:n;i=(h-p)/Math.max(1,f-c+u*2),o&&(i=Math.floor(i)),p+=(h-p-i*(f-c))*d,l=i*(1-c),o&&(p=Math.round(p),l=Math.round(l));var g=fX(f).map(function(b){return p+i*b});return r(x?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),m()):t()},e.range=function(f){return arguments.length?([a,n]=f,a=+a,n=+n,m()):[a,n]},e.rangeRound=function(f){return[a,n]=f,a=+a,n=+n,o=!0,m()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,m()):o},e.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),m()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),m()):c},e.paddingOuter=function(f){return arguments.length?(u=+f,m()):u},e.align=function(f){return arguments.length?(d=Math.max(0,Math.min(1,f)),m()):d},e.copy=function(){return gv(t(),[a,n]).round(o).paddingInner(c).paddingOuter(u).align(d)},Wa.apply(m(),arguments)}function OC(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return OC(t())},e}function hX(){return OC(gv.apply(null,arguments).paddingInner(1))}function vv(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function PC(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function Gc(){}var gc=.7,Cu=1/gc,Pl="\\s*([+-]?\\d+)\\s*",vc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pX=/^#([0-9a-f]{3,8})$/,xX=new RegExp(`^rgb\\(${Pl},${Pl},${Pl}\\)$`),gX=new RegExp(`^rgb\\(${dn},${dn},${dn}\\)$`),vX=new RegExp(`^rgba\\(${Pl},${Pl},${Pl},${vc}\\)$`),bX=new RegExp(`^rgba\\(${dn},${dn},${dn},${vc}\\)$`),yX=new RegExp(`^hsl\\(${vc},${dn},${dn}\\)$`),jX=new RegExp(`^hsla\\(${vc},${dn},${dn},${vc}\\)$`),Tw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vv(Gc,bc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Aw,formatHex:Aw,formatHex8:wX,formatHsl:NX,formatRgb:Cw,toString:Cw});function Aw(){return this.rgb().formatHex()}function wX(){return this.rgb().formatHex8()}function NX(){return RC(this).formatHsl()}function Cw(){return this.rgb().formatRgb()}function bc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=pX.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?_w(t):r===3?new Qs(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?kd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?kd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xX.exec(e))?new Qs(t[1],t[2],t[3],1):(t=gX.exec(e))?new Qs(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vX.exec(e))?kd(t[1],t[2],t[3],t[4]):(t=bX.exec(e))?kd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=yX.exec(e))?Iw(t[1],t[2]/100,t[3]/100,1):(t=jX.exec(e))?Iw(t[1],t[2]/100,t[3]/100,t[4]):Tw.hasOwnProperty(e)?_w(Tw[e]):e==="transparent"?new Qs(NaN,NaN,NaN,0):null}function _w(e){return new Qs(e>>16&255,e>>8&255,e&255,1)}function kd(e,t,r,a){return a<=0&&(e=t=r=NaN),new Qs(e,t,r,a)}function SX(e){return e instanceof Gc||(e=bc(e)),e?(e=e.rgb(),new Qs(e.r,e.g,e.b,e.opacity)):new Qs}function wx(e,t,r,a){return arguments.length===1?SX(e):new Qs(e,t,r,a??1)}function Qs(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}vv(Qs,wx,PC(Gc,{brighter(e){return e=e==null?Cu:Math.pow(Cu,e),new Qs(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?gc:Math.pow(gc,e),new Qs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Qs(Hi(this.r),Hi(this.g),Hi(this.b),_u(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kw,formatHex:kw,formatHex8:EX,formatRgb:Dw,toString:Dw}));function kw(){return`#${Pi(this.r)}${Pi(this.g)}${Pi(this.b)}`}function EX(){return`#${Pi(this.r)}${Pi(this.g)}${Pi(this.b)}${Pi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Dw(){const e=_u(this.opacity);return`${e===1?"rgb(":"rgba("}${Hi(this.r)}, ${Hi(this.g)}, ${Hi(this.b)}${e===1?")":`, ${e})`}`}function _u(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Hi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Pi(e){return e=Hi(e),(e<16?"0":"")+e.toString(16)}function Iw(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new qa(e,t,r,a)}function RC(e){if(e instanceof qa)return new qa(e.h,e.s,e.l,e.opacity);if(e instanceof Gc||(e=bc(e)),!e)return new qa;if(e instanceof qa)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,n=Math.min(t,r,a),i=Math.max(t,r,a),l=NaN,o=i-n,c=(i+n)/2;return o?(t===i?l=(r-a)/o+(r<a)*6:r===i?l=(a-t)/o+2:l=(t-r)/o+4,o/=c<.5?i+n:2-i-n,l*=60):o=c>0&&c<1?0:l,new qa(l,o,c,e.opacity)}function TX(e,t,r,a){return arguments.length===1?RC(e):new qa(e,t,r,a??1)}function qa(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}vv(qa,TX,PC(Gc,{brighter(e){return e=e==null?Cu:Math.pow(Cu,e),new qa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?gc:Math.pow(gc,e),new qa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,n=2*r-a;return new Qs(Sh(e>=240?e-240:e+120,n,a),Sh(e,n,a),Sh(e<120?e+240:e-120,n,a),this.opacity)},clamp(){return new qa(Ow(this.h),Dd(this.s),Dd(this.l),_u(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=_u(this.opacity);return`${e===1?"hsl(":"hsla("}${Ow(this.h)}, ${Dd(this.s)*100}%, ${Dd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ow(e){return e=(e||0)%360,e<0?e+360:e}function Dd(e){return Math.max(0,Math.min(1,e||0))}function Sh(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const bv=e=>()=>e;function AX(e,t){return function(r){return e+r*t}}function CX(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function _X(e){return(e=+e)==1?LC:function(t,r){return r-t?CX(t,r,e):bv(isNaN(t)?r:t)}}function LC(e,t){var r=t-e;return r?AX(e,r):bv(isNaN(e)?t:e)}const Pw=(function e(t){var r=_X(t);function a(n,i){var l=r((n=wx(n)).r,(i=wx(i)).r),o=r(n.g,i.g),c=r(n.b,i.b),u=LC(n.opacity,i.opacity);return function(d){return n.r=l(d),n.g=o(d),n.b=c(d),n.opacity=u(d),n+""}}return a.gamma=e,a})(1);function kX(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,a=t.slice(),n;return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function DX(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function IX(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,n=new Array(a),i=new Array(r),l;for(l=0;l<a;++l)n[l]=io(e[l],t[l]);for(;l<r;++l)i[l]=t[l];return function(o){for(l=0;l<a;++l)i[l]=n[l](o);return i}}function OX(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function ku(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function PX(e,t){var r={},a={},n;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in e?r[n]=io(e[n],t[n]):a[n]=t[n];return function(i){for(n in r)a[n]=r[n](i);return a}}var Nx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Eh=new RegExp(Nx.source,"g");function RX(e){return function(){return e}}function LX(e){return function(t){return e(t)+""}}function FX(e,t){var r=Nx.lastIndex=Eh.lastIndex=0,a,n,i,l=-1,o=[],c=[];for(e=e+"",t=t+"";(a=Nx.exec(e))&&(n=Eh.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),o[l]?o[l]+=i:o[++l]=i),(a=a[0])===(n=n[0])?o[l]?o[l]+=n:o[++l]=n:(o[++l]=null,c.push({i:l,x:ku(a,n)})),r=Eh.lastIndex;return r<t.length&&(i=t.slice(r),o[l]?o[l]+=i:o[++l]=i),o.length<2?c[0]?LX(c[0].x):RX(t):(t=c.length,function(u){for(var d=0,m;d<t;++d)o[(m=c[d]).i]=m.x(u);return o.join("")})}function io(e,t){var r=typeof t,a;return t==null||r==="boolean"?bv(t):(r==="number"?ku:r==="string"?(a=bc(t))?(t=a,Pw):FX:t instanceof bc?Pw:t instanceof Date?OX:DX(t)?kX:Array.isArray(t)?IX:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?PX:ku)(e,t)}function yv(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function MX(e,t){t===void 0&&(t=e,e=io);for(var r=0,a=t.length-1,n=t[0],i=new Array(a<0?0:a);r<a;)i[r]=e(n,n=t[++r]);return function(l){var o=Math.max(0,Math.min(a-1,Math.floor(l*=a)));return i[o](l-o)}}function BX(e){return function(){return e}}function Du(e){return+e}var Rw=[0,1];function Ks(e){return e}function Sx(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:BX(isNaN(t)?NaN:.5)}function zX(e,t){var r;return e>t&&(r=e,e=t,t=r),function(a){return Math.max(e,Math.min(t,a))}}function UX(e,t,r){var a=e[0],n=e[1],i=t[0],l=t[1];return n<a?(a=Sx(n,a),i=r(l,i)):(a=Sx(a,n),i=r(i,l)),function(o){return i(a(o))}}function $X(e,t,r){var a=Math.min(e.length,t.length)-1,n=new Array(a),i=new Array(a),l=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<a;)n[l]=Sx(e[l],e[l+1]),i[l]=r(t[l],t[l+1]);return function(o){var c=Vc(e,o,1,a)-1;return i[c](n[c](o))}}function qc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Im(){var e=Rw,t=Rw,r=io,a,n,i,l=Ks,o,c,u;function d(){var f=Math.min(e.length,t.length);return l!==Ks&&(l=zX(e[0],e[f-1])),o=f>2?$X:UX,c=u=null,m}function m(f){return f==null||isNaN(f=+f)?i:(c||(c=o(e.map(a),t,r)))(a(l(f)))}return m.invert=function(f){return l(n((u||(u=o(t,e.map(a),ku)))(f)))},m.domain=function(f){return arguments.length?(e=Array.from(f,Du),d()):e.slice()},m.range=function(f){return arguments.length?(t=Array.from(f),d()):t.slice()},m.rangeRound=function(f){return t=Array.from(f),r=yv,d()},m.clamp=function(f){return arguments.length?(l=f?!0:Ks,d()):l!==Ks},m.interpolate=function(f){return arguments.length?(r=f,d()):r},m.unknown=function(f){return arguments.length?(i=f,m):i},function(f,x){return a=f,n=x,d()}}function jv(){return Im()(Ks,Ks)}function WX(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Iu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function Gl(e){return e=Iu(Math.abs(e)),e?e[1]:NaN}function HX(e,t){return function(r,a){for(var n=r.length,i=[],l=0,o=e[0],c=0;n>0&&o>0&&(c+o+1>a&&(o=Math.max(1,a-c)),i.push(r.substring(n-=o,n+o)),!((c+=o+1)>a));)o=e[l=(l+1)%e.length];return i.reverse().join(t)}}function VX(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var GX=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function yc(e){if(!(t=GX.exec(e)))throw new Error("invalid format: "+e);var t;return new wv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}yc.prototype=wv.prototype;function wv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}wv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function qX(e){e:for(var t=e.length,r=1,a=-1,n;r<t;++r)switch(e[r]){case".":a=n=r;break;case"0":a===0&&(a=r),n=r;break;default:if(!+e[r])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(n+1):e}var FC;function KX(e,t){var r=Iu(e,t);if(!r)return e+"";var a=r[0],n=r[1],i=n-(FC=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,l=a.length;return i===l?a:i>l?a+new Array(i-l+1).join("0"):i>0?a.slice(0,i)+"."+a.slice(i):"0."+new Array(1-i).join("0")+Iu(e,Math.max(0,t+i-1))[0]}function Lw(e,t){var r=Iu(e,t);if(!r)return e+"";var a=r[0],n=r[1];return n<0?"0."+new Array(-n).join("0")+a:a.length>n+1?a.slice(0,n+1)+"."+a.slice(n+1):a+new Array(n-a.length+2).join("0")}const Fw={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:WX,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Lw(e*100,t),r:Lw,s:KX,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Mw(e){return e}var Bw=Array.prototype.map,zw=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function YX(e){var t=e.grouping===void 0||e.thousands===void 0?Mw:HX(Bw.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",n=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Mw:VX(Bw.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(m){m=yc(m);var f=m.fill,x=m.align,p=m.sign,h=m.symbol,g=m.zero,b=m.width,j=m.comma,y=m.precision,w=m.trim,N=m.type;N==="n"?(j=!0,N="g"):Fw[N]||(y===void 0&&(y=12),w=!0,N="g"),(g||f==="0"&&x==="=")&&(g=!0,f="0",x="=");var S=h==="$"?r:h==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",E=h==="$"?a:/[%p]/.test(N)?l:"",_=Fw[N],T=/[defgprs%]/.test(N);y=y===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function C(A){var D=S,P=E,R,M,X;if(N==="c")P=_(A)+P,A="";else{A=+A;var ie=A<0||1/A<0;if(A=isNaN(A)?c:_(Math.abs(A),y),w&&(A=qX(A)),ie&&+A==0&&p!=="+"&&(ie=!1),D=(ie?p==="("?p:o:p==="-"||p==="("?"":p)+D,P=(N==="s"?zw[8+FC/3]:"")+P+(ie&&p==="("?")":""),T){for(R=-1,M=A.length;++R<M;)if(X=A.charCodeAt(R),48>X||X>57){P=(X===46?n+A.slice(R+1):A.slice(R))+P,A=A.slice(0,R);break}}}j&&!g&&(A=t(A,1/0));var ae=D.length+A.length+P.length,V=ae<b?new Array(b-ae+1).join(f):"";switch(j&&g&&(A=t(V+A,V.length?b-P.length:1/0),V=""),x){case"<":A=D+A+P+V;break;case"=":A=D+V+A+P;break;case"^":A=V.slice(0,ae=V.length>>1)+D+A+P+V.slice(ae);break;default:A=V+D+A+P;break}return i(A)}return C.toString=function(){return m+""},C}function d(m,f){var x=u((m=yc(m),m.type="f",m)),p=Math.max(-8,Math.min(8,Math.floor(Gl(f)/3)))*3,h=Math.pow(10,-p),g=zw[8+p/3];return function(b){return x(h*b)+g}}return{format:u,formatPrefix:d}}var Id,Nv,MC;XX({thousands:",",grouping:[3],currency:["$",""]});function XX(e){return Id=YX(e),Nv=Id.format,MC=Id.formatPrefix,Id}function JX(e){return Math.max(0,-Gl(Math.abs(e)))}function ZX(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Gl(t)/3)))*3-Gl(Math.abs(e)))}function QX(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Gl(t)-Gl(e))+1}function BC(e,t,r,a){var n=yx(e,t,r),i;switch(a=yc(a??",f"),a.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(i=ZX(n,l))&&(a.precision=i),MC(a,l)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(i=QX(n,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=i-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(i=JX(n))&&(a.precision=i-(a.type==="%")*2);break}}return Nv(a)}function vi(e){var t=e.domain;return e.ticks=function(r){var a=t();return vx(a[0],a[a.length-1],r??10)},e.tickFormat=function(r,a){var n=t();return BC(n[0],n[n.length-1],r??10,a)},e.nice=function(r){r==null&&(r=10);var a=t(),n=0,i=a.length-1,l=a[n],o=a[i],c,u,d=10;for(o<l&&(u=l,l=o,o=u,u=n,n=i,i=u);d-- >0;){if(u=bx(l,o,r),u===c)return a[n]=l,a[i]=o,t(a);if(u>0)l=Math.floor(l/u)*u,o=Math.ceil(o/u)*u;else if(u<0)l=Math.ceil(l*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function zC(){var e=jv();return e.copy=function(){return qc(e,zC())},Wa.apply(e,arguments),vi(e)}function UC(e){var t;function r(a){return a==null||isNaN(a=+a)?t:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,Du),r):e.slice()},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return UC(e).unknown(t)},e=arguments.length?Array.from(e,Du):[0,1],vi(r)}function $C(e,t){e=e.slice();var r=0,a=e.length-1,n=e[r],i=e[a],l;return i<n&&(l=r,r=a,a=l,l=n,n=i,i=l),e[r]=t.floor(n),e[a]=t.ceil(i),e}function Uw(e){return Math.log(e)}function $w(e){return Math.exp(e)}function eJ(e){return-Math.log(-e)}function tJ(e){return-Math.exp(-e)}function rJ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function sJ(e){return e===10?rJ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function aJ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Ww(e){return(t,r)=>-e(-t,r)}function Sv(e){const t=e(Uw,$w),r=t.domain;let a=10,n,i;function l(){return n=aJ(a),i=sJ(a),r()[0]<0?(n=Ww(n),i=Ww(i),e(eJ,tJ)):e(Uw,$w),t}return t.base=function(o){return arguments.length?(a=+o,l()):a},t.domain=function(o){return arguments.length?(r(o),l()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const m=d<u;m&&([u,d]=[d,u]);let f=n(u),x=n(d),p,h;const g=o==null?10:+o;let b=[];if(!(a%1)&&x-f<g){if(f=Math.floor(f),x=Math.ceil(x),u>0){for(;f<=x;++f)for(p=1;p<a;++p)if(h=f<0?p/i(-f):p*i(f),!(h<u)){if(h>d)break;b.push(h)}}else for(;f<=x;++f)for(p=a-1;p>=1;--p)if(h=f>0?p/i(-f):p*i(f),!(h<u)){if(h>d)break;b.push(h)}b.length*2<g&&(b=vx(u,d,g))}else b=vx(f,x,Math.min(x-f,g)).map(i);return m?b.reverse():b},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=a===10?"s":","),typeof c!="function"&&(!(a%1)&&(c=yc(c)).precision==null&&(c.trim=!0),c=Nv(c)),o===1/0)return c;const u=Math.max(1,a*o/t.ticks().length);return d=>{let m=d/i(Math.round(n(d)));return m*a<a-.5&&(m*=a),m<=u?c(d):""}},t.nice=()=>r($C(r(),{floor:o=>i(Math.floor(n(o))),ceil:o=>i(Math.ceil(n(o)))})),t}function WC(){const e=Sv(Im()).domain([1,10]);return e.copy=()=>qc(e,WC()).base(e.base()),Wa.apply(e,arguments),e}function Hw(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Vw(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Ev(e){var t=1,r=e(Hw(t),Vw(t));return r.constant=function(a){return arguments.length?e(Hw(t=+a),Vw(t)):t},vi(r)}function HC(){var e=Ev(Im());return e.copy=function(){return qc(e,HC()).constant(e.constant())},Wa.apply(e,arguments)}function Gw(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function nJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function iJ(e){return e<0?-e*e:e*e}function Tv(e){var t=e(Ks,Ks),r=1;function a(){return r===1?e(Ks,Ks):r===.5?e(nJ,iJ):e(Gw(r),Gw(1/r))}return t.exponent=function(n){return arguments.length?(r=+n,a()):r},vi(t)}function Av(){var e=Tv(Im());return e.copy=function(){return qc(e,Av()).exponent(e.exponent())},Wa.apply(e,arguments),e}function lJ(){return Av.apply(null,arguments).exponent(.5)}function qw(e){return Math.sign(e)*e*e}function oJ(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function VC(){var e=jv(),t=[0,1],r=!1,a;function n(i){var l=oJ(e(i));return isNaN(l)?a:r?Math.round(l):l}return n.invert=function(i){return e.invert(qw(i))},n.domain=function(i){return arguments.length?(e.domain(i),n):e.domain()},n.range=function(i){return arguments.length?(e.range((t=Array.from(i,Du)).map(qw)),n):t.slice()},n.rangeRound=function(i){return n.range(i).round(!0)},n.round=function(i){return arguments.length?(r=!!i,n):r},n.clamp=function(i){return arguments.length?(e.clamp(i),n):e.clamp()},n.unknown=function(i){return arguments.length?(a=i,n):a},n.copy=function(){return VC(e.domain(),t).round(r).clamp(e.clamp()).unknown(a)},Wa.apply(n,arguments),vi(n)}function GC(){var e=[],t=[],r=[],a;function n(){var l=0,o=Math.max(1,t.length);for(r=new Array(o-1);++l<o;)r[l-1]=mX(e,l/o);return i}function i(l){return l==null||isNaN(l=+l)?a:t[Vc(r,l)]}return i.invertExtent=function(l){var o=t.indexOf(l);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let o of l)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ai),n()},i.range=function(l){return arguments.length?(t=Array.from(l),n()):t.slice()},i.unknown=function(l){return arguments.length?(a=l,i):a},i.quantiles=function(){return r.slice()},i.copy=function(){return GC().domain(e).range(t).unknown(a)},Wa.apply(i,arguments)}function qC(){var e=0,t=1,r=1,a=[.5],n=[0,1],i;function l(c){return c!=null&&c<=c?n[Vc(a,c,0,r)]:i}function o(){var c=-1;for(a=new Array(r);++c<r;)a[c]=((c+1)*t-(c-r)*e)/(r+1);return l}return l.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},l.range=function(c){return arguments.length?(r=(n=Array.from(c)).length-1,o()):n.slice()},l.invertExtent=function(c){var u=n.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,a[0]]:u>=r?[a[r-1],t]:[a[u-1],a[u]]},l.unknown=function(c){return arguments.length&&(i=c),l},l.thresholds=function(){return a.slice()},l.copy=function(){return qC().domain([e,t]).range(n).unknown(i)},Wa.apply(vi(l),arguments)}function KC(){var e=[.5],t=[0,1],r,a=1;function n(i){return i!=null&&i<=i?t[Vc(e,i,0,a)]:r}return n.domain=function(i){return arguments.length?(e=Array.from(i),a=Math.min(e.length,t.length-1),n):e.slice()},n.range=function(i){return arguments.length?(t=Array.from(i),a=Math.min(e.length,t.length-1),n):t.slice()},n.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return KC().domain(e).range(t).unknown(r)},Wa.apply(n,arguments)}const Th=new Date,Ah=new Date;function is(e,t,r,a){function n(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return n.floor=i=>(e(i=new Date(+i)),i),n.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),n.round=i=>{const l=n(i),o=n.ceil(i);return i-l<o-i?l:o},n.offset=(i,l)=>(t(i=new Date(+i),l==null?1:Math.floor(l)),i),n.range=(i,l,o)=>{const c=[];if(i=n.ceil(i),o=o==null?1:Math.floor(o),!(i<l)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<l);return c},n.filter=i=>is(l=>{if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},(l,o)=>{if(l>=l)if(o<0)for(;++o<=0;)for(;t(l,-1),!i(l););else for(;--o>=0;)for(;t(l,1),!i(l););}),r&&(n.count=(i,l)=>(Th.setTime(+i),Ah.setTime(+l),e(Th),e(Ah),Math.floor(r(Th,Ah))),n.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?n.filter(a?l=>a(l)%i===0:l=>n.count(0,l)%i===0):n)),n}const Ou=is(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ou.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?is(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Ou);Ou.range;const wn=1e3,Pa=wn*60,Nn=Pa*60,On=Nn*24,Cv=On*7,Kw=On*30,Ch=On*365,Ri=is(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*wn)},(e,t)=>(t-e)/wn,e=>e.getUTCSeconds());Ri.range;const _v=is(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*wn)},(e,t)=>{e.setTime(+e+t*Pa)},(e,t)=>(t-e)/Pa,e=>e.getMinutes());_v.range;const kv=is(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Pa)},(e,t)=>(t-e)/Pa,e=>e.getUTCMinutes());kv.range;const Dv=is(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*wn-e.getMinutes()*Pa)},(e,t)=>{e.setTime(+e+t*Nn)},(e,t)=>(t-e)/Nn,e=>e.getHours());Dv.range;const Iv=is(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Nn)},(e,t)=>(t-e)/Nn,e=>e.getUTCHours());Iv.range;const Kc=is(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Pa)/On,e=>e.getDate()-1);Kc.range;const Om=is(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/On,e=>e.getUTCDate()-1);Om.range;const YC=is(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/On,e=>Math.floor(e/On));YC.range;function gl(e){return is(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Pa)/Cv)}const Pm=gl(0),Pu=gl(1),cJ=gl(2),dJ=gl(3),ql=gl(4),uJ=gl(5),mJ=gl(6);Pm.range;Pu.range;cJ.range;dJ.range;ql.range;uJ.range;mJ.range;function vl(e){return is(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Cv)}const Rm=vl(0),Ru=vl(1),fJ=vl(2),hJ=vl(3),Kl=vl(4),pJ=vl(5),xJ=vl(6);Rm.range;Ru.range;fJ.range;hJ.range;Kl.range;pJ.range;xJ.range;const Ov=is(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ov.range;const Pv=is(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Pv.range;const Pn=is(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Pn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:is(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Pn.range;const Rn=is(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Rn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:is(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Rn.range;function XC(e,t,r,a,n,i){const l=[[Ri,1,wn],[Ri,5,5*wn],[Ri,15,15*wn],[Ri,30,30*wn],[i,1,Pa],[i,5,5*Pa],[i,15,15*Pa],[i,30,30*Pa],[n,1,Nn],[n,3,3*Nn],[n,6,6*Nn],[n,12,12*Nn],[a,1,On],[a,2,2*On],[r,1,Cv],[t,1,Kw],[t,3,3*Kw],[e,1,Ch]];function o(u,d,m){const f=d<u;f&&([u,d]=[d,u]);const x=m&&typeof m.range=="function"?m:c(u,d,m),p=x?x.range(u,+d+1):[];return f?p.reverse():p}function c(u,d,m){const f=Math.abs(d-u)/m,x=pv(([,,g])=>g).right(l,f);if(x===l.length)return e.every(yx(u/Ch,d/Ch,m));if(x===0)return Ou.every(Math.max(yx(u,d,m),1));const[p,h]=l[f/l[x-1][2]<l[x][2]/f?x-1:x];return p.every(h)}return[o,c]}const[gJ,vJ]=XC(Rn,Pv,Rm,YC,Iv,kv),[bJ,yJ]=XC(Pn,Ov,Pm,Kc,Dv,_v);function _h(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function kh(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ao(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function jJ(e){var t=e.dateTime,r=e.date,a=e.time,n=e.periods,i=e.days,l=e.shortDays,o=e.months,c=e.shortMonths,u=Co(n),d=_o(n),m=Co(i),f=_o(i),x=Co(l),p=_o(l),h=Co(o),g=_o(o),b=Co(c),j=_o(c),y={a:ie,A:ae,b:V,B:me,c:null,d:eN,e:eN,f:HJ,g:eZ,G:rZ,H:UJ,I:$J,j:WJ,L:JC,m:VJ,M:GJ,p:ue,q:F,Q:sN,s:aN,S:qJ,u:KJ,U:YJ,V:XJ,w:JJ,W:ZJ,x:null,X:null,y:QJ,Y:tZ,Z:sZ,"%":rN},w={a:Y,A:z,b:k,B:O,c:null,d:tN,e:tN,f:lZ,g:gZ,G:bZ,H:aZ,I:nZ,j:iZ,L:QC,m:oZ,M:cZ,p:G,q:Z,Q:sN,s:aN,S:dZ,u:uZ,U:mZ,V:fZ,w:hZ,W:pZ,x:null,X:null,y:xZ,Y:vZ,Z:yZ,"%":rN},N={a:C,A,b:D,B:P,c:R,d:Zw,e:Zw,f:FJ,g:Jw,G:Xw,H:Qw,I:Qw,j:OJ,L:LJ,m:IJ,M:PJ,p:T,q:DJ,Q:BJ,s:zJ,S:RJ,u:TJ,U:AJ,V:CJ,w:EJ,W:_J,x:M,X,y:Jw,Y:Xw,Z:kJ,"%":MJ};y.x=S(r,y),y.X=S(a,y),y.c=S(t,y),w.x=S(r,w),w.X=S(a,w),w.c=S(t,w);function S(ee,de){return function(Ee){var B=[],Se=-1,Re=0,He=ee.length,st,Pe,Gt;for(Ee instanceof Date||(Ee=new Date(+Ee));++Se<He;)ee.charCodeAt(Se)===37&&(B.push(ee.slice(Re,Se)),(Pe=Yw[st=ee.charAt(++Se)])!=null?st=ee.charAt(++Se):Pe=st==="e"?" ":"0",(Gt=de[st])&&(st=Gt(Ee,Pe)),B.push(st),Re=Se+1);return B.push(ee.slice(Re,Se)),B.join("")}}function E(ee,de){return function(Ee){var B=Ao(1900,void 0,1),Se=_(B,ee,Ee+="",0),Re,He;if(Se!=Ee.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(de&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(Re=kh(Ao(B.y,0,1)),He=Re.getUTCDay(),Re=He>4||He===0?Ru.ceil(Re):Ru(Re),Re=Om.offset(Re,(B.V-1)*7),B.y=Re.getUTCFullYear(),B.m=Re.getUTCMonth(),B.d=Re.getUTCDate()+(B.w+6)%7):(Re=_h(Ao(B.y,0,1)),He=Re.getDay(),Re=He>4||He===0?Pu.ceil(Re):Pu(Re),Re=Kc.offset(Re,(B.V-1)*7),B.y=Re.getFullYear(),B.m=Re.getMonth(),B.d=Re.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),He="Z"in B?kh(Ao(B.y,0,1)).getUTCDay():_h(Ao(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(He+5)%7:B.w+B.U*7-(He+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,kh(B)):_h(B)}}function _(ee,de,Ee,B){for(var Se=0,Re=de.length,He=Ee.length,st,Pe;Se<Re;){if(B>=He)return-1;if(st=de.charCodeAt(Se++),st===37){if(st=de.charAt(Se++),Pe=N[st in Yw?de.charAt(Se++):st],!Pe||(B=Pe(ee,Ee,B))<0)return-1}else if(st!=Ee.charCodeAt(B++))return-1}return B}function T(ee,de,Ee){var B=u.exec(de.slice(Ee));return B?(ee.p=d.get(B[0].toLowerCase()),Ee+B[0].length):-1}function C(ee,de,Ee){var B=x.exec(de.slice(Ee));return B?(ee.w=p.get(B[0].toLowerCase()),Ee+B[0].length):-1}function A(ee,de,Ee){var B=m.exec(de.slice(Ee));return B?(ee.w=f.get(B[0].toLowerCase()),Ee+B[0].length):-1}function D(ee,de,Ee){var B=b.exec(de.slice(Ee));return B?(ee.m=j.get(B[0].toLowerCase()),Ee+B[0].length):-1}function P(ee,de,Ee){var B=h.exec(de.slice(Ee));return B?(ee.m=g.get(B[0].toLowerCase()),Ee+B[0].length):-1}function R(ee,de,Ee){return _(ee,t,de,Ee)}function M(ee,de,Ee){return _(ee,r,de,Ee)}function X(ee,de,Ee){return _(ee,a,de,Ee)}function ie(ee){return l[ee.getDay()]}function ae(ee){return i[ee.getDay()]}function V(ee){return c[ee.getMonth()]}function me(ee){return o[ee.getMonth()]}function ue(ee){return n[+(ee.getHours()>=12)]}function F(ee){return 1+~~(ee.getMonth()/3)}function Y(ee){return l[ee.getUTCDay()]}function z(ee){return i[ee.getUTCDay()]}function k(ee){return c[ee.getUTCMonth()]}function O(ee){return o[ee.getUTCMonth()]}function G(ee){return n[+(ee.getUTCHours()>=12)]}function Z(ee){return 1+~~(ee.getUTCMonth()/3)}return{format:function(ee){var de=S(ee+="",y);return de.toString=function(){return ee},de},parse:function(ee){var de=E(ee+="",!1);return de.toString=function(){return ee},de},utcFormat:function(ee){var de=S(ee+="",w);return de.toString=function(){return ee},de},utcParse:function(ee){var de=E(ee+="",!0);return de.toString=function(){return ee},de}}}var Yw={"-":"",_:" ",0:"0"},gs=/^\s*\d+/,wJ=/^%/,NJ=/[\\^$*+?|[\]().{}]/g;function Qt(e,t,r){var a=e<0?"-":"",n=(a?-e:e)+"",i=n.length;return a+(i<r?new Array(r-i+1).join(t)+n:n)}function SJ(e){return e.replace(NJ,"\\$&")}function Co(e){return new RegExp("^(?:"+e.map(SJ).join("|")+")","i")}function _o(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function EJ(e,t,r){var a=gs.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function TJ(e,t,r){var a=gs.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function AJ(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function CJ(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function _J(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function Xw(e,t,r){var a=gs.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function Jw(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function kJ(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function DJ(e,t,r){var a=gs.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function IJ(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function Zw(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function OJ(e,t,r){var a=gs.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function Qw(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function PJ(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function RJ(e,t,r){var a=gs.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function LJ(e,t,r){var a=gs.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function FJ(e,t,r){var a=gs.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function MJ(e,t,r){var a=wJ.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function BJ(e,t,r){var a=gs.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function zJ(e,t,r){var a=gs.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function eN(e,t){return Qt(e.getDate(),t,2)}function UJ(e,t){return Qt(e.getHours(),t,2)}function $J(e,t){return Qt(e.getHours()%12||12,t,2)}function WJ(e,t){return Qt(1+Kc.count(Pn(e),e),t,3)}function JC(e,t){return Qt(e.getMilliseconds(),t,3)}function HJ(e,t){return JC(e,t)+"000"}function VJ(e,t){return Qt(e.getMonth()+1,t,2)}function GJ(e,t){return Qt(e.getMinutes(),t,2)}function qJ(e,t){return Qt(e.getSeconds(),t,2)}function KJ(e){var t=e.getDay();return t===0?7:t}function YJ(e,t){return Qt(Pm.count(Pn(e)-1,e),t,2)}function ZC(e){var t=e.getDay();return t>=4||t===0?ql(e):ql.ceil(e)}function XJ(e,t){return e=ZC(e),Qt(ql.count(Pn(e),e)+(Pn(e).getDay()===4),t,2)}function JJ(e){return e.getDay()}function ZJ(e,t){return Qt(Pu.count(Pn(e)-1,e),t,2)}function QJ(e,t){return Qt(e.getFullYear()%100,t,2)}function eZ(e,t){return e=ZC(e),Qt(e.getFullYear()%100,t,2)}function tZ(e,t){return Qt(e.getFullYear()%1e4,t,4)}function rZ(e,t){var r=e.getDay();return e=r>=4||r===0?ql(e):ql.ceil(e),Qt(e.getFullYear()%1e4,t,4)}function sZ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Qt(t/60|0,"0",2)+Qt(t%60,"0",2)}function tN(e,t){return Qt(e.getUTCDate(),t,2)}function aZ(e,t){return Qt(e.getUTCHours(),t,2)}function nZ(e,t){return Qt(e.getUTCHours()%12||12,t,2)}function iZ(e,t){return Qt(1+Om.count(Rn(e),e),t,3)}function QC(e,t){return Qt(e.getUTCMilliseconds(),t,3)}function lZ(e,t){return QC(e,t)+"000"}function oZ(e,t){return Qt(e.getUTCMonth()+1,t,2)}function cZ(e,t){return Qt(e.getUTCMinutes(),t,2)}function dZ(e,t){return Qt(e.getUTCSeconds(),t,2)}function uZ(e){var t=e.getUTCDay();return t===0?7:t}function mZ(e,t){return Qt(Rm.count(Rn(e)-1,e),t,2)}function e_(e){var t=e.getUTCDay();return t>=4||t===0?Kl(e):Kl.ceil(e)}function fZ(e,t){return e=e_(e),Qt(Kl.count(Rn(e),e)+(Rn(e).getUTCDay()===4),t,2)}function hZ(e){return e.getUTCDay()}function pZ(e,t){return Qt(Ru.count(Rn(e)-1,e),t,2)}function xZ(e,t){return Qt(e.getUTCFullYear()%100,t,2)}function gZ(e,t){return e=e_(e),Qt(e.getUTCFullYear()%100,t,2)}function vZ(e,t){return Qt(e.getUTCFullYear()%1e4,t,4)}function bZ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Kl(e):Kl.ceil(e),Qt(e.getUTCFullYear()%1e4,t,4)}function yZ(){return"+0000"}function rN(){return"%"}function sN(e){return+e}function aN(e){return Math.floor(+e/1e3)}var Sl,t_,r_;jZ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function jZ(e){return Sl=jJ(e),t_=Sl.format,Sl.parse,r_=Sl.utcFormat,Sl.utcParse,Sl}function wZ(e){return new Date(e)}function NZ(e){return e instanceof Date?+e:+new Date(+e)}function Rv(e,t,r,a,n,i,l,o,c,u){var d=jv(),m=d.invert,f=d.domain,x=u(".%L"),p=u(":%S"),h=u("%I:%M"),g=u("%I %p"),b=u("%a %d"),j=u("%b %d"),y=u("%B"),w=u("%Y");function N(S){return(c(S)<S?x:o(S)<S?p:l(S)<S?h:i(S)<S?g:a(S)<S?n(S)<S?b:j:r(S)<S?y:w)(S)}return d.invert=function(S){return new Date(m(S))},d.domain=function(S){return arguments.length?f(Array.from(S,NZ)):f().map(wZ)},d.ticks=function(S){var E=f();return e(E[0],E[E.length-1],S??10)},d.tickFormat=function(S,E){return E==null?N:u(E)},d.nice=function(S){var E=f();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?f($C(E,S)):d},d.copy=function(){return qc(d,Rv(e,t,r,a,n,i,l,o,c,u))},d}function SZ(){return Wa.apply(Rv(bJ,yJ,Pn,Ov,Pm,Kc,Dv,_v,Ri,t_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function EZ(){return Wa.apply(Rv(gJ,vJ,Rn,Pv,Rm,Om,Iv,kv,Ri,r_).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Lm(){var e=0,t=1,r,a,n,i,l=Ks,o=!1,c;function u(m){return m==null||isNaN(m=+m)?c:l(n===0?.5:(m=(i(m)-r)*n,o?Math.max(0,Math.min(1,m)):m))}u.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),a=i(t=+t),n=r===a?0:1/(a-r),u):[e,t]},u.clamp=function(m){return arguments.length?(o=!!m,u):o},u.interpolator=function(m){return arguments.length?(l=m,u):l};function d(m){return function(f){var x,p;return arguments.length?([x,p]=f,l=m(x,p),u):[l(0),l(1)]}}return u.range=d(io),u.rangeRound=d(yv),u.unknown=function(m){return arguments.length?(c=m,u):c},function(m){return i=m,r=m(e),a=m(t),n=r===a?0:1/(a-r),u}}function bi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function s_(){var e=vi(Lm()(Ks));return e.copy=function(){return bi(e,s_())},$n.apply(e,arguments)}function a_(){var e=Sv(Lm()).domain([1,10]);return e.copy=function(){return bi(e,a_()).base(e.base())},$n.apply(e,arguments)}function n_(){var e=Ev(Lm());return e.copy=function(){return bi(e,n_()).constant(e.constant())},$n.apply(e,arguments)}function Lv(){var e=Tv(Lm());return e.copy=function(){return bi(e,Lv()).exponent(e.exponent())},$n.apply(e,arguments)}function TZ(){return Lv.apply(null,arguments).exponent(.5)}function i_(){var e=[],t=Ks;function r(a){if(a!=null&&!isNaN(a=+a))return t((Vc(e,a,1)-1)/(e.length-1))}return r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let n of a)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(ai),r},r.interpolator=function(a){return arguments.length?(t=a,r):t},r.range=function(){return e.map((a,n)=>t(n/(e.length-1)))},r.quantiles=function(a){return Array.from({length:a+1},(n,i)=>uX(e,i/a))},r.copy=function(){return i_(t).domain(e)},$n.apply(r,arguments)}function Fm(){var e=0,t=.5,r=1,a=1,n,i,l,o,c,u=Ks,d,m=!1,f;function x(h){return isNaN(h=+h)?f:(h=.5+((h=+d(h))-i)*(a*h<a*i?o:c),u(m?Math.max(0,Math.min(1,h)):h))}x.domain=function(h){return arguments.length?([e,t,r]=h,n=d(e=+e),i=d(t=+t),l=d(r=+r),o=n===i?0:.5/(i-n),c=i===l?0:.5/(l-i),a=i<n?-1:1,x):[e,t,r]},x.clamp=function(h){return arguments.length?(m=!!h,x):m},x.interpolator=function(h){return arguments.length?(u=h,x):u};function p(h){return function(g){var b,j,y;return arguments.length?([b,j,y]=g,u=MX(h,[b,j,y]),x):[u(0),u(.5),u(1)]}}return x.range=p(io),x.rangeRound=p(yv),x.unknown=function(h){return arguments.length?(f=h,x):f},function(h){return d=h,n=h(e),i=h(t),l=h(r),o=n===i?0:.5/(i-n),c=i===l?0:.5/(l-i),a=i<n?-1:1,x}}function l_(){var e=vi(Fm()(Ks));return e.copy=function(){return bi(e,l_())},$n.apply(e,arguments)}function o_(){var e=Sv(Fm()).domain([.1,1,10]);return e.copy=function(){return bi(e,o_()).base(e.base())},$n.apply(e,arguments)}function c_(){var e=Ev(Fm());return e.copy=function(){return bi(e,c_()).constant(e.constant())},$n.apply(e,arguments)}function Fv(){var e=Tv(Fm());return e.copy=function(){return bi(e,Fv()).exponent(e.exponent())},$n.apply(e,arguments)}function AZ(){return Fv.apply(null,arguments).exponent(.5)}const Lo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:gv,scaleDiverging:l_,scaleDivergingLog:o_,scaleDivergingPow:Fv,scaleDivergingSqrt:AZ,scaleDivergingSymlog:c_,scaleIdentity:UC,scaleImplicit:jx,scaleLinear:zC,scaleLog:WC,scaleOrdinal:xv,scalePoint:hX,scalePow:Av,scaleQuantile:GC,scaleQuantize:qC,scaleRadial:VC,scaleSequential:s_,scaleSequentialLog:a_,scaleSequentialPow:Lv,scaleSequentialQuantile:i_,scaleSequentialSqrt:TZ,scaleSequentialSymlog:n_,scaleSqrt:lJ,scaleSymlog:HC,scaleThreshold:KC,scaleTime:SZ,scaleUtc:EZ,tickFormat:BC},Symbol.toStringTag,{value:"Module"}));var yi=e=>e.chartData,Mv=be([yi],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Bv=(e,t,r,a)=>a?Mv(e):yi(e);function Yl(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(ga(t)&&ga(r))return!0}return!1}function nN(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function CZ(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,a]=e,n,i;if(ga(r))n=r;else if(typeof r=="function")return;if(ga(a))i=a;else if(typeof a=="function")return;var l=[n,i];if(Yl(l))return l}}function _Z(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var a=e(t,r);if(Yl(a))return nN(a,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[n,i]=e,l,o;if(n==="auto")t!=null&&(l=Math.min(...t));else if(at(n))l=n;else if(typeof n=="function")try{t!=null&&(l=n(t?.[0]))}catch{}else if(typeof n=="string"&&Yj.test(n)){var c=Yj.exec(n);if(c==null||t==null)l=void 0;else{var u=+c[1];l=t[0]-u}}else l=t?.[0];if(i==="auto")t!=null&&(o=Math.max(...t));else if(at(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t?.[1]))}catch{}else if(typeof i=="string"&&Xj.test(i)){var d=Xj.exec(i);if(d==null||t==null)o=void 0;else{var m=+d[1];o=t[1]+m}}else o=t?.[1];var f=[l,o];if(Yl(f))return t==null?f:nN(f,t,r)}}}var lo=1e9,kZ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Uv,Sr=!0,Ba="[DecimalError] ",Vi=Ba+"Invalid argument: ",zv=Ba+"Exponent out of range: ",oo=Math.floor,Ci=Math.pow,DZ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ma,cs=1e7,vr=7,d_=9007199254740991,Lu=oo(d_/vr),Ye={};Ye.absoluteValue=Ye.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Ye.comparedTo=Ye.cmp=function(e){var t,r,a,n,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(a=i.d.length,n=e.d.length,t=0,r=a<n?a:n;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return a===n?0:a>n^i.s<0?1:-1};Ye.decimalPlaces=Ye.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*vr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Ye.dividedBy=Ye.div=function(e){return Cn(this,new this.constructor(e))};Ye.dividedToIntegerBy=Ye.idiv=function(e){var t=this,r=t.constructor;return fr(Cn(t,new r(e),0,1),r.precision)};Ye.equals=Ye.eq=function(e){return!this.cmp(e)};Ye.exponent=function(){return Zr(this)};Ye.greaterThan=Ye.gt=function(e){return this.cmp(e)>0};Ye.greaterThanOrEqualTo=Ye.gte=function(e){return this.cmp(e)>=0};Ye.isInteger=Ye.isint=function(){return this.e>this.d.length-2};Ye.isNegative=Ye.isneg=function(){return this.s<0};Ye.isPositive=Ye.ispos=function(){return this.s>0};Ye.isZero=function(){return this.s===0};Ye.lessThan=Ye.lt=function(e){return this.cmp(e)<0};Ye.lessThanOrEqualTo=Ye.lte=function(e){return this.cmp(e)<1};Ye.logarithm=Ye.log=function(e){var t,r=this,a=r.constructor,n=a.precision,i=n+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(ma))throw Error(Ba+"NaN");if(r.s<1)throw Error(Ba+(r.s?"NaN":"-Infinity"));return r.eq(ma)?new a(0):(Sr=!1,t=Cn(jc(r,i),jc(e,i),i),Sr=!0,fr(t,n))};Ye.minus=Ye.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?f_(t,e):u_(t,(e.s=-e.s,e))};Ye.modulo=Ye.mod=function(e){var t,r=this,a=r.constructor,n=a.precision;if(e=new a(e),!e.s)throw Error(Ba+"NaN");return r.s?(Sr=!1,t=Cn(r,e,0,1).times(e),Sr=!0,r.minus(t)):fr(new a(r),n)};Ye.naturalExponential=Ye.exp=function(){return m_(this)};Ye.naturalLogarithm=Ye.ln=function(){return jc(this)};Ye.negated=Ye.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Ye.plus=Ye.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?u_(t,e):f_(t,(e.s=-e.s,e))};Ye.precision=Ye.sd=function(e){var t,r,a,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Vi+e);if(t=Zr(n)+1,a=n.d.length-1,r=a*vr+1,a=n.d[a],a){for(;a%10==0;a/=10)r--;for(a=n.d[0];a>=10;a/=10)r++}return e&&t>r?t:r};Ye.squareRoot=Ye.sqrt=function(){var e,t,r,a,n,i,l,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(Ba+"NaN")}for(e=Zr(o),Sr=!1,n=Math.sqrt(+o),n==0||n==1/0?(t=cn(o.d),(t.length+e)%2==0&&(t+="0"),n=Math.sqrt(t),e=oo((e+1)/2)-(e<0||e%2),n==1/0?t="5e"+e:(t=n.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new c(t)):a=new c(n.toString()),r=c.precision,n=l=r+3;;)if(i=a,a=i.plus(Cn(o,i,l+2)).times(.5),cn(i.d).slice(0,l)===(t=cn(a.d)).slice(0,l)){if(t=t.slice(l-3,l+1),n==l&&t=="4999"){if(fr(i,r+1,0),i.times(i).eq(o)){a=i;break}}else if(t!="9999")break;l+=4}return Sr=!0,fr(a,r)};Ye.times=Ye.mul=function(e){var t,r,a,n,i,l,o,c,u,d=this,m=d.constructor,f=d.d,x=(e=new m(e)).d;if(!d.s||!e.s)return new m(0);for(e.s*=d.s,r=d.e+e.e,c=f.length,u=x.length,c<u&&(i=f,f=x,x=i,l=c,c=u,u=l),i=[],l=c+u,a=l;a--;)i.push(0);for(a=u;--a>=0;){for(t=0,n=c+a;n>a;)o=i[n]+x[a]*f[n-a-1]+t,i[n--]=o%cs|0,t=o/cs|0;i[n]=(i[n]+t)%cs|0}for(;!i[--l];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Sr?fr(e,m.precision):e};Ye.toDecimalPlaces=Ye.todp=function(e,t){var r=this,a=r.constructor;return r=new a(r),e===void 0?r:(hn(e,0,lo),t===void 0?t=a.rounding:hn(t,0,8),fr(r,e+Zr(r)+1,t))};Ye.toExponential=function(e,t){var r,a=this,n=a.constructor;return e===void 0?r=nl(a,!0):(hn(e,0,lo),t===void 0?t=n.rounding:hn(t,0,8),a=fr(new n(a),e+1,t),r=nl(a,!0,e+1)),r};Ye.toFixed=function(e,t){var r,a,n=this,i=n.constructor;return e===void 0?nl(n):(hn(e,0,lo),t===void 0?t=i.rounding:hn(t,0,8),a=fr(new i(n),e+Zr(n)+1,t),r=nl(a.abs(),!1,e+Zr(a)+1),n.isneg()&&!n.isZero()?"-"+r:r)};Ye.toInteger=Ye.toint=function(){var e=this,t=e.constructor;return fr(new t(e),Zr(e)+1,t.rounding)};Ye.toNumber=function(){return+this};Ye.toPower=Ye.pow=function(e){var t,r,a,n,i,l,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(ma);if(o=new c(o),!o.s){if(e.s<1)throw Error(Ba+"Infinity");return o}if(o.eq(ma))return o;if(a=c.precision,e.eq(ma))return fr(o,a);if(t=e.e,r=e.d.length-1,l=t>=r,i=o.s,l){if((r=d<0?-d:d)<=d_){for(n=new c(ma),t=Math.ceil(a/vr+4),Sr=!1;r%2&&(n=n.times(o),lN(n.d,t)),r=oo(r/2),r!==0;)o=o.times(o),lN(o.d,t);return Sr=!0,e.s<0?new c(ma).div(n):fr(n,a)}}else if(i<0)throw Error(Ba+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Sr=!1,n=e.times(jc(o,a+u)),Sr=!0,n=m_(n),n.s=i,n};Ye.toPrecision=function(e,t){var r,a,n=this,i=n.constructor;return e===void 0?(r=Zr(n),a=nl(n,r<=i.toExpNeg||r>=i.toExpPos)):(hn(e,1,lo),t===void 0?t=i.rounding:hn(t,0,8),n=fr(new i(n),e,t),r=Zr(n),a=nl(n,e<=r||r<=i.toExpNeg,e)),a};Ye.toSignificantDigits=Ye.tosd=function(e,t){var r=this,a=r.constructor;return e===void 0?(e=a.precision,t=a.rounding):(hn(e,1,lo),t===void 0?t=a.rounding:hn(t,0,8)),fr(new a(r),e,t)};Ye.toString=Ye.valueOf=Ye.val=Ye.toJSON=Ye[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Zr(e),r=e.constructor;return nl(e,t<=r.toExpNeg||t>=r.toExpPos)};function u_(e,t){var r,a,n,i,l,o,c,u,d=e.constructor,m=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Sr?fr(t,m):t;if(c=e.d,u=t.d,l=e.e,n=t.e,c=c.slice(),i=l-n,i){for(i<0?(a=c,i=-i,o=u.length):(a=u,n=l,o=c.length),l=Math.ceil(m/vr),o=l>o?l+1:o+1,i>o&&(i=o,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,a=u,u=c,c=a),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/cs|0,c[i]%=cs;for(r&&(c.unshift(r),++n),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=n,Sr?fr(t,m):t}function hn(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Vi+e)}function cn(e){var t,r,a,n=e.length-1,i="",l=e[0];if(n>0){for(i+=l,t=1;t<n;t++)a=e[t]+"",r=vr-a.length,r&&(i+=Xn(r)),i+=a;l=e[t],a=l+"",r=vr-a.length,r&&(i+=Xn(r))}else if(l===0)return"0";for(;l%10===0;)l/=10;return i+l}var Cn=(function(){function e(a,n){var i,l=0,o=a.length;for(a=a.slice();o--;)i=a[o]*n+l,a[o]=i%cs|0,l=i/cs|0;return l&&a.unshift(l),a}function t(a,n,i,l){var o,c;if(i!=l)c=i>l?1:-1;else for(o=c=0;o<i;o++)if(a[o]!=n[o]){c=a[o]>n[o]?1:-1;break}return c}function r(a,n,i){for(var l=0;i--;)a[i]-=l,l=a[i]<n[i]?1:0,a[i]=l*cs+a[i]-n[i];for(;!a[0]&&a.length>1;)a.shift()}return function(a,n,i,l){var o,c,u,d,m,f,x,p,h,g,b,j,y,w,N,S,E,_,T=a.constructor,C=a.s==n.s?1:-1,A=a.d,D=n.d;if(!a.s)return new T(a);if(!n.s)throw Error(Ba+"Division by zero");for(c=a.e-n.e,E=D.length,N=A.length,x=new T(C),p=x.d=[],u=0;D[u]==(A[u]||0);)++u;if(D[u]>(A[u]||0)&&--c,i==null?j=i=T.precision:l?j=i+(Zr(a)-Zr(n))+1:j=i,j<0)return new T(0);if(j=j/vr+2|0,u=0,E==1)for(d=0,D=D[0],j++;(u<N||d)&&j--;u++)y=d*cs+(A[u]||0),p[u]=y/D|0,d=y%D|0;else{for(d=cs/(D[0]+1)|0,d>1&&(D=e(D,d),A=e(A,d),E=D.length,N=A.length),w=E,h=A.slice(0,E),g=h.length;g<E;)h[g++]=0;_=D.slice(),_.unshift(0),S=D[0],D[1]>=cs/2&&++S;do d=0,o=t(D,h,E,g),o<0?(b=h[0],E!=g&&(b=b*cs+(h[1]||0)),d=b/S|0,d>1?(d>=cs&&(d=cs-1),m=e(D,d),f=m.length,g=h.length,o=t(m,h,f,g),o==1&&(d--,r(m,E<f?_:D,f))):(d==0&&(o=d=1),m=D.slice()),f=m.length,f<g&&m.unshift(0),r(h,m,g),o==-1&&(g=h.length,o=t(D,h,E,g),o<1&&(d++,r(h,E<g?_:D,g))),g=h.length):o===0&&(d++,h=[0]),p[u++]=d,o&&h[0]?h[g++]=A[w]||0:(h=[A[w]],g=1);while((w++<N||h[0]!==void 0)&&j--)}return p[0]||p.shift(),x.e=c,fr(x,l?i+Zr(x)+1:i)}})();function m_(e,t){var r,a,n,i,l,o,c=0,u=0,d=e.constructor,m=d.precision;if(Zr(e)>16)throw Error(zv+Zr(e));if(!e.s)return new d(ma);for(Sr=!1,o=m,l=new d(.03125);e.abs().gte(.1);)e=e.times(l),u+=5;for(a=Math.log(Ci(2,u))/Math.LN10*2+5|0,o+=a,r=n=i=new d(ma),d.precision=o;;){if(n=fr(n.times(e),o),r=r.times(++c),l=i.plus(Cn(n,r,o)),cn(l.d).slice(0,o)===cn(i.d).slice(0,o)){for(;u--;)i=fr(i.times(i),o);return d.precision=m,t==null?(Sr=!0,fr(i,m)):i}i=l}}function Zr(e){for(var t=e.e*vr,r=e.d[0];r>=10;r/=10)t++;return t}function Dh(e,t,r){if(t>e.LN10.sd())throw Sr=!0,r&&(e.precision=r),Error(Ba+"LN10 precision limit exceeded");return fr(new e(e.LN10),t)}function Xn(e){for(var t="";e--;)t+="0";return t}function jc(e,t){var r,a,n,i,l,o,c,u,d,m=1,f=10,x=e,p=x.d,h=x.constructor,g=h.precision;if(x.s<1)throw Error(Ba+(x.s?"NaN":"-Infinity"));if(x.eq(ma))return new h(0);if(t==null?(Sr=!1,u=g):u=t,x.eq(10))return t==null&&(Sr=!0),Dh(h,u);if(u+=f,h.precision=u,r=cn(p),a=r.charAt(0),i=Zr(x),Math.abs(i)<15e14){for(;a<7&&a!=1||a==1&&r.charAt(1)>3;)x=x.times(e),r=cn(x.d),a=r.charAt(0),m++;i=Zr(x),a>1?(x=new h("0."+r),i++):x=new h(a+"."+r.slice(1))}else return c=Dh(h,u+2,g).times(i+""),x=jc(new h(a+"."+r.slice(1)),u-f).plus(c),h.precision=g,t==null?(Sr=!0,fr(x,g)):x;for(o=l=x=Cn(x.minus(ma),x.plus(ma),u),d=fr(x.times(x),u),n=3;;){if(l=fr(l.times(d),u),c=o.plus(Cn(l,new h(n),u)),cn(c.d).slice(0,u)===cn(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Dh(h,u+2,g).times(i+""))),o=Cn(o,new h(m),u),h.precision=g,t==null?(Sr=!0,fr(o,g)):o;o=c,n+=2}}function iN(e,t){var r,a,n;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;t.charCodeAt(a)===48;)++a;for(n=t.length;t.charCodeAt(n-1)===48;)--n;if(t=t.slice(a,n),t){if(n-=a,r=r-a-1,e.e=oo(r/vr),e.d=[],a=(r+1)%vr,r<0&&(a+=vr),a<n){for(a&&e.d.push(+t.slice(0,a)),n-=vr;a<n;)e.d.push(+t.slice(a,a+=vr));t=t.slice(a),a=vr-t.length}else a-=n;for(;a--;)t+="0";if(e.d.push(+t),Sr&&(e.e>Lu||e.e<-Lu))throw Error(zv+r)}else e.s=0,e.e=0,e.d=[0];return e}function fr(e,t,r){var a,n,i,l,o,c,u,d,m=e.d;for(l=1,i=m[0];i>=10;i/=10)l++;if(a=t-l,a<0)a+=vr,n=t,u=m[d=0];else{if(d=Math.ceil((a+1)/vr),i=m.length,d>=i)return e;for(u=i=m[d],l=1;i>=10;i/=10)l++;a%=vr,n=a-vr+l}if(r!==void 0&&(i=Ci(10,l-n-1),o=u/i%10|0,c=t<0||m[d+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(a>0?n>0?u/Ci(10,l-n):0:m[d-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return c?(i=Zr(e),m.length=1,t=t-i-1,m[0]=Ci(10,(vr-t%vr)%vr),e.e=oo(-t/vr)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(a==0?(m.length=d,i=1,d--):(m.length=d+1,i=Ci(10,vr-a),m[d]=n>0?(u/Ci(10,l-n)%Ci(10,n)|0)*i:0),c)for(;;)if(d==0){(m[0]+=i)==cs&&(m[0]=1,++e.e);break}else{if(m[d]+=i,m[d]!=cs)break;m[d--]=0,i=1}for(a=m.length;m[--a]===0;)m.pop();if(Sr&&(e.e>Lu||e.e<-Lu))throw Error(zv+Zr(e));return e}function f_(e,t){var r,a,n,i,l,o,c,u,d,m,f=e.constructor,x=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),Sr?fr(t,x):t;if(c=e.d,m=t.d,a=t.e,u=e.e,c=c.slice(),l=u-a,l){for(d=l<0,d?(r=c,l=-l,o=m.length):(r=m,a=u,o=c.length),n=Math.max(Math.ceil(x/vr),o)+2,l>n&&(l=n,r.length=1),r.reverse(),n=l;n--;)r.push(0);r.reverse()}else{for(n=c.length,o=m.length,d=n<o,d&&(o=n),n=0;n<o;n++)if(c[n]!=m[n]){d=c[n]<m[n];break}l=0}for(d&&(r=c,c=m,m=r,t.s=-t.s),o=c.length,n=m.length-o;n>0;--n)c[o++]=0;for(n=m.length;n>l;){if(c[--n]<m[n]){for(i=n;i&&c[--i]===0;)c[i]=cs-1;--c[i],c[n]+=cs}c[n]-=m[n]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--a;return c[0]?(t.d=c,t.e=a,Sr?fr(t,x):t):new f(0)}function nl(e,t,r){var a,n=Zr(e),i=cn(e.d),l=i.length;return t?(r&&(a=r-l)>0?i=i.charAt(0)+"."+i.slice(1)+Xn(a):l>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(n<0?"e":"e+")+n):n<0?(i="0."+Xn(-n-1)+i,r&&(a=r-l)>0&&(i+=Xn(a))):n>=l?(i+=Xn(n+1-l),r&&(a=r-n-1)>0&&(i=i+"."+Xn(a))):((a=n+1)<l&&(i=i.slice(0,a)+"."+i.slice(a)),r&&(a=r-l)>0&&(n+1===l&&(i+="."),i+=Xn(a))),e.s<0?"-"+i:i}function lN(e,t){if(e.length>t)return e.length=t,!0}function h_(e){var t,r,a;function n(i){var l=this;if(!(l instanceof n))return new n(i);if(l.constructor=n,i instanceof n){l.s=i.s,l.e=i.e,l.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Vi+i);if(i>0)l.s=1;else if(i<0)i=-i,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(i===~~i&&i<1e7){l.e=0,l.d=[i];return}return iN(l,i.toString())}else if(typeof i!="string")throw Error(Vi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),l.s=-1):l.s=1,DZ.test(i))iN(l,i);else throw Error(Vi+i)}if(n.prototype=Ye,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.clone=h_,n.config=n.set=IZ,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(r=a[t++])||(e[r]=this[r]);return n.config(e),n}function IZ(e){if(!e||typeof e!="object")throw Error(Ba+"Object expected");var t,r,a,n=["precision",1,lo,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<n.length;t+=3)if((a=e[r=n[t]])!==void 0)if(oo(a)===a&&a>=n[t+1]&&a<=n[t+2])this[r]=a;else throw Error(Vi+r+": "+a);if((a=e[r="LN10"])!==void 0)if(a==Math.LN10)this[r]=new this(a);else throw Error(Vi+r+": "+a);return this}var Uv=h_(kZ);ma=new Uv(1);const lr=Uv;var OZ=e=>e,p_={},x_=e=>e===p_,oN=e=>function t(){return arguments.length===0||arguments.length===1&&x_(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},g_=(e,t)=>e===1?t:oN(function(){for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];var i=a.filter(l=>l!==p_).length;return i>=e?t(...a):g_(e-i,oN(function(){for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];var u=a.map(d=>x_(d)?o.shift():d);return t(...u,...o)}))}),Mm=e=>g_(e.length,e),Ex=(e,t)=>{for(var r=[],a=e;a<t;++a)r[a-e]=a;return r},PZ=Mm((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),RZ=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(!r.length)return OZ;var n=r.reverse(),i=n[0],l=n.slice(1);return function(){return l.reduce((o,c)=>c(o),i(...arguments))}},Tx=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),v_=e=>{var t=null,r=null;return function(){for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return t&&n.every((l,o)=>{var c;return l===((c=t)===null||c===void 0?void 0:c[o])})||(t=n,r=e(...n)),r}};function b_(e){var t;return e===0?t=1:t=Math.floor(new lr(e).abs().log(10).toNumber())+1,t}function y_(e,t,r){for(var a=new lr(e),n=0,i=[];a.lt(t)&&n<1e5;)i.push(a.toNumber()),a=a.add(r),n++;return i}Mm((e,t,r)=>{var a=+e,n=+t;return a+r*(n-a)});Mm((e,t,r)=>{var a=t-+e;return a=a||1/0,(r-e)/a});Mm((e,t,r)=>{var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(r-e)/a))});var j_=e=>{var[t,r]=e,[a,n]=[t,r];return t>r&&([a,n]=[r,t]),[a,n]},w_=(e,t,r)=>{if(e.lte(0))return new lr(0);var a=b_(e.toNumber()),n=new lr(10).pow(a),i=e.div(n),l=a!==1?.05:.1,o=new lr(Math.ceil(i.div(l).toNumber())).add(r).mul(l),c=o.mul(n);return t?new lr(c.toNumber()):new lr(Math.ceil(c.toNumber()))},LZ=(e,t,r)=>{var a=new lr(1),n=new lr(e);if(!n.isint()&&r){var i=Math.abs(e);i<1?(a=new lr(10).pow(b_(e)-1),n=new lr(Math.floor(n.div(a).toNumber())).mul(a)):i>1&&(n=new lr(Math.floor(e)))}else e===0?n=new lr(Math.floor((t-1)/2)):r||(n=new lr(Math.floor(e)));var l=Math.floor((t-1)/2),o=RZ(PZ(c=>n.add(new lr(c-l).mul(a)).toNumber()),Ex);return o(0,t)},N_=function(t,r,a,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(a-1)))return{step:new lr(0),tickMin:new lr(0),tickMax:new lr(0)};var l=w_(new lr(r).sub(t).div(a-1),n,i),o;t<=0&&r>=0?o=new lr(0):(o=new lr(t).add(r).div(2),o=o.sub(new lr(o).mod(l)));var c=Math.ceil(o.sub(t).div(l).toNumber()),u=Math.ceil(new lr(r).sub(o).div(l).toNumber()),d=c+u+1;return d>a?N_(t,r,a,n,i+1):(d<a&&(u=r>0?u+(a-d):u,c=r>0?c:c+(a-d)),{step:l,tickMin:o.sub(new lr(c).mul(l)),tickMax:o.add(new lr(u).mul(l))})};function FZ(e){var[t,r]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),[l,o]=j_([t,r]);if(l===-1/0||o===1/0){var c=o===1/0?[l,...Ex(0,a-1).map(()=>1/0)]:[...Ex(0,a-1).map(()=>-1/0),o];return t>r?Tx(c):c}if(l===o)return LZ(l,a,n);var{step:u,tickMin:d,tickMax:m}=N_(l,o,i,n,0),f=y_(d,m.add(new lr(.1).mul(u)),u);return t>r?Tx(f):f}function MZ(e,t){var[r,a]=e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,l]=j_([r,a]);if(i===-1/0||l===1/0)return[r,a];if(i===l)return[i];var o=Math.max(t,2),c=w_(new lr(l).sub(i).div(o-1),n,0),u=[...y_(new lr(i),new lr(l),c),l];return n===!1&&(u=u.map(d=>Math.round(d))),r>a?Tx(u):u}var BZ=v_(FZ),zZ=v_(MZ),S_=e=>e.rootProps.maxBarSize,UZ=e=>e.rootProps.barGap,E_=e=>e.rootProps.barCategoryGap,$Z=e=>e.rootProps.barSize,Yc=e=>e.rootProps.stackOffset,$v=e=>e.options.chartName,Wv=e=>e.rootProps.syncId,T_=e=>e.rootProps.syncMethod,Hv=e=>e.options.eventEmitter,bn={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},la={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Bm=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},WZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:bn.angleAxisId,includeHidden:!1,name:void 0,reversed:bn.reversed,scale:bn.scale,tick:bn.tick,tickCount:void 0,ticks:void 0,type:bn.type,unit:void 0},HZ={allowDataOverflow:la.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:la.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:la.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:la.scale,tick:la.tick,tickCount:la.tickCount,ticks:void 0,type:la.type,unit:void 0},VZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:bn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:bn.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:bn.scale,tick:bn.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},GZ={allowDataOverflow:la.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:la.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:la.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:la.scale,tick:la.tick,tickCount:la.tickCount,ticks:void 0,type:"category",unit:void 0},Vv=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?VZ:WZ,Gv=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?GZ:HZ,zm=e=>e.polarOptions,qv=be([zn,Un,ns],oC),A_=be([zm,qv],(e,t)=>{if(e!=null)return Ms(e.innerRadius,t,0)}),C_=be([zm,qv],(e,t)=>{if(e!=null)return Ms(e.outerRadius,t,t*.8)}),qZ=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},__=be([zm],qZ);be([Vv,__],Bm);var k_=be([qv,A_,C_],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});be([Gv,k_],Bm);var D_=be([tr,zm,A_,C_,zn,Un],(e,t,r,a,n,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||a==null)){var{cx:l,cy:o,startAngle:c,endAngle:u}=t;return{cx:Ms(l,n,n/2),cy:Ms(o,i,i/2),innerRadius:r,outerRadius:a,startAngle:c,endAngle:u,clockWise:!1}}}),Cr=(e,t)=>t,Xc=(e,t,r)=>r;function Kv(e){return e?.id}var ls=e=>{var t=tr(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},co=e=>e.tooltip.settings.axisId,vs=e=>{var t=ls(e),r=co(e);return Jc(e,t,r)},I_=be([vs],e=>e?.dataKey);function O_(e,t,r){var{chartData:a=[]}=t,{allowDuplicatedCategory:n,dataKey:i}=r,l=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:a;if(!(u==null||u.length===0)){var d=Kv(o);u.forEach((m,f)=>{var x=i==null||n?f:String(Pr(m,i,null)),p=Pr(m,o.dataKey,0),h;l.has(x)?h=l.get(x):h={},Object.assign(h,{[d]:p}),l.set(x,h)})}}),Array.from(l.values())}function Um(e){return e.stackId!=null&&e.dataKey!=null}function cN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Fu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cN(Object(r),!0).forEach(function(a){KZ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function KZ(e,t,r){return(t=YZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YZ(e){var t=XZ(e,"string");return typeof t=="symbol"?t:t+""}function XZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ax=[0,"auto"],na={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},P_=(e,t)=>e.cartesianAxis.xAxis[t],Wn=(e,t)=>{var r=P_(e,t);return r??na},ia={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Ax,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Hc},R_=(e,t)=>e.cartesianAxis.yAxis[t],Hn=(e,t)=>{var r=R_(e,t);return r??ia},JZ={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Yv=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??JZ},Vr=(e,t,r)=>{switch(t){case"xAxis":return Wn(e,r);case"yAxis":return Hn(e,r);case"zAxis":return Yv(e,r);case"angleAxis":return Vv(e,r);case"radiusAxis":return Gv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},ZZ=(e,t,r)=>{switch(t){case"xAxis":return Wn(e,r);case"yAxis":return Hn(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Jc=(e,t,r)=>{switch(t){case"xAxis":return Wn(e,r);case"yAxis":return Hn(e,r);case"angleAxis":return Vv(e,r);case"radiusAxis":return Gv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},L_=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Xv(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Jv=e=>e.graphicalItems.cartesianItems,QZ=be([Cr,Xc],Xv),Zv=(e,t,r)=>e.filter(r).filter(a=>t?.includeHidden===!0?!0:!a.hide),Zc=be([Jv,Vr,QZ],Zv),F_=be([Zc],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Um)),M_=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),B_=be([Zc],M_),Qv=e=>e.map(t=>t.data).filter(Boolean).flat(1),eQ=be([Zc],Qv),e1=(e,t)=>{var{chartData:r=[],dataStartIndex:a,dataEndIndex:n}=t;return e.length>0?e:r.slice(a,n+1)},t1=be([eQ,Bv],e1),r1=(e,t,r)=>t?.dataKey!=null?e.map(a=>({value:Pr(a,t.dataKey)})):r.length>0?r.map(a=>a.dataKey).flatMap(a=>e.map(n=>({value:Pr(n,a)}))):e.map(a=>({value:a})),$m=be([t1,Vr,Zc],r1);function z_(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function bl(e){return e.filter(t=>fn(t)||t instanceof Date).map(Number).filter(t=>pa(t)===!1)}function tQ(e,t,r){return!r||typeof t!="number"||pa(t)?[]:r.length?bl(r.flatMap(a=>{var n=Pr(e,a.dataKey),i,l;if(Array.isArray(n)?[i,l]=n:i=l=n,!(!ga(i)||!ga(l)))return[t-i,t+l]})):[]}var rQ=be([F_,Bv,vs],O_),U_=(e,t,r)=>{var a={},n=t.reduce((i,l)=>(l.stackId==null||(i[l.stackId]==null&&(i[l.stackId]=[]),i[l.stackId].push(l)),i),a);return Object.fromEntries(Object.entries(n).map(i=>{var[l,o]=i,c=o.map(Kv);return[l,{stackedData:iK(e,c,r),graphicalItems:o}]}))},Cx=be([rQ,F_,Yc],U_),$_=(e,t,r)=>{var{dataStartIndex:a,dataEndIndex:n}=t;if(r!=="zAxis"){var i=uK(e,a,n);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},sQ=be([Cx,yi,Cr],$_),W_=(e,t,r,a,n)=>r.length>0?e.flatMap(i=>r.flatMap(l=>{var o,c,u=(o=a[l.id])===null||o===void 0?void 0:o.filter(m=>z_(n,m)),d=Pr(i,(c=t.dataKey)!==null&&c!==void 0?c:l.dataKey);return{value:d,errorDomain:tQ(i,d,u)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:Pr(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),Wm=e=>e.errorBars,H_=(e,t,r)=>e.flatMap(a=>t[a.id]).filter(Boolean).filter(a=>z_(r,a));be([B_,Wm,Cr],H_);var aQ=be([t1,Vr,B_,Wm,Cr],W_);function nQ(e){var{value:t}=e;if(fn(t)||t instanceof Date)return t}var dN=e=>{var t=e.flatMap(a=>[a.value,a.errorDomain]).flat(1),r=bl(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},iQ=(e,t,r)=>{var a=e.map(nQ).filter(n=>n!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&sA(a))?_C(0,e.length):t.allowDuplicatedCategory?a:Array.from(new Set(a))},s1=e=>{var t;if(e==null||!("domain"in e))return Ax;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=bl(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:Ax},Mu=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var n=r.filter(Boolean);if(n.length!==0){var i=n.flat(),l=Math.min(...i),o=Math.max(...i);return[l,o]}},V_=e=>e.referenceElements.dots,uo=(e,t,r)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>t==="xAxis"?a.xAxisId===r:a.yAxisId===r),lQ=be([V_,Cr,Xc],uo),G_=e=>e.referenceElements.areas,oQ=be([G_,Cr,Xc],uo),q_=e=>e.referenceElements.lines,cQ=be([q_,Cr,Xc],uo),K_=(e,t)=>{var r=bl(e.map(a=>t==="xAxis"?a.x:a.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},dQ=be(lQ,Cr,K_),Y_=(e,t)=>{var r=bl(e.flatMap(a=>[t==="xAxis"?a.x1:a.y1,t==="xAxis"?a.x2:a.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},uQ=be([oQ,Cr],Y_),X_=(e,t)=>{var r=bl(e.map(a=>t==="xAxis"?a.x:a.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},mQ=be(cQ,Cr,X_),fQ=be(dQ,mQ,uQ,(e,t,r)=>Mu(e,r,t)),J_=be([Vr],s1),a1=(e,t,r,a,n,i,l)=>{var o=CZ(t,e.allowDataOverflow);if(o!=null)return o;var c=i==="vertical"&&l==="xAxis"||i==="horizontal"&&l==="yAxis",u=c?Mu(r,n,dN(a)):Mu(n,dN(a));return _Z(t,u,e.allowDataOverflow)},hQ=be([Vr,J_,sQ,aQ,fQ,tr,Cr],a1),pQ=[0,1],n1=(e,t,r,a,n,i,l)=>{if(!((e==null||r==null||r.length===0)&&l===void 0)){var{dataKey:o,type:c}=e,u=pl(t,i);return u&&o==null?_C(0,r.length):c==="category"?iQ(a,e,u):n==="expand"?pQ:l}},i1=be([Vr,tr,t1,$m,Yc,Cr,hQ],n1),Z_=(e,t,r,a,n)=>{if(e!=null){var{scale:i,type:l}=e;if(i==="auto")return t==="radial"&&n==="radiusAxis"?"band":t==="radial"&&n==="angleAxis"?"linear":l==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(zc(i));return o in Lo?o:"point"}}},mo=be([Vr,tr,L_,$v,Cr],Z_);function xQ(e){if(e!=null){if(e in Lo)return Lo[e]();var t="scale".concat(zc(e));if(t in Lo)return Lo[t]()}}function l1(e,t,r,a){if(!(r==null||a==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(a);var n=xQ(t);if(n!=null){var i=n.domain(r).range(a);return tK(i),i}}}var o1=(e,t,r)=>{var a=s1(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&Yl(e))return BZ(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Yl(e))return zZ(e,t.tickCount,t.allowDecimals)}},c1=be([i1,Jc,mo],o1),d1=(e,t,r,a)=>{if(a!=="angleAxis"&&e?.type==="number"&&Yl(t)&&Array.isArray(r)&&r.length>0){var n=t[0],i=r[0],l=t[1],o=r[r.length-1];return[Math.min(n,i),Math.max(l,o)]}return t},gQ=be([Vr,i1,c1,Cr],d1),vQ=be($m,Vr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,a=Array.from(bl(e.map(o=>o.value))).sort((o,c)=>o-c);if(a.length<2)return 1/0;var n=a[a.length-1]-a[0];if(n===0)return 1/0;for(var i=0;i<a.length-1;i++){var l=a[i+1]-a[i];r=Math.min(r,l)}return r/n}}),Q_=be(vQ,tr,E_,ns,(e,t,r,a)=>a,(e,t,r,a,n)=>{if(!ga(e))return 0;var i=t==="vertical"?a.height:a.width;if(n==="gap")return e*i/2;if(n==="no-gap"){var l=Ms(r,e*i),o=e*i/2;return o-l-(o-l)/i*l}return 0}),bQ=(e,t)=>{var r=Wn(e,t);return r==null||typeof r.padding!="string"?0:Q_(e,"xAxis",t,r.padding)},yQ=(e,t)=>{var r=Hn(e,t);return r==null||typeof r.padding!="string"?0:Q_(e,"yAxis",t,r.padding)},jQ=be(Wn,bQ,(e,t)=>{var r,a;if(e==null)return{left:0,right:0};var{padding:n}=e;return typeof n=="string"?{left:t,right:t}:{left:((r=n.left)!==null&&r!==void 0?r:0)+t,right:((a=n.right)!==null&&a!==void 0?a:0)+t}}),wQ=be(Hn,yQ,(e,t)=>{var r,a;if(e==null)return{top:0,bottom:0};var{padding:n}=e;return typeof n=="string"?{top:t,bottom:t}:{top:((r=n.top)!==null&&r!==void 0?r:0)+t,bottom:((a=n.bottom)!==null&&a!==void 0?a:0)+t}}),NQ=be([ns,jQ,_m,Cm,(e,t,r)=>r],(e,t,r,a,n)=>{var{padding:i}=a;return n?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),SQ=be([ns,tr,wQ,_m,Cm,(e,t,r)=>r],(e,t,r,a,n,i)=>{var{padding:l}=n;return i?[a.height-l.bottom,l.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Qc=(e,t,r,a)=>{var n;switch(t){case"xAxis":return NQ(e,r,a);case"yAxis":return SQ(e,r,a);case"zAxis":return(n=Yv(e,r))===null||n===void 0?void 0:n.range;case"angleAxis":return __(e);case"radiusAxis":return k_(e,r);default:return}},e5=be([Vr,Qc],Bm),fo=be([Vr,mo,gQ,e5],l1);be([Zc,Wm,Cr],H_);function t5(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Hm=(e,t)=>t,Vm=(e,t,r)=>r,EQ=be(Tm,Hm,Vm,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort(t5)),TQ=be(Am,Hm,Vm,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort(t5)),r5=(e,t)=>({width:e.width,height:t.height}),AQ=(e,t)=>{var r=typeof t.width=="number"?t.width:Hc;return{width:r,height:e.height}},s5=be(ns,Wn,r5),CQ=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},_Q=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},kQ=be(Un,ns,EQ,Hm,Vm,(e,t,r,a,n)=>{var i={},l;return r.forEach(o=>{var c=r5(t,o);l==null&&(l=CQ(t,a,e));var u=a==="top"&&!n||a==="bottom"&&n;i[o.id]=l-Number(u)*c.height,l+=(u?-1:1)*c.height}),i}),DQ=be(zn,ns,TQ,Hm,Vm,(e,t,r,a,n)=>{var i={},l;return r.forEach(o=>{var c=AQ(t,o);l==null&&(l=_Q(t,a,e));var u=a==="left"&&!n||a==="right"&&n;i[o.id]=l-Number(u)*c.width,l+=(u?-1:1)*c.width}),i}),IQ=(e,t)=>{var r=Wn(e,t);if(r!=null)return kQ(e,r.orientation,r.mirror)},OQ=be([ns,Wn,IQ,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var n=r?.[a];return n==null?{x:e.left,y:0}:{x:e.left,y:n}}}),PQ=(e,t)=>{var r=Hn(e,t);if(r!=null)return DQ(e,r.orientation,r.mirror)},RQ=be([ns,Hn,PQ,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var n=r?.[a];return n==null?{x:0,y:e.top}:{x:n,y:e.top}}}),a5=be(ns,Hn,(e,t)=>{var r=typeof t.width=="number"?t.width:Hc;return{width:r,height:e.height}}),uN=(e,t,r)=>{switch(t){case"xAxis":return s5(e,r).width;case"yAxis":return a5(e,r).height;default:return}},n5=(e,t,r,a)=>{if(r!=null){var{allowDuplicatedCategory:n,type:i,dataKey:l}=r,o=pl(e,a),c=t.map(u=>u.value);if(l&&o&&i==="category"&&n&&sA(c))return c}},u1=be([tr,$m,Vr,Cr],n5),i5=(e,t,r,a)=>{if(!(r==null||r.dataKey==null)){var{type:n,scale:i}=r,l=pl(e,a);if(l&&(n==="number"||i!=="auto"))return t.map(o=>o.value)}},m1=be([tr,$m,Jc,Cr],i5),mN=be([tr,ZZ,mo,fo,u1,m1,Qc,c1,Cr],(e,t,r,a,n,i,l,o,c)=>{if(t==null)return null;var u=pl(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:n,isCategorical:u,niceTicks:o,range:l,realScaleType:r,scale:a}}),LQ=(e,t,r,a,n,i,l,o,c)=>{if(!(t==null||a==null)){var u=pl(e,c),{type:d,ticks:m,tickCount:f}=t,x=r==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,p=d==="category"&&a.bandwidth?a.bandwidth()/x:0;p=c==="angleAxis"&&i!=null&&i.length>=2?ms(i[0]-i[1])*2*p:p;var h=m||n;if(h){var g=h.map((b,j)=>{var y=l?l.indexOf(b):b;return{index:j,coordinate:a(y)+p,value:b,offset:p}});return g.filter(b=>!pa(b.coordinate))}return u&&o?o.map((b,j)=>({coordinate:a(b)+p,value:b,index:j,offset:p})):a.ticks?a.ticks(f).map(b=>({coordinate:a(b)+p,value:b,offset:p})):a.domain().map((b,j)=>({coordinate:a(b)+p,value:l?l[b]:b,index:j,offset:p}))}},l5=be([tr,Jc,mo,fo,c1,Qc,u1,m1,Cr],LQ),FQ=(e,t,r,a,n,i,l)=>{if(!(t==null||r==null||a==null||a[0]===a[1])){var o=pl(e,l),{tickCount:c}=t,u=0;return u=l==="angleAxis"&&a?.length>=2?ms(a[0]-a[1])*2*u:u,o&&i?i.map((d,m)=>({coordinate:r(d)+u,value:d,index:m,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,m)=>({coordinate:r(d)+u,value:n?n[d]:d,index:m,offset:u}))}},Xl=be([tr,Jc,fo,Qc,u1,m1,Cr],FQ),Jl=be(Vr,fo,(e,t)=>{if(!(e==null||t==null))return Fu(Fu({},e),{},{scale:t})}),MQ=be([Vr,mo,i1,e5],l1);be((e,t,r)=>Yv(e,r),MQ,(e,t)=>{if(!(e==null||t==null))return Fu(Fu({},e),{},{scale:t})});var BQ=be([tr,Tm,Am],(e,t,r)=>{switch(e){case"horizontal":return t.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),o5=e=>e.options.defaultTooltipEventType,c5=e=>e.options.validateTooltipEventTypes;function d5(e,t,r){if(e==null)return t;var a=e?"axis":"item";return r==null?t:r.includes(a)?a:t}function f1(e,t){var r=o5(e),a=c5(e);return d5(t,r,a)}function zQ(e){return tt(t=>f1(t,e))}var u5=(e,t)=>{var r,a=Number(t);if(!(pa(a)||t==null))return a>=0?e==null||(r=e[a])===null||r===void 0?void 0:r.value:void 0},UQ=e=>e.tooltip.settings,Qn={active:!1,index:null,dataKey:void 0,coordinate:void 0},$Q={itemInteraction:{click:Qn,hover:Qn},axisInteraction:{click:Qn,hover:Qn},keyboardInteraction:Qn,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},m5=va({name:"tooltip",initialState:$Q,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=An(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:WQ,removeTooltipEntrySettings:HQ,setTooltipSettingsState:VQ,setActiveMouseOverItemIndex:f5,mouseLeaveItem:GQ,mouseLeaveChart:h5,setActiveClickItemIndex:qQ,setMouseOverAxisIndex:p5,setMouseClickAxisIndex:KQ,setSyncInteraction:_x,setKeyboardInteraction:kx}=m5.actions,YQ=m5.reducer;function fN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Od(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fN(Object(r),!0).forEach(function(a){XQ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function XQ(e,t,r){return(t=JQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JQ(e){var t=ZQ(e,"string");return typeof t=="symbol"?t:t+""}function ZQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QQ(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function eee(e){return e.index!=null}var x5=(e,t,r,a)=>{if(t==null)return Qn;var n=QQ(e,t,r);if(n==null)return Qn;if(n.active)return n;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(eee(n)){if(i)return Od(Od({},n),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return Od(Od({},Qn),{},{coordinate:n.coordinate})},h1=(e,t)=>{var r=e?.index;if(r==null)return null;var a=Number(r);if(!ga(a))return r;var n=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(n,Math.min(a,i)))},g5=(e,t,r,a,n,i,l,o)=>{if(!(i==null||o==null)){var c=l[0],u=c==null?void 0:o(c.positions,i);if(u!=null)return u;var d=n?.[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(a.top+t)/2};default:return{x:(a.left+e)/2,y:d.coordinate}}}},v5=(e,t,r,a)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var n;return r==="hover"?n=e.itemInteraction.hover.dataKey:n=e.itemInteraction.click.dataKey,n==null&&a!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var l;return((l=i.settings)===null||l===void 0?void 0:l.dataKey)===n})},ed=e=>e.options.tooltipPayloadSearcher,ho=e=>e.tooltip;function hN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function pN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hN(Object(r),!0).forEach(function(a){tee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function tee(e,t,r){return(t=ree(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ree(e){var t=see(e,"string");return typeof t=="symbol"?t:t+""}function see(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aee(e,t){return e??t}var b5=(e,t,r,a,n,i,l)=>{if(!(t==null||i==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,m=[];return e.reduce((f,x)=>{var p,{dataDefinedOnItem:h,settings:g}=x,b=aee(h,o),j=Array.isArray(b)?cC(b,u,d):b,y=(p=g?.dataKey)!==null&&p!==void 0?p:a,w=g?.nameKey,N;if(a&&Array.isArray(j)&&!Array.isArray(j[0])&&l==="axis"?N=HH(j,a,n):N=i(j,t,c,w),Array.isArray(N))N.forEach(E=>{var _=pN(pN({},g),{},{name:E.name,unit:E.unit,color:void 0,fill:void 0});f.push(Jj({tooltipEntrySettings:_,dataKey:E.dataKey,payload:E.payload,value:Pr(E.payload,E.dataKey),name:E.name}))});else{var S;f.push(Jj({tooltipEntrySettings:g,dataKey:y,payload:N,value:Pr(N,y),name:(S=Pr(N,w))!==null&&S!==void 0?S:g?.name}))}return f},m)}},p1=be([vs,tr,L_,$v,ls],Z_),nee=be([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),iee=be([ls,co],Xv),td=be([nee,vs,iee],Zv),lee=be([td],e=>e.filter(Um)),oee=be([td],Qv),po=be([oee,yi],e1),cee=be([lee,yi,vs],O_),x1=be([po,vs,td],r1),dee=be([vs],s1),uee=be([td],e=>e.filter(Um)),mee=be([cee,uee,Yc],U_),fee=be([mee,yi,ls],$_),hee=be([td],M_),pee=be([po,vs,hee,Wm,ls],W_),xee=be([V_,ls,co],uo),gee=be([xee,ls],K_),vee=be([G_,ls,co],uo),bee=be([vee,ls],Y_),yee=be([q_,ls,co],uo),jee=be([yee,ls],X_),wee=be([gee,jee,bee],Mu),Nee=be([vs,dee,fee,pee,wee,tr,ls],a1),y5=be([vs,tr,po,x1,Yc,ls,Nee],n1),See=be([y5,vs,p1],o1),Eee=be([vs,y5,See,ls],d1),j5=e=>{var t=ls(e),r=co(e),a=!1;return Qc(e,t,r,a)},w5=be([vs,j5],Bm),N5=be([vs,p1,Eee,w5],l1),Tee=be([tr,x1,vs,ls],n5),Aee=be([tr,x1,vs,ls],i5),Cee=(e,t,r,a,n,i,l,o)=>{if(t){var{type:c}=t,u=pl(e,o);if(a){var d=r==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,m=c==="category"&&a.bandwidth?a.bandwidth()/d:0;return m=o==="angleAxis"&&n!=null&&n?.length>=2?ms(n[0]-n[1])*2*m:m,u&&l?l.map((f,x)=>({coordinate:a(f)+m,value:f,index:x,offset:m})):a.domain().map((f,x)=>({coordinate:a(f)+m,value:i?i[f]:f,index:x,offset:m}))}}},Vn=be([tr,vs,p1,N5,j5,Tee,Aee,ls],Cee),g1=be([o5,c5,UQ],(e,t,r)=>d5(r.shared,e,t)),S5=e=>e.tooltip.settings.trigger,v1=e=>e.tooltip.settings.defaultIndex,Gm=be([ho,g1,S5,v1],x5),il=be([Gm,po],h1),E5=be([Vn,il],u5),T5=be([Gm],e=>{if(e)return e.dataKey}),A5=be([ho,g1,S5,v1],v5),_ee=be([zn,Un,tr,ns,Vn,v1,A5,ed],g5),kee=be([Gm,_ee],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Dee=be([Gm],e=>e.active),Iee=be([A5,il,yi,I_,E5,ed,g1],b5);be([Iee],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function xN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function gN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xN(Object(r),!0).forEach(function(a){Oee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Oee(e,t,r){return(t=Pee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pee(e){var t=Ree(e,"string");return typeof t=="symbol"?t:t+""}function Ree(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lee=()=>tt(vs),Fee=()=>{var e=Lee(),t=tt(Vn),r=tt(N5);return ov(gN(gN({},e),{},{scale:r}),t)},Mee=()=>tt($v),b1=(e,t)=>t,C5=(e,t,r)=>r,y1=(e,t,r,a)=>a,Bee=be(Vn,e=>bm(e,t=>t.coordinate)),j1=be([ho,b1,C5,y1],x5),_5=be([j1,po],h1),zee=(e,t,r)=>{if(t!=null){var a=ho(e);return t==="axis"?r==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:r==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},k5=be([ho,b1,C5,y1],v5),Bu=be([zn,Un,tr,ns,Vn,y1,k5,ed],g5),Uee=be([j1,Bu],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),D5=be(Vn,_5,u5),$ee=be([k5,_5,yi,I_,D5,ed,b1],b5),Wee=be([j1],e=>({isActive:e.active,activeIndex:e.index})),Hee=(e,t,r,a,n,i,l,o)=>{if(!(!e||!t||!a||!n||!i)){var c=mK(e.chartX,e.chartY,t,r,o);if(c){var u=hK(c,t),d=Qq(u,l,i,a,n),m=fK(t,i,d,c);return{activeIndex:String(d),activeCoordinate:m}}}};function Dx(){return Dx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Dx.apply(null,arguments)}function vN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Pd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vN(Object(r),!0).forEach(function(a){Vee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Vee(e,t,r){return(t=Gee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gee(e){var t=qee(e,"string");return typeof t=="symbol"?t:t+""}function qee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kee(e){var{coordinate:t,payload:r,index:a,offset:n,tooltipAxisBandSize:i,layout:l,cursor:o,tooltipEventType:c,chartName:u}=e,d=t,m=r,f=a;if(!o||!d||u!=="ScatterChart"&&c!=="axis")return null;var x,p;if(u==="ScatterChart")x=d,p=hY;else if(u==="BarChart")x=pY(l,d,n,i),p=EC;else if(l==="radial"){var{cx:h,cy:g,radius:b,startAngle:j,endAngle:y}=TC(d);x={cx:h,cy:g,startAngle:j,endAngle:y,innerRadius:b,outerRadius:b},p=CC}else x={points:KY(l,d,n)},p=yC;var w=typeof o=="object"&&"className"in o?o.className:void 0,N=Pd(Pd(Pd(Pd({stroke:"#ccc",pointerEvents:"none"},n),x),as(o,!1)),{},{payload:m,payloadIndex:f,className:Bt("recharts-tooltip-cursor",w)});return v.isValidElement(o)?v.cloneElement(o,N):v.createElement(p,N)}function Yee(e){var t=Fee(),r=pC(),a=fv(),n=Mee();return v.createElement(Kee,Dx({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:a,tooltipAxisBandSize:t,chartName:n}))}var I5=v.createContext(null),Xee=()=>v.useContext(I5),Ih={exports:{}},bN;function Jee(){return bN||(bN=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1));function n(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,m,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var x=new n(d,m||c,f),p=r?r+u:u;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],x]:c._events[p].push(x):(c._events[p]=x,c._eventsCount++),c}function l(c,u){--c._eventsCount===0?c._events=new a:delete c._events[u]}function o(){this._events=new a,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,m;if(this._eventsCount===0)return u;for(m in d=this._events)t.call(d,m)&&u.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,m=this._events[d];if(!m)return[];if(m.fn)return[m.fn];for(var f=0,x=m.length,p=new Array(x);f<x;f++)p[f]=m[f].fn;return p},o.prototype.listenerCount=function(u){var d=r?r+u:u,m=this._events[d];return m?m.fn?1:m.length:0},o.prototype.emit=function(u,d,m,f,x,p){var h=r?r+u:u;if(!this._events[h])return!1;var g=this._events[h],b=arguments.length,j,y;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,m),!0;case 4:return g.fn.call(g.context,d,m,f),!0;case 5:return g.fn.call(g.context,d,m,f,x),!0;case 6:return g.fn.call(g.context,d,m,f,x,p),!0}for(y=1,j=new Array(b-1);y<b;y++)j[y-1]=arguments[y];g.fn.apply(g.context,j)}else{var w=g.length,N;for(y=0;y<w;y++)switch(g[y].once&&this.removeListener(u,g[y].fn,void 0,!0),b){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,d);break;case 3:g[y].fn.call(g[y].context,d,m);break;case 4:g[y].fn.call(g[y].context,d,m,f);break;default:if(!j)for(N=1,j=new Array(b-1);N<b;N++)j[N-1]=arguments[N];g[y].fn.apply(g[y].context,j)}}return!0},o.prototype.on=function(u,d,m){return i(this,u,d,m,!1)},o.prototype.once=function(u,d,m){return i(this,u,d,m,!0)},o.prototype.removeListener=function(u,d,m,f){var x=r?r+u:u;if(!this._events[x])return this;if(!d)return l(this,x),this;var p=this._events[x];if(p.fn)p.fn===d&&(!f||p.once)&&(!m||p.context===m)&&l(this,x);else{for(var h=0,g=[],b=p.length;h<b;h++)(p[h].fn!==d||f&&!p[h].once||m&&p[h].context!==m)&&g.push(p[h]);g.length?this._events[x]=g.length===1?g[0]:g:l(this,x)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&l(this,d)):(this._events=new a,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(Ih)),Ih.exports}var Zee=Jee();const Qee=fi(Zee);var wc=new Qee,Ix="recharts.syncEvent.tooltip",yN="recharts.syncEvent.brush";function O5(e,t){if(t){var r=Number.parseInt(t,10);if(!pa(r))return e?.[r]}}var ete={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},P5=va({name:"options",initialState:ete,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),tte=P5.reducer,{createEventEmitter:rte}=P5.actions;function ste(e){return e.tooltip.syncInteraction}var ate={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},R5=va({name:"chartData",initialState:ate,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:a}=t.payload;r!=null&&(e.dataStartIndex=r),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:jN,setDataStartEndIndexes:nte,setComputedData:Ode}=R5.actions,ite=R5.reducer,lte=["x","y"];function wN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ei(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wN(Object(r),!0).forEach(function(a){ote(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ote(e,t,r){return(t=cte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cte(e){var t=dte(e,"string");return typeof t=="symbol"?t:t+""}function dte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ute(e,t){if(e==null)return{};var r,a,n=mte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mte(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var L5=()=>{};function fte(){var e=tt(Wv),t=tt(Hv),r=Rr(),a=tt(T_),n=tt(Vn),i=fv(),l=dv(),o=tt(c=>c.rootProps.className);v.useEffect(()=>{if(e==null)return L5;var c=(u,d,m)=>{if(t!==m&&e===u){if(a==="index"){var f;if(l&&d!==null&&d!==void 0&&(f=d.payload)!==null&&f!==void 0&&f.coordinate){var x=d.payload.coordinate,{x:p,y:h}=x,g=ute(x,lte),b=Ei(Ei(Ei({},g),typeof p=="number"&&{x:Math.max(l.x,Math.min(p,l.x+l.width))}),typeof h=="number"&&{y:Math.max(l.y,Math.min(h,l.y+l.height))}),j=Ei(Ei({},d),{},{payload:Ei(Ei({},d.payload),{},{coordinate:b})});r(j)}else r(d);return}if(n!=null){var y;if(typeof a=="function"){var w={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},N=a(n,w);y=n[N]}else a==="value"&&(y=n.find(P=>String(P.value)===d.payload.label));var{coordinate:S}=d.payload;if(y==null||d.payload.active===!1||S==null||l==null){r(_x({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:E,y:_}=S,T=Math.min(E,l.x+l.width),C=Math.min(_,l.y+l.height),A={x:i==="horizontal"?y.coordinate:T,y:i==="horizontal"?C:y.coordinate},D=_x({active:d.payload.active,coordinate:A,dataKey:d.payload.dataKey,index:String(y.index),label:d.payload.label});r(D)}}};return wc.on(Ix,c),()=>{wc.off(Ix,c)}},[o,r,t,e,a,n,i,l])}function hte(){var e=tt(Wv),t=tt(Hv),r=Rr();v.useEffect(()=>{if(e==null)return L5;var a=(n,i,l)=>{t!==l&&e===n&&r(nte(i))};return wc.on(yN,a),()=>{wc.off(yN,a)}},[r,t,e])}function pte(){var e=Rr();v.useEffect(()=>{e(rte())},[e]),fte(),hte()}function xte(e,t,r,a,n,i){var l=tt(f=>zee(f,e,t)),o=tt(Hv),c=tt(Wv),u=tt(T_),d=tt(ste),m=d?.active;v.useEffect(()=>{if(!m&&c!=null&&o!=null){var f=_x({active:i,coordinate:r,dataKey:l,index:n,label:typeof a=="number"?String(a):a});wc.emit(Ix,c,f,o)}},[m,r,l,n,a,o,c,u,i])}function NN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function SN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NN(Object(r),!0).forEach(function(a){gte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function gte(e,t,r){return(t=vte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vte(e){var t=bte(e,"string");return typeof t=="symbol"?t:t+""}function bte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yte(e){return e.dataKey}function jte(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement(GK,t)}var EN=[],wte={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!xl.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Rd(e){var t=Xs(e,wte),{active:r,allowEscapeViewBox:a,animationDuration:n,animationEasing:i,content:l,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:d,position:m,reverseDirection:f,useTranslate3d:x,wrapperStyle:p,cursor:h,shared:g,trigger:b,defaultIndex:j,portal:y,axisId:w}=t,N=Rr(),S=typeof j=="number"?String(j):j;v.useEffect(()=>{N(VQ({shared:g,trigger:b,axisId:w,active:r,defaultIndex:S}))},[N,g,b,w,r,S]);var E=dv(),_=bC(),T=zQ(g),{activeIndex:C,isActive:A}=tt(k=>Wee(k,T,b,S)),D=tt(k=>$ee(k,T,b,S)),P=tt(k=>D5(k,T,b,S)),R=tt(k=>Uee(k,T,b,S)),M=D,X=Xee(),ie=r??A,[ae,V]=FA([M,ie]),me=T==="axis"?P:void 0;xte(T,b,R,me,C,ie);var ue=y??X;if(ue==null)return null;var F=M??EN;ie||(F=EN),o&&F.length&&(F=IA(M.filter(k=>k.value!=null&&(k.hide!==!0||t.includeHidden)),d,yte));var Y=F.length>0,z=v.createElement(QK,{allowEscapeViewBox:a,animationDuration:n,animationEasing:i,isAnimationActive:c,active:ie,coordinate:R,hasPayload:Y,offset:u,position:m,reverseDirection:f,useTranslate3d:x,viewBox:E,wrapperStyle:p,lastBoundingBox:ae,innerRef:V,hasPortalFromProps:!!y},jte(l,SN(SN({},t),{},{payload:F,label:me,active:ie,coordinate:R,accessibilityLayer:_})));return v.createElement(v.Fragment,null,$x.createPortal(z,ue),ie&&v.createElement(Yee,{cursor:h,tooltipEventType:T,coordinate:R,payload:M,index:C}))}var Oh={},Ph={},Rh={},TN;function Nte(){return TN||(TN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a,{signal:n,edges:i}={}){let l,o=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{o!==null&&(r.apply(l,o),l=void 0,o=null)},m=()=>{u&&d(),h()};let f=null;const x=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,m()},a)},p=()=>{f!==null&&(clearTimeout(f),f=null)},h=()=>{p(),l=void 0,o=null},g=()=>{d()},b=function(...j){if(n?.aborted)return;l=this,o=j;const y=f==null;x(),c&&y&&d()};return b.schedule=x,b.cancel=h,b.flush=g,n?.addEventListener("abort",h,{once:!0}),b}e.debounce=t})(Rh)),Rh}var AN;function Ste(){return AN||(AN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Nte();function r(a,n=0,i={}){typeof i!="object"&&(i={});const{leading:l=!1,trailing:o=!0,maxWait:c}=i,u=Array(2);l&&(u[0]="leading"),o&&(u[1]="trailing");let d,m=null;const f=t.debounce(function(...h){d=a.apply(this,h),m=null},n,{edges:u}),x=function(...h){return c!=null&&(m===null&&(m=Date.now()),Date.now()-m>=c)?(d=a.apply(this,h),m=Date.now(),f.cancel(),f.schedule(),d):(f.apply(this,h),d)},p=()=>(f.flush(),d);return x.cancel=f.cancel,x.flush=p,x}e.debounce=r})(Ph)),Ph}var CN;function Ete(){return CN||(CN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ste();function r(a,n=0,i={}){const{leading:l=!0,trailing:o=!0}=i;return t.debounce(a,n,{leading:l,maxWait:n,trailing:o})}e.throttle=r})(Oh)),Oh}var Lh,_N;function Tte(){return _N||(_N=1,Lh=Ete().throttle),Lh}var Ate=Tte();const Cte=fi(Ate);var Go=function(t,r){for(var a=arguments.length,n=new Array(a>2?a-2:0),i=2;i<a;i++)n[i-2]=arguments[i]};function kN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Fh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kN(Object(r),!0).forEach(function(a){_te(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function _te(e,t,r){return(t=kte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kte(e){var t=Dte(e,"string");return typeof t=="symbol"?t:t+""}function Dte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ld=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:a={width:-1,height:-1},width:n="100%",height:i="100%",minWidth:l=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:m,className:f,onResize:x,style:p={}}=e,h=v.useRef(null),g=v.useRef();g.current=x,v.useImperativeHandle(t,()=>h.current);var[b,j]=v.useState({containerWidth:a.width,containerHeight:a.height}),y=v.useCallback((N,S)=>{j(E=>{var _=Math.round(N),T=Math.round(S);return E.containerWidth===_&&E.containerHeight===T?E:{containerWidth:_,containerHeight:T}})},[]);v.useEffect(()=>{var N=T=>{var C,{width:A,height:D}=T[0].contentRect;y(A,D),(C=g.current)===null||C===void 0||C.call(g,A,D)};d>0&&(N=Cte(N,d,{trailing:!0,leading:!1}));var S=new ResizeObserver(N),{width:E,height:_}=h.current.getBoundingClientRect();return y(E,_),S.observe(h.current),()=>{S.disconnect()}},[y,d]);var w=v.useMemo(()=>{var{containerWidth:N,containerHeight:S}=b;if(N<0||S<0)return null;Go(Ii(n)||Ii(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,n,i),Go(!r||r>0,"The aspect(%s) must be greater than zero.",r);var E=Ii(n)?N:n,_=Ii(i)?S:i;return r&&r>0&&(E?_=E/r:_&&(E=_*r),c&&_>c&&(_=c)),Go(E>0||_>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,E,_,n,i,l,o,r),v.Children.map(u,T=>v.cloneElement(T,{width:E,height:_,style:Fh({width:E,height:_},T.props.style)}))},[r,u,i,c,o,l,b,n]);return v.createElement("div",{id:m?"".concat(m):void 0,className:Bt("recharts-responsive-container",f),style:Fh(Fh({},p),{},{width:n,height:i,minWidth:l,minHeight:o,maxHeight:c}),ref:h},v.createElement("div",{style:{width:0,height:0,overflow:"visible"}},w))}),rd=e=>null;rd.displayName="Cell";function Ite(e,t,r){return(t=Ote(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ote(e){var t=Pte(e,"string");return typeof t=="symbol"?t:t+""}function Pte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Rte{constructor(t){Ite(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function DN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Lte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DN(Object(r),!0).forEach(function(a){Fte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Fte(e,t,r){return(t=Mte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mte(e){var t=Bte(e,"string");return typeof t=="symbol"?t:t+""}function Bte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zte={cacheSize:2e3,enableCache:!0},F5=Lte({},zte),IN=new Rte(F5.cacheSize),Ute={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},ON="recharts_measurement_span";function $te(e,t){var r=t.fontSize||"",a=t.fontFamily||"",n=t.fontWeight||"",i=t.fontStyle||"",l=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(a,"|").concat(n,"|").concat(i,"|").concat(l,"|").concat(o)}var PN=(e,t)=>{try{var r=document.getElementById(ON);r||(r=document.createElement("span"),r.setAttribute("id",ON),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Ute,t),r.textContent="".concat(e);var a=r.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},qo=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||xl.isSsr)return{width:0,height:0};if(!F5.enableCache)return PN(t,r);var a=$te(t,r),n=IN.get(a);if(n)return n;var i=PN(t,r);return IN.set(a,i),i},RN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,LN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Wte=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Hte=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,M5={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Vte=Object.keys(M5),Cl="NaN";function Gte(e,t){return e*M5[t]}class Zs{static parse(t){var r,[,a,n]=(r=Hte.exec(t))!==null&&r!==void 0?r:[];return new Zs(parseFloat(a),n??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,pa(t)&&(this.unit=""),r!==""&&!Wte.test(r)&&(this.num=NaN,this.unit=""),Vte.includes(r)&&(this.num=Gte(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Zs(NaN,""):new Zs(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Zs(NaN,""):new Zs(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Zs(NaN,""):new Zs(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Zs(NaN,""):new Zs(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return pa(this.num)}}function B5(e){if(e.includes(Cl))return Cl;for(var t=e;t.includes("*")||t.includes("/");){var r,[,a,n,i]=(r=RN.exec(t))!==null&&r!==void 0?r:[],l=Zs.parse(a??""),o=Zs.parse(i??""),c=n==="*"?l.multiply(o):l.divide(o);if(c.isNaN())return Cl;t=t.replace(RN,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,m,f]=(u=LN.exec(t))!==null&&u!==void 0?u:[],x=Zs.parse(d??""),p=Zs.parse(f??""),h=m==="+"?x.add(p):x.subtract(p);if(h.isNaN())return Cl;t=t.replace(LN,h.toString())}return t}var FN=/\(([^()]*)\)/;function qte(e){for(var t=e,r;(r=FN.exec(t))!=null;){var[,a]=r;t=t.replace(FN,B5(a))}return t}function Kte(e){var t=e.replace(/\s+/g,"");return t=qte(t),t=B5(t),t}function Yte(e){try{return Kte(e)}catch{return Cl}}function Mh(e){var t=Yte(e.slice(5,-1));return t===Cl?"":t}var Xte=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Jte=["dx","dy","angle","className","breakAll"];function Ox(){return Ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ox.apply(null,arguments)}function MN(e,t){if(e==null)return{};var r,a,n=Zte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Zte(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var z5=/[ \f\n\r\t\v\u2028\u2029]+/,U5=e=>{var{children:t,breakAll:r,style:a}=e;try{var n=[];ps(t)||(r?n=t.toString().split(""):n=t.toString().split(z5));var i=n.map(o=>({word:o,width:qo(o,a).width})),l=r?0:qo("",a).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}},Qte=(e,t,r,a,n)=>{var{maxLines:i,children:l,style:o,breakAll:c}=e,u=at(i),d=l,m=function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return A.reduce((D,P)=>{var{word:R,width:M}=P,X=D[D.length-1];if(X&&(a==null||n||X.width+M+r<Number(a)))X.words.push(R),X.width+=M+r;else{var ie={words:[R],width:M};D.push(ie)}return D},[])},f=m(t),x=C=>C.reduce((A,D)=>A.width>D.width?A:D);if(!u||n)return f;var p=f.length>i||x(f).width>Number(a);if(!p)return f;for(var h="",g=C=>{var A=d.slice(0,C),D=U5({breakAll:c,style:o,children:A+h}).wordsWithComputedWidth,P=m(D),R=P.length>i||x(P).width>Number(a);return[R,P]},b=0,j=d.length-1,y=0,w;b<=j&&y<=d.length-1;){var N=Math.floor((b+j)/2),S=N-1,[E,_]=g(S),[T]=g(N);if(!E&&!T&&(b=N+1),E&&T&&(j=N-1),!E&&T){w=_;break}y++}return w||f},BN=e=>{var t=ps(e)?[]:e.toString().split(z5);return[{words:t}]},ere=e=>{var{width:t,scaleToFit:r,children:a,style:n,breakAll:i,maxLines:l}=e;if((t||r)&&!xl.isSsr){var o,c,u=U5({breakAll:i,children:a,style:n});if(u){var{wordsWithComputedWidth:d,spaceWidth:m}=u;o=d,c=m}else return BN(a);return Qte({breakAll:i,children:a,maxLines:l,style:n},o,c,t,r)}return BN(a)},zN="#808080",qm=v.forwardRef((e,t)=>{var{x:r=0,y:a=0,lineHeight:n="1em",capHeight:i="0.71em",scaleToFit:l=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=zN}=e,d=MN(e,Xte),m=v.useMemo(()=>ere({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:l,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,l,d.style,d.width]),{dx:f,dy:x,angle:p,className:h,breakAll:g}=d,b=MN(d,Jte);if(!fn(r)||!fn(a)||m.length===0)return null;var j=r+(at(f)?f:0),y=a+(at(x)?x:0),w;switch(c){case"start":w=Mh("calc(".concat(i,")"));break;case"middle":w=Mh("calc(".concat((m.length-1)/2," * -").concat(n," + (").concat(i," / 2))"));break;default:w=Mh("calc(".concat(m.length-1," * -").concat(n,")"));break}var N=[];if(l){var S=m[0].width,{width:E}=d;N.push("scale(".concat(at(E)?E/S:1,")"))}return p&&N.push("rotate(".concat(p,", ").concat(j,", ").concat(y,")")),N.length&&(b.transform=N.join(" ")),v.createElement("text",Ox({},as(b,!0),{ref:t,x:j,y,className:Bt("recharts-text",h),textAnchor:o,fill:u.includes("url")?zN:u}),m.map((_,T)=>{var C=_.words.join(g?"":" ");return v.createElement("tspan",{x:j,dy:T===0?w:n,key:"".concat(C,"-").concat(T)},C)}))});qm.displayName="Text";var tre=["labelRef"];function rre(e,t){if(e==null)return{};var r,a,n=sre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function sre(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function UN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ur(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UN(Object(r),!0).forEach(function(a){are(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function are(e,t,r){return(t=nre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nre(e){var t=ire(e,"string");return typeof t=="symbol"?t:t+""}function ire(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yn(){return yn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},yn.apply(null,arguments)}var $5=v.createContext(null),lre=e=>{var{x:t,y:r,width:a,height:n,children:i}=e,l=v.useMemo(()=>({x:t,y:r,width:a,height:n}),[t,r,a,n]);return v.createElement($5.Provider,{value:l},i)},W5=()=>{var e=v.useContext($5),t=dv();return e||t},ore=v.createContext(null),cre=()=>{var e=v.useContext(ore),t=tt(D_);return e||t},dre=e=>{var{value:t,formatter:r}=e,a=ps(e.children)?t:e.children;return typeof r=="function"?r(a):a},w1=e=>e!=null&&typeof e=="function",ure=(e,t)=>{var r=ms(t-e),a=Math.min(Math.abs(t-e),360);return r*a},mre=(e,t,r,a,n)=>{var{offset:i,className:l}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:m,endAngle:f,clockWise:x}=n,p=(u+d)/2,h=ure(m,f),g=h>=0?1:-1,b,j;switch(t){case"insideStart":b=m+g*i,j=x;break;case"insideEnd":b=f-g*i,j=!x;break;case"end":b=f+g*i,j=x;break;default:throw new Error("Unsupported position ".concat(t))}j=h<=0?j:!j;var y=Jr(o,c,p,b),w=Jr(o,c,p,b+(j?1:-1)*359),N="M".concat(y.x,",").concat(y.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(j?0:1,`,
    `).concat(w.x,",").concat(w.y),S=ps(e.id)?fc("recharts-radial-line-"):e.id;return v.createElement("text",yn({},a,{dominantBaseline:"central",className:Bt("recharts-radial-bar-label",l)}),v.createElement("defs",null,v.createElement("path",{id:S,d:N})),v.createElement("textPath",{xlinkHref:"#".concat(S)},r))},fre=(e,t,r)=>{var{cx:a,cy:n,innerRadius:i,outerRadius:l,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:m}=Jr(a,n,l+t,u);return{x:d,y:m,textAnchor:d>=a?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"end"};var f=(i+l)/2,{x,y:p}=Jr(a,n,f,u);return{x,y:p,textAnchor:"middle",verticalAnchor:"middle"}},H5=e=>"cx"in e&&at(e.cx),hre=(e,t)=>{var{parentViewBox:r,offset:a,position:n}=e,i;r!=null&&!H5(r)&&(i=r);var{x:l,y:o,width:c,height:u}=t,d=u>=0?1:-1,m=d*a,f=d>0?"end":"start",x=d>0?"start":"end",p=c>=0?1:-1,h=p*a,g=p>0?"end":"start",b=p>0?"start":"end";if(n==="top"){var j={x:l+c/2,y:o-d*a,textAnchor:"middle",verticalAnchor:f};return Ur(Ur({},j),i?{height:Math.max(o-i.y,0),width:c}:{})}if(n==="bottom"){var y={x:l+c/2,y:o+u+m,textAnchor:"middle",verticalAnchor:x};return Ur(Ur({},y),i?{height:Math.max(i.y+i.height-(o+u),0),width:c}:{})}if(n==="left"){var w={x:l-h,y:o+u/2,textAnchor:g,verticalAnchor:"middle"};return Ur(Ur({},w),i?{width:Math.max(w.x-i.x,0),height:u}:{})}if(n==="right"){var N={x:l+c+h,y:o+u/2,textAnchor:b,verticalAnchor:"middle"};return Ur(Ur({},N),i?{width:Math.max(i.x+i.width-N.x,0),height:u}:{})}var S=i?{width:c,height:u}:{};return n==="insideLeft"?Ur({x:l+h,y:o+u/2,textAnchor:b,verticalAnchor:"middle"},S):n==="insideRight"?Ur({x:l+c-h,y:o+u/2,textAnchor:g,verticalAnchor:"middle"},S):n==="insideTop"?Ur({x:l+c/2,y:o+m,textAnchor:"middle",verticalAnchor:x},S):n==="insideBottom"?Ur({x:l+c/2,y:o+u-m,textAnchor:"middle",verticalAnchor:f},S):n==="insideTopLeft"?Ur({x:l+h,y:o+m,textAnchor:b,verticalAnchor:x},S):n==="insideTopRight"?Ur({x:l+c-h,y:o+m,textAnchor:g,verticalAnchor:x},S):n==="insideBottomLeft"?Ur({x:l+h,y:o+u-m,textAnchor:b,verticalAnchor:f},S):n==="insideBottomRight"?Ur({x:l+c-h,y:o+u-m,textAnchor:g,verticalAnchor:f},S):n&&typeof n=="object"&&(at(n.x)||Ii(n.x))&&(at(n.y)||Ii(n.y))?Ur({x:l+Ms(n.x,c),y:o+Ms(n.y,u),textAnchor:"end",verticalAnchor:"end"},S):Ur({x:l+c/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},S)},pre={offset:5};function Jn(e){var t=Xs(e,pre),{viewBox:r,position:a,value:n,children:i,content:l,className:o="",textBreakAll:c,labelRef:u}=t,d=cre(),m=W5(),f=a==="center"?m:d??m,x=r||f;if(!x||ps(n)&&ps(i)&&!v.isValidElement(l)&&typeof l!="function")return null;var p=Ur(Ur({},t),{},{viewBox:x});if(v.isValidElement(l)){var{labelRef:h}=p,g=rre(p,tre);return v.cloneElement(l,g)}var b;if(typeof l=="function"){if(b=v.createElement(l,p),v.isValidElement(b))return b}else b=dre(t);var j=H5(x),y=as(t,!0);if(j&&(a==="insideStart"||a==="insideEnd"||a==="end"))return mre(t,a,b,y,x);var w=j?fre(x,t.offset,t.position):hre(t,x);return v.createElement(qm,yn({ref:u,className:Bt("recharts-label",o)},y,w,{breakAll:c}),b)}Jn.displayName="Label";var xre=(e,t,r)=>{if(!e)return null;var a={viewBox:t,labelRef:r};return e===!0?v.createElement(Jn,yn({key:"label-implicit"},a)):fn(e)?v.createElement(Jn,yn({key:"label-implicit",value:e},a)):v.isValidElement(e)?e.type===Jn?v.cloneElement(e,Ur({key:"label-implicit"},a)):v.createElement(Jn,yn({key:"label-implicit",content:e},a)):w1(e)?v.createElement(Jn,yn({key:"label-implicit",content:e},a)):e&&typeof e=="object"?v.createElement(Jn,yn({},e,{key:"label-implicit"},a)):null};function gre(e){var{label:t}=e,r=W5();return xre(t,r)||null}var Bh={},zh={},$N;function vre(){return $N||($N=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(zh)),zh}var Uh={},WN;function bre(){return WN||(WN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Uh)),Uh}var HN;function yre(){return HN||(HN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vre(),r=bre(),a=ev();function n(i){if(a.isArrayLike(i))return t.last(r.toArray(i))}e.last=n})(Bh)),Bh}var $h,VN;function jre(){return VN||(VN=1,$h=yre().last),$h}var wre=jre();const Nre=fi(wre);var Sre=["valueAccessor"],Ere=["dataKey","clockWise","id","textBreakAll"];function zu(){return zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},zu.apply(null,arguments)}function GN(e,t){if(e==null)return{};var r,a,n=Tre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Tre(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Are=e=>Array.isArray(e.value)?Nre(e.value):e.value,V5=v.createContext(void 0),Cre=V5.Provider,G5=v.createContext(void 0),_re=G5.Provider;function kre(){return v.useContext(V5)}function Dre(){return v.useContext(G5)}function Vd(e){var{valueAccessor:t=Are}=e,r=GN(e,Sre),{dataKey:a,clockWise:n,id:i,textBreakAll:l}=r,o=GN(r,Ere),c=kre(),u=Dre(),d=c||u;return!d||!d.length?null:v.createElement(aa,{className:"recharts-label-list"},d.map((m,f)=>{var x,p=ps(a)?t(m,f):Pr(m&&m.payload,a),h=ps(i)?{}:{id:"".concat(i,"-").concat(f)};return v.createElement(Jn,zu({},as(m,!0),o,h,{fill:(x=r.fill)!==null&&x!==void 0?x:m.fill,parentViewBox:m.parentViewBox,value:p,textBreakAll:l,viewBox:m.viewBox,key:"label-".concat(f),index:f}))}))}Vd.displayName="LabelList";function q5(e){var{label:t}=e;return t?t===!0?v.createElement(Vd,{key:"labelList-implicit"}):v.isValidElement(t)||w1(t)?v.createElement(Vd,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(Vd,zu({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var K5=e=>e.graphicalItems.polarItems,Ire=be([Cr,Xc],Xv),N1=be([K5,Vr,Ire],Zv),Ore=be([N1],Qv),S1=be([Ore,Mv],e1),Pre=be([S1,Vr,N1],r1),Rre=be([S1,Vr,N1],(e,t,r)=>r.length>0?e.flatMap(a=>r.flatMap(n=>{var i,l=Pr(a,(i=t.dataKey)!==null&&i!==void 0?i:n.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:Pr(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]}))),qN=()=>{},Lre=be([Vr,J_,qN,Rre,qN,tr,Cr],a1),Y5=be([Vr,tr,S1,Pre,Yc,Cr,Lre],n1),Fre=be([Y5,Vr,mo],o1);be([Vr,Y5,Fre,Cr],d1);var Mre={radiusAxis:{},angleAxis:{}},X5=va({name:"polarAxis",initialState:Mre,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Pde,removeRadiusAxis:Rde,addAngleAxis:Lde,removeAngleAxis:Fde}=X5.actions,Bre=X5.reducer;function KN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function YN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KN(Object(r),!0).forEach(function(a){zre(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function zre(e,t,r){return(t=Ure(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ure(e){var t=$re(e,"string");return typeof t=="symbol"?t:t+""}function $re(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wre=(e,t)=>t,E1=be([K5,Wre],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),Hre=[],T1=(e,t,r)=>r?.length===0?Hre:r,J5=be([Mv,E1,T1],(e,t,r)=>{var{chartData:a}=e;if(t!=null){var n;if(t?.data!=null&&t.data.length>0?n=t.data:n=a,(!n||!n.length)&&r!=null&&(n=r.map(i=>YN(YN({},t.presentationProps),i.props))),n!=null)return n}}),Vre=be([J5,E1,T1],(e,t,r)=>{if(!(e==null||t==null))return e.map((a,n)=>{var i,l=Pr(a,t.nameKey,t.name),o;return r!=null&&(i=r[n])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[n].props.fill:typeof a=="object"&&a!=null&&"fill"in a?o=a.fill:o=t.fill,{value:Em(l,t.dataKey),color:o,payload:a,type:t.legendType}})}),Gre=be([J5,E1,T1,ns],(e,t,r,a)=>{if(!(t==null||e==null))return Vse({offset:a,pieSettings:t,displayedData:e,cells:r})}),Wh={},XN;function qre(){return XN||(XN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${n}]`}let a=r;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(r)===a}e.isPlainObject=t})(Wh)),Wh}var Hh,JN;function Kre(){return JN||(JN=1,Hh=qre().isPlainObject),Hh}var Yre=Kre();const Xre=fi(Yre);function ZN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function QN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZN(Object(r),!0).forEach(function(a){Jre(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Jre(e,t,r){return(t=Zre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zre(e){var t=Qre(e,"string");return typeof t=="symbol"?t:t+""}function Qre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Uu.apply(null,arguments)}var e2=(e,t,r,a,n)=>{var i=r-a,l;return l="M ".concat(e,",").concat(t),l+="L ".concat(e+r,",").concat(t),l+="L ".concat(e+r-i/2,",").concat(t+n),l+="L ".concat(e+r-i/2-a,",").concat(t+n),l+="L ".concat(e,",").concat(t," Z"),l},ese={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},tse=e=>{var t=Xs(e,ese),{x:r,y:a,upperWidth:n,lowerWidth:i,height:l,className:o}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:m}=t,f=v.useRef(),[x,p]=v.useState(-1),h=v.useRef(n),g=v.useRef(i),b=v.useRef(l),j=v.useRef(r),y=v.useRef(a),w=Dm(e,"trapezoid-");if(v.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var R=f.current.getTotalLength();R&&p(R)}catch{}},[]),r!==+r||a!==+a||n!==+n||i!==+i||l!==+l||n===0&&i===0||l===0)return null;var N=Bt("recharts-trapezoid",o);if(!m)return v.createElement("g",null,v.createElement("path",Uu({},as(t,!0),{className:N,d:e2(r,a,n,i,l)})));var S=h.current,E=g.current,_=b.current,T=j.current,C=y.current,A="0px ".concat(x===-1?1:x,"px"),D="".concat(x,"px 0px"),P=jC(["strokeDasharray"],u,c);return v.createElement(km,{animationId:w,key:w,canBegin:x>0,duration:u,easing:c,isActive:m,begin:d},R=>{var M=Ss(S,n,R),X=Ss(E,i,R),ie=Ss(_,l,R),ae=Ss(T,r,R),V=Ss(C,a,R);f.current&&(h.current=M,g.current=X,b.current=ie,j.current=ae,y.current=V);var me=R>0?{transition:P,strokeDasharray:D}:{strokeDasharray:A};return v.createElement("path",Uu({},as(t,!0),{className:N,d:e2(ae,V,M,X,ie),ref:f,style:QN(QN({},me),t.style)}))})},rse=["option","shapeType","propTransformer","activeClassName","isActive"];function sse(e,t){if(e==null)return{};var r,a,n=ase(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ase(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function t2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function $u(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t2(Object(r),!0).forEach(function(a){nse(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function nse(e,t,r){return(t=ise(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ise(e){var t=lse(e,"string");return typeof t=="symbol"?t:t+""}function lse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ose(e,t){return $u($u({},t),e)}function cse(e,t){return e==="symbols"}function r2(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement(EC,r);case"trapezoid":return v.createElement(tse,r);case"sector":return v.createElement(CC,r);case"symbols":if(cse(t))return v.createElement(Jg,r);break;default:return null}}function dse(e){return v.isValidElement(e)?e.props:e}function Z5(e){var{option:t,shapeType:r,propTransformer:a=ose,activeClassName:n="recharts-active-shape",isActive:i}=e,l=sse(e,rse),o;if(v.isValidElement(t))o=v.cloneElement(t,$u($u({},l),dse(t)));else if(typeof t=="function")o=t(l);else if(Xre(t)&&typeof t!="boolean"){var c=a(t,l);o=v.createElement(r2,{shapeType:r,elementProps:c})}else{var u=l;o=v.createElement(r2,{shapeType:r,elementProps:u})}return i?v.createElement(aa,{className:n},o):o}var A1=(e,t)=>{var r=Rr();return(a,n)=>i=>{e?.(a,n,i),r(f5({activeIndex:String(n),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}},C1=e=>{var t=Rr();return(r,a)=>n=>{e?.(r,a,n),t(GQ())}},_1=(e,t)=>{var r=Rr();return(a,n)=>i=>{e?.(a,n,i),r(qQ({activeIndex:String(n),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}};function Q5(e){var{fn:t,args:r}=e,a=Rr(),n=$a();return v.useEffect(()=>{if(!n){var i=t(r);return a(WQ(i)),()=>{a(HQ(i))}}},[t,r,a,n]),null}var e4=()=>{};function use(e){var{legendPayload:t}=e,r=Rr(),a=$a();return v.useEffect(()=>a?e4:(r(gC(t)),()=>{r(vC(t))}),[r,a,t]),null}function mse(e){var{legendPayload:t}=e,r=Rr(),a=tt(tr);return v.useEffect(()=>a!=="centric"&&a!=="radial"?e4:(r(gC(t)),()=>{r(vC(t))}),[r,a,t]),null}var Vh,fse=()=>{var[e]=v.useState(()=>fc("uid-"));return e},hse=(Vh=U4.useId)!==null&&Vh!==void 0?Vh:fse;function pse(e,t){var r=hse();return t||(e?"".concat(e,"-").concat(r):r)}var xse=v.createContext(void 0),t4=e=>{var{id:t,type:r,children:a}=e,n=pse("recharts-".concat(r),t);return v.createElement(xse.Provider,{value:n},a(n))},gse={cartesianItems:[],polarItems:[]},r4=va({name:"graphicalItems",initialState:gse,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:a}=t.payload,n=An(e).cartesianItems.indexOf(r);n>-1&&(e.cartesianItems[n]=a)},removeCartesianGraphicalItem(e,t){var r=An(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=An(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:vse,replaceCartesianGraphicalItem:bse,removeCartesianGraphicalItem:yse,addPolarGraphicalItem:jse,removePolarGraphicalItem:wse}=r4.actions,Nse=r4.reducer;function Sse(e){var t=Rr(),r=v.useRef(null);return v.useEffect(()=>{r.current===null?t(vse(e)):r.current!==e&&t(bse({prev:r.current,next:e})),r.current=e},[t,e]),v.useEffect(()=>()=>{r.current&&(t(yse(r.current)),r.current=null)},[t]),null}function Ese(e){var t=Rr();return v.useEffect(()=>(t(jse(e)),()=>{t(wse(e))}),[t,e]),null}var Tse=["onMouseEnter","onClick","onMouseLeave"],Ase=["id"],Cse=["id"];function k1(e,t){if(e==null)return{};var r,a,n=_se(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _se(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function s2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Nr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s2(Object(r),!0).forEach(function(a){kse(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function kse(e,t,r){return(t=Dse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dse(e){var t=Ise(e,"string");return typeof t=="symbol"?t:t+""}function Ise(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ui(){return ui=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ui.apply(null,arguments)}function Ose(e){var t=v.useMemo(()=>Gg(e.children,rd),[e.children]),r=tt(a=>Vre(a,e.id,t));return r==null?null:v.createElement(mse,{legendPayload:r})}function Pse(e){var{dataKey:t,nameKey:r,sectors:a,stroke:n,strokeWidth:i,fill:l,name:o,hide:c,tooltipType:u}=e;return{dataDefinedOnItem:a.map(d=>d.tooltipPayload),positions:a.map(d=>d.tooltipPosition),settings:{stroke:n,strokeWidth:i,fill:l,dataKey:t,nameKey:r,name:Em(o,t),hide:c,type:u,color:l,unit:""}}}var Rse=(e,t)=>e>t?"start":e<t?"end":"middle",Lse=(e,t,r)=>Ms(typeof t=="function"?t(e):t,r,r*.8),Fse=(e,t,r)=>{var{top:a,left:n,width:i,height:l}=t,o=oC(i,l),c=n+Ms(e.cx,i,i/2),u=a+Ms(e.cy,l,l/2),d=Ms(e.innerRadius,o,0),m=Lse(r,e.outerRadius,o),f=e.maxRadius||Math.sqrt(i*i+l*l)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:m,maxRadius:f}},Mse=(e,t)=>{var r=ms(t-e),a=Math.min(Math.abs(t-e),360);return r*a};function Bse(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var zse=(e,t)=>{if(v.isValidElement(e))return v.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Bt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return v.createElement(yC,ui({},t,{type:"linear",className:r}))},Use=(e,t,r)=>{if(v.isValidElement(e))return v.cloneElement(e,t);var a=r;if(typeof e=="function"&&(a=e(t),v.isValidElement(a)))return a;var n=Bt("recharts-pie-label-text",Bse(e));return v.createElement(qm,ui({},t,{alignmentBaseline:"middle",className:n}),a)};function $se(e){var{sectors:t,props:r,showLabels:a}=e,{label:n,labelLine:i,dataKey:l}=r;if(!a||!n||!t)return null;var o=gi(r),c=as(n,!1),u=as(i,!1),d=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,m=t.map((f,x)=>{var p=(f.startAngle+f.endAngle)/2,h=Jr(f.cx,f.cy,f.outerRadius+d,p),g=Nr(Nr(Nr(Nr({},o),f),{},{stroke:"none"},c),{},{index:x,textAnchor:Rse(h.x,f.cx)},h),b=Nr(Nr(Nr(Nr({},o),f),{},{fill:"none",stroke:f.fill},u),{},{index:x,points:[Jr(f.cx,f.cy,f.outerRadius,p),h],key:"line"});return v.createElement(aa,{key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(x)},i&&zse(i,b),Use(n,g,Pr(f,l)))});return v.createElement(aa,{className:"recharts-pie-labels"},m)}function Wse(e){var{sectors:t,props:r,showLabels:a}=e,{label:n}=r;return typeof n=="object"&&n!=null&&"position"in n?v.createElement(q5,{label:n}):v.createElement($se,{sectors:t,props:r,showLabels:a})}function Hse(e){var{sectors:t,activeShape:r,inactiveShape:a,allOtherPieProps:n}=e,i=tt(il),{onMouseEnter:l,onClick:o,onMouseLeave:c}=n,u=k1(n,Tse),d=A1(l,n.dataKey),m=C1(c),f=_1(o,n.dataKey);return t==null||t.length===0?null:v.createElement(v.Fragment,null,t.map((x,p)=>{if(x?.startAngle===0&&x?.endAngle===0&&t.length!==1)return null;var h=r&&String(p)===i,g=i?a:null,b=h?r:g,j=Nr(Nr({},x),{},{stroke:x.stroke,tabIndex:-1,[fC]:p,[hC]:n.dataKey});return v.createElement(aa,ui({tabIndex:-1,className:"recharts-pie-sector"},Uc(u,x,p),{onMouseEnter:d(x,p),onMouseLeave:m(x,p),onClick:f(x,p),key:"sector-".concat(x?.startAngle,"-").concat(x?.endAngle,"-").concat(x.midAngle,"-").concat(p)}),v.createElement(Z5,ui({option:b,isActive:h,shapeType:"sector"},j)))}))}function Vse(e){var t,{pieSettings:r,displayedData:a,cells:n,offset:i}=e,{cornerRadius:l,startAngle:o,endAngle:c,dataKey:u,nameKey:d,tooltipType:m}=r,f=Math.abs(r.minAngle),x=Mse(o,c),p=Math.abs(x),h=a.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=a.filter(S=>Pr(S,u,0)!==0).length,b=(p>=360?g:g-1)*h,j=p-g*f-b,y=a.reduce((S,E)=>{var _=Pr(E,u,0);return S+(at(_)?_:0)},0),w;if(y>0){var N;w=a.map((S,E)=>{var _=Pr(S,u,0),T=Pr(S,d,E),C=Fse(r,i,S),A=(at(_)?_:0)/y,D,P=Nr(Nr({},S),n&&n[E]&&n[E].props);E?D=N.endAngle+ms(x)*h*(_!==0?1:0):D=o;var R=D+ms(x)*((_!==0?f:0)+A*j),M=(D+R)/2,X=(C.innerRadius+C.outerRadius)/2,ie=[{name:T,value:_,payload:P,dataKey:u,type:m}],ae=Jr(C.cx,C.cy,X,M);return N=Nr(Nr(Nr(Nr({},r.presentationProps),{},{percent:A,cornerRadius:l,name:T,tooltipPayload:ie,midAngle:M,middleRadius:X,tooltipPosition:ae},P),C),{},{value:_,startAngle:D,endAngle:R,payload:P,paddingAngle:ms(x)*h}),N})}return w}function Gse(e){var{showLabels:t,sectors:r,children:a}=e,n=v.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return v.createElement(_re,{value:t?n:void 0},a)}function qse(e){var{props:t,previousSectorsRef:r}=e,{sectors:a,isAnimationActive:n,animationBegin:i,animationDuration:l,animationEasing:o,activeShape:c,inactiveShape:u,onAnimationStart:d,onAnimationEnd:m}=t,f=Dm(t,"recharts-pie-"),x=r.current,[p,h]=v.useState(!1),g=v.useCallback(()=>{typeof m=="function"&&m(),h(!1)},[m]),b=v.useCallback(()=>{typeof d=="function"&&d(),h(!0)},[d]);return v.createElement(Gse,{showLabels:!p,sectors:a},v.createElement(km,{animationId:f,begin:i,duration:l,isActive:n,easing:o,onAnimationStart:b,onAnimationEnd:g,key:f},j=>{var y=[],w=a&&a[0],N=w?.startAngle;return a?.forEach((S,E)=>{var _=x&&x[E],T=E>0?rl(S,"paddingAngle",0):0;if(_){var C=Ss(_.endAngle-_.startAngle,S.endAngle-S.startAngle,j),A=Nr(Nr({},S),{},{startAngle:N+T,endAngle:N+C+T});y.push(A),N=A.endAngle}else{var{endAngle:D,startAngle:P}=S,R=Ss(0,D-P,j),M=Nr(Nr({},S),{},{startAngle:N+T,endAngle:N+R+T});y.push(M),N=M.endAngle}}),r.current=y,v.createElement(aa,null,v.createElement(Hse,{sectors:y,activeShape:c,inactiveShape:u,allOtherPieProps:t}))}),v.createElement(Wse,{showLabels:!p,sectors:a,props:t}),t.children)}var Kse={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!xl.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function Yse(e){var{id:t}=e,r=k1(e,Ase),{hide:a,className:n,rootTabIndex:i}=e,l=v.useMemo(()=>Gg(e.children,rd),[e.children]),o=tt(d=>Gre(d,t,l)),c=v.useRef(null),u=Bt("recharts-pie",n);return a||o==null?(c.current=null,v.createElement(aa,{tabIndex:i,className:u})):v.createElement(v.Fragment,null,v.createElement(Q5,{fn:Pse,args:Nr(Nr({},e),{},{sectors:o})}),v.createElement(aa,{tabIndex:i,className:u},v.createElement(qse,{props:Nr(Nr({},r),{},{sectors:o}),previousSectorsRef:c})))}function s4(e){var t=Xs(e,Kse),{id:r}=t,a=k1(t,Cse),n=gi(a);return v.createElement(t4,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(Ese,{type:"pie",id:i,data:a.data,dataKey:a.dataKey,hide:a.hide,angleAxisId:0,radiusAxisId:0,name:a.name,nameKey:a.nameKey,tooltipType:a.tooltipType,legendType:a.legendType,fill:a.fill,cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,paddingAngle:a.paddingAngle,minAngle:a.minAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius,cornerRadius:a.cornerRadius,presentationProps:n,maxRadius:t.maxRadius}),v.createElement(Ose,ui({},a,{id:i})),v.createElement(Yse,ui({},a,{id:i}))))}s4.displayName="Pie";function a2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function n2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a2(Object(r),!0).forEach(function(a){Xse(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Xse(e,t,r){return(t=Jse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jse(e){var t=Zse(e,"string");return typeof t=="symbol"?t:t+""}function Zse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qse={xAxis:{},yAxis:{},zAxis:{}},a4=va({name:"cartesianAxis",initialState:Qse,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:a}=t.payload;e.yAxis[r]&&(e.yAxis[r]=n2(n2({},e.yAxis[r]),{},{width:a}))}}}),{addXAxis:eae,removeXAxis:tae,addYAxis:rae,removeYAxis:sae,addZAxis:Mde,removeZAxis:Bde,updateYAxisWidth:aae}=a4.actions,nae=a4.reducer,iae=be([ns],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),lae=be([iae,zn,Un],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),n4=()=>tt(lae),oae="Invariant failed";function cae(e,t){throw new Error(oae)}var dae=["x","y"];function Px(){return Px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Px.apply(null,arguments)}function i2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i2(Object(r),!0).forEach(function(a){uae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function uae(e,t,r){return(t=mae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mae(e){var t=fae(e,"string");return typeof t=="symbol"?t:t+""}function fae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hae(e,t){if(e==null)return{};var r,a,n=pae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function xae(e,t){var{x:r,y:a}=e,n=hae(e,dae),i="".concat(r),l=parseInt(i,10),o="".concat(a),c=parseInt(o,10),u="".concat(t.height||n.height),d=parseInt(u,10),m="".concat(t.width||n.width),f=parseInt(m,10);return ko(ko(ko(ko(ko({},t),n),l?{x:l}:{}),c?{y:c}:{}),{},{height:d,width:f,name:t.name,radius:t.radius})}function D1(e){return v.createElement(Z5,Px({shapeType:"rectangle",propTransformer:xae,activeClassName:"recharts-active-bar"},e))}var gae=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,n)=>{if(at(t))return t;var i=at(a)||ps(a);return i?t(a,n):(i||cae(),r)}},vae={},i4=va({name:"errorBars",initialState:vae,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]||(e[r]=[]),e[r].push(a)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:a,next:n}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===a.dataKey&&i.direction===a.direction?n:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]&&(e[r]=e[r].filter(n=>n.dataKey!==a.dataKey||n.direction!==a.direction))}}}),{addErrorBar:zde,replaceErrorBar:Ude,removeErrorBar:$de}=i4.actions,bae=i4.reducer,yae=["children"];function jae(e,t){if(e==null)return{};var r,a,n=wae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function wae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Nae={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Sae=v.createContext(Nae);function Eae(e){var{children:t}=e,r=jae(e,yae);return v.createElement(Sae.Provider,{value:r},t)}function l4(e,t){var r,a,n=tt(u=>Wn(u,e)),i=tt(u=>Hn(u,t)),l=(r=n?.allowDataOverflow)!==null&&r!==void 0?r:na.allowDataOverflow,o=(a=i?.allowDataOverflow)!==null&&a!==void 0?a:ia.allowDataOverflow,c=l||o;return{needClip:c,needClipX:l,needClipY:o}}function Tae(e){var{xAxisId:t,yAxisId:r,clipPathId:a}=e,n=n4(),{needClipX:i,needClipY:l,needClip:o}=l4(t,r);if(!o)return null;var{x:c,y:u,width:d,height:m}=n;return v.createElement("clipPath",{id:"clipPath-".concat(a)},v.createElement("rect",{x:i?c:c-d/2,y:l?u:u-m/2,width:i?d:d*2,height:l?m:m*2}))}var Aae=["onMouseEnter","onMouseLeave","onClick"],Cae=["value","background","tooltipPosition"],_ae=["id"],kae=["onMouseEnter","onClick","onMouseLeave"];function mi(){return mi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},mi.apply(null,arguments)}function l2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Gs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l2(Object(r),!0).forEach(function(a){Dae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Dae(e,t,r){return(t=Iae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iae(e){var t=Oae(e,"string");return typeof t=="symbol"?t:t+""}function Oae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wu(e,t){if(e==null)return{};var r,a,n=Pae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Pae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Rae=e=>{var{dataKey:t,name:r,fill:a,legendType:n,hide:i}=e;return[{inactive:i,dataKey:t,type:n,color:a,value:Em(r,t),payload:e}]};function Lae(e){var{dataKey:t,stroke:r,strokeWidth:a,fill:n,name:i,hide:l,unit:o}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:n,dataKey:t,nameKey:void 0,name:Em(i,t),hide:l,type:e.tooltipType,color:e.fill,unit:o}}}function Fae(e){var t=tt(il),{data:r,dataKey:a,background:n,allOtherBarProps:i}=e,{onMouseEnter:l,onMouseLeave:o,onClick:c}=i,u=Wu(i,Aae),d=A1(l,a),m=C1(o),f=_1(c,a);if(!n||r==null)return null;var x=as(n,!1);return v.createElement(v.Fragment,null,r.map((p,h)=>{var{value:g,background:b,tooltipPosition:j}=p,y=Wu(p,Cae);if(!b)return null;var w=d(p,h),N=m(p,h),S=f(p,h),E=Gs(Gs(Gs(Gs(Gs({option:n,isActive:String(h)===t},y),{},{fill:"#eee"},b),x),Uc(u,p,h)),{},{onMouseEnter:w,onMouseLeave:N,onClick:S,dataKey:a,index:h,className:"recharts-bar-background-rectangle"});return v.createElement(D1,mi({key:"background-bar-".concat(E.index)},E))}))}function Mae(e){var{showLabels:t,children:r,rects:a}=e,n=a?.map(i=>{var l={x:i.x,y:i.y,width:i.width,height:i.height};return Gs(Gs({},l),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:l,fill:i.fill})});return v.createElement(Cre,{value:t?n:void 0},r)}function Bae(e){var{shape:t,activeBar:r,baseProps:a,entry:n,index:i,dataKey:l}=e,o=tt(il),c=tt(T5),u=r&&String(i)===o&&(c==null||l===c),d=u?r:t;return v.createElement(D1,mi({},a,n,{isActive:u,option:d,index:i,dataKey:l}))}function zae(e){var{shape:t,baseProps:r,entry:a,index:n,dataKey:i}=e;return v.createElement(D1,mi({},r,a,{isActive:!1,option:t,index:n,dataKey:i}))}function Uae(e){var{data:t,props:r}=e,a=gi(r),{id:n}=a,i=Wu(a,_ae),{shape:l,dataKey:o,activeBar:c}=r,{onMouseEnter:u,onClick:d,onMouseLeave:m}=r,f=Wu(r,kae),x=A1(u,o),p=C1(m),h=_1(d,o);return t?v.createElement(v.Fragment,null,t.map((g,b)=>v.createElement(aa,mi({className:"recharts-bar-rectangle"},Uc(f,g,b),{onMouseEnter:x(g,b),onMouseLeave:p(g,b),onClick:h(g,b),key:"rectangle-".concat(g?.x,"-").concat(g?.y,"-").concat(g?.value,"-").concat(b)}),c?v.createElement(Bae,{shape:l,activeBar:c,baseProps:i,entry:g,index:b,dataKey:o}):v.createElement(zae,{shape:l,baseProps:i,entry:g,index:b,dataKey:o})))):null}function $ae(e){var{props:t,previousRectanglesRef:r}=e,{data:a,layout:n,isAnimationActive:i,animationBegin:l,animationDuration:o,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,m=r.current,f=Dm(t,"recharts-bar-"),[x,p]=v.useState(!1),h=!x,g=v.useCallback(()=>{typeof u=="function"&&u(),p(!1)},[u]),b=v.useCallback(()=>{typeof d=="function"&&d(),p(!0)},[d]);return v.createElement(Mae,{showLabels:h,rects:a},v.createElement(km,{animationId:f,begin:l,duration:o,isActive:i,easing:c,onAnimationEnd:g,onAnimationStart:b,key:f},j=>{var y=j===1?a:a?.map((w,N)=>{var S=m&&m[N];if(S)return Gs(Gs({},w),{},{x:Ss(S.x,w.x,j),y:Ss(S.y,w.y,j),width:Ss(S.width,w.width,j),height:Ss(S.height,w.height,j)});if(n==="horizontal"){var E=Ss(0,w.height,j);return Gs(Gs({},w),{},{y:w.y+w.height-E,height:E})}var _=Ss(0,w.width,j);return Gs(Gs({},w),{},{width:_})});return j>0&&(r.current=y??null),y==null?null:v.createElement(aa,null,v.createElement(Uae,{props:t,data:y}))}),v.createElement(q5,{label:t.label}),t.children)}function Wae(e){var t=v.useRef(null);return v.createElement($ae,{previousRectanglesRef:t,props:e})}var o4=0,Hae=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Pr(e,t)}};class Vae extends v.PureComponent{render(){var{hide:t,data:r,dataKey:a,className:n,xAxisId:i,yAxisId:l,needClip:o,background:c,id:u}=this.props;if(t||r==null)return null;var d=Bt("recharts-bar",n),m=u;return v.createElement(aa,{className:d,id:u},o&&v.createElement("defs",null,v.createElement(Tae,{clipPathId:m,xAxisId:i,yAxisId:l})),v.createElement(aa,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(m,")"):void 0},v.createElement(Fae,{data:r,dataKey:a,background:c,allOtherBarProps:this.props}),v.createElement(Wae,this.props)))}}var Gae={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!xl.isSsr,legendType:"rect",minPointSize:o4,xAxisId:0,yAxisId:0};function qae(e){var{xAxisId:t,yAxisId:r,hide:a,legendType:n,minPointSize:i,activeBar:l,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:m}=l4(t,r),f=fv(),x=$a(),p=Gg(e.children,rd),h=tt(j=>jne(j,t,r,x,e.id,p));if(f!=="vertical"&&f!=="horizontal")return null;var g,b=h?.[0];return b==null||b.height==null||b.width==null?g=0:g=f==="vertical"?b.height/2:b.width/2,v.createElement(Eae,{xAxisId:t,yAxisId:r,data:h,dataPointFormatter:Hae,errorBarOffset:g},v.createElement(Vae,mi({},e,{layout:f,needClip:m,data:h,xAxisId:t,yAxisId:r,hide:a,legendType:n,minPointSize:i,activeBar:l,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function Kae(e){var{layout:t,barSettings:{dataKey:r,minPointSize:a},pos:n,bandSize:i,xAxis:l,yAxis:o,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:m,offset:f,cells:x,parentViewBox:p}=e,h=t==="horizontal"?o:l,g=d?h.scale.domain():null,b=oK({numericAxis:h});return m.map((j,y)=>{var w,N,S,E,_,T;d?w=rK(d[y],g):(w=Pr(j,r),Array.isArray(w)||(w=[b,w]));var C=gae(a,o4)(w[1],y);if(t==="horizontal"){var A,[D,P]=[o.scale(w[0]),o.scale(w[1])];N=Kj({axis:l,ticks:c,bandSize:i,offset:n.offset,entry:j,index:y}),S=(A=P??D)!==null&&A!==void 0?A:void 0,E=n.size;var R=D-P;if(_=pa(R)?0:R,T={x:N,y:f.top,width:E,height:f.height},Math.abs(C)>0&&Math.abs(_)<Math.abs(C)){var M=ms(_||C)*(Math.abs(C)-Math.abs(_));S-=M,_+=M}}else{var[X,ie]=[l.scale(w[0]),l.scale(w[1])];if(N=X,S=Kj({axis:o,ticks:u,bandSize:i,offset:n.offset,entry:j,index:y}),E=ie-X,_=n.size,T={x:f.left,y:S,width:f.width,height:_},Math.abs(C)>0&&Math.abs(E)<Math.abs(C)){var ae=ms(E||C)*(Math.abs(C)-Math.abs(E));E+=ae}}if(N==null||S==null||E==null||_==null)return null;var V=Gs(Gs({},j),{},{x:N,y:S,width:E,height:_,value:d?w:w[1],payload:j,background:T,tooltipPosition:{x:N+E/2,y:S+_/2},parentViewBox:p},x&&x[y]&&x[y].props);return V}).filter(Boolean)}function Yae(e){var t=Xs(e,Gae),r=$a();return v.createElement(t4,{id:t.id,type:"bar"},a=>v.createElement(v.Fragment,null,v.createElement(use,{legendPayload:Rae(t)}),v.createElement(Q5,{fn:Lae,args:t}),v.createElement(Sse,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:lK(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),v.createElement(qae,mi({},t,{id:a}))))}var Fo=v.memo(Yae);Fo.displayName="Bar";function o2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Fd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o2(Object(r),!0).forEach(function(a){Xae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Xae(e,t,r){return(t=Jae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jae(e){var t=Zae(e,"string");return typeof t=="symbol"?t:t+""}function Zae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qae=(e,t)=>t,ene=(e,t,r)=>r,tne=(e,t,r,a)=>a,rne=(e,t,r,a,n)=>n,sd=be([Jv,rne],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),sne=be([sd],e=>e?.maxBarSize),ane=(e,t,r,a,n,i)=>i,c2=(e,t,r)=>{var a=r??e;if(!ps(a))return Ms(a,t,0)},nne=be([tr,Jv,Qae,ene,tne],(e,t,r,a,n)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===a).filter(i=>i.isPanorama===n).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),ine=(e,t,r,a)=>{var n=tr(e);return n==="horizontal"?Cx(e,"yAxis",r,a):Cx(e,"xAxis",t,a)},lne=(e,t,r)=>{var a=tr(e);return a==="horizontal"?uN(e,"xAxis",t):uN(e,"yAxis",r)},one=(e,t,r)=>{var a={},n=e.filter(Um),i=e.filter(u=>u.stackId==null),l=n.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),a),o=Object.entries(l).map(u=>{var[d,m]=u,f=m.map(p=>p.dataKey),x=c2(t,r,m[0].barSize);return{stackId:d,dataKeys:f,barSize:x}}),c=i.map(u=>{var d=[u.dataKey].filter(f=>f!=null),m=c2(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:m}});return[...o,...c]},cne=be([nne,$Z,lne],one),dne=(e,t,r,a,n)=>{var i,l,o=sd(e,t,r,a,n);if(o!=null){var c=tr(e),u=S_(e),{maxBarSize:d}=o,m=ps(d)?u:d,f,x;return c==="horizontal"?(f=Jl(e,"xAxis",t,a),x=Xl(e,"xAxis",t,a)):(f=Jl(e,"yAxis",r,a),x=Xl(e,"yAxis",r,a)),(i=(l=ov(f,x,!0))!==null&&l!==void 0?l:m)!==null&&i!==void 0?i:0}},c4=(e,t,r,a)=>{var n=tr(e),i,l;return n==="horizontal"?(i=Jl(e,"xAxis",t,a),l=Xl(e,"xAxis",t,a)):(i=Jl(e,"yAxis",r,a),l=Xl(e,"yAxis",r,a)),ov(i,l)};function une(e,t,r,a,n){var i=a.length;if(!(i<1)){var l=Ms(e,r,0,!0),o,c=[];if(ga(a[0].barSize)){var u=!1,d=r/i,m=a.reduce((b,j)=>b+(j.barSize||0),0);m+=(i-1)*l,m>=r&&(m-=(i-1)*l,l=0),m>=r&&d>0&&(u=!0,d*=.9,m=i*d);var f=(r-m)/2>>0,x={offset:f-l,size:0};o=a.reduce((b,j)=>{var y,w={stackId:j.stackId,dataKeys:j.dataKeys,position:{offset:x.offset+x.size+l,size:u?d:(y=j.barSize)!==null&&y!==void 0?y:0}},N=[...b,w];return x=N[N.length-1].position,N},c)}else{var p=Ms(t,r,0,!0);r-2*p-(i-1)*l<=0&&(l=0);var h=(r-2*p-(i-1)*l)/i;h>1&&(h>>=0);var g=ga(n)?Math.min(h,n):h;o=a.reduce((b,j,y)=>[...b,{stackId:j.stackId,dataKeys:j.dataKeys,position:{offset:p+(h+l)*y+(h-g)/2,size:g}}],c)}return o}}var mne=(e,t,r,a,n,i,l)=>{var o=ps(l)?t:l,c=une(r,a,n!==i?n:i,e,o);return n!==i&&c!=null&&(c=c.map(u=>Fd(Fd({},u),{},{position:Fd(Fd({},u.position),{},{offset:u.position.offset-n/2})}))),c},fne=be([cne,S_,UZ,E_,dne,c4,sne],mne),hne=(e,t,r,a)=>Jl(e,"xAxis",t,a),pne=(e,t,r,a)=>Jl(e,"yAxis",r,a),xne=(e,t,r,a)=>Xl(e,"xAxis",t,a),gne=(e,t,r,a)=>Xl(e,"yAxis",r,a),vne=be([fne,sd],(e,t)=>{if(!(e==null||t==null)){var r=e.find(a=>a.stackId===t.stackId&&t.dataKey!=null&&a.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),bne=(e,t)=>{var r=Kv(t);if(!(!e||r==null||t==null)){var{stackId:a}=t;if(a!=null){var n=e[a];if(n){var{stackedData:i}=n;if(i)return i.find(l=>l.key===r)}}}},yne=be([ine,sd],bne),jne=be([ns,cv,hne,pne,xne,gne,vne,tr,Bv,c4,yne,sd,ane],(e,t,r,a,n,i,l,o,c,u,d,m,f)=>{var{chartData:x,dataStartIndex:p,dataEndIndex:h}=c;if(!(m==null||l==null||t==null||o!=="horizontal"&&o!=="vertical"||r==null||a==null||n==null||i==null||u==null)){var{data:g}=m,b;if(g!=null&&g.length>0?b=g:b=x?.slice(p,h+1),b!=null)return Kae({layout:o,barSettings:m,pos:l,parentViewBox:t,bandSize:u,xAxis:r,yAxis:a,xAxisTicks:n,yAxisTicks:i,stackedData:d,displayedData:b,offset:e,cells:f})}}),d4=e=>{var{chartData:t}=e,r=Rr(),a=$a();return v.useEffect(()=>a?()=>{}:(r(jN(t)),()=>{r(jN(void 0))}),[t,r,a]),null},d2={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},u4=va({name:"brush",initialState:d2,reducers:{setBrushSettings(e,t){return t.payload==null?d2:t.payload}}}),{setBrushSettings:Wde}=u4.actions,wne=u4.reducer;function Nne(e,t,r){return(t=Sne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sne(e){var t=Ene(e,"string");return typeof t=="symbol"?t:t+""}function Ene(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class I1{static create(t){return new I1(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var n=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+n}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+l}return this.scale(t)}}isInRange(t){var r=this.range(),a=r[0],n=r[r.length-1];return a<=n?t>=a&&t<=n:t>=n&&t<=a}}Nne(I1,"EPS",1e-4);function Tne(e){return(e%180+180)%180}var Ane=function(t){var{width:r,height:a}=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Tne(n),l=i*Math.PI/180,o=Math.atan(a/r),c=l>o&&l<Math.PI-o?a/Math.sin(l):r/Math.cos(l);return Math.abs(c)},Cne={dots:[],areas:[],lines:[]},m4=va({name:"referenceElements",initialState:Cne,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=An(e).dots.findIndex(a=>a===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=An(e).areas.findIndex(a=>a===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=An(e).lines.findIndex(a=>a===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Hde,removeDot:Vde,addArea:Gde,removeArea:qde,addLine:Kde,removeLine:Yde}=m4.actions,_ne=m4.reducer,kne=v.createContext(void 0),Dne=e=>{var{children:t}=e,[r]=v.useState("".concat(fc("recharts"),"-clip")),a=n4();if(a==null)return null;var{x:n,y:i,width:l,height:o}=a;return v.createElement(kne.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:n,y:i,height:o,width:l}))),t)};function Zl(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function f4(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var a=[],n=0;n<e.length;n+=t)a.push(e[n]);return a}function Ine(e,t,r){var a={width:e.width+t.width,height:e.height+t.height};return Ane(a,r)}function One(e,t,r){var a=r==="width",{x:n,y:i,width:l,height:o}=e;return t===1?{start:a?n:i,end:a?n+l:i+o}:{start:a?n+l:i+o,end:a?n:i}}function Hu(e,t,r,a,n){if(e*t<e*a||e*t>e*n)return!1;var i=r();return e*(t-e*i/2-a)>=0&&e*(t+e*i/2-n)<=0}function Pne(e,t){return f4(e,t+1)}function Rne(e,t,r,a,n){for(var i=(a||[]).slice(),{start:l,end:o}=t,c=0,u=1,d=l,m=function(){var p=a?.[c];if(p===void 0)return{v:f4(a,u)};var h=c,g,b=()=>(g===void 0&&(g=r(p,h)),g),j=p.coordinate,y=c===0||Hu(e,j,b,d,o);y||(c=0,d=l,u+=1),y&&(d=j+e*(b()/2+n),c+=u)},f;u<=i.length;)if(f=m(),f)return f.v;return[]}function u2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function _s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u2(Object(r),!0).forEach(function(a){Lne(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Lne(e,t,r){return(t=Fne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fne(e){var t=Mne(e,"string");return typeof t=="symbol"?t:t+""}function Mne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bne(e,t,r,a,n){for(var i=(a||[]).slice(),l=i.length,{start:o}=t,{end:c}=t,u=function(f){var x=i[f],p,h=()=>(p===void 0&&(p=r(x,f)),p);if(f===l-1){var g=e*(x.coordinate+e*h()/2-c);i[f]=x=_s(_s({},x),{},{tickCoord:g>0?x.coordinate-g*e:x.coordinate})}else i[f]=x=_s(_s({},x),{},{tickCoord:x.coordinate});var b=Hu(e,x.tickCoord,h,o,c);b&&(c=x.tickCoord-e*(h()/2+n),i[f]=_s(_s({},x),{},{isShow:!0}))},d=l-1;d>=0;d--)u(d);return i}function zne(e,t,r,a,n,i){var l=(a||[]).slice(),o=l.length,{start:c,end:u}=t;if(i){var d=a[o-1],m=r(d,o-1),f=e*(d.coordinate+e*m/2-u);l[o-1]=d=_s(_s({},d),{},{tickCoord:f>0?d.coordinate-f*e:d.coordinate});var x=Hu(e,d.tickCoord,()=>m,c,u);x&&(u=d.tickCoord-e*(m/2+n),l[o-1]=_s(_s({},d),{},{isShow:!0}))}for(var p=i?o-1:o,h=function(j){var y=l[j],w,N=()=>(w===void 0&&(w=r(y,j)),w);if(j===0){var S=e*(y.coordinate-e*N()/2-c);l[j]=y=_s(_s({},y),{},{tickCoord:S<0?y.coordinate-S*e:y.coordinate})}else l[j]=y=_s(_s({},y),{},{tickCoord:y.coordinate});var E=Hu(e,y.tickCoord,N,c,u);E&&(c=y.tickCoord+e*(N()/2+n),l[j]=_s(_s({},y),{},{isShow:!0}))},g=0;g<p;g++)h(g);return l}function O1(e,t,r){var{tick:a,ticks:n,viewBox:i,minTickGap:l,orientation:o,interval:c,tickFormatter:u,unit:d,angle:m}=e;if(!n||!n.length||!a)return[];if(at(c)||xl.isSsr){var f;return(f=Pne(n,at(c)?c:0))!==null&&f!==void 0?f:[]}var x=[],p=o==="top"||o==="bottom"?"width":"height",h=d&&p==="width"?qo(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(y,w)=>{var N=typeof u=="function"?u(y.value,w):y.value;return p==="width"?Ine(qo(N,{fontSize:t,letterSpacing:r}),h,m):qo(N,{fontSize:t,letterSpacing:r})[p]},b=n.length>=2?ms(n[1].coordinate-n[0].coordinate):1,j=One(i,b,p);return c==="equidistantPreserveStart"?Rne(b,j,g,n,l):(c==="preserveStart"||c==="preserveStartEnd"?x=zne(b,j,g,n,l,c==="preserveStartEnd"):x=Bne(b,j,g,n,l),x.filter(y=>y.isShow))}var Une=e=>{var{ticks:t,label:r,labelGapWithTick:a=5,tickSize:n=0,tickMargin:i=0}=e,l=0;if(t){t.forEach(d=>{if(d){var m=d.getBoundingClientRect();m.width>l&&(l=m.width)}});var o=r?r.getBoundingClientRect().width:0,c=n+i,u=l+c+o+(r?a:0);return Math.round(u)}return 0},$ne=["axisLine","width","height","className","hide","ticks"],Wne=["viewBox"],Hne=["viewBox"];function Rx(e,t){if(e==null)return{};var r,a,n=Vne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Vne(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function ll(){return ll=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ll.apply(null,arguments)}function m2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Qr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m2(Object(r),!0).forEach(function(a){Gne(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Gne(e,t,r){return(t=qne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qne(e){var t=Kne(e,"string");return typeof t=="symbol"?t:t+""}function Kne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P1={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function Yne(e){var{x:t,y:r,width:a,height:n,orientation:i,mirror:l,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=Qr(Qr(Qr({},c),as(o,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!l||i==="bottom"&&l);u=Qr(Qr({},u),{},{x1:t,y1:r+d*n,x2:t+a,y2:r+d*n})}else{var m=+(i==="left"&&!l||i==="right"&&l);u=Qr(Qr({},u),{},{x1:t+m*a,y1:r,x2:t+m*a,y2:r+n})}return v.createElement("line",ll({},u,{className:Bt("recharts-cartesian-axis-line",rl(o,"className"))}))}function Xne(e,t,r,a,n,i,l,o,c){var u,d,m,f,x,p,h=o?-1:1,g=e.tickSize||l,b=at(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,f=r+ +!o*n,m=f-h*g,p=m-h*c,x=b;break;case"left":m=f=e.coordinate,d=t+ +!o*a,u=d-h*g,x=u-h*c,p=b;break;case"right":m=f=e.coordinate,d=t+ +o*a,u=d+h*g,x=u+h*c,p=b;break;default:u=d=e.coordinate,f=r+ +o*n,m=f+h*g,p=m+h*c,x=b;break}return{line:{x1:u,y1:m,x2:d,y2:f},tick:{x,y:p}}}function Jne(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function Zne(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function Qne(e){var{option:t,tickProps:r,value:a}=e,n,i=Bt(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))n=v.cloneElement(t,Qr(Qr({},r),{},{className:i}));else if(typeof t=="function")n=t(Qr(Qr({},r),{},{className:i}));else{var l="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(l=Bt(l,t?.className)),n=v.createElement(qm,ll({},r,{className:l}),a)}return n}function eie(e){var{ticks:t=[],tick:r,tickLine:a,stroke:n,tickFormatter:i,unit:l,padding:o,tickTextProps:c,orientation:u,mirror:d,x:m,y:f,width:x,height:p,tickSize:h,tickMargin:g,fontSize:b,letterSpacing:j,getTicksConfig:y,events:w}=e,N=O1(Qr(Qr({},y),{},{ticks:t}),b,j),S=Jne(u,d),E=Zne(u,d),_=gi(y),T=as(r,!1),C=Qr(Qr({},_),{},{fill:"none"},as(a,!1)),A=N.map((D,P)=>{var{line:R,tick:M}=Xne(D,m,f,x,p,u,h,d,g),X=Qr(Qr(Qr(Qr({textAnchor:S,verticalAnchor:E},_),{},{stroke:"none",fill:n},T),M),{},{index:P,payload:D,visibleTicksCount:N.length,tickFormatter:i,padding:o},c);return v.createElement(aa,ll({className:"recharts-cartesian-axis-tick",key:"tick-".concat(D.value,"-").concat(D.coordinate,"-").concat(D.tickCoord)},Uc(w,D,P)),a&&v.createElement("line",ll({},C,R,{className:Bt("recharts-cartesian-axis-tick-line",rl(a,"className"))})),r&&v.createElement(Qne,{option:r,tickProps:X,value:"".concat(typeof i=="function"?i(D.value,P):D.value).concat(l||"")}))});return A.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},A):null}var tie=v.forwardRef((e,t)=>{var{axisLine:r,width:a,height:n,className:i,hide:l,ticks:o}=e,c=Rx(e,$ne),[u,d]=v.useState(""),[m,f]=v.useState(""),x=v.useRef([]);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var h;return Une({ticks:x.current,label:(h=e.labelRef)===null||h===void 0?void 0:h.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var p=v.useCallback(h=>{if(h){var g=h.getElementsByClassName("recharts-cartesian-axis-tick-value");x.current=Array.from(g);var b=g[0];if(b){var j=window.getComputedStyle(b),y=j.fontSize,w=j.letterSpacing;(y!==u||w!==m)&&(d(y),f(w))}}},[u,m]);return l||a!=null&&a<=0||n!=null&&n<=0?null:v.createElement(aa,{className:Bt("recharts-cartesian-axis",i),ref:p},v.createElement(Yne,{x:e.x,y:e.y,width:a,height:n,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:gi(e)}),v.createElement(eie,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:m,getTicksConfig:e,events:c}),v.createElement(lre,{x:e.x,y:e.y,width:e.width,height:e.height},v.createElement(gre,{label:e.label}),e.children))}),rie=v.memo(tie,(e,t)=>{var{viewBox:r}=e,a=Rx(e,Wne),{viewBox:n}=t,i=Rx(t,Hne);return Zl(r,n)&&Zl(a,i)}),R1=v.forwardRef((e,t)=>{var r=Xs(e,P1);return v.createElement(rie,ll({},r,{ref:t}))});R1.displayName="CartesianAxis";var sie=["x1","y1","x2","y2","key"],aie=["offset"],nie=["xAxisId","yAxisId"],iie=["xAxisId","yAxisId"];function f2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Os(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f2(Object(r),!0).forEach(function(a){lie(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function lie(e,t,r){return(t=oie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oie(e){var t=cie(e,"string");return typeof t=="symbol"?t:t+""}function cie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Li(){return Li=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Li.apply(null,arguments)}function Vu(e,t){if(e==null)return{};var r,a,n=die(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function die(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var uie=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:a,y:n,width:i,height:l,ry:o}=e;return v.createElement("rect",{x:a,y:n,ry:o,width:i,height:l,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function h4(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:a,y1:n,x2:i,y2:l,key:o}=t,c=Vu(t,sie),u=gi(c),{offset:d}=u,m=Vu(u,aie);r=v.createElement("line",Li({},m,{x1:a,y1:n,x2:i,y2:l,fill:"none",key:o}))}return r}function mie(e){var{x:t,width:r,horizontal:a=!0,horizontalPoints:n}=e;if(!a||!n||!n.length)return null;var{xAxisId:i,yAxisId:l}=e,o=Vu(e,nie),c=n.map((u,d)=>{var m=Os(Os({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return h4(a,m)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function fie(e){var{y:t,height:r,vertical:a=!0,verticalPoints:n}=e;if(!a||!n||!n.length)return null;var{xAxisId:i,yAxisId:l}=e,o=Vu(e,iie),c=n.map((u,d)=>{var m=Os(Os({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return h4(a,m)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function hie(e){var{horizontalFill:t,fillOpacity:r,x:a,y:n,width:i,height:l,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=o.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==u[0]&&u.unshift(0);var d=u.map((m,f)=>{var x=!u[f+1],p=x?n+l-m:u[f+1]-m;if(p<=0)return null;var h=f%t.length;return v.createElement("rect",{key:"react-".concat(f),y:m,x:a,height:p,width:i,stroke:"none",fill:t[h],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function pie(e){var{vertical:t=!0,verticalFill:r,fillOpacity:a,x:n,y:i,width:l,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==u[0]&&u.unshift(0);var d=u.map((m,f)=>{var x=!u[f+1],p=x?n+l-m:u[f+1]-m;if(p<=0)return null;var h=f%r.length;return v.createElement("rect",{key:"react-".concat(f),x:m,y:i,width:p,height:o,stroke:"none",fill:r[h],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var xie=(e,t)=>{var{xAxis:r,width:a,height:n,offset:i}=e;return dC(O1(Os(Os(Os({},P1),r),{},{ticks:uC(r),viewBox:{x:0,y:0,width:a,height:n}})),i.left,i.left+i.width,t)},gie=(e,t)=>{var{yAxis:r,width:a,height:n,offset:i}=e;return dC(O1(Os(Os(Os({},P1),r),{},{ticks:uC(r),viewBox:{x:0,y:0,width:a,height:n}})),i.top,i.top+i.height,t)},vie={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Gd(e){var t=uv(),r=mv(),a=pC(),n=Os(Os({},Xs(e,vie)),{},{x:at(e.x)?e.x:a.left,y:at(e.y)?e.y:a.top,width:at(e.width)?e.width:a.width,height:at(e.height)?e.height:a.height}),{xAxisId:i,yAxisId:l,x:o,y:c,width:u,height:d,syncWithTicks:m,horizontalValues:f,verticalValues:x}=n,p=$a(),h=tt(T=>mN(T,"xAxis",i,p)),g=tt(T=>mN(T,"yAxis",l,p));if(!at(u)||u<=0||!at(d)||d<=0||!at(o)||o!==+o||!at(c)||c!==+c)return null;var b=n.verticalCoordinatesGenerator||xie,j=n.horizontalCoordinatesGenerator||gie,{horizontalPoints:y,verticalPoints:w}=n;if((!y||!y.length)&&typeof j=="function"){var N=f&&f.length,S=j({yAxis:g?Os(Os({},g),{},{ticks:N?f:g.ticks}):void 0,width:t,height:r,offset:a},N?!0:m);Go(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(y=S)}if((!w||!w.length)&&typeof b=="function"){var E=x&&x.length,_=b({xAxis:h?Os(Os({},h),{},{ticks:E?x:h.ticks}):void 0,width:t,height:r,offset:a},E?!0:m);Go(Array.isArray(_),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof _,"]")),Array.isArray(_)&&(w=_)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(uie,{fill:n.fill,fillOpacity:n.fillOpacity,x:n.x,y:n.y,width:n.width,height:n.height,ry:n.ry}),v.createElement(hie,Li({},n,{horizontalPoints:y})),v.createElement(pie,Li({},n,{verticalPoints:w})),v.createElement(mie,Li({},n,{offset:a,horizontalPoints:y,xAxis:h,yAxis:g})),v.createElement(fie,Li({},n,{offset:a,verticalPoints:w,xAxis:h,yAxis:g})))}Gd.displayName="CartesianGrid";var bie=["dangerouslySetInnerHTML","ticks"],yie=["id"],jie=["domain"],wie=["domain"];function Lx(){return Lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Lx.apply(null,arguments)}function Gu(e,t){if(e==null)return{};var r,a,n=Nie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Nie(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Sie(e){var t=Rr();return v.useEffect(()=>(t(eae(e)),()=>{t(tae(e))}),[e,t]),null}var Eie=e=>{var{xAxisId:t,className:r}=e,a=tt(cv),n=$a(),i="xAxis",l=tt(g=>fo(g,i,t,n)),o=tt(g=>l5(g,i,t,n)),c=tt(g=>s5(g,t)),u=tt(g=>OQ(g,t)),d=tt(g=>P_(g,t));if(c==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:m,ticks:f}=e,x=Gu(e,bie),{id:p}=d,h=Gu(d,yie);return v.createElement(R1,Lx({},x,h,{scale:l,x:u.x,y:u.y,width:c.width,height:c.height,className:Bt("recharts-".concat(i," ").concat(i),r),viewBox:a,ticks:o}))},Tie={allowDataOverflow:na.allowDataOverflow,allowDecimals:na.allowDecimals,allowDuplicatedCategory:na.allowDuplicatedCategory,height:na.height,hide:!1,mirror:na.mirror,orientation:na.orientation,padding:na.padding,reversed:na.reversed,scale:na.scale,tickCount:na.tickCount,type:na.type,xAxisId:0},Aie=e=>{var t,r,a,n,i,l=Xs(e,Tie);return v.createElement(v.Fragment,null,v.createElement(Sie,{interval:(t=l.interval)!==null&&t!==void 0?t:"preserveEnd",id:l.xAxisId,scale:l.scale,type:l.type,padding:l.padding,allowDataOverflow:l.allowDataOverflow,domain:l.domain,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,includeHidden:(r=l.includeHidden)!==null&&r!==void 0?r:!1,reversed:l.reversed,ticks:l.ticks,height:l.height,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(a=l.angle)!==null&&a!==void 0?a:0,minTickGap:(n=l.minTickGap)!==null&&n!==void 0?n:5,tick:(i=l.tick)!==null&&i!==void 0?i:!0,tickFormatter:l.tickFormatter}),v.createElement(Eie,l))},Cie=(e,t)=>{var{domain:r}=e,a=Gu(e,jie),{domain:n}=t,i=Gu(t,wie);return Zl(a,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:Zl({domain:r},{domain:n}):!1},qd=v.memo(Aie,Cie);qd.displayName="XAxis";var _ie=["dangerouslySetInnerHTML","ticks"],kie=["id"],Die=["domain"],Iie=["domain"];function Fx(){return Fx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Fx.apply(null,arguments)}function qu(e,t){if(e==null)return{};var r,a,n=Oie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Oie(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Pie(e){var t=Rr();return v.useEffect(()=>(t(rae(e)),()=>{t(sae(e))}),[e,t]),null}var Rie=e=>{var{yAxisId:t,className:r,width:a,label:n}=e,i=v.useRef(null),l=v.useRef(null),o=tt(cv),c=$a(),u=Rr(),d="yAxis",m=tt(N=>fo(N,d,t,c)),f=tt(N=>a5(N,t)),x=tt(N=>RQ(N,t)),p=tt(N=>l5(N,d,t,c)),h=tt(N=>R_(N,t));if(v.useLayoutEffect(()=>{if(!(a!=="auto"||!f||w1(n)||v.isValidElement(n)||h==null)){var N=i.current;if(N){var S=N.getCalculatedWidth();Math.round(f.width)!==Math.round(S)&&u(aae({id:t,width:S}))}}},[p,f,u,n,t,a,h]),f==null||x==null||h==null)return null;var{dangerouslySetInnerHTML:g,ticks:b}=e,j=qu(e,_ie),{id:y}=h,w=qu(h,kie);return v.createElement(R1,Fx({},j,w,{ref:i,labelRef:l,scale:m,x:x.x,y:x.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:f.width,height:f.height,className:Bt("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:p}))},Lie={allowDataOverflow:ia.allowDataOverflow,allowDecimals:ia.allowDecimals,allowDuplicatedCategory:ia.allowDuplicatedCategory,hide:!1,mirror:ia.mirror,orientation:ia.orientation,padding:ia.padding,reversed:ia.reversed,scale:ia.scale,tickCount:ia.tickCount,type:ia.type,width:ia.width,yAxisId:0},Fie=e=>{var t,r,a,n,i,l=Xs(e,Lie);return v.createElement(v.Fragment,null,v.createElement(Pie,{interval:(t=l.interval)!==null&&t!==void 0?t:"preserveEnd",id:l.yAxisId,scale:l.scale,type:l.type,domain:l.domain,allowDataOverflow:l.allowDataOverflow,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,padding:l.padding,includeHidden:(r=l.includeHidden)!==null&&r!==void 0?r:!1,reversed:l.reversed,ticks:l.ticks,width:l.width,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(a=l.angle)!==null&&a!==void 0?a:0,minTickGap:(n=l.minTickGap)!==null&&n!==void 0?n:5,tick:(i=l.tick)!==null&&i!==void 0?i:!0,tickFormatter:l.tickFormatter}),v.createElement(Rie,l))},Mie=(e,t)=>{var{domain:r}=e,a=qu(e,Die),{domain:n}=t,i=qu(t,Iie);return Zl(a,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:Zl({domain:r},{domain:n}):!1},Kd=v.memo(Fie,Mie);Kd.displayName="YAxis";var Gh={exports:{}},qh={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h2;function Bie(){if(h2)return qh;h2=1;var e=Wx();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,n=e.useRef,i=e.useEffect,l=e.useMemo,o=e.useDebugValue;return qh.useSyncExternalStoreWithSelector=function(c,u,d,m,f){var x=n(null);if(x.current===null){var p={hasValue:!1,value:null};x.current=p}else p=x.current;x=l(function(){function g(N){if(!b){if(b=!0,j=N,N=m(N),f!==void 0&&p.hasValue){var S=p.value;if(f(S,N))return y=S}return y=N}if(S=y,r(j,N))return S;var E=m(N);return f!==void 0&&f(S,E)?(j=N,S):(j=N,y=E)}var b=!1,j,y,w=d===void 0?null:d;return[function(){return g(u())},w===null?void 0:function(){return g(w())}]},[u,d,m,f]);var h=a(c,x[0],x[1]);return i(function(){p.hasValue=!0,p.value=h},[h]),o(h),h},qh}var p2;function zie(){return p2||(p2=1,Gh.exports=Bie()),Gh.exports}zie();function Uie(e){e()}function $ie(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Uie(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0;const n=t={callback:r,next:null,prev:t};return n.prev?n.prev.next=n:e=n,function(){!a||e===null||(a=!1,n.next?n.next.prev=n.prev:t=n.prev,n.prev?n.prev.next=n.next:e=n.next)}}}}var x2={notify(){},get:()=>[]};function Wie(e,t){let r,a=x2,n=0,i=!1;function l(h){d();const g=a.subscribe(h);let b=!1;return()=>{b||(b=!0,g(),m())}}function o(){a.notify()}function c(){p.onStateChange&&p.onStateChange()}function u(){return i}function d(){n++,r||(r=e.subscribe(c),a=$ie())}function m(){n--,r&&n===0&&(r(),r=void 0,a.clear(),a=x2)}function f(){i||(i=!0,d())}function x(){i&&(i=!1,m())}const p={addNestedSub:l,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:f,tryUnsubscribe:x,getListeners:()=>a};return p}var Hie=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Vie=Hie(),Gie=()=>typeof navigator<"u"&&navigator.product==="ReactNative",qie=Gie(),Kie=()=>Vie||qie?v.useLayoutEffect:v.useEffect,Yie=Kie(),Xie=Symbol.for("react-redux-context"),Jie=typeof globalThis<"u"?globalThis:{};function Zie(){if(!v.createContext)return{};const e=Jie[Xie]??=new Map;let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var Qie=Zie();function ele(e){const{children:t,context:r,serverState:a,store:n}=e,i=v.useMemo(()=>{const c=Wie(n);return{store:n,subscription:c,getServerState:a?()=>a:void 0}},[n,a]),l=v.useMemo(()=>n.getState(),[n]);Yie(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),l!==n.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,l]);const o=r||Qie;return v.createElement(o.Provider,{value:i},t)}var tle=ele,rle=(e,t)=>t,L1=be([rle,tr,D_,ls,w5,Vn,Bee,ns],Hee),F1=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/a)}},p4=Ma("mouseClick"),x4=Wc();x4.startListening({actionCreator:p4,effect:(e,t)=>{var r=e.payload,a=L1(t.getState(),F1(r));a?.activeIndex!=null&&t.dispatch(KQ({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var Mx=Ma("mouseMove"),g4=Wc();g4.startListening({actionCreator:Mx,effect:(e,t)=>{var r=e.payload,a=t.getState(),n=f1(a,a.tooltip.settings.shared),i=L1(a,F1(r));n==="axis"&&(i?.activeIndex!=null?t.dispatch(p5({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(h5()))}});var g2={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},v4=va({name:"rootProps",initialState:g2,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:g2.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),sle=v4.reducer,{updateOptions:ale}=v4.actions,b4=va({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:nle}=b4.actions,ile=b4.reducer,y4=Ma("keyDown"),j4=Ma("focus"),M1=Wc();M1.startListening({actionCreator:y4,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:n}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var l=Number(h1(n,po(r))),o=Vn(r);if(i==="Enter"){var c=Bu(r,"axis","hover",String(n.index));t.dispatch(kx({active:!n.active,activeIndex:n.index,activeDataKey:n.dataKey,activeCoordinate:c}));return}var u=BQ(r),d=u==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,f=l+m*d;if(!(o==null||f>=o.length||f<0)){var x=Bu(r,"axis","hover",String(f));t.dispatch(kx({active:!0,activeIndex:f.toString(),activeDataKey:void 0,activeCoordinate:x}))}}}}});M1.startListening({actionCreator:j4,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:n}=r.tooltip;if(!n.active&&n.index==null){var i="0",l=Bu(r,"axis","hover",String(i));t.dispatch(kx({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:l}))}}}});var Ta=Ma("externalEvent"),w4=Wc();w4.startListening({actionCreator:Ta,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),a={activeCoordinate:kee(r),activeDataKey:T5(r),activeIndex:il(r),activeLabel:E5(r),activeTooltipIndex:il(r),isTooltipActive:Dee(r)};e.payload.handler(a,e.payload.reactEvent)}}});var lle=be([ho],e=>e.tooltipItemPayloads),ole=be([lle,ed,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,a)=>{var n=e.find(o=>o.settings.dataKey===a);if(n!=null){var{positions:i}=n;if(i!=null){var l=t(i,r);return l}}}),N4=Ma("touchMove"),S4=Wc();S4.startListening({actionCreator:N4,effect:(e,t)=>{var r=e.payload,a=t.getState(),n=f1(a,a.tooltip.settings.shared);if(n==="axis"){var i=L1(a,F1({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(p5({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(n==="item"){var l,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(fC),d=(l=c.getAttribute(hC))!==null&&l!==void 0?l:void 0,m=ole(t.getState(),u,d);t.dispatch(f5({activeDataKey:d,activeIndex:u,activeCoordinate:m}))}}});var cle=BA({brush:wne,cartesianAxis:nae,chartData:ite,errorBars:bae,graphicalItems:Nse,layout:zq,legend:kK,options:tte,polarAxis:Bre,polarOptions:ile,referenceElements:_ne,rootProps:sle,tooltip:YQ}),dle=function(t){return uq({reducer:cle,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([x4.middleware,g4.middleware,M1.middleware,w4.middleware,S4.middleware]),devTools:xl.devToolsEnabled})};function E4(e){var{preloadedState:t,children:r,reduxStoreName:a}=e,n=$a(),i=v.useRef(null);if(n)return r;i.current==null&&(i.current=dle(t));var l=rv;return v.createElement(tle,{context:l,store:i.current},r)}function T4(e){var{layout:t,width:r,height:a,margin:n}=e,i=Rr(),l=$a();return v.useEffect(()=>{l||(i(Fq(t)),i(Mq({width:r,height:a})),i(Lq(n)))},[i,l,t,r,a,n]),null}function A4(e){var t=Rr();return v.useEffect(()=>{t(ale(e))},[t,e]),null}var ule=["children"];function mle(e,t){if(e==null)return{};var r,a,n=fle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fle(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Ku(){return Ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ku.apply(null,arguments)}var hle={width:"100%",height:"100%"},ple=v.forwardRef((e,t)=>{var r=uv(),a=mv(),n=bC();if(!Vl(r)||!Vl(a))return null;var{children:i,otherAttributes:l,title:o,desc:c}=e,u,d;return typeof l.tabIndex=="number"?u=l.tabIndex:u=n?0:void 0,typeof l.role=="string"?d=l.role:d=n?"application":void 0,v.createElement(qg,Ku({},l,{title:o,desc:c,role:d,tabIndex:u,width:r,height:a,style:hle,ref:t}),i)}),xle=e=>{var{children:t}=e,r=tt(_m);if(!r)return null;var{width:a,height:n,y:i,x:l}=r;return v.createElement(qg,{width:a,height:n,x:l,y:i},t)},v2=v.forwardRef((e,t)=>{var{children:r}=e,a=mle(e,ule),n=$a();return n?v.createElement(xle,null,r):v.createElement(ple,Ku({ref:t},a),r)});function gle(){var e=Rr(),[t,r]=v.useState(null),a=tt(pK);return v.useEffect(()=>{if(t!=null){var n=t.getBoundingClientRect(),i=n.width/t.offsetWidth;ga(i)&&i!==a&&e(Bq(i))}},[t,e,a]),r}function b2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function vle(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b2(Object(r),!0).forEach(function(a){ble(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ble(e,t,r){return(t=yle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yle(e){var t=jle(e,"string");return typeof t=="symbol"?t:t+""}function jle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wle=v.forwardRef((e,t)=>{var{children:r,className:a,height:n,onClick:i,onContextMenu:l,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:m,onMouseUp:f,onTouchEnd:x,onTouchMove:p,onTouchStart:h,style:g,width:b}=e,j=Rr(),[y,w]=v.useState(null),[N,S]=v.useState(null);pte();var E=gle(),_=v.useCallback(F=>{E(F),typeof t=="function"&&t(F),w(F),S(F)},[E,t,w,S]),T=v.useCallback(F=>{j(p4(F)),j(Ta({handler:i,reactEvent:F}))},[j,i]),C=v.useCallback(F=>{j(Mx(F)),j(Ta({handler:u,reactEvent:F}))},[j,u]),A=v.useCallback(F=>{j(h5()),j(Ta({handler:d,reactEvent:F}))},[j,d]),D=v.useCallback(F=>{j(Mx(F)),j(Ta({handler:m,reactEvent:F}))},[j,m]),P=v.useCallback(()=>{j(j4())},[j]),R=v.useCallback(F=>{j(y4(F.key))},[j]),M=v.useCallback(F=>{j(Ta({handler:l,reactEvent:F}))},[j,l]),X=v.useCallback(F=>{j(Ta({handler:o,reactEvent:F}))},[j,o]),ie=v.useCallback(F=>{j(Ta({handler:c,reactEvent:F}))},[j,c]),ae=v.useCallback(F=>{j(Ta({handler:f,reactEvent:F}))},[j,f]),V=v.useCallback(F=>{j(Ta({handler:h,reactEvent:F}))},[j,h]),me=v.useCallback(F=>{j(N4(F)),j(Ta({handler:p,reactEvent:F}))},[j,p]),ue=v.useCallback(F=>{j(Ta({handler:x,reactEvent:F}))},[j,x]);return v.createElement(I5.Provider,{value:y},v.createElement(iA.Provider,{value:N},v.createElement("div",{className:Bt("recharts-wrapper",a),style:vle({position:"relative",cursor:"default",width:b,height:n},g),onClick:T,onContextMenu:M,onDoubleClick:X,onFocus:P,onKeyDown:R,onMouseDown:ie,onMouseEnter:C,onMouseLeave:A,onMouseMove:D,onMouseUp:ae,onTouchEnd:ue,onTouchMove:me,onTouchStart:V,ref:_},r)))}),Nle=["children","className","width","height","style","compact","title","desc"];function Sle(e,t){if(e==null)return{};var r,a,n=Ele(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ele(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var C4=v.forwardRef((e,t)=>{var{children:r,className:a,width:n,height:i,style:l,compact:o,title:c,desc:u}=e,d=Sle(e,Nle),m=gi(d);return o?v.createElement(v2,{otherAttributes:m,title:c,desc:u},r):v.createElement(wle,{className:a,style:l,width:n,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(v2,{otherAttributes:m,title:c,desc:u,ref:t},v.createElement(Dne,null,r)))}),Tle=["width","height"];function Bx(){return Bx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Bx.apply(null,arguments)}function Ale(e,t){if(e==null)return{};var r,a,n=Cle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Cle(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var _le={top:5,right:5,bottom:5,left:5},kle={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:_le,reverseStackOrder:!1,syncMethod:"index"},Dle=v.forwardRef(function(t,r){var a,n=Xs(t.categoricalChartProps,kle),{width:i,height:l}=n,o=Ale(n,Tle);if(!Vl(i)||!Vl(l))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,categoricalChartProps:f}=t,x={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,eventEmitter:void 0};return v.createElement(E4,{preloadedState:{options:x},reduxStoreName:(a=f.id)!==null&&a!==void 0?a:c},v.createElement(d4,{chartData:f.data}),v.createElement(T4,{width:i,height:l,layout:n.layout,margin:n.margin}),v.createElement(A4,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),v.createElement(C4,Bx({},o,{width:i,height:l,ref:r})))}),Ile=["axis","item"],Kh=v.forwardRef((e,t)=>v.createElement(Dle,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ile,tooltipPayloadSearcher:O5,categoricalChartProps:e,ref:t}));function Ole(e){var t=Rr();return v.useEffect(()=>{t(nle(e))},[t,e]),null}var Ple=["width","height","layout"];function zx(){return zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},zx.apply(null,arguments)}function Rle(e,t){if(e==null)return{};var r,a,n=Lle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Lle(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Fle={top:5,right:5,bottom:5,left:5},Mle={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Fle,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},Ble=v.forwardRef(function(t,r){var a,n=Xs(t.categoricalChartProps,Mle),{width:i,height:l,layout:o}=n,c=Rle(n,Ple);if(!Vl(i)||!Vl(l))return null;var{chartName:u,defaultTooltipEventType:d,validateTooltipEventTypes:m,tooltipPayloadSearcher:f}=t,x={chartName:u,defaultTooltipEventType:d,validateTooltipEventTypes:m,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(E4,{preloadedState:{options:x},reduxStoreName:(a=n.id)!==null&&a!==void 0?a:u},v.createElement(d4,{chartData:n.data}),v.createElement(T4,{width:i,height:l,layout:o,margin:n.margin}),v.createElement(A4,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),v.createElement(Ole,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),v.createElement(C4,zx({width:i,height:l},c,{ref:r})))}),zle=["item"],Ule={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},$le=v.forwardRef((e,t)=>{var r=Xs(e,Ule);return v.createElement(Ble,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:zle,tooltipPayloadSearcher:O5,categoricalChartProps:r,ref:t})});const Wle=()=>{const e=Ge(),[t,r]=v.useState(!1),a=[{title:"Create New Assessment Event",description:"Create a new assessment event for trainees",icon:Ra,action:()=>{e(he.ASSESSMENT_EVENTS)},color:"primary"},{title:"View All Departments",description:"View and manage all academic departments",icon:Ls,action:()=>{e("/academic/departments")},color:"primary"}],[n,i]=v.useState({ongoingCourses:[],ongoingEnrollments:[],assessmentStatuses:[],passFailRate:[]});v.useEffect(()=>{(async()=>{r(!0);try{await new Promise(u=>setTimeout(u,1e3)),i({ongoingCourses:[{department:"Operations",count:15},{department:"Maintenance",count:12},{department:"Safety",count:8},{department:"Quality",count:10},{department:"Training",count:6}],ongoingEnrollments:[{department:"Operations",count:245},{department:"Maintenance",count:180},{department:"Safety",count:120},{department:"Quality",count:150},{department:"Training",count:95}],assessmentStatuses:[{status:"NOT_STARTED",count:150},{status:"DRAFT",count:30},{status:"SUBMITTED",count:45},{status:"APPROVED",count:85},{status:"REJECTED",count:12},{status:"CANCELLED",count:8}],passFailRate:[{department:"Operations",pass:120,fail:15},{department:"Maintenance",pass:95,fail:8},{department:"Safety",pass:80,fail:5},{department:"Quality",pass:100,fail:10},{department:"Training",pass:60,fail:3}]})}catch(u){console.error("Error fetching analytics data:",u)}finally{r(!1)}})()},[]);const l=["#1b3c53","#456882","#6a9fb8","#8fb6ce","#b4d3e4","#d9e9f2"],o={NOT_STARTED:"#6c757d",DRAFT:"#ffc107",SUBMITTED:"#0d6efd",APPROVED:"#28a745",REJECTED:"#dc3545",CANCELLED:"#6c757d"};return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsxs(_e,{className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{lg:12,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(H.Body,{children:s.jsx(oe,{children:a.map((c,u)=>s.jsx(U,{md:4,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:c.action,children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(c.icon,{size:24,className:`text-${c.color} me-2`}),s.jsx("h6",{className:"mb-0",children:c.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:c.description}),s.jsx(un,{size:16,className:`text-${c.color} ms-auto`})]})},u))})})]})})}),t?s.jsx(oe,{children:s.jsx(U,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading analytics data..."})]})})}):s.jsxs(s.Fragment,{children:[s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{lg:6,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Bd,{className:"me-2",size:20}),"Ongoing Courses"]})}),s.jsx(H.Body,{children:s.jsx(Ld,{width:"100%",height:300,children:s.jsxs(Kh,{data:n.ongoingCourses,children:[s.jsx(Gd,{strokeDasharray:"3 3"}),s.jsx(qd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),s.jsx(Kd,{}),s.jsx(Rd,{}),s.jsx(Oi,{}),s.jsx(Fo,{dataKey:"count",fill:"#1b3c53",name:"Number of Courses"})]})})})]})}),s.jsx(U,{lg:6,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Bd,{className:"me-2",size:20}),"Ongoing Trainees"]})}),s.jsx(H.Body,{children:s.jsx(Ld,{width:"100%",height:300,children:s.jsxs(Kh,{data:n.ongoingEnrollments,children:[s.jsx(Gd,{strokeDasharray:"3 3"}),s.jsx(qd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),s.jsx(Kd,{}),s.jsx(Rd,{}),s.jsx(Oi,{}),s.jsx(Fo,{dataKey:"count",fill:"#456882",name:"Number of Trainees"})]})})})]})})]}),s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{lg:6,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(sS,{className:"me-2",size:20}),"Assessment Results"]})}),s.jsx(H.Body,{children:s.jsx(Ld,{width:"100%",height:300,children:s.jsxs($le,{children:[s.jsx(s4,{data:n.assessmentStatuses,cx:"50%",cy:"50%",labelLine:!1,label:({name:c,percent:u})=>`${c}: ${(u*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:n.assessmentStatuses.map((c,u)=>s.jsx(rd,{fill:o[c.status]||l[u%l.length]},`cell-${u}`))}),s.jsx(Rd,{}),s.jsx(Oi,{})]})})})]})}),s.jsx(U,{lg:6,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Bd,{className:"me-2",size:20}),"Training Effectiveness (Pass/Fail Rate)"]})}),s.jsx(H.Body,{children:s.jsx(Ld,{width:"100%",height:300,children:s.jsxs(Kh,{data:n.passFailRate,children:[s.jsx(Gd,{strokeDasharray:"3 3"}),s.jsx(qd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),s.jsx(Kd,{}),s.jsx(Rd,{}),s.jsx(Oi,{}),s.jsx(Fo,{dataKey:"pass",stackId:"a",fill:"#28a745",name:"Pass"}),s.jsx(Fo,{dataKey:"fail",stackId:"a",fill:"#dc3545",name:"Fail"})]})})})]})})]})]})]})})},Hle=({courses:e,loading:t,actionsComponent:r,onView:a,onDisable:n})=>{const{sortedData:i,sortConfig:l,handleSort:o}=ur(e);if(t)return s.jsx(zt,{rows:4,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No courses found"}),s.jsx("p",{children:"This department doesn't have any courses yet."})]})});const c=({columnKey:u,children:d,className:m=""})=>{const f=l.key===u,x=f?l.direction:null;return s.jsxs("th",{className:`fw-semibold ${m}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(u),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:d}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:x,size:14,color:"white"})})]}),f&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"department-table-container course-table-responsive",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(c,{columnKey:"name",className:"show-mobile",children:"Course Name"}),s.jsx(c,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(c,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),s.jsx(c,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),s.jsx(c,{columnKey:"venue",className:"show-mobile",children:"Venue"}),s.jsx(c,{columnKey:"note",className:"show-mobile",children:"Note"}),s.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"})]})}),s.jsx("tbody",{children:i.map((u,d)=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary cursor-pointer",onClick:()=>a(u.id),style:{cursor:"pointer"},children:u.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ne,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:u.code})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:u.startDate||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:u.endDate||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ll,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:u.venue||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(vt,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u.note||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ne,{bg:u.status==="ACTIVE"?"success":u.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:u.status||"N/A"})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(r,{course:u,onView:a,onDisable:n})})]},u.id))})]})})},Vle=({course:e,onView:t,onDisable:r})=>{const{hasPermission:a}=to(),n=a(fe.VIEW_COURSE_IN_DETAIL),i=a(fe.ARCHIVE_COURSE),l=a(fe.UPDATE_COURSE),o=i||l,c=()=>{t&&n&&t(e.id)},u=()=>{r&&o&&r(e.id)},d=[];return d.push({label:"View Details",icon:s.jsx(St,{}),onClick:c,disabled:!n}),d.push({type:"divider"}),d.push({label:"Archive Course",icon:s.jsx(fs,{}),className:"text-danger",onClick:u,disabled:!o}),s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:d})},Gle=({show:e,onClose:t,onSave:r,loading:a=!1})=>{const[n,i]=v.useState({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),[l,o]=v.useState({});v.useEffect(()=>{e&&(i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),o({}))},[e]);const c=()=>{i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),o({}),t()},u=f=>{const{name:x,value:p}=f.target;if(i(h=>({...h,[x]:p})),l[x]&&o(h=>({...h,[x]:""})),x==="startDate"&&p){const h=new Date;h.setHours(0,0,0,0),new Date(p+"T00:00:00")<h&&o(b=>({...b,startDate:"Start date cannot be in the past"}))}if(x==="endDate"&&p){const h=new Date;h.setHours(0,0,0,0),new Date(p+"T00:00:00")<h&&o(b=>({...b,endDate:"End date cannot be in the past"}))}},d=()=>{const f={};if(n.name.trim()||(f.name="Course name is required"),n.code.trim()||(f.code="Course code is required"),n.description.trim()||(f.description="Description is required"),(!n.maxNumTrainee||isNaN(n.maxNumTrainee)||parseInt(n.maxNumTrainee)<=0)&&(f.maxNumTrainee="Max trainees must be a positive number"),n.venue.trim()||(f.venue="Venue is required"),(!n.passScore||isNaN(n.passScore)||!Number.isInteger(parseFloat(n.passScore))||parseInt(n.passScore)<0||parseInt(n.passScore)>100)&&(f.passScore="Pass score must be an integer between 0 and 100"),!n.startDate)f.startDate="Start date is required";else{const x=new Date;x.setHours(0,0,0,0),new Date(n.startDate+"T00:00:00")<x&&(f.startDate="Start date cannot be in the past")}if(!n.endDate)f.endDate="End date is required";else{const x=new Date;x.setHours(0,0,0,0),new Date(n.endDate+"T00:00:00")<x&&(f.endDate="End date cannot be in the past")}return n.startDate&&n.endDate&&new Date(n.startDate+"T00:00:00")>=new Date(n.endDate+"T00:00:00")&&(f.endDate="End date must be after start date"),o(f),Object.keys(f).length===0},m=async f=>{if(f.preventDefault(),!!d())try{await r(n),c()}catch{}};return s.jsxs(le,{show:e,onHide:c,size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Xr,{className:"me-2",size:20}),"Add New Course"]}),s.jsx(se,{variant:"link",onClick:c,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(I,{onSubmit:m,children:[s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto",paddingTop:"1.5rem"},children:[s.jsxs(oe,{className:"mb-5",children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Name *"}),s.jsx(I.Control,{type:"text",name:"name",value:n.name,onChange:u,isInvalid:!!l.name,disabled:a}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.name})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Code *"}),s.jsx(I.Control,{type:"text",name:"code",value:n.code,onChange:u,isInvalid:!!l.code,disabled:a}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.code})]})})]}),s.jsxs(oe,{className:"mb-5",children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Max Trainees *"}),s.jsx(I.Control,{type:"number",name:"maxNumTrainee",value:n.maxNumTrainee,onChange:u,isInvalid:!!l.maxNumTrainee,disabled:a,min:"1"}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.maxNumTrainee})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Pass Score *"}),s.jsx(I.Control,{type:"number",name:"passScore",value:n.passScore,onChange:u,isInvalid:!!l.passScore,disabled:a,min:"0",max:"100",step:"1"}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.passScore})]})})]}),s.jsxs(oe,{className:"mb-5",children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Level"}),s.jsxs(I.Select,{name:"level",value:n.level,onChange:u,disabled:a,children:[s.jsx("option",{value:"BEGINNER",children:"Beginner"}),s.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),s.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Venue *"}),s.jsx(I.Control,{type:"text",name:"venue",value:n.venue,onChange:u,isInvalid:!!l.venue,disabled:a}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.venue})]})})]}),s.jsxs(oe,{className:"mb-5",children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Start Date *"}),s.jsx(I.Control,{type:"date",name:"startDate",value:n.startDate,onChange:u,isInvalid:!!l.startDate,disabled:a}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.startDate})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"End Date *"}),s.jsx(I.Control,{type:"date",name:"endDate",value:n.endDate,onChange:u,isInvalid:!!l.endDate,disabled:a}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.endDate})]})})]}),s.jsx(oe,{className:"mb-5",children:s.jsx(U,{children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Description *"}),s.jsx(I.Control,{as:"textarea",rows:3,name:"description",value:n.description,onChange:u,isInvalid:!!l.description,disabled:a}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.description})]})})}),s.jsx(oe,{className:"mb-5",children:s.jsx(U,{children:s.jsxs(I.Group,{className:"mb-0",children:[s.jsx(I.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Note"}),s.jsx(I.Control,{as:"textarea",rows:2,name:"note",value:n.note,onChange:u,disabled:a})]})})})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:c,disabled:a,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary-custom",type:"submit",disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),"Create Course"]})})]})]})]})},qle=({show:e,onClose:t,onArchive:r,course:a,loading:n=!1})=>{const[i,l]=v.useState(""),[o,c]=v.useState(""),d=i==="ARCHIVE",m=()=>{l(""),c(""),t()},f=async()=>{if(!d){c('Please type "ARCHIVE" to confirm');return}try{await r(a?.id),m()}catch(p){c(p.message||"Failed to archive course. Please try again.")}},x=p=>{l(p.target.value),c("")};return s.jsxs(le,{show:e,onHide:m,centered:!0,children:[s.jsxs(le.Header,{className:"bg-warning text-dark border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Er,{className:"me-2",size:20}),"Archive Course"]}),s.jsx(se,{variant:"link",onClick:m,className:"text-dark p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",children:[o&&s.jsx(ke,{variant:"danger",className:"mb-3",children:o}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-2",children:"You are about to archive the following course:"}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx("strong",{children:"Course Code:"})," ",a?.code,s.jsx("br",{}),s.jsx("strong",{children:"Course Name:"})," ",a?.name,s.jsx("br",{}),a?.description&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Description:"})," ",a?.description,s.jsx("br",{})]}),a?.venue&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Venue:"})," ",a?.venue,s.jsx("br",{})]}),a?.startDate&&a?.endDate&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Duration:"})," ",a?.startDate," to ",a?.endDate]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-warning mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-warning mb-3",children:[s.jsx("li",{children:"Archive the course and make it unavailable for new enrollments"}),s.jsx("li",{children:"Remove the course from active course offerings"}),s.jsx("li",{children:"Affect any ongoing training sessions"}),s.jsx("li",{children:"Course data will be archived but can be restored if needed"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",s.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),s.jsx("input",{type:"text",className:`form-control ${i&&!d?"is-invalid":""}`,id:"confirmText",value:i,onChange:x,placeholder:"Type ARCHIVE here",disabled:n}),i&&!d&&s.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:m,disabled:n,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"warning",onClick:f,disabled:n||!d,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"me-2",size:16}),"Archive Course"]})})]})]})},Kle=({show:e,onClose:t,departmentHead:r,department:a})=>{if(!r)return null;const n=[r.firstName,r.middleName,r.lastName].filter(Boolean).join(" ");return s.jsxs(le,{show:e,onHide:t,size:"lg",centered:!0,children:[s.jsx(le.Header,{closeButton:!0,children:s.jsxs(le.Title,{children:[s.jsx(Ft,{className:"me-2"}),"Department Head Details"]})}),s.jsx(le.Body,{children:s.jsxs(oe,{className:"g-3",children:[s.jsx(U,{md:4,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3",style:{width:"80px",height:"80px"},children:s.jsx(Ft,{size:40,className:"text-white"})}),s.jsx("h5",{className:"mb-1",children:n}),s.jsx(Ne,{bg:"primary",className:"mb-2",children:r.role?.name||"Department Head"}),s.jsx("p",{className:"text-muted small mb-0",children:a?.name})]})}),s.jsx(U,{md:8,children:s.jsx(oe,{className:"g-4",children:s.jsx(U,{md:12,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Gi,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Email"}),s.jsx("div",{className:"fw-semibold",children:r.email||"N/A"})]})]})})})})]})}),s.jsx(le.Footer,{children:s.jsx(se,{variant:"secondary",onClick:t,children:"Close"})})]})},Yle=({courseId:e})=>{const t=Ge(),[r,a]=v.useState(null),[n,i]=v.useState([]),[l,o]=v.useState(!0),[c,u]=v.useState(!1),[d,m]=v.useState("add"),[f,x]=v.useState(!1),[p,h]=v.useState(null),[g,b]=v.useState(null),[j,y]=v.useState(!1),[w,N]=v.useState(!1),S={1:{id:1,name:"Cabin Crew Training",code:"CCT",description:"Primarily responsible for training and developing flight attendants. The curriculum covers all skills required to work on board, including safety procedures, emergency response, first aid, and customer service.",duration:"6 months",status:"ACTIVE",totalSubjects:12,totalTrainers:8},2:{id:2,name:"Flight Crew Training",code:"FCTD",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"12 months",status:"ACTIVE",totalSubjects:18,totalTrainers:15},3:{id:3,name:"Ground Operations Training",code:"GOT",description:"A more specialized branch of Ground Training (GAT). It focuses on personnel working directly on the aircraft ramp/apron. Operations include marshalling aircraft into parking positions, operating passenger stairs and baggage vehicles, and carrying out cargo and baggage loading procedures.",duration:"4 months",status:"ACTIVE",totalSubjects:8,totalTrainers:6},4:{id:4,name:"Ground Affairs Training",code:"GAT",description:"Responsible for training staff in ground service departments. This area is broad and may include check-in agents, gate agents, baggage service staff, and more.",duration:"3 months",status:"ACTIVE",totalSubjects:6,totalTrainers:4},5:{id:5,name:"Technical & Aircraft Maintenance",code:"TAMT",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"18 months",status:"ACTIVE",totalSubjects:24,totalTrainers:20}},E=[{id:1,name:"Safety Procedures",code:"SAF001",startDate:"2024-01-15",endDate:"2024-01-29",venue:"Training Center A",note:"Basic safety protocols",status:"ACTIVE"},{id:2,name:"Emergency Response",code:"EMR001",startDate:"2024-02-01",endDate:"2024-02-22",venue:"Training Center B",note:"Emergency procedures training",status:"ACTIVE"},{id:3,name:"First Aid",code:"FAD001",startDate:"2024-01-20",endDate:"2024-01-27",venue:"Medical Center",note:"Basic first aid skills",status:"ACTIVE"},{id:4,name:"Customer Service",code:"CSV001",startDate:"2024-02-05",endDate:"2024-02-19",venue:"Training Center A",note:"Customer interaction skills",status:"ACTIVE"},{id:5,name:"Simulator Training",code:"SIM001",startDate:"2024-02-10",endDate:"2024-03-09",venue:"Simulator Complex",note:"Flight simulator training",status:"ACTIVE"},{id:6,name:"Type Rating",code:"TR001",startDate:"2024-03-01",endDate:"2024-04-12",venue:"Training Center C",note:"Aircraft type certification",status:"ACTIVE"},{id:7,name:"Recurrent Training",code:"RT001",startDate:"2024-01-25",endDate:"2024-02-08",venue:"Training Center A",note:"Refresher training",status:"ACTIVE"},{id:8,name:"Aircraft Marshalling",code:"AM001",startDate:"2024-02-15",endDate:"2024-02-22",venue:"Ramp Area",note:"Ground operations",status:"ACTIVE"},{id:9,name:"Baggage Handling",code:"BH001",startDate:"2024-02-20",endDate:"2024-02-27",venue:"Baggage Area",note:"Baggage operations",status:"ACTIVE"},{id:10,name:"Check-in Procedures",code:"CIP001",startDate:"2024-03-05",endDate:"2024-03-12",venue:"Terminal",note:"Passenger check-in",status:"ACTIVE"}];v.useEffect(()=>{e&&(async()=>{o(!0);try{const M=await Yr.getDepartmentById(e);if(!M)throw new Error(`Department with ID ${e} not found in API response`);const X={id:M.id,name:M.name,code:M.code,description:M.description,duration:"N/A",status:M.isActive,totalSubjects:M.courseCount||0,totalTrainers:M.trainerCount||0};a(X);const ae=(M.courses||[]).filter(V=>V.status!=="ARCHIVED").map(V=>({id:V.id,name:V.name,code:V.code,startDate:V.startDate?new Date(V.startDate).toISOString().split("T")[0]:"N/A",endDate:V.endDate?new Date(V.endDate).toISOString().split("T")[0]:"N/A",venue:V.venue||"N/A",note:V.note||"N/A",status:V.status,description:V.description,maxNumTrainee:V.maxNumTrainee,passScore:V.passScore,level:V.level,subjectCount:V.subjectCount||0}))||[];i(ae),M.headUser&&b(M.headUser),o(!1)}catch{o(!1);const R=S[e];R&&(a(R),i(E.filter(M=>M.status!=="ARCHIVED")))}})()},[e]);const _=()=>{m("add"),u(!0)},T=P=>{const R=n.find(M=>M.id===P);h(R),x(!0)},C=async P=>{try{await Yr.archiveCourse(P),te.success("Course archived successfully"),i(R=>R.filter(M=>M.id!==P)),x(!1),h(null)}catch(R){throw te.error("Failed to archive course. Please try again."),R}},A=P=>{t(he.ACADEMIC_COURSE_DETAIL(P),{state:{departmentId:r.id,departmentName:r?.name||"Department"}})},D=async P=>{try{N(!0);const R={departmentId:r.id,name:P.name,description:P.description,code:P.code,maxNumTrainee:Number(P.maxNumTrainee),venue:P.venue,note:P.note,passScore:Number(P.passScore),startDate:P.startDate?new Date(P.startDate).toISOString():null,endDate:P.endDate?new Date(P.endDate).toISOString():null,level:P.level},M=await Yr.createCourse(R);te.success("Course created successfully");const X={id:M.id,name:M.name,code:M.code,startDate:M.startDate?new Date(M.startDate).toISOString().split("T")[0]:"N/A",endDate:M.endDate?new Date(M.endDate).toISOString().split("T")[0]:"N/A",venue:M.venue||"N/A",note:M.note||"N/A",status:M.status||"PLANNED",description:M.description,maxNumTrainee:M.maxNumTrainee,passScore:M.passScore,level:M.level,department:M.department};i(ie=>[X,...ie])}catch(R){throw R.response?.status,te.error(R.response?.data?.message||"Failed to create course"),R}finally{N(!1)}};return l?s.jsx(_e,{className:"py-4",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):r?s.jsxs(_e,{className:"d-flex flex-column",style:{padding:"0.5rem 1rem",overflowX:"hidden"},children:[s.jsx(oe,{className:"mb-1 flex-shrink-0",children:s.jsx(U,{children:s.jsx(H,{className:"border-0 shadow-sm",children:s.jsxs(H.Body,{className:"p-2",children:[s.jsx("div",{className:"d-flex justify-content-between align-items-start mb-1",children:s.jsxs("div",{children:[s.jsxs("h4",{className:"mb-1",children:[s.jsx(It,{className:"me-2 text-primary"}),r.name]}),s.jsxs("p",{className:"text-muted mb-0 small",children:["Department Code: ",r.code]})]})}),s.jsx("p",{className:"text-muted mb-1 small",children:r.description}),s.jsxs(oe,{className:"g-2",children:[s.jsx(U,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(vt,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Total Subjects"}),s.jsx("div",{className:"fw-semibold small",children:r.totalSubjects})]})]})}),s.jsx(U,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($r,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Total Trainers"}),s.jsx("div",{className:"fw-semibold small",children:r.totalTrainers})]})]})}),s.jsx(U,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Department Head"}),s.jsx("div",{className:"fw-semibold small",children:g?s.jsx(se,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>y(!0),style:{fontSize:"inherit",fontWeight:"inherit",color:"#0d6efd"},children:[g.firstName,g.middleName,g.lastName].filter(Boolean).join(" ")}):"Not assigned"})]})]})})]})]})})})}),s.jsx(oe,{className:"mt-3",children:s.jsx(U,{children:s.jsxs(H,{className:"border-0 shadow-sm",children:[s.jsx(H.Header,{className:"academic-course-section-header bg-primary text-white border-0 flex-shrink-0",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("h5",{className:"mb-0 text-white",children:[s.jsx(vt,{className:"me-2"}),"Courses (",n.length,")"]}),s.jsx(Ar,{permission:fe.CREATE_COURSE,children:s.jsxs(se,{variant:"light",size:"sm",onClick:_,className:"academic-course-add-btn",children:[s.jsx(Xr,{size:16,className:"me-1"}),"Add New Course"]})})]})}),s.jsx("div",{className:"p-0",children:s.jsx(Hle,{courses:n,loading:!1,actionsComponent:Vle,onView:A,onDisable:T})})]})})}),s.jsx(Gle,{show:c&&d==="add",onClose:()=>u(!1),onSave:D,loading:w}),s.jsx(qle,{show:f,onClose:()=>x(!1),onArchive:C,course:p}),s.jsx(Kle,{show:j,onClose:()=>y(!1),departmentHead:g,department:r})]}):s.jsx(_e,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx(It,{size:48,className:"mb-3"}),s.jsx("h4",{children:"Department not found"}),s.jsx("p",{children:"The requested department could not be found."})]})})},Xle=()=>{const{courseId:e}=gr();return s.jsx(Yle,{courseId:e})},Jle=({trainer:e,onEdit:t,onDelete:r})=>s.jsx(Ar,{permissions:[fe.UPDATE_SUBJECT,fe.REMOVE_SUBJECT_TRAINER],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"Edit Trainer",icon:s.jsx(ts,{}),onClick:()=>t(e.id),permission:fe.UPDATE_SUBJECT},{type:"divider"},{label:"Remove Trainer",icon:s.jsx(mn,{}),className:"text-danger",onClick:()=>r(e.id),permission:fe.REMOVE_SUBJECT_TRAINER}]})}),_4=({show:e,onClose:t,onDisable:r,subject:a,loading:n=!1})=>{const[i,l]=v.useState(""),[o,c]=v.useState(""),[u,d]=v.useState(0),[m,f]=v.useState(!1),p=i==="ARCHIVE";v.useEffect(()=>{e&&a?.id?h():(d(0),l(""),c(""))},[e,a?.id]);const h=async()=>{if(a?.id){f(!0);try{const y=await ws.getSubjectById(a.id);y?.enrollmentCount!==void 0?d(y.enrollmentCount):y?.enrollments&&Array.isArray(y.enrollments)?d(y.enrollments.length):d(0)}catch{d(0)}finally{f(!1)}}},g=()=>{l(""),c(""),d(0),t()},b=async()=>{if(!p){c('Please type "ARCHIVE" to confirm');return}try{await r(a?.id),g()}catch(y){c(y.message||"Failed to disable subject. Please try again.")}},j=y=>{l(y.target.value),c("")};return s.jsxs(le,{show:e,onHide:g,centered:!0,children:[s.jsx(le.Header,{className:"bg-warning text-dark border-0",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Er,{className:"me-2",size:20}),"Archive Subject"]})}),s.jsxs(le.Body,{className:"p-4",children:[o&&s.jsx(ke,{variant:"danger",className:"mb-3",children:o}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-2",children:"You are about to archive the following subject:"}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx("strong",{children:"Subject Code:"})," ",a?.code,s.jsx("br",{}),s.jsx("strong",{children:"Subject Name:"})," ",a?.name,s.jsx("br",{}),a?.description&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Description:"})," ",a?.description]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-warning mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-warning mb-3",children:[s.jsx("li",{children:"Make the subject unavailable for new enrollments"}),s.jsx("li",{children:"Remove the subject from active course offerings"}),s.jsx("li",{children:"Affect any ongoing training sessions"}),u>0&&s.jsxs("li",{className:"fw-bold",children:[s.jsxs("strong",{children:["Cascade cancel all ",u," enrollment",u>1?"s":""]})," associated with this subject"]})]}),u>0&&s.jsxs("div",{className:"alert alert-warning mb-0",children:[s.jsx("strong",{children:"Total Enrollments:"})," ",s.jsx(Ne,{bg:"warning",className:"text-dark ms-2",children:u}),u>0&&s.jsxs("p",{className:"mb-0 mt-2 small",children:["All ",u," enrollment",u>1?"s":""," will be automatically cancelled when this subject is archived."]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",s.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),s.jsx("input",{type:"text",className:`form-control ${i&&!p?"is-invalid":""}`,id:"confirmText",value:i,onChange:j,placeholder:"Type ARCHIVE here",disabled:n}),i&&!p&&s.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsx(se,{variant:"outline-secondary",onClick:g,disabled:n,children:"Cancel"}),s.jsx(se,{variant:"warning",onClick:b,disabled:n||!p||m,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"me-2",size:16}),"Archive Subject"]})})]})]})},Zle=({show:e,onClose:t,onSave:r,subject:a,loading:n=!1})=>{const[i,l]=v.useState({name:"",code:"",description:"",duration:"",level:"Beginner"}),[o,c]=v.useState([]);v.useEffect(()=>{a&&e&&(l({name:a.name||"",code:a.code||"",description:a.description||"",duration:a.duration||"",level:a.level||"Beginner"}),c([]))},[a,e]);const u=x=>{const{name:p,value:h}=x.target;l(g=>({...g,[p]:h}))},d=()=>{const x=[];return i.name.trim()||x.push("Subject name is required"),i.code.trim()||x.push("Subject code is required"),i.description.trim()||x.push("Description is required"),i.duration.trim()||x.push("Duration is required"),c(x),x.length===0},m=async x=>{if(x.preventDefault(),!!d())try{await r(i),f()}catch{}},f=()=>{l({name:"",code:"",description:"",duration:"",level:"Beginner"}),c([]),t()};return s.jsxs(le,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(ts,{className:"me-2",size:20}),"Edit Subject"]}),s.jsx(se,{variant:"link",onClick:f,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",children:[o.length>0&&s.jsx(ke,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:o.map((x,p)=>s.jsx("li",{children:x},p))})}),s.jsxs(I,{onSubmit:m,children:[s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Subject Name *"}),s.jsx(I.Control,{type:"text",name:"name",value:i.name,onChange:u,placeholder:"Enter subject name",disabled:n})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Subject Code *"}),s.jsx(I.Control,{type:"text",name:"code",value:i.code,onChange:u,placeholder:"Enter subject code",disabled:n})]})})]}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Duration *"}),s.jsx(I.Control,{type:"text",name:"duration",value:i.duration,onChange:u,placeholder:"e.g., 2 weeks, 1 month",disabled:n})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Level"}),s.jsxs(I.Select,{name:"level",value:i.level,onChange:u,disabled:n,children:[s.jsx("option",{value:"Beginner",children:"Beginner"}),s.jsx("option",{value:"Intermediate",children:"Intermediate"}),s.jsx("option",{value:"Advanced",children:"Advanced"})]})]})})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Description *"}),s.jsx(I.Control,{as:"textarea",rows:4,name:"description",value:i.description,onChange:u,placeholder:"Enter subject description",disabled:n})]})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:f,disabled:n,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",onClick:m,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ts,{className:"me-2",size:16}),"Save Changes"]})})]})]})},Qle=({show:e,onClose:t,onSave:r,trainer:a,loading:n=!1})=>{const[i,l]=v.useState({roleInSubject:"EXAMINER"}),[o,c]=v.useState([]);v.useEffect(()=>{if(a&&e){const x=a.role==="EXAMINER"||a.role==="ASSESSMENT_REVIEWER"?a.role:"EXAMINER";l({roleInSubject:x}),c([])}},[a,e]);const u=x=>{const{name:p,value:h}=x.target;l(g=>({...g,[p]:h}))},d=()=>{const x=[];return i.roleInSubject||x.push("Role in assessment is required"),c(x),x.length===0},m=async x=>{if(x.preventDefault(),!!d())try{await r(i),f()}catch{}},f=()=>{l({roleInSubject:"EXAMINER"}),c([]),t()};return s.jsxs(le,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(ts,{className:"me-2",size:20}),"Edit Trainer"]}),s.jsx(se,{variant:"link",onClick:f,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",children:[o.length>0&&s.jsx(ke,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:o.map((x,p)=>s.jsx("li",{children:x},p))})}),s.jsxs(I,{onSubmit:m,children:[s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Trainer Name"}),s.jsx(I.Control,{type:"text",value:a?.name||"",disabled:!0,className:"bg-light"})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"EID"}),s.jsx(I.Control,{type:"text",value:a?.eid||"",disabled:!0,className:"bg-light"})]})})]}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Role in Assessment *"}),s.jsxs(I.Select,{name:"roleInSubject",value:i.roleInSubject,onChange:u,disabled:n,children:[s.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]}),s.jsx(I.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:f,disabled:n,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",onClick:m,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ts,{className:"me-2",size:16}),"Save Changes"]})})]})]})},eoe=({show:e,onClose:t,onSave:r,loading:a=!1})=>{const[n,i]=v.useState({trainer_user_id:"",role_in_subject:"EXAMINER"}),[l,o]=v.useState([]),[c,u]=v.useState([]),[d,m]=v.useState(!1),f=async()=>{m(!0);try{const g=await $s.getTrainers();let b=[];g&&(g.data&&Array.isArray(g.data)?b=g.data:g.users&&Array.isArray(g.users)?b=g.users:g.data&&g.data.users&&Array.isArray(g.data.users)?b=g.data.users:Array.isArray(g)&&(b=g)),u(Array.isArray(b)?b:[])}catch(g){console.error("Error loading trainers:",g),u([])}finally{m(!1)}};v.useEffect(()=>{e&&(i({trainer_user_id:"",role_in_subject:"EXAMINER"}),o([]),f())},[e]);const x=()=>{const g=[];return n.trainer_user_id||g.push("Please select a trainer"),n.role_in_subject||g.push("Role in assessment is required"),o(g),g.length===0},p=async g=>{if(g.preventDefault(),!!x())try{await r(n),h()}catch{}},h=()=>{i({trainer_user_id:"",role_in_subject:"EXAMINER"}),o([]),t()};return s.jsxs(le,{show:e,onHide:h,size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Xr,{className:"me-2",size:20}),"Add Trainer"]}),s.jsx(se,{variant:"link",onClick:h,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",children:[l.length>0&&s.jsx(ke,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:l.map((g,b)=>s.jsx("li",{children:g},b))})}),s.jsx(I,{onSubmit:p,children:s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Select Trainer *"}),s.jsxs(kt,{onSelect:g=>{i(b=>({...b,trainer_user_id:g||""}))},children:[s.jsx(kt.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:a||d,style:{border:"1px solid #ced4da",backgroundColor:a||d?"#e9ecef":"#fff",minWidth:0},children:s.jsx("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:n.trainer_user_id?c.find(g=>g.id===n.trainer_user_id)?`${c.find(g=>g.id===n.trainer_user_id).firstName} ${c.find(g=>g.id===n.trainer_user_id).lastName} - ${c.find(g=>g.id===n.trainer_user_id).department?.name||"General"}`:"Choose a trainer...":d?"Loading trainers...":"Choose a trainer..."})}),s.jsx(kt.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:d?s.jsxs(kt.Item,{disabled:!0,children:[s.jsx(xt,{animation:"border",size:"sm",className:"me-2"}),"Loading trainers..."]}):!Array.isArray(c)||c.length===0?s.jsx(kt.Item,{disabled:!0,children:"No trainers available"}):c.map(g=>s.jsxs(kt.Item,{eventKey:g.id,children:[g.firstName," ",g.lastName," - ",g.department?.name||"General"]},g.id))})]}),d&&s.jsxs("div",{className:"mt-2 text-center",children:[s.jsx(xt,{animation:"border",size:"sm",className:"me-2"}),s.jsx("small",{className:"text-muted",children:"Loading trainers..."})]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Role in Assessment *"}),s.jsxs(kt,{onSelect:g=>{i(b=>({...b,role_in_subject:g||"EXAMINER"}))},children:[s.jsx(kt.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:a,style:{border:"1px solid #ced4da",backgroundColor:a?"#e9ecef":"#fff",minWidth:0},children:s.jsxs("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:[n.role_in_subject==="EXAMINER"&&"Examiner - Conducts exams and assessments",n.role_in_subject==="ASSESSMENT_REVIEWER"&&"Assessment Reviewer - Reviews and grades assessments"]})}),s.jsxs(kt.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:[s.jsx(kt.Item,{eventKey:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx(kt.Item,{eventKey:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]})]}),s.jsx(I.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})]})})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:h,disabled:a,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",onClick:p,disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Adding..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Xr,{className:"me-2",size:16}),"Add Trainer"]})})]})]})},k4=({courseId:e,subjectId:t,onView:r})=>{const[a,n]=v.useState([]),[i,l]=v.useState(!0),[o,c]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e&&!t){n([]),l(!1);return}try{l(!0),c(null);const h=((await Za.getAssessmentEvents())?.data?.events||[]).filter(g=>t?g.subjectId===t:e?g.courseId===e:!1).map((g,b)=>{let j="",y="";return g.entityInfo&&(g.entityInfo.type==="subject"?j=g.entityInfo.name||"":g.entityInfo.type==="course"&&(y=g.entityInfo.name||"")),{id:g.id||`event-${b}`,name:g.name||"N/A",subject:j,course:y,occurrenceDate:g.occuranceDate||g.occurrenceDate,status:g.status||"N/A",totalTrainees:g.totalTrainees||0,templateInfo:g.templateInfo,originalEvent:g}});n(h)}catch(f){console.error("Error loading assessment events:",f),c(f.response?.data?.message||f.message||"Failed to load assessment events"),te.error("Failed to load assessment events"),n([])}finally{l(!1)}})()},[e,t]);const u=m=>{switch(String(m||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},d=m=>{if(!m)return"-";try{return new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}};return i?s.jsx("div",{children:s.jsx(zt,{rows:4,columns:6})}):o?s.jsx("div",{children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:o})]})}):a.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx(Ra,{size:48,className:"mb-3",style:{opacity:.5}}),s.jsx("h5",{children:"No assessment events found"}),s.jsxs("p",{children:["There are no assessment events available for this ",t?"subject":"course","."]})]})}):s.jsx("div",{children:s.jsx("div",{className:"table-responsive",children:s.jsxs(Yt,{hover:!0,striped:!0,bordered:!0,className:"mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Name"}),!t&&s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Subject"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Template"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Occurrence Date"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Total Trainees"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Status"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:a.map((m,f)=>s.jsxs("tr",{style:{transition:"all 0.2s ease"},onMouseEnter:x=>{x.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:x=>{x.currentTarget.style.backgroundColor=""},children:[s.jsx("td",{className:"align-middle",children:s.jsx("span",{className:"fw-medium",children:m.name||"-"})}),!t&&s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:m.subject||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:m.templateInfo?.name||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:d(m.occurrenceDate)})}),s.jsx("td",{className:"align-middle",children:s.jsx(Ne,{bg:"info",className:"px-2 py-1",children:m.totalTrainees||0})}),s.jsx("td",{className:"align-middle",children:s.jsx(Ne,{bg:u(m.status),className:"px-3 py-2",children:m.status||"-"})}),s.jsx("td",{className:"align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>r&&r(m.originalEvent||m)}]})})]},m.id||f))})]})})})},B1=({show:e,onClose:t,event:r})=>{if(!r)return null;const a=d=>{if(!d)return"-";try{return new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return d}},n=d=>{switch(String(d||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},i=r.entityInfo?.type||"-",l=r.entityInfo?.name||"-",o=r.entityInfo?.code||"-";r.entityInfo?.id;const c=r.templateInfo?.name||"-";r.templateInfo?.id;const u=r.templateInfo?.isActive??!1;return s.jsxs(le,{show:e,onHide:t,size:"lg",centered:!0,dialogClassName:"assessment-event-detail-modal",children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[s.jsxs(le.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(Ra,{className:"me-2",size:20}),"Assessment Event Details"]}),s.jsx(se,{variant:"link",onClick:t,className:"text-white p-0 ms-auto",style:{border:"none",background:"none",opacity:.9},children:s.jsx(Xe,{size:24,color:"#ffffff"})})]}),s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",backgroundColor:"var(--bs-light)",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[s.jsxs(H,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[s.jsxs(H.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[s.jsx(vt,{className:"me-2",size:18}),s.jsx("span",{className:"fw-semibold",children:"Basic Information"})]}),s.jsx(H.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:s.jsxs(oe,{children:[s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Event Name"}),s.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:r.name||"-"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"text-muted mb-1 d-flex align-items-center",style:{fontSize:"0.875rem",fontWeight:600},children:[s.jsx(xr,{className:"me-2",size:16,style:{color:"var(--bs-primary)"}}),"Occurrence Date"]}),s.jsx("span",{style:{color:"var(--bs-dark)"},children:a(r.occuranceDate||r.occurrenceDate)})]})]}),s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Status"}),s.jsx(Ne,{bg:n(r.status),className:"px-3 py-2",children:r.status||"-"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"text-muted mb-1 d-flex align-items-center",style:{fontSize:"0.875rem",fontWeight:600},children:[s.jsx($r,{className:"me-2",size:16,style:{color:"var(--bs-primary)"}}),"Total Trainees"]}),s.jsx(Ne,{bg:"info",className:"px-3 py-2",children:r.totalTrainees||0})]})]})]})})]}),s.jsxs(H,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[s.jsxs(H.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[s.jsx(It,{className:"me-2",size:18}),s.jsx("span",{className:"fw-semibold",children:i==="course"?"Course Information":i==="subject"?"Subject Information":"Entity Information"})]}),s.jsx(H.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:s.jsxs(oe,{children:[s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Name"}),s.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:l})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Code"}),s.jsx(Ne,{bg:"secondary",className:"px-2 py-1",children:o})]})]}),s.jsx(U,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Type"}),s.jsx(Ne,{bg:i==="course"?"primary":i==="subject"?"info":"secondary",className:"px-2 py-1",children:i.toUpperCase()})]})})]})})]}),s.jsxs(H,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[s.jsxs(H.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[s.jsx(vt,{className:"me-2",size:18}),s.jsx("span",{className:"fw-semibold",children:"Template Information"})]}),s.jsx(H.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Template Name"}),s.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:c})]})}),s.jsx(U,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Status"}),s.jsx(Ne,{bg:u?"success":"danger",className:"px-2 py-1",children:u?"Active":"Inactive"})]})})]})})]})]}),s.jsx(le.Footer,{className:"border-top",children:s.jsx(se,{variant:"secondary",onClick:t,children:"Close"})})]})},toe=({subjectId:e,courseId:t})=>{const r=Ge(),a=za(),[n,i]=v.useState(null),[l,o]=v.useState([]),[c,u]=v.useState(!0),[d,m]=v.useState(!1),[f,x]=v.useState(!1),[p,h]=v.useState(!1),[g,b]=v.useState(!1),[j,y]=v.useState(null),[w,N]=v.useState(!1),[S,E]=v.useState(!1),[_,T]=v.useState(!1),[C,A]=v.useState(!1),[D,P]=v.useState(!1),[R,M]=v.useState(null),[X,ie]=v.useState("subject-info"),{sortedData:ae}=ur(l),V=G=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"primary"},EXAMINER:{text:"Examiner",variant:"warning"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"info"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"secondary"}})[G]||{text:G,variant:"light"},me=v.useCallback(G=>{if(G&&G.instructors){const Z=G.instructors.map(ee=>({id:ee.id,eid:ee.eid,name:`${ee.firstName} ${ee.lastName}`,role:ee.roleInSubject,assignedAt:ee.assignedAt}));o(Z)}else o([])},[]);v.useEffect(()=>{e&&(async()=>{if(!e){i(null),u(!1);return}u(!0);try{const Z=await ws.getSubjectById(e);Z?(i(Z),me(Z)):i(null)}catch(Z){let ee=Z.response?.data?.message||Z.message||"Failed to load subject details";if(Z.response?.data?.errors&&Array.isArray(Z.response.data.errors)&&Z.response.data.errors.length>0){const de=Z.response.data.errors[0];ee=`${ee}: ${de.message||de.field}`}te.error(ee),i(null)}finally{u(!1)}})()},[e,me]);const ue=async G=>{E(!0);try{await new Promise(Z=>setTimeout(Z,1e3)),i(Z=>({...Z,...G})),te.success("Subject updated successfully!"),x(!1)}catch{te.error("Failed to update subject")}finally{E(!1)}},F=async()=>{N(!0);try{await new Promise(G=>setTimeout(G,1e3)),m(!1)}catch{}finally{N(!1)}},Y=async G=>{T(!0);try{await ws.addTrainerToSubject(e,G);const Z=await ws.getSubjectById(e);Z&&(i(Z),me(Z)),te.success("Trainer added successfully!"),h(!1)}catch(Z){const ee=Z?.message||Z?.error||"Failed to add trainer";te.error(ee)}finally{T(!1)}},z=async G=>{if(j){A(!0);try{await ws.updateTrainerRole(e,j.id,G);const Z=await ws.getSubjectById(e);Z&&(i(Z),me(Z)),te.success("Trainer role updated successfully!"),b(!1)}catch(Z){console.error("Error updating trainer role:",Z);const ee=Z?.message||Z?.error||"Failed to update trainer role";te.error(ee)}finally{A(!1)}}},k=async G=>{if(G)try{await ws.removeTrainerFromSubject(e,G);const Z=await ws.getSubjectById(e);Z&&(i(Z),me(Z)),te.success("Trainer removed successfully!")}catch(Z){console.error("Error removing trainer:",Z);const ee=Z?.message||Z?.error||"Failed to remove trainer";te.error(ee)}},O=()=>{if(t)r(he.ACADEMIC_COURSE_DETAIL(t));else if(a.state?.courseId)r(he.ACADEMIC_COURSE_DETAIL(a.state.courseId));else if(document.referrer){const G=document.referrer.match(/\/course-detail\/([^/]+)/);r(G?he.ACADEMIC_COURSE_DETAIL(G[1]):-1)}else n?.courseId?r(he.ACADEMIC_COURSE_DETAIL(n.courseId)):r(-1)};return c?s.jsx(_e,{className:"py-4",children:s.jsx(zt,{rows:4,columns:3})}):n?s.jsxs(_e,{className:"py-4 subject-details",children:[s.jsx("div",{className:"d-flex justify-content-between align-items-start mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(se,{variant:"outline-secondary",onClick:O,className:"me-3",children:[s.jsx(At,{className:"me-2",size:16}),"Back to Course"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:n.name}),s.jsxs("p",{className:"text-muted mb-0",children:["Subject Code: ",n.code]})]})]})}),s.jsx(H,{className:"border-0 shadow-sm",children:s.jsxs(Vt.Container,{activeKey:X,onSelect:ie,children:[s.jsxs(H.Header,{className:"border-bottom py-2 bg-primary d-flex justify-content-between align-items-center",children:[s.jsxs(pt,{variant:"tabs",className:"border-0",children:[s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"subject-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:X==="subject-info"?"600":"400",opacity:X==="subject-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(K2,{className:"me-2",size:16}),"Subject Information"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"trainers",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:X==="trainers"?"600":"400",opacity:X==="trainers"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(tS,{className:"me-2",size:16}),"Trainers"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"assessment-events",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:X==="assessment-events"?"600":"400",opacity:X==="assessment-events"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Ra,{className:"me-2",size:16}),"All Related Assessment Events"]})})]}),X==="trainers"&&s.jsxs(se,{variant:"light",size:"sm",onClick:()=>h(!0),className:"d-flex align-items-center",style:{backgroundColor:"#ffffff",borderColor:"#dee2e6",color:"#000000",fontWeight:500},onMouseEnter:G=>{G.currentTarget.style.backgroundColor="#f8f9fa",G.currentTarget.style.borderColor="#dee2e6"},onMouseLeave:G=>{G.currentTarget.style.backgroundColor="#ffffff",G.currentTarget.style.borderColor="#dee2e6"},children:[s.jsx(Xr,{size:14,className:"me-1"}),"Add Trainer"]})]}),s.jsx(H.Body,{className:"p-0",children:s.jsxs(Vt.Content,{children:[s.jsx(Vt.Pane,{eventKey:"subject-info",children:s.jsxs("div",{className:"p-4",children:[s.jsxs(oe,{children:[s.jsxs(U,{md:6,children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",n.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Code:"})," ",n.code]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Description:"})," ",n.description]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Method:"})," ",n.method]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Duration:"})," ",n.duration," days"]})]}),s.jsxs(U,{md:6,children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Type:"})," ",n.type]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Pass Score:"})," ",n.passScore]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Room:"})," ",n.roomName]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Time Slot:"})," ",n.timeSlot]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Start Date:"})," ",new Date(n.startDate).toLocaleDateString()]}),s.jsxs("p",{children:[s.jsx("strong",{children:"End Date:"})," ",new Date(n.endDate).toLocaleDateString()]})]})]}),n.remarkNote&&s.jsx(oe,{children:s.jsx(U,{xs:12,children:s.jsxs("p",{children:[s.jsx("strong",{children:"Remark Note:"})," ",n.remarkNote]})})})]})}),s.jsx(Vt.Pane,{eventKey:"trainers",children:s.jsxs(Yt,{hover:!0,children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"EID"}),s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Name"}),s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Role"}),s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Assigned Date"}),s.jsx("th",{style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:ae.map(G=>{const Z=V(G.role);return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx(Ne,{bg:"secondary",className:"text-white",children:G.eid})}),s.jsx("td",{children:G.name}),s.jsx("td",{children:s.jsx(Ne,{bg:Z.variant,children:Z.text})}),s.jsx("td",{children:G.assignedAt&&!isNaN(new Date(G.assignedAt).getTime())?new Date(G.assignedAt).toLocaleDateString():"N/A"}),s.jsx("td",{children:s.jsx(Jle,{trainer:G,onEdit:()=>{y(G),b(!0)},onDelete:k})})]},G.id)})})]})}),s.jsx(Vt.Pane,{eventKey:"assessment-events",style:{height:"100%"},children:s.jsx(k4,{subjectId:e,courseId:t,onView:G=>{M(G),P(!0)}})})]})})]})}),s.jsx(_4,{show:d,onClose:()=>m(!1),onConfirm:F,subject:n,loading:w}),s.jsx(Zle,{show:f,onClose:()=>x(!1),onSave:ue,subject:n,loading:S}),s.jsx(eoe,{show:p,onClose:()=>h(!1),onSave:Y,loading:_}),s.jsx(Qle,{show:g,onClose:()=>b(!1),onSave:z,trainer:j,loading:C}),s.jsx(B1,{show:D,onClose:()=>{P(!1),M(null)},event:R})]}):s.jsx(_e,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{children:"Subject not found"}),s.jsx("p",{children:"The requested subject could not be found."}),s.jsxs(se,{variant:"primary",onClick:O,children:[s.jsx(At,{className:"me-2",size:16}),"Go Back"]})]})})},y2=()=>{const{subjectId:e,courseId:t}=gr();return s.jsx(toe,{subjectId:e,courseId:t})},roe=({subject:e,onView:t,onEdit:r,onDelete:a})=>{const n=()=>{t&&t(e.id)},i=()=>{a&&a(e.id)};return s.jsx(Ar,{permissions:[fe.VIEW_SUBJECT_DETAIL,fe.ARCHIVE_SUBJECT],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:n,permission:fe.VIEW_SUBJECT_DETAIL},{type:"divider"},{label:"Archive Subject",icon:s.jsx(F2,{}),className:"text-warning",onClick:i,permission:fe.ARCHIVE_SUBJECT}]})})},soe=e=>({id:e.id,name:e.name,code:e.code,method:e.method,duration:noe(e.duration),startDate:j2(e.startDate||e.start_date),endDate:j2(e.endDate||e.end_date),roomName:e.roomName||e.room_name,trainees:e.enrollmentCount||e.enrollment_count||0,status:e.status||(e.deletedAt?"ARCHIVED":"PLANNED"),description:e.description,type:e.type,remarkNote:e.remarkNote||e.remark_note,timeSlot:e.timeSlot||e.time_slot,passScore:e.passScore||e.pass_score,isSIM:e.isSIM||e.is_sim,courseId:e.courseId||e.course_id,course:e.course,createdBy:e.createdBy||e.created_by,updatedBy:e.updatedBy||e.updated_by,instructorCount:e.instructorCount||e.instructor_count||0,source:"api_data"}),aoe=e=>e.map(soe),noe=e=>{if(!e&&e!==0)return"N/A";if(e<1){const t=Math.round(e*24);return t===0?"< 1 hour":t===1?"1 hour":`${t} hours`}return e===1?"1 day":e<7?`${e} days`:e===7?"1 week":e<14?`${Math.round(e/7)} weeks`:e===14?"2 weeks":`${Math.round(e/7)} weeks`},j2=e=>{if(!e)return"N/A";try{return new Date(e).toISOString().split("T")[0]}catch{return"Invalid Date"}},ioe=e=>{switch(e?.toUpperCase()){case"ACTIVE":case"ON-GOING":case"ONGOING":return"success";case"PLANNED":return"info";case"COMPLETED":return"primary";case"ARCHIVED":case"INACTIVE":return"secondary";default:return"secondary"}},loe=e=>{switch(e?.toUpperCase()){case"CLASSROOM":return"info";case"E_LEARNING":case"E-LEARNING":case"ELEARNING":return"primary";case"ERO":return"warning";case"PRACTICAL":return"warning";case"MIXED":return"primary";default:return"secondary"}},ooe=({subjects:e=[],loading:t=!1,onView:r,onEdit:a,onDelete:n})=>{const i=aoe(e),{sortedData:l,sortConfig:o,handleSort:c}=ur(i);if(t)return s.jsx(zt,{rows:4,columns:5});if(i.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"This course doesn't have any subjects yet."})]})});const u=({columnKey:d,children:m,className:f=""})=>{const x=o.key===d,p=x?o.direction:null;return s.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(d),onMouseEnter:h=>{h.target.style.backgroundColor="#214760",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="var(--bs-primary)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),s.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:s.jsx(pr,{direction:p,size:14,color:"white"})})]}),x&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"department-table-container subject-table-scroll",style:{overflowX:"hidden"},children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(u,{columnKey:"name",className:"show-mobile",children:"Name"}),s.jsx(u,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(u,{columnKey:"method",className:"show-mobile",children:"Method"}),s.jsx(u,{columnKey:"duration",className:"show-mobile",children:"Duration"}),s.jsx(u,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),s.jsx(u,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),s.jsx(u,{columnKey:"roomName",className:"show-mobile",children:"Room Name"}),s.jsx(u,{columnKey:"trainees",className:"show-mobile",children:"Trainees"}),s.jsx(u,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px",textTransform:"uppercase",letterSpacing:"0.5px"},children:s.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),s.jsx("tbody",{children:l.map(d=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>r&&r(d.id),style:{cursor:"pointer"},children:d.name})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(Ne,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:d.code,children:d.code})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(Ne,{bg:loe(d.method),className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:d.method,children:d.method})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:d.duration})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:d.startDate})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:d.endDate})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:d.roomName})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($r,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:d.trainees||0})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs(Ne,{bg:ioe(d.status),className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:d.status==="ACTIVE"||d.status==="ON-GOING"||d.status==="ONGOING"?"":""}),d.status||"N/A"]})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(roe,{subject:d,onView:r,onEdit:a,onDelete:n})})]},d.id))})]})})},coe=({trainee:e,onViewSubjects:t,onRemoveTrainee:r})=>s.jsx(Ar,{permissions:[fe.VIEW_SUBJECT_DETAIL,fe.REMOVE_TRAINEE_FROM_SUBJECT],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Subject List",icon:s.jsx(St,{}),onClick:()=>t(e),permission:fe.VIEW_SUBJECT_DETAIL},{type:"divider"},{label:"Remove Trainee",icon:s.jsx(mn,{}),className:"text-danger",onClick:()=>r(e.id),permission:fe.REMOVE_TRAINEE_FROM_SUBJECT}]})}),doe=({show:e,onClose:t,onConfirm:r,trainee:a,subjectName:n=null,loading:i=!1})=>{const l=!n,o=l?"Remove Trainee from All Subjects":"Remove Trainee from Subject",c=l?"Remove from All Subjects":"Remove from Subject",u=()=>{r(),t()};return s.jsxs(le,{show:e,onHide:t,centered:!0,children:[s.jsx(le.Header,{className:"bg-danger text-white border-0",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Er,{className:"me-2",size:20}),o]})}),s.jsxs(le.Body,{className:"p-4",children:[s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"mb-3",children:["Are you sure you want to remove ",s.jsxs("strong",{children:['"',a?.name,'"']}),l?" from ALL subjects":` from "${n}"`,"?"]}),s.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[s.jsx("strong",{children:"Trainee:"})," ",a?.name,s.jsx("br",{}),s.jsx("strong",{children:"EID:"})," ",a?.eid,!l&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("strong",{children:"Subject:"})," ",n]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-danger mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-danger mb-3",children:[l?s.jsxs(s.Fragment,{children:[s.jsx("li",{children:"Remove the trainee from all enrolled subjects"}),s.jsx("li",{children:"Cancel all ongoing training sessions for this trainee"}),s.jsx("li",{children:"Remove the trainee from the course completely"})]}):s.jsxs(s.Fragment,{children:[s.jsx("li",{children:"Remove the trainee from this specific subject only"}),s.jsx("li",{children:"Cancel any ongoing training sessions for this subject"}),s.jsx("li",{children:"Keep the trainee enrolled in other subjects"})]}),s.jsx("li",{children:s.jsx("strong",{children:"Cannot be undone"})})]})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsx(se,{variant:"outline-secondary",onClick:t,disabled:i,children:"Cancel"}),s.jsx(se,{variant:"danger",onClick:u,disabled:i,children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(mn,{className:"me-2",size:16}),c]})})]})]})},uoe=({courseId:e,loading:t=!1,title:r="Enrolled Trainees"})=>{const[a,n]=v.useState([]),[i,l]=v.useState(!0),[o,c]=v.useState(!1),[u,d]=v.useState(null),[m,f]=v.useState(!1),[x,p]=v.useState(null),[h,g]=v.useState(null),[b,j]=v.useState(!1),{sortedData:y,sortConfig:w,handleSort:N}=ur(a),S=v.useCallback(async()=>{if(!e){n([]),l(!1);return}l(!0);try{const P=await Yr.getCourseTrainees(e),R=P?.trainees||P?.data?.trainees||[];if(!Array.isArray(R)||R.length===0){n([]),l(!1);return}const M=[],X=R.map(async V=>{try{const me=await Yr.getTraineeEnrollments(V.id);if(me&&me.enrollments&&me.enrollments.length>0){const ue=me.enrollments.filter(F=>F.enrollment?.status==="ENROLLED");if(ue.length>0){const F=ue.map(Y=>Y.subject.id);return{id:V.id,eid:V.eid,name:`${V.firstName||""} ${V.lastName||""}`.trim()||V.name||"Unknown",subjects:F,userId:V.id,email:V.email||"",department:V.department||null}}}return null}catch{return null}}),ae=(await Promise.all(X)).filter(V=>V!==null);n(ae)}catch(P){console.error("Error loading enrolled trainees:",P),n([])}finally{l(!1)}},[e]);v.useEffect(()=>{e&&S()},[e,S]);const E=async P=>{try{const R=await Yr.getTraineeEnrollments(P.userId),M=R.enrollments?.filter(ie=>ie.enrollment?.status==="ENROLLED")||[],X={...P,enrollmentDetails:R,subjects:M.map(ie=>({id:ie.subject.id,name:ie.subject.name,code:ie.subject.code,status:ie.subject.status,type:ie.subject.type,method:ie.subject.method,startDate:ie.subject.startDate,endDate:ie.subject.endDate,course:ie.subject.course,enrollment:ie.enrollment}))};d(X),c(!0)}catch{d(P),c(!0)}},_=P=>{const R=a.find(M=>M.id===P);R&&(p(R),g(null),f(!0))},T=async()=>{if(x){j(!0);try{const P=await Yr.getTraineeEnrollments(x.userId);if(P&&P.enrollments&&P.enrollments.length>0){const M=P.enrollments.map(async X=>{const ie=X.subject.id,ae=X.enrollment?.batchCode||"TEST0012025";return X.enrollment?.status!=="ENROLLED"?null:ws.removeTraineeFromSubject(ie,x.userId,ae)}).filter(X=>X!==null);M.length>0&&await Promise.all(M),await S(),te.success(`Successfully removed ${x.name} from all subjects`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1)}else te.warning(`No enrollments found for ${x.name}`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1)}catch(P){const R=P?.response?.data?.message||P?.message||"Failed to remove trainee from subjects";te.error(`Error: ${R}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{j(!1)}}},C=(P,R)=>{const M=a.find(ae=>ae.id===P);if(!M)return;const X=u?.subjects?.find(ae=>ae.id===R),ie=X?X.name:"Unknown Subject";p(M),g(ie),f(!0)},A=async()=>{if(!x||!h)return;const P=u?.subjects?.find(R=>R.name===h);if(!P){te.error("Subject not found",{autoClose:3e3,position:"top-right",icon:!1});return}j(!0);try{const R=P.enrollment?.batchCode||"TEST0012025";if(P.enrollment?.status!=="ENROLLED"){te.warning(`Cannot remove trainee from ${h}. Enrollment status is not ENROLLED.`,{autoClose:4e3,position:"top-right",icon:!1}),j(!1);return}await ws.removeTraineeFromSubject(P.id,x.userId,R),await S(),te.success(`Successfully removed ${x.name} from ${h}`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1),c(!1)}catch(R){const M=R?.response?.data?.message||R?.message||"Failed to remove trainee from subject";te.error(`Error: ${M}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{j(!1)}};if(t||i)return s.jsx("div",{children:s.jsx(zt,{rows:4,columns:4})});if(a.length===0)return s.jsx("div",{children:s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No enrolled trainees"}),s.jsx("p",{children:"No trainees have been enrolled in any subjects yet."})]})})});const D=({columnKey:P,children:R,className:M=""})=>{const X=w.key===P,ie=X?w.direction:null;return s.jsxs("th",{className:`fw-semibold ${M}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>N(P),onMouseEnter:ae=>{ae.target.style.backgroundColor="#214760",ae.target.style.transform="translateY(-1px)",ae.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:ae=>{ae.target.style.backgroundColor="var(--bs-primary)",ae.target.style.transform="translateY(0)",ae.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:X?"700":"600",color:"white"},children:R}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:ie,size:14,color:"white"})})]}),X&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"d-flex flex-column",style:{height:"400px",width:"100%"},children:s.jsx("div",{className:"p-0",style:{flex:1,minHeight:0,overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",overflowY:"auto"},children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(D,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(D,{columnKey:"eid",className:"show-mobile",children:"EID"}),s.jsx(D,{columnKey:"subjects",className:"show-mobile",children:"Total Subject"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:y.map(P=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom",children:P.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx(Ne,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:P.eid})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($r,{size:14,className:"me-1 text-muted"}),s.jsxs(Ne,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[P.subjects.length," subjects"]})]})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(coe,{trainee:P,onViewSubjects:E,onRemoveTrainee:_})})]},P.id))})]})})})}),s.jsxs(le,{show:o,onHide:()=>c(!1),size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-gradient-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center text-white",children:[s.jsx($r,{className:"me-2",size:20}),u?.name," - Enrolled Subjects"]}),s.jsx(se,{variant:"link",onClick:()=>c(!1),className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsx(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:u&&s.jsxs("div",{children:[s.jsx("div",{className:"mb-4 p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:s.jsxs("div",{className:"row align-items-center",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:"Trainee Information"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ne,{bg:"primary-custom",className:"me-2 text-white",children:"EID"}),s.jsx("span",{className:"fw-semibold text-primary-custom",children:u.eid})]})]}),s.jsx("div",{className:"col-md-6 text-md-end",children:s.jsx("div",{className:"text-primary-custom small",children:s.jsxs("div",{children:["Total Subjects: ",s.jsx(Ne,{bg:"primary-custom",className:"text-white",children:u.subjects.length})]})})})]})}),s.jsx("div",{className:"row g-3",children:u.subjects.map(P=>s.jsx("div",{className:"col-12",children:s.jsx(H,{className:"border-0 shadow-sm",children:s.jsx(H.Body,{className:"p-3",children:s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-8",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:P.name}),s.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[s.jsx(Ne,{bg:"primary-custom",className:"text-white",children:P.code}),s.jsx(Ne,{bg:P.status==="ACTIVE"?"success":"primary-custom",className:P.status==="ACTIVE"?"":"text-white",children:P.status})]})]}),s.jsx(se,{size:"sm",variant:"outline-danger",className:"ms-2",onClick:()=>{C(u.id,P.id)},children:s.jsx(Xe,{size:14})})]}),s.jsxs("div",{className:"row g-2 mb-3",children:[s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Type:"}),s.jsx(Ne,{bg:"primary-custom",className:"text-white",children:P.type})]})}),s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Method:"}),s.jsx(Ne,{bg:"primary-custom",className:"text-white",children:P.method})]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Course:"}),s.jsx("span",{className:"fw-medium text-primary-custom",children:P.course?.name})]})]}),P.enrollment&&s.jsx("div",{className:"col-md-4",children:s.jsxs("div",{className:"p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:[s.jsx("h6",{className:"text-primary-custom mb-2 fw-bold",children:"Enrollment Details"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Status:"}),s.jsx(Ne,{bg:"primary-custom",className:"text-white",children:P.enrollment.status})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Batch:"}),s.jsx("span",{className:"fw-medium small text-primary-custom",children:P.enrollment.batchCode})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Enrolled:"}),s.jsx("span",{className:"fw-medium small text-primary-custom",children:new Date(P.enrollment.enrollmentDate).toLocaleDateString()})]})]})]})})]})})})},P.id))})]})}),s.jsx(le.Footer,{className:"border-top",children:s.jsx(se,{variant:"primary-custom",className:"text-white",onClick:()=>c(!1),children:"Close"})})]}),s.jsx(doe,{show:m,onClose:()=>{f(!1),p(null),g(null),j(!1)},onConfirm:h?A:T,trainee:x,subjectName:h,loading:b})]})},moe=({show:e,onClose:t,onSave:r,loading:a=!1,courseId:n})=>{const[i,l]=v.useState({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[o,c]=v.useState([]),[u,d]=v.useState(!1);v.useEffect(()=>{e&&n&&(l({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]))},[e,n]);const m=h=>{const{name:g,value:b,type:j,checked:y}=h.target;l(w=>({...w,[g]:j==="checkbox"?y:b}))},f=()=>{const h=[];return n||h.push("Course ID is required"),i.name.trim()||h.push("Subject name is required"),i.code.trim()||h.push("Subject code is required"),i.duration.trim()&&(isNaN(i.duration)||parseInt(i.duration)<=0)&&h.push("Duration must be a positive number"),i.passScore.trim()&&(isNaN(i.passScore)||parseFloat(i.passScore)<0||parseFloat(i.passScore)>100)&&h.push("Pass score must be between 0 and 100"),i.startDate.trim()||h.push("Start date is required"),i.endDate.trim()||h.push("End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&h.push("End date must be after start date"),c(h),h.length===0},x=async h=>{if(h.preventDefault(),!!f()){d(!0);try{const g={courseId:n,name:i.name.trim(),code:i.code.trim(),description:i.description.trim()||null,method:i.method,duration:i.duration.trim()?parseInt(i.duration):null,type:i.type,roomName:i.roomName.trim()||null,remarkNote:i.remarkNote.trim()||null,timeSlot:i.timeSlot.trim()||null,isSIM:i.isSIM,passScore:i.passScore.trim()?parseFloat(i.passScore):null,startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString()},b=await Ce.post("/subjects",g);te.success("Subject created successfully!"),r&&await r(b.data||g),p()}catch(g){const b=g.response?.data?.message||g.message||"Failed to create subject";te.error(`Error: ${b}`),c([b])}finally{d(!1)}}},p=()=>{l({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]),d(!1),t()};return s.jsxs(le,{show:e,onHide:p,size:"lg",centered:!0,style:{maxHeight:"90vh"},children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Xr,{className:"me-2",size:20}),"Add New Subject"]}),s.jsx(se,{variant:"link",onClick:p,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[o.length>0&&s.jsx(ke,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:o.map((h,g)=>s.jsx("li",{children:h},g))})}),s.jsxs(I,{onSubmit:x,children:[s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Subject Name *"}),s.jsx(I.Control,{type:"text",name:"name",value:i.name,onChange:m,placeholder:"Enter subject name",required:!0})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Subject Code *"}),s.jsx(I.Control,{type:"text",name:"code",value:i.code,onChange:m,placeholder:"Enter subject code",required:!0})]})})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Description"}),s.jsx(I.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,placeholder:"Enter subject description"})]}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Method *"}),s.jsxs(I.Select,{name:"method",value:i.method,onChange:m,required:!0,children:[s.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),s.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),s.jsx("option",{value:"ERO",children:"ERO"})]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Duration (days)"}),s.jsx(I.Control,{type:"number",name:"duration",value:i.duration,onChange:m,placeholder:"Enter duration in days",min:"1"})]})})]}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Type *"}),s.jsxs(I.Select,{name:"type",value:i.type,onChange:m,required:!0,children:[s.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),s.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Room Name"}),s.jsx(I.Control,{type:"text",name:"roomName",value:i.roomName,onChange:m,placeholder:"Enter room name"})]})})]}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Time Slot"}),s.jsx(I.Control,{type:"text",name:"timeSlot",value:i.timeSlot,onChange:m,placeholder:"e.g., 09:00-11:00"})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Pass Score"}),s.jsx(I.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,placeholder:"Enter pass score (0-100)",min:"0",max:"100",step:"0.01"})]})})]}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Start Date *"}),s.jsx(I.Control,{type:"datetime-local",name:"startDate",value:i.startDate,onChange:m,required:!0})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"End Date *"}),s.jsx(I.Control,{type:"datetime-local",name:"endDate",value:i.endDate,onChange:m,required:!0})]})})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Remark Note"}),s.jsx(I.Control,{as:"textarea",rows:2,name:"remarkNote",value:i.remarkNote,onChange:m,placeholder:"Enter remark note"})]}),s.jsx(I.Group,{className:"mb-3",children:s.jsx(I.Check,{type:"checkbox",name:"isSIM",checked:i.isSIM,onChange:m,label:"Is Simulator"})})]})]}),s.jsxs(le.Footer,{className:"border-0",children:[s.jsx(se,{variant:"secondary",onClick:p,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:x,disabled:u,children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):"Create Subject"})]})]})},foe=({show:e,onClose:t,onImport:r,loading:a=!1,courseId:n})=>{const[i,l]=v.useState(!1),[o,c]=v.useState(null),[u,d]=v.useState([]),[m,f]=v.useState([]),[x,p]=v.useState([]),h=v.useRef(null),g=["code","name","course_id"],b=["code","name","course_id","description","method","duration","type","room_name","remark_note","time_slot","pass_score","start_date","end_date","is_sim"],j=A=>{A.preventDefault(),A.stopPropagation(),A.type==="dragenter"||A.type==="dragover"?l(!0):A.type==="dragleave"&&l(!1)},y=A=>{A.preventDefault(),A.stopPropagation(),l(!1),A.dataTransfer.files&&A.dataTransfer.files[0]&&N(A.dataTransfer.files[0])},w=A=>{A.target.files&&A.target.files[0]&&N(A.target.files[0])},N=A=>{if(!A.name.match(/\.(xlsx|xls)$/)){f(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(A.size>100*1024*1024){f(["File size must be less than 100MB"]);return}c(A),f([]),S(A)},S=A=>{const D=new FileReader;D.onload=P=>{try{const R=new Uint8Array(P.target.result),M=uc(R,{type:"array"}),X=M.SheetNames[0],ie=M.Sheets[X],ae=Oa.sheet_to_json(ie,{header:1});if(ae.length<2){f(["Excel file must contain at least a header row and one data row"]);return}const V=ae[0].map(z=>z?.toString().toLowerCase().trim()),me=ae.slice(1),F=(n?g.filter(z=>z!=="course_id"):g).filter(z=>!V.includes(z));if(F.length>0){f([`Missing required columns: ${F.join(", ")}`]);return}const Y=me.map((z,k)=>{const O=V.includes("course_id")?z[V.indexOf("course_id")]?.toString().trim()||"":n||"",G={id:`temp_${k}`,rowNumber:k+2,code:z[V.indexOf("code")]?.toString().trim()||"",name:z[V.indexOf("name")]?.toString().trim()||"",course_id:O,description:z[V.indexOf("description")]?.toString().trim()||"",method:z[V.indexOf("method")]?.toString().trim()||"THEORY",duration:z[V.indexOf("duration")]?.toString().trim()||"",type:z[V.indexOf("type")]?.toString().trim()||"MANDATORY",room_name:z[V.indexOf("room_name")]?.toString().trim()||"",remark_note:z[V.indexOf("remark_note")]?.toString().trim()||"",time_slot:z[V.indexOf("time_slot")]?.toString().trim()||"",pass_score:z[V.indexOf("pass_score")]?.toString().trim()||"",start_date:(()=>{const Z=z[V.indexOf("start_date")];return Z?Z instanceof Date?Z.toISOString().split("T")[0]:typeof Z=="number"?Z:String(Z).trim():""})(),end_date:(()=>{const Z=z[V.indexOf("end_date")];return Z?Z instanceof Date?Z.toISOString().split("T")[0]:typeof Z=="number"?Z:String(Z).trim():""})(),is_sim:V.includes("is_sim")||V.includes("issim")?z[V.indexOf(V.includes("is_sim")?"is_sim":"issim")]:void 0,hasError:!1,errors:[]};if(G.code||(G.hasError=!0,G.errors.push("Subject code is required")),G.name||(G.hasError=!0,G.errors.push("Subject name is required")),!G.course_id&&!n?(G.hasError=!0,G.errors.push("Course ID is required (either in file or must be importing from course detail page)")):G.course_id&&(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(G.course_id)||(G.hasError=!0,G.errors.push("Course ID must be a valid UUID format"))),G.duration&&(isNaN(G.duration)||parseInt(G.duration)<=0)&&(G.hasError=!0,G.errors.push("Duration must be a positive number")),G.pass_score&&(isNaN(G.pass_score)||parseFloat(G.pass_score)<0||parseFloat(G.pass_score)>100)&&(G.hasError=!0,G.errors.push("Pass score must be between 0 and 100")),G.method){let Z=G.method.toUpperCase().trim();Z==="E-LEARNING"||Z==="E LEARNING"||Z==="ELEARNING"?Z="E_LEARNING":Z==="CLASSROOM"||Z==="CLASS ROOM"||Z==="CLASS-ROOM"?Z="CLASSROOM":Z==="ERO"&&(Z="ERO"),G.method=Z,["E_LEARNING","CLASSROOM","ERO"].includes(Z)||(G.hasError=!0,G.errors.push("Method must be E_LEARNING, CLASSROOM, or ERO"))}if(G.type&&!["UNLIMIT","RECURRENT"].includes(G.type.toUpperCase())&&(G.hasError=!0,G.errors.push("Type must be UNLIMIT or RECURRENT")),G.start_date)try{let Z;if(typeof G.start_date=="number"&&G.start_date>1e4){const ee=parseFloat(G.start_date);Z=new Date((ee-25569)*86400*1e3)}else{const ee=String(G.start_date).trim();Z=new Date(ee)}isNaN(Z.getTime())&&(G.hasError=!0,G.errors.push("Start date must be a valid date"))}catch{G.hasError=!0,G.errors.push("Start date must be a valid date")}if(G.end_date)try{let Z;if(typeof G.end_date=="number"&&G.end_date>1e4){const ee=parseFloat(G.end_date);Z=new Date((ee-25569)*86400*1e3)}else{const ee=String(G.end_date).trim();Z=new Date(ee)}isNaN(Z.getTime())&&(G.hasError=!0,G.errors.push("End date must be a valid date"))}catch{G.hasError=!0,G.errors.push("End date must be a valid date")}return G}).filter(z=>z.code||z.name);d(Y),p([])}catch{f(["Failed to parse Excel file. Please check the file format."])}},D.readAsArrayBuffer(A)},E=async()=>{const A=u.filter(P=>!P.hasError);if(A.length===0){f(["No valid subjects to import"]);return}if(!n&&A.filter(R=>!R.course_id).length>0){f(["Course ID is required. Please ensure courseId is provided when importing from Course Detail page, or include course_id column in your Excel file."]);return}const D=A.map(P=>{let R=!1;const M=P.is_sim!==void 0?P.is_sim:void 0;if(M!=null&&M!=="")if(typeof M=="string"){const me=M.toLowerCase().trim();R=["true","1","yes","y"].includes(me)}else typeof M=="boolean"?R=M:typeof M=="number"&&(R=M!==0);const X=me=>{if(!me||me===""||me==="N/A")return null;try{let ue;if(typeof me=="string"){const Y=me.trim();if(/^\d+$/.test(Y)){const z=parseInt(Y);if(z>=1&&z<=1e5){const G=(z-25569)*86400*1e3;ue=new Date(G);const Z=ue.getFullYear();(Z<1900||Z>2100)&&(ue=new Date(Y))}else ue=new Date(z<1e12?z*1e3:z)}else{if(Y.includes("T")&&Y.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/))return Y;Y.match(/^\d{4}-\d{2}-\d{2}$/)?ue=new Date(Y+"T00:00:00.000Z"):ue=new Date(Y)}}else typeof me=="number"?me>=1&&me<=1e5?ue=new Date((me-25569)*86400*1e3):me>1e5&&me<1e12?ue=new Date(me*1e3):ue=new Date(me):ue=new Date(me);if(isNaN(ue.getTime()))return null;const F=ue.getFullYear();return F<1900||F>2100?null:ue.toISOString()}catch{return null}},ie=X(P.start_date),ae=X(P.end_date),V={code:P.code,name:P.name,courseId:String(n||P.course_id),description:P.description||"",method:P.method?P.method.toUpperCase():"CLASSROOM",duration:P.duration?parseInt(P.duration):1,type:P.type?P.type.toUpperCase():"UNLIMIT",roomName:P.room_name||"",remarkNote:P.remark_note||"",timeSlot:P.time_slot||"",passScore:P.pass_score?parseFloat(P.pass_score):70,isSIM:R};return ie&&(V.startDate=ie),ae&&(V.endDate=ae),V});try{const P=await r(D);let R=P;P&&P.data&&typeof P.data=="object"&&(R=P.data);const M=R?.summary?.created??R?.createdSubjects?.length??R?.summary?.createdCount??R?.subjects?.length??0,X=R?.summary?.failed??R?.failedSubjects?.length??R?.summary?.failedCount??0,ie=R?.summary?.skipped??R?.skippedSubjects?.length??R?.summary?.skippedCount??0,ae=R?.summary?.total??D.length;if(!(R?.summary||R?.createdSubjects!==void 0||R?.failedSubjects!==void 0)&&P!==null&&P!==void 0&&!P?.error&&!P?.message?.toLowerCase().includes("fail")){te.success(`Imported ${ae}/${ae} subjects successfully.`,{icon:!1}),_();return}const ue=(!R||M===0&&X===0&&ie===0&&ae===0)&&!P?.error&&R?.message?.toLowerCase().includes("exist");R?.failedSubjects&&Array.isArray(R.failedSubjects)&&R.failedSubjects.length>0&&R.failedSubjects.forEach(F=>{const Y=F.subject?.name||"Unknown Subject",z=F.subject?.code||"N/A",k=F.error||"Unknown error";te.error(`${Y} (${z}): ${k}`,{autoClose:6e3,position:"top-right",icon:!1})}),ue||ie>0?ie>0?te.info(`${ie} subject(s) already exist and were skipped. ${M>0?`${M} new subject(s) were imported.`:""}`,{icon:!1}):te.info("All subjects already exist. No new subjects were imported.",{icon:!1}):M>0&&X===0?te.success(`Imported ${M}/${ae} subjects successfully.`,{icon:!1}):M>0&&X>0?te.warn(`Imported ${M}/${ae}. ${X} failed.`,{icon:!1}):M===0&&X>0?te.error(`All ${X}/${ae} subjects failed to import.`,{icon:!1}):te.success(`Imported ${ae}/${ae} subjects successfully.`,{icon:!1}),_()}catch(P){P?.response?.status===304?(te.info("All subjects already exist. No new subjects were imported.",{icon:!1}),_()):(te.error(P?.response?.data?.message||P.message||"Failed to import subjects.",{icon:!1}),f([P?.response?.data?.message||P.message||"Failed to import subjects. Please try again."]))}},_=()=>{c(null),d([]),f([]),p([]),l(!1),t()},T=A=>A==="valid"?s.jsx(Je,{className:"text-success",size:16}):s.jsx(fs,{className:"text-danger",size:16}),C=()=>{const A=[b,["MATH101","Mathematics",n||"550e8400-e29b-41d4-a716-446655440000","Basic mathematics course covering algebra and geometry","CLASSROOM","14","UNLIMIT","Room A101","This is a required course for all students","09:00-17:00","70.0","2025-01-15 09:00:00","2025-01-29 17:00:00"],["PHYS101","Physics",n||"550e8400-e29b-41d4-a716-446655440000","Introduction to physics concepts and principles","E_LEARNING","7","RECURRENT","Lab B201","Hands-on experiments and demonstrations","14:00-18:00","75.0","2025-02-01 14:00:00","2025-02-08 18:00:00"],["SAFETY301","Safety Procedures",n||"550e8400-e29b-41d4-a716-446655440000","Emergency response and safety protocols training","ERO","5","UNLIMIT","Training Hall B","Hands-on practical training required","08:00-16:00","80.0","2025-03-01 08:00:00","2025-03-06 16:00:00"]],D=Oa.aoa_to_sheet(A),P=Oa.book_new();Oa.book_append_sheet(P,D,"Subjects"),Mg(P,"Subject_Upload_Template.xlsx")};return s.jsxs(le,{show:e,onHide:_,size:"xl",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Ts,{className:"me-2",size:20}),"Bulk Import Subjects"]}),s.jsx(se,{variant:"link",onClick:_,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[m.length>0&&s.jsx(ke,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:m.map((A,D)=>s.jsx("li",{children:A},D))})}),s.jsx(H,{className:"mb-4",children:s.jsxs(H.Body,{children:[s.jsxs("div",{className:`upload-area ${i?"drag-active":""}`,onDragEnter:j,onDragLeave:j,onDragOver:j,onDrop:y,onClick:()=>h.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:i?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Rl,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:h,type:"file",accept:".xlsx,.xls",onChange:w,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Required columns:"})," Code, Name",!n&&s.jsx("span",{children:", Course ID (UUID format)"})]}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Optional columns:"})," Description, Method (E_LEARNING|CLASSROOM|ERO), Duration, Type (UNLIMIT|RECURRENT), Room Name, Remark Note, Time Slot, Pass Score, Start Date, End Date"]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:C,className:"d-flex align-items-center",children:[s.jsx(Ln,{className:"me-1",size:14}),"Download Template"]}),o&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Rl,{className:"text-success me-2",size:16}),s.jsx("span",{className:"text-success fw-semibold",children:o.name})]})]})]})]})}),u.length>0&&s.jsxs(H,{children:[s.jsx(H.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",u.length," records)"]})}),s.jsx(H.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(Yt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"120px"},children:"CODE"}),s.jsx("th",{style:{minWidth:"200px"},children:"NAME"}),s.jsx("th",{style:{minWidth:"200px"},children:"COURSE ID"}),s.jsx("th",{style:{minWidth:"150px"},children:"METHOD"}),s.jsx("th",{style:{minWidth:"100px"},children:"DURATION"}),s.jsx("th",{style:{minWidth:"120px"},children:"TYPE"}),s.jsx("th",{style:{minWidth:"100px"},children:"PASS SCORE"}),s.jsx("th",{style:{minWidth:"150px"},children:"DESCRIPTION"}),s.jsx("th",{style:{minWidth:"150px"},children:"ROOM NAME"}),s.jsx("th",{style:{minWidth:"150px"},children:"TIME SLOT"}),s.jsx("th",{style:{minWidth:"150px"},children:"START DATE"}),s.jsx("th",{style:{minWidth:"150px"},children:"END DATE"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),s.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),s.jsx("tbody",{children:u.map((A,D)=>s.jsxs("tr",{className:A.hasError?"table-danger":"",children:[s.jsx("td",{children:A.rowNumber||D+1}),s.jsx("td",{children:A.code||"-"}),s.jsx("td",{children:A.name||"-"}),s.jsx("td",{children:A.course_id||"-"}),s.jsx("td",{children:A.method||"-"}),s.jsx("td",{children:A.duration||"-"}),s.jsx("td",{children:A.type||"-"}),s.jsx("td",{children:A.pass_score||"-"}),s.jsx("td",{children:A.description||"-"}),s.jsx("td",{children:A.room_name||"-"}),s.jsx("td",{children:A.time_slot||"-"}),s.jsx("td",{children:A.start_date||"-"}),s.jsx("td",{children:A.end_date||"-"}),s.jsx("td",{className:"text-center",children:T(A.hasError?"invalid":"valid")}),s.jsx("td",{children:A.errors.length>0&&s.jsx("small",{className:"text-danger",children:A.errors.length>1?`${A.errors[0]} (+${A.errors.length-1} more)`:A.errors[0]})}),s.jsx("td",{children:s.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{d(P=>P.filter(R=>R.id!==A.id))},children:s.jsx(mn,{size:14})})})]},A.id))})]})})})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:_,disabled:a,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),u.length>0&&s.jsx(P2,{placement:"top",overlay:s.jsxs(R2,{id:"import-tooltip",children:["Only ",u.filter(A=>!A.hasError).length,"/",u.length," subjects will be imported into DSFMS"]}),children:s.jsx(se,{variant:"primary",onClick:E,disabled:a||u.filter(A=>!A.hasError).length===0,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ts,{className:"me-2",size:16}),"Import All (",u.filter(A=>!A.hasError).length," subjects)"]})})})]})]})},hoe=({show:e,onClose:t,onSave:r,course:a,loading:n=!1})=>{const[i,l]=v.useState({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),[o,c]=v.useState({}),u=p=>{if(!p)return"";if(typeof p=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(p))return p;try{const h=new Date(p);return isNaN(h.getTime())?"":h.toISOString().split("T")[0]}catch{return""}};v.useEffect(()=>{e&&a?l({name:a.name||"",code:a.code||"",description:a.description||"",maxTrainees:a.maxNumTrainee||a.maxTrainees||"",venue:a.venue||"",note:a.note||"",passScore:a.passScore||"",startDate:u(a.startDate),endDate:u(a.endDate),level:a.level||"BEGINNER",status:a.status||"ACTIVE"}):e||(l({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),c({}))},[e,a]);const d=()=>{c({}),t()},m=p=>{const{name:h,value:g}=p.target;l(b=>({...b,[h]:g})),o[h]&&c(b=>({...b,[h]:""}))},f=()=>{const p={};if(i.name.trim()||(p.name="Course name is required"),i.code.trim()||(p.code="Course code is required"),i.description.trim()||(p.description="Description is required"),(!i.maxTrainees||isNaN(i.maxTrainees)||parseInt(i.maxTrainees)<=0)&&(p.maxTrainees="Max trainees must be a positive number"),i.venue.trim()||(p.venue="Venue is required"),(!i.passScore||isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&(p.passScore="Pass score must be between 0 and 100"),!i.startDate)p.startDate="Start date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(i.startDate)<h&&(p.startDate="Start date cannot be in the past")}return i.endDate||(p.endDate="End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&(p.endDate="End date must be after start date"),c(p),Object.keys(p).length===0},x=async p=>{if(p.preventDefault(),!!f())try{const h={name:i.name.trim(),description:i.description.trim(),code:i.code.trim(),maxNumTrainee:parseInt(i.maxTrainees),venue:i.venue.trim(),note:i.note.trim(),passScore:parseInt(i.passScore),startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString(),level:i.level},g=await Ce.put(`/courses/${a.id}`,h);te.success("Course updated successfully!"),r&&await r(g.data||h),d()}catch(h){const g=h.response?.data?.message||h.message||"Failed to update course";te.error(`Error: ${g}`)}};return s.jsxs(le,{show:e,onHide:d,size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(ts,{className:"me-2",size:20}),"Edit Course"]}),s.jsx(se,{variant:"link",onClick:d,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(I,{onSubmit:x,children:[s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(oe,{className:"mb-3",children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Course Name *"}),s.jsx(I.Control,{type:"text",name:"name",value:i.name,onChange:m,isInvalid:!!o.name,disabled:n}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.name})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Course Code *"}),s.jsx(I.Control,{type:"text",name:"code",value:i.code,onChange:m,isInvalid:!!o.code,disabled:n}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.code})]})})]}),s.jsxs(oe,{className:"mb-3",children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Max Trainees *"}),s.jsx(I.Control,{type:"number",name:"maxTrainees",value:i.maxTrainees,onChange:m,isInvalid:!!o.maxTrainees,disabled:n,min:"1"}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.maxTrainees})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Pass Score *"}),s.jsx(I.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,isInvalid:!!o.passScore,disabled:n,min:"0",max:"100"}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.passScore})]})})]}),s.jsx(oe,{className:"mb-3",children:s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Level"}),s.jsxs(I.Select,{name:"level",value:i.level,onChange:m,disabled:n,children:[s.jsx("option",{value:"BEGINNER",children:"Beginner"}),s.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),s.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})})}),s.jsxs(oe,{className:"mb-3",children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Start Date *"}),s.jsx(I.Control,{type:"date",name:"startDate",value:i.startDate,onChange:m,isInvalid:!!o.startDate,disabled:n}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.startDate})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"End Date *"}),s.jsx(I.Control,{type:"date",name:"endDate",value:i.endDate,onChange:m,isInvalid:!!o.endDate,disabled:n}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.endDate})]})})]}),s.jsx(oe,{className:"mb-3",children:s.jsx(U,{children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Venue *"}),s.jsx(I.Control,{type:"text",name:"venue",value:i.venue,onChange:m,isInvalid:!!o.venue,disabled:n}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.venue})]})})}),s.jsx(oe,{className:"mb-3",children:s.jsx(U,{children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Description *"}),s.jsx(I.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,isInvalid:!!o.description,disabled:n}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.description})]})})}),s.jsx(oe,{className:"mb-3",children:s.jsx(U,{children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Note"}),s.jsx(I.Control,{as:"textarea",rows:2,name:"note",value:i.note,onChange:m,disabled:n})]})})})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:d,disabled:n,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",type:"submit",disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),"Save Changes"]})})]})]})]})},poe=({show:e,onClose:t,courseId:r,onSuccess:a})=>{const[n,i]=v.useState([]),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState(null),[f,x]=v.useState(null);v.useEffect(()=>{e&&r?p():(i([]),m(null),x(null))},[e,r]);const p=async()=>{o(!0),x(null);try{const b=await Yr.getCourseEnrollmentBatches(r),j=b?.batches||b?.data?.batches||[];i(j)}catch(b){const j=b?.response?.data?.message||b?.message||"Failed to load batches";x(j),te.error(j)}finally{o(!1)}},h=async()=>{if(!d){te.error("Please select a batch to delete");return}if(!n.find(j=>j.batchCode===d)){te.error("Selected batch not found");return}u(!0);try{await Yr.deleteBatchEnrollments(r,d),te.success(`Successfully deleted all enrollments for batch "${d}"`),a&&a(),t()}catch(j){const y=j?.response?.data?.message||j?.message||"Failed to delete batch enrollments";te.error(y)}finally{u(!1)}},g=b=>{if(Object.values(b).reduce((w,N)=>w+N,0)===0)return s.jsx(Ne,{bg:"secondary",children:"No enrollments"});const y=b.ENROLLED+b.ON_GOING;return y>0?s.jsxs(Ne,{bg:"success",children:[y," Active"]}):s.jsx(Ne,{bg:"secondary",children:"All Cancelled"})};return s.jsxs(le,{show:e,onHide:t,size:"lg",centered:!0,children:[s.jsx(le.Header,{className:"bg-danger text-white border-0",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(mn,{className:"me-2",size:20}),"Delete All Subject Enrollments by Batch Code"]})}),s.jsx(le.Body,{className:"p-4",style:{minHeight:"400px",maxHeight:"500px",display:"flex",flexDirection:"column"},children:l?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading batches..."})]}):f?s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:f}),s.jsx(se,{variant:"outline-danger",size:"sm",onClick:p,children:"Try Again"})]}):n.length===0?s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-muted",children:"No batches found for this course."})}):s.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[s.jsxs(ke,{variant:"warning",className:"mb-3",style:{flexShrink:0},children:[s.jsx("strong",{children:"Warning:"})," This action will permanently delete all subject enrollments for the selected batch. This cannot be undone."]}),s.jsxs("div",{className:"mb-3",style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[s.jsx("h6",{className:"mb-3",style:{flexShrink:0},children:"Select a batch to delete:"}),s.jsx("div",{style:{flex:1,minHeight:0,overflowY:"auto"},children:s.jsxs(Yt,{hover:!0,responsive:!0,children:[s.jsx("thead",{className:"table-light",style:{position:"sticky",top:0,zIndex:10},children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"40px"}}),s.jsx("th",{children:"Batch Code"}),s.jsx("th",{children:"Trainees"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Subjects"}),s.jsx("th",{children:"Status"})]})}),s.jsx("tbody",{children:n.map(b=>s.jsxs("tr",{onClick:()=>m(b.batchCode),style:{cursor:"pointer",backgroundColor:d===b.batchCode?"#e7f3ff":"transparent"},children:[s.jsx("td",{children:s.jsx("input",{type:"radio",name:"batchSelection",checked:d===b.batchCode,onChange:()=>m(b.batchCode),onClick:j=>j.stopPropagation()})}),s.jsx("td",{children:s.jsx("strong",{children:b.batchCode})}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($r,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:b.totalTrainees})]})}),s.jsx("td",{children:s.jsx(Ne,{bg:"success",children:b.activeTrainees})}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:b.subjects?.length||0})]})}),s.jsx("td",{children:g(b.statusCounts)})]},b.batchCode))})]})})]}),s.jsx("div",{className:"mt-3 p-3 bg-light rounded",style:{minHeight:"120px",maxHeight:"180px",overflowY:"auto",flexShrink:0},children:d?s.jsxs(s.Fragment,{children:[s.jsx("h6",{className:"mb-2",children:"Selected Batch Details:"}),(()=>{const b=n.find(j=>j.batchCode===d);return b?s.jsxs("div",{children:[s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Batch Code:"})," ",b.batchCode]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Total Trainees:"})," ",b.totalTrainees," ","(",s.jsxs(Ne,{bg:"success",className:"ms-1",children:[b.activeTrainees," Active"]}),")"]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Subjects:"})," ",b.subjects?.length||0]}),b.subjects&&b.subjects.length>0&&s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Subject Details:"}),s.jsx("ul",{className:"mt-2 mb-0",children:b.subjects.map(j=>s.jsxs("li",{children:[j.subjectCode," - ",j.subjectName," ","(",j.activeTrainees,"/",j.totalTrainees," active)"]},j.subjectId))})]})]}):null})()]}):s.jsx("div",{className:"text-muted",style:{minHeight:"60px",display:"flex",alignItems:"center"},children:s.jsx("span",{children:"No batch selected"})})})]})}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:t,disabled:c,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"danger",onClick:h,disabled:!d||c||l||n.length===0,children:c?s.jsxs(s.Fragment,{children:[s.jsx(xt,{animation:"border",size:"sm",className:"me-2"}),"Deleting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(mn,{className:"me-2",size:16}),"Delete Enrollments"]})})]})]})},xoe=({course:e,department:t})=>{const r=Ge(),{courseId:a}=gr(),n=za(),[i,l]=v.useState(!1),[o,c]=v.useState(!1),[u,d]=v.useState(!1),[m,f]=v.useState(!1),[x,p]=v.useState(null),[h,g]=v.useState(!1),[b,j]=v.useState(!1),[y,w]=v.useState(null),[N,S]=v.useState(!1),[E,_]=v.useState(null),[T,C]=v.useState([]),[A,D]=v.useState(!0),P=k=>Array.isArray(k)?k.filter(O=>O?.status?.toUpperCase()!=="ARCHIVED"&&!O?.deletedAt):[],[R,M]=v.useState(()=>n.state?.activeTab?n.state.activeTab:"course-info");v.useEffect(()=>{n.state?.activeTab&&(M(n.state.activeTab),window.history.replaceState({},document.title))},[n.state]),v.useEffect(()=>{a&&(async()=>{if(a){D(!0);try{const O=await Yr.getCourseById(a);if(!O)throw new Error("Invalid API response");const G={id:O.id||a,name:O.name,code:O.code,description:O.description,maxTrainees:O.maxNumTrainee,maxNumTrainee:O.maxNumTrainee,venue:O.venue,note:O.note,passScore:O.passScore,startDate:O.startDate?new Date(O.startDate).toISOString().split("T")[0]:"",endDate:O.endDate?new Date(O.endDate).toISOString().split("T")[0]:"",level:O.level,status:O.status,department:O.department,subjectCount:O.subjectCount||0,traineeCount:O.traineeCount||0,trainerCount:O.trainerCount||0};_(G),O.subjects&&Array.isArray(O.subjects)?C(P(O.subjects)):O.subjectCount>0&&!O.subjects?C([]):C([]),D(!1)}catch{if(e&&e.id&&e.name){const O={id:e.id,name:e.name,code:e.code||"N/A",description:e.description||"Course information not available.",maxTrainees:e.maxNumTrainee||e.maxTrainees||50,maxNumTrainee:e.maxNumTrainee||e.maxTrainees||50,venue:e.venue||"N/A",note:e.note||"",passScore:e.passScore||80,startDate:e.startDate?typeof e.startDate=="string"?e.startDate.split("T")[0]:new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?typeof e.endDate=="string"?e.endDate.split("T")[0]:new Date(e.endDate).toISOString().split("T")[0]:"",level:e.level||"N/A",status:e.status||"ACTIVE",department:e.department||t,subjectCount:e.subjectCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0};_(O),C([])}else _(null),C([]);D(!1)}}})()},[a,e,t]);const X=()=>{t?.id?r(`/academic/course/${t.id}`):r("/academic/departments")};if(A)return s.jsx(_e,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!E)return s.jsx(_e,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h5",{className:"text-muted",children:"Course not found"}),s.jsx("p",{className:"text-muted",children:"The requested course could not be loaded."}),s.jsxs(se,{variant:"primary",onClick:X,children:[s.jsx(At,{className:"me-2"}),"Back to Department"]})]})});const ie=k=>{r(`/academic/course/${a}/subject/${k}`)},ae=()=>{},V=k=>{const O=T.find(G=>G.id===k);O&&(p(O),f(!0))},me=async()=>{if(x){g(!0);try{const k=await ws.archiveSubject(x.id),O=k?.message||k?.data?.message||`Successfully archived subject "${x.name}"`;te.success(O,{autoClose:3e3,position:"top-right",icon:!1});const G=await Yr.getCourseById(a);G.subjects&&Array.isArray(G.subjects)&&C(P(G.subjects)),f(!1),p(null)}catch(k){const O=k?.response?.data?.message||k?.message||"Failed to archive subject";te.error(`Error: ${O}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{g(!1)}}},ue=()=>{r(`/academic/course/${e.id}/enroll-trainees`)},F=async()=>{try{const k=await Yr.getCourseById(a);k.subjects&&Array.isArray(k.subjects)&&C(P(k.subjects))}catch(k){const O=k?.response?.data?.message||k?.message||"Failed to refresh subjects after creation";te.error(`Error: ${O}`,{autoClose:4e3,position:"top-right",icon:!1})}},Y=async k=>{const O=await ws.bulkImportSubjects(k),G=await Yr.getCourseById(a);return G.subjects&&Array.isArray(G.subjects)&&C(P(G.subjects)),c(!1),O},z=async k=>{try{await Yr.updateCourse(a,k);const O=await Yr.getCourseById(a),G={id:O.id||a,name:O.name,code:O.code,description:O.description,maxTrainees:O.maxNumTrainee,maxNumTrainee:O.maxNumTrainee,venue:O.venue,note:O.note,passScore:O.passScore,startDate:O.startDate?new Date(O.startDate).toISOString().split("T")[0]:"",endDate:O.endDate?new Date(O.endDate).toISOString().split("T")[0]:"",level:O.level,status:O.status,department:O.department,subjectCount:O.subjectCount||0,traineeCount:O.traineeCount||0,trainerCount:O.trainerCount||0,subjects:O.subjects||[]};_(G),d(!1)}catch{}};return s.jsxs(_e,{fluid:!0,className:"py-2 course-detail",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:X,className:"me-3",children:[s.jsx(At,{size:16,className:"me-1"}),"Back"]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"mb-0 text-primary",children:[s.jsx("strong",{children:e.name}),"  ",e.code]}),s.jsx("small",{className:"text-muted",children:"Course Details"})]})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("div",{className:"d-flex",children:s.jsxs(se,{size:"sm",variant:"primary",onClick:ue,children:[s.jsx($r,{size:14,className:"me-1"})," Enroll Trainees"]})}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(se,{size:"sm",variant:"outline-secondary",onClick:()=>d(!0),children:[s.jsx(ts,{size:14,className:"me-1"})," Edit Course"]}),s.jsx("div",{className:"vr",style:{height:"24px",margin:"0 8px"}}),s.jsxs(se,{size:"sm",variant:"primary",onClick:()=>l(!0),children:[s.jsx(Xr,{size:14,className:"me-1"})," Add Subject"]}),s.jsxs(se,{size:"sm",variant:"outline-primary",onClick:()=>c(!0),children:[s.jsx(Ts,{size:14,className:"me-1"})," Import Bulk Subjects"]}),s.jsxs(se,{size:"sm",variant:"outline-danger",onClick:()=>S(!0),children:[s.jsx(mn,{size:14,className:"me-1"})," Delete All Subject Enrollments In Course by BatchCode"]})]})]}),s.jsx(H,{className:"border-0 shadow-sm mb-2",children:s.jsxs(Vt.Container,{activeKey:R,onSelect:M,children:[s.jsx(H.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(pt,{variant:"tabs",className:"border-0",children:[s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"course-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:R==="course-info"?"600":"400",opacity:R==="course-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(It,{className:"me-2",size:16}),"Course Information"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:R==="subjects"?"600":"400",opacity:R==="subjects"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(vt,{className:"me-2",size:16}),"Subjects"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:R==="trainees"?"600":"400",opacity:R==="trainees"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx($r,{className:"me-2",size:16}),"Trainees Roster"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"assessment-events",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:R==="assessment-events"?"600":"400",opacity:R==="assessment-events"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Ra,{className:"me-2",size:16}),"All Related Assessment Events"]})})]})}),s.jsx(H.Body,{className:"p-0",children:s.jsxs(Vt.Content,{children:[s.jsx(Vt.Pane,{eventKey:"course-info",children:s.jsxs("div",{className:"p-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-3",style:{color:"#1b3c53",fontWeight:"800",fontSize:"1.3rem",letterSpacing:"0.5px",textTransform:"uppercase",borderBottom:"2px solid #d2c1b6",paddingBottom:"0.5rem"},children:"Description"}),s.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.95rem"},children:E.description})]})})}),s.jsxs(oe,{className:"g-4",children:[s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Name"}),s.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:E.name})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Code"}),s.jsx(Ne,{bg:"secondary",className:"px-2 py-1",children:E.code})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Level"}),s.jsx(Ne,{bg:"info",className:"px-2 py-1",children:E.level})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Start Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.startDate||"N/A"})]})]})]}),s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Max Number of Trainees"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ia,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.maxTrainees})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Venue"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ll,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.venue})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Pass Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(M2,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.passScore})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Status"}),s.jsx(Ne,{bg:E.status==="ACTIVE"?"success":E.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",children:E.status})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"End Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:E.endDate||"N/A"})]})]})]})]})]})}),s.jsx(Vt.Pane,{eventKey:"subjects",children:s.jsx(ooe,{subjects:T,loading:!1,onView:ie,onEdit:ae,onDelete:V})}),s.jsx(Vt.Pane,{eventKey:"trainees",style:{height:"100%"},children:s.jsx(uoe,{courseId:a,loading:!1,title:"Trainees Roster"})}),s.jsx(Vt.Pane,{eventKey:"assessment-events",style:{height:"100%"},children:s.jsx(k4,{courseId:a,onView:k=>{w(k),j(!0)}})})]})})]})}),s.jsx(moe,{show:i,onClose:()=>l(!1),onSave:F,courseId:a}),s.jsx(foe,{show:o,onClose:()=>c(!1),onImport:Y,courseId:a}),s.jsx(hoe,{show:u,onClose:()=>d(!1),onSave:z,course:E||e}),s.jsx(_4,{show:m,onClose:()=>{f(!1),p(null)},onDisable:me,subject:x,loading:h}),s.jsx(B1,{show:b,onClose:()=>{j(!1),w(null)},event:y}),s.jsx(poe,{show:N,onClose:()=>S(!1),courseId:a,onSuccess:()=>{}})]})},goe=()=>{const{courseId:e}=gr(),t=za(),[r,a]=v.useState(null),[n,i]=v.useState(null),[l,o]=v.useState(!0);return v.useEffect(()=>{e&&(async()=>{try{o(!0);try{const u=await Yr.getCourseById(e);a(u),u.department&&i(u.department)}catch{const d={id:e,name:"Course Details",code:"COURSE-001",description:"Course information will be loaded from department data",status:"ACTIVE",startDate:"2026-01-12",endDate:"2026-01-26",venue:"Training Room",maxNumTrainee:16,passScore:80,level:"INTERMEDIATE"},m={id:t.state?.departmentId||null,name:t.state?.departmentName||"Default Department"};a(d),i(m)}o(!1)}catch{o(!1)}})()},[e]),l?s.jsx(_e,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):r?s.jsx(_e,{className:"py-3",children:s.jsx(xoe,{course:r,department:n})}):s.jsx(_e,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Course not found"}),s.jsx("p",{children:"The requested course could not be found."})]})})},voe=({selectedSubjects:e,onSelectionChange:t})=>{const[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!0),[c,u]=v.useState(null),d=h=>Array.isArray(h)?h.filter(g=>g?.status?.toUpperCase()!=="ARCHIVED"&&!g?.deletedAt):[];v.useEffect(()=>{(async()=>{try{o(!0),u(null);const g=await ws.getSubjects();if(g&&g.subjects){const j=d(g.subjects).map(y=>({id:y.id,name:y.name,code:y.code}));i(j)}else i([])}catch{u("Failed to load subjects"),i([])}finally{o(!1)}})()},[]);const m=n.filter(h=>h.name.toLowerCase().includes(r.toLowerCase())||h.code.toLowerCase().includes(r.toLowerCase())),f=()=>{e.length===m.length?t([]):t(m.map(h=>h.id))},x=h=>{e.includes(h)?t(e.filter(g=>g!==h)):t([...e,h])},p=m.length>0&&e.length===m.length;return s.jsxs(H,{className:"d-flex flex-column h-100 subject-selection-panel-card",style:{border:"1px solid #e9ecef",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",overflow:"visible",marginBottom:"2rem"},children:[s.jsx(H.Header,{className:"bg-gradient-primary-custom text-white border-0",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("h6",{className:"mb-0 text-white",children:"Select Subjects"}),s.jsx(se,{variant:"outline-light",size:"sm",onClick:f,children:p?"Deselect All":"Select All"})]})}),s.jsxs(H.Body,{className:"p-0 d-flex flex-column subject-selection-panel-body",style:{height:"500px",minHeight:0,display:"flex",flexDirection:"column"},children:[s.jsx("div",{className:"p-2 border-bottom flex-shrink-0",children:s.jsx(I.Control,{type:"text",placeholder:"Search subjects...",value:r,onChange:h=>a(h.target.value),size:"sm"})}),s.jsx("div",{className:"subject-list-scroll-container",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,maxHeight:"100%"},children:l?s.jsxs("div",{className:"p-3 text-center",children:[s.jsx(xt,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"text-muted",children:"Loading subjects..."})]}):c?s.jsx("div",{className:"p-3 text-center text-danger",children:s.jsx("p",{className:"mb-0",children:c})}):m.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No subjects found"})}):m.map(h=>s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>x(h.id),children:[s.jsx("div",{className:"me-3 flex-shrink-0",children:e.includes(h.id)?s.jsx(U2,{size:20,className:"text-primary"}):s.jsx(oS,{size:20,className:"text-muted"})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:h.name,children:h.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:h.code,children:h.code})]})]},h.id))}),s.jsx("div",{className:"p-2 bg-light border-top flex-shrink-0",children:s.jsxs("small",{className:"text-muted",children:[e.length," of ",m.length," subjects selected"]})})]})]})},boe=({selectedTrainees:e,onSelectionChange:t})=>{const[r,a]=v.useState(""),[n,i]=v.useState(!1),[l,o]=v.useState([]),[c,u]=v.useState(!1),[d,m]=v.useState(null),[f,x]=v.useState(null),p=v.useRef(null);v.useEffect(()=>{h()},[]),v.useEffect(()=>{const y=w=>{p.current&&!p.current.contains(w.target)&&i(!1)};return n&&document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[n]);const h=async()=>{u(!0),m(null);try{const y=await Jd.getTraineesForEnrollment();let w=[];y&&y.data&&(y.data.users&&Array.isArray(y.data.users)?w=y.data.users:y.data.data&&Array.isArray(y.data.data)?w=y.data.data:Array.isArray(y.data)&&(w=y.data));const N=w.map(S=>{let E=S.fullName||"",_=S.firstName||"",T=S.lastName||"";return!E&&(_||T)&&(E=`${_} ${T}`.trim()),{id:S.id,eid:S.eid,name:E||S.eid,firstName:_,lastName:T,email:S.email,status:S.status||"ACTIVE",departmentId:S.departmentId,departmentName:S.departmentName}});o(N)}catch(y){console.error("Error loading trainees:",y),m("Failed to load trainees"),o([])}finally{u(!1)}},g=l.filter(y=>y.name.toLowerCase().includes(r.toLowerCase())||y.eid.toLowerCase().includes(r.toLowerCase()));v.useEffect(()=>{r.trim().length>0&&i(!0)},[r]);const b=y=>{e.find(w=>w.id===y.id)||(t([...e,y]),x(y.id),setTimeout(()=>{x(null)},2e3))},j=y=>{t(e.filter(w=>w.id!==y))};return s.jsxs(H,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",overflow:"hidden",marginBottom:"2rem"},children:[s.jsx(H.Header,{className:"bg-gradient-primary-custom text-white border-0",children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsx("h6",{className:"mb-0 text-white",children:"Add Trainees"})})}),s.jsxs(H.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[s.jsxs("div",{className:"flex-shrink-0",style:{position:"relative",paddingBottom:"1rem"},ref:p,children:[s.jsx("div",{className:"p-2 border-bottom",children:s.jsx(I.Control,{type:"text",placeholder:"Search by EID or name...",value:r,onChange:y=>a(y.target.value),size:"sm"})}),s.jsx("div",{className:"p-2",children:s.jsxs(se,{variant:"outline-primary",className:"w-100 d-flex align-items-center justify-content-between",size:"sm",onClick:()=>i(!n),disabled:c,children:[s.jsxs("span",{children:[s.jsx($r,{className:"me-2",size:16}),c?"Loading...":r.trim().length>0?`Available Trainees (${g.length})`:`Show All Available Trainees (${l.length})`]}),s.jsx(ni,{size:16})]})}),n&&s.jsx("div",{className:"border bg-white",style:{position:"absolute",top:"calc(100% + 8px)",left:0,right:0,zIndex:1050,maxHeight:"350px",overflowY:"auto",borderRadius:"8px",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.15), 0 4px 8px rgba(0, 0, 0, 0.1)"},children:c?s.jsxs("div",{className:"p-3 text-center",children:[s.jsx(xt,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"text-muted",children:"Loading trainees..."})]}):d?s.jsxs("div",{className:"p-3 text-center text-danger",children:[s.jsx("p",{className:"mb-0",children:d}),s.jsx(se,{size:"sm",variant:"outline-danger",onClick:h,className:"mt-2",children:"Retry"})]}):g.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No trainees found"})}):g.map(y=>{const w=e.find(N=>N.id===y.id);return s.jsxs("div",{className:`p-2 border-bottom d-flex align-items-center justify-content-between ${w?"bg-success bg-opacity-10":"hover-bg-light"}`,style:{cursor:w?"not-allowed":"pointer",minWidth:0,transition:"all 0.3s ease",opacity:w?.6:1},onClick:()=>!w&&b(y),children:[s.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:y.name,children:y.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:y.eid,children:y.eid})]}),w?s.jsx(Je,{size:16,className:"text-success flex-shrink-0"}):s.jsx(Xr,{size:14,className:"text-primary flex-shrink-0"})]},y.id)})})]}),s.jsxs("div",{className:"border-top flex-grow-1 d-flex flex-column",style:{minHeight:0,marginTop:"1rem"},children:[s.jsx("div",{className:"p-2 bg-gradient-primary-custom text-white border-bottom",children:s.jsxs("small",{className:"text-white fw-semibold",children:["Selected Trainees (",e.length,")"]})}),s.jsx("div",{style:{overflowY:"auto",flex:1,minHeight:0},children:e.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No trainees selected"})}):e.map(y=>{const w=f===y.id;return s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between",style:{minWidth:0,backgroundColor:w?"rgba(40, 167, 69, 0.1)":"transparent",animation:w?"slideInRight 0.5s ease-out, highlightPulse 0.5s ease-out":"none",transition:"background-color 0.3s ease"},children:[s.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:y.name,children:y.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:y.eid,children:y.eid})]}),s.jsx(se,{size:"sm",variant:"outline-danger",className:"flex-shrink-0",onClick:()=>j(y.id),children:s.jsx(Xe,{size:14})})]},y.id)})})]})]})]})},yoe=({show:e,onClose:t,onImport:r,loading:a=!1})=>{const[n,i]=v.useState(!1),[l,o]=v.useState(null),[c,u]=v.useState([]),[d,m]=v.useState(null),[f,x]=v.useState([]),[p,h]=v.useState([]),[g,b]=v.useState([]),[j,y]=v.useState(!1),w=v.useRef(null),N=["eid","email"],S=ae=>{ae.preventDefault(),ae.stopPropagation(),ae.type==="dragenter"||ae.type==="dragover"?i(!0):ae.type==="dragleave"&&i(!1)},E=ae=>{ae.preventDefault(),ae.stopPropagation(),i(!1),ae.dataTransfer.files&&ae.dataTransfer.files[0]&&T(ae.dataTransfer.files[0])},_=ae=>{ae.target.files&&ae.target.files[0]&&T(ae.target.files[0])},T=ae=>{if(!ae.name.match(/\.(xlsx|xls)$/)){h(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(ae.size>100*1024*1024){h(["File size must be less than 100MB"]);return}o(ae),h([]),C(ae)},C=ae=>{const V=new FileReader;V.onload=me=>{try{const ue=new Uint8Array(me.target.result),F=uc(ue,{type:"array"}),Y=F.SheetNames[0],z=F.Sheets[Y],k=Oa.sheet_to_json(z,{header:1});if(k.length<2){h(["Excel file must contain at least a header row and one data row"]);return}const O=k[0].map(Ee=>Ee?.toString().toLowerCase().trim()),G=k.slice(1),Z=N.filter(Ee=>!O.includes(Ee));if(Z.length>0){h([`Missing required columns: ${Z.join(", ")}`]);return}const de=G.map((Ee,B)=>{const Se=Ee[O.indexOf("eid")]?.toString().trim()||"",Re=Ee[O.indexOf("email")]?.toString().trim()||"";return{id:`temp_${B}`,rowNumber:B+2,eid:Se,email:Re,hasError:!1,errors:[]}}).filter(Ee=>Ee.eid||Ee.email).map(Ee=>(Ee.eid||(Ee.hasError=!0,Ee.errors.push("EID is required")),Ee.email?/\S+@\S+\.\S+/.test(Ee.email)||(Ee.hasError=!0,Ee.errors.push("Email format is invalid")):(Ee.hasError=!0,Ee.errors.push("Email is required")),Ee));u(de),b([])}catch{h(["Failed to parse Excel file. Please check the file format."])}},V.readAsArrayBuffer(ae)},A=async()=>{const ae=c.filter(V=>!V.hasError);if(ae.length===0){h(["No valid identifiers to lookup"]);return}y(!0),h([]);try{const V=ae.map(k=>({eid:k.eid,email:k.email}));console.log("Sending lookup request with identifiers:",V);const me=await Jd.lookupTrainees(V);console.log("Lookup response:",me),console.log("Found users:",me.foundUsers),console.log("Not found:",me.notFoundIdentifiers),me.foundUsers&&me.foundUsers.length>0&&(console.log(" First found user structure:",me.foundUsers[0]),console.log(" All found user IDs:",me.foundUsers.map(k=>({id:k.id,eid:k.eid,email:k.email}))));const ue=(me.foundUsers||[]).filter(k=>V.some(O=>O.eid===k.eid&&O.email===k.email)),F=V.filter(k=>!ue.some(O=>O.eid===k.eid&&O.email===k.email)),Y=ue.map(k=>{if(console.log(" Validating trainee:",{id:k.id,eid:k.eid,email:k.email,firstName:k.firstName,lastName:k.lastName}),!k.id||typeof k.id!="string"||k.id.length<10)throw new Error(`Trainee ${k.eid} has invalid UUID: ${k.id}`);if(!k.firstName||!k.lastName)throw new Error(`Trainee ${k.eid} has missing name fields`);return k}),z={foundUsers:Y,notFoundIdentifiers:F,uploadedIdentifiers:V};console.log("Exact matches found:",Y),console.log("Not found identifiers:",F),m(z),x(Y),console.log("Set selected trainees (exact matches only):",Y)}catch(V){console.error("Lookup error:",V),console.error("Error response:",V.response?.data),h([V.response?.data?.message||V.message||"Failed to lookup trainees. Please try again."])}finally{y(!1)}},D=(ae,V)=>{x(V?me=>[...me,ae]:me=>me.filter(ue=>ue.id!==ae.id))},P=ae=>{x(ae?d?.foundUsers||[]:[])},R=async()=>{if(f.length===0){h(["Please select at least one trainee to import"]);return}try{r&&await r(f),M()}catch(ae){h([ae.message||"Failed to import selected trainees. Please try again."])}},M=()=>{o(null),u([]),m(null),x([]),h([]),b([]),i(!1),y(!1),t()},X=ae=>ae==="valid"?s.jsx(Je,{className:"text-success",size:16}):s.jsx(fs,{className:"text-danger",size:16}),ie=()=>{const ae=[["eid","email"],["TE000001","john.doe@example.com"],["TE000002","trollergamehuydk+7@gmail.com"],["TE000003","bob.johnson@example.com"],["TE000004","alice.brown@example.com"],["TE000005","charlie.wilson@example.com"]],V=Oa.book_new(),me=Oa.aoa_to_sheet(ae);me["!cols"]=[{wch:15},{wch:30}],Oa.book_append_sheet(V,me,"Trainees Lookup Template"),Mg(V,"Trainees_Lookup_Template.xlsx")};return s.jsxs(le,{show:e,onHide:M,size:"xl",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Ts,{className:"me-2",size:20}),"Bulk Import Trainees"]}),s.jsx(se,{variant:"link",onClick:M,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[p.length>0&&s.jsx(ke,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:p.map((ae,V)=>s.jsx("li",{children:ae},V))})}),s.jsx(H,{className:"mb-4",children:s.jsxs(H.Body,{children:[s.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:S,onDragLeave:S,onDragOver:S,onDrop:E,onClick:()=>w.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Rl,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",onChange:_,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Required columns:"})," eid, email"]}),s.jsx("div",{className:"mt-1",children:s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:ie,className:"d-flex align-items-center",children:[s.jsx(Ln,{className:"me-1",size:14}),"Download Template"]})})]}),l&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Rl,{className:"text-success me-2",size:16}),s.jsx("span",{className:"text-success fw-semibold",children:l.name})]})]})]})}),c.length>0&&s.jsxs(H,{className:"mb-4",children:[s.jsx(H.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),s.jsx(H.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(Yt,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"800px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"150px"},children:"EID"}),s.jsx("th",{style:{minWidth:"250px"},children:"EMAIL"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"300px"},children:"ERROR ENCOUNTERED"})]})}),s.jsx("tbody",{children:c.map(ae=>s.jsxs("tr",{className:ae.hasError?"table-danger":"",children:[s.jsx("td",{children:ae.rowNumber||ae.id}),s.jsx("td",{children:ae.eid||"-"}),s.jsx("td",{children:ae.email||"-"}),s.jsx("td",{className:"text-center",children:X(ae.hasError?"invalid":"valid")}),s.jsx("td",{children:ae.errors.length>0&&s.jsx("small",{className:"text-danger",children:ae.errors.length>1?`${ae.errors[0]} (+${ae.errors.length-1} more)`:ae.errors[0]})})]},ae.id))})]})})}),s.jsx(H.Footer,{className:"bg-light",children:s.jsx(se,{variant:"primary",onClick:A,disabled:j||c.filter(ae=>!ae.hasError).length===0,className:"d-flex align-items-center",children:j?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Looking up..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Gx,{className:"me-2",size:16}),"Lookup Existing Trainees (",c.filter(ae=>!ae.hasError).length," valid)"]})})})]}),d&&s.jsxs(H,{children:[s.jsx(H.Header,{className:"bg-light",children:s.jsxs("h6",{className:"mb-0",children:["Matched Trainees from Excel",s.jsxs("span",{className:"ms-2",children:[s.jsx(Je,{className:"text-success me-1",size:16}),d.foundUsers?.length||0," matched",s.jsx(fs,{className:"text-danger ms-2 me-1",size:16}),d.notFoundIdentifiers?.length||0," not found"]})]})}),s.jsx(H.Body,{className:"p-0",children:d.foundUsers?.length>0?s.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:s.jsxs(Yt,{hover:!0,className:"mb-0",children:[s.jsx("thead",{className:"bg-light sticky-top",children:s.jsxs("tr",{children:[s.jsx("th",{children:s.jsx(I.Check,{type:"checkbox",checked:f.length===(d.foundUsers?.length||0)&&(d.foundUsers?.length||0)>0,onChange:ae=>P(ae.target.checked)})}),s.jsx("th",{children:"EID"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Phone"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Matched From Excel"})]})}),s.jsx("tbody",{children:d.foundUsers?.map(ae=>d.uploadedIdentifiers?.find(me=>me.eid===ae.eid&&me.email===ae.email)?s.jsxs("tr",{className:f.some(me=>me.id===ae.id)?"table-success":"",children:[s.jsx("td",{children:s.jsx(I.Check,{type:"checkbox",checked:f.some(me=>me.id===ae.id),onChange:me=>D(ae,me.target.checked)})}),s.jsx("td",{children:ae.eid}),s.jsxs("td",{children:[ae.firstName," ",ae.lastName]}),s.jsx("td",{children:ae.email}),s.jsx("td",{children:ae.phoneNumber}),s.jsx("td",{children:s.jsx(Ne,{bg:ae.status==="ACTIVE"?"success":"secondary",children:ae.status})}),s.jsx("td",{children:s.jsx(Ne,{bg:"success",children:" Exact Match"})})]},ae.id):null).filter(Boolean)})]})}):s.jsxs("div",{className:"p-4 text-center",children:[s.jsx(fs,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No matching trainees found"}),s.jsx("p",{className:"text-muted mb-0",children:"None of the uploaded identifiers match existing trainees with TRAINEE role in the system."})]})}),d.notFoundIdentifiers?.length>0&&s.jsx(H.Footer,{className:"bg-warning bg-opacity-10",children:s.jsxs(ke,{variant:"warning",className:"mb-0",children:[s.jsxs("strong",{children:["Identifiers Not Found in System (",d.notFoundIdentifiers.length,"):"]}),s.jsx("p",{className:"mb-2 mt-2",children:"These identifiers from your Excel file do not exist in the system:"}),s.jsx("ul",{className:"mb-0",children:d.notFoundIdentifiers.map((ae,V)=>s.jsxs("li",{children:[s.jsx("strong",{children:ae.eid})," - ",ae.email]},V))})]})})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:M,disabled:a,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),d&&d.foundUsers?.length>0&&f.length>0&&s.jsx(se,{variant:"primary",onClick:R,disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ts,{className:"me-2",size:16}),"Import Selected (",f.length," matched trainees)"]})})]})]})},joe=({show:e,onClose:t,onConfirm:r,loading:a=!1})=>{const[n,i]=v.useState(""),[l,o]=v.useState("");v.useEffect(()=>{e&&(i(""),o(""))},[e]);const c=f=>!f||f.trim()===""?"Batch code is required":f.length<3?"Batch code must be at least 3 characters long":f.length>20?"Batch code must be no more than 20 characters long":/[^a-zA-Z0-9_]/.test(f)?"Batch code can only contain letters, numbers, and underscores":null,u=f=>{const x=f.target.value;i(x),l&&o("")},d=()=>{const f=c(n);if(f){o(f);return}r(n.trim())},m=f=>{f.key==="Enter"&&(f.preventDefault(),d())};return s.jsxs(le,{show:e,onHide:t,centered:!0,backdrop:"static",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsxs(le.Title,{children:[s.jsx(Er,{className:"me-2 text-warning",size:20}),"Enter Batch Code"]})}),s.jsxs(le.Body,{children:[s.jsx(I,{children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{children:["Batch Code ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"Enter batch code (e.g., SAF0012025, CCT_BATCH_01)",value:n,onChange:u,onKeyPress:m,isInvalid:!!l,disabled:a,autoFocus:!0}),s.jsx(I.Text,{className:"text-muted",children:"Only letters, numbers, and underscores are allowed. 3-20 characters."}),l&&s.jsx(I.Control.Feedback,{type:"invalid",children:l})]})}),s.jsx(ke,{variant:"info",className:"mb-0",children:s.jsxs("small",{children:[s.jsx("strong",{children:"Note:"})," This batch code will be used to identify the enrollment group. Make sure it's unique and descriptive for your course."]})})]}),s.jsxs(le.Footer,{children:[s.jsx(se,{variant:"secondary",onClick:t,disabled:a,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:d,disabled:a||!n.trim(),children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Enrolling..."]}):"Confirm & Enroll"})]})]})},w2=()=>{const e=Ge(),{courseId:t}=gr(),r={name:"Safety Procedures",code:"SAF001",description:"Basic safety procedures training course"},[a,n]=v.useState([]),[i,l]=v.useState([]),[o,c]=v.useState(!1),[u,d]=v.useState(!1),[m,f]=v.useState(!1),[x,p]=v.useState(!1),[h,g]=v.useState({});v.useEffect(()=>{(async()=>{try{const E=await ws.getSubjects();if(E&&E.subjects){const _={};E.subjects.forEach(T=>{_[T.id]={name:T.name,code:T.code}}),g(_)}}catch{}})()},[]);const b=()=>{e(he.ACADEMIC_COURSE_DETAIL(t))},j=()=>{c(!0)},y=async S=>{if(!m){f(!0);try{const E=S.map(_=>({id:_.id,eid:_.eid,name:`${_.firstName} ${_.lastName}`.trim(),firstName:_.firstName,lastName:_.lastName,email:_.email,phoneNumber:_.phoneNumber,status:_.status,subjects:[]}));l(_=>{const T=new Set(_.map(A=>A.id)),C=E.filter(A=>!T.has(A.id));return C.length===0&&E.length>0?setTimeout(()=>{te.error("All selected trainees are already in the list!",{autoClose:3e3,position:"top-right",toastId:"duplicate-trainees",closeButton:!1})},100):C.length<E.length&&C.length>0?setTimeout(()=>{te.warning(`Added ${C.length} new trainees. ${E.length-C.length} were already selected.`,{autoClose:4e3,position:"top-right",toastId:"partial-duplicates",closeButton:!1})},100):C.length===E.length&&C.length>0&&setTimeout(()=>{te.success(`Successfully added ${C.length} trainee${C.length>1?"s":""} to the selection!`,{autoClose:3e3,position:"top-right",toastId:"bulk-import-success",closeButton:!1})},100),[..._,...C]}),await new Promise(_=>setTimeout(_,1e3))}catch(E){throw E}finally{f(!1)}}},w=()=>{if(a.length===0||i.length===0){te.warning("Please select both subjects and trainees to enroll");return}d(!0)},N=async S=>{p(!0),d(!1);try{const E=i.map(P=>{if(!P.id)throw new Error(`Trainee ${P.eid} (${P.firstName} ${P.lastName}) is missing UUID`);return P.id}),_={batchCode:String(S).trim(),traineeUserIds:E},T=a.map(async P=>{if(!P){const R=h[P]||{name:"Unknown",code:"N/A"};throw new Error(`Invalid subject ID: ${P} (${R.name})`)}try{const R=await ws.assignTrainees(P,_);return{subjectId:P,response:R,status:"success",subjectName:h[P]?.name||"Unknown Subject",subjectCode:h[P]?.code||"N/A"}}catch(R){const M=h[P]||{name:"Unknown Subject",code:"N/A"};return{subjectId:P,status:"error",error:R,subjectName:M.name,subjectCode:M.code,errorMessage:R.response?.data?.message||R.message||"Unknown error",errorDetails:R.response?.data}}}),C=await Promise.allSettled(T),A=[],D=[];if(C.forEach((P,R)=>{if(P.status==="fulfilled"){const M=P.value;M.status==="success"?A.push(M):D.push(M)}else{const M=a[R],X=h[M]||{name:"Unknown Subject",code:"N/A"};D.push({subjectId:M,status:"error",subjectName:X.name,subjectCode:X.code,errorMessage:P.reason?.message||"Unknown error",errorDetails:P.reason})}}),D.length>0&&D.forEach(P=>{const R=P.errorMessage||"Unknown error",M=`${P.subjectName} (${P.subjectCode})`;let X=R;P.errorDetails?.message?X=P.errorDetails.message:P.errorDetails?.errors&&Array.isArray(P.errorDetails.errors)&&(X=P.errorDetails.errors.map(ie=>ie.message||ie).join(", ")),te.error(`${M}: ${X}`,{autoClose:5e3,position:"top-right",icon:!1})}),A.length>0){const P=i.length;if(te.success(`Successfully enrolled ${P} trainee(s) to ${A.length} subject(s): ${A.map(R=>R.subjectName).join(", ")}`,{autoClose:4e3,position:"top-right",icon:!1}),D.length===0)l([]),n([]);else{const R=new Set(A.map(M=>M.subjectId));n(M=>M.filter(X=>!R.has(X)))}setTimeout(()=>{e(he.ACADEMIC_COURSE_DETAIL(t),{state:{activeTab:"trainees"}})},1e3)}}catch(E){let _="Failed to enroll trainees. Please try again.";E.response?.data?.message?_=E.response.data.message:E.message&&(_=E.message),te.error(_)}finally{p(!1)}};return s.jsxs(_e,{fluid:!0,className:"py-4 px-4 enroll-page",style:{minHeight:"100%",display:"flex",flexDirection:"column"},children:[s.jsxs("div",{className:"mb-4 flex-shrink-0",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:b,className:"me-3",children:[s.jsx(At,{size:16,className:"me-1"}),"Back"]}),s.jsx("div",{children:s.jsxs("h5",{className:"mb-0 text-primary",children:["Enroll Trainees - ",s.jsx("strong",{children:r.name})," (",r.code,")"]})})]}),s.jsx(H,{className:"mb-4",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:s.jsx(H.Body,{className:"py-4 px-4",children:s.jsxs(oe,{children:[s.jsx(U,{md:8,children:s.jsx("p",{className:"mb-0 text-muted",children:r.description})}),s.jsxs(U,{md:4,className:"text-end d-flex justify-content-end align-items-center gap-2",children:[s.jsx(se,{size:"sm",variant:"primary",onClick:w,disabled:a.length===0||i.length===0||x,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:x?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true",style:{width:"0.5rem",height:"0.5rem"}}),"Enrolling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Xr,{size:12,className:"me-1"})," Enroll"]})}),s.jsxs(se,{size:"sm",variant:"outline-primary",onClick:j,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[s.jsx(Ts,{size:12,className:"me-1"})," Bulk Import Trainees"]})]})]})})})]}),s.jsx("div",{className:"mb-4 flex-shrink-0 main-content-section",style:{position:"relative",zIndex:1,marginBottom:"3rem"},children:s.jsxs(oe,{className:"g-4",children:[s.jsx(U,{lg:6,children:s.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"visible",marginBottom:"2rem"},children:s.jsx(voe,{selectedSubjects:a,onSelectionChange:n})})}),s.jsx(U,{lg:6,children:s.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"visible",marginBottom:"2rem"},children:s.jsx(boe,{selectedTrainees:i,onSelectionChange:l})})})]})}),s.jsx(yoe,{show:o,onClose:()=>c(!1),onImport:y,loading:m}),s.jsx(joe,{show:u,onClose:()=>d(!1),onConfirm:N,loading:x})]})},woe=({assessmentEvents:e=[],loading:t=!1,onView:r,onUpdate:a})=>{const{sortedData:n,sortConfig:i,handleSort:l}=ur(e);if(t)return s.jsx(zt,{rows:4,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No assessment events found"}),s.jsx("p",{children:"There are no assessment events available."})]})});const o=({columnKey:d,children:m,className:f=""})=>{const x=i.key===d,p=x?i.direction:null;return s.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>l(d),onMouseEnter:h=>{h.target.style.backgroundColor="#214760",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="var(--bs-primary)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:p,size:14,color:"white"})})]}),x&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})},c=d=>{switch(String(d||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},u=d=>{if(!d)return"-";try{return new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}};return s.jsx("div",{className:"table-responsive",children:s.jsxs(Yt,{hover:!0,striped:!0,bordered:!0,className:"mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx(o,{columnKey:"name",children:"Name"}),s.jsx(o,{columnKey:"subject",children:"Subject"}),s.jsx(o,{columnKey:"course",children:"Course"}),s.jsx(o,{columnKey:"occurrenceDate",children:"Occurrence Date"}),s.jsx(o,{columnKey:"status",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:n.map((d,m)=>s.jsxs("tr",{style:{transition:"all 0.2s ease"},onMouseEnter:f=>{f.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:f=>{f.currentTarget.style.backgroundColor=""},children:[s.jsx("td",{className:"align-middle",children:s.jsx("span",{className:"fw-medium",children:d.name||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:d.subject||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:d.course||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:u(d.occurrenceDate)})}),s.jsx("td",{className:"align-middle",children:s.jsx(Ne,{bg:c(d.status),className:"px-3 py-2",children:d.status||"-"})}),s.jsx("td",{className:"align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>r&&r(d.originalEvent||d)},{label:"Update",icon:s.jsx(ts,{}),onClick:()=>a&&a(d.originalEvent||d)}]})})]},d.id||m))})]})})},Noe=({show:e,onClose:t,onSave:r,event:a,loading:n=!1})=>{const[i,l]=v.useState({name:"",occuranceDate:""}),[o,c]=v.useState({}),[u,d]=v.useState(!1),m=g=>{if(!g)return"";if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g))return g;try{const b=new Date(g);return isNaN(b.getTime())?"":b.toISOString().split("T")[0]}catch{return""}};v.useEffect(()=>{e&&a?l({name:a.name||"",occuranceDate:m(a.occuranceDate||a.occurrenceDate)}):e||(l({name:"",occuranceDate:""}),c({}))},[e,a]);const f=()=>{c({}),d(!1),t()},x=g=>{const{name:b,value:j}=g.target;l(y=>({...y,[b]:j})),o[b]&&c(y=>({...y,[b]:""}))},p=()=>{const g={};if((!i.name||i.name.trim()==="")&&(g.name="Event name is required"),!i.occuranceDate)g.occuranceDate="Occurrence date is required";else{const b=new Date(i.occuranceDate),j=new Date;j.setHours(0,0,0,0),b<j&&(g.occuranceDate="Occurrence date cannot be in the past")}return c(g),Object.keys(g).length===0},h=async g=>{if(g.preventDefault(),!!p()){if(!a){te.error("Event data is missing");return}d(!0);try{const[b,j,y]=i.occuranceDate.split("-").map(Number),N=new Date(Date.UTC(b,j-1,y,0,0,0,0)).toISOString(),S=a.occuranceDate||a.occurrenceDate,E=m(S),_={name:a.name,occuranceDate:E,templateId:a.templateInfo?.id||""};a.subjectId===null&&a.courseId?_.courseId=a.courseId:a.subjectId&&(_.subjectId=a.subjectId);const T={name:i.name,occuranceDate:N};console.log("Update Assessment Event - Request:",{params:_,body:T,isoDateString:N}),await Za.updateAssessmentEvent(_,T),te.success("Assessment event updated successfully"),r&&r(),f()}catch(b){console.error("Error updating assessment event:",b);const j=b.response?.data?.message||b.message||"Failed to update assessment event";te.error(j)}finally{d(!1)}}};return a?s.jsxs(le,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[s.jsxs(le.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(ts,{className:"me-2",size:20}),"Update Assessment Event"]}),s.jsx(se,{variant:"link",onClick:f,className:"text-white p-0 ms-auto",style:{border:"none",background:"none",opacity:.9},disabled:u,children:s.jsx(Xe,{size:24,color:"#ffffff"})})]}),s.jsxs(I,{onSubmit:h,children:[s.jsxs(le.Body,{className:"p-4",children:[s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Event Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",name:"name",value:i.name,onChange:x,isInvalid:!!o.name,placeholder:"Enter event name",disabled:u||n}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.name})]})})}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Occurrence Date ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"date",name:"occuranceDate",value:i.occuranceDate,onChange:x,isInvalid:!!o.occuranceDate,disabled:u||n}),s.jsx(I.Control.Feedback,{type:"invalid",children:o.occuranceDate})]})})}),s.jsxs(oe,{className:"mt-4",children:[s.jsx(U,{md:6,children:s.jsxs("div",{className:"p-3 bg-light rounded",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Course/Subject"}),s.jsx("strong",{children:a.entityInfo?.name||"-"})]})}),s.jsx(U,{md:6,children:s.jsxs("div",{className:"p-3 bg-light rounded",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Template"}),s.jsx("strong",{children:a.templateInfo?.name||"-"})]})})]})]}),s.jsxs(le.Footer,{className:"border-top",children:[s.jsx(se,{variant:"secondary",onClick:f,disabled:u||n,children:"Cancel"}),s.jsx(se,{variant:"primary",type:"submit",disabled:u||n,className:"d-flex align-items-center",children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),"Update Event"]})})]})]})]}):null},Soe=({onSuccess:e})=>{const[t,r]=v.useState({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",traineeIds:[]}),[a,n]=v.useState({}),[i,l]=v.useState(!1),[o,c]=v.useState([]),[u,d]=v.useState([]),[m,f]=v.useState([]),[x,p]=v.useState([]),[h,g]=v.useState([]),[b,j]=v.useState(!1),[y,w]=v.useState(null),[N,S]=v.useState(!1),[E,_]=v.useState(!0),[T,C]=v.useState(!1),[A,D]=v.useState(!0),[P,R]=v.useState(!0),[M,X]=v.useState(!1);v.useEffect(()=>{(async()=>{try{_(!0);const G=(await Mt.getPublicDepartments()).filter(Z=>Z.isActive===!0);c(G)}catch(O){console.error("Error loading departments:",O),te.error("Failed to load departments"),c([])}finally{_(!1)}})()},[]),v.useEffect(()=>{(async()=>{if(!t.departmentId){d([]),r(O=>({...O,templateId:""}));return}try{C(!0);const O=await cr.getTemplatesByDepartment(t.departmentId),G=O?.data?.templates||O?.templates||O?.data||O||[];d(G),r(Z=>({...Z,templateId:""}))}catch(O){console.error("Error loading templates:",O),te.error("Failed to load templates"),d([])}finally{C(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.departmentId){f([]),p([]),D(!1),R(!1),r(O=>({...O,courseId:"",subjectId:"",traineeIds:[]}));return}try{D(!0),R(!0);const O=await Mt.getDepartmentById(t.departmentId);let G=[];O?.courses&&Array.isArray(O.courses)?G=O.courses:O?.data?.courses&&Array.isArray(O.data.courses)&&(G=O.data.courses);const Z=G.filter(B=>B.status==="ACTIVE"||B.status==="PLANNED");f(Z);let ee=[];Z.forEach(B=>{B.subjects&&Array.isArray(B.subjects)&&(ee=ee.concat(B.subjects))}),O?.subjects&&Array.isArray(O.subjects)?ee=ee.concat(O.subjects):O?.data?.subjects&&Array.isArray(O.data.subjects)&&(ee=ee.concat(O.data.subjects));const Ee=ee.filter((B,Se,Re)=>Se===Re.findIndex(He=>He.id===B.id)).filter(B=>B.status==="ON_GOING"||B.status==="ACTIVE");p(Ee),r(B=>({...B,courseId:"",subjectId:"",traineeIds:[]}))}catch(O){console.error("Error loading courses and subjects:",O),te.error("Failed to load courses and subjects"),f([]),p([])}finally{D(!1),R(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.courseId&&!t.subjectId){g([]),r(O=>({...O,traineeIds:[]}));return}try{X(!0);let O=[];if(t.courseId&&!t.subjectId){const G=await Yr.getCourseTrainees(t.courseId);O=G?.trainees||G?.data?.trainees||[]}else if(t.subjectId){const G=await ws.getSubjectById(t.subjectId),Z=[];G?.enrollmentsByBatch&&G.enrollmentsByBatch.forEach(ee=>{ee.trainees&&Array.isArray(ee.trainees)&&ee.trainees.forEach(de=>{Z.push({id:de.id,eid:de.eid,firstName:de.firstName,lastName:de.lastName,email:de.email})})}),O=Z}g(O),r(G=>({...G,traineeIds:[]}))}catch(O){console.error("Error loading trainees:",O),te.error("Failed to load trainees"),g([])}finally{X(!1)}})()},[t.courseId,t.subjectId]);const ie=k=>{const{name:O,value:G}=k.target;r(O==="courseId"?Z=>({...Z,courseId:G,subjectId:G?"":Z.subjectId}):O==="subjectId"?Z=>({...Z,subjectId:G,courseId:G?"":Z.courseId}):Z=>({...Z,[O]:G})),a[O]&&n(Z=>({...Z,[O]:""}))},ae=k=>{r(O=>{const G=O.traineeIds||[],Z=G.includes(k)?G.filter(ee=>ee!==k):[...G,k];return{...O,traineeIds:Z}}),a.traineeIds&&n(O=>({...O,traineeIds:""}))},V=k=>{r(O=>({...O,templateId:k}))},me=async k=>{if(!k||!k.id){te.error("Template not found");return}try{S(!0),j(!0);const O=await cr.getTemplatePDF(k.id),G=URL.createObjectURL(O);w(G)}catch(O){console.error("Error loading PDF:",O),te.error("Failed to load PDF preview"),j(!1)}finally{S(!1)}},ue=()=>{j(!1),y&&(URL.revokeObjectURL(y),w(null))},F=()=>{const k={};return t.departmentId||(k.departmentId="Department is required"),t.templateId||(k.templateId="Template is required"),!t.subjectId&&!t.courseId&&(k.courseSubject="Either Course or Subject must be selected"),t.subjectId&&t.courseId&&(k.courseSubject="Course and Subject cannot be selected at the same time"),t.occuranceDate||(k.occuranceDate="Occurrence date is required"),(!t.name||t.name.trim()==="")&&(k.name="Event name is required"),(!t.traineeIds||t.traineeIds.length===0)&&(k.traineeIds="At least one trainee must be selected"),n(k),Object.keys(k).length===0},Y=async k=>{if(k.preventDefault(),!!F()){l(!0);try{const O={templateId:t.templateId,occuranceDate:t.occuranceDate,name:t.name,traineeIds:t.traineeIds};t.courseId?O.courseId=t.courseId:t.subjectId&&(O.subjectId=t.subjectId),await Za.createAssessmentEvent(O),te.success("Assessment event created successfully"),r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",traineeIds:[]}),n({}),g([]),e&&e()}catch(O){console.error("Error creating assessment event:",O);const G=O.response?.data?.message||O.message||"Failed to create assessment event";te.error(G)}finally{l(!1)}}},z=k=>{const O=k.firstName||"",G=k.lastName||"",Z=k.middleName||"";return`${O} ${Z} ${G}`.trim()||k.eid||"Unknown"};return s.jsxs(I,{onSubmit:Y,className:"create-assessment-event-form",children:[s.jsx(oe,{children:s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(ei,{name:"departmentId",value:t.departmentId,onChange:ie,isInvalid:!!a.departmentId,disabled:i||E,placeholder:"Select a department",options:o.map(k=>({value:k.id,label:k.name}))}),s.jsx(I.Control.Feedback,{type:"invalid",children:a.departmentId})]})})}),s.jsx(oe,{children:s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Template ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(ei,{name:"templateId",value:t.templateId,onChange:k=>V(k.target.value),isInvalid:!!a.templateId,disabled:i||T||!t.departmentId,placeholder:t.departmentId?"Select a template":"Select a department first",options:u.map(k=>({value:k.id,label:k.name}))}),t.templateId&&s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>{const k=u.find(O=>O.id===t.templateId);k&&me(k)},disabled:i,className:"d-flex align-items-center",children:[s.jsx(St,{size:16,className:"me-1"}),"Preview"]})]}),s.jsx(I.Control.Feedback,{type:"invalid",children:a.templateId}),!t.departmentId&&s.jsx(I.Text,{className:"text-muted",children:"Please select a department first to load templates."})]})})}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3 course-select-group",children:[s.jsx(I.Label,{className:"fw-semibold",children:"Course"}),s.jsx(ei,{name:"courseId",value:t.courseId,onChange:ie,disabled:i||A||!!t.subjectId,placeholder:"Select a course (optional)",options:m.map(k=>({value:k.id,label:`${k.name} (${k.code})`}))}),t.subjectId&&s.jsx(I.Text,{className:"text-muted",children:"Subject is selected. Course cannot be selected."})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3 subject-select-group",children:[s.jsx(I.Label,{className:"fw-semibold",children:"Subject"}),s.jsx(ei,{name:"subjectId",value:t.subjectId,onChange:ie,disabled:i||P||!!t.courseId,placeholder:"Select a subject (optional)",options:x.map(k=>({value:k.id,label:`${k.name} (${k.code})`}))}),t.courseId&&s.jsx(I.Text,{className:"text-muted",children:"Course is selected. Subject cannot be selected."})]})})]}),a.courseSubject&&s.jsx(ke,{variant:"danger",className:"mb-3",children:a.courseSubject}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Event Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",name:"name",value:t.name,onChange:ie,isInvalid:!!a.name,placeholder:"Enter event name",disabled:i}),s.jsx(I.Control.Feedback,{type:"invalid",children:a.name})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Occurrence Date ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"date",name:"occuranceDate",value:t.occuranceDate,onChange:ie,isInvalid:!!a.occuranceDate,disabled:i}),s.jsx(I.Control.Feedback,{type:"invalid",children:a.occuranceDate})]})})]}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Trainees ",s.jsx("span",{className:"text-danger",children:"*"})]}),!t.courseId&&!t.subjectId?s.jsx(ke,{variant:"info",className:"mb-0",children:"Please select a Course or Subject first to load trainees."}):M?s.jsxs("div",{className:"text-center py-3",children:[s.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading trainees..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading trainees..."})]}):h.length===0?s.jsxs(ke,{variant:"warning",className:"mb-0",children:["No trainees found for the selected ",t.courseId?"course":"subject","."]}):s.jsx(H,{className:"border",style:{maxHeight:"300px",overflowY:"auto"},children:s.jsx(H.Body,{className:"p-3",children:s.jsx("div",{className:"d-flex flex-column gap-2",children:h.map(k=>{const O=t.traineeIds?.includes(k.id);return s.jsx("div",{className:`p-2 border rounded cursor-pointer ${O?"bg-primary":"bg-light"}`,onClick:()=>ae(k.id),style:{cursor:"pointer",transition:"all 0.2s ease",backgroundColor:O?"var(--bs-primary)":"var(--bs-light)",color:O?"#ffffff":"var(--bs-dark)"},onMouseEnter:G=>{O||(G.currentTarget.style.backgroundColor="#e9ecef")},onMouseLeave:G=>{O||(G.currentTarget.style.backgroundColor="var(--bs-light)")},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{children:[s.jsx("strong",{style:{color:O?"#ffffff":"inherit"},children:z(k)}),k.eid&&s.jsx(Ne,{bg:O?"light":"secondary",className:"ms-2",style:{color:O?"var(--bs-primary)":"#ffffff"},children:k.eid})]}),O&&s.jsx(Ne,{bg:"light",style:{color:"var(--bs-primary)"},children:"Selected"})]})},k.id)})})})}),a.traineeIds&&t.traineeIds?.length===0&&s.jsx("div",{className:"text-danger mt-1",style:{fontSize:"0.875rem"},children:a.traineeIds}),t.traineeIds&&t.traineeIds.length>0&&s.jsxs(I.Text,{className:"text-muted",children:[t.traineeIds.length," trainee(s) selected"]})]})})}),s.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[s.jsx(se,{variant:"secondary",onClick:()=>{r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",traineeIds:[]}),n({}),g([]),d([])},disabled:i,children:"Reset"}),s.jsx(se,{variant:"primary",type:"submit",disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),"Create Assessment Event"]})})]}),s.jsxs(le,{show:b,onHide:ue,size:"lg",centered:!0,fullscreen:"lg-down",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:"Template Preview"})}),s.jsx(le.Body,{style:{padding:0,height:"70vh",minHeight:"500px"},children:N?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2",children:"Loading PDF..."})]})}):y?s.jsx("iframe",{src:y,style:{width:"100%",height:"100%",border:"none"},title:"Template PDF Preview"}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsx("p",{className:"text-muted",children:"No preview available"})})})]})]})},Eoe=({onSuccess:e})=>{const[t,r]=v.useState({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),[a,n]=v.useState({}),[i,l]=v.useState(!1),[o,c]=v.useState([]),[u,d]=v.useState([]),[m,f]=v.useState([]),[x,p]=v.useState([]),[h,g]=v.useState([]),[b,j]=v.useState(!1),[y,w]=v.useState(null),[N,S]=v.useState(!1),[E,_]=v.useState(!0),[T,C]=v.useState(!1),[A,D]=v.useState(!0),[P,R]=v.useState(!0),[M,X]=v.useState(!1);v.useEffect(()=>{(async()=>{try{_(!0);const G=(await Mt.getPublicDepartments()).filter(Z=>Z.isActive===!0);c(G)}catch(O){console.error("Error loading departments:",O),te.error("Failed to load departments"),c([])}finally{_(!1)}})()},[]),v.useEffect(()=>{(async()=>{if(!t.departmentId){d([]),r(O=>({...O,templateId:""}));return}try{C(!0);const O=await cr.getTemplatesByDepartment(t.departmentId),G=O?.data?.templates||O?.templates||O?.data||O||[];d(G),r(Z=>({...Z,templateId:""}))}catch(O){console.error("Error loading templates:",O),te.error("Failed to load templates"),d([])}finally{C(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.departmentId){f([]),p([]),D(!1),R(!1),r(O=>({...O,courseId:"",subjectId:"",excludeTraineeIds:[]}));return}try{D(!0),R(!0);const O=await Mt.getDepartmentById(t.departmentId);let G=[];O?.courses&&Array.isArray(O.courses)?G=O.courses:O?.data?.courses&&Array.isArray(O.data.courses)&&(G=O.data.courses);const Z=G.filter(B=>B.status==="ACTIVE"||B.status==="PLANNED");f(Z);let ee=[];Z.forEach(B=>{B.subjects&&Array.isArray(B.subjects)&&(ee=ee.concat(B.subjects))}),O?.subjects&&Array.isArray(O.subjects)?ee=ee.concat(O.subjects):O?.data?.subjects&&Array.isArray(O.data.subjects)&&(ee=ee.concat(O.data.subjects));const Ee=ee.filter((B,Se,Re)=>Se===Re.findIndex(He=>He.id===B.id)).filter(B=>B.status==="ON_GOING"||B.status==="ACTIVE");p(Ee),r(B=>({...B,courseId:"",subjectId:"",excludeTraineeIds:[]}))}catch(O){console.error("Error loading courses and subjects:",O),te.error("Failed to load courses and subjects"),f([]),p([])}finally{D(!1),R(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.courseId&&!t.subjectId){g([]),r(O=>({...O,excludeTraineeIds:[]}));return}try{X(!0);let O=[];if(t.courseId&&!t.subjectId){const G=await Yr.getCourseTrainees(t.courseId);O=G?.trainees||G?.data?.trainees||[]}else if(t.subjectId){const G=await ws.getSubjectById(t.subjectId),Z=[];G?.enrollmentsByBatch&&G.enrollmentsByBatch.forEach(ee=>{ee.trainees&&Array.isArray(ee.trainees)&&ee.trainees.forEach(de=>{Z.push({id:de.id,eid:de.eid,firstName:de.firstName,lastName:de.lastName,email:de.email})})}),O=Z}g(O)}catch(O){console.error("Error loading trainees:",O),te.error("Failed to load trainees"),g([])}finally{X(!1)}})()},[t.courseId,t.subjectId]);const ie=k=>{const O=k.firstName||"",G=k.lastName||"",Z=k.middleName||"";return`${O} ${Z} ${G}`.trim()||k.eid||"Unknown"},ae=k=>{const{name:O,value:G}=k.target;r(O==="courseId"?Z=>({...Z,courseId:G,subjectId:G?"":Z.subjectId,excludeTraineeIds:[]}):O==="subjectId"?Z=>({...Z,subjectId:G,courseId:G?"":Z.courseId,excludeTraineeIds:[]}):Z=>({...Z,[O]:G})),a[O]&&n(Z=>({...Z,[O]:""}))},V=k=>{r(O=>{const G=O.excludeTraineeIds||[],Z=G.includes(k)?G.filter(ee=>ee!==k):[...G,k];return{...O,excludeTraineeIds:Z}}),a.excludeTraineeIds&&n(O=>({...O,excludeTraineeIds:""}))},me=k=>{r(O=>({...O,templateId:k}))},ue=async k=>{if(!k||!k.id){te.error("Template not found");return}try{S(!0),j(!0);const O=await cr.getTemplatePDF(k.id),G=URL.createObjectURL(O);w(G)}catch(O){console.error("Error loading PDF:",O),te.error("Failed to load PDF preview"),j(!1)}finally{S(!1)}},F=()=>{j(!1),y&&(URL.revokeObjectURL(y),w(null))},Y=()=>{const k={};return t.departmentId||(k.departmentId="Department is required"),t.templateId||(k.templateId="Template is required"),!t.subjectId&&!t.courseId&&(k.courseSubject="Either Course or Subject must be selected"),t.subjectId&&t.courseId&&(k.courseSubject="Course and Subject cannot be selected at the same time"),t.occuranceDate||(k.occuranceDate="Occurrence date is required"),(!t.name||t.name.trim()==="")&&(k.name="Event name is required"),n(k),Object.keys(k).length===0},z=async k=>{if(k.preventDefault(),!!Y()){l(!0);try{const O={templateId:t.templateId,occuranceDate:t.occuranceDate,name:t.name,excludeTraineeIds:t.excludeTraineeIds||[]};t.courseId?O.courseId=t.courseId:t.subjectId&&(O.subjectId=t.subjectId),await Za.createBulkAssessmentEvent(O),te.success("Bulk assessment event created successfully"),r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),n({}),g([]),setSelectedTemplate(null),e&&e()}catch(O){console.error("Error creating bulk assessment event:",O);const G=O.response?.data?.message||O.message||"Failed to create bulk assessment event";te.error(G)}finally{l(!1)}}};return s.jsxs(I,{onSubmit:z,className:"create-assessment-event-form",children:[s.jsx(oe,{children:s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(ei,{name:"departmentId",value:t.departmentId,onChange:ae,isInvalid:!!a.departmentId,disabled:i||E,placeholder:"Select a department",options:o.map(k=>({value:k.id,label:k.name}))}),s.jsx(I.Control.Feedback,{type:"invalid",children:a.departmentId})]})})}),s.jsx(oe,{children:s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Template ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(ei,{name:"templateId",value:t.templateId,onChange:k=>me(k.target.value),isInvalid:!!a.templateId,disabled:i||T||!t.departmentId,placeholder:t.departmentId?"Select a template":"Select a department first",options:u.map(k=>({value:k.id,label:k.name}))}),t.templateId&&s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>{const k=u.find(O=>O.id===t.templateId);k&&ue(k)},disabled:i,className:"d-flex align-items-center",children:[s.jsx(St,{size:16,className:"me-1"}),"Preview"]})]}),s.jsx(I.Control.Feedback,{type:"invalid",children:a.templateId}),!t.departmentId&&s.jsx(I.Text,{className:"text-muted",children:"Please select a department first to load templates."})]})})}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3 course-select-group",children:[s.jsx(I.Label,{className:"fw-semibold",children:"Course"}),s.jsx(ei,{name:"courseId",value:t.courseId,onChange:ae,disabled:i||A||!!t.subjectId,placeholder:"Select a course (optional)",options:m.map(k=>({value:k.id,label:`${k.name} (${k.code})`}))}),t.subjectId&&s.jsx(I.Text,{className:"text-muted",children:"Subject is selected. Course cannot be selected."})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3 subject-select-group",children:[s.jsx(I.Label,{className:"fw-semibold",children:"Subject"}),s.jsx(ei,{name:"subjectId",value:t.subjectId,onChange:ae,disabled:i||P||!!t.courseId,placeholder:"Select a subject (optional)",options:x.map(k=>({value:k.id,label:`${k.name} (${k.code})`}))}),t.courseId&&s.jsx(I.Text,{className:"text-muted",children:"Course is selected. Subject cannot be selected."})]})})]}),a.courseSubject&&s.jsx(ke,{variant:"danger",className:"mb-3",children:a.courseSubject}),s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Event Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",name:"name",value:t.name,onChange:ae,isInvalid:!!a.name,placeholder:"Enter event name",disabled:i}),s.jsx(I.Control.Feedback,{type:"invalid",children:a.name})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-semibold",children:["Occurrence Date ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"date",name:"occuranceDate",value:t.occuranceDate,onChange:ae,isInvalid:!!a.occuranceDate,disabled:i}),s.jsx(I.Control.Feedback,{type:"invalid",children:a.occuranceDate})]})})]}),s.jsx(oe,{children:s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"fw-semibold",children:"Exclude Trainees (Optional)"}),!t.courseId&&!t.subjectId?s.jsx(ke,{variant:"info",className:"mb-0",children:"Please select a Course or Subject first to load trainees."}):M?s.jsxs("div",{className:"text-center py-3",children:[s.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading trainees..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading trainees..."})]}):h.length===0?s.jsxs(ke,{variant:"warning",className:"mb-0",children:["No trainees found for the selected ",t.courseId?"course":"subject","."]}):s.jsx(H,{className:"border",style:{maxHeight:"300px",overflowY:"auto"},children:s.jsx(H.Body,{className:"p-3",children:s.jsx("div",{className:"d-flex flex-column gap-2",children:h.map(k=>{const O=t.excludeTraineeIds?.includes(k.id);return s.jsx("div",{className:`p-2 border rounded cursor-pointer ${O?"bg-primary":"bg-light"}`,onClick:()=>V(k.id),style:{cursor:"pointer",transition:"all 0.2s ease",backgroundColor:O?"var(--bs-primary)":"var(--bs-light)",color:O?"#ffffff":"var(--bs-dark)"},onMouseEnter:G=>{O||(G.currentTarget.style.backgroundColor="#e9ecef")},onMouseLeave:G=>{O||(G.currentTarget.style.backgroundColor="var(--bs-light)")},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{children:[s.jsx("strong",{style:{color:O?"#ffffff":"inherit"},children:ie(k)}),k.eid&&s.jsx(Ne,{bg:O?"light":"secondary",className:"ms-2",style:{color:O?"var(--bs-primary)":"#ffffff"},children:k.eid})]}),O&&s.jsx(Ne,{bg:"light",style:{color:"var(--bs-primary)"},children:"Excluded"})]})},k.id)})})})}),t.excludeTraineeIds&&t.excludeTraineeIds.length>0&&s.jsxs(I.Text,{className:"text-muted",children:[t.excludeTraineeIds.length," trainee(s) excluded"]})]})})}),s.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[s.jsx(se,{variant:"secondary",onClick:()=>{r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),n({}),g([]),d([])},disabled:i,children:"Reset"}),s.jsx(se,{variant:"primary",type:"submit",disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),"Create Bulk Assessment Event"]})})]}),s.jsxs(le,{show:b,onHide:F,size:"lg",centered:!0,fullscreen:"lg-down",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:"Template Preview"})}),s.jsx(le.Body,{style:{padding:0,height:"70vh",minHeight:"500px"},children:N?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2",children:"Loading PDF..."})]})}):y?s.jsx("iframe",{src:y,style:{width:"100%",height:"100%",border:"none"},title:"Template PDF Preview"}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsx("p",{className:"text-muted",children:"No preview available"})})})]})]})},N2=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[c,u]=v.useState(null),[d,m]=v.useState("list"),f=async()=>{try{a(!0);const N=((await Za.getAssessmentEvents())?.data?.events||[]).map((S,E)=>{let _="",T="";return S.subjectId===null?S.entityInfo&&S.entityInfo.type==="course"&&(T=S.entityInfo.name||"",_=""):(S.entityInfo&&S.entityInfo.type==="subject"&&(_=S.entityInfo.name||""),T=""),{id:S.id||`event-${E}`,name:S.name||"N/A",subject:_,course:T,occurrenceDate:S.occuranceDate||S.occurrenceDate,status:S.status||"N/A",originalEvent:S}});t(N)}catch(y){console.error("Error loading assessment events:",y),t([])}finally{a(!1)}};v.useEffect(()=>{f()},[]);const x=y=>{const w=y.originalEvent||y;u(w),i(!0)},p=()=>{i(!1),u(null)},h=y=>{const w=y.originalEvent||y;u(w),o(!0)},g=()=>{o(!1),u(null)},b=()=>{f()},j=()=>{f(),m("list")};return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{children:s.jsx(U,{children:s.jsx(H,{className:"shadow-sm",children:s.jsx(Vt.Container,{activeKey:d,onSelect:m,children:s.jsxs(H.Body,{className:"p-0",style:{overflow:"visible",minHeight:"800px"},children:[s.jsx(H.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(pt,{variant:"tabs",className:"border-0",children:[s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"list",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:d==="list"?"600":"400",opacity:d==="list"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Q2,{className:"me-2",size:16}),"Assessment Events"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"create",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:d==="create"?"600":"400",opacity:d==="create"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Xr,{className:"me-2",size:16}),"Create New Assessment Event"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"create-bulk",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:d==="create-bulk"?"600":"400",opacity:d==="create-bulk"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(V2,{className:"me-2",size:16}),"Create Bulk Assessment Event"]})})]})}),s.jsxs(Vt.Content,{children:[s.jsx(Vt.Pane,{eventKey:"list",className:"p-4",children:s.jsx(woe,{assessmentEvents:e,loading:r,onView:x,onUpdate:h})}),s.jsx(Vt.Pane,{eventKey:"create",className:"p-4",style:{overflow:"visible",minHeight:"800px"},children:s.jsx(Soe,{onSuccess:j})}),s.jsx(Vt.Pane,{eventKey:"create-bulk",className:"p-4",style:{overflow:"visible",minHeight:"800px"},children:s.jsx(Eoe,{onSuccess:j})})]})]})})})})}),s.jsx(B1,{show:n,onClose:p,event:c}),s.jsx(Noe,{show:l,onClose:g,onSave:b,event:c,loading:r})]})},Toe=({traineeId:e,courseId:t})=>{const r=Ge(),[a,n]=v.useState([]),[i,l]=v.useState(!0),{sortedData:o,sortConfig:c,handleSort:u}=ur(a);v.useEffect(()=>{e&&t&&d()},[e,t]);const d=async()=>{try{l(!0);const h=[{id:"1",name:"Basic Safety Protocols",code:"BSP",description:"Introduction to basic safety procedures and protocols",status:"COMPLETED",progress:100,startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-01-30T17:00:00.000Z",instructor:"Sarah Johnson",score:95},{id:"2",name:"Emergency Procedures",code:"EP",description:"Emergency response procedures and protocols",status:"IN_PROGRESS",progress:75,startDate:"2024-02-01T09:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",instructor:"Mike Chen",score:null},{id:"3",name:"Equipment Handling",code:"EH",description:"Proper handling and maintenance of safety equipment",status:"PENDING",progress:0,startDate:"2024-02-16T09:00:00.000Z",endDate:"2024-03-01T17:00:00.000Z",instructor:"Lisa Wang",score:null}];await new Promise(g=>setTimeout(g,300)),n(h)}catch(h){console.error("Error loading trainee subjects:",h),te.error("Failed to load subjects")}finally{l(!1)}},m=h=>{const b={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[h]||{variant:"secondary",text:h};return s.jsx(Ne,{bg:b.variant,children:b.text})},f=h=>{const b={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[h]||{variant:"secondary",text:h};return s.jsx(Ne,{bg:b.variant,children:b.text})},x=h=>{r(`/trainee/${e}/course/${t}/subject/${h}`)},p=({columnKey:h,children:g,className:b=""})=>{const j=c.key===h,y=j?c.direction:null;return s.jsxs("th",{className:`fw-semibold ${b}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>u(h),onMouseEnter:w=>{w.target.style.backgroundColor="#214760",w.target.style.transform="translateY(-1px)",w.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:w=>{w.target.style.backgroundColor="var(--bs-primary)",w.target.style.transform="translateY(0)",w.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:j?"600":"500",color:"white"},children:g}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:y,size:14,color:"white"})})]}),j&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return i?s.jsx(zt,{rows:5,columns:8}):a.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(p,{columnKey:"code",className:"show-mobile",children:"Subject Code"}),s.jsx(p,{columnKey:"name",className:"show-mobile",children:"Subject Name"}),s.jsx(p,{columnKey:"level",className:"show-mobile",children:"Level"}),s.jsx(p,{columnKey:"duration",className:"show-mobile",children:"Duration"}),s.jsx(p,{columnKey:"method",className:"show-mobile",children:"Method"}),s.jsx(p,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(p,{columnKey:"progress",className:"show-mobile",children:"Progress"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:o.map((h,g)=>s.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsx(Ne,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:h.code})}),s.jsxs("td",{className:"align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:h.name}),s.jsx("small",{className:"text-muted",children:h.description})]}),s.jsx("td",{className:"align-middle show-mobile",children:f(h.level)}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("span",{className:"text-dark",children:[h.duration," hours"]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx(Ne,{bg:"info",className:"fw-normal",children:h.method||"Classroom"})}),s.jsx("td",{className:"align-middle show-mobile",children:m(h.status)}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${h.progress||0}%`}})}),s.jsxs("small",{className:"text-muted",children:[h.progress||0,"%"]})]})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>x(h.id)}]})})]},h.id))})]})})},Aoe=({traineeId:e,courseId:t})=>{const r=Ge(),[a,n]=v.useState([]),[i,l]=v.useState(!0),{sortedData:o,sortConfig:c,handleSort:u}=ur(a);v.useEffect(()=>{e&&d()},[e,t]);const d=async()=>{try{l(!0);const j=[{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}],y=[{id:"4",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",type:"Written Test",subject:"Basic Safety Protocols",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"5",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",type:"Practical Assessment",subject:"Emergency Procedures",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"6",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",type:"Quiz",subject:"Equipment Handling",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}],w=[...j.map(N=>({...N,isUpcoming:!0})),...y.map(N=>({...N,isUpcoming:!1}))];await new Promise(N=>setTimeout(N,300)),n(w)}catch(j){console.error("Error loading assessments:",j),te.error("Failed to load assessments")}finally{l(!1)}},m=j=>{const w={UPCOMING:{variant:"warning",text:"Upcoming",icon:Qe},PENDING:{variant:"warning",text:"Pending",icon:Qe},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Ht},COMPLETED:{variant:"success",text:"Completed",icon:Je},PASSED:{variant:"success",text:"Passed",icon:Je},FAILED:{variant:"danger",text:"Failed",icon:Er},OVERDUE:{variant:"danger",text:"Overdue",icon:Er}}[j]||{variant:"secondary",text:j,icon:Ht},N=w.icon;return s.jsxs(Ne,{bg:w.variant,className:"d-flex align-items-center",children:[s.jsx(N,{size:12,className:"me-1"}),w.text]})},f=j=>{const w={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[j]||{variant:"secondary",text:j};return s.jsx(Ne,{bg:w.variant,children:w.text})},x=j=>{const w={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"},QUIZ:{variant:"secondary",text:"Quiz"}}[j?.toUpperCase()]||{variant:"secondary",text:j};return s.jsx(Ne,{bg:w.variant,children:w.text})},p=(j,y)=>{if(!j||!y)return null;const w=j/y*100;let N="success";return w<60?N="danger":w<80&&(N="warning"),s.jsxs(Ne,{bg:N,children:[j,"/",y," (",w.toFixed(0),"%)"]})},h=async j=>{try{r(`/trainee/${e}/assessment/${j}?action=start`)}catch(y){console.error("Error starting assessment:",y),te.error("Failed to start assessment")}},g=j=>{r(`/trainee/${e}/assessment/${j}`)},b=({columnKey:j,children:y,className:w=""})=>{const N=c.key===j,S=N?c.direction:null;return s.jsxs("th",{className:`fw-semibold ${w}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>u(j),onMouseEnter:E=>{E.target.style.backgroundColor="#214760",E.target.style.transform="translateY(-1px)",E.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:E=>{E.target.style.backgroundColor="var(--bs-primary)",E.target.style.transform="translateY(0)",E.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:N?"600":"500",color:"white"},children:y}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:S,size:14,color:"white"})})]}),N&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return i?s.jsx(zt,{rows:5,columns:8}):a.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No assessment events"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(b,{columnKey:"name",className:"show-mobile",children:"Assessment"}),s.jsx(b,{columnKey:"subject",className:"show-mobile",children:"Subject"}),s.jsx(b,{columnKey:"type",className:"show-mobile",children:"Type"}),s.jsx(b,{columnKey:"priority",className:"show-mobile",children:"Priority"}),s.jsx(b,{columnKey:"dueDate",className:"show-mobile",children:"Date"}),s.jsx(b,{columnKey:"score",className:"show-mobile",children:"Score"}),s.jsx(b,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:o.map((j,y)=>s.jsxs("tr",{className:`${y%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:w=>{w.currentTarget.style.backgroundColor=y%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsxs("td",{className:"align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:j.name}),j.description&&s.jsx("small",{className:"text-muted",children:j.description})]}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:j.subject})}),s.jsx("td",{className:"align-middle show-mobile",children:x(j.type)}),s.jsx("td",{className:"align-middle show-mobile",children:f(j.priority)}),s.jsx("td",{className:"align-middle show-mobile",children:j.isUpcoming?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"text-muted me-1",size:14}),s.jsx("span",{className:"text-dark",children:j.dueDate?new Date(j.dueDate).toLocaleDateString():"N/A"})]}):s.jsx("span",{className:"text-dark",children:j.completedDate?new Date(j.completedDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"align-middle show-mobile",children:j.isUpcoming?s.jsx("span",{className:"text-muted",children:"-"}):p(j.score,j.maxScore)}),s.jsx("td",{className:"align-middle show-mobile",children:m(j.status)}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:j.isUpcoming?[{label:"Start Assessment",icon:s.jsx(Ht,{}),onClick:()=>h(j.id)}]:[{label:"View Results",icon:s.jsx(Je,{}),onClick:()=>g(j.id)}]})})]},j.id))})]})})},Coe=({traineeId:e,courseId:t})=>{const r=Ge(),[a,n]=v.useState(null),[i,l]=v.useState(null),[o,c]=v.useState(!0),[u,d]=v.useState(""),[m,f]=v.useState("subjects");v.useEffect(()=>{e&&t&&x()},[e,t]);const x=async()=>{try{c(!0),d(""),l({id:e,firstName:"John",lastName:"Doe",eid:"EMP001",email:"john.doe@company.com"}),n({id:t,name:"Advanced Flight Training",code:"AFT2024",description:"Comprehensive flight training program covering advanced maneuvers and emergency procedures.",level:"ADVANCED",status:"ACTIVE",startDate:"2024-01-15T08:00:00.000Z",endDate:"2024-06-15T17:00:00.000Z",venue:"Training Center A",maxNumTrainee:25,passScore:80,progress:65,department:{name:"Flight Crew Training Department",code:"FCTD"}})}catch(h){console.error("Error loading course details:",h),d("Failed to load course details"),te.error("Failed to load course details")}finally{c(!1)}},p=()=>{r(he.COURSES_ENROLLED)};return o?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):u||!a?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:u||"Course not found"}),s.jsxs(se,{variant:"outline-danger",onClick:p,children:[s.jsx(At,{className:"me-2",size:16}),"Back to Trainee"]})]})}):s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:p,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(It,{className:"me-2",size:28}),a.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[a.code,"  ",i?.firstName," ",i?.lastName]})]})]})})})}),s.jsx(oe,{children:s.jsx(U,{children:s.jsx(H,{className:"border-0 shadow-sm mb-2",children:s.jsxs(Vt.Container,{activeKey:m,onSelect:f,children:[s.jsx(H.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(pt,{variant:"tabs",className:"border-0",children:[s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:m==="subjects"?"600":"400",opacity:m==="subjects"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(It,{className:"me-2",size:16}),"Subject List"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"assessments",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:m==="assessments"?"600":"400",opacity:m==="assessments"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Ht,{className:"me-2",size:16}),"All Assessment Events"]})})]})}),s.jsx(H.Body,{className:"p-0",children:s.jsxs(Vt.Content,{children:[s.jsx(Vt.Pane,{eventKey:"subjects",children:s.jsx(Toe,{traineeId:e,courseId:t})}),s.jsx(Vt.Pane,{eventKey:"assessments",children:s.jsx(Aoe,{traineeId:e,courseId:t})})]})})]})})})})]})},_oe=()=>{const{traineeId:e,courseId:t}=gr();return s.jsx(_e,{className:"py-3",children:s.jsx(Coe,{traineeId:e,courseId:t})})},koe=({traineeId:e,courseId:t})=>{const r=Ge(),[a,n]=v.useState([]),[i,l]=v.useState(!0);v.useEffect(()=>{e&&o()},[e,t]);const o=async()=>{try{l(!0),n([{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}])}catch(m){console.error("Error loading upcoming assessments:",m),te.error("Failed to load upcoming assessments")}finally{l(!1)}},c=m=>{const x={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[m]||{variant:"secondary",text:m};return s.jsx(Ne,{bg:x.variant,children:x.text})},u=m=>{const x={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"}}[m?.toUpperCase()]||{variant:"secondary",text:m};return s.jsx(Ne,{bg:x.variant,children:x.text})},d=async m=>{try{r(`/trainee/${e}/assessment/${m}?action=start`)}catch(f){console.error("Error starting assessment:",f),te.error("Failed to start assessment")}};return i?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(xt,{animation:"border",variant:"primary",size:"sm"}),s.jsx("p",{className:"mt-2 text-muted small",children:"Loading upcoming assessments..."})]}):a.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(xr,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No upcoming assessments"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Assessment"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Type"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Priority"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Due Date"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:a.map((m,f)=>s.jsxs("tr",{className:`${f%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:x=>{x.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:x=>{x.currentTarget.style.backgroundColor=f%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:m.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:m.subject})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:u(m.type)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(m.priority)}),s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"text-muted me-1",size:14}),s.jsx("span",{className:"text-dark",children:new Date(m.dueDate).toLocaleDateString()})]}),s.jsx("small",{className:"text-muted",children:new Date(m.dueDate).toLocaleTimeString()})]}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsxs(se,{variant:"primary",size:"sm",onClick:()=>d(m.id),children:[s.jsx(Ht,{className:"me-1",size:14}),"Start"]})})]},m.id))})]})})},yr=({title:e,sortKey:t,sortConfig:r,onSort:a})=>{const n=()=>{a(t)},i=()=>r.key===t?r.direction==="asc"?s.jsx(W2,{size:12,className:"ms-1"}):s.jsx(ni,{size:12,className:"ms-1"}):s.jsx(pr,{size:12,className:"ms-1"});return s.jsxs("div",{className:"d-flex align-items-center cursor-pointer user-select-none",onClick:n,style:{cursor:"pointer",whiteSpace:"nowrap"},children:[s.jsx("span",{className:"me-1",children:e}),i()]})},Doe=`
  .completed-assessments-table-no-borders .table,
  .completed-assessments-table-no-borders .table td,
  .completed-assessments-table-no-borders .table th,
  .completed-assessments-table-no-borders .table tbody tr,
  .completed-assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .completed-assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .completed-assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Doe,document.head.appendChild(e)}const D4=({traineeId:e,courseId:t,subjectId:r})=>{const a=Ge(),[n,i]=v.useState([]),[l,o]=v.useState(!0),{sortedData:c,sortConfig:u,handleSort:d}=ur(n);v.useEffect(()=>{m()},[e,t,r]);const m=async()=>{try{o(!0);let g=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}];t&&(g=g.filter(b=>b.course?.code==="SAF001")),r&&(g=g.filter(b=>b.subject?.code==="BSP")),await new Promise(b=>setTimeout(b,300)),i(g)}catch(h){console.error("Error loading completed assessments:",h),te.error("Failed to load completed assessments")}finally{o(!1)}},f=h=>{const b={COMPLETED:{variant:"success",text:"Completed",icon:Je},PASSED:{variant:"success",text:"Passed",icon:Je},FAILED:{variant:"danger",text:"Failed",icon:Er}}[h]||{variant:"secondary",text:h,icon:Je},j=b.icon;return s.jsxs(Ne,{bg:b.variant,className:"d-flex align-items-center",children:[s.jsx(j,{size:12,className:"me-1"}),b.text]})},x=(h,g)=>{const b=h/g*100;let j="success";return b<60?j="danger":b<80&&(j="warning"),s.jsxs(Ne,{bg:j,children:[h,"/",g," (",b.toFixed(0),"%)"]})},p=h=>{a(`/trainee/${e}/assessment/${h.id}`)};return l?s.jsx("div",{className:"text-center py-4",children:s.jsx(zt,{count:5})}):n.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Je,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No completed assessments"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(yr,{title:"Assessment",sortKey:"name",sortConfig:u,onSort:d})}),!r&&s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(yr,{title:"Subject",sortKey:"subject",sortConfig:u,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(yr,{title:"Type",sortKey:"type",sortConfig:u,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(yr,{title:"Score",sortKey:"score",sortConfig:u,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(yr,{title:"Completed Date",sortKey:"completedDate",sortConfig:u,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(yr,{title:"Status",sortKey:"status",sortConfig:u,onSort:d})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:c.map((h,g)=>s.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:h.name}),s.jsx("small",{className:"text-muted",children:h.description})]}),!r&&s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:h.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:h.subject?.code||""})]}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ne,{bg:"primary",className:"fw-normal",children:h.type||"Assessment"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:x(h.score,h.maxScore)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:h.completedDate?new Date(h.completedDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:f(h.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Results",icon:s.jsx(Je,{}),onClick:()=>p(h)}]})})]},h.id))})]})})},Ioe=({traineeId:e,courseId:t,subjectId:r})=>{const a=Ge(),[n,i]=v.useState(null),[l,o]=v.useState(null),[c,u]=v.useState(!0),[d,m]=v.useState("");v.useEffect(()=>{e&&t&&r&&f()},[e,t,r]);const f=async()=>{try{u(!0),m("");const g={id:r,name:"Emergency Procedures",code:"EP101",description:"Comprehensive training on emergency procedures and safety protocols for flight operations.",level:"INTERMEDIATE",status:"ACTIVE",duration:40,method:"Simulator",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",roomName:"Simulator Room A",progress:75,trainer:{name:"Captain John Smith",email:"john.smith@instructor.com"},assessments:[{id:"1",name:"Emergency Evacuation Drill",type:"Practical",dueDate:"2024-02-10T14:00:00.000Z",status:"COMPLETED",score:85},{id:"2",name:"Safety Protocol Test",type:"Written",dueDate:"2024-02-12T10:00:00.000Z",status:"PENDING",score:null}]},b={id:e,firstName:"John",lastName:"Doe",eid:"TR001"};i(g),o(b)}catch(g){console.error("Error loading subject details:",g),m("Failed to load subject details"),te.error("Failed to load subject details")}finally{u(!1)}},x=()=>{a(`/trainee/${e}/course/${t}`)},p=g=>{const j={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[g]||{variant:"secondary",text:g};return s.jsx(Ne,{bg:j.variant,className:"fs-6",children:j.text})},h=g=>{const j={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[g]||{variant:"secondary",text:g};return s.jsx(Ne,{bg:j.variant,children:j.text})};return c?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading subject details..."})]})}):d||!n?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:d||"Subject not found"}),s.jsxs(se,{variant:"outline-danger",onClick:x,children:[s.jsx(At,{className:"me-2",size:16}),"Back to Course"]})]})}):s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:x,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(It,{className:"me-2",size:28}),n.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",l?.firstName," ",l?.lastName]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[p(n.status),h(n.level)]})]})})}),s.jsxs(oe,{children:[s.jsxs(U,{lg:8,className:"mb-4",children:[s.jsx(oe,{children:s.jsx(U,{className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Ht,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),s.jsx(H.Body,{className:"p-0",children:s.jsx(koe,{traineeId:e,courseId:t,subjectId:r})})]})})}),s.jsx(oe,{children:s.jsx(U,{children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Je,{className:"me-2",size:20}),"Completed Assessments"]})}),s.jsx(H.Body,{className:"p-0",children:s.jsx(D4,{traineeId:e,courseId:t,subjectId:r})})]})})})]}),s.jsx(U,{lg:4,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(It,{className:"me-2",size:20}),"Enrolled Subject Details"]})}),s.jsxs(H.Body,{children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Start Date"}),s.jsx("div",{className:"text-muted",children:new Date(n.startDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"End Date"}),s.jsx("div",{className:"text-muted",children:new Date(n.endDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Duration"}),s.jsxs("div",{className:"text-muted",children:[n.duration," hours"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ll,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Room"}),s.jsx("div",{className:"text-muted",children:n.roomName})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Trainer"}),s.jsx("div",{className:"text-muted",children:n.trainer?.name})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("span",{className:"fw-semibold",children:"Progress"}),s.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),s.jsx("div",{className:"progress",children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${n.progress}%`}})})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("h6",{children:"Description"}),s.jsx("p",{className:"text-muted",children:n.description})]})]})]})})]})]})},Ooe=()=>{const{traineeId:e,courseId:t,subjectId:r}=gr();return s.jsx(_e,{className:"py-3",children:s.jsx(Ioe,{traineeId:e,courseId:t,subjectId:r})})},Poe=({traineeId:e})=>{const t=Ge(),[r,a]=v.useState(null),[n,i]=v.useState([]),[l,o]=v.useState([]),[c,u]=v.useState([]),[d,m]=v.useState(!0),[f,x]=v.useState("");v.useEffect(()=>{e&&p()},[e]);const p=async()=>{try{m(!0),x("");const S=await Jd.getTraineeById(e);a(S);const E=await Jd.getTraineeAssessments(e);i(E.assessments||E.data||[]);const _=[{id:"1",name:"Safety Protocol Agreement",course:"Emergency Procedures",subject:"Safety Protocols",dueDate:"2024-02-15T17:00:00.000Z",status:"PENDING"},{id:"2",name:"Training Completion Certificate",course:"Advanced Flight Training",subject:"Flight Operations",dueDate:"2024-02-20T17:00:00.000Z",status:"PENDING"}],T=[{id:"1",name:"Emergency Evacuation Procedures",course:"Emergency Procedures",subject:"Safety Protocols",section:"Practical Assessment",dueDate:"2024-02-12T14:00:00.000Z",status:"IN_PROGRESS",progress:60},{id:"2",name:"Flight Navigation Systems",course:"Advanced Flight Training",subject:"Navigation",section:"Written Test",dueDate:"2024-02-18T10:00:00.000Z",status:"PENDING",progress:0}];o(_),u(T)}catch(S){console.error("Error loading assessment data:",S),x("Failed to load assessment data"),te.error("Failed to load assessment data")}finally{m(!1)}},h=()=>{t(he.ASSESSMENTS_MY_ASSESSMENTS)},g=S=>{const _={PENDING:{variant:"warning",text:"Pending",icon:Qe},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Ht},COMPLETED:{variant:"success",text:"Completed",icon:Je},OVERDUE:{variant:"danger",text:"Overdue",icon:Er}}[S]||{variant:"secondary",text:S,icon:Ht},T=_.icon;return s.jsxs(Ne,{bg:_.variant,className:"d-flex align-items-center",children:[s.jsx(T,{size:12,className:"me-1"}),_.text]})},b=S=>{const _={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[S]||{variant:"secondary",text:S};return s.jsx(Ne,{bg:_.variant,children:_.text})},j=S=>{t(`/trainee/${e}/assessment/${S}`)},y=S=>{t(`/trainee/${e}/assessment/${S}`)},w=S=>{t(`/trainee/${e}/signature-pad/${S}`)},N=S=>{t(`/trainee/${e}/assessment-section/${S}`)};return d?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment data..."})]})}):f||!r?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:f||"Trainee not found"}),s.jsxs(se,{variant:"outline-danger",onClick:h,children:[s.jsx(At,{className:"me-2",size:16}),"Back to Trainee"]})]})}):s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:h,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(Ht,{className:"me-2",size:28}),"Assessment Management"]}),s.jsxs("p",{className:"text-muted mb-0",children:[r.firstName," ",r.lastName,"  ",r.eid]})]})]})})})}),s.jsx(oe,{children:s.jsx(U,{children:s.jsx(H,{className:"border-0 shadow-sm",children:s.jsx(H.Body,{className:"p-0",children:s.jsxs(Ux,{defaultActiveKey:"pending",className:"border-bottom",children:[s.jsx(Vt,{eventKey:"pending",title:"Pending Assessments",children:s.jsx("div",{className:"p-4",children:n.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Ht,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No pending assessments"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Assessment"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Type"}),s.jsx("th",{className:"text-start",children:"Priority"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:n.map(S=>s.jsxs("tr",{children:[s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:S.name}),s.jsx("small",{className:"text-muted",children:S.description})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:S.course?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:S.course?.code||""})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:S.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:S.subject?.code||""})]}),s.jsx("td",{children:s.jsx(Ne,{bg:"info",className:"fw-normal",children:S.type||"Assessment"})}),s.jsx("td",{children:b(S.priority)}),s.jsx("td",{children:S.dueDate?new Date(S.dueDate).toLocaleDateString():"N/A"}),s.jsx("td",{children:g(S.status)}),s.jsx("td",{children:s.jsx("div",{className:"d-flex gap-1",children:S.status==="PENDING"||S.status==="IN_PROGRESS"?s.jsx(se,{variant:"primary",size:"sm",onClick:()=>j(S.id),children:"Start"}):s.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>y(S.id),children:"View"})})})]},S.id))})]})})})}),s.jsx(Vt,{eventKey:"signature",title:"Signature Required",children:s.jsx("div",{className:"p-4",children:l.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(_n,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Document"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:l.map(S=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:S.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:S.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:S.subject})}),s.jsx("td",{children:new Date(S.dueDate).toLocaleDateString()}),s.jsx("td",{children:g(S.status)}),s.jsx("td",{children:s.jsxs(se,{variant:"primary",size:"sm",onClick:()=>w(S.id),children:[s.jsx(_n,{className:"me-1",size:14}),"Sign"]})})]},S.id))})]})})})}),s.jsx(Vt,{eventKey:"completion",title:"Section Completion",children:s.jsx("div",{className:"p-4",children:c.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Je,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Section"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Type"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Progress"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:c.map(S=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:S.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:S.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:S.subject})}),s.jsx("td",{children:s.jsx(Ne,{bg:"info",className:"fw-normal",children:S.section})}),s.jsx("td",{children:new Date(S.dueDate).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${S.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:[S.progress,"%"]})]})}),s.jsx("td",{children:g(S.status)}),s.jsx("td",{children:s.jsx(se,{variant:"primary",size:"sm",onClick:()=>N(S.id),children:S.status==="COMPLETED"?"View":"Complete"})})]},S.id))})]})})})})]})})})})})]})},Roe=()=>{const{traineeId:e}=gr();return s.jsx(_e,{className:"py-3",children:s.jsx(Poe,{traineeId:e})})},Loe=()=>{const{traineeId:e,assessmentId:t}=gr(),r=Ge(),[a,n]=Yu(),[i,l]=v.useState(null),[o,c]=v.useState(!0),[u,d]=v.useState("");v.useEffect(()=>{t&&m()},[t]),v.useEffect(()=>{if(i&&a.get("action")==="start"){n({});const w=i.sections?.find(N=>N.status!=="COMPLETED");w&&r(he.TRAINEE_ASSESSMENT_SECTION(w.id))}},[i,a,r,e,n]);const m=async()=>{try{c(!0),d(""),l({id:t,name:"Emergency Procedures Assessment",description:"Comprehensive assessment covering emergency evacuation procedures, safety protocols, and equipment handling.",course:{id:"course-1",name:"Emergency Procedures Training",code:"EPT2024"},subject:{id:"subject-1",name:"Safety Protocols",code:"SP101"},type:"PRACTICAL",status:"IN_PROGRESS",priority:"HIGH",dueDate:"2024-02-15T17:00:00.000Z",startDate:"2024-02-10T08:00:00.000Z",timeLimit:120,progress:60,score:null,maxScore:100,completedDate:null,sections:[{id:"section-1",name:"Emergency Evacuation Procedures",status:"COMPLETED",progress:100},{id:"section-2",name:"Safety Protocol Review",status:"IN_PROGRESS",progress:60},{id:"section-3",name:"Equipment Handling",status:"PENDING",progress:0}],requiresSignature:!0,signatureStatus:"PENDING",instructions:["Read each question carefully before answering","You have 120 minutes to complete this assessment","Save your progress regularly","Ensure all required sections are completed","Signature will be required upon completion"]})}catch(w){console.error("Error loading assessment details:",w),d("Failed to load assessment details"),te.error("Failed to load assessment details")}finally{c(!1)}},f=()=>{r(-1)},x=()=>{const w=i.sections.find(N=>N.status!=="COMPLETED");w?r(`/trainee/${e}/assessment-section/${w.id}`):te.info("Starting assessment...")},p=()=>{const w=i.sections.find(N=>N.status==="IN_PROGRESS");w?r(`/trainee/${e}/assessment-section/${w.id}`):x()},h=w=>{r(`/trainee/${e}/assessment-section/${w}`)},g=()=>{r(he.TRAINEE_SIGNATURE_PAD(t))},b=()=>{r(he.REPORTS_CREATE,{state:{assessmentId:t,assessmentName:i.name}})},j=w=>{const S={PENDING:{variant:"warning",text:"Pending",icon:Qe},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Ht},COMPLETED:{variant:"success",text:"Completed",icon:Je},OVERDUE:{variant:"danger",text:"Overdue",icon:Er}}[w]||{variant:"secondary",text:w,icon:Ht},E=S.icon;return s.jsxs(Ne,{bg:S.variant,className:"d-flex align-items-center",children:[s.jsx(E,{size:12,className:"me-1"}),S.text]})},y=w=>{const S={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[w]||{variant:"secondary",text:w};return s.jsx(Ne,{bg:S.variant,children:S.text})};return o?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment details..."})]})}):u||!i?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:u||"Assessment not found"}),s.jsxs(se,{variant:"outline-danger",onClick:f,children:[s.jsx(At,{className:"me-2",size:16}),"Back"]})]})}):s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:f,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(Ht,{className:"me-2",size:28}),i.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[i.course?.name||"Course","  ",i.subject?.name||"Subject"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[j(i.status),y(i.priority)]})]})})}),s.jsxs(oe,{children:[s.jsx(U,{lg:8,className:"mb-4",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsx(H.Body,{className:"p-0",children:s.jsxs(Ux,{defaultActiveKey:i.status==="COMPLETED"?"results":"overview",className:"border-bottom",children:[s.jsx(Vt,{eventKey:"overview",title:"Overview",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Description"}),s.jsx("p",{className:"text-muted",children:i.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Instructions"}),s.jsx("ul",{className:"list-unstyled",children:i.instructions.map((w,N)=>s.jsxs("li",{className:"mb-2",children:[s.jsx("span",{className:"text-primary me-2",children:""}),w]},N))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Assessment Sections"}),s.jsx("div",{className:"row",children:i.sections.map((w,N)=>s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx(H,{className:`${w.status==="COMPLETED"?"bg-light":""}`,children:s.jsxs(H.Body,{children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",N+1]}),j(w.status)]}),s.jsx("h6",{className:"mb-2",children:w.name}),s.jsx("div",{className:"progress mb-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${w.progress}%`}})}),s.jsx(se,{variant:w.status==="COMPLETED"?"outline-success":"primary",size:"sm",onClick:()=>h(w.id),children:w.status==="COMPLETED"?"View":w.status==="IN_PROGRESS"?"Continue":"Start"})]})})},w.id))})]}),s.jsxs("div",{className:"d-flex gap-2",children:[i.status==="PENDING"?s.jsxs(se,{variant:"primary",size:"lg",onClick:x,children:[s.jsx(Ht,{className:"me-2",size:20}),"Start Assessment"]}):i.status==="IN_PROGRESS"?s.jsxs(se,{variant:"primary",size:"lg",onClick:p,children:[s.jsx(Ht,{className:"me-2",size:20}),"Continue Assessment"]}):null,i.requiresSignature&&i.signatureStatus==="PENDING"&&s.jsxs(se,{variant:"outline-primary",size:"lg",onClick:g,children:[s.jsx(_n,{className:"me-2",size:20}),"Sign Document"]})]})]})}),s.jsx(Vt,{eventKey:"progress",title:"Progress",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Overall Progress"}),s.jsx("div",{className:"progress mb-2",style:{height:"20px"},children:s.jsxs("div",{className:"progress-bar bg-primary",style:{width:`${i.progress}%`},children:[i.progress,"%"]})}),s.jsxs("small",{className:"text-muted",children:[i.sections.filter(w=>w.status==="COMPLETED").length," of ",i.sections.length," sections completed"]})]}),s.jsx("h5",{children:"Section Progress"}),i.sections.map((w,N)=>s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",N+1,": ",w.name]}),s.jsxs("span",{className:"text-muted",children:[w.progress,"%"]})]}),s.jsx("div",{className:"progress",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${w.progress}%`}})})]},w.id))]})}),i.status==="COMPLETED"&&s.jsx(Vt,{eventKey:"results",title:"Results",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Assessment Score"}),i.score!==null?s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs("div",{className:"display-4 fw-bold text-primary me-3",children:[i.score," / ",i.maxScore]}),s.jsx("div",{children:s.jsxs(Ne,{bg:i.score>=i.maxScore*.8?"success":i.score>=i.maxScore*.6?"warning":"danger",className:"fs-6",children:[Math.round(i.score/i.maxScore*100),"%"]})})]}):s.jsx("p",{className:"text-muted",children:"Score pending review"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Section Results"}),i.sections?.map((w,N)=>s.jsx(H,{className:"mb-2",children:s.jsx(H.Body,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",N+1,": ",w.name]}),s.jsx(Ne,{bg:"success",className:"ms-2",children:"Completed"})]}),w.score!==void 0&&s.jsxs("div",{className:"text-end",children:[s.jsxs("div",{className:"fw-bold",children:[w.score," / ",w.maxScore||100]}),s.jsxs("small",{className:"text-muted",children:[Math.round(w.score/(w.maxScore||100)*100),"%"]})]})]})})},w.id))]})]})})]})})})}),s.jsx(U,{lg:4,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(vt,{className:"me-2",size:20}),"Assessment Information"]})}),s.jsxs(H.Body,{children:[s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Course"}),s.jsx("div",{className:"text-muted",children:i.course?.name||"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Subject"}),s.jsx("div",{className:"text-muted",children:i.subject?.name||"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Due Date"}),s.jsx("div",{className:"text-muted",children:i.dueDate?new Date(i.dueDate).toLocaleDateString():"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Time Limit"}),s.jsxs("div",{className:"text-muted",children:[i.timeLimit," minutes"]})]})]}),i.score!==null&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Je,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Score"}),s.jsxs("div",{className:"text-muted",children:[i.score," / ",i.maxScore]})]})]}),i.completedDate&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Completed Date"}),s.jsx("div",{className:"text-muted",children:new Date(i.completedDate).toLocaleDateString()})]})]})]})]}),i.requiresSignature&&s.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Signature Required"}),s.jsx("p",{className:"small text-muted mb-2",children:"This assessment requires a digital signature upon completion."}),i.signatureStatus==="PENDING"&&s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:g,children:[s.jsx(_n,{className:"me-2",size:14}),"Sign Now"]}),i.signatureStatus==="COMPLETED"&&s.jsx(Ne,{bg:"success",children:"Signed"})]}),s.jsx("div",{className:"mt-4",children:s.jsxs(se,{variant:"outline-secondary",className:"w-100",onClick:b,children:[s.jsx(Er,{className:"me-2",size:16}),"Report Issue / Feedback"]})})]})]})})]})]})},Foe=({show:e,onClose:t,onSave:r,documentName:a,loading:n=!1})=>{const i=v.useRef(null),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState("");v.useEffect(()=>{e&&(u(!1),m(""),f())},[e]);const f=()=>{const j=i.current;j&&(j.getContext("2d").clearRect(0,0,j.width,j.height),u(!1))},x=j=>{o(!0);const y=i.current,w=y.getBoundingClientRect(),N=y.getContext("2d");N.beginPath(),N.moveTo(j.clientX-w.left,j.clientY-w.top)},p=j=>{if(!l)return;const y=i.current,w=y.getBoundingClientRect(),N=y.getContext("2d");N.lineTo(j.clientX-w.left,j.clientY-w.top),N.stroke(),u(!0)},h=()=>{o(!1)},g=async()=>{if(!c){m("Please provide your signature before saving");return}try{const y=i.current.toDataURL("image/png");await r({documentName:a,signature:y,timestamp:new Date().toISOString()}),t()}catch{m("Failed to save signature. Please try again.")}},b=()=>{f(),m(""),t()};return s.jsxs(le,{show:e,onHide:b,size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(_n,{className:"me-2",size:20}),"Digital Signature"]}),s.jsx(se,{variant:"link",onClick:b,className:"text-white p-0",children:s.jsx(Xe,{size:24})})]}),s.jsxs(le.Body,{className:"p-4",children:[d&&s.jsx(ke,{variant:"danger",className:"mb-3",children:d}),s.jsxs("div",{className:"text-center mb-4",children:[s.jsxs("h5",{children:["Sign Document: ",a]}),s.jsx("p",{className:"text-muted",children:"Please sign in the box below using your mouse or touch device"})]}),s.jsx("div",{className:"signature-container border rounded p-3 mb-3",children:s.jsx("canvas",{ref:i,width:600,height:200,className:"border rounded w-100",style:{cursor:"crosshair",touchAction:"none"},onMouseDown:x,onMouseMove:p,onMouseUp:h,onMouseLeave:h,onTouchStart:j=>{j.preventDefault();const y=j.touches[0],w=new MouseEvent("mousedown",{clientX:y.clientX,clientY:y.clientY});x(w)},onTouchMove:j=>{j.preventDefault();const y=j.touches[0],w=new MouseEvent("mousemove",{clientX:y.clientX,clientY:y.clientY});p(w)},onTouchEnd:j=>{j.preventDefault(),h()}})}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs(se,{variant:"outline-secondary",onClick:f,disabled:n,children:[s.jsx(Yd,{className:"me-2",size:16}),"Clear"]}),s.jsx("div",{className:"text-muted small",children:c?s.jsx("span",{className:"text-success",children:" Signature captured"}):s.jsx("span",{children:"Please sign above"})})]}),s.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Signature Guidelines:"}),s.jsxs("ul",{className:"mb-0 small text-muted",children:[s.jsx("li",{children:"Sign within the designated area"}),s.jsx("li",{children:"Use your full legal signature"}),s.jsx("li",{children:"Ensure the signature is clear and readable"}),s.jsx("li",{children:'Click "Clear" to start over if needed'})]})]})]}),s.jsxs(le.Footer,{className:"border-0 p-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:b,disabled:n,children:[s.jsx(Xe,{className:"me-2",size:16}),"Cancel"]}),s.jsx(se,{variant:"primary",onClick:g,disabled:n||!c,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),"Save Signature"]})})]})]})},Moe=()=>{const{traineeId:e,documentId:t}=gr(),r=Ge(),a=async i=>{try{console.log("Signature saved:",i),te.success("Signature saved successfully"),r(he.ASSESSMENTS_DETAIL(t),{replace:!0})}catch(l){console.error("Error saving signature:",l),te.error("Failed to save signature")}},n=()=>{r(`/trainee/${e}/assessment/${t}`,{replace:!0})};return s.jsx(_e,{className:"py-3",children:s.jsx(Foe,{show:!0,documentName:`Document ${t}`,onClose:n,onSave:a})})},Boe=({traineeId:e,sectionId:t})=>{const r=Ge(),[a,n]=v.useState(null),[i,l]=v.useState(!0),[o,c]=v.useState("");v.useEffect(()=>{t&&u()},[t]);const u=async()=>{try{l(!0),c(""),n({id:t,name:"Emergency Evacuation Procedures",description:"Complete the emergency evacuation procedures assessment including both theoretical knowledge and practical demonstration.",course:"Emergency Procedures",subject:"Safety Protocols",type:"Practical Assessment",status:"IN_PROGRESS",progress:60,dueDate:"2024-02-12T14:00:00.000Z",timeLimit:120,questions:[{id:"1",type:"multiple_choice",question:"What is the first step in an emergency evacuation?",options:["Sound the alarm","Assess the situation","Call emergency services","Evacuate immediately"],correctAnswer:1,userAnswer:1,isAnswered:!0},{id:"2",type:"multiple_choice",question:"How many emergency exits should be available in a training facility?",options:["At least 1","At least 2","At least 3","At least 4"],correctAnswer:1,userAnswer:null,isAnswered:!1},{id:"3",type:"practical",question:"Demonstrate the proper use of emergency equipment",description:"Show how to properly use fire extinguisher and emergency lighting",isCompleted:!1,score:null}],instructions:["Read each question carefully before answering","For practical assessments, ensure you have the required equipment","You have 120 minutes to complete this assessment","Save your progress regularly","Contact your instructor if you encounter any technical issues"]})}catch(p){console.error("Error loading section details:",p),c("Failed to load assessment section details"),te.error("Failed to load assessment section details")}finally{l(!1)}},d=()=>{r(he.ASSESSMENTS_MY_ASSESSMENTS)},m=p=>{const g={PENDING:{variant:"warning",text:"Pending",icon:Qe},IN_PROGRESS:{variant:"info",text:"In Progress",icon:Ht},COMPLETED:{variant:"success",text:"Completed",icon:Je},OVERDUE:{variant:"danger",text:"Overdue",icon:Er}}[p]||{variant:"secondary",text:p,icon:Ht},b=g.icon;return s.jsxs(Ne,{bg:g.variant,className:"d-flex align-items-center",children:[s.jsx(b,{size:12,className:"me-1"}),g.text]})},f=()=>{te.info("Starting assessment section...")},x=()=>{te.info("Continuing assessment section...")};return i?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment section..."})]})}):o||!a?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:o||"Assessment section not found"}),s.jsxs(se,{variant:"outline-danger",onClick:d,children:[s.jsx(At,{className:"me-2",size:16}),"Back to Assessments"]})]})}):s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",onClick:d,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(Ht,{className:"me-2",size:28}),a.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[a.course,"  ",a.subject]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[m(a.status),s.jsx(Ne,{bg:"info",className:"fw-normal",children:a.type})]})]})})}),s.jsxs(oe,{children:[s.jsx(U,{lg:8,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Ht,{className:"me-2",size:20}),"Assessment Section Details"]})}),s.jsxs(H.Body,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Description"}),s.jsx("p",{className:"text-muted",children:a.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Instructions"}),s.jsx("ul",{className:"list-unstyled",children:a.instructions.map((p,h)=>s.jsxs("li",{className:"mb-2",children:[s.jsx("span",{className:"text-primary me-2",children:""}),p]},h))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Questions Overview"}),s.jsx("div",{className:"row",children:a.questions.map((p,h)=>s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs("div",{className:`p-3 border rounded ${p.isAnswered||p.isCompleted?"bg-light":""}`,children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Question ",h+1]}),p.isAnswered||p.isCompleted?s.jsx(Ne,{bg:"success",className:"small",children:"Completed"}):s.jsx(Ne,{bg:"warning",className:"small",children:"Pending"})]}),s.jsx("p",{className:"mb-0 small text-muted",children:p.type==="practical"?"Practical Assessment":"Multiple Choice"})]})},p.id))})]}),s.jsx("div",{className:"d-flex justify-content-center",children:a.status==="PENDING"?s.jsxs(se,{variant:"primary",size:"lg",onClick:f,children:[s.jsx(Vx,{className:"me-2",size:20}),"Start Assessment"]}):s.jsxs(se,{variant:"primary",size:"lg",onClick:x,children:[s.jsx(Ht,{className:"me-2",size:20}),"Continue Assessment"]})})]})]})}),s.jsx(U,{lg:4,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Qe,{className:"me-2",size:20}),"Assessment Information"]})}),s.jsxs(H.Body,{children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Time Limit"}),s.jsxs("div",{className:"text-muted",children:[a.timeLimit," minutes"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Due Date"}),s.jsx("div",{className:"text-muted",children:new Date(a.dueDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ht,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Total Questions"}),s.jsx("div",{className:"text-muted",children:a.questions.length})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("span",{className:"fw-semibold",children:"Progress"}),s.jsxs("span",{className:"text-muted",children:[a.progress,"%"]})]}),s.jsx(Zh,{now:a.progress,variant:"primary",className:"mb-3"}),s.jsx("div",{className:"text-center",children:s.jsxs("small",{className:"text-muted",children:[a.questions.filter(p=>p.isAnswered||p.isCompleted).length," of ",a.questions.length," questions completed"]})})]}),s.jsxs("div",{className:"mt-4 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Assessment Tips:"}),s.jsxs("ul",{className:"mb-0 small text-muted",children:[s.jsx("li",{children:"Read questions carefully"}),s.jsx("li",{children:"Manage your time wisely"}),s.jsx("li",{children:"Save progress regularly"}),s.jsx("li",{children:"Review answers before submitting"})]})]})]})]})})]})]})},zoe=()=>{const{traineeId:e,sectionId:t}=gr();return s.jsx(_e,{className:"py-3",children:s.jsx(Boe,{traineeId:e,sectionId:t})})},Uoe=`
  .training-progress-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .training-progress-card .card-header h5 {
    color: #ffffff !important;
  }
  .assessments-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .assessments-card .card-header h5 {
    color: #ffffff !important;
  }
  .quick-actions-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .quick-actions-card .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Uoe,document.head.appendChild(e)}const S2=()=>{const e=Ge(),t=[{title:"Academic Details",description:"Track your learning progress and achievements",icon:Ft,path:he.TRAINEE_ACADEMIC_DETAILS,color:"primary"},{title:"Your Courses",description:"Check your enrolled courses and progress",icon:It,path:he.COURSES_ENROLLED,color:"success"},{title:"All Assessments",description:"View pending assessments and tasks",icon:Ht,path:he.ASSESSMENTS_MY_ASSESSMENTS,color:"warning"},{title:"Create Issue Report",description:"Report issues or provide feedback",icon:Er,path:he.REPORTS_CREATE,color:"danger"}];return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs(H,{className:"border-0 shadow-sm quick-actions-card",children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Quick Actions"})}),s.jsx(H.Body,{children:s.jsx(oe,{children:t.map((r,a)=>{const n=r.icon;return s.jsx(U,{lg:6,xl:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(H.Body,{className:"p-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:`bg-${r.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:s.jsx(n,{size:24})}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("h5",{className:"mb-1",children:r.title})}),s.jsx(un,{size:20,className:"text-muted"})]}),s.jsx("p",{className:"text-muted mb-0",children:r.description})]})})},a)})})})]})})}),s.jsxs(oe,{className:"mt-4",children:[s.jsx(U,{lg:6,className:"d-flex",children:s.jsxs(H,{className:"border-0 shadow-sm w-100 training-progress-card",children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Training Progress"})}),s.jsx(H.Body,{className:"d-flex flex-column justify-content-center",children:s.jsxs("div",{className:"text-center py-4",children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"display-4 text-primary fw-bold",children:"0%"}),s.jsx("p",{className:"text-muted mb-0",children:"Overall Progress"})]}),s.jsx("div",{className:"progress mb-3",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:"0%"}})}),s.jsx("p",{className:"text-muted small mb-0",children:"Complete your enrolled courses to see progress."})]})})]})}),s.jsx(U,{lg:6,className:"d-flex",children:s.jsxs(H,{className:"border-0 shadow-sm w-100 assessments-card",children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Assessments Required Confirmations"})}),s.jsx(H.Body,{className:"d-flex flex-column justify-content-center",children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Ht,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No assessments pending"}),s.jsx("p",{className:"text-muted small mb-3",children:"View and complete signature required assessments."}),s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>e(he.ASSESSMENTS_SIGNATURE_REQUIRED),className:"d-flex align-items-center justify-content-center mx-auto",children:[s.jsx(Ht,{size:16,className:"me-2"}),"Go to Assessments",s.jsx(un,{size:16,className:"ms-2"})]})]})})]})})]})]})},$oe=()=>{const e=Ge(),{user:t}=xs(),[r,a]=v.useState(!0),[n,i]=v.useState(null);v.useEffect(()=>{l()},[]);const l=async()=>{try{a(!0);const u={totalCourses:8,completedCourses:3,inProgressCourses:2,pendingCourses:3,totalAssessments:15,completedAssessments:8,pendingAssessments:7,overallProgress:65,courses:[{id:1,name:"Safety Procedures Training",code:"SAF001",progress:100,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations",code:"FLT002",progress:75,status:"in-progress",startDate:"2024-01-20"},{id:3,name:"Emergency Response",code:"EMG003",progress:45,status:"in-progress",startDate:"2024-02-01"},{id:4,name:"Technical Systems",code:"TECH004",progress:0,status:"pending",startDate:"2024-02-15"}],recentAssessments:[{id:1,name:"Safety Training Assessment",course:"Safety Procedures Training",score:95,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations Quiz",course:"Flight Operations",score:88,status:"completed",completedDate:"2024-01-25"},{id:3,name:"Emergency Response Test",course:"Emergency Response",score:null,status:"pending",dueDate:"2024-02-10"}]};await new Promise(d=>setTimeout(d,500)),i(u)}catch(u){console.error("Error loading academic data:",u)}finally{a(!1)}},o=u=>{switch(u){case"completed":return"success";case"in-progress":return"warning";case"pending":return"secondary";default:return"secondary"}},c=u=>{switch(u){case"completed":return s.jsx(Je,{className:"text-success"});case"in-progress":return s.jsx(Qe,{className:"text-warning"});case"pending":return s.jsx(Qe,{className:"text-muted"});default:return s.jsx(Qe,{className:"text-muted"})}};return r?s.jsx(_e,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading academic details..."})]})}):n?s.jsxs(_e,{className:"py-4 academic-details",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-secondary",size:"sm",className:"me-3",onClick:()=>e(-1),children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Academic Details"}),s.jsx("p",{className:"text-muted mb-0",children:"Track your learning progress and achievements"})]})]})})}),s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{lg:3,md:6,className:"mb-3",children:s.jsx(H,{className:"border-0 shadow-sm h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(It,{size:32,className:"text-primary mb-2"}),s.jsx("h4",{className:"mb-1",children:n.totalCourses}),s.jsx("p",{className:"text-muted mb-0",children:"Total Courses"})]})})}),s.jsx(U,{lg:3,md:6,className:"mb-3",children:s.jsx(H,{className:"border-0 shadow-sm h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(dS,{size:32,className:"text-success mb-2"}),s.jsx("h4",{className:"mb-1",children:n.completedCourses}),s.jsx("p",{className:"text-muted mb-0",children:"Completed"})]})})}),s.jsx(U,{lg:3,md:6,className:"mb-3",children:s.jsx(H,{className:"border-0 shadow-sm h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(Qe,{size:32,className:"text-warning mb-2"}),s.jsx("h4",{className:"mb-1",children:n.inProgressCourses}),s.jsx("p",{className:"text-muted mb-0",children:"In Progress"})]})})}),s.jsx(U,{lg:3,md:6,className:"mb-3",children:s.jsx(H,{className:"border-0 shadow-sm h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(Ht,{size:32,className:"text-info mb-2"}),s.jsx("h4",{className:"mb-1",children:n.completedAssessments}),s.jsx("p",{className:"text-muted mb-0",children:"Assessments Done"})]})})})]}),s.jsx(oe,{className:"mb-5",children:s.jsx(U,{children:s.jsxs(H,{className:"border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsx("h5",{className:"mb-0",children:"Overall Learning Progress"})}),s.jsxs(H.Body,{children:[s.jsxs("div",{className:"text-center mb-3",children:[s.jsxs("h2",{className:"text-primary mb-1",children:[n.overallProgress,"%"]}),s.jsx("p",{className:"text-muted mb-0",children:"Complete your courses to improve progress"})]}),s.jsx(Zh,{now:n.overallProgress,variant:"primary",style:{height:"12px"},className:"mb-3"}),s.jsx(oe,{className:"text-center",children:s.jsx(U,{children:s.jsxs("small",{className:"text-muted",children:[n.completedCourses," of ",n.totalCourses," courses completed"]})})})]})]})})}),s.jsxs(oe,{className:"mt-4",children:[s.jsx(U,{lg:8,className:"mb-4 pe-3",children:s.jsxs(H,{className:"border-0 shadow-sm h-100",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(It,{className:"me-2"}),"Course Progress"]})}),s.jsx(H.Body,{children:n.courses.map(u=>s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:u.name}),s.jsx("small",{className:"text-muted",children:u.code})]}),s.jsx("div",{className:"d-flex align-items-center",children:s.jsx(Ne,{variant:o(u.status),children:u.status.replace("-"," ")})})]}),s.jsx(Zh,{now:u.progress,variant:u.progress===100?"success":"primary",style:{height:"8px"}}),s.jsxs("div",{className:"d-flex justify-content-between mt-1",children:[s.jsxs("small",{className:"text-muted",children:[u.progress,"% complete"]}),u.status==="completed"&&s.jsxs("small",{className:"text-success",children:["Completed: ",new Date(u.completedDate).toLocaleDateString()]})]})]},u.id))})]})}),s.jsx(U,{lg:4,className:"mb-4 ps-3",children:s.jsxs(H,{className:"border-0 shadow-sm h-100",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Ht,{className:"me-2"}),"Recent Assessments"]})}),s.jsx(H.Body,{children:n.recentAssessments.map(u=>s.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[s.jsx("h6",{className:"mb-1",children:u.name}),c(u.status)]}),s.jsx("small",{className:"text-muted d-block mb-1",children:u.course}),u.status==="completed"?s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsxs(Ne,{variant:"success",children:["Score: ",u.score]}),s.jsx("small",{className:"text-muted",children:new Date(u.completedDate).toLocaleDateString()})]}):s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsx(Ne,{variant:"warning",children:"Pending"}),s.jsxs("small",{className:"text-muted",children:["Due: ",new Date(u.dueDate).toLocaleDateString()]})]})]},u.id))})]})})]})]}):s.jsx(_e,{className:"py-4",children:s.jsx(ke,{variant:"danger",children:"Failed to load academic details. Please try again later."})})},Woe=()=>{const{user:e}=xs();return e?s.jsx(_e,{className:"py-3",children:s.jsx($oe,{})}):s.jsx(_e,{className:"py-3",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{children:"Please log in to view your academic details."})})})},E2=({uniqueLevels:e,uniqueStatuses:t,selectedLevels:r,selectedStatuses:a,onLevelToggle:n,onStatusToggle:i,onClearFilters:l,className:o=""})=>{const c=r.length>0||a.length>0;return s.jsxs(kt,{className:`filter-panel-dropdown course-filter-dropdown ${o}`,children:[s.jsx(kt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ol,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(kt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Levels"}),r.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(u=>s.jsx(I.Check,{type:"checkbox",id:`level-${u}`,label:u,checked:r.includes(u),onChange:()=>n(u),className:"mb-1"},u))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Statuses"}),a.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(u=>s.jsx(I.Check,{type:"checkbox",id:`status-${u}`,label:u,checked:a.includes(u),onChange:()=>i(u),className:"mb-1"},u))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:l,children:[s.jsx(Xe,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},I4=document.createElement("style");I4.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(I4);const Hoe=`
  .course-list-table-no-borders .table,
  .course-list-table-no-borders .table td,
  .course-list-table-no-borders .table th,
  .course-list-table-no-borders .table tbody tr,
  .course-list-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .course-list-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .course-list-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Hoe,document.head.appendChild(e)}const Voe=({traineeId:e})=>{const t=Ge(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(""),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,x]=v.useState("upcoming"),p=[...new Set(r.map(R=>R.level).filter(Boolean))],h=[...new Set(r.map(R=>R.status).filter(Boolean))],g=R=>r.filter(M=>{switch(R){case"upcoming":return M.status==="PLANNED";case"ongoing":return M.status==="ON-GOING";case"completed":return M.status==="COMPLETED";default:return!0}}),b=g(f),j=v.useMemo(()=>b.filter(R=>{const M=!l||R.name.toLowerCase().includes(l.toLowerCase())||R.code.toLowerCase().includes(l.toLowerCase())||R.description.toLowerCase().includes(l.toLowerCase()),X=c.length===0||c.includes(R.level),ie=d.length===0||d.includes(R.status);return M&&X&&ie}),[b,l,c,d]),{sortedData:y,sortConfig:w,handleSort:N}=ur(j);v.useEffect(()=>{e&&S()},[e]);const S=async()=>{try{i(!0);const R=[{id:"1",code:"SAF001",name:"Safety Procedures Training",description:"Basic safety procedures and emergency protocols",level:"BEGINNER",status:"ON-GOING",startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-03-15T17:00:00.000Z",progress:75,department:{id:1,name:"Safety Department",code:"SAF"}},{id:"2",code:"FLT002",name:"Flight Operations",description:"Advanced flight operations and navigation",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-04-01T16:00:00.000Z",progress:45,department:{id:2,name:"Flight Operations",code:"FO"}},{id:"3",code:"EMG003",name:"Emergency Response",description:"Emergency response and crisis management",level:"ADVANCED",status:"COMPLETED",startDate:"2023-11-01T09:00:00.000Z",endDate:"2023-12-15T17:00:00.000Z",progress:100,department:{id:3,name:"Emergency Services",code:"EMG"}},{id:"4",code:"TECH004",name:"Technical Systems",description:"Aircraft technical systems and maintenance",level:"INTERMEDIATE",status:"PLANNED",startDate:"2024-03-01T09:00:00.000Z",endDate:"2024-05-01T17:00:00.000Z",progress:0,department:{id:4,name:"Technical Department",code:"TECH"}},{id:"5",code:"NAV005",name:"Navigation Systems",description:"Advanced navigation and GPS systems",level:"ADVANCED",status:"COMPLETED",startDate:"2023-09-01T09:00:00.000Z",endDate:"2023-10-15T17:00:00.000Z",progress:100,department:{id:5,name:"Navigation Department",code:"NAV"}},{id:"6",code:"COMM006",name:"Communication Protocols",description:"Radio communication and protocols",level:"BEGINNER",status:"PLANNED",startDate:"2024-04-01T09:00:00.000Z",endDate:"2024-06-01T17:00:00.000Z",progress:0,department:{id:6,name:"Communication Department",code:"COMM"}},{id:"7",code:"MAINT007",name:"Aircraft Maintenance",description:"Routine maintenance procedures",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-01-20T08:00:00.000Z",endDate:"2024-03-20T16:00:00.000Z",progress:60,department:{id:7,name:"Maintenance Department",code:"MAINT"}},{id:"8",code:"ARCH008",name:"Archived Course",description:"This course has been archived",level:"BEGINNER",status:"ARCHIVED",startDate:"2023-06-01T09:00:00.000Z",endDate:"2023-08-01T17:00:00.000Z",progress:100,department:{id:8,name:"Archived Department",code:"ARCH"}}];await new Promise(M=>setTimeout(M,300)),a(R)}catch(R){console.error("Error loading trainee courses:",R),te.error("Failed to load enrolled courses")}finally{i(!1)}},E=R=>{const X={"ON-GOING":{variant:"success",text:"On-going"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[R]||{variant:"secondary",text:R};return s.jsx(Ne,{bg:X.variant,children:X.text})},_=R=>{const X={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[R]||{variant:"secondary",text:R};return s.jsx(Ne,{bg:X.variant,children:X.text})},T=R=>{t(`/trainee/${e}/course/${R.id}`)},C=R=>{u(R==="clear"?[]:M=>M.includes(R)?M.filter(X=>X!==R):[...M,R])},A=R=>{m(R==="clear"?[]:M=>M.includes(R)?M.filter(X=>X!==R):[...M,R])},D=()=>{u([]),m([]),o("")},P=({columnKey:R,children:M,className:X=""})=>{const ie=w.key===R,ae=ie?w.direction:null;return s.jsxs("th",{className:`fw-semibold ${X}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>N(R),onMouseEnter:V=>{V.target.style.backgroundColor="#214760",V.target.style.transform="translateY(-1px)",V.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:V=>{V.target.style.backgroundColor="var(--bs-primary)",V.target.style.transform="translateY(0)",V.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:ie?"600":"500",color:"white"},children:M}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:ae,size:14,color:"white"})})]}),ie&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return n?s.jsx(zt,{rows:5,columns:8}):r.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No enrolled courses"}),s.jsx("p",{children:"You are not enrolled in any courses yet."})]})}):j.length===0&&(l||c.length>0||d.length>0)?s.jsx("div",{children:s.jsx(H,{className:"border-0 shadow-sm mb-2",children:s.jsxs(Vt.Container,{activeKey:f,onSelect:x,children:[s.jsx(H.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(pt,{variant:"tabs",className:"border-0",children:[s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"upcoming",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="upcoming"?"600":"400",opacity:f==="upcoming"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Qe,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"ongoing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="ongoing"?"600":"400",opacity:f==="ongoing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(op,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="completed"?"600":"400",opacity:f==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Je,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]})}),s.jsx(H.Body,{className:"p-0",children:s.jsx(Vt.Content,{children:s.jsxs(Vt.Pane,{eventKey:f,children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search courses by name, code, or description...",value:l,onChange:o,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(E2,{uniqueLevels:p,uniqueStatuses:h,selectedLevels:c,selectedStatuses:d,onLevelToggle:C,onStatusToggle:A,onClearFilters:D,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[j.length," course",j.length!==1?"s":""]})})})]}),s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No courses found"}),s.jsx("p",{children:"Try adjusting your search criteria or filters."}),s.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:D,children:"Clear Filters"})]})})]})})})]})})}):s.jsx("div",{children:s.jsx(H,{className:"border-0 shadow-sm mb-2",children:s.jsxs(Vt.Container,{activeKey:f,onSelect:x,children:[s.jsx(H.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(pt,{variant:"tabs",className:"border-0",children:[s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"upcoming",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="upcoming"?"600":"400",opacity:f==="upcoming"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Qe,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"ongoing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="ongoing"?"600":"400",opacity:f==="ongoing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(op,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),s.jsx(pt.Item,{children:s.jsxs(pt.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="completed"?"600":"400",opacity:f==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Je,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]})}),s.jsx(H.Body,{className:"p-0",children:s.jsx(Vt.Content,{children:s.jsxs(Vt.Pane,{eventKey:f,children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search courses by name, code, or description...",value:l,onChange:o,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(E2,{uniqueLevels:p,uniqueStatuses:h,selectedLevels:c,selectedStatuses:d,onLevelToggle:C,onStatusToggle:A,onClearFilters:D,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[j.length," course",j.length!==1?"s":""]})})})]}),s.jsx("div",{className:"scrollable-table-container admin-table course-list-table-no-borders",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(P,{columnKey:"code",className:"show-mobile",children:"Course Code"}),s.jsx(P,{columnKey:"name",className:"show-mobile",children:"Course Name"}),s.jsx(P,{columnKey:"level",className:"show-mobile",children:"Level"}),s.jsx(P,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(P,{columnKey:"startDate",className:"hide-mobile",children:"Start Date"}),s.jsx(P,{columnKey:"endDate",className:"hide-mobile",children:"End Date"}),s.jsx(P,{columnKey:"progress",className:"show-mobile",children:"Progress"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:y.map((R,M)=>s.jsxs("tr",{className:`${M%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:X=>{X.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:X=>{X.currentTarget.style.backgroundColor=M%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(Ne,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:R.code})}),s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:R.name}),s.jsx("small",{className:"text-muted",children:R.description})]}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:_(R.level)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:E(R.status)}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:R.startDate?new Date(R.startDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:R.endDate?new Date(R.endDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${R.progress||0}%`}})}),s.jsxs("small",{className:"text-muted",children:[R.progress||0,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.VIEW_COURSE_IN_DETAIL],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Course Details",icon:s.jsx(St,{}),onClick:()=>T(R),permission:fe.VIEW_COURSE_IN_DETAIL}]})})})]},R.id))})]})})]})})})]})})})},Goe=()=>{const{user:e}=xs();return e?s.jsx(_e,{className:"py-3",children:s.jsx(Voe,{traineeId:e.id})}):s.jsx(_e,{className:"py-3",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{children:"Please log in to view your enrolled courses."})})})};function qoe(e){const t=String(e||"").toUpperCase();return t==="SIGNATURE_IMAGE"?"SIGNATURE_IMG":(["TEXT","IMAGE","TOGGLE","PART","SECTION_CONTROL_TOGGLE","SIGNATURE_DRAW","SIGNATURE_IMG","FINAL_SCORE_TEXT","FINAL_SCORE_NUM","VALUE_LIST"].includes(t),e)}function Zn(){try{const r=localStorage.getItem("templateInfo");if(r){const a=JSON.parse(r);return{id:a.id||null,currentTemplateId:a.currentTemplateId||null,originalTemplateId:a.originalTemplateId||null,name:a.name||"",description:a.description||"",departmentId:a.departmentId||"",templateContent:a.templateContent||"",templateConfig:a.templateConfig||null,templateContentMediaId:a.templateContentMediaId||null,editorDocumentUrl:a.editorDocumentUrl||""}}}catch{}const e=localStorage.getItem("currentTemplateId"),t=localStorage.getItem("originalTemplateId");return{id:null,currentTemplateId:e||null,originalTemplateId:t||null,name:localStorage.getItem("templateName")||"",description:localStorage.getItem("templateDesc")||"",departmentId:localStorage.getItem("departmentId")||"",templateContent:localStorage.getItem("templateContent")||"",templateConfig:null,templateContentMediaId:null,editorDocumentUrl:""}}function T2(e,t,r=null){const a={};if(r&&Array.isArray(r)){console.log(` Existing fields count: ${r.length}`),r.forEach(l=>{if(l.fieldType==="PART"&&l.id&&l.fieldName){const o=`${l.fieldName}-parent`;a[o]=l.id,console.log(` Mapped PART field: tempId="${o}"  id="${l.id}"`)}});const i=r.filter(l=>l.parentId);console.log(" Child fields with parentId:",i.map(l=>({fieldName:l.fieldName,fieldType:l.fieldType,parentId:l.parentId,id:l.id})))}const n=(t||[]).map((i,l)=>{const o=i.fields||[],c={};for(const p of o)if(String(p.fieldType||"").toUpperCase()==="PART"){const h=p.fieldName||p.name||"",g=p.tempId||(h?`${h}-parent`:void 0);g&&(c[h]=g)}const d=o.map(p=>{const h=p.parentTempId;return h&&c[h]?{...p,parentTempId:c[h]}:p}).map((p,h)=>({...p,__idx:h})),m=d.filter(p=>!p.parentTempId).sort((p,h)=>p.__idx-h.__idx),f=[];for(const p of m){f.push(p);const h=String(p.fieldType||"").toUpperCase()==="PART"?p.tempId||c[p.fieldName||p.name||""]||(p.fieldName||p.name?`${p.fieldName||p.name}-parent`:void 0):null;if(h){const g=d.filter(b=>b.parentTempId===h).sort((b,j)=>b.__idx-j.__idx);f.push(...g)}}if(f.length!==d.length){const p=new Set(f.map(h=>h.__idx));d.filter(h=>!p.has(h.__idx)).sort((h,g)=>h.__idx-g.__idx).forEach(h=>f.push(h))}const x=f.map((p,h)=>{const g=String(p.fieldType||"").toUpperCase().startsWith("SIGNATURE"),b=String(p.fieldType||"").toUpperCase(),j=qoe(p.fieldType),y=p.fieldName||p.name||"";y||console.warn(" Field missing fieldName/name:",p);const w={label:p.label,fieldName:y,fieldType:j,displayOrder:h+1};if(r)if(w.parentTempId=p.parentTempId?p.parentTempId:null,p.parentTempId&&a[p.parentTempId]){let N=r.find(S=>S.fieldName===y&&S.fieldType===j&&S.id);N&&N.id?(w.id=N.id,console.log(` Added id="${w.id}" for child field "${y}" (parentTempId="${p.parentTempId}") (for update)`)):console.warn(` Could not find existing child field: fieldName="${y}", fieldType="${j}"`)}else{const N=r.find(S=>S.fieldName===y&&S.fieldType===j&&!S.parentId&&S.id);N&&N.id&&(w.id=N.id,console.log(` Added id="${w.id}" for top-level field "${y}" (for update)`))}else w.parentTempId=p.parentTempId?p.parentTempId:null;if(g&&(w.roleRequired=p.roleRequired||"TRAINER"),b==="PART"){const N=y||"";if(w.tempId=p.tempId||(N?`${N}-parent`:void 0),r){const S=r.find(E=>E.fieldType==="PART"&&(E.fieldName===y||E.fieldName===p.name)&&E.id);S&&S.id&&(w.id=S.id,console.log(` Added id="${w.id}" for PART field "${y}" (for update)`))}}if(b==="VALUE_LIST")if(console.log(" VALUE_LIST field found:",{fieldName:y,label:p.label,hasOption:!!p.option,option:p.option,optionType:typeof p.option}),p.option)try{const N=JSON.parse(p.option);N.items&&Array.isArray(N.items)?(w.options={items:N.items},console.log(" VALUE_LIST options parsed successfully:",w.options)):console.warn(" VALUE_LIST option missing items array:",N)}catch(N){console.warn(" Failed to parse VALUE_LIST option:",N,"Raw option:",p.option)}else console.warn(" VALUE_LIST field missing option field:",{fieldName:y,label:p.label,field:p});return w});return{label:i.label,displayOrder:l+1,editBy:i.editBy||"TRAINER",roleInSubject:i.roleInSubject?i.roleInSubject:null,isSubmittable:!!i.isSubmittable,isToggleDependent:!!i.isToggleDependent,fields:x}});return{name:e.name,description:e.description,departmentId:e.departmentId,templateContent:e.templateContent,templateConfig:e.templateConfig||null,sections:n}}function z1(e){return Array.isArray(e)?e.map(t=>{const r=(t.fields||[]).filter(i=>i.fieldType==="PART"),a={};r.forEach(i=>{const l=`${i.fieldName}-parent`;a[i.id]=l});const n=(t.fields||[]).map(i=>{let l=i.fieldType||"TEXT";l==="SIGNATURE_IMG"&&(l="SIGNATURE_IMAGE");const o={label:i.label||"",fieldName:i.fieldName||"",fieldType:l,roleRequired:i.roleRequired||null,parentTempId:null,option:null};if(i.parentId){const c=t.fields.find(u=>u.id===i.parentId);c&&c.fieldType==="PART"&&(o.parentTempId=`${c.fieldName}-parent`)}if(i.fieldType==="PART"&&(o.tempId=`${i.fieldName}-parent`),i.fieldType==="VALUE_LIST"&&i.options)try{o.option=JSON.stringify(i.options)}catch(c){console.warn("Failed to stringify VALUE_LIST options:",c)}return o});return{name:t.label||t.name||"",label:t.label||t.name||"",displayOrder:t.displayOrder||1,editBy:t.editBy||"TRAINER",roleInSubject:t.roleInSubject||"",isSubmittable:!!t.isSubmittable,isToggleDependent:!!t.isToggleDependent,fields:n}}):[]}function Koe(e){let t=[],r=[];if(e?.sections&&Array.isArray(e.sections)?r=e.sections:e?.fields&&Array.isArray(e.fields)?t=e.fields:Array.isArray(e)?t=e:e?.data?.fields&&Array.isArray(e.data.fields)?t=e.data.fields:e?.data?.sections&&Array.isArray(e.data.sections)&&(r=e.data.sections),r.length>0)return z1(r);if(t.length>0){const a=t.map(u=>{let d=u.fieldType||"TEXT";d==="SIGNATURE_IMG"&&(d="SIGNATURE_IMAGE");const m={label:u.label||u.fieldName||"",fieldName:u.fieldName||u.name||"",fieldType:d,roleRequired:u.roleRequired||null,parentTempId:u.parentTempId||null,tempId:u.tempId||null,option:null};if(d==="PART"&&(m.tempId=u.tempId||(m.fieldName?`${m.fieldName}-parent`:null)),d==="VALUE_LIST"&&u.options)try{m.option=JSON.stringify(u.options)}catch(f){console.warn("Failed to stringify VALUE_LIST options:",f)}return m}),n=a.filter(u=>u.fieldType==="PART"),i=a.filter(u=>u.parentTempId),l=a.filter(u=>!u.parentTempId&&u.fieldType!=="PART"),o=[];return n.forEach(u=>{o.push(u);const d=i.filter(m=>m.parentTempId===u.tempId);o.push(...d)}),o.push(...l),[{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:o.length>0?o:a}]}return[]}const Yoe=({show:e,onHide:t,onImportSuccess:r,onImportError:a})=>{const n=Ge(),[i,l]=v.useState("with-fields"),[o,c]=v.useState(null),[u,d]=v.useState(!1),[m,f]=v.useState({name:"",description:"",departmentId:""}),[x,p]=v.useState([]),[h,g]=v.useState(!1),b=v.useRef(null);v.useEffect(()=>{e&&j()},[e]);const j=async()=>{try{g(!0);const S=await Mt.getPublicDepartments();p(S)}catch(S){console.error("Error loading departments:",S),te.error("Failed to load departments"),p([])}finally{g(!1)}},y=S=>{const E=S.target.files[0];if(E){const _=[".docx"],T=E.name.toLowerCase().substring(E.name.lastIndexOf("."));if(!_.includes(T)){te.error("Please select a valid Word document file (.docx)");return}if(E.size>10*1024*1024){te.error("File size must be less than 10MB");return}c(E)}},w=async()=>{if(!o){te.error("Please select a file to import");return}d(!0);try{const S=ii.getDocsType(o.name),E=await ii.uploadDocument(o,S);let _;if(E.data&&E.data.length>0&&E.data[0].url)_=E.data[0].url,console.log(` Form Template Upload Success! Document URL: ${_}`);else throw new Error("Invalid response format from upload API");if(i==="with-fields"){console.log(" Extracting fields from file (File with Fields flow)...");try{const T=await cr.extractFields(_);console.log(" Extract fields response:",T);const C=Koe(T);console.log(" Converted to frontend sections:",C);const A={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:"",fileName:o.name.replace(".docx",""),importType:"File with fields",createdAt:new Date().toISOString(),editorDocumentUrl:_};localStorage.setItem("templateInfo",JSON.stringify(A)),console.log(" Template info saved to localStorage:",A),n(he.TEMPLATES_EDITOR,{state:{documentUrl:_,fileName:A.fileName,importType:"File with fields",templateInfo:A,initialSections:C}}),N(),r("File with fields",o.name)}catch(T){console.error(" Failed to extract fields:",T);const C=T?.response?.data?.message||T?.message||"Failed to extract fields from file. You can still add fields manually.";te.warning(C);const A={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:"",fileName:o.name.replace(".docx",""),importType:"File with fields",createdAt:new Date().toISOString(),editorDocumentUrl:_};localStorage.setItem("templateInfo",JSON.stringify(A)),console.log(" Template info saved to localStorage (without extracted fields):",A),n("/templates/editor",{state:{documentUrl:_,fileName:A.fileName,importType:"File with fields",templateInfo:A,initialSections:[]}}),N(),r("File with fields",o.name)}}else{console.log(" Checking if file contains fields (File without Fields flow)...");try{const T=await cr.extractFields(_);if(T?.fields&&Array.isArray(T.fields)&&T.fields.length>0||T?.totalFields&&T.totalFields>0){te.error('Your template already have field. Please use "File with Fields" import type instead.'),d(!1);return}console.log(" File does not contain fields, proceeding with import...");const A={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:_,fileName:o.name.replace(".docx",""),importType:"File without fields",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(A)),console.log(" Template info saved to localStorage:",A),n("/templates/editor",{state:{documentUrl:_,fileName:A.fileName,importType:"File without fields",templateInfo:A}}),N(),r("File without fields",o.name)}catch(T){console.error(" Failed to extract fields:",T);const C=T?.response?.data?.message||T?.message||"Failed to validate file. Please try again.";te.error(C),d(!1);return}}}catch(S){a(S.message||"Import failed")}finally{d(!1)}},N=()=>{c(null),l("with-fields"),f({name:"",description:"",departmentId:""}),b.current&&(b.current.value=""),t()};return s.jsxs(le,{show:e,onHide:N,size:"lg",centered:!0,className:"import-file-modal",dialogClassName:"import-file-modal-dialog",children:[s.jsx(le.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Ts,{className:"me-2",size:20}),"Import Form File"]})}),s.jsxs(le.Body,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Select Import Type"}),s.jsxs(oe,{className:"g-3 import-type-row",children:[s.jsx(U,{xs:12,sm:12,md:6,className:"import-type-col",children:s.jsx(H,{className:`import-type-card ${i==="with-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>l("with-fields"),style:{cursor:"pointer"},children:s.jsx(H.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:s.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[s.jsx(Ju,{size:48,className:"text-primary mb-3"}),s.jsx("h6",{className:"text-primary mb-2",children:"Upload Pre-configured File"})]})})})}),s.jsx(U,{xs:12,sm:12,md:6,className:"import-type-col",children:s.jsx(H,{className:`import-type-card ${i==="without-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>l("without-fields"),style:{cursor:"pointer"},children:s.jsx(H.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:s.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[s.jsx(qi,{size:48,className:"text-success mb-3"}),s.jsx("h6",{className:"text-success mb-2",children:"Start From Blank"})]})})})})]})]}),!i&&s.jsxs(ke,{variant:"info",className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Please select an import type"}),s.jsx("p",{className:"mb-0 small",children:'Choose between "Upload Pre-configured File" or "Start From Blank" above to continue with the import process.'})]}),(i==="without-fields"||i==="with-fields")&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Fill in Basic Template Information"}),s.jsx(I,{children:s.jsxs(oe,{className:"g-3",children:[s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Template Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:m.name,onChange:S=>f(E=>({...E,name:S.target.value})),required:!0})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Description ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:m.description,onChange:S=>f(E=>({...E,description:S.target.value})),required:!0})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(I.Select,{value:m.departmentId,onChange:S=>f(E=>({...E,departmentId:S.target.value})),required:!0,disabled:h,children:[s.jsx("option",{value:"",children:"Select Department"}),x.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))]}),h&&s.jsx(I.Text,{className:"text-muted",children:"Loading departments..."}),m.templateContent&&s.jsxs(I.Text,{className:"text-muted",children:["Template Content: ",m.templateContent]})]})})]})})]}),i&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Select File"}),s.jsxs(I.Group,{children:[s.jsx(I.Control,{ref:b,type:"file",accept:".docx",onChange:y,className:"mb-2"}),s.jsx(I.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]})]}),o&&s.jsx(ke,{variant:"info",className:"mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(qi,{className:"me-2",size:20}),s.jsxs("div",{children:[s.jsx("strong",{children:"Selected File:"})," ",o.name,s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Size: ",(o.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),s.jsxs(le.Footer,{className:"border-0 p-3 p-md-3 d-flex flex-column flex-md-row gap-2 gap-md-2 justify-content-end",children:[s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:N,disabled:u,className:"w-100 w-md-auto order-2 order-md-1",children:[s.jsx(Xe,{className:"me-2",size:14}),"Cancel"]}),i==="with-fields"&&s.jsx(se,{variant:"primary-custom",size:"sm",onClick:w,disabled:!o||!m.name||!m.description||!m.departmentId||u,className:"w-100 w-md-auto order-1 order-md-2",children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ts,{className:"me-2",size:14}),"Import File"]})}),i==="without-fields"&&s.jsx(se,{variant:"primary-custom",size:"sm",onClick:w,disabled:!o||!m.name||!m.description||!m.departmentId||u,className:"w-100 w-md-auto order-1 order-md-2",children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ts,{className:"me-2",size:14}),"Import File"]})})]})]})},O4=({show:e,onHide:t,template:r,onCreateVersion:a})=>{const[n,i]=v.useState("details"),[l,o]=v.useState(null),[c,u]=v.useState(!1),[d,m]=v.useState(null),[f,x]=v.useState(!1),[p,h]=v.useState(null),[g,b]=v.useState(!1);if(v.useEffect(()=>{(async()=>{if(r?.reviewedByUserId&&e)try{u(!0);const C=await $s.getUserById(r.reviewedByUserId),A=C.data||C;o(A)}catch(C){console.error("Error fetching reviewed by user:",C),o(null)}finally{u(!1)}else o(null)})()},[r?.reviewedByUserId,e]),v.useEffect(()=>{(async()=>{if(r?.id&&e&&!r.sections)try{x(!0);const C=await cr.getTemplateById(r.id),A=C.data||C;m(A)}catch(C){console.error("Error fetching full template data:",C),m(null)}finally{x(!1)}else r?.sections?m(r):m(null)})()},[r?.id,e,r?.sections]),v.useEffect(()=>((async()=>{if(n==="content"&&r?.id&&e)try{b(!0);const C=r.formId||r.id,A=await cr.getTemplatePDF(C),D=URL.createObjectURL(A);h(D)}catch(C){console.error("Error loading PDF:",C),h(null)}finally{b(!1)}else h(C=>(C&&URL.revokeObjectURL(C),null))})(),()=>{h(C=>(C&&URL.revokeObjectURL(C),null))}),[n,r?.id,r?.formId,e]),!r)return null;const j=T=>{if(!T)return"N/A";try{return new Date(T).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return T}},y=T=>{const C={PENDING:{variant:"warning",icon:Qe,text:"PENDING"},PUBLISHED:{variant:"success",icon:Je,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:vt,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:vt,text:"ARCHIVED"}},A=C[T]||C.DRAFT,D=A.icon;return s.jsxs(Ne,{bg:A.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(D,{size:12}),A.text]})},w=()=>{a?a(r):(console.log("Create new version for template:",r.id),t())},N=()=>s.jsx("div",{className:"template-details",style:{flex:1,display:"flex",flexDirection:"column"},children:s.jsxs("div",{className:"list-group list-group-flush",style:{flex:1},children:[s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Template Name"}),s.jsx("span",{className:"text-dark",children:r.name})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ls,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Department"}),s.jsx("span",{className:"text-dark",children:r.department?.name||"N/A"}),r.department?.code&&s.jsx("small",{className:"text-muted d-block",children:r.department.code})]})]})}),r.description&&s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Description"}),s.jsx("span",{className:"text-dark",children:r.description})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Je,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Status"}),s.jsx("div",{children:y(r.status)})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Version"}),s.jsxs("span",{className:"text-dark",children:["Version ",r.version]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Sections"}),s.jsxs("span",{className:"text-dark",children:[r._count?.sections||0," ",r._count?.sections===1?"section":"sections"]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created By"}),s.jsxs("span",{className:"text-dark",children:[r.createdByUser?.firstName||""," ",r.createdByUser?.lastName||""]}),s.jsxs("small",{className:"text-muted d-block",children:[s.jsx(xr,{className:"me-1",size:12}),j(r.createdAt)]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Last Updated"}),s.jsx("span",{className:"text-dark",children:j(r.updatedAt)})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Je,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Reviewed By"}),r.reviewedByUserId?s.jsx(s.Fragment,{children:c?s.jsx("span",{className:"text-muted",children:"Loading..."}):l?s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"text-dark",children:[l.firstName||""," ",l.lastName||""]}),r.reviewedAt&&s.jsxs("small",{className:"text-muted d-block",children:[s.jsx(xr,{className:"me-1",size:12}),j(r.reviewedAt)]})]}):s.jsxs("span",{className:"text-muted",children:["User ID: ",r.reviewedByUserId]})}):s.jsx("span",{className:"text-muted",children:"Not reviewed"})]})]})})]})}),S=()=>{const T=d?.sections||r?.sections||[];if(f)return s.jsx("div",{className:"text-center",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs("div",{children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading template config..."})]})});const C=[];return T.forEach((A,D)=>{C.push({type:"section",id:A.id||`section-${D}`,name:A.label||A.name,fieldCount:A.fields?.length||0,data:A}),A.fields&&A.fields.length>0&&A.fields.forEach((P,R)=>{C.push({type:"field",id:P.id||P.fieldName||`field-${D}-${R}`,name:P.label||P.fieldName,parentSectionId:A.id||`section-${D}`,data:P})})}),C.length===0?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsx(ke,{variant:"info",className:"mb-0",style:{maxWidth:"600px",width:"100%"},children:s.jsxs("div",{children:[s.jsx("strong",{children:"No template config found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no sections or fields yet."})]})})}):s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[s.jsx("h6",{className:"mb-3",style:{color:"#333",fontWeight:500},children:"Template fields & sections"}),s.jsx("div",{className:"list-group",style:{border:"none",flex:1,overflowY:"auto"},children:C.map((A,D)=>{const P=A.type==="section",R=A.type==="field";return s.jsx("div",{className:"list-group-item",style:{border:"none",borderBottom:"1px solid #e9ecef",padding:"12px 16px",backgroundColor:"white",paddingLeft:R?"40px":"16px"},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{className:"d-flex align-items-center",style:{flex:1,minWidth:0},children:[s.jsx("span",{style:{fontSize:"14px",color:"#333",fontWeight:P?500:400,wordBreak:"break-word",overflowWrap:"break-word"},children:A.name}),P&&A.fieldCount>0&&s.jsx(Ne,{bg:"info",className:"ms-2",style:{fontSize:"11px",padding:"2px 8px",borderRadius:"12px",backgroundColor:"#0dcaf0",color:"#000"},children:A.fieldCount})]}),s.jsx(Ne,{bg:P?"warning":"secondary",style:{fontSize:"11px",padding:"4px 10px",borderRadius:"4px",backgroundColor:P?"#ffc107":"var(--bs-secondary)",color:P?"#000":"#fff",fontWeight:500,marginLeft:"12px"},children:P?"SECTION":A.data?.fieldType||A.data?.type||"FIELD"})]})},A.id)})})]})},E=()=>{const T=[];return f?s.jsx("div",{className:"text-center",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs("div",{children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading version history..."})]})}):T.length===0?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsx(ke,{variant:"info",className:"mb-0",style:{maxWidth:"600px",width:"100%"},children:s.jsxs("div",{children:[s.jsx("strong",{children:"No version history found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no previous versions."})]})})}):s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[s.jsx("div",{className:"mb-3",children:s.jsx("h6",{className:"mb-0",children:"Version History"})}),s.jsx("div",{className:"list-group",style:{flex:1,overflowY:"auto"},children:T.map((C,A)=>s.jsx("div",{className:"list-group-item",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("h6",{className:"mb-1",children:["Version ",C.version]}),s.jsxs("small",{className:"text-muted",children:[j(C.createdAt||C.updatedAt),C.createdByUser&&s.jsxs(s.Fragment,{children:["  ",C.createdByUser.firstName," ",C.createdByUser.lastName]})]})]}),s.jsx(Ne,{bg:C.status==="PUBLISHED"?"success":"warning",children:C.status})]})},C.id||A))})]})},_=()=>g?s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs("div",{className:"text-center",children:[s.jsx(xt,{animation:"border",variant:"primary",className:"mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"Loading PDF preview..."})]})}):p?s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minHeight:0},children:s.jsx("iframe",{src:p,style:{width:"100%",height:"100%",border:"1px solid #dee2e6",borderRadius:"0.375rem",display:"block",flex:1,minHeight:0},title:"Template PDF Preview"})}):s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs(ke,{variant:"warning",className:"mb-0",style:{maxWidth:"600px",width:"100%"},children:[s.jsx(Nc,{className:"me-2"}),"PDF preview is not available. Please try again or contact support."]})});return s.jsxs(le,{show:e,onHide:t,size:"lg",centered:!0,className:"template-detail-modal",dialogClassName:"template-detail-modal-dialog",contentClassName:"template-detail-modal-content",children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0 template-detail-header d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[s.jsxs(le.Title,{className:"d-flex align-items-center text-white mb-0 template-detail-title flex-grow-1",style:{minWidth:0},children:[s.jsx(vt,{className:"me-2 flex-shrink-0",size:20}),s.jsxs("span",{className:"template-detail-title-text text-truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:`Template Detail: ${r.name}`,children:[s.jsx("span",{className:"d-none d-md-inline",children:"Template Detail: "}),r.name]})]}),s.jsx(se,{variant:"link",onClick:t,className:"text-white p-0 flex-shrink-0",style:{border:"none",background:"none",opacity:.9,color:"#ffffff !important",marginLeft:"1rem"},children:s.jsx(Xe,{size:24,color:"#ffffff"})})]}),s.jsxs(le.Body,{className:"p-0 template-detail-body",style:{height:"70vh",maxHeight:"70vh",overflowY:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:[s.jsx("div",{className:"bg-primary-custom text-white template-detail-tabs-container",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex border-bottom border-white border-opacity-25 template-detail-tabs",style:{overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:[s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${n==="details"?"border-bottom border-white border-3":""}`,onClick:()=>i("details"),style:{fontWeight:n==="details"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(vt,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Details"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${n==="overview"?"border-bottom border-white border-3":""}`,onClick:()=>i("overview"),style:{fontWeight:n==="overview"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(Z2,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Template Config Overview"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Overview"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${n==="history"?"border-bottom border-white border-3":""}`,onClick:()=>i("history"),style:{fontWeight:n==="history"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(H2,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-lg-inline",children:"List History Version"}),s.jsx("span",{className:"d-inline d-lg-none d-sm-inline",children:"History"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${n==="content"?"border-bottom border-white border-3":""}`,onClick:()=>i("content"),style:{fontWeight:n==="content"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(St,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Content Preview"})]})]})}),s.jsx("div",{className:"p-3 p-md-4 template-detail-content",style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,overflow:"hidden",height:"100%"},children:s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:[n==="details"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:N()}),n==="overview"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:S()}),n==="history"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:E()}),n==="content"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:_()})]})})]}),s.jsxs(le.Footer,{className:"bg-light border-0 template-detail-footer d-flex flex-wrap gap-2",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)",justifyContent:"flex-end"},children:[s.jsx(se,{variant:"secondary",onClick:t,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#ffffff",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#3a5a6f",T.currentTarget.style.borderColor="#3a5a6f",T.currentTarget.style.color="#ffffff"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="var(--bs-secondary)",T.currentTarget.style.borderColor="var(--bs-secondary)",T.currentTarget.style.color="#ffffff"},children:"Close"}),a&&s.jsxs(se,{variant:"primary",onClick:w,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-primary)",borderColor:"var(--bs-primary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#153a4a",T.currentTarget.style.borderColor="#153a4a",T.currentTarget.style.transform="translateY(-1px)",T.currentTarget.style.boxShadow="0 4px 8px rgba(27, 60, 83, 0.3)"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="var(--bs-primary)",T.currentTarget.style.borderColor="var(--bs-primary)",T.currentTarget.style.transform="translateY(0)",T.currentTarget.style.boxShadow="none"},children:[s.jsx(q2,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Create New Version"}),s.jsx("span",{className:"d-inline d-sm-none",children:"New Version"})]}),r.templateConfig&&s.jsxs(se,{variant:"primary",href:r.templateConfig,target:"_blank",rel:"noopener noreferrer",className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-primary)",borderColor:"var(--bs-primary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease",textDecoration:"none"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#153a4a",T.currentTarget.style.borderColor="#153a4a",T.currentTarget.style.transform="translateY(-1px)",T.currentTarget.style.boxShadow="0 4px 8px rgba(27, 60, 83, 0.3)"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="var(--bs-primary)",T.currentTarget.style.borderColor="var(--bs-primary)",T.currentTarget.style.transform="translateY(0)",T.currentTarget.style.boxShadow="none"},children:[s.jsx(Ln,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Download File"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Download"})]})]})]})},Xoe=({show:e,onHide:t})=>{const r=Ge(),[a,n]=v.useState([]),[i,l]=v.useState(!1),[o,c]=v.useState(null),[u,d]=v.useState(!1);v.useEffect(()=>{e&&m()},[e]);const m=async()=>{try{l(!0);const h=await cr.getTemplates({status:"PUBLISHED"});let g=[];h.success&&h.data?g=h.data:Array.isArray(h)?g=h:h.data&&Array.isArray(h.data)&&(g=h.data),n(g)}catch(h){console.error("Error loading published templates:",h),te.error("Failed to load published templates"),n([])}finally{l(!1)}},f=h=>{c(h),d(!0)},x=async h=>{try{const g=await cr.getTemplateById(h.id);if(!g||!g.data){te.error("Failed to load template details");return}const b=g.data,j=b.templateForm||b,y=b.sections||[],w=z1(y),N={name:j.name||h.name,description:j.description||h.description,departmentId:j.departmentId||h.departmentId,templateContent:j.templateContent||"",templateConfig:j.templateConfig||"",originalTemplateId:h.id,importType:"Create Version",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(N)),console.log(" Template info saved for version creation:",N),console.log(" Frontend sections:",w),r(he.TEMPLATES_EDITOR,{state:{documentUrl:j.templateConfig||j.templateContent||"",fileName:j.name||"Untitled Document",importType:"Create Version",templateInfo:N,initialSections:w}}),t(),te.success("Template loaded. You can now create a new version.")}catch(g){console.error("Error creating version:",g),te.error("Failed to load template for version creation")}},p=h=>{if(!h)return"N/A";try{return new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return h}};return s.jsxs(s.Fragment,{children:[s.jsxs(le,{show:e,onHide:t,size:"xl",centered:!0,className:"published-templates-modal",fullscreen:"md-down",children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(vt,{className:"me-2",size:20}),"Create New Template's Version"]}),s.jsx(se,{variant:"link",onClick:t,className:"text-white p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1},children:s.jsx(Xe,{size:24})})]}),s.jsx(le.Body,{style:{maxHeight:"70vh",overflowY:"auto",overflowX:"hidden"},className:"published-templates-modal-body",children:i?s.jsx(zt,{}):a.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(vt,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No published templates found"}),s.jsx("p",{className:"text-muted",children:"There are no published templates available to create a new version."})]}):s.jsx(oe,{className:"g-3",children:a.map(h=>s.jsx(U,{xs:12,sm:6,md:6,lg:4,children:s.jsx(H,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease",cursor:"pointer"},onMouseEnter:g=>{g.currentTarget.style.transform="translateY(-5px)",g.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:g=>{g.currentTarget.style.transform="translateY(0)",g.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(H.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(vt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:h.name,children:h.name}),s.jsxs("small",{className:"text-muted",children:["v",h.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4"},title:h.description||"No description",children:h.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ls,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:h.department?.code||"N/A",children:h.department?.code||"N/A"})]}),s.jsxs(Ne,{bg:"success",className:"d-flex align-items-center gap-1",children:[s.jsx(Je,{size:12}),"PUBLISHED"]})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ft,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:`${h.createdByUser?.firstName||""} ${h.createdByUser?.lastName||""}`.trim(),children:[h.createdByUser?.firstName," ",h.createdByUser?.lastName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:p(h.createdAt)})]}),s.jsxs("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center",children:[s.jsx(vt,{size:12,className:"me-1"}),h._count?.sections||0," sections"]}),s.jsxs(se,{variant:"link",size:"sm",className:"p-0 text-primary-custom",onClick:g=>{g.stopPropagation(),f(h)},style:{whiteSpace:"nowrap"},children:[s.jsx(St,{size:14,className:"me-1"}),"View Detail"]})]}),s.jsxs(se,{variant:"primary-custom",size:"sm",className:"w-100 d-flex align-items-center justify-content-center",onClick:g=>{g.stopPropagation(),x(h)},children:[s.jsx(un,{size:14,className:"me-2"}),"Create New Version"]})]})]})})},h.id))})}),s.jsx(le.Footer,{className:"border-0",children:s.jsx(se,{variant:"outline-secondary",onClick:t,children:"Close"})})]}),s.jsx(O4,{show:u,onHide:()=>{d(!1),c(null)},template:o,onCreateVersion:h=>{d(!1),x(h)}})]})},Joe=()=>{const e=Ge(),[t]=Yu(),[r,a]=v.useState(!1),[n,i]=v.useState([]),[l,o]=v.useState(!0),[c,u]=v.useState(null),[d,m]=v.useState(!1),[f,x]=v.useState(!1);v.useEffect(()=>{p()},[]),v.useEffect(()=>{if(t.get("action")==="create"){a(!0);const S=new URLSearchParams(t);S.delete("action");const E=S.toString();e({search:E?`?${E}`:""},{replace:!0})}},[]);const p=async()=>{try{o(!0);const N=await cr.getTemplates({status:"PENDING"});let S=[];N.success&&N.data?S=N.data:Array.isArray(N)?S=N:N.data&&Array.isArray(N.data)&&(S=N.data);const E=S.filter(_=>_.status==="PENDING");i(E)}catch(N){console.error("Error loading templates:",N),te.error("Failed to load templates"),i([])}finally{o(!1)}},h=()=>{a(!0)},g=()=>{a(!1),p()},b=N=>{te.error(`Import failed: ${N}`,{icon:!1})},j=N=>{u(N),m(!0)},y=N=>{const S={PENDING:{variant:"warning",icon:Qe,text:"PENDING"},PUBLISHED:{variant:"success",icon:Je,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:vt,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:vt,text:"ARCHIVED"}},E=S[N]||S.DRAFT,_=E.icon;return s.jsxs(Ne,{bg:E.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(_,{size:12}),E.text]})},w=N=>{if(!N)return"N/A";try{return new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return N}};return s.jsx(_e,{fluid:!0,className:"py-4 forms-page form-component",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53"},children:s.jsxs(oe,{className:"align-items-center",children:[s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(vt,{className:"me-2 text-white",size:24}),s.jsx("h4",{className:"mb-0 text-white",children:"Template List"})]})}),s.jsx(U,{xs:"auto",children:s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(se,{variant:"outline-light",onClick:()=>e(he.TEMPLATES_DRAFTS),className:"d-flex align-items-center",size:"sm",children:[s.jsx(vt,{className:"me-2",size:16}),"Your Drafts"]}),s.jsxs(Ar,{permission:fe.CREATE_TEMPLATE,fallback:null,children:[s.jsxs(se,{variant:"outline-light",onClick:()=>x(!0),className:"d-flex align-items-center",size:"sm",children:[s.jsx(vt,{className:"me-2",size:16}),"Create New Template's Version"]}),s.jsxs(se,{variant:"primary-custom",onClick:h,className:"d-flex align-items-center",size:"sm",children:[s.jsx(Ts,{className:"me-2",size:16}),"Create New Template"]})]})]})})]})}),s.jsxs(H.Body,{children:[l?s.jsx(zt,{}):n.length===0?s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(qi,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No form templates found"}),s.jsx("p",{className:"text-muted mb-4",children:"Get started by creating a new form or importing an existing file."})]})})}):s.jsx(oe,{className:"g-3 g-md-4",children:n.map(N=>s.jsx(U,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(H,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease"},onMouseEnter:S=>{S.currentTarget.style.transform="translateY(-5px)",S.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:S=>{S.currentTarget.style.transform="translateY(0)",S.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(H.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(vt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:N.name,children:N.name}),s.jsxs("small",{className:"text-muted",children:["v",N.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:N.description||"No description",children:N.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ls,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:N.department?.code||"N/A",children:N.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:y(N.status)})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ft,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:`${N.createdByUser?.firstName||""} ${N.createdByUser?.lastName||""}`.trim(),children:[N.createdByUser?.firstName," ",N.createdByUser?.lastName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:w(N.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center flex-shrink-0",children:[s.jsx(vt,{size:12,className:"me-1"}),N._count?.sections||0," sections"]}),s.jsxs(se,{variant:"link",size:"sm",className:"p-0 text-primary-custom flex-shrink-0 ms-2",onClick:S=>{S.stopPropagation(),j(N)},style:{whiteSpace:"nowrap"},children:[s.jsx(St,{size:14,className:"me-1"}),"Preview"]})]})})]})})},N.id))}),s.jsx(Yoe,{show:r,onHide:()=>a(!1),onImportSuccess:g,onImportError:b}),s.jsx(O4,{show:d,onHide:()=>{m(!1),u(null)},template:c}),s.jsx(Xoe,{show:f,onHide:()=>x(!1)})]})]})})};function Md(e){const t=(e.fieldName||"").trim(),r=e.parentTempId||null;return`${t}|${r||"null"}`}function Zoe(e){return Array.isArray(e)?e.flatMap(t=>(t.fields||[]).map(a=>{const n=(a.fieldName||a.name||"").trim(),i=(a.fieldType||"").trim(),l=a.parentTempId||null;return{fieldName:n,fieldType:i,parentTempId:l}})):[]}function Qoe(e){let t=[];return Array.isArray(e)?t=e:e?.fields&&Array.isArray(e.fields)?t=e.fields:e?.data?.fields&&Array.isArray(e.data.fields)?t=e.data.fields:e?.data&&Array.isArray(e.data)&&(t=e.data),t.map(r=>({fieldName:(r.fieldName||"").trim(),fieldType:(r.fieldType||"").trim(),parentTempId:r.parentTempId||null}))}function ece(e,t){const r=Qoe(e),a=Zoe(t);console.log(" [Field Validator] Debug Info:"),console.log("   Normalized Extract Fields:",r),console.log("   Flattened Payload Fields:",a);const n=new Set(a.map(Md)),i=new Set(r.map(Md));console.log("   Payload Keys:",Array.from(n)),console.log("   Extract Keys:",Array.from(i));const l=r.filter(x=>{const p=Md(x),h=n.has(p);return h||console.log(`   Missing in Schema: ${p} (fieldName: ${x.fieldName}, fieldType: ${x.fieldType}, parentTempId: ${x.parentTempId})`),!h}),o=a.filter(x=>{const p=Md(x),h=i.has(p);return h||console.log(`   Missing in Document: ${p} (fieldName: ${x.fieldName}, fieldType: ${x.fieldType}, parentTempId: ${x.parentTempId})`),!h}),c=[...new Set(l.map(x=>x.fieldName))],u=[...new Set(o.map(x=>x.fieldName))],d=l.length===0&&o.length===0;let m="",f="";return l.length>0&&(c.length===1?m=`Field "${c[0]}" is not in the Available Custom Fields. Please remove it from the editor or add it through the side panel.`:m=`The following fields are not in the Available Custom Fields: ${c.join(", ")}. Please remove them from the editor or add them through the side panel.`),o.length>0&&(u.length===1?f=`Field "${u[0]}" is in the Available Custom Fields but not found in the editor. Please insert it into the editor using the "Insert Field" button.`:f=`The following fields are in the Available Custom Fields but not found in the editor: ${u.join(", ")}. Please insert them into the editor using the "Insert Field" button.`),{isValid:d,missingInSchema:c,missingInDocument:u,errorMessage:m,warningMessage:f,totalExtractFields:r.length,totalPayloadFields:a.length}}const tce=({customFields:e=[],onAddField:t,onRemoveField:r,onInsertField:a,exportEditedDoc:n,exportAndUploadEditedDoc:i,forceSaveAndPoll:l,getDocumentKey:o,addSystemFieldToSectionRef:c,initialSections:u=null,readOnly:d=!1,className:m="",onSubmittingChange:f})=>{const x=Ge(),[p,h]=v.useState([]);v.useEffect(()=>{u&&Array.isArray(u)&&u.length>0&&p.length===0&&(console.log(" Restoring sections from draft:",u),h(u))},[u]);const[g,b]=v.useState({}),[j,y]=v.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null}),[w,N]=v.useState({fromIndex:null,overIndex:null,position:"above"}),S=v.useRef(new Set),[E,_]=v.useState(!1),[T,C]=v.useState(null),[A,D]=v.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[P,R]=v.useState(["TRAINER","TRAINEE"]),[M,X]=v.useState(!1),[ie,ae]=v.useState(!1),[V,me]=v.useState(null),[ue,F]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"TRAINER",parentTempId:null,option:null}),[Y,z]=v.useState([]),[k,O]=v.useState("");v.useEffect(()=>{e&&e.length>0&&p.length===0&&h([{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[...e]}])},[]),v.useEffect(()=>(c&&(c.current={getSections:()=>p,addSystemField:(pe,ce)=>{if(pe===null||pe<0||pe>=p.length)return te.error("Invalid section index"),!1;const we=p[pe],Ve=we.fields||[];if(Ve.some(Ct=>Ct.fieldName===ce.fieldName))return te.warning(`Field "${ce.fieldName}" already exists in this section`),!1;const $e={...ce,roleRequired:ce.roleRequired||we.editBy||"TRAINER"},qe=[...p];if(qe[pe]={...we,fields:[...Ve,$e]},h(qe),t){const Ct=qe.flatMap(mr=>mr.fields||[]);setTimeout(()=>{t(Ct)},0)}return!0},buildAndSubmitDraftTemplate:async pe=>{try{console.log(" Building and submitting draft template..."),console.log(" Draft URL (OnlyOffice):",pe);let ce=null;const we=Zn();try{console.log(" Uploading from OnlyOffice URL to S3...");const Rt=`${(we.name||"template").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase().substring(0,50)}_draft.docx`;if(console.log(" File name for upload:",Rt),ce=await ii.uploadFromUrl(pe,Rt),ce)console.log(" Upload from URL success! S3 URL:",ce);else throw console.warn(" No S3 URL received from upload-from-url"),new Error("Failed to upload to S3")}catch(ot){throw console.error(" Upload from URL failed:",ot),te.error("Could not upload draft document to S3"),ot}const Ve=Zn(),$e=Ve.originalTemplateId,qe=Ve.currentTemplateId||Ve.id||localStorage.getItem("currentTemplateId");let Ct=null;if(qe&&!$e)try{console.log(" Loading existing draft fields for parentId conversion...");const ot=await cr.getTemplateById(qe);Ct=(ot?.data?.sections||ot?.data?.data?.sections||[]).flatMap(Rt=>Rt.fields||[]),console.log(` Loaded ${Ct.length} existing fields for conversion`)}catch(ot){console.warn(" Failed to load existing draft fields, will use parentTempId:",ot)}const mr={...we,templateContent:we.templateContent,templateConfig:ce},et=T2(mr,p,Ct),gt={name:et.name,description:et.description,departmentId:et.departmentId,templateContent:et.templateContent,templateConfig:et.templateConfig||null,status:"DRAFT",sections:et.sections};if(console.log(" Draft template payload built:"),console.log("   templateContent (file import):",gt.templateContent),console.log("   templateConfig (file  chnh sa):",gt.templateConfig||"null"),console.log("   Status:",gt.status),console.log("   Using existingFields for conversion:",Ct?"Yes":"No"),console.log(` Full payload:
`,JSON.stringify(gt,null,2)),console.log(" Checking flow type:"),console.log("   freshMeta.originalTemplateId:",$e),console.log("   freshMeta.currentTemplateId:",Ve.currentTemplateId),console.log("   freshMeta.id:",Ve.id),console.log('   localStorage.getItem("currentTemplateId"):',localStorage.getItem("currentTemplateId")),console.log("   Final originalTemplateId:",$e),console.log("   Final currentTemplateId:",qe),$e){console.log(" Creating new draft for version (with originalTemplateId):",$e);const ot={originalTemplateId:$e,...gt};try{const Ze=await cr.createVersion(ot),Lt=(Ze?.data?.templateForm||Ze?.data?.data?.templateForm||Ze?.data?.data?.template||Ze?.data?.template)?.id||Ze?.data?.id||Ze?.data?.data?.id||Ze?.data?.data?.templateForm?.id||Ze?.data?.data?.template?.id||Ze?.data?.template?.id||(Ze?.data?.data?.template?Ze.data.data.template.id:null);if(Lt){const W={...Zn(),currentTemplateId:Lt};localStorage.setItem("templateInfo",JSON.stringify(W)),localStorage.setItem("currentTemplateId",Lt),console.log(" Saved currentTemplateId:",Lt)}return te.success("Draft template saved successfully!"),console.log(" Draft version created successfully:",Ze?.data??Ze),Ze?.data??Ze}catch(Ze){const Rt=Ze?.response?.data?.message||Ze?.message||"";if((Ze?.response?.statusCode||Ze?.response?.status)===400&&(Rt.includes("already exists")||Rt.includes("Template name")||Rt.toLowerCase().includes("duplicate"))){console.log(" Template name already exists, retrying without name..."),te.warning("Template name already exists. System will auto-generate a new name...");const W={originalTemplateId:$e,description:gt.description,departmentId:gt.departmentId,templateContent:gt.templateContent,templateConfig:gt.templateConfig||null,status:"DRAFT",sections:gt.sections};try{const Q=await cr.createVersion(W),K=(Q?.data?.templateForm||Q?.data?.data?.templateForm||Q?.data?.data?.template||Q?.data?.template)?.id||Q?.data?.id||Q?.data?.data?.id||Q?.data?.data?.templateForm?.id||Q?.data?.data?.template?.id||Q?.data?.template?.id||(Q?.data?.data?.template?Q.data.data.template.id:null);if(K){const re={...Zn(),currentTemplateId:K};localStorage.setItem("templateInfo",JSON.stringify(re)),localStorage.setItem("currentTemplateId",K),console.log(" Saved currentTemplateId (retry):",K)}return te.success("Draft template saved successfully with auto-generated name!"),console.log(" Draft version created successfully (retry):",Q?.data??Q),Q?.data??Q}catch(Q){throw console.error(" Retry failed:",Q),Q}}else throw Ze}}else if(qe){console.log(" Updating existing draft:",qe);const ot=await Ce.put(`/templates/update-draft/${qe}`,{...gt,id:qe,status:"DRAFT"});return te.success("Draft template saved successfully!"),console.log(" Draft updated successfully:",ot?.data??ot),ot?.data??ot}else{console.log(" Creating new draft");const ot=await Ce.post("/templates",gt);console.log(" Response structure check:"),console.log("   Full res?.data:",JSON.stringify(ot?.data,null,2)),console.log("   res?.data?.id:",ot?.data?.id),console.log("   res?.data?.data:",ot?.data?.data),console.log("   res?.data?.data?.id:",ot?.data?.data?.id),console.log("   res?.data?.data?.templateForm?.id:",ot?.data?.data?.templateForm?.id),console.log("   res?.data?.data?.template?.id:",ot?.data?.data?.template?.id),console.log("   res?.data?.template?.id:",ot?.data?.template?.id);const Ze=ot?.data?.id||ot?.data?.data?.id||ot?.data?.data?.templateForm?.id||ot?.data?.data?.template?.id||ot?.data?.template?.id||(ot?.data?.data?.template?ot.data.data.template.id:null);if(console.log("   Extracted newTemplateId:",Ze),Ze){const Lt={...Zn(),currentTemplateId:Ze};localStorage.setItem("templateInfo",JSON.stringify(Lt)),localStorage.setItem("currentTemplateId",Ze),console.log(" Saved currentTemplateId:",Ze),console.log(" Updated templateInfo:",Lt)}else console.warn(" No template ID found in response! Response structure:",ot?.data);return te.success("Draft template saved successfully!"),console.log(" Draft created successfully:",ot?.data??ot),ot?.data??ot}}catch(ce){console.error(" Error building/submitting draft template:",ce);const we=ce.response?.data?.message||ce.message||"Unknown error";throw te.error(we),ce}}}),()=>{c&&(c.current=null)}),[p,c,t]);const G=()=>{C(null),D({name:"",label:"",displayOrder:p.length+1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),_(!0)},Z=pe=>{if(d)return;const ce=p[pe];ce&&(C(pe),D({name:ce.name||ce.label||"",label:ce.label||"",displayOrder:ce.displayOrder||pe+1,editBy:ce.editBy||"TRAINER",roleInSubject:ce.roleInSubject||"",isSubmittable:ce.isSubmittable!==void 0?ce.isSubmittable:!0,isToggleDependent:ce.isToggleDependent!==void 0?ce.isToggleDependent:!1,fields:ce.fields||[]}),_(!0))},ee=pe=>{b(ce=>({...ce,[pe]:!ce[pe]}))},de=(pe,ce,we)=>{ce===null||we===null||ce===we||h(Ve=>{const $e=[...Ve],qe=[...$e[pe]?.fields||[]],[Ct]=qe.splice(ce,1);if(qe.splice(we,0,Ct),$e[pe]={...$e[pe],fields:qe},t){const mr=$e.flatMap(et=>et.fields||[]);setTimeout(()=>{t(mr,{silent:!0})},0)}return $e})},Ee=(pe,ce)=>{pe===null||ce===null||pe===ce||h(we=>{const Ve=[...we],[$e]=Ve.splice(pe,1);return Ve.splice(ce,0,$e),Ve})},B=(pe,ce,we,Ve)=>{if(d||pe===null||ce===null||we===null)return;if(pe===we){de(pe,ce,Ve);return}const $e=`${pe}-${ce}-${we}`,qe=S.current.size;S.current.add($e);const Ct=S.current.size;if(qe===Ct){console.warn(" Move operation already in progress, skipping...",$e);return}h(mr=>{const et=[...mr],gt=et[pe],ot=et[we];if(!gt||!ot)return setTimeout(()=>{S.current.delete($e)},0),mr;const Ze=[...gt.fields||[]],Rt=[...ot.fields||[]];if(ce<0||ce>=Ze.length)return console.warn(" Invalid fromFieldIndex:",ce,"Fields length:",Ze.length),setTimeout(()=>{S.current.delete($e)},0),mr;const Lt=Ze[ce];if(!Lt)return console.warn(" Field not found at index:",ce),setTimeout(()=>{S.current.delete($e)},0),mr;console.log(" moveFieldBetweenSections:",{fromFieldIndex:ce,fieldToMove:Lt.label||Lt.fieldName,fieldType:Lt.fieldType,parentTempId:Lt.parentTempId,allFields:Ze.map((re,xe)=>({idx:xe,label:re.label||re.fieldName,type:re.fieldType,parent:re.parentTempId}))});const Us=String(Lt.fieldType||"").toUpperCase()==="PART",W=Us?Lt.tempId||`${Lt.fieldName}-parent`:null,Q=[Lt],q=new Set([ce]);Us&&W&&Ze.forEach((re,xe)=>{re.parentTempId===W&&xe!==ce&&(console.log("   Adding child:",{idx:xe,label:re.label||re.fieldName,parentTempId:re.parentTempId}),Q.push(re),q.add(xe))}),console.log("   Fields to move:",Q.map(re=>re.label||re.fieldName)),console.log("   Indices to remove:",Array.from(q));const K=Ze.filter((re,xe)=>{const Ae=q.has(xe);return Ae&&console.log(`   Removing field at index ${xe}:`,re.label||re.fieldName),!Ae});console.log("   Remaining fields:",K.map((re,xe)=>({idx:xe,label:re.label||re.fieldName})));const ne=Ve!==null?Math.max(0,Math.min(Ve,Rt.length)):Rt.length;if(Rt.splice(ne,0,...Q),et[pe]={...gt,fields:K},et[we]={...ot,fields:Rt},t){const re=et.flatMap(xe=>xe.fields||[]);setTimeout(()=>{t(re,{silent:!0})},0)}return setTimeout(()=>{S.current.delete($e)},0),et})},Se=pe=>{if(!(d||!p[pe])&&(h(we=>we.filter((Ve,$e)=>$e!==pe)),t)){const Ve=p.filter(($e,qe)=>qe!==pe).flatMap($e=>$e.fields||[]);setTimeout(()=>{t(Ve,{silent:!0})},0)}},Re=()=>{if(!A.label){te.warning("Please fill in section label");return}const pe=A.label.trim();if(p.some((Ve,$e)=>T!==null&&$e===T?!1:Ve.label&&Ve.label.trim().toLowerCase()===pe.toLowerCase())){te.warning(`Section with label "${pe}" already exists. Please use a different label.`);return}const we={...A,name:pe,label:pe,roleInSubject:A.editBy==="TRAINEE"?null:A.roleInSubject||null,fields:[...A.fields||[]]};if(T!==null)h(Ve=>{const $e=[...Ve],qe=$e[T],Ct=qe.fields||[];let mr=[...Ct];const et=Ct.some(ot=>ot.fieldType==="SECTION_CONTROL_TOGGLE"),gt=we.isToggleDependent;if(gt&&!et){const ot=`${we.name.toLowerCase().replace(/\s+/g,"_")}_toggle`;mr=[{label:`${we.label} Toggle`,fieldName:ot,fieldType:"SECTION_CONTROL_TOGGLE",roleRequired:we.editBy||"TRAINER",parentTempId:null},...mr]}else!gt&&et&&(mr=mr.filter(ot=>ot.fieldType!=="SECTION_CONTROL_TOGGLE"));return $e[T]={...qe,label:we.label,name:we.name,editBy:we.editBy,roleInSubject:we.roleInSubject,isSubmittable:we.isSubmittable,isToggleDependent:we.isToggleDependent,displayOrder:we.displayOrder,fields:mr},$e}),te.success("Section updated successfully");else{if(we.isToggleDependent){const Ve=`${we.name.toLowerCase().replace(/\s+/g,"_")}_toggle`,$e={label:`${we.label} Toggle`,fieldName:Ve,fieldType:"SECTION_CONTROL_TOGGLE",roleRequired:we.editBy||"TRAINER",parentTempId:null};we.fields=[$e]}h(Ve=>[...Ve,we]),te.success("Section added successfully")}_(!1),C(null)},He=()=>{if(T===null)return;const pe=p[T];pe&&window.confirm(`Are you sure you want to remove section "${pe.label}"? This action cannot be undone.`)&&(Se(T),_(!1),C(null),te.success("Section removed successfully"))};v.useEffect(()=>{E&&(async()=>{try{const ce=await Ws.getPublicRoles(),Ve=(Array.isArray(ce)?ce:[]).map(qe=>typeof qe=="string"?qe:qe.name||qe.code||qe.roleName||"").filter(qe=>typeof qe=="string").map(qe=>qe.toUpperCase()).filter(qe=>qe.includes("TRAINER")||qe.includes("TRAINEE")).map(qe=>qe.includes("TRAINER")?"TRAINER":"TRAINEE"),$e=Array.from(new Set(Ve));$e.length>0&&R($e)}catch{}})()},[E]);const st=pe=>{const we=p[pe]?.editBy||"TRAINER";F({label:"",fieldName:"",fieldType:"TEXT",roleRequired:we,displayOrder:1,parentTempId:null,option:null}),z([]),O(""),C(pe),X(!0)},Pe=(pe,ce)=>{if(!pe)return{valid:!1,message:"Field name is required"};const we=String(ce||"").toUpperCase();return we==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(pe)?pe.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:we==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(pe)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(pe)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},Gt=()=>{if(!ue.label||!ue.fieldName){te.warning("Please fill in all required fields");return}let pe={...ue};if(ue.fieldType==="VALUE_LIST"){if(!Y||Y.length===0){te.warning("Please add at least one option for VALUE_LIST field");return}const qe=JSON.stringify({items:Y});pe.option=qe,F(Ct=>({...Ct,option:qe}))}const ce=Pe(pe.fieldName,pe.fieldType);if(!ce.valid){te.warning(ce.message);return}if(T===null||T<0||T>=p.length){te.warning("Please choose a section");return}const we=p[T].fields||[];if((V!==null?we.filter((qe,Ct)=>Ct!==V):we).some(qe=>qe.fieldName===pe.fieldName)){te.warning("Field name must be unique");return}const $e=[...p];if(V!==null?$e[T].fields=[...we.slice(0,V),pe,...we.slice(V+1)]:$e[T].fields=[...we,pe],h($e),t){const qe=$e.flatMap(Ct=>Ct.fields||[]);setTimeout(()=>{t(qe)},0)}X(!1),ae(!1),C(null),me(null),z([]),O("")},yt=(pe,ce)=>{const we=p[pe]?.fields?.[ce];if(we){if(F({...we}),we.fieldType==="VALUE_LIST"&&we.option)try{const Ve=JSON.parse(we.option);Ve.items&&Array.isArray(Ve.items)?z(Ve.items):z([])}catch{z([])}else z([]);O(""),C(pe),me(ce),ae(!0)}},Pt=()=>{X(!1),ae(!1),_(!1),C(null),me(null),z([]),O("")},[qt,Ie]=v.useState(!1);v.useEffect(()=>{f&&f(qt)},[qt,f]);const Ue=async()=>{try{Ie(!0);const pe=Zn(),ce=o?o():null;console.log(" DocumentKey:",ce);let we=null;const Ve=pe.templateContent;if(l)try{console.log(" Triggering callback flow...");const q=await l();if(q){console.log(" Callback flow success! OnlyOffice URL:",q);try{console.log(" Uploading from OnlyOffice URL to S3...");const re=`${(pe.name||"template").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase().substring(0,50)}.docx`;console.log(" File name for upload:",re),we=await ii.uploadFromUrl(q,re),we?console.log(" Upload from URL success! S3 URL:",we):(console.warn(" No S3 URL received from upload-from-url"),we=null)}catch(K){console.error(" Upload from URL failed:",K),te.warning("Could not upload document to S3"),we=null}}else console.warn(" No OnlyOffice URL received"),we=null}catch(q){console.error(" Callback flow failed:",q),te.warning("Could not get edited document from backend"),we=null}else console.warn(" forceSaveAndPoll function not available"),we=null;console.log(" Submitting template to backend...");const $e=p.flatMap(q=>q.fields||[]),qe=$e.filter(q=>q.fieldType==="FINAL_SCORE_TEXT"),Ct=$e.filter(q=>q.fieldType==="FINAL_SCORE_NUM");if(qe.length!==1){te.error(`Template must have exactly 1 FINAL_SCORE_TEXT field. Found: ${qe.length}`),Ie(!1);return}if(Ct.length!==1){te.error(`Template must have exactly 1 FINAL_SCORE_NUM field. Found: ${Ct.length}`),Ie(!1);return}const mr=$e.filter(q=>q.fieldType==="FINAL_SCORE_TEST"),et=Ct.length>0,gt=qe.length>0,ot=et&&gt;for(const q of mr)if(!ot&&gt&&!et){if(!q.option||!q.option.trim()){te.error(`FINAL_SCORE_TEST field "${q.label||q.fieldName||q.name}" requires options when only FINAL_SCORE_TEXT exists. Please provide options in JSON format: {"items": ["value1", "value2", ...]}`),Ie(!1);return}try{const K=JSON.parse(q.option);if(!K.items||!Array.isArray(K.items)||K.items.length===0){te.error(`FINAL_SCORE_TEST field "${q.label||q.fieldName||q.name}" options must be a JSON object with a non-empty "items" array. Example: {"items": ["value1", "value2"]}`),Ie(!1);return}}catch{te.error(`FINAL_SCORE_TEST field "${q.label||q.fieldName||q.name}" has invalid JSON format for options. Example: {"items": ["value1", "value2"]}`),Ie(!1);return}}const Ze=pe.originalTemplateId,Rt=pe.currentTemplateId||localStorage.getItem("currentTemplateId");let Lt=null;if(Rt&&!Ze)try{console.log(" Loading existing draft fields for parentId conversion (Submit)...");const q=await cr.getTemplateById(Rt);Lt=(q?.data?.sections||q?.data?.data?.sections||[]).flatMap(ne=>ne.fields||[]),console.log(` Loaded ${Lt.length} existing fields for conversion (Submit)`)}catch(q){console.warn(" Failed to load existing draft fields, will use parentTempId:",q)}const Us={...pe,templateContent:Ve,templateConfig:we},W=T2(Us,p,Lt),Q={name:W.name,description:W.description,departmentId:W.departmentId,templateContent:W.templateContent,templateConfig:W.templateConfig||null,status:"PENDING",sections:W.sections};if(console.log(" Template payload built:"),console.log("   templateContent (file import):",Q.templateContent),console.log("   templateConfig (file  chnh sa):",Q.templateConfig||"null"),console.log("   Status:",Q.status),console.log("   documentKey:",ce),console.log("   Using existingFields for conversion:",Lt?"Yes":"No"),console.log(` Full payload:
`,JSON.stringify(Q,null,2)),we)try{console.log(" Validating fields from editor against Available Custom Fields..."),console.log("   Document URL:",we);const q=await cr.extractFields(we);console.log(" Extract fields response:",q);const K=ece(q,Q.sections);if(console.log(" Validation result:",{isValid:K.isValid,missingInSchema:K.missingInSchema,missingInDocument:K.missingInDocument,totalExtractFields:K.totalExtractFields,totalPayloadFields:K.totalPayloadFields}),!K.isValid){if(K.missingInSchema.length>0){console.error(" Field validation failed - fields in editor but not in Available Custom Fields:",K.missingInSchema),te.error(K.errorMessage),Ie(!1);return}if(K.missingInDocument.length>0){console.error(" Field validation failed - fields in Available Custom Fields but not in editor:",K.missingInDocument),te.error(K.warningMessage),Ie(!1);return}}K.isValid&&console.log(" Field validation passed - all fields match between editor and Available Custom Fields")}catch(q){console.warn(" Failed to validate fields (extract-fields API error):",q),console.warn(" Continuing with submit without field validation")}else console.warn(" No templateConfigUrl available - skipping field validation");if(Ze){console.log(" Creating new version from published template:",Ze);const q={originalTemplateId:Ze,...Q};try{const K=await cr.createVersion(q);te.success("Template version created successfully"),console.log(" Template version created:",K?.data??K);const ne={...pe,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(ne)),console.log(" Cleared originalTemplateId after version creation"),setTimeout(()=>{x(he.TEMPLATES)},1500)}catch(K){const ne=K?.response?.data?.message||K?.message||"";if((K?.response?.statusCode||K?.response?.status)===400&&(ne.includes("already exists")||ne.includes("Template name")||ne.toLowerCase().includes("duplicate"))){console.log(" Template name already exists, retrying without name..."),te.warning("Template name already exists. System will auto-generate a new name...");const Ae={originalTemplateId:Ze,description:Q.description,departmentId:Q.departmentId,templateContent:Q.templateContent,templateConfig:Q.templateConfig||null,status:Q.status,sections:Q.sections};try{const ge=await cr.createVersion(Ae);te.success("Template version created successfully with auto-generated name"),console.log(" Template version created (retry):",ge?.data??ge);const ve={...pe,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(ve)),console.log(" Cleared originalTemplateId after version creation (retry)"),setTimeout(()=>{x("/templates")},1500)}catch(ge){throw console.error(" Retry failed:",ge),ge}}else throw K}}else if(Rt){console.log(" Updating existing draft to PENDING:",Rt);const q=await Ce.put(`/templates/update-draft/${Rt}`,{...Q,id:Rt,status:"PENDING"});te.success("Template submitted successfully"),console.log(" Template updated and submitted:",q?.data??q);const K={...pe,currentTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(K)),localStorage.removeItem("currentTemplateId"),console.log(" Cleared currentTemplateId after submit"),setTimeout(()=>{x(he.TEMPLATES)},1500)}else{console.log(" Creating new template");const q=await Ce.post("/templates",Q);te.success("Template submitted successfully"),console.log(" Backend response:",q?.data??q),setTimeout(()=>{x(he.TEMPLATES)},1500)}}catch(pe){console.error(" Submit template failed:",pe);const ce=pe.response?.data?.message||pe.message||"Unknown error";te.error(ce)}finally{Ie(!1)}},De=pe=>{const ce=pe.fieldName;if(!ce)return"";switch((pe.fieldType||"TEXT").toUpperCase()){case"TOGGLE":return`{#${ce}}{/`+ce+`} {^${ce}}{/`+ce+"}";case"PART":return`{#${ce}} {test_field} {/${ce}}`;case"IMAGE":case"SIGNATURE_DRAW":case"SIGNATURE_IMAGE":case"FINAL_SCORE_TEXT":case"FINAL_SCORE_NUM":case"VALUE_LIST":case"TEXT":default:return`{${ce}}`}},[lt,Ut]=v.useState(!1),[rr,ct]=v.useState(null),[Et,ft]=v.useState(null),[jt,Lr]=v.useState(""),[nt,dt]=v.useState("TEXT"),[sr,tn]=v.useState(""),[wi,gn]=v.useState("TRAINER"),Gn=(pe,ce,we)=>{ft(pe),ct(we),Lr(""),dt("TEXT"),tn(""),gn("TRAINER"),Ut(!0)},Ni=()=>{if(!sr||!jt||!/^[a-z][a-z0-9_]*$/.test(jt)){te.warning("Please enter label and snake_case field name, e.g., focus_item");return}if(!rr?.fieldName){te.error("Invalid PART field");return}if(Et===null||Et<0||Et>=p.length){te.error("Invalid section");return}const we=p[Et].fields||[];if(we.some(et=>et.fieldName===jt)){te.warning("Field name must be unique within section");return}const Ve={label:sr,fieldName:jt,fieldType:nt,roleRequired:wi,parentTempId:rr?.tempId||rr?.fieldName||null},$e=[...p];if($e[Et].fields=[...we,Ve],h($e),t){const et=$e.flatMap(gt=>gt.fields||[]);setTimeout(()=>{t(et)},0)}let qe=`{${jt}}`;const Ct=String(nt).toUpperCase();Ct==="TOGGLE"?qe=`{#${jt}}{/${jt}} {^${jt}}{/${jt}}`:Ct==="IMAGE"&&(qe=`{${jt}}`);const mr=` ${qe}`;setTimeout(()=>a(mr),0),Ut(!1),ct(null),ft(null),Lr(""),dt("TEXT"),tn(""),gn("TRAINER")};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
          .insert-field-btn {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
          }
          .insert-field-btn:hover:not(:disabled) {
            background-color: #007bff !important;
            border-color: #007bff !important;
            color: white !important;
          }
          .insert-field-btn:focus {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
          }
          /* Visual grouping for PART and its children */
          .bg-part { background-color: rgba(var(--bs-primary-rgb), .06); border-color: rgba(var(--bs-primary-rgb), .35) !important; }
          .part-badge { font-size: 0.65rem; background: var(--bs-primary); }
          .part-children { border-left: 3px dashed rgba(var(--bs-primary-rgb), .35); margin-left: .5rem; padding-left: .75rem; }
          .child-row { background: #ffffff; }
          .field-title { display: flex; align-items: center; gap: .5rem; }
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: .5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-neutral-200); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-toggle { color: var(--bs-primary); border-color: var(--bs-primary); background: rgba(var(--bs-primary-rgb), .08); }
          .section-toggle:hover { background: rgba(var(--bs-primary-rgb), .15); }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display:flex; align-items:center; gap:.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight:600; border:1px solid rgba(var(--bs-primary-rgb), .25); }
          .draggable-item { transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease; }
          .draggable-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background:#fff; }
          .drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
          .section-card { transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease; }
          .section-card.section-dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.15); transform: scale(.98); opacity: 0.7; }
          .section-card.section-drop-target-above { border-top: 4px solid var(--bs-primary) !important; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }
          .section-card.section-drop-target-below { border-bottom: 4px solid var(--bs-primary) !important; border-bottom-left-radius: 0.5rem; border-bottom-right-radius: 0.5rem; }
          .section-body.section-drop-target { 
            background-color: rgba(0, 123, 255, 0.05) !important; 
            border: 2px dashed var(--bs-primary) !important; 
            border-radius: 0.375rem;
          }
          .section-header.section-header-drop-target {
            background-color: rgba(0, 123, 255, 0.1) !important;
            border: 2px dashed var(--bs-primary) !important;
            border-radius: 0.375rem;
          }
        `}),s.jsxs("div",{className:`p-2 p-md-3 bg-light custom-fields-panel ${m}`,style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 mb-md-3 flex-wrap gap-2 flex-shrink-0",children:[s.jsx("h6",{className:"mb-0 text-muted custom-fields-title",style:{fontSize:"0.95rem"},children:"Available Custom Fields"}),s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:G,disabled:d,className:"custom-fields-add-section-btn",style:{whiteSpace:"nowrap",flexShrink:0},children:[s.jsx(Xr,{className:"me-1",size:14}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Section"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Section"})]})]}),s.jsx("div",{className:"flex-grow-1 custom-fields-content",style:{overflowY:"auto",overflowX:"hidden",minHeight:"0",flex:"1 1 auto"},children:s.jsx("div",{className:"d-grid gap-2 custom-fields-grid",children:p.length>0?p.map((pe,ce)=>s.jsxs(H,{className:`border section-card ${w.fromIndex===ce?"section-dragging":""} ${w.overIndex===ce?w.position==="above"?"section-drop-target-above":"section-drop-target-below":""}`,draggable:!d,onDragStart:we=>{if(d){we.preventDefault();return}N({fromIndex:ce,overIndex:ce,position:"above"}),we.dataTransfer.effectAllowed="move"},onDragOver:we=>{if(d||w.fromIndex===null||j.sectionIndex!==null)return;we.preventDefault();const Ve=we.currentTarget.getBoundingClientRect(),$e=Ve.top+Ve.height/2,qe=we.clientY<$e?"above":"below";let Ct=ce;qe==="below"&&w.fromIndex<ce?Ct=ce+1:qe==="above"&&w.fromIndex>ce?Ct=ce:qe==="below"&&w.fromIndex>ce?Ct=ce+1:qe==="above"&&w.fromIndex<ce&&(Ct=ce),(w.overIndex!==Ct||w.position!==qe)&&N(mr=>({...mr,overIndex:Ct,position:qe}))},onDrop:we=>{if(d||w.fromIndex===null||j.sectionIndex!==null)return;we.preventDefault();const Ve=Math.max(0,Math.min(w.overIndex,p.length));Ee(w.fromIndex,Ve),N({fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>{N({fromIndex:null,overIndex:null,position:"above"})},style:{cursor:d?"default":"grab"},children:[s.jsxs(H.Header,{className:`d-flex justify-content-between align-items-center section-header ${g[ce]&&j.sectionIndex!==null&&j.sectionIndex!==ce&&j.targetSectionIndex===ce?"section-header-drop-target":""}`,onClick:()=>ee(ce),"aria-expanded":!g[ce],onDragStart:we=>we.stopPropagation(),onDragOver:we=>{d||j.sectionIndex===null||j.sectionIndex!==ce&&g[ce]&&(we.preventDefault(),we.stopPropagation(),j.targetSectionIndex!==ce&&y(Ve=>({...Ve,targetSectionIndex:ce,overIndex:pe.fields?.length||0,position:"below"})))},onDrop:we=>{if(d||j.sectionIndex===null||j.fromIndex===null||j.sectionIndex===ce||!g[ce])return;we.preventDefault(),we.stopPropagation(),b($e=>({...$e,[ce]:!1}));const Ve=pe.fields?.length||0;B(j.sectionIndex,j.fromIndex,ce,Ve),y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})},style:{padding:"0.75rem"},children:[s.jsxs("div",{className:"d-flex flex-column flex-grow-1",style:{minWidth:0,marginRight:"0.5rem"},children:[s.jsxs("div",{className:"section-title fw-bold d-flex align-items-center",style:{fontSize:"0.9rem"},children:[g[ce]?s.jsx(Xu,{size:16,className:"flex-shrink-0"}):s.jsx(ni,{size:16,className:"flex-shrink-0"}),s.jsx("span",{className:"text-truncate ms-1",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:pe.label,children:pe.label}),s.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge flex-shrink-0",children:pe.fields?.length||0})]}),s.jsxs("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:["Edit by: ",pe.editBy]})]}),s.jsxs("div",{onClick:we=>we.stopPropagation(),className:"flex-shrink-0 d-flex gap-1",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>st(ce),disabled:d,className:"custom-fields-add-field-btn",style:{whiteSpace:"nowrap",fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[s.jsx(Xr,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Field"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Field"})]}),s.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>Z(ce),disabled:d,title:"Edit Section",className:"text-primary border-primary",style:{padding:"0.25rem 0.4rem"},children:s.jsx(ts,{size:12})})]})]}),!g[ce]&&s.jsx(H.Body,{className:`section-body ${j.sectionIndex!==null&&j.sectionIndex!==ce&&j.targetSectionIndex===ce?"section-drop-target":""}`,onDragOver:we=>{d||j.sectionIndex===null||j.sectionIndex!==ce&&(we.preventDefault(),we.stopPropagation(),j.targetSectionIndex!==ce&&y(Ve=>({...Ve,targetSectionIndex:ce,overIndex:pe.fields?.length||0,position:"below"})))},onDrop:we=>{if(d||j.sectionIndex===null||j.fromIndex===null||j.sectionIndex===ce)return;we.preventDefault(),we.stopPropagation();const Ve=pe.fields?.length||0;B(j.sectionIndex,j.fromIndex,ce,Ve),y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})},style:{minHeight:j.sectionIndex!==null&&j.sectionIndex!==ce&&j.targetSectionIndex===ce?"60px":"auto",transition:"all 0.2s ease"},children:pe.fields&&pe.fields.length>0?(()=>{const we=new Map;pe.fields.forEach((et,gt)=>{we.set(et,gt)});const Ve=[...pe.fields].sort((et,gt)=>et.displayOrder-gt.displayOrder),$e=et=>et?.tempId||et?.fieldName||null,qe=et=>!!et.parentTempId,Ct=Ve.filter(et=>!qe(et)),mr=(et,gt)=>{const ot=String(et.fieldType).toUpperCase()==="PART";return s.jsxs("div",{className:`p-2 p-md-2 rounded border mb-2 mb-md-2 draggable-item custom-field-item ${ot?"bg-part part-card":"bg-white child-row"} ${j.sectionIndex!==null&&j.targetSectionIndex===ce&&j.overIndex===gt?"border-primary":""} ${j.sectionIndex!==null&&j.targetSectionIndex===ce&&j.overIndex===gt&&j.position==="above"?"drop-target-above":""} ${j.sectionIndex!==null&&j.targetSectionIndex===ce&&j.overIndex===gt&&j.position==="below"?"drop-target-below":""} ${j.sectionIndex===ce&&j.fromIndex===gt?"dragging":""}`,draggable:!0,style:{display:"block",visibility:"visible",opacity:1,cursor:"grab"},onDragStart:Ze=>{y({sectionIndex:ce,fromIndex:gt,overIndex:gt,position:"above",targetSectionIndex:ce}),Ze.dataTransfer.effectAllowed="move"},onDragOver:Ze=>{Ze.preventDefault();const Rt=Ze.currentTarget.getBoundingClientRect(),Lt=Rt.top+Rt.height/2,Us=Ze.clientY<Lt?"above":"below";let W=gt;Us==="below"&&(W=gt+1),j.sectionIndex!==null&&(j.sectionIndex===ce?j.overIndex!==W||j.position!==Us:j.targetSectionIndex!==ce||j.overIndex!==W||j.position!==Us)&&y(K=>({...K,overIndex:W,position:Us,targetSectionIndex:ce}))},onDrop:Ze=>{if(Ze.preventDefault(),!(j.sectionIndex===null||j.fromIndex===null)){if(j.sectionIndex===ce){const Rt=Math.max(0,Math.min(j.overIndex,p[ce]?.fields?.length||0));de(ce,j.fromIndex,Rt)}else{const Rt=Math.max(0,Math.min(j.overIndex,p[ce]?.fields?.length||0));B(j.sectionIndex,j.fromIndex,ce,Rt)}y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})}},onDragEnd:()=>y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null}),children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2 gap-2",children:[s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsxs("div",{className:"fw-bold field-title d-flex align-items-center flex-wrap gap-1",style:{fontSize:"0.85rem",wordBreak:"break-word"},children:[s.jsx("span",{className:"text-truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},title:et.label,children:et.label}),ot&&s.jsx("span",{className:"badge part-badge flex-shrink-0",children:"PART"})]}),s.jsxs("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis"},title:`${et.fieldName} (${et.fieldType})${et.roleRequired?` - ${et.roleRequired}`:""}`,children:[et.fieldName," (",et.fieldType,")",et.roleRequired?` - ${et.roleRequired}`:""]})]}),s.jsxs("div",{className:"d-flex gap-1 flex-shrink-0",children:[s.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>yt(ce,gt),disabled:d,title:"Edit Field",className:"text-primary border-primary",style:{padding:"0.25rem 0.4rem"},children:s.jsx(ts,{size:12})}),s.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{const Ze=[...p];if(Ze[ce].fields=Ze[ce].fields.filter((Rt,Lt)=>Lt!==gt),h(Ze),r){const Rt=Ze.flatMap(Lt=>Lt.fields||[]);r(Rt)}},disabled:d,title:"Remove Field",className:"text-danger border-danger",style:{padding:"0.25rem 0.4rem"},children:s.jsx(Xe,{size:12})})]})]}),s.jsxs("div",{className:"d-grid gap-1",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>a(De(et)),disabled:d,className:"d-flex align-items-center justify-content-center text-primary border-primary insert-field-btn",style:{transition:"all 0.2s ease-in-out",fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[s.jsx(s0,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Insert Field"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Insert"})]}),String(et.fieldType).toUpperCase()==="PART"&&s.jsxs(se,{variant:"outline-primary",size:"sm",className:"mt-0 text-primary border-primary",onClick:()=>Gn(ce,gt,et),disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[s.jsx(s0,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Field to PART"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Add to PART"})]})]}),String(et.fieldType).toUpperCase()==="PART"&&(()=>{const Ze=$e(et),Rt=Ve.filter(Lt=>Lt.parentTempId===Ze);return Rt.length?s.jsx("div",{className:"mt-2 part-children",children:Rt.map(Lt=>{const Us=we.get(Lt)??pe.fields.indexOf(Lt);return mr(Lt,Us)})}):null})()]},`${ce}-${gt}`)};return s.jsx(s.Fragment,{children:Ct.map(et=>{const gt=we.get(et)??pe.fields.indexOf(et);return mr(et,gt)})})})():s.jsx(ke,{variant:"light",className:"mb-0",children:s.jsx("small",{children:'No fields in this section. Click "Add Field".'})})})]},ce)):s.jsx(ke,{variant:"light",className:"mb-0",children:s.jsx("small",{children:'No sections yet. Click "Add Section" to start.'})})})}),s.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mt-2 mt-md-3 gap-2 flex-shrink-0",style:{borderTop:"1px solid #dee2e6",paddingTop:"0.75rem"},children:[s.jsxs(ke,{variant:"info",className:"mb-0 custom-fields-tip",style:{fontSize:"0.75rem",padding:"0.5rem",flex:"1 1 auto",marginRight:"0.5rem"},children:[s.jsx("strong",{children:"Tip:"})," ",s.jsx("span",{className:"d-none d-sm-inline",children:"Create sections first, then add fields inside each section."}),s.jsx("span",{className:"d-inline d-sm-none",children:"Create sections, then add fields."})]}),s.jsx(se,{variant:"primary",size:"sm",onClick:Ue,disabled:qt,className:"custom-fields-submit-btn flex-shrink-0",style:{whiteSpace:"nowrap",fontSize:"0.8rem",padding:"0.375rem 0.75rem"},children:qt?s.jsxs(s.Fragment,{children:[s.jsx(xt,{animation:"border",size:"sm",variant:"light",style:{width:"14px",height:"14px"}}),s.jsx("span",{children:"Submitting..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"d-none d-sm-inline",children:"Submit Template"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Submit"})]})})]}),s.jsxs(le,{show:E,onHide:Pt,centered:!0,size:"lg",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:T!==null?"Edit Section":"Add New Section"})}),s.jsx(le.Body,{children:s.jsx(I,{children:s.jsxs(oe,{className:"g-3",children:[s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"Display label",value:A.label,onChange:pe=>D(ce=>({...ce,label:pe.target.value})),required:!0})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{className:"text-primary-custom",children:"Edit By"}),s.jsx(I.Select,{value:A.editBy,onChange:pe=>{const ce=pe.target.value;D(we=>({...we,editBy:ce,roleInSubject:ce==="TRAINEE"?"":we.roleInSubject}))},children:P.map(pe=>s.jsx("option",{value:pe,children:pe},pe))})]})}),A.editBy==="TRAINER"&&s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{className:"text-primary-custom",children:"Role In Subject"}),s.jsxs(I.Select,{value:A.roleInSubject||"ASSESSMENT_REVIEWER",onChange:pe=>D(ce=>({...ce,roleInSubject:pe.target.value})),style:{minWidth:"200px"},children:[s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT_REVIEWER"}),s.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),A.editBy==="TRAINER"&&s.jsx(U,{md:12,children:s.jsxs(I.Group,{className:"d-flex flex-row align-items-center gap-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(I.Check,{type:"checkbox",checked:A.isSubmittable,onChange:pe=>D(ce=>({...ce,isSubmittable:pe.target.checked})),id:"section-submittable"}),s.jsx(I.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(I.Check,{type:"checkbox",checked:A.isToggleDependent,onChange:pe=>D(ce=>({...ce,isToggleDependent:pe.target.checked})),id:"section-toggle-dependent"}),s.jsx(I.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),s.jsxs(le.Footer,{children:[T!==null&&s.jsx(se,{variant:"outline-danger",onClick:He,className:"me-auto",children:"Remove Section"}),s.jsx(se,{variant:"outline-secondary",onClick:Pt,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:Re,children:T!==null?"Update Section":"Save Section"})]})]}),s.jsxs(le,{show:M,onHide:Pt,size:"lg",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:"Add New Field"})}),s.jsx(le.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsx(I,{children:s.jsxs(oe,{className:"g-3",children:[s.jsx(U,{md:12,children:s.jsxs(ke,{variant:"light",className:"py-2",children:["Adding field to section: ",s.jsx("strong",{children:T!==null?p[T]?.label:"N/A"})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"e.g., Crew Communication",value:ue.label,onChange:pe=>F(ce=>({...ce,label:pe.target.value})),required:!0}),s.jsx(I.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"e.g., crew_communication",value:ue.fieldName,onChange:pe=>F(ce=>({...ce,fieldName:pe.target.value})),required:!0}),s.jsxs(I.Text,{className:"text-muted",children:["The variable name used in the docxtemplate (e.g., ","{crew_communication}","). Must be unique within a template."]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(I.Select,{value:ue.fieldType,onChange:pe=>{const ce=pe.target.value;F(we=>({...we,fieldType:ce,option:ce==="VALUE_LIST"?we.option:null})),ce!=="VALUE_LIST"&&(z([]),O(""))},required:!0,children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"IMAGE",children:"IMAGE"}),s.jsx("option",{value:"PART",children:"PART"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),s.jsx("option",{value:"SIGNATURE_DRAW",children:"SIGNATURE_DRAW"}),s.jsx("option",{value:"SIGNATURE_IMAGE",children:"SIGNATURE_IMAGE"}),s.jsx("option",{value:"FINAL_SCORE_TEXT",children:"FINAL_SCORE_TEXT"}),s.jsx("option",{value:"FINAL_SCORE_NUM",children:"FINAL_SCORE_NUM"}),s.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Role Required ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",value:T!==null&&p[T]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),s.jsx(I.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),ue.fieldType==="VALUE_LIST"&&s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Options ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2 mb-2",children:[s.jsx(I.Control,{type:"text",placeholder:"Enter option value (e.g., Pass, Fail)",value:k,onChange:pe=>O(pe.target.value),onKeyPress:pe=>{if(pe.key==="Enter"){pe.preventDefault();const ce=k.trim();if(ce){if(Y.includes(ce)){te.warning("This option already exists. Please enter a different value.");return}z(we=>[...we,ce]),O("")}}}}),s.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>{const pe=k.trim();if(pe){if(Y.includes(pe)){te.warning("This option already exists. Please enter a different value.");return}z(ce=>[...ce,pe]),O("")}},disabled:!k.trim(),children:s.jsx(Xr,{size:14})})]}),Y.length>0&&s.jsx("div",{className:"d-flex flex-column gap-2 mb-2",style:{maxHeight:"200px",overflowY:"auto"},children:Y.map((pe,ce)=>s.jsxs("div",{className:"d-flex align-items-center gap-2 p-2 border rounded",children:[s.jsx("span",{className:"flex-grow-1",children:pe}),s.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{z(we=>we.filter((Ve,$e)=>$e!==ce))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(Xe,{size:12})})]},ce))}),s.jsx(I.Text,{className:"text-muted",children:"Add options one by one."})]})})]})})}),s.jsxs(le.Footer,{children:[s.jsx(se,{variant:"outline-secondary",onClick:Pt,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:Gt,children:"Save Field"})]})]}),s.jsxs(le,{show:ie,onHide:Pt,size:"lg",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:"Edit Field"})}),s.jsx(le.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsx(I,{children:s.jsxs(oe,{className:"g-3",children:[s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"e.g., Crew Communication",value:ue.label,onChange:pe=>F(ce=>({...ce,label:pe.target.value})),required:!0}),s.jsx(I.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(I.Select,{value:ue.fieldType,onChange:pe=>{const ce=pe.target.value;F(we=>({...we,fieldType:ce,option:ce==="VALUE_LIST"?we.option:null})),ce!=="VALUE_LIST"&&(z([]),O(""))},required:!0,children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"IMAGE",children:"IMAGE"}),s.jsx("option",{value:"PART",children:"PART"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),s.jsx("option",{value:"SIGNATURE_DRAW",children:"SIGNATURE_DRAW"}),s.jsx("option",{value:"SIGNATURE_IMAGE",children:"SIGNATURE_IMAGE"}),s.jsx("option",{value:"FINAL_SCORE_TEXT",children:"FINAL_SCORE_TEXT"}),s.jsx("option",{value:"FINAL_SCORE_NUM",children:"FINAL_SCORE_NUM"}),s.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Role Required ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",value:T!==null&&p[T]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),s.jsx(I.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:ue.fieldType==="PART"?"e.g., Assessment_Items":ue.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:ue.fieldName,onChange:pe=>F(ce=>({...ce,fieldName:pe.target.value})),required:!0}),s.jsx(I.Text,{className:"text-muted",children:ue.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':ue.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),ue.fieldType==="VALUE_LIST"&&s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Options ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2 mb-2",children:[s.jsx(I.Control,{type:"text",placeholder:"Enter option value (e.g., Pass, Fail)",value:k,onChange:pe=>O(pe.target.value),onKeyPress:pe=>{if(pe.key==="Enter"){pe.preventDefault();const ce=k.trim();if(ce){if(Y.includes(ce)){te.warning("This option already exists. Please enter a different value.");return}z(we=>[...we,ce]),O("")}}}}),s.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>{const pe=k.trim();if(pe){if(Y.includes(pe)){te.warning("This option already exists. Please enter a different value.");return}z(ce=>[...ce,pe]),O("")}},disabled:!k.trim(),children:s.jsx(Xr,{size:14})})]}),Y.length>0&&s.jsx("div",{className:"d-flex flex-column gap-2 mb-2",style:{maxHeight:"200px",overflowY:"auto"},children:Y.map((pe,ce)=>s.jsxs("div",{className:"d-flex align-items-center gap-2 p-2 border rounded",children:[s.jsx("span",{className:"flex-grow-1",children:pe}),s.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{z(we=>we.filter((Ve,$e)=>$e!==ce))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(Xe,{size:12})})]},ce))}),s.jsx(I.Text,{className:"text-muted",children:"Add options one by one."})]})})]})})}),s.jsxs(le.Footer,{children:[s.jsx(se,{variant:"outline-secondary",onClick:Pt,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:Gt,children:"Update Field"})]})]}),s.jsxs(le,{show:lt,onHide:()=>Ut(!1),children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:"Insert Part Field"})}),s.jsx(le.Body,{children:s.jsx(I,{children:s.jsxs(oe,{className:"g-3",children:[s.jsx(U,{md:12,children:s.jsxs(ke,{variant:"light",className:"py-2",children:["Insert field into PART: ",s.jsxs("strong",{children:[rr?.label," (",rr?.fieldName,")"]})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"e.g., Focus Item",value:sr,onChange:pe=>tn(pe.target.value)})]})}),s.jsx(U,{md:8,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"e.g., focus_item",value:jt,onChange:pe=>Lr(pe.target.value)}),s.jsx(I.Text,{className:"text-muted",children:"snake_case only"})]})}),s.jsx(U,{md:4,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{className:"text-primary-custom",children:"Type"}),s.jsxs(I.Select,{value:nt,onChange:pe=>dt(pe.target.value),children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"IMAGE",children:"IMAGE"})]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsx(I.Label,{className:"text-primary-custom",children:"Role Required"}),s.jsx(I.Select,{value:wi,onChange:pe=>gn(pe.target.value),children:P.map(pe=>s.jsx("option",{value:pe,children:pe},pe))})]})}),s.jsx(U,{md:12,children:s.jsx(I.Text,{className:"text-muted",children:"Display order is assigned automatically by creation order."})})]})})}),s.jsxs(le.Footer,{children:[s.jsx(se,{variant:"outline-secondary",onClick:()=>Ut(!1),children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:Ni,children:"Insert"})]})]})]})]})},Yh=`${Ml.BASE_URL}/media/docs/onlyoffice/callback`,rce=v.forwardRef(({initialContent:e="",fileName:t="Untitled Document",readOnly:r=!1,showMergeFields:a=!0,importType:n="",className:i="",initialSections:l=null,onHasUnsavedChangesChange:o,onDraftSaved:c},u)=>{const[d,m]=v.useState(!0),[f,x]=v.useState(null),[p,h]=v.useState(!1),[g,b]=v.useState([]),[j]=v.useState(!0),[y,w]=v.useState(!1),[N,S]=v.useState(!1),E=v.useRef(!1),_=v.useRef(!1),T=v.useRef(null),C=v.useRef(null),A=v.useRef(null);v.useImperativeHandle(u,()=>({downloadAs:(Ie="docx")=>{if(T.current&&typeof T.current.downloadAs=="function")T.current.downloadAs(Ie);else throw new Error("Editor is not ready or downloadAs method is not available")},save:()=>{if(T.current&&typeof T.current.save=="function")T.current.save();else throw new Error("Editor is not ready or save method is not available")},saveAndDownload:async(Ie="docx")=>{if(!T.current)throw new Error("Editor is not ready");if(typeof T.current.save=="function"&&(console.log(" Step 1: Calling save() to save all changes..."),T.current.save(),await new Promise(Ue=>setTimeout(Ue,1e3)),console.log(" save() completed")),typeof T.current.downloadAs=="function")console.log(" Step 2: Calling downloadAs() to get document URL..."),T.current.downloadAs(Ie);else throw new Error("downloadAs method is not available")},buildAndSubmitDraftTemplate:async Ie=>{if(Y.current&&typeof Y.current.buildAndSubmitDraftTemplate=="function")return await Y.current.buildAndSubmitDraftTemplate(Ie);throw new Error("buildAndSubmitDraftTemplate function is not available")}}),[]);const D=v.useRef(o),P=v.useRef(c);v.useEffect(()=>{D.current=o},[o]),v.useEffect(()=>{P.current=c},[c]),v.useEffect(()=>{E.current=y},[y]);const R=v.useRef(!1),M=v.useRef(null),X=v.useRef(new Map);v.useEffect(()=>{const Ie=setTimeout(()=>{D.current&&D.current(y)},0);return()=>clearTimeout(Ie)},[y]);const[ie,ae]=v.useState(!1),[V,me]=v.useState(null),[ue,F]=v.useState([]),Y=v.useRef(null),[z,k]=v.useState([]),[O,G]=v.useState(!1),Z=[{label:"Trainee's Full Name",variable:"{trainee_name}",fieldType:"TEXT"},{label:"Trainee's Eid",variable:"{trainee_eid}",fieldType:"TEXT"},{label:"Trainee's Nation",variable:"{trainee_nationality}",fieldType:"TEXT"},{label:"Trainee's Batch Name",variable:"{training_batch}",fieldType:"TEXT"},{label:"Course's Name",variable:"{course_name}",fieldType:"TEXT"},{label:"Course's Code",variable:"{course_code}",fieldType:"TEXT"},{label:"Subject's Name",variable:"{subject_name}",fieldType:"TEXT"},{label:"Subject's Code",variable:"{subject_code}",fieldType:"TEXT"},{label:"Assessing date",variable:"{assessment_date}",fieldType:"TEXT"},{label:"Assessment Location",variable:"{assessment_venue}",fieldType:"TEXT"},{label:"Instructor's Full Name",variable:"{trainer_name}",fieldType:"TEXT"},{label:"Trainer's Eid",variable:"{trainer_eid}",fieldType:"TEXT"},{label:"Template Name",variable:"{template_name}",fieldType:"TEXT"}];v.useEffect(()=>{let Ie=!0;return(async()=>{try{G(!0);const De=await Xo.getGlobalFields(),lt=De?.data||De||[];Ie&&k(lt)}catch(De){console.error("Error loading global mapped fields:",De),te.error("Failed to load global mapped fields")}finally{Ie&&G(!1)}})(),()=>{Ie=!1}},[]);const ee=v.useCallback(()=>{if(_.current=!1,T.current)try{typeof T.current.destroy=="function"&&T.current.destroy()}catch(Ie){console.warn("Error destroying editor:",Ie)}},[]);v.useEffect(()=>{console.log(" initialContent changed:",e)},[e]);const de="bd9aaaaddaf94061b51e976a8fd335ce",Ee=async Ie=>{try{const De=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),lt=btoa(JSON.stringify(Ie)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Ut=`${De}.${lt}`,rr=new TextEncoder,ct=await crypto.subtle.importKey("raw",rr.encode(de),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),Et=await crypto.subtle.sign("HMAC",ct,rr.encode(Ut)),ft=btoa(String.fromCharCode(...new Uint8Array(Et))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),jt=`${De}.${lt}.${ft}`;return console.log(" Generated JWT Token (Hardcoded):",jt),jt}catch(Ue){return console.error("Error generating JWT token:",Ue),null}};v.useEffect(()=>{if(!e||e.trim()===""){console.log(" No content provided, setting loading to false"),m(!1);return}if(_.current){console.log(" Editor already initialized, skipping...");return}return _.current=!0,(async()=>{try{let Ue=0;const De=10;await new Promise((nt,dt)=>{const sr=()=>{typeof window.DocsAPI<"u"?nt():Ue<De?(Ue++,console.log(` Waiting for OnlyOffice API... (${Ue}/${De})`),setTimeout(sr,500)):dt(new Error("OnlyOffice API failed to load after 5 seconds"))};sr()}),console.log(" OnlyOffice API loaded successfully"),console.log(" DocsAPI structure:",{DocsAPI:typeof window.DocsAPI,DocEditor:typeof window.DocsAPI?.DocEditor,hasEvents:typeof window.DocsAPI?.DocEditor?.prototype?.events});const Ut=`doc-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;A.current=Ut,console.log(" Generated documentKey for callback:",Ut);const ct=await Ee({document:{key:Ut,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1},url:e},editorConfig:{mode:"edit",user:{id:"test-user",name:"Test User"},callbackUrl:Yh}}),Et=!0;Et&&console.log(" Adding callbackUrl:",Yh);const ft={document:{fileType:"docx",key:Ut,title:t,url:e,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1}},documentType:"word",editorConfig:{user:{id:"test-user",name:"Test User"},customization:{autosave:!1,forcesave:!0,comments:!1,help:!1,hideRightMenu:!1},callbackUrl:Et?Yh:void 0,mode:"edit"},token:ct,events:{onAppReady:()=>{console.log(" OnlyOffice Document Editor is ready"),h(!0)},onDocumentReady:()=>{console.log(" Document is loaded"),w(!0),console.log(" Set hasUnsavedChanges = true (document ready, user can edit)")},onError:nt=>{console.error(" OnlyOffice Error:",nt),console.error(" Error details:",{errorCode:nt.data?.errorCode,errorDescription:nt.data?.errorDescription,error:nt.data?.error,fullEvent:nt}),te.error("Error loading document: "+(nt.data?.errorDescription||nt.data?.error||"Unknown error"))},onDocumentStateChange:nt=>{if(console.log(" Document state changed:",nt),console.log(" Event data:",nt.data),nt.data!==void 0&&nt.data!==null){const dt=nt.data;console.log(" Document state value:",dt),dt===1?(console.log(" Marking document as having unsaved changes"),w(!0)):(dt===0||dt===3)&&console.log(" Document state: ready/saved (state:",dt,")")}},onInfo:nt=>{console.log(" OnlyOffice opened in mode:",nt.data?.mode)},onDownloadAs:async nt=>{try{const dt=nt?.data||{};console.log(""),console.log(" OnlyOffice Event: onDownloadAs"),console.log(""),console.log(" Event data received:",JSON.stringify(dt,null,2));const sr=dt.url||dt.downloadUrl||dt.fileUrl||(Array.isArray(dt.files)?dt.files[0]?.url:void 0)||dt.file&&dt.file.url;if(sr){if(M.current){console.log(" This is a Submit flow - resolving Promise with URL");const pe=A.current,ce=sr.match(/doc-([^_/]+)/),we=ce?ce[1]:null;if(pe&&we){const $e=pe,qe=`doc-${we}`;$e!==qe&&(console.log(" Warning: URL documentKey does not match current, but resolving anyway (resolver exists)"),console.log(`   Current: ${$e}, URL: ${qe}`),console.log("   This can happen during hot reload - resolving anyway because resolver exists"))}const Ve=M.current;M.current=null,Ve.resolve(sr),w(!1);return}if(R.current){console.log(" onDownloadAs event during Submit but no resolver - ignoring (likely from old instance)");return}try{const pe=sessionStorage.getItem("onlyoffice_submitting")==="true",ce=sessionStorage.getItem("onlyoffice_submit_docKey");if(pe&&ce){let we=null;const Ve=sr.match(/[?&]shardkey=([^&]+)/);if(Ve)we=Ve[1];else{const $e=sr.match(/doc-([^_/]+)/);$e&&(we=`doc-${$e[1]}`)}if(we&&ce===we){console.log(" onDownloadAs: Ignoring Draft save - Submit in progress (sessionStorage check)"),console.log(`   Submit docKey: ${ce}, URL docKey: ${we}`);return}}}catch(pe){console.warn(" Error checking sessionStorage in onDownloadAs:",pe)}const tn=A.current,wi=sr.match(/doc-([^_/]+)/),gn=wi?wi[1]:null;if(tn&&gn){const pe=tn,ce=`doc-${gn}`;if(pe!==ce){console.log(" onDownloadAs event ignored - URL from old documentKey instance (Draft flow)"),console.log(`   Current: ${pe}, URL: ${ce}`);return}}const Gn=Date.now(),Ni=X.current.get(sr);if(Ni&&Gn-Ni<2e3){console.log(" Duplicate onDownloadAs event ignored (debounced):",sr.substring(0,50)+"...");return}X.current.set(sr,Gn);for(const[pe,ce]of X.current.entries())Gn-ce>5e3&&X.current.delete(pe);console.log(" Download URL received:",sr),console.log(" This is a Draft save - calling onDraftSaved callback"),P.current&&typeof P.current=="function"&&P.current(sr),w(!1)}else if(console.warn(" onDownloadAs received but no URL found in payload"),R.current&&M.current){const tn=M.current;M.current=null,tn.reject(new Error("No URL found in onDownloadAs event"))}else R.current||te.warning("Draft saved but URL not found")}catch(dt){console.error(" Error in onDownloadAs handler:",dt),te.error("Error processing draft save")}},onRequestSaveAs:async nt=>{try{const dt=nt?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSaveAs"),console.log(""),console.log(" Event data received:",JSON.stringify(dt,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server"),w(!1);const sr=dt.url||dt.downloadUrl||dt.fileUrl||(Array.isArray(dt.files)?dt.files[0]?.url:void 0)||dt.file&&dt.file.url;console.log(" Extracted temporary DOCX URL:",sr),sr||(console.warn(" onRequestSaveAs received but no URL found in payload"),console.warn(" Full event data:",JSON.stringify(dt,null,2))),C.current&&(sr?C.current.resolve(sr):C.current.reject(new Error("onRequestSaveAs event received but no URL found")),C.current=null),console.log("")}catch(dt){console.error(" Error in onRequestSaveAs handler:",dt),C.current&&(C.current.reject(dt),C.current=null)}},onRequestSave:nt=>{try{const dt=nt?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSave"),console.log(""),console.log(" Event data received:",JSON.stringify(dt,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server");const sr=dt.url||dt.downloadUrl||dt.fileUrl;sr&&C.current&&(console.log(" Using URL from onRequestSave:",sr),C.current.resolve(sr),C.current=null),console.log("")}catch(dt){console.error(" Error in onRequestSave handler:",dt)}}}},jt=new window.DocsAPI.DocEditor("onlyoffice-editor",ft);x(jt),T.current=jt,m(!1);const Lr=nt=>{nt.data&&nt.data.type==="insertText"&&console.log(" Received insert text message:",nt.data)};return window.addEventListener("message",Lr,{passive:!0}),()=>{window.removeEventListener("message",Lr)}}catch(Ue){console.error("Error initializing OnlyOffice editor:",Ue),te.error("Failed to initialize editor"),m(!1)}})(),ee},[e,t,ee]);const B=Ie=>{if(f&&p)try{if(typeof f.createConnector=="function")try{const Ue=f.createConnector();if(typeof f.asc_enableKeyEvents=="function")try{f.asc_enableKeyEvents(!0)}catch{}if(Ue&&Ue.isConnected)try{Asc.scope.__templateText=typeof Ie=="string"&&Ie.includes("{")?Ie:`{${Ie}}`,Ue.callCommand(function(){try{const De=Api.GetDocument();let lt=null;try{const rr=De.GetCurrentSentence(),ct=rr&&typeof rr=="string"?rr.trim():"";if(ct&&ct.length>0)try{const Et=De.Search(ct);if(Et&&Et.length>0&&Et.length<10){const ft=Et[0];try{const jt=ft.GetParagraph(0);try{lt=ft.GetTextPr()}catch{try{const Lr=jt.GetElementsCount();if(Lr>0){const nt=jt.GetElement(Lr-1);nt&&nt.GetTextPr&&(lt=nt.GetTextPr())}}catch{}}}catch{}}}catch{}}catch{}const Ut=Api.CreateParagraph();if(lt){const rr=Api.CreateRun();rr.AddText(Asc.scope.__templateText),rr.SetTextPr(lt),Ut.AddElement(rr)}else{const rr=Api.CreateTextPr();rr.SetBold(!1);const ct=Api.CreateRun();ct.AddText(Asc.scope.__templateText),ct.SetTextPr(rr),Ut.AddElement(ct)}De.InsertContent([Ut],!0)}catch{const De=Api.GetDocument(),lt=Api.CreateParagraph();lt.AddText(Asc.scope.__templateText),De.InsertContent([lt],!0)}},function(){},function(De){console.error(" Insert field error:",De),te.error("Failed to insert field: "+(De?.message||"Unknown error"))});return}catch{te.error("Failed to insert field using OnlyOffice Automation API")}}catch{}}catch(Ue){console.error("Error inserting field:",Ue),te.error("Failed to insert field: "+Ue.message)}else f?p||te.warning("Editor is still loading, please wait..."):te.warning("Editor not initialized yet")},Se=v.useCallback(()=>A.current,[]),Re=Ie=>{if(!Ie||!Ie.variable)return;const Ue={...Ie,fieldType:Ie.fieldType||"TEXT",roleRequired:Ie.roleRequired||"TRAINER",options:Ie.options||null};if(me(Ue),Y.current&&typeof Y.current.getSections=="function"){const De=Y.current.getSections();De&&De.length>0?(F(De),ae(!0)):te.warning("Please create a section first before adding system fields")}else te.warning("Custom Fields Panel is not ready. Please wait...")},He=Ie=>{if(!Ie)return;const Ue=Ie.fieldName||Ie.name;if(!Ue){te.warning("Global field is missing a field name");return}const De=Ue.startsWith("{")&&Ue.endsWith("}")?Ue:`{${Ue}}`,lt={label:Ie.label||Ue,variable:De,fieldType:Ie.fieldType||"TEXT",roleRequired:Ie.roleRequired||"TRAINER",options:Ie.options||null};Re(lt)},st=Ie=>{if(!(!V||Ie===null||Ie<0))if(Y.current&&typeof Y.current.addSystemField=="function"){const Ue={label:V.label,fieldName:V.variable.replace(/[{}]/g,""),fieldType:V.fieldType||"TEXT",roleRequired:V.roleRequired||"TRAINER",displayOrder:1,...V.options?{options:V.options}:{}};Y.current.addSystemField(Ie,Ue)&&(ae(!1),me(null))}else te.error("Failed to add field to section")},Pe=v.useCallback(async()=>{try{if(!T.current||!p)throw new Error("Editor not ready");const Ie=A.current;if(!Ie)throw new Error("Document key not found");R.current=!0;try{sessionStorage.setItem("onlyoffice_submitting","true"),sessionStorage.setItem("onlyoffice_submit_docKey",Ie),console.log(" Submit state saved to sessionStorage")}catch(De){console.warn(" Failed to set sessionStorage:",De)}if(console.log(" Starting callback flow (Submit)..."),console.log(` DocumentKey: ${Ie}`),console.log(` Callback URL: ${Ml.BASE_URL}/media/docs/onlyoffice/callback`),console.log(" Step 1: Saving all changes first (auto Ctrl+S)..."),typeof T.current.save=="function")try{T.current.save(),await new Promise(De=>setTimeout(De,2e3)),console.log(" All changes saved successfully")}catch(De){console.warn(" save() failed:",De)}console.log(" Step 2: Triggering downloadAs() and waiting for URL from event..."),M.current=null;const Ue=new Promise((De,lt)=>{M.current={resolve:De,reject:lt},setTimeout(()=>{M.current&&(M.current.reject(new Error("Timeout waiting for download URL")),M.current=null)},15e3)});if(typeof T.current.downloadAs=="function")try{T.current.downloadAs("docx"),console.log(" downloadAs() triggered - waiting for URL from onDownloadAs event...")}catch(De){console.warn(" downloadAs() failed:",De),M.current&&(M.current.reject(new Error("Failed to trigger downloadAs()")),M.current=null),R.current=!1;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(lt){console.warn(" Failed to clear sessionStorage:",lt)}throw new Error("Failed to trigger downloadAs()")}else{M.current&&(M.current.reject(new Error("downloadAs method is not available")),M.current=null),R.current=!1;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(De){console.warn(" Failed to clear sessionStorage:",De)}throw new Error("downloadAs method is not available")}console.log(" Waiting for URL from onDownloadAs event...");try{const De=await Ue;if(De){console.log(" URL received from onDownloadAs event:",De),w(!1),R.current=!1,M.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage")}catch(lt){console.warn(" Failed to clear sessionStorage:",lt)}return De}else{console.warn(" No URL received from onDownloadAs event"),te.warning("Could not get document URL"),R.current=!1,M.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(lt){console.warn(" Failed to clear sessionStorage:",lt)}return null}}catch(De){console.error(" Error waiting for URL from onDownloadAs:",De),te.error(`Failed to get document URL: ${De.message}`),R.current=!1,M.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage (error)")}catch(lt){console.warn(" Failed to clear sessionStorage:",lt)}throw De}}catch(Ie){console.error(" Force save and poll failed:",Ie),te.error(`Failed: ${Ie.message}`),R.current=!1,M.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage (outer catch)")}catch(Ue){console.warn(" Failed to clear sessionStorage:",Ue)}throw Ie}},[p]),Gt=v.useCallback(()=>new Promise((Ie,Ue)=>{try{if(!T.current){Ue(new Error("Editor not initialized"));return}if(C.current={resolve:Ie,reject:Ue},typeof T.current.downloadDocument=="function"){console.log(" Attempting export via downloadDocument()...");try{T.current.downloadDocument()}catch(De){console.warn("downloadDocument() failed, trying downloadAs()...",De)}}if(typeof T.current.downloadAs=="function"){console.log(' Attempting export via downloadAs("docx")...');try{T.current.downloadAs("docx")}catch(De){console.warn("downloadAs() failed:",De)}}if(typeof T.current.save=="function"){console.log(" Attempting export via save()...");try{T.current.save()}catch(De){console.warn("save() failed:",De)}}setTimeout(()=>{if(C.current){const De=new Error("Export timeout: onRequestSaveAs not received after 20s. OnlyOffice Cloud may not support this method without callbackUrl.");C.current.reject(De),C.current=null}},2e4)}catch(De){C.current?(C.current.reject(De),C.current=null):Ue(De)}}),[]),yt=v.useCallback(async()=>{try{if(!T.current||!p)throw new Error("Editor not ready");const Ie=await Gt();if(!Ie)throw new Error("No temporary URL received from OnlyOffice");console.log(" Got temp URL:",Ie);const Ue=await fetch(Ie);if(!Ue.ok)throw new Error(`Failed to fetch file: ${Ue.statusText}`);const De=await Ue.blob();console.log(" Downloaded blob:",De.size,"bytes");const lt=t.endsWith(".docx")?t:`${t}.docx`,Ut=new File([De],lt,{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),rr=ii.getDocsType(lt)||"tem",ct=await ii.uploadDocument(Ut,rr);console.log(" Upload API response:",ct);let Et=null;if(ct?.data?.[0]?.url?(Et=ct.data[0].url,console.log(" Found S3 URL in uploadResult.data[0].url:",Et)):ct?.data?.url?(Et=ct.data.url,console.log(" Found S3 URL in uploadResult.data.url:",Et)):ct?.url?(Et=ct.url,console.log(" Found S3 URL in uploadResult.url:",Et)):ct?.fileUrl?(Et=ct.fileUrl,console.log(" Found S3 URL in uploadResult.fileUrl:",Et)):ct?.path&&(Et=ct.path,console.log(" Found S3 URL in uploadResult.path:",Et)),!Et)throw console.error(" Upload response structure:",JSON.stringify(ct,null,2)),new Error("No S3 URL returned from upload API");return console.log(" Final S3 URL to be used in templateContent:",Et),console.log(" Full S3 URL:",Et),Et}catch(Ie){throw console.error(" Export and upload failed:",Ie),te.error(`Failed: ${Ie.message}`),Ie}},[Gt,t,p]);if(d)return s.jsx(H,{className:`border-neutral-200 shadow-sm ${i}`,children:s.jsx(H.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading OnlyOffice Editor..."}),s.jsx("small",{className:"text-muted",children:"Loading document from S3..."}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Content:"," ",e?"Available":"Not available"]})]})})});if(!e)return s.jsx(H,{className:`border-neutral-200 shadow-sm ${i}`,children:s.jsx(H.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:s.jsx("div",{className:"text-center",children:s.jsxs(ke,{variant:"warning",children:[s.jsx("strong",{children:"No Document URL"}),s.jsx("br",{}),"Please upload a document first to use the editor."]})})})});const Pt=Ie=>{Array.isArray(Ie)?b(Ie):b(Ue=>[...Ue,Ie])},qt=Ie=>{b(Ue=>Ue.filter((De,lt)=>lt!==Ie))};return s.jsxs(s.Fragment,{children:[N&&s.jsx("div",{className:"loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(6px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,transition:"opacity 0.3s ease-in-out"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(xt,{animation:"border",variant:"primary",style:{width:"3rem",height:"3rem"}}),s.jsx("p",{className:"mt-3 mb-0 text-primary fw-semibold",style:{fontSize:"1.1rem"},children:"Submitting template..."})]})}),s.jsxs("div",{className:`onlyoffice-form-editor ${i}`,style:{position:"relative"},children:[s.jsx("div",{className:"p-0",children:s.jsxs(oe,{className:"g-0",style:{minHeight:"90vh"},children:[s.jsx(U,{xs:12,md:a&&j?9:12,className:"editor-col",style:{order:1},children:s.jsxs("div",{className:"p-3 editor-wrapper",style:{height:"90vh",position:"relative"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-2 flex-wrap mb-2",children:[s.jsxs(kt,{children:[s.jsx(kt.Toggle,{variant:"outline-primary",size:"sm",id:"global-mapped-field-dropdown",disabled:O,children:O?"Loading Global Fields...":"Global Mapped Field"}),s.jsx(kt.Menu,{style:{maxHeight:"400px",overflowY:"auto"},children:O?s.jsx(kt.ItemText,{className:"text-muted",children:"Loading..."}):z.length===0?s.jsx(kt.ItemText,{className:"text-muted",children:"No global fields available"}):z.map(Ie=>s.jsx(kt.Item,{onClick:()=>He(Ie),children:Ie.label||Ie.fieldName},Ie.id||Ie.fieldName))})]}),s.jsxs(kt,{children:[s.jsx(kt.Toggle,{variant:"outline-primary",size:"sm",id:"system-mapped-field-dropdown",children:"System Mapped Field"}),s.jsx(kt.Menu,{style:{maxHeight:"400px",overflowY:"auto"},children:Z.map((Ie,Ue)=>s.jsx(kt.Item,{onClick:()=>Re(Ie),children:Ie.label},`system-field-${Ue}`))})]})]}),s.jsx("div",{id:"onlyoffice-editor",style:{width:"100%",height:"100%",border:"1px solid #ddd",borderRadius:"4px"}})]})}),a&&j&&s.jsx(U,{xs:12,md:3,className:"border-start border-md-start custom-fields-col",style:{order:2},children:s.jsx("div",{className:"custom-fields-wrapper",style:{height:"90vh",overflowY:"auto",overflowX:"hidden"},children:s.jsx(tce,{customFields:g,onAddField:Pt,onRemoveField:qt,onInsertField:B,initialSections:l,exportEditedDoc:Gt,exportAndUploadEditedDoc:yt,forceSaveAndPoll:Pe,getDocumentKey:Se,addSystemFieldToSectionRef:Y,readOnly:r,className:"h-100",onSubmittingChange:S})})})]})}),s.jsxs(le,{show:ie,onShow:()=>{if(Y.current&&typeof Y.current.getSections=="function"){const Ie=Y.current.getSections();F(Ie||[])}},onHide:()=>{ae(!1),me(null)},centered:!0,className:"system-field-modal",children:[s.jsx(le.Header,{closeButton:!0,className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:s.jsx(le.Title,{className:"text-white mb-0",style:{fontSize:"1.25rem",fontWeight:600},children:"Select Section"})}),s.jsxs(le.Body,{style:{padding:"1.5rem"},children:[V&&s.jsxs("div",{className:"mb-4 p-3 rounded",style:{backgroundColor:"var(--bs-light)",border:"1px solid var(--bs-neutral-200)"},children:[s.jsx("p",{className:"mb-1 text-primary-custom",style:{fontSize:"0.875rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Field to add:"}),s.jsx("p",{className:"mb-0",style:{fontSize:"1rem",fontWeight:500,color:"var(--bs-dark)"},children:V.label}),s.jsx("code",{className:"d-inline-block mt-1 px-2 py-1 rounded",style:{fontSize:"0.875rem",backgroundColor:"var(--bs-neutral-100)",color:"var(--bs-primary)",border:"1px solid var(--bs-neutral-300)"},children:V.variable})]}),s.jsx("p",{className:"mb-3",style:{fontSize:"0.95rem",color:"var(--bs-dark)",fontWeight:500},children:"Choose a section to add this field:"}),ue.length>0?s.jsx("div",{className:"d-grid gap-2",style:{maxHeight:"400px",overflowY:"auto"},children:ue.map((Ie,Ue)=>s.jsx("button",{type:"button",className:"section-select-btn",onClick:()=>st(Ue),style:{padding:"1rem 1.25rem",border:"2px solid var(--bs-neutral-200)",borderRadius:"0.5rem",backgroundColor:"var(--bs-light)",textAlign:"left",transition:"all 0.3s ease",cursor:"pointer",width:"100%"},onMouseEnter:De=>{De.currentTarget.style.borderColor="var(--bs-primary)",De.currentTarget.style.backgroundColor="rgba(27, 60, 83, 0.05)",De.currentTarget.style.transform="translateY(-2px)",De.currentTarget.style.boxShadow="0 4px 12px rgba(27, 60, 83, 0.15)"},onMouseLeave:De=>{De.currentTarget.style.borderColor="var(--bs-neutral-200)",De.currentTarget.style.backgroundColor="var(--bs-light)",De.currentTarget.style.transform="translateY(0)",De.currentTarget.style.boxShadow="none"},children:s.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{className:"mb-1",style:{fontSize:"1rem",fontWeight:600,color:"var(--bs-primary)"},children:Ie.label||Ie.name}),s.jsx("div",{className:"d-flex align-items-center gap-2 mt-2",style:{fontSize:"0.875rem"},children:s.jsx("span",{className:"badge rounded-pill px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",color:"white",fontSize:"0.75rem",fontWeight:500},children:Ie.editBy||"TRAINER"})})]}),s.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{minWidth:"60px",height:"60px",borderRadius:"0.375rem",backgroundColor:"var(--bs-primary)",color:"white",fontSize:"1.25rem",fontWeight:700},children:Ie.fields?.length||0})]})},Ue))}):s.jsxs(ke,{variant:"warning",className:"mb-0",style:{backgroundColor:"#fff3cd",borderColor:"#ffc107",color:"#856404",borderRadius:"0.5rem",padding:"1rem"},children:[s.jsx("strong",{children:"No sections available."})," Please create a section first."]})]}),s.jsx(le.Footer,{className:"border-0",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)"},children:s.jsx(se,{variant:"secondary",onClick:()=>{ae(!1),me(null)},style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:Ie=>{Ie.currentTarget.style.backgroundColor="#3a5a6f",Ie.currentTarget.style.borderColor="#3a5a6f",Ie.currentTarget.style.transform="translateY(-1px)",Ie.currentTarget.style.boxShadow="0 4px 8px rgba(69, 104, 130, 0.3)"},onMouseLeave:Ie=>{Ie.currentTarget.style.backgroundColor="var(--bs-secondary)",Ie.currentTarget.style.borderColor="var(--bs-secondary)",Ie.currentTarget.style.transform="translateY(0)",Ie.currentTarget.style.boxShadow="none"},children:"Cancel"})})]})]})]})}),sce=({onSuccess:e,className:t=""})=>{const[r,a]=v.useState(!1),[n,i]=v.useState(null),[l,o]=v.useState(!1),[c,u]=v.useState(!1),d=v.useRef(null),m=()=>{a(!0),i(null),d.current&&(d.current.value="")},f=()=>{a(!1),i(null),d.current&&(d.current.value="")},x=y=>{const w=y.target.files[0];if(w){const N=[".docx"],S=w.name.toLowerCase().substring(w.name.lastIndexOf("."));if(!N.includes(S)){te.error("Please select a valid Word document file (.docx)");return}if(w.size>10*1024*1024){te.error("File size must be less than 10MB");return}i(w)}},p=async y=>{try{u(!0),console.log(" Validating file has no fields:",y);const{data:w}=await Ce.post("/templates/extract-fields-from-url",{url:y}),N=w?.fields||w||[],S=Array.isArray(N)&&N.length>0;return console.log(" Validation result:",{hasFields:S,fieldCount:N.length}),!S}catch(w){return console.error(" Error validating file:",w),!1}finally{u(!1)}},h=async y=>{if(!y){console.log(" No mediaId provided, skipping delete");return}try{console.log(" Deleting old file with mediaId:",y),console.log(" Calling DELETE /media/objects with body:",{key:y});const w=await Ce.delete("/media/objects",{data:{key:y}});return console.log(" Old file deleted successfully!",w.data),!0}catch(w){return console.error(" Error deleting old file:",w),console.error(" Error response:",w.response?.data),!1}},g=async()=>{if(!n){te.error("Please select a file");return}o(!0);let y=null,w=null;try{const N=Zn(),S=N.templateContentMediaId;if(S){console.log(" Replacing existing template content, deleting old file...");const A=await h(S);console.log(A?" Old file deleted successfully before upload":" Failed to delete old file, but continuing with upload")}else console.log(" Adding new template content (no old file to delete)");console.log(" Uploading file to S3 for validation...");const E=ii.getDocsType(n.name),_=await ii.uploadDocument(n,E);if(_.data&&_.data.length>0)y=_.data[0].url,w=_.data[0].id||_.data[0].mediaId||null,console.log(" File uploaded successfully! URL:",y),w?console.log(" MediaId from response:",w):console.log(" No mediaId in response, will try to extract from URL if needed");else throw new Error("Invalid response format from upload API");if(console.log(" Validating file has no fields..."),!await p(y)){if(console.log(" File contains fields, deleting uploaded file..."),w){const A=await h(w);console.log(A?" Invalid file deleted successfully":" Failed to delete invalid file")}else console.log(" No mediaId to delete invalid file");te.error("File contains fields. Please upload a file without fields."),o(!1);return}console.log(" File validation passed! Saving to localStorage...");const C={...N,templateContent:y,templateContentMediaId:w};localStorage.setItem("templateInfo",JSON.stringify(C)),console.log(" templateContent saved:",y),w&&console.log(" templateContentMediaId saved:",w),te.success("Template content uploaded and validated successfully!"),e&&e(y),f()}catch(N){if(console.error(" Error uploading/validating file:",N),w){console.log(" Attempting to clean up uploaded file due to error...");try{await h(w),console.log(" Cleaned up uploaded file")}catch(S){console.error(" Failed to clean up uploaded file:",S)}}te.error("Failed to upload file: "+(N.message||"Unknown error"))}finally{o(!1)}},j=!!Zn().templateContent;return s.jsxs(s.Fragment,{children:[s.jsxs(se,{variant:"outline-light",size:"sm",onClick:m,className:`d-flex align-items-center gap-2 ${t}`,style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",whiteSpace:"nowrap"},onMouseEnter:y=>{y.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",y.currentTarget.style.borderColor="#fff"},onMouseLeave:y=>{y.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",y.currentTarget.style.borderColor="#fff"},title:j?"Original template already uploaded. Click to replace.":"Upload original template (file without fields)",children:[s.jsx(Ts,{size:16}),j?"Replace Original Template":"Original Template"]}),s.jsxs(le,{show:r,onHide:f,centered:!0,size:"lg",children:[s.jsx(le.Header,{className:"bg-primary-custom text-white border-0",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(qi,{className:"me-2",size:20}),j?"Replace Original Template":"Original Template"]})}),s.jsxs(le.Body,{className:"p-4",children:[s.jsxs(ke,{variant:"info",className:"mb-4",children:[s.jsx("strong",{children:"Important:"})," Please upload a Word document (.docx) that does ",s.jsx("strong",{children:"not"})," contain any form fields. The system will automatically validate this before saving."]}),s.jsxs(I,{children:[s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Select File ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{ref:d,type:"file",accept:".docx",onChange:x,className:"mb-2"}),s.jsx(I.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]}),n&&s.jsx(ke,{variant:"info",className:"mt-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(qi,{className:"me-2",size:20}),s.jsxs("div",{children:[s.jsx("strong",{children:"Selected File:"})," ",n.name,s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Size: ",(n.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),s.jsxs(le.Footer,{className:"border-0",children:[s.jsx(se,{variant:"outline-secondary",onClick:f,disabled:l||c,children:"Cancel"}),s.jsx(se,{variant:"primary-custom",onClick:g,disabled:!n||l||c,children:l||c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),c?"Validating...":"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ts,{className:"me-2",size:14}),j?"Replace":"Upload"]})})]})]})]})},ace=()=>{const e=Ge(),t=za(),[r,a]=v.useState(""),[n,i]=v.useState("Untitled Document"),[l,o]=v.useState(""),[c,u]=v.useState(null),[d,m]=v.useState(!1),[f,x]=v.useState({name:"",description:"",departmentId:""}),[p,h]=v.useState([]),[g,b]=v.useState(!1),[j,y]=v.useState(!1),[w,N]=v.useState(!1),[S,E]=v.useState(!1),[_,T]=v.useState(!1),C=v.useRef(null);v.useEffect(()=>{console.log(" hasUnsavedChanges changed:",j)},[j]);const[A,D]=v.useState(null);v.useEffect(()=>{if(t.state){const{content:ue,documentUrl:F,fileName:Y,importType:z,templateInfo:k,initialSections:O}=t.state;let G=F||ue||"";k?.editorDocumentUrl&&(G=k.editorDocumentUrl),z==="Create Version"&&!G&&(G=k?.templateConfig||k?.templateContent||""),a(G),i(Y||"Untitled Document"),o(z||""),u(k||null),O&&Array.isArray(O)&&(D(O),console.log(" FormEditorPage received initialSections:",O)),k&&x({name:k.name||"",description:k.description||"",departmentId:k.departmentId||""}),console.log(" FormEditorPage received:",{documentUrl:F,content:ue,fileName:Y,templateInfo:k,initialSections:O,finalContent:G})}},[t.state]),v.useEffect(()=>{d&&P()},[d]);const P=async()=>{try{b(!0);const ue=await Mt.getPublicDepartments();h(ue)}catch(ue){console.error("Error loading departments:",ue),te.error("Failed to load departments"),h([])}finally{b(!1)}},R=()=>{c&&x({name:c.name||"",description:c.description||"",departmentId:c.departmentId||""}),m(!0)},M=()=>{m(!1)},X=()=>{if(!f.name||!f.description||!f.departmentId){te.error("Please fill in all required fields");return}const ue={...c,name:f.name,description:f.description,departmentId:f.departmentId};u(ue);try{const F=localStorage.getItem("templateInfo");if(F){const z={...JSON.parse(F),name:f.name,description:f.description,departmentId:f.departmentId};localStorage.setItem("templateInfo",JSON.stringify(z))}}catch(F){console.error("Error updating localStorage:",F)}te.success("Template information updated successfully"),m(!1)},ie=()=>{console.log(" Back button clicked, hasUnsavedChanges:",j),j?(console.log(" Showing discard modal"),N(!0)):(console.log(" No unsaved changes, navigating back"),e(he.TEMPLATES))},ae=()=>{N(!1),y(!1),e(he.TEMPLATES)},V=()=>{N(!1)},me=async()=>{if(!C.current){te.warning("Editor is not ready yet. Please wait...");return}E(!0);try{typeof C.current.saveAndDownload=="function"?await C.current.saveAndDownload("docx"):(typeof C.current.save=="function"&&(console.log(" Step 1: Calling save() to save all changes..."),C.current.save(),await new Promise(ue=>setTimeout(ue,1e3))),typeof C.current.downloadAs=="function"&&(console.log(" Step 2: Calling downloadAs() to get document URL..."),C.current.downloadAs("docx")))}catch(ue){console.error(" Error saving draft:",ue),te.error("Failed to save draft: "+(ue.message||"Unknown error")),E(!1)}};return s.jsx(Ar,{permission:fe.CREATE_TEMPLATE,fallback:s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Access Denied"}),s.jsx("p",{children:"You don't have permission to edit form templates."})]})}),children:s.jsxs(_e,{fluid:!0,className:"py-4 form-editor-page form-component",style:{position:"relative"},children:[S&&s.jsx("div",{className:"loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(6px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,transition:"opacity 0.3s ease-in-out"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(xt,{animation:"border",variant:"primary",style:{width:"3rem",height:"3rem"}}),s.jsx("p",{className:"mt-3 mb-0 text-primary fw-semibold",style:{fontSize:"1.1rem"},children:"Saving draft..."})]})}),s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"border-neutral-200 form-editor-header bg-primary",children:s.jsxs(oe,{className:"align-items-center",children:[s.jsx(U,{xs:12,md:8,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(se,{variant:"outline-light",onClick:ie,className:"me-3",size:"sm",style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)"},onMouseEnter:ue=>{ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",ue.currentTarget.style.borderColor="#fff"},onMouseLeave:ue=>{ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",ue.currentTarget.style.borderColor="#fff"},children:s.jsx(At,{size:16})}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"mb-0 text-white",children:c?.name||n}),l&&s.jsxs("small",{className:"text-white",style:{opacity:.9},children:["Import Type: ",l]})]}),c&&s.jsx(se,{variant:"outline-light",size:"sm",onClick:R,className:"ms-2",title:"Edit Template Information",children:s.jsx(ts,{size:14})})]})]})}),s.jsxs(U,{xs:12,md:4,className:"d-flex justify-content-end align-items-center gap-2 mt-2 mt-md-0",children:[l==="File with fields"&&s.jsx(sce,{onSuccess:ue=>{console.log(" Template content uploaded:",ue)}}),s.jsx(se,{variant:"outline-light",size:"sm",onClick:me,disabled:S,className:"d-flex align-items-center gap-2",style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",whiteSpace:"nowrap"},onMouseEnter:ue=>{S||(ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",ue.currentTarget.style.borderColor="#fff")},onMouseLeave:ue=>{S||(ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",ue.currentTarget.style.borderColor="#fff")},children:S?s.jsxs(s.Fragment,{children:[s.jsx(xt,{animation:"border",size:"sm",variant:"light",style:{width:"14px",height:"14px"}}),s.jsx("span",{children:"Saving..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{size:16}),s.jsx("span",{children:"Save Draft"})]})}),s.jsx(se,{variant:"outline-light",size:"sm",onClick:()=>T(!0),className:"d-flex align-items-center justify-content-center text-white",style:{borderWidth:"2px",fontWeight:"700",fontSize:"18px",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",width:"36px",height:"36px",padding:0,color:"#ffffff !important",lineHeight:"1"},onMouseEnter:ue=>{ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",ue.currentTarget.style.borderColor="#fff",ue.currentTarget.style.color="#ffffff"},onMouseLeave:ue=>{ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",ue.currentTarget.style.borderColor="#fff",ue.currentTarget.style.color="#ffffff"},title:"System Syntax Guidance",children:"?"})]})]})}),s.jsx(H.Body,{className:"p-0",style:{position:"relative"},children:s.jsx(rce,{ref:C,initialContent:r,fileName:n,showImportInfo:!!l,importType:l,initialSections:A,onHasUnsavedChangesChange:y,onDraftSaved:async ue=>{try{console.log(" onDraftSaved called - checking sessionStorage...");const F=sessionStorage.getItem("onlyoffice_submitting")==="true",Y=sessionStorage.getItem("onlyoffice_submit_docKey");if(console.log(" SessionStorage check:",{isSubmitting:F,submitDocKey:Y,draftUrl:ue.substring(0,100)+"..."}),F&&Y){let z=null;const k=ue.match(/[?&]shardkey=([^&]+)/);if(k)z=k[1],console.log(" Extracted docKey from shardkey:",z);else{const O=ue.match(/doc-([^_/]+)/);O&&(z=`doc-${O[1]}`,console.log(" Extracted docKey from path:",z))}if(console.log(" Comparing:",{submitDocKey:Y,urlDocKey:z,match:z&&Y===z}),z&&Y===z){console.log(" Draft save ignored - Submit in progress"),console.log(`   Submit docKey: ${Y}, URL docKey: ${z}`),E(!1);return}else console.log(" Submit in progress but documentKey mismatch - treating as Draft anyway"),console.log(`   Submit docKey: ${Y}, URL docKey: ${z}`)}try{console.log(" Processing draft save - uploading to S3 and building template..."),C.current&&typeof C.current.buildAndSubmitDraftTemplate=="function"?(await C.current.buildAndSubmitDraftTemplate(ue),console.log(" Draft template saved successfully!")):(console.warn(" buildAndSubmitDraftTemplate function not available"),te.warning("Draft URL saved but template not created"))}catch(z){console.error(" Error building/submitting draft template:",z),te.error("Failed to save draft template: "+(z.message||"Unknown error"))}finally{E(!1)}}catch(F){console.error(" Error in onDraftSaved callback:",F),E(!1),te.error("Error processing draft save")}}})})]}),s.jsxs(le,{show:w,onHide:V,centered:!0,children:[s.jsx(le.Header,{className:"bg-warning text-dark border-0",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:s.jsx(le.Title,{className:"text-dark mb-0",style:{fontSize:"1.25rem",fontWeight:600},children:"Discard Changes?"})}),s.jsxs(le.Body,{style:{padding:"1.5rem"},children:[s.jsx("p",{className:"mb-0",style:{fontSize:"1rem",color:"var(--bs-dark)"},children:"You have unsaved changes in the document. Are you sure you want to leave without saving?"}),s.jsx("p",{className:"mt-2 mb-0 text-muted",style:{fontSize:"0.875rem"},children:"All unsaved changes will be lost."})]}),s.jsxs(le.Footer,{className:"border-0",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)"},children:[s.jsx(se,{variant:"secondary",onClick:V,style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},children:"Cancel"}),s.jsx(se,{variant:"warning",onClick:ae,style:{backgroundColor:"#ffc107",borderColor:"#ffc107",color:"#212529",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},children:"Discard Changes"})]})]}),s.jsxs(le,{show:d,onHide:M,size:"lg",centered:!0,children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(ts,{className:"me-2",size:20}),"Edit Template Information"]}),s.jsx(se,{variant:"link",onClick:M,className:"text-white text-decoration-none",style:{fontSize:"1.5rem",lineHeight:1},children:""})]}),s.jsx(le.Body,{className:"p-4",children:s.jsx(I,{children:s.jsxs(oe,{className:"g-3",children:[s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Template Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:f.name,onChange:ue=>x(F=>({...F,name:ue.target.value})),required:!0})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Description ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:f.description,onChange:ue=>x(F=>({...F,description:ue.target.value})),required:!0})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(I.Select,{value:f.departmentId,onChange:ue=>x(F=>({...F,departmentId:ue.target.value})),required:!0,disabled:g,children:[s.jsx("option",{value:"",children:"Select Department"}),p.map(ue=>s.jsx("option",{value:ue.id,children:ue.name},ue.id))]}),g&&s.jsx(I.Text,{className:"text-muted",children:"Loading departments..."})]})})]})})}),s.jsxs(le.Footer,{className:"border-0",children:[s.jsx(se,{variant:"outline-secondary",onClick:M,children:"Cancel"}),s.jsx(se,{variant:"primary-custom",onClick:X,disabled:!f.name||!f.description||!f.departmentId,children:"Save Changes"})]})]}),s.jsxs(le,{show:_,onHide:()=>T(!1),size:"lg",centered:!0,className:"syntax-guide-modal",children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(nS,{className:"me-2",size:20}),"System Syntax Guidance"]}),s.jsx(se,{variant:"link",onClick:()=>T(!1),className:"text-white text-decoration-none",style:{fontSize:"1.5rem",lineHeight:1},children:s.jsx(Xe,{size:24})})]}),s.jsx(le.Body,{style:{padding:"1.5rem",maxHeight:"70vh",overflowY:"auto"},children:s.jsxs("div",{className:"syntax-guide-content",children:[s.jsxs("div",{className:"syntax-list mb-4",children:[s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Field:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{variable_name}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TEXT, VALUE_LIST, FINAL_SCORE_TEXT, FINAL_SCORE_NUM, SIGNATURE_DRAW, SIGNATURE_IMG"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Part:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{#Part_Name} {field1} {field2} {/PartName}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: PART"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Conditions:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{#isCondition} {true} {/isCondition}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TOGGLE, SECTION_CONTROL_TOGGLE"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Inverted Conditions:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{^isCondition} {false} {/isCondition}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TOGGLE, SECTION_CONTROL_TOGGLE"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Advanced Syntax:"}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("code",{className:"syntax-pill",children:"Operators: + - * % /"})})]})})]}),s.jsx("hr",{className:"my-4",style:{borderColor:"#dfe1e6"}}),s.jsx("h5",{className:"mb-3",style:{fontSize:"1.25rem",fontWeight:600,color:"#172B4D"},children:"Sections-Fields Rule"}),s.jsxs("ul",{className:"rule-list mb-4",style:{paddingLeft:"1.5rem",lineHeight:1.8},children:[s.jsx("li",{children:"Create a Section first, then you can create Fields belonging to that Section."}),s.jsx("li",{children:"You can drag the Section card to change the position of Sections."}),s.jsx("li",{children:"You can drag the Field card to change the position of Fields within the same or between Sections."})]}),s.jsx("h5",{className:"mb-3",style:{fontSize:"1.25rem",fontWeight:600,color:"#172B4D"},children:"Template Rule"}),s.jsxs("ul",{className:"rule-list",style:{paddingLeft:"1.5rem",lineHeight:1.8},children:[s.jsx("li",{children:"Placeholders in the Template must match the Available Fields (e.g., no Field in the Template that is not in Available Fields when submitting, and vice versa)."}),s.jsx("li",{children:'For the "Submittable" field of a Section for a TRAINER, it means only the person Assessing that Section later will be allowed to Submit the Assessment Form.'}),s.jsxs("li",{children:['For the "Toggle Dependent" field of a Section for a TRAINER:',s.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[s.jsx("li",{children:"It means the person Assessing this Section is allowed to skip Fields without filling them in."}),s.jsx("li",{children:"There must be exactly one Field with the Field Type SECTION_CONTROL_TOGGLE."})]})]}),s.jsx("li",{children:"A Field with the type FINAL_SCORE_TEXT or FINAL_SCORE_NUM must exist (serving the purpose of Assessing TRAINEE), and no more than two Fields with this same Field Type can exist."})]})]})}),s.jsx(le.Footer,{className:"border-0",children:s.jsx(se,{variant:"primary-custom",onClick:()=>T(!1),style:{fontWeight:500,padding:"0.5rem 1.5rem"},children:"Got it"})})]})]})})},nce=()=>{const e=Ge(),{user:t}=xs(),[r,a]=v.useState([]),[n,i]=v.useState(!0);v.useEffect(()=>{t?.id&&l()},[t?.id]);const l=async()=>{try{i(!0);const u=t?.id;if(!u){te.error("User ID not found"),a([]);return}const d=await cr.getTemplates({status:"DRAFT",createdByUserId:u});d.success&&d.data?a(d.data):Array.isArray(d)?a(d):d.data&&Array.isArray(d.data)?a(d.data):a([])}catch(u){console.error("Error loading drafts:",u),te.error("Failed to load drafts"),a([])}finally{i(!1)}},o=async u=>{try{console.log(" Opening draft:",u);const d=await cr.getTemplateById(u),m=d.data?.templateForm||d.data,f=d.data?.sections||[];if(!m){te.error("Template not found");return}console.log(" Template loaded:",m),console.log(" Sections loaded:",f);const x=z1(f);console.log(" Converted sections:",x);const p=m.templateConfig||m.templateContent;if(!p){te.error("Document URL not found");return}localStorage.setItem("templateInfo",JSON.stringify({id:m.id,currentTemplateId:m.id,name:m.name,description:m.description,departmentId:m.departmentId,templateContent:m.templateContent,templateConfig:m.templateConfig})),localStorage.setItem("currentTemplateId",m.id),console.log(" Restored templateInfo with currentTemplateId:",m.id),e(he.TEMPLATES_EDITOR,{state:{documentUrl:p,fileName:m.name,importType:"File without fields",templateInfo:{id:m.id,name:m.name,description:m.description,departmentId:m.departmentId,status:m.status},initialSections:x}}),te.success("Draft loaded successfully")}catch(d){console.error("Error opening draft:",d),te.error("Failed to load draft: "+(d.message||"Unknown error"))}},c=u=>{if(!u)return"N/A";try{return new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return u}};return s.jsx(_e,{fluid:!0,className:"py-4 forms-page form-component",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53",padding:"12px 16px"},children:s.jsx(oe,{className:"align-items-center g-0",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center",style:{gap:"8px"},children:[s.jsx(se,{variant:"link",className:"text-white p-0",onClick:()=>e(he.TEMPLATES),style:{textDecoration:"none",margin:0,padding:"4px",minWidth:"auto"},children:s.jsx(At,{size:20})}),s.jsx(vt,{className:"text-white",size:24,style:{marginLeft:"4px"}}),s.jsx("h4",{className:"mb-0 text-white",style:{marginLeft:"8px"},children:"Your Drafts"})]})})})}),s.jsx(H.Body,{children:n?s.jsx(zt,{}):r.length===0?s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(qi,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No drafts found"}),s.jsx("p",{className:"text-muted mb-4",children:"You haven't saved any drafts yet. Start creating a template to save drafts."}),s.jsx(se,{variant:"primary-custom",onClick:()=>e(he.TEMPLATES),children:"Go to Templates"})]})})}):s.jsx(oe,{className:"g-3 g-md-4",children:r.map(u=>s.jsx(U,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(H,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease"},onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-5px)",d.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(H.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(vt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:u.name,children:u.name}),s.jsxs("small",{className:"text-muted",children:["v",u.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:u.description||"No description",children:u.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ls,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:u.department?.code||"N/A",children:u.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:s.jsxs(Ne,{bg:"secondary",className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(Qe,{size:12}),"DRAFT"]})})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ft,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},children:[u.createdByUser?.firstName," ",u.createdByUser?.lastName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:c(u.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs(se,{variant:"primary-custom",size:"sm",className:"w-100 d-flex align-items-center justify-content-center",onClick:()=>o(u.id),children:[s.jsx(ts,{size:14,className:"me-2"}),"Continue Editing"]})})]})})},u.id))})})]})})},ice=()=>{const e=Ge(),t=[{id:"add-template",title:"Add New Template",description:"Create a new form template",icon:aS,path:`${he.TEMPLATES}?action=create`,permission:fe.CREATE_TEMPLATE,color:"primary",action:()=>{e(`${he.TEMPLATES}?action=create`)}},{id:"add-department",title:"Add New Department",description:"Create a new department",icon:Ls,path:he.DEPARTMENTS,permission:fe.CREATE_DEPARTMENT,color:"primary",action:()=>{e(he.DEPARTMENTS)}},{id:"bulk-import-user",title:"Bulk Import User",description:"Import multiple users from Excel file",icon:Ts,path:`${he.USERS}?action=bulk-import`,permission:fe.BULK_CREATE_USERS,color:"primary",action:()=>{e(`${he.USERS}?action=bulk-import`)}}];return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsx(_e,{className:"py-4",children:s.jsx(oe,{className:"mb-4",children:s.jsx(U,{lg:12,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(H.Body,{children:s.jsx(oe,{children:t.map((r,a)=>{const n=r.icon;return s.jsx(Ar,{permission:r.permission,fallback:null,children:s.jsx(U,{md:4,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:r.action,children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(n,{size:24,className:`text-${r.color} me-2`}),s.jsx("h6",{className:"mb-0",children:r.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),s.jsx(un,{size:16,className:`text-${r.color} ms-auto`})]})},a)},r.id)})})})]})})})})})},lce=({field:e,onViewDetail:t,onEdit:r})=>{const{hasPermission:a}=to(),n=[{label:"View Detail",icon:s.jsx(vt,{size:16}),onClick:()=>t(e),permission:fe.VIEW_GLOBAL_FIELD_IN_DETAIL},{label:"Edit Global Field",icon:s.jsx(ts,{size:16}),onClick:()=>r(e),permission:fe.UPDATE_GLOBAL_FIELD}].filter(i=>!i.permission||a(i.permission));return s.jsx(H,{className:"h-100 border-0 shadow-sm",style:{transition:"all 0.3s ease"},onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(H.Body,{className:"p-3 d-flex flex-column position-relative",children:[s.jsx("div",{className:"position-absolute",style:{top:"0.5rem",right:"0.5rem",zIndex:10},children:s.jsx(Ar,{permissions:[fe.VIEW_GLOBAL_FIELD_IN_DETAIL,fe.UPDATE_GLOBAL_FIELD],fallback:null,children:s.jsx(er,{align:"end",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:n})})}),s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0,paddingRight:"2rem"},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(vt,{size:20})}),s.jsx("div",{className:"flex-grow-1",style:{minWidth:0},children:s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:e.label,children:e.label})})]}),s.jsxs("div",{className:"mb-2",style:{flexShrink:0},children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Field Name:"}),s.jsx("code",{className:"text-dark d-block",style:{fontSize:"0.85rem",wordBreak:"break-word",backgroundColor:"var(--bs-neutral-200)",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},children:e.fieldName})]}),e.roleRequired&&s.jsxs("div",{className:"mt-auto",style:{flexShrink:0},children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Role Required:"}),s.jsx("span",{className:"badge bg-secondary",children:e.roleRequired})]})]})})},oce=({show:e,onHide:t,field:r})=>{if(!r)return null;const a=i=>{if(!i)return"N/A";try{return new Date(i).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return i}},n=i=>{const o={TEXT:{variant:"primary",text:"TEXT"},NUMBER:{variant:"info",text:"NUMBER"},DATE:{variant:"success",text:"DATE"},SELECT:{variant:"warning",text:"SELECT"},CHECKBOX:{variant:"secondary",text:"CHECKBOX"}}[i]||{variant:"secondary",text:i||"N/A"};return s.jsx(Ne,{bg:o.variant,className:"px-2 py-1",children:o.text})};return s.jsxs(le,{show:e,onHide:t,size:"md",centered:!0,fullscreen:"md-down",children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0 d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[s.jsxs(le.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(vt,{className:"me-2",size:20}),s.jsx("span",{children:"Global Field Detail"})]}),s.jsx("button",{onClick:t,className:"btn btn-link text-white p-0",style:{border:"none",background:"none",opacity:.9},children:s.jsx(Xe,{size:24})})]}),s.jsx(le.Body,{style:{padding:"1.5rem",maxHeight:"60vh",overflowY:"auto"},children:s.jsxs(Aa,{variant:"flush",children:[s.jsx(Aa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Label"}),s.jsx("span",{className:"text-dark fw-medium",children:r.label||"N/A"})]})]})}),s.jsx(Aa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Field Name"}),s.jsx("code",{className:"text-dark",style:{fontSize:"0.9rem",backgroundColor:"var(--bs-neutral-200)",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},children:r.fieldName||"N/A"})]})]})}),s.jsx(Aa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Field Type"}),s.jsx("div",{children:n(r.fieldType)})]})]})}),r.roleRequired&&s.jsx(Aa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Role Required"}),s.jsx(Ne,{bg:"secondary",children:r.roleRequired})]})]})}),r.options&&s.jsx(Aa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(vt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Options"}),s.jsx("span",{className:"text-dark",children:JSON.stringify(r.options)})]})]})}),r.createdBy&&s.jsx(Aa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(Ft,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created By"}),s.jsxs("span",{className:"text-dark",children:[r.createdBy.firstName," ",r.createdBy.lastName]})]})]})}),r.createdAt&&s.jsx(Aa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(xr,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created At"}),s.jsx("span",{className:"text-dark",children:a(r.createdAt)})]})]})}),r.updatedBy&&s.jsx(Aa.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(Ft,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Updated By"}),s.jsxs("span",{className:"text-dark",children:[r.updatedBy.firstName," ",r.updatedBy.lastName]})]})]})}),r.updatedAt&&s.jsx(Aa.Item,{className:"px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(Qe,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Updated At"}),s.jsx("span",{className:"text-dark",children:a(r.updatedAt)})]})]})})]})}),s.jsx(le.Footer,{className:"bg-light border-0",children:s.jsx("button",{onClick:t,className:"btn btn-secondary",style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#ffffff"},children:"Close"})})]})},cce=({show:e,onHide:t,field:r,onSuccess:a})=>{const[n,i]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),[l,o]=v.useState({}),[c,u]=v.useState(!1);v.useEffect(()=>{r&&e&&(i({label:r.label||"",fieldName:r.fieldName||"",fieldType:r.fieldType||"TEXT",roleRequired:r.roleRequired||"",options:r.options||null}),o({}))},[r,e]);const d=p=>{const{name:h,value:g}=p.target;i(b=>({...b,[h]:g})),l[h]&&o(b=>({...b,[h]:""}))},m=()=>{const p={};return n.label.trim()||(p.label="Label is required"),n.fieldName.trim()||(p.fieldName="Field Name is required"),n.fieldType||(p.fieldType="Field Type is required"),o(p),Object.keys(p).length===0},f=async p=>{if(p.preventDefault(),!!m())try{u(!0);const h={label:n.label.trim(),fieldName:n.fieldName.trim(),fieldType:n.fieldType,roleRequired:n.roleRequired||null,options:n.options||null};await Xo.updateGlobalField(r.id,h),te.success("Global field updated successfully"),a&&a(),t()}catch(h){console.error("Error updating global field:",h);const g=h.response?.data?.message||h.message||"Failed to update global field";te.error(g)}finally{u(!1)}},x=()=>{i({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),o({}),t()};return s.jsxs(le,{show:e,onHide:x,size:"lg",centered:!0,fullscreen:"md-down",children:[s.jsxs(le.Header,{className:"bg-primary-custom text-white border-0 d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[s.jsxs(le.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(hs,{className:"me-2",size:20}),s.jsx("span",{children:"Edit Global Field"})]}),s.jsx("button",{onClick:x,className:"btn btn-link text-white p-0",style:{border:"none",background:"none",opacity:.9},children:s.jsx(Xe,{size:24})})]}),s.jsxs(I,{onSubmit:f,children:[s.jsxs(le.Body,{style:{padding:"1.5rem"},children:[s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-medium",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",name:"label",value:n.label,onChange:d,isInvalid:!!l.label,placeholder:"Enter field label"}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.label})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-medium",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",name:"fieldName",value:n.fieldName,onChange:d,isInvalid:!!l.fieldName,placeholder:"Enter field name (e.g., template_name)"}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.fieldName})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsxs(I.Label,{className:"fw-medium",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(I.Select,{name:"fieldType",value:n.fieldType,onChange:d,isInvalid:!!l.fieldType,children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"PART",children:"PART"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),s.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]}),s.jsx(I.Control.Feedback,{type:"invalid",children:l.fieldType})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{className:"fw-medium",children:"Role Required"}),s.jsxs(I.Select,{name:"roleRequired",value:n.roleRequired||"",onChange:d,children:[s.jsx("option",{value:"",children:"None"}),s.jsx("option",{value:"TRAINER",children:"TRAINER"}),s.jsx("option",{value:"TRAINEE",children:"TRAINEE"})]})]})]}),s.jsxs(le.Footer,{className:"bg-light border-0 d-flex flex-wrap gap-2",style:{justifyContent:"flex-end"},children:[s.jsx(se,{variant:"secondary",onClick:x,disabled:c,children:"Cancel"}),s.jsx(se,{variant:"primary",type:"submit",disabled:c,className:"d-flex align-items-center",children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{className:"me-2",size:16}),"Update Global Field"]})})]})]})]})},dce=({show:e,onHide:t,onSuccess:r})=>{const[a,n]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),[i,l]=v.useState(!1),o=(d,m)=>{if(!d)return{valid:!1,message:"Field name is required"};const f=String(m||"").toUpperCase();return f==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(d)?d.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:f==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(d)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(d)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},c=async()=>{if(!a.label||!a.fieldName||!a.roleRequired){te.warning("Please fill in all required fields");return}const d=o(a.fieldName,a.fieldType);if(!d.valid){te.warning(d.message);return}try{l(!0);const m={label:a.label.trim(),fieldName:a.fieldName.trim(),fieldType:a.fieldType,roleRequired:a.roleRequired||null,options:a.options||null};await Xo.createGlobalField(m),te.success("Global field created successfully"),r&&r(),u()}catch(m){console.error("Error creating global field:",m);const f=m.response?.data?.message||m.message||"Failed to create global field";te.error(f)}finally{l(!1)}},u=()=>{n({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),t()};return s.jsxs(le,{show:e,onHide:u,size:"lg",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:"Create Global Field"})}),s.jsx(le.Body,{children:s.jsx(I,{children:s.jsxs(oe,{className:"g-3",children:[s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:"e.g., Crew Communication",value:a.label,onChange:d=>n(m=>({...m,label:d.target.value})),required:!0}),s.jsx(I.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(U,{md:12,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(I.Control,{type:"text",placeholder:a.fieldType==="PART"?"e.g., Assessment_Items":a.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:a.fieldName,onChange:d=>n(m=>({...m,fieldName:d.target.value})),required:!0}),s.jsx(I.Text,{className:"text-muted",children:a.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':a.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(I.Select,{value:a.fieldType,onChange:d=>n(m=>({...m,fieldType:d.target.value})),required:!0,children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"PART",children:"PART"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),s.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{children:[s.jsxs(I.Label,{className:"text-primary-custom",children:["Role Required ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(I.Select,{value:a.roleRequired,onChange:d=>n(m=>({...m,roleRequired:d.target.value})),required:!0,children:[s.jsx("option",{value:"",children:"Select role"}),s.jsx("option",{value:"TRAINER",children:"TRAINER"}),s.jsx("option",{value:"TRAINEE",children:"TRAINEE"})]})]})})]})})}),s.jsxs(le.Footer,{children:[s.jsx(se,{variant:"outline-secondary",onClick:u,disabled:i,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:c,disabled:i,children:"Save Field"})]})]})},uce=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(null),[l,o]=v.useState(!1),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,x]=v.useState(null),[p,h]=v.useState(null),g=v.useCallback(async()=>{try{a(!0),i(null);const T=await Xo.getGlobalFields(),C=T?.data||T||[];t(C)}catch(T){console.error("Error loading global fields:",T),i(T.response?.data?.message||T.message||"Failed to load global fields"),te.error("Failed to load global fields"),t([])}finally{a(!1)}},[]);v.useEffect(()=>{g()},[g]);const b=async T=>{try{x(T);const C=await Xo.getGlobalFieldDetail(T.id),A=C?.data||C||T;h(A),o(!0)}catch(C){console.error("Error loading field detail:",C),te.error("Failed to load field details"),h(T),o(!0)}},j=T=>{x(T),u(!0)},y=()=>{o(!1),h(null),x(null)},w=()=>{u(!1),x(null)},N=()=>{g()},S=()=>{g()},E=()=>{m(!0)},_=()=>{m(!1)};return r?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary-custom text-white",children:s.jsx("h4",{className:"mb-0",children:"Global Field List"})}),s.jsx(H.Body,{children:s.jsx(zt,{})})]})}):n?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary-custom text-white",children:s.jsx("h4",{className:"mb-0",children:"Global Field List"})}),s.jsx(H.Body,{children:s.jsxs("div",{className:"alert alert-danger",children:[s.jsx("strong",{children:"Error:"})," ",n]})})]})}):s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary-custom text-white",style:{backgroundColor:"#1b3c53",borderBottom:"none"},children:s.jsxs(oe,{className:"align-items-center",children:[s.jsx(U,{children:s.jsx("h4",{className:"mb-0 text-white",children:"Global Field List"})}),s.jsx(U,{xs:"auto",className:"ms-auto",children:s.jsx(Ar,{permission:fe.CREATE_GLOBAL_FIELD,fallback:null,children:s.jsxs(se,{variant:"light",onClick:E,className:"d-flex align-items-center",size:"sm",style:{backgroundColor:"#ffffff",borderColor:"#dee2e6",color:"#000000",fontWeight:500},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#f8f9fa",T.currentTarget.style.borderColor="#dee2e6"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="#ffffff",T.currentTarget.style.borderColor="#dee2e6"},children:[s.jsx(Xr,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Create Global Field"}),s.jsx("span",{className:"d-sm-none",children:"Create"})]})})})]})}),s.jsx(H.Body,{children:e.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsx("p",{className:"text-muted",children:"No global fields found"})}):s.jsx(oe,{className:"g-3 g-md-4",children:e.map(T=>s.jsx(U,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(lce,{field:T,onViewDetail:b,onEdit:j})},T.id))})})]}),s.jsx(oce,{show:l,onHide:y,field:p}),s.jsx(cce,{show:c,onHide:w,field:f,onSuccess:N}),s.jsx(dce,{show:d,onHide:_,onSuccess:S})]})},mce=`
  .signature-required-table-no-borders .table,
  .signature-required-table-no-borders .table td,
  .signature-required-table-no-borders .table th,
  .signature-required-table-no-borders .table tbody tr,
  .signature-required-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .signature-required-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .signature-required-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=mce,document.head.appendChild(e)}const fce=({traineeId:e})=>{const t=Ge(),[r,a]=v.useState([]),[n,i]=v.useState(!0),{sortedData:l,sortConfig:o,handleSort:c}=ur(r);v.useEffect(()=>{u()},[e]);const u=async()=>{try{i(!0);const f=[{id:"1",name:"Safety Training Acknowledgment",course:"Safety Procedures Training",subject:"Basic Safety Protocols",dueDate:"2024-01-25T23:59:59.000Z",status:"PENDING"},{id:"2",name:"Equipment Usage Agreement",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",dueDate:"2024-01-30T23:59:59.000Z",status:"PENDING"},{id:"3",name:"Confidentiality Agreement",course:"Company Policies Training",subject:"Data Protection Guidelines",dueDate:"2024-02-05T23:59:59.000Z",status:"COMPLETED"}];await new Promise(x=>setTimeout(x,300)),a(f)}catch(f){console.error("Error loading signature required:",f),te.error("Failed to load signature requirements")}finally{i(!1)}},d=f=>{const p={PENDING:{variant:"warning",text:"Pending"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return s.jsx(Ne,{bg:p.variant,children:p.text})},m=f=>{e?t(`/trainee/${e}/signature-pad/${f}`):te.error("Unable to open signature pad: Trainee ID not found")};return n?s.jsx("div",{className:"text-center py-4",children:s.jsx(zt,{count:5})}):r.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(_n,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):s.jsx("div",{className:"scrollable-table-container admin-table signature-required-table-no-borders",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Document",sortKey:"name",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Course",sortKey:"course",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Subject",sortKey:"subject",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Due Date",sortKey:"dueDate",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Status",sortKey:"status",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:l.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.subject})}),s.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),s.jsx("td",{children:d(f.status)}),s.jsx("td",{children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"Sign Document",icon:s.jsx(_n,{}),onClick:()=>m(f.id)}]})})]},f.id))})]})})},hce=()=>{const{user:e}=xs();return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(fce,{traineeId:e?.id})})},pce=`
  .section-completion-table-no-borders .table,
  .section-completion-table-no-borders .table td,
  .section-completion-table-no-borders .table th,
  .section-completion-table-no-borders .table tbody tr,
  .section-completion-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .section-completion-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .section-completion-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=pce,document.head.appendChild(e)}const xce=({traineeId:e})=>{const t=Ge(),[r,a]=v.useState([]),[n,i]=v.useState(!0),{sortedData:l,sortConfig:o,handleSort:c}=ur(r);v.useEffect(()=>{u()},[e]);const u=async()=>{try{i(!0);const f=[{id:"1",name:"Introduction to Safety Protocols",course:"Safety Procedures Training",subject:"Basic Safety Protocols",section:"Theory",dueDate:"2024-01-25T23:59:59.000Z",progress:75,status:"IN_PROGRESS"},{id:"2",name:"Practical Equipment Handling",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",section:"Practical",dueDate:"2024-01-30T23:59:59.000Z",progress:100,status:"COMPLETED"},{id:"3",name:"Data Protection Guidelines",course:"Company Policies Training",subject:"Data Protection Guidelines",section:"Assessment",dueDate:"2024-02-05T23:59:59.000Z",progress:0,status:"PENDING"}];await new Promise(x=>setTimeout(x,300)),a(f)}catch(f){console.error("Error loading section completion:",f),te.error("Failed to load section completion requirements")}finally{i(!1)}},d=f=>{const p={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return s.jsx(Ne,{bg:p.variant,children:p.text})},m=f=>{e?t(`/trainee/${e}/assessment-section/${f}`):te.error("Unable to open section: Trainee ID not found")};return n?s.jsx("div",{className:"text-center py-4",children:s.jsx(zt,{count:5})}):r.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Je,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):s.jsx("div",{className:"scrollable-table-container admin-table section-completion-table-no-borders",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Section",sortKey:"name",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Course",sortKey:"course",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Subject",sortKey:"subject",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Type",sortKey:"section",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Due Date",sortKey:"dueDate",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Progress",sortKey:"progress",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Status",sortKey:"status",sortConfig:o,onSort:c})}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:l.map(f=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:f.subject})}),s.jsx("td",{children:s.jsx(Ne,{bg:"primary",className:"fw-normal",children:f.section})}),s.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${f.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:[f.progress,"%"]})]})}),s.jsx("td",{children:d(f.status)}),s.jsx("td",{children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:f.status==="COMPLETED"?"View Section":"Complete Section",icon:f.status==="COMPLETED"?s.jsx(St,{}):s.jsx(Je,{}),onClick:()=>m(f.id)}]})})]},f.id))})]})})},A2=()=>{const{user:e}=xs();return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(xce,{traineeId:e?.id})})},gce=({uniqueTypes:e,uniqueStatuses:t,uniquePriorities:r,selectedTypes:a,selectedStatuses:n,selectedPriorities:i,onTypeToggle:l,onStatusToggle:o,onPriorityToggle:c,onClearFilters:u,className:d=""})=>{const m=a.length>0||n.length>0||i.length>0;return s.jsxs(kt,{className:`filter-panel-dropdown course-filter-dropdown ${d}`,children:[s.jsx(kt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ol,{size:14,className:"me-2"}),"Filters",m&&s.jsx("span",{className:"badge bg-primary ms-2",children:a.length+n.length+i.length})]})}),s.jsxs(kt.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Types"}),a.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>l("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(f=>s.jsx(I.Check,{type:"checkbox",id:`type-${f}`,label:f,checked:a.includes(f),onChange:()=>l(f),className:"mb-1"},f))})]}),s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),n.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>o("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(f=>s.jsx(I.Check,{type:"checkbox",id:`status-${f}`,label:f,checked:n.includes(f),onChange:()=>o(f),className:"mb-1"},f))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Priority"}),i.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>c("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(f=>s.jsx(I.Check,{type:"checkbox",id:`priority-${f}`,label:f,checked:i.includes(f),onChange:()=>c(f),className:"mb-1"},f))})]}),m&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:u,children:[s.jsx(Xe,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},P4=document.createElement("style");P4.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(P4);const vce=`
  .assessments-table-no-borders .table,
  .assessments-table-no-borders .table td,
  .assessments-table-no-borders .table th,
  .assessments-table-no-borders .table tbody tr,
  .assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=vce,document.head.appendChild(e)}const bce=({traineeId:e})=>{const t=Ge(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(""),[c,u]=v.useState([]),[d,m]=v.useState([]),[f,x]=v.useState([]),{sortedData:p,sortConfig:h,handleSort:g}=ur(r);v.useEffect(()=>{b()},[e]);const b=async()=>{try{i(!0);const M=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",dueDate:"2024-01-25T14:30:00.000Z",status:"PENDING"},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",dueDate:"2024-01-28T10:15:00.000Z",status:"IN_PROGRESS"},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Equipment Handling Course",code:"EHC001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",dueDate:"2024-02-01T16:45:00.000Z",status:"PENDING"}];await new Promise(X=>setTimeout(X,300)),a(M)}catch(M){console.error("Error loading assessments:",M),te.error("Failed to load assessments")}finally{i(!1)}},j=v.useMemo(()=>r.filter(M=>{const X=l===""||M.name.toLowerCase().includes(l.toLowerCase())||M.description.toLowerCase().includes(l.toLowerCase())||M.course?.name.toLowerCase().includes(l.toLowerCase())||M.subject?.name.toLowerCase().includes(l.toLowerCase()),ie=c.length===0||c.includes(M.type),ae=d.length===0||d.includes(M.status),V=f.length===0||f.includes(M.priority);return X&&ie&&ae&&V}),[r,l,c,d,f]),y=v.useMemo(()=>[...new Set(r.map(X=>X.type))].filter(Boolean),[r]),w=v.useMemo(()=>[...new Set(r.map(X=>X.status))].filter(Boolean),[r]),N=v.useMemo(()=>[...new Set(r.map(X=>X.priority))].filter(Boolean),[r]),S=M=>{o(M.target.value)},E=M=>{u(X=>X.includes(M)?X.filter(ie=>ie!==M):[...X,M])},_=M=>{m(X=>X.includes(M)?X.filter(ie=>ie!==M):[...X,M])},T=M=>{x(X=>X.includes(M)?X.filter(ie=>ie!==M):[...X,M])},C=()=>{u([]),m([]),x([]),o("")},A=M=>{const ie={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[M]||{variant:"secondary",text:M};return s.jsx(Ne,{bg:ie.variant,children:ie.text})},D=M=>{const ie={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"success",text:"Low"}}[M]||{variant:"secondary",text:M};return s.jsx(Ne,{bg:ie.variant,children:ie.text})},P=M=>{t(`/trainee/${e}/assessment/${M.id}`)},R=M=>{t(`/trainee/${e}/assessment/${M.id}`)};return n?s.jsx("div",{className:"text-center py-4",children:s.jsx(zt,{count:8})}):s.jsx("div",{className:"trainee-your-assessments",children:s.jsx(H,{className:"shadow-sm",children:s.jsx(H.Body,{className:"p-0",children:s.jsxs(Ux,{defaultActiveKey:"upcoming",className:"border-bottom",children:[s.jsx(Vt,{eventKey:"upcoming",title:"Upcoming Assessments",children:s.jsxs("div",{className:"p-3",children:[s.jsx("div",{style:{marginBottom:"3rem"},children:s.jsxs(oe,{className:"form-mobile-stack",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search assessments by name, description, course, or subject...",value:l,onChange:S,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(gce,{uniqueTypes:y,uniqueStatuses:w,uniquePriorities:N,selectedTypes:c,selectedStatuses:d,selectedPriorities:f,onTypeToggle:E,onStatusToggle:_,onPriorityToggle:T,onClearFilters:C,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[j.length," assessment",j.length!==1?"s":""]})})})]})}),j.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Ht,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:r.length===0?"No upcoming assessments":"No assessments match your filters"})]}):s.jsx("div",{className:"scrollable-table-container admin-table assessments-table-no-borders",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Assessment",sortKey:"name",sortConfig:h,onSort:g})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Course",sortKey:"course",sortConfig:h,onSort:g})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Subject",sortKey:"subject",sortConfig:h,onSort:g})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Type",sortKey:"type",sortConfig:h,onSort:g})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Priority",sortKey:"priority",sortConfig:h,onSort:g})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Due Date",sortKey:"dueDate",sortConfig:h,onSort:g})}),s.jsx("th",{className:"text-start",children:s.jsx(yr,{title:"Status",sortKey:"status",sortConfig:h,onSort:g})}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:p.map(M=>s.jsxs("tr",{children:[s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:M.name}),s.jsx("small",{className:"text-muted",children:M.description})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:M.course?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:M.course?.code||""})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:M.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:M.subject?.code||""})]}),s.jsx("td",{children:s.jsx(Ne,{bg:"primary",className:"fw-normal",children:M.type||"Assessment"})}),s.jsx("td",{children:D(M.priority)}),s.jsx("td",{children:M.dueDate?new Date(M.dueDate).toLocaleDateString():"N/A"}),s.jsx("td",{children:A(M.status)}),s.jsx("td",{children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:M.status==="PENDING"||M.status==="IN_PROGRESS"?"Start Assessment":"View Assessment",icon:M.status==="PENDING"||M.status==="IN_PROGRESS"?s.jsx(Vx,{}):s.jsx(St,{}),onClick:()=>M.status==="PENDING"||M.status==="IN_PROGRESS"?P(M):R(M)}]})})]},M.id))})]})})]})}),s.jsx(Vt,{eventKey:"completed",title:"Completed Assessments",children:s.jsx("div",{className:"p-3",children:s.jsx(D4,{traineeId:e})})})]})})})})},C2=()=>{const{user:e}=xs();return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(bce,{traineeId:e?.id})})},yce=`
  .create-issue-form .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-form .card-header h5 {
    color: #ffffff !important;
  }
  .create-issue-form .card-header svg {
    color: #ffffff !important;
  }
  .create-issue-guidelines .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-guidelines .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=yce,document.head.appendChild(e)}const jce=()=>{const[e,t]=v.useState({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1}),[r,a]=v.useState(!1),n=l=>{const{name:o,value:c,type:u,checked:d}=l.target;t(m=>({...m,[o]:u==="checkbox"?d:c}))},i=async l=>{l.preventDefault(),a(!0);try{console.log("Submitting incident/feedback report:",e),await new Promise(o=>setTimeout(o,1e3)),te.success("Incident/Feedback report submitted successfully!"),t({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1})}catch(o){console.error("Error submitting incident/feedback report:",o),te.error("Failed to submit incident/feedback report. Please try again.")}finally{a(!1)}};return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsx("div",{className:"d-flex align-items-center",children:s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Create Incident/Feedback Report"}),s.jsx("p",{className:"text-muted mb-0",children:"Report incidents or provide feedback about your training experience"})]})})})}),s.jsxs(oe,{className:"mt-4",children:[s.jsx(U,{lg:8,children:s.jsxs(H,{className:"border-0 shadow-sm create-issue-form",children:[s.jsx(H.Header,{children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(vt,{className:"me-2",size:20}),"Incident/Feedback Report Form"]})}),s.jsx(H.Body,{children:s.jsxs(I,{onSubmit:i,children:[s.jsxs(oe,{children:[s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Title"}),s.jsx(I.Control,{type:"text",name:"title",value:e.title,onChange:n,placeholder:"Brief description of the incident or feedback"})]})}),s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Request Type *"}),s.jsxs(I.Select,{name:"request_type",value:e.request_type,onChange:n,required:!0,children:[s.jsx("option",{value:"",children:"Select request type"}),s.jsx("option",{value:"SAFETY_REPORT",children:"Safety Report"}),s.jsx("option",{value:"INSTRUCTOR_REPORT",children:"Instructor Report"}),s.jsx("option",{value:"FATIGUE_REPORT",children:"Fatigue Report"}),s.jsx("option",{value:"TRAINING_PROGRAM_REPORT",children:"Training Program Report"}),s.jsx("option",{value:"FACILITIES_REPORT",children:"Facilities Report"}),s.jsx("option",{value:"COURSE_ORGANIZATION_REPORT",children:"Course Organization Report"}),s.jsx("option",{value:"ASSESSMENT_APPROVAL_REQUEST",children:"Assessment Approval Request"}),s.jsx("option",{value:"OTHER",children:"Other"})]})]})})]}),s.jsx(oe,{children:s.jsx(U,{md:6,children:s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Severity"}),s.jsxs(I.Select,{name:"severity",value:e.severity,onChange:n,children:[s.jsx("option",{value:"LOW",children:"Low"}),s.jsx("option",{value:"MEDIUM",children:"Medium"}),s.jsx("option",{value:"HIGH",children:"High"}),s.jsx("option",{value:"CRITICAL",children:"Critical"})]})]})})}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Description"}),s.jsx(I.Control,{as:"textarea",rows:4,name:"description",value:e.description,onChange:n,placeholder:"Please provide detailed information about the incident or feedback..."})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Actions Taken"}),s.jsx(I.Control,{as:"textarea",rows:3,name:"actions_taken",value:e.actions_taken,onChange:n,placeholder:"Describe any actions you have already taken regarding this incident..."})]}),s.jsx(I.Group,{className:"mb-4",children:s.jsx(I.Check,{type:"checkbox",name:"is_anonymous",checked:e.is_anonymous,onChange:n,label:"Submit anonymously (your identity will be kept confidential)"})}),s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(se,{type:"submit",variant:"primary",disabled:r,children:r?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(iS,{className:"me-2",size:16}),"Submit Incident/Feedback Report"]})})})]})})]})}),s.jsx(U,{lg:4,children:s.jsxs(H,{className:"border-0 shadow-sm create-issue-guidelines",children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Guidelines"})}),s.jsxs(H.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Before submitting:"}),s.jsxs("ul",{className:"small text-muted mb-0",children:[s.jsx("li",{children:"Check if the incident has already been reported"}),s.jsx("li",{children:"Provide clear and specific details"}),s.jsx("li",{children:"Include steps to reproduce the incident"}),s.jsx("li",{children:"Attach screenshots if applicable"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Response time:"}),s.jsxs("ul",{className:"small text-muted mb-0",children:[s.jsx("li",{children:"High priority: Within 24 hours"}),s.jsx("li",{children:"Medium priority: Within 2-3 days"}),s.jsx("li",{children:"Low priority: Within 1 week"})]})]}),s.jsxs(ke,{variant:"info",className:"small",children:[s.jsx("strong",{children:"Note:"})," All incident/feedback reports are reviewed by our support team. You will receive a response via email."]})]})]})})]})]})},wce=()=>{const e=Ge(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,c]=v.useState("all");ur(),v.useEffect(()=>{const p=[{id:1,title:"Safety Procedure Issue",description:"Reported safety concern in training module",reporter:"John Smith",reporterEmail:"john.smith@company.com",status:"open",priority:"high",createdAt:"2024-01-15T10:30:00Z",updatedAt:"2024-01-15T14:20:00Z"},{id:2,title:"Training Material Error",description:"Incorrect information in assessment template",reporter:"Sarah Johnson",reporterEmail:"sarah.johnson@company.com",status:"in_progress",priority:"medium",createdAt:"2024-01-14T09:15:00Z",updatedAt:"2024-01-15T11:45:00Z"},{id:3,title:"System Performance Issue",description:"Slow loading times during assessment",reporter:"Mike Wilson",reporterEmail:"mike.wilson@company.com",status:"resolved",priority:"low",createdAt:"2024-01-13T16:20:00Z",updatedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{r(p),n(!1)},1e3)},[]);const u=p=>{const h={open:{variant:"danger",icon:Er},in_progress:{variant:"warning",icon:Qe},resolved:{variant:"success",icon:Je},closed:{variant:"secondary",icon:fs}},g=h[p]||h.open,b=g.icon;return s.jsxs(Ne,{bg:g.variant,className:"d-flex align-items-center",children:[s.jsx(b,{size:12,className:"me-1"}),p.replace("_"," ").toUpperCase()]})},d=p=>{const h={high:"danger",medium:"warning",low:"info"};return s.jsx(Ne,{bg:h[p]||"secondary",children:p.toUpperCase()})},m=t.filter(p=>{const h=p.title.toLowerCase().includes(i.toLowerCase())||p.description.toLowerCase().includes(i.toLowerCase())||p.reporter.toLowerCase().includes(i.toLowerCase()),g=o==="all"||p.status===o;return h&&g}),f=p=>{e(he.REPORTS_DETAIL(p))},x=p=>[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>f(p.id),permission:fe.LIST_ALL_REPORTS}];return a?s.jsx(_e,{className:"py-4",children:s.jsx(zt,{})}):s.jsx(_e,{fluid:!0,className:"py-4 issue-list-page",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(oe,{className:"align-items-center",children:s.jsx(U,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end gap-2",children:s.jsx(se,{variant:"outline-primary",size:"sm",children:"Export Issues"})})})})}),s.jsxs(H.Body,{children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search issues by title, description, or reporter...",value:i,onChange:l,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsxs("select",{className:"form-select filter-panel-mobile",value:o,onChange:p=>c(p.target.value),children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"resolved",children:"Resolved"}),s.jsx("option",{value:"closed",children:"Closed"})]})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[m.length," issue",m.length!==1?"s":""]})})})]}),s.jsx(im,{data:m,loading:a,columns:[{key:"title",title:"Issue Title",className:"show-mobile",sortable:!0},{key:"reporter",title:"Reporter",className:"hide-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"priority",title:"Priority",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"Created Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(p,h)=>s.jsxs("tr",{className:`${h%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor=h%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:p.title}),s.jsx("small",{className:"text-muted",children:p.description})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:p.reporter}),s.jsx("small",{className:"text-muted",children:p.reporterEmail})]})}),s.jsx("td",{className:"align-middle show-mobile",children:u(p.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:d(p.priority)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:new Date(p.createdAt).toLocaleDateString()})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.LIST_ALL_REPORTS],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:x(p)})})})]},p.id),emptyMessage:"No issues found",emptyDescription:"Try adjusting your search criteria."})]})]})})},Nce=()=>{const e=Ge(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,c]=v.useState("all");ur(),v.useEffect(()=>{const h=[{id:1,title:"Training Course Feedback",description:"Positive feedback about the safety training course",submitter:"Sarah Johnson",submitterEmail:"sarah.johnson@company.com",status:"acknowledged",category:"training",rating:5,createdAt:"2024-01-15T10:30:00Z",acknowledgedAt:"2024-01-15T14:20:00Z"},{id:2,title:"System Usability Feedback",description:"Suggestions for improving the assessment interface",submitter:"Mike Wilson",submitterEmail:"mike.wilson@company.com",status:"pending",category:"system",rating:4,createdAt:"2024-01-14T09:15:00Z",acknowledgedAt:null},{id:3,title:"Content Quality Feedback",description:"Feedback about the quality of training materials",submitter:"John Smith",submitterEmail:"john.smith@company.com",status:"acknowledged",category:"content",rating:3,createdAt:"2024-01-13T16:20:00Z",acknowledgedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{r(h),n(!1)},1e3)},[]);const u=h=>{const g={pending:{variant:"warning",icon:Qe},acknowledged:{variant:"success",icon:Je},reviewed:{variant:"info",icon:G2}},b=g[h]||g.pending,j=b.icon;return s.jsxs(Ne,{bg:b.variant,className:"d-flex align-items-center",children:[s.jsx(j,{size:12,className:"me-1"}),h.toUpperCase()]})},d=h=>{const g={training:"primary",system:"info",content:"success",general:"secondary"};return s.jsx(Ne,{bg:g[h]||"secondary",children:h.toUpperCase()})},m=t.filter(h=>{const g=h.title.toLowerCase().includes(i.toLowerCase())||h.description.toLowerCase().includes(i.toLowerCase())||h.submitter.toLowerCase().includes(i.toLowerCase()),b=o==="all"||h.status===o;return g&&b}),f=h=>{e(he.REPORTS_DETAIL(h))},x=h=>{e(`/sqa/feedback/${h}/acknowledge`)},p=h=>[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>f(h.id),permission:fe.LIST_ALL_REPORTS},{label:"Acknowledge",icon:s.jsx(Je,{}),onClick:()=>x(h.id),disabled:h.status==="acknowledged"||h.status==="reviewed",permission:fe.LIST_ALL_REPORTS}];return a?s.jsx(_e,{className:"py-4",children:s.jsx(zt,{})}):s.jsx(_e,{fluid:!0,className:"py-4 feedback-list-page",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(oe,{className:"align-items-center",children:s.jsx(U,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end gap-2",children:s.jsx(se,{variant:"outline-primary",size:"sm",children:"Export Feedback"})})})})}),s.jsxs(H.Body,{children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search feedback by title, description, or submitter...",value:i,onChange:l,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsxs("select",{className:"form-select filter-panel-mobile",value:o,onChange:h=>c(h.target.value),children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"acknowledged",children:"Acknowledged"}),s.jsx("option",{value:"reviewed",children:"Reviewed"})]})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[m.length," feedback",(m.length!==1,"")]})})})]}),s.jsx(im,{data:m,loading:a,columns:[{key:"title",title:"Feedback Title",className:"show-mobile",sortable:!0},{key:"submitter",title:"Submitter",className:"hide-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"category",title:"Category",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"Created Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(h,g)=>s.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:h.title}),s.jsx("small",{className:"text-muted",children:h.description})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:h.submitter}),s.jsx("small",{className:"text-muted",children:h.submitterEmail})]})}),s.jsx("td",{className:"align-middle show-mobile",children:u(h.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:d(h.category)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:new Date(h.createdAt).toLocaleDateString()})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.LIST_ALL_REPORTS],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:p(h)})})})]},h.id),emptyMessage:"No feedback found",emptyDescription:"Try adjusting your search criteria."})]})]})})},Sce=({activeTab:e,onTabChange:t,counts:r={}})=>{const a=[{id:"pending",label:"Pending",icon:Qe,status:"PENDING"},{id:"approved",label:"Approved (Published)",icon:Je,status:"PUBLISHED"},{id:"denied",label:"Rejected",icon:fs,status:"DENIED"}];return s.jsx("div",{className:"bg-primary-custom text-white template-detail-tabs-container",children:s.jsx("div",{className:"d-flex border-bottom border-white border-opacity-25 template-detail-tabs",style:{overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:a.map(n=>{const i=n.icon,l=e===n.id,o=r[n.id]||0;return s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${l?"border-bottom border-white border-3":""}`,onClick:()=>t(n.id),style:{fontWeight:l?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(i,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:n.label}),s.jsx("span",{className:"d-inline d-sm-none",children:n.label.split(" ")[0]}),o>0&&s.jsx(Ne,{bg:"light",text:"dark",className:"ms-2",style:{fontSize:"0.7rem",padding:"2px 6px",borderRadius:"10px",backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white"},children:o})]},n.id)})})})},Ece=({templates:e,onViewDetail:t})=>{const r=n=>{const i={PENDING:{variant:"warning",icon:Qe,text:"PENDING"},PUBLISHED:{variant:"success",icon:Je,text:"PUBLISHED"},DENIED:{variant:"danger",icon:fs,text:"REJECTED"},REJECTED:{variant:"danger",icon:fs,text:"REJECTED"},DRAFT:{variant:"secondary",icon:Qe,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:vt,text:"ARCHIVED"}},l=i[n]||i.DRAFT,o=l.icon;return s.jsxs(Ne,{bg:l.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(o,{size:12}),l.text]})},a=n=>{if(!n)return"N/A";try{return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return n}};return e.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(vt,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No templates found"}),s.jsx("p",{className:"text-muted",children:"No templates match your current filters."})]}):s.jsx(oe,{className:"g-3 g-md-4",children:e.map(n=>s.jsx(U,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(H,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease",cursor:"pointer"},onClick:()=>t(n.id),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(H.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(vt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:n.name,children:n.name}),s.jsxs("small",{className:"text-muted",children:["v",n.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:n.description||"No description",children:n.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ls,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:n.department?.code||"N/A",children:n.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:r(n.status)})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Ft,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:n.createdByUser?.firstName&&n.createdByUser?.lastName?`${n.createdByUser.firstName} ${n.createdByUser.lastName}`:n.createdBy||"N/A",children:n.createdByUser?.firstName&&n.createdByUser?.lastName?`${n.createdByUser.firstName} ${n.createdByUser.lastName}`:n.createdBy||"N/A"})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:a(n.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center flex-shrink-0",children:[s.jsx(vt,{size:12,className:"me-1"}),n._count?.sections||n.sections||0," sections"]}),s.jsx(Ar,{permissions:[fe.VIEW_TEMPLATE_DETAILS],fallback:null,children:s.jsxs(se,{variant:"link",size:"sm",className:"p-0 text-primary-custom flex-shrink-0 ms-2",onClick:i=>{i.stopPropagation(),t(n.id)},style:{whiteSpace:"nowrap"},children:[s.jsx(St,{size:14,className:"me-1"}),"View Detail"]})})]})})]})})},n.id))})},Tce=({templates:e,searchTerm:t,onSearchChange:r,onViewDetail:a})=>s.jsxs(s.Fragment,{children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search templates by name, description, or creator...",value:t,onChange:r,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:6,md:7,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[e.length," template",e.length!==1?"s":""]})})})]}),s.jsx("div",{className:"template-card-scroll-container",children:s.jsx(Ece,{templates:e,onViewDetail:a})})]}),Ace=()=>{const e=Ge(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState("pending"),[o,c]=v.useState("");v.useEffect(()=>{u()},[]);const u=async()=>{try{n(!0);const h=await cr.getTemplates();let g=[];h.success&&h.data?g=h.data:Array.isArray(h)?g=h:h.data&&Array.isArray(h.data)&&(g=h.data),r(g)}catch(h){console.error("Error loading templates:",h),te.error("Failed to load templates"),r([])}finally{n(!1)}},d=h=>{switch(h){case"pending":return"PENDING";case"approved":return"PUBLISHED";case"denied":return["DENIED","REJECTED"];default:return null}},m=v.useMemo(()=>{const h=d(i);return h?Array.isArray(h)?t.filter(g=>h.includes(g.status)):t.filter(g=>g.status===h):[]},[t,i]),f=v.useMemo(()=>m.filter(h=>{const g=h.name?.toLowerCase()||"",b=h.description?.toLowerCase()||"",j=h.createdBy?.toLowerCase()||(h.createdByUser?.firstName&&h.createdByUser?.lastName?`${h.createdByUser.firstName} ${h.createdByUser.lastName}`.toLowerCase():"");return g.includes(o.toLowerCase())||b.includes(o.toLowerCase())||j.includes(o.toLowerCase())}),[m,o]),x=v.useMemo(()=>({pending:t.filter(h=>h.status==="PENDING").length,approved:t.filter(h=>h.status==="PUBLISHED").length,denied:t.filter(h=>h.status==="DENIED"||h.status==="REJECTED").length}),[t]),p=h=>{console.log("View detail for template:",h),e(he.TEMPLATES_DETAIL(h))};return a?s.jsx(_e,{fluid:!0,className:"p-4",children:s.jsx(zt,{})}):s.jsx(_e,{fluid:!0,className:"py-4 template-list-page",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-light-custom border-neutral-200"}),s.jsx(Sce,{activeTab:i,onTabChange:l,counts:x}),s.jsx(H.Body,{children:s.jsx(Tce,{templates:f,searchTerm:o,onSearchChange:c,onViewDetail:p})})]})})},Cce=({template:e})=>{const r=(n=>{switch(n){case"ACTIVE":return{variant:"success",icon:Je,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:Qe,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:Qe,text:"INACTIVE"};case"PENDING":return{variant:"warning",icon:Qe,text:"PENDING"};case"PUBLISHED":return{variant:"success",icon:Je,text:"PUBLISHED"};case"REJECTED":case"DENIED":return{variant:"danger",icon:Qe,text:"REJECTED"};default:return{variant:"secondary",icon:Qe,text:n}}})(e?.status),a=r.icon;return s.jsx("div",{className:"p-4",children:s.jsxs(oe,{children:[s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Version"}),s.jsx("div",{children:s.jsx(Ne,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:e?.version})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Status"}),s.jsx("div",{children:s.jsxs(Ne,{bg:r.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx(a,{className:"me-1",size:12}),r.text]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Sections"}),s.jsxs("div",{className:"fw-medium",children:[e?.totalSections||0," sections"]})]})]}),s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{className:"me-2",size:16}),s.jsx("span",{children:e?.createdBy||"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{className:"me-2",size:16}),s.jsx("span",{children:e?.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"me-2",size:16}),s.jsx("span",{children:e?.lastModified?new Date(e.lastModified).toLocaleDateString():"N/A"})]})]})]})]})})},_ce=({sections:e=[]})=>{if(e.length===0)return s.jsx(ke,{variant:"info",className:"mb-0",children:s.jsxs("div",{children:[s.jsx("strong",{children:"No template config found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no sections or fields yet."})]})});const t=[];return e.forEach((r,a)=>{t.push({type:"section",id:r.id||`section-${a}`,name:r.label||r.name,fieldCount:r.fields?.length||0,data:r}),r.fields&&r.fields.length>0&&r.fields.forEach((n,i)=>{t.push({type:"field",id:n.id||n.fieldName||`field-${a}-${i}`,name:n.label||n.fieldName,parentSectionId:r.id||`section-${a}`,data:n})})}),s.jsx("div",{children:s.jsx("div",{className:"list-group",style:{border:"none"},children:t.map(r=>{const a=r.type==="section",n=r.type==="field";return s.jsx("div",{className:"list-group-item",style:{border:"none",borderBottom:"1px solid #e9ecef",padding:"12px 16px",backgroundColor:"white",paddingLeft:n?"40px":"16px"},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{className:"d-flex align-items-center",style:{flex:1,minWidth:0},children:[s.jsx("span",{style:{fontSize:"14px",color:"#333",fontWeight:a?500:400,wordBreak:"break-word",overflowWrap:"break-word"},children:r.name}),a&&r.fieldCount>0&&s.jsx(Ne,{bg:"info",className:"ms-2",style:{fontSize:"11px",padding:"2px 8px",borderRadius:"12px",backgroundColor:"#0dcaf0",color:"#000"},children:r.fieldCount})]}),s.jsx(Ne,{bg:a?"warning":"secondary",style:{fontSize:"11px",padding:"4px 10px",borderRadius:"4px",backgroundColor:a?"#ffc107":"var(--bs-secondary)",color:a?"#000":"#fff",fontWeight:500,marginLeft:"12px"},children:a?"SECTION":r.data?.fieldType||r.data?.type||"FIELD"})]})},r.id)})})})},kce=({template:e,pdfUrl:t,loadingPDF:r,onViewTemplateConfig:a,onOpenApproveModal:n,onOpenRejectModal:i,reviewing:l})=>s.jsxs("div",{className:"p-4",children:[s.jsx(oe,{children:s.jsx(U,{xs:12,className:"mb-3",children:s.jsxs("div",{className:"d-flex justify-content-end gap-2 mb-3",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:a,className:"d-flex align-items-center",disabled:!e?.templateConfig,children:[s.jsx(Ln,{className:"me-2",size:16}),"View Template Config"]}),s.jsxs(se,{variant:"primary",size:"sm",onClick:n,className:"d-flex align-items-center",disabled:e?.status!=="PENDING"||l,children:[s.jsx(Je,{className:"me-2",size:16}),"Approve"]}),s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:i,className:"d-flex align-items-center",disabled:e?.status!=="PENDING"||l,style:{backgroundColor:"white",borderColor:"#dee2e6",color:"#333"},children:[s.jsx(fs,{className:"me-2",size:16}),"Reject"]})]})})}),s.jsxs(oe,{children:[s.jsxs(U,{xs:12,lg:7,className:"mb-4",children:[s.jsx("div",{className:"mb-2",children:s.jsx("h6",{className:"mb-0",style:{color:"#333",fontWeight:500},children:"PDF Preview"})}),r?s.jsx("div",{className:"border rounded p-4 bg-light text-center",style:{minHeight:"500px",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{children:[s.jsx(xt,{animation:"border",variant:"primary",className:"mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"Loading PDF preview..."})]})}):t?s.jsx("div",{style:{height:"60vh",overflow:"hidden"},children:s.jsx("iframe",{src:t,style:{width:"100%",height:"100%",border:"1px solid #dee2e6",borderRadius:"0.375rem",display:"block"},title:"Template PDF Preview"})}):s.jsxs(ke,{variant:"warning",className:"mb-0",children:[s.jsx(Nc,{className:"me-2"}),"PDF preview is not available. Please try again or contact support."]})]}),s.jsxs(U,{xs:12,lg:5,children:[s.jsx("div",{className:"mb-2",children:s.jsx("h6",{className:"mb-0",style:{color:"#333",fontWeight:500},children:"Template fields & sections"})}),s.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:s.jsx(_ce,{sections:e?.sections||[]})})]})]})]}),Dce=({template:e})=>{const[t,r]=v.useState(null),[a,n]=v.useState(!1),[i,l]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e?.referFirstVersionId){l("No previous version found");return}try{n(!0),l(null);const x=await cr.getTemplateById(e.referFirstVersionId),p=x?.data?.templateForm||x?.data||x,h=x?.data?.sections||p?.sections||[];if(!p){l("Old version template not found");return}const g=p.createdByUser||p.createdBy,b=p.updatedByUser||p.updatedBy,j=w=>w?.firstName&&w?.lastName?`${w.firstName} ${w.lastName}`:w?.fullName||w?.name||"N/A",y={id:p.id,name:p.name||"N/A",description:p.description||"",version:p.version||"v1.0",totalSections:h.length||0,totalFields:h.reduce((w,N)=>w+(N.fields?.length||0),0)||0,status:p.status||"DRAFT",createdBy:j(g),createdAt:p.createdAt||p.createdDate,lastModified:p.updatedAt||p.updatedDate||p.createdAt,lastModifiedBy:j(b),sections:h,templateContent:p.templateContent||null,templateConfig:p.templateConfig||null,formId:p.formId||p.id};r(y)}catch(x){console.error("Error loading old version:",x),l(x.response?.data?.message||x.message||"Failed to load old version details")}finally{n(!1)}})()},[e?.referFirstVersionId]);const o=f=>{switch(f){case"ACTIVE":return{variant:"success",icon:Je,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:Qe,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:Qe,text:"INACTIVE"};case"PENDING":return{variant:"warning",icon:Qe,text:"PENDING"};case"PUBLISHED":return{variant:"success",icon:Je,text:"PUBLISHED"};case"REJECTED":case"DENIED":return{variant:"danger",icon:Qe,text:"REJECTED"};default:return{variant:"secondary",icon:Qe,text:f}}},c=()=>{t?.templateConfig?window.open(t.templateConfig,"_blank","noopener,noreferrer"):te.warning("Template config is not available")},u=async()=>{if(!t?.formId&&!t?.id){te.warning("Template ID is not available");return}try{const f=t.formId||t.id,x=await cr.getTemplatePDF(f),p=URL.createObjectURL(x),h=document.createElement("a");h.href=p,h.download=`${t.name||"template"}.pdf`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(p)}catch(f){console.error("Error downloading PDF:",f),te.error(f.response?.data?.message||"Failed to download template PDF")}};if(a)return s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading old version details..."})]})});if(i||!t)return s.jsx("div",{className:"p-4",children:s.jsxs(ke,{variant:"info",children:[s.jsx(ke.Heading,{children:"No Previous Version"}),s.jsx("p",{className:"mb-0",children:i||"This template does not have a previous version."})]})});const d=o(t.status),m=d.icon;return s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"d-flex justify-content-end gap-2 mb-4",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",onClick:c,className:"d-flex align-items-center",disabled:!t?.templateConfig,children:[s.jsx(Ln,{className:"me-2",size:16}),"View Template Config"]}),s.jsxs(se,{variant:"primary",size:"sm",onClick:u,className:"d-flex align-items-center",children:[s.jsx(Nc,{className:"me-2",size:16}),"Export PDF"]})]}),s.jsxs(H,{className:"mb-4",children:[s.jsx(H.Header,{className:"bg-light",children:s.jsx("h6",{className:"mb-0",children:"Template Information"})}),s.jsx(H.Body,{children:s.jsxs(oe,{children:[s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Template Name"}),s.jsx("div",{className:"fw-medium",children:t.name})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Description"}),s.jsx("div",{children:t.description||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Version"}),s.jsx("div",{children:s.jsx(Ne,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:t.version})})]})]}),s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Status"}),s.jsx("div",{children:s.jsxs(Ne,{bg:d.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx(m,{className:"me-1",size:12}),d.text]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Sections"}),s.jsxs("div",{className:"fw-medium",children:[t.totalSections," sections"]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Fields"}),s.jsxs("div",{className:"fw-medium",children:[t.totalFields," fields"]})]})]})]})})]}),s.jsxs(H,{children:[s.jsx(H.Header,{className:"bg-light",children:s.jsx("h6",{className:"mb-0",children:"Metadata"})}),s.jsx(H.Body,{children:s.jsxs(oe,{children:[s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{className:"me-2",size:16}),s.jsx("span",{children:t.createdBy})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{className:"me-2",size:16}),s.jsx("span",{children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]})]})]}),s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{className:"me-2",size:16}),s.jsx("span",{children:t.lastModifiedBy||"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{className:"me-2",size:16}),s.jsx("span",{children:t.lastModified?new Date(t.lastModified).toLocaleDateString():"N/A"})]})]})]})]})})]})]})},Ice=({show:e,onHide:t,template:r,onApprove:a,reviewing:n})=>s.jsxs(le,{show:e,onHide:t,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(le.Header,{className:"bg-primary-custom text-white border-0",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(Je,{className:"me-2",size:20}),"Approve Template"]})}),s.jsxs(le.Body,{className:"p-4",children:[s.jsxs("p",{className:"mb-0",children:["Are you sure you want to approve the template ",s.jsxs("strong",{children:['"',r?.name,'"']}),"?"]}),s.jsx("p",{className:"text-muted mt-2 mb-0",children:"Once approved, the template will be published and available for use."})]}),s.jsxs(le.Footer,{className:"border-0",children:[s.jsx(se,{variant:"outline-secondary",onClick:t,disabled:n,children:"Cancel"}),s.jsx(se,{variant:"primary",onClick:a,disabled:n,className:"d-flex align-items-center",children:n?s.jsxs(s.Fragment,{children:[s.jsx(xt,{animation:"border",size:"sm",className:"me-2"}),"Approving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Je,{className:"me-2",size:16}),"Approve"]})})]})]}),Oce=({show:e,onHide:t,template:r,rejectComment:a,onRejectCommentChange:n,onReject:i,reviewing:l})=>s.jsxs(le,{show:e,onHide:t,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(le.Header,{className:"bg-secondary text-white border-0",children:s.jsxs(le.Title,{className:"d-flex align-items-center",children:[s.jsx(fs,{className:"me-2",size:20}),"Reject Template"]})}),s.jsxs(le.Body,{className:"p-4",children:[s.jsxs("p",{className:"mb-3",children:["Are you sure you want to reject the template ",s.jsxs("strong",{children:['"',r?.name,'"']}),"?"]}),s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:s.jsxs("strong",{children:["Reason for Rejection ",s.jsx("span",{className:"text-danger",children:"*"})]})}),s.jsx(I.Control,{as:"textarea",rows:4,value:a,onChange:o=>n(o.target.value),placeholder:"Please provide a reason for rejecting this template...",disabled:l}),s.jsx(I.Text,{className:"text-muted",children:"This comment will be visible to the template creator."})]})]}),s.jsxs(le.Footer,{className:"border-0",children:[s.jsx(se,{variant:"outline-secondary",onClick:t,disabled:l,children:"Cancel"}),s.jsx(se,{variant:"secondary",onClick:i,disabled:l||!a.trim(),className:"d-flex align-items-center",children:l?s.jsxs(s.Fragment,{children:[s.jsx(xt,{animation:"border",size:"sm",className:"me-2"}),"Rejecting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(fs,{className:"me-2",size:16}),"Reject"]})})]})]}),Pce=()=>{const{templateId:e}=gr(),t=Ge(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState("basic-info"),[d,m]=v.useState(null),[f,x]=v.useState(!1),[p,h]=v.useState(!1),[g,b]=v.useState(!1),[j,y]=v.useState(""),[w,N]=v.useState(!1),[S,E]=v.useState(!1),_=v.useCallback(async()=>{if(!e){o("Template ID is required"),i(!1);return}try{i(!0),o(null);const ae=await cr.getTemplateById(e),V=ae?.data?.templateForm||ae?.data||ae,me=ae?.data?.sections||V?.sections||[];if(!V){o("Template not found");return}const ue=V.createdByUser||V.createdBy,F=V.updatedByUser||V.updatedBy,Y=k=>k?.firstName&&k?.lastName?`${k.firstName} ${k.lastName}`:k?.fullName||k?.name||"N/A",z={id:V.id,name:V.name||"N/A",description:V.description||"",version:V.version||"v1.0",category:V.category||"",totalSections:me.length||0,totalFields:me.reduce((k,O)=>k+(O.fields?.length||0),0)||0,status:V.status||"DRAFT",createdBy:Y(ue),createdAt:V.createdAt||V.createdDate,lastModified:V.updatedAt||V.updatedDate||V.createdAt,lastModifiedBy:Y(F),sections:me,history:V.history||V.versions||[],templateContent:V.templateContent||null,templateConfig:V.templateConfig||null,formId:V.formId||V.id,referFirstVersionId:V.referFirstVersionId||null};a(z)}catch(ae){console.error("Error loading template detail:",ae),o(ae.response?.data?.message||ae.message||"Failed to load template details")}finally{i(!1)}},[e]);v.useEffect(()=>{_()},[_]),v.useEffect(()=>((async()=>{if(c==="preview"&&r?.formId&&r?.templateContent)try{x(!0);const V=await cr.getTemplatePDF(r.formId),me=URL.createObjectURL(V);m(me)}catch(V){console.error("Error loading PDF:",V),m(null),te.error("Failed to load PDF preview")}finally{x(!1)}else m(V=>(V&&URL.revokeObjectURL(V),null))})(),()=>{m(V=>(V&&URL.revokeObjectURL(V),null))}),[c,r?.formId,r?.templateContent]);const T=async()=>{if(!r?.formId&&!r?.id){te.warning("Template ID is not available");return}try{E(!0);const ae=r.formId||r.id,V=await cr.getTemplatePDF(ae),me=URL.createObjectURL(V),ue=document.createElement("a");ue.href=me;const F=`${r.name||"template"}.pdf`;ue.download=F,document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),URL.revokeObjectURL(me)}catch(ae){console.error("Error downloading PDF:",ae),te.error(ae.response?.data?.message||"Failed to download template PDF")}finally{E(!1)}},C=()=>{t(he.TEMPLATES)},A=()=>{r?.templateConfig?window.open(r.templateConfig,"_blank","noopener,noreferrer"):te.warning("Template config is not available")},D=async()=>{if(r?.id)try{N(!0),await cr.reviewTemplate(r.id,{action:"PUBLISHED"}),te.success("Template approved successfully"),h(!1),t(he.TEMPLATES)}catch(ae){console.error("Error approving template:",ae),te.error(ae.response?.data?.message||"Failed to approve template")}finally{N(!1)}},P=async()=>{if(r?.id){if(!j.trim()){te.warning("Please provide a reason for rejection");return}try{N(!0),await cr.reviewTemplate(r.id,{action:"REJECTED",comment:j.trim()}),te.success("Template rejected successfully"),b(!1),y(""),t(he.TEMPLATES)}catch(ae){console.error("Error rejecting template:",ae),te.error(ae.response?.data?.message||"Failed to reject template")}finally{N(!1)}}},R=()=>{h(!0)},M=()=>{h(!1)},X=()=>{b(!0)},ie=()=>{b(!1),y("")};return n?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading template details..."})]})}):l?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:l}),s.jsxs(se,{variant:"outline-danger",onClick:C,children:[s.jsx(At,{className:"me-2"}),"Back to Template List"]})]})}):r?s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{xs:12,children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:C,className:"me-3",children:[s.jsx(At,{className:"me-1",size:16}),"Back to List"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1 text-dark",children:r.name}),s.jsx("p",{className:"text-muted mb-0",children:r.description})]})]}),s.jsx(Ar,{permissions:[fe.VIEW_ALL_TEMPLATES],fallback:null,children:s.jsx(se,{variant:"primary",size:"sm",onClick:T,className:"d-flex align-items-center",disabled:S,children:S?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Exporting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Nc,{className:"me-1",size:16}),"Export PDF"]})})})]})})}),s.jsx(oe,{children:s.jsx(U,{xs:12,children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary-custom border-neutral-200 p-0",children:s.jsxs("div",{className:"custom-tabs",children:[s.jsx("button",{className:`custom-tab ${c==="basic-info"?"active":""}`,onClick:()=>u("basic-info"),children:"Basic Info"}),s.jsx("button",{className:`custom-tab ${c==="preview"?"active":""}`,onClick:()=>u("preview"),children:"Preview"}),s.jsx("button",{className:`custom-tab ${c==="old-version"?"active":""}`,onClick:()=>u("old-version"),children:"Old Template Version Details"})]})}),s.jsxs(H.Body,{className:"p-0",children:[c==="basic-info"&&s.jsx(Cce,{template:r}),c==="preview"&&s.jsx(kce,{template:r,pdfUrl:d,loadingPDF:f,onViewTemplateConfig:A,onOpenApproveModal:R,onOpenRejectModal:X,reviewing:w}),c==="old-version"&&s.jsx(Dce,{template:r})]})]})})}),s.jsx(Ice,{show:p,onHide:M,template:r,onApprove:D,reviewing:w}),s.jsx(Oce,{show:g,onHide:ie,template:r,rejectComment:j,onRejectCommentChange:y,onReject:P,reviewing:w})]}):s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"warning",children:[s.jsx(ke.Heading,{children:"Template Not Found"}),s.jsx("p",{children:"The requested template could not be found."}),s.jsxs(se,{variant:"outline-warning",onClick:C,children:[s.jsx(At,{className:"me-2"}),"Back to Template List"]})]})})},Rce=()=>{const e=Ge(),[t,r]=v.useState("upcoming-assessments"),a=[{id:"upcoming-assessments",title:"List Upcoming Assessment",icon:Ra,description:"View and manage upcoming assessments",color:"primary"},{id:"assessment-results",title:"List Assessment Result",icon:Je,description:"Review completed assessment results",color:"success"},{id:"instructed-courses",title:"List Instructed Course",icon:It,description:"Manage your instructed courses",color:"info"}],n=[{title:"Configure Signature",description:"Set up your digital signature for assessments",icon:Ia,path:he.TRAINER_CONFIGURE_SIGNATURE,color:"warning"},{title:"Section Required Completion",description:"Review sections that require completion",icon:Ht,path:"/trainer/section-completion",color:"danger"},{title:"Assessment Result Details",description:"View detailed assessment results",icon:Ju,path:he.ASSESSMENTS_RESULTS,color:"secondary"},{title:"Result Approval Note",description:"Manage result approval notes",icon:Je,path:"/trainer/approval-notes",color:"success"}],i=()=>{switch(t){case"upcoming-assessments":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Upcoming Assessments"}),s.jsxs(oe,{children:[s.jsx(U,{md:6,className:"mb-3",children:s.jsxs(H,{className:"h-100",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Assessment Schedule"})}),s.jsx(H.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Ra,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No upcoming assessments"}),s.jsx("p",{className:"text-muted small",children:"You don't have any upcoming assessments scheduled."})]})})]})}),s.jsx(U,{md:6,className:"mb-3",children:s.jsxs(H,{className:"h-100",children:[s.jsx(H.Header,{className:"bg-success text-white",children:s.jsx("h6",{className:"mb-0",children:"Quick Actions"})}),s.jsx(H.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",children:[s.jsx(Ra,{size:16,className:"me-2"}),"Schedule Assessment"]}),s.jsxs(se,{variant:"outline-success",size:"sm",children:[s.jsx(Ht,{size:16,className:"me-2"}),"View All Assessments"]})]})})]})})]})]});case"assessment-results":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Assessment Results"}),s.jsxs(oe,{children:[s.jsx(U,{md:6,className:"mb-3",children:s.jsxs(H,{className:"h-100",children:[s.jsx(H.Header,{className:"bg-success text-white",children:s.jsx("h6",{className:"mb-0",children:"Recent Results"})}),s.jsx(H.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Je,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No recent results"}),s.jsx("p",{className:"text-muted small",children:"Assessment results will appear here once completed."})]})})]})}),s.jsx(U,{md:6,className:"mb-3",children:s.jsxs(H,{className:"h-100",children:[s.jsx(H.Header,{className:"bg-info text-white",children:s.jsx("h6",{className:"mb-0",children:"Statistics"})}),s.jsx(H.Body,{children:s.jsx("div",{className:"text-center",children:s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-primary",children:"0"}),s.jsx("small",{className:"text-muted",children:"Completed"})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-warning",children:"0"}),s.jsx("small",{className:"text-muted",children:"Pending"})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-success",children:"0"}),s.jsx("small",{className:"text-muted",children:"Approved"})]})]})})})]})})]})]});case"instructed-courses":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Instructed Courses"}),s.jsxs(oe,{children:[s.jsx(U,{md:6,className:"mb-3",children:s.jsxs(H,{className:"h-100",children:[s.jsx(H.Header,{className:"bg-info text-white",children:s.jsx("h6",{className:"mb-0",children:"My Courses"})}),s.jsx(H.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(It,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No courses assigned"}),s.jsx("p",{className:"text-muted small",children:"You haven't been assigned to instruct any courses yet."})]})})]})}),s.jsx(U,{md:6,className:"mb-3",children:s.jsxs(H,{className:"h-100",children:[s.jsx(H.Header,{className:"bg-warning text-white",children:s.jsx("h6",{className:"mb-0",children:"Course Management"})}),s.jsx(H.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(se,{variant:"outline-primary",size:"sm",children:[s.jsx(It,{size:16,className:"me-2"}),"View All Courses"]}),s.jsxs(se,{variant:"outline-info",size:"sm",children:[s.jsx(Qe,{size:16,className:"me-2"}),"Course Schedule"]})]})})]})})]})]});default:return null}};return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsxs(U,{children:[s.jsx("h2",{className:"mb-2",children:"Trainer Dashboard"}),s.jsx("p",{className:"text-muted",children:"Manage your assessments, courses, and training activities"})]})}),s.jsxs(oe,{children:[s.jsx(U,{lg:3,className:"mb-4",children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsx("h5",{className:"mb-0",children:"Navigation"})}),s.jsx(H.Body,{className:"p-0",children:s.jsx("div",{className:"list-group list-group-flush",children:a.map(l=>{const o=l.icon;return s.jsx("button",{className:`list-group-item list-group-item-action border-0 ${t===l.id?"active":""}`,onClick:()=>r(l.id),style:{backgroundColor:t===l.id?"#0d6efd":"transparent",color:t===l.id?"white":"inherit",border:"none",borderRadius:0},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(o,{size:20,className:"me-3",style:{color:t===l.id?"white":`var(--bs-${l.color})`}}),s.jsxs("div",{className:"flex-grow-1 text-start",children:[s.jsx("h6",{className:"mb-1",children:l.title}),s.jsx("small",{className:"text-muted",children:l.description})]}),s.jsx(un,{size:16})]})},l.id)})})})]})}),s.jsx(U,{lg:9,children:s.jsx(H,{className:"border-0 shadow-sm",children:s.jsx(H.Body,{className:"p-4",children:i()})})})]}),s.jsx(oe,{className:"mt-4",children:s.jsx(U,{children:s.jsx("h4",{className:"mb-3",children:"Quick Actions"})})}),s.jsx(oe,{children:n.map((l,o)=>{const c=l.icon;return s.jsx(U,{lg:6,xl:3,className:"mb-4",children:s.jsx(H,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(l.path),onMouseEnter:u=>{u.currentTarget.style.transform="translateY(-5px)",u.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:u=>{u.currentTarget.style.transform="translateY(0)",u.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(H.Body,{className:"p-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:`bg-${l.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:s.jsx(c,{size:24})}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("h5",{className:"mb-1",children:l.title})}),s.jsx(un,{size:20,className:"text-muted"})]}),s.jsx("p",{className:"text-muted mb-0",children:l.description})]})})},o)})})]})},ji=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:a,className:n=""})=>{const i=t.length>0;return s.jsxs(kt,{className:`filter-panel-dropdown ${n}`,children:[s.jsx(kt.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ol,{size:14,className:"me-2"}),"Filters",i&&s.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),s.jsxs(kt.Menu,{className:"course-filter-menu",style:{width:"100%",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"-1px",top:"100%",left:0,transform:"none",position:"absolute",borderTopLeftRadius:0,borderTopRightRadius:0},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&s.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:s.jsx(Xe,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(l=>s.jsx(I.Check,{type:"checkbox",id:`status-${l}`,label:l,checked:t.includes(l),onChange:()=>r(l),className:"mb-1"},l))})]}),i&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:a,children:[s.jsx(Xe,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},Lce=()=>{const e=Ge(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(null),[o,c]=v.useState(""),[u,d]=v.useState([]),[m,f]=v.useState("course");v.useEffect(()=>{(async()=>{try{n(!0),l(null);const T=await Za.getUserEvents();if(T?.success&&T?.data?.events){const C=new Set(["NOT_STARTED","ON_GOING"]),A=T.data.events.filter(D=>C.has(D.status)).map(D=>{const P=new Date(D.occuranceDate),R=P.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),M=P.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),X=D.entityInfo?.type||(D.subjectId?"subject":"course");return{id:D.id||`${D.courseId}-${D.subjectId}-${D.occuranceDate}`,title:D.name,entityInfo:D.entityInfo,entityType:X,entityId:X==="course"?D.entityInfo?.id||D.courseId:D.entityInfo?.id||D.subjectId,entityName:D.entityInfo?.name||"N/A",entityCode:D.entityInfo?.code||"",courseName:X==="course"?D.entityInfo?.name:null,courseCode:X==="course"?D.entityInfo?.code:null,subjectName:X==="subject"?D.entityInfo?.name:null,subjectCode:X==="subject"?D.entityInfo?.code:null,traineeCount:D.totalTrainees||0,scheduledDate:R,scheduledTime:M,occurrenceDate:D.occuranceDate,status:D.status||"NOT_STARTED",templateInfo:D.templateInfo}});r(A)}else r([])}catch(T){console.error("Error fetching assessments:",T),l("Failed to load upcoming assessments"),te.error("Failed to load upcoming assessments")}finally{n(!1)}})()},[]);const x={NOT_STARTED:{variant:"secondary",text:"Not Started"},ON_GOING:{variant:"info",text:"On Going"},APPROVED:{variant:"success",text:"Approved"},COMPLETED:{variant:"success",text:"Completed"},PENDING:{variant:"warning",text:"Pending"}},p=_=>{const T=x[_]||{variant:"secondary",text:_||"Unknown"};return s.jsx(Ne,{bg:T.variant,children:T.text})},h=_=>{const T=m,C=_.entityId;if(!C){te.error(`Missing ${T} identifier`);return}e(he.ASSESSMENTS_ASSIGN(T,C),{state:{name:_.entityName,code:_.entityCode,template:_.templateInfo?.name}})},g=[...new Set(t.map(_=>_.status))],b=t.filter(_=>{const T=u.length===0||u.includes(_.status),C=_.entityType===m,A=_.title.toLowerCase().includes(o.toLowerCase())||_.entityName.toLowerCase().includes(o.toLowerCase())||_.entityCode&&_.entityCode.toLowerCase().includes(o.toLowerCase());return T&&C&&A}),j=_=>{d(_==="clear"?[]:T=>T.includes(_)?T.filter(C=>C!==_):[...T,_])},y=()=>{d([]),c("")},{sortedData:w,sortConfig:N,handleSort:S}=ur(b);if(a)return s.jsx(zt,{rows:5,columns:6});if(i)return s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(Button,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});const E=({columnKey:_,children:T,className:C=""})=>{const A=N.key===_,D=A?N.direction:null;return s.jsxs("th",{className:`fw-semibold ${C}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(_),onMouseEnter:P=>{P.target.style.backgroundColor="#214760",P.target.style.transform="translateY(-1px)",P.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:P=>{P.target.style.backgroundColor="var(--bs-primary)",P.target.style.transform="translateY(0)",P.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:A?"600":"500",color:"white"},children:T}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:D,size:14,color:"white"})})]}),A&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:5,md:4,className:"mb-2 mb-lg-0 ps-2 ps-lg-3",children:s.jsx(rs,{placeholder:"Search assessments, courses, or trainees...",value:o,onChange:c,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:s.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[s.jsx("label",{className:"text-muted small mb-0 me-2",children:"View:"}),s.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[s.jsx("input",{type:"radio",className:"btn-check",name:"entityFilter",id:"filter-course",checked:m==="course",onChange:()=>f("course")}),s.jsxs("label",{className:`btn btn-sm ${m==="course"?"btn-primary-custom text-white":"btn-outline-primary"}`,htmlFor:"filter-course",style:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.35rem 0.9rem"},children:[s.jsx(It,{size:14}),"Course"]}),s.jsx("input",{type:"radio",className:"btn-check",name:"entityFilter",id:"filter-subject",checked:m==="subject",onChange:()=>f("subject")}),s.jsxs("label",{className:`btn btn-sm ${m==="subject"?"btn-secondary-custom text-white":"btn-outline-secondary"}`,htmlFor:"filter-subject",style:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.35rem 0.9rem"},children:[s.jsx(zd,{size:14}),"Subject"]})]})]})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(ji,{uniqueStatuses:g,selectedStatuses:u,onStatusToggle:j,onClearFilters:y,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(E,{columnKey:"title",className:"show-mobile",children:"Assessment"}),s.jsx(E,{columnKey:m==="course"?"courseName":"subjectName",className:"show-mobile",children:m==="course"?"Course":"Subject"}),s.jsx(E,{columnKey:"traineeCount",className:"show-mobile",children:"Trainees"}),s.jsx(E,{columnKey:"scheduledDate",className:"show-mobile",children:"Date & Time"}),s.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:w.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"text-center py-4 text-muted",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:"No upcoming assessments found"}),s.jsx("small",{children:"Try adjusting your search criteria or schedule a new assessment."})]})})}):w.map(_=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:_.title}),_.templateInfo&&s.jsxs("small",{className:"text-muted",children:[s.jsx(zd,{size:12,className:"me-1"}),_.templateInfo.name]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:m==="course"?_.courseName?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("span",{className:"fw-medium",children:_.courseName}),_.courseCode&&s.jsx("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:_.courseCode})]})]}):s.jsx("span",{className:"text-muted",children:"-"}):_.subjectName?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(zd,{size:16,className:"me-2 text-success"}),s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("span",{className:"fw-medium",children:_.subjectName}),_.subjectCode&&s.jsx("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:_.subjectCode})]})]}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted"}),s.jsxs("span",{children:[_.traineeCount," ",_.traineeCount===1?"trainee":"trainees"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:_.scheduledDate}),s.jsx("small",{className:"text-muted",children:_.scheduledTime})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:p(_.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"Assess",icon:s.jsx(St,{}),onClick:()=>h(_)}]})})]},_.id))})]})})]})},Fce=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(null),[l,o]=v.useState("all"),[c,u]=v.useState(""),[d,m]=v.useState([]),{sortedData:f,sortConfig:x,handleSort:p}=ur(e);v.useEffect(()=>{(async()=>{try{a(!0),await new Promise(T=>setTimeout(T,1e3)),t([{id:1,title:"Safety Procedures - Module 1",course:"Aviation Safety Management",trainee:"John Doe",dueDate:"2024-01-20",status:"pending",priority:"high",progress:65,instructor:"Dr. Smith",lastActivity:"2024-01-15",estimatedTime:"2 hours"},{id:2,title:"Engine Maintenance - Part A",course:"Aircraft Maintenance",trainee:"Jane Smith",dueDate:"2024-01-18",status:"in_progress",priority:"medium",progress:30,instructor:"Jane Doe",lastActivity:"2024-01-16",estimatedTime:"3 hours"},{id:3,title:"Navigation Systems - Theory",course:"Flight Operations",trainee:"Mike Johnson",dueDate:"2024-01-22",status:"completed",priority:"low",progress:100,instructor:"Mike Johnson",lastActivity:"2024-01-17",estimatedTime:"1.5 hours"},{id:4,title:"Regulatory Compliance - Section 2",course:"Aviation Regulations",trainee:"Sarah Wilson",dueDate:"2024-01-19",status:"overdue",priority:"high",progress:45,instructor:"Sarah Wilson",lastActivity:"2024-01-14",estimatedTime:"2.5 hours"},{id:5,title:"Emergency Response - Practical",course:"Crisis Management",trainee:"David Brown",dueDate:"2024-01-25",status:"pending",priority:"medium",progress:0,instructor:"David Brown",lastActivity:"2024-01-12",estimatedTime:"4 hours"}])}catch(_){i("Failed to fetch section completion data"),console.error("Error fetching sections:",_)}finally{a(!1)}})()},[]);const h=E=>{const T={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},overdue:{variant:"danger",text:"Overdue"}}[E]||{variant:"secondary",text:"Unknown"};return s.jsx(Ne,{bg:T.variant,children:T.text})},g=E=>{const T={high:{variant:"danger",text:"High"},medium:{variant:"warning",text:"Medium"},low:{variant:"success",text:"Low"}}[E]||{variant:"secondary",text:"Unknown"};return s.jsx(Ne,{bg:T.variant,className:"me-1",children:T.text})},b=[...new Set(e.map(E=>E.status))],j=f.filter(E=>{const _=d.length===0||d.includes(E.status),T=c===""||E.title.toLowerCase().includes(c.toLowerCase())||E.course.toLowerCase().includes(c.toLowerCase())||E.trainee.toLowerCase().includes(c.toLowerCase());return _&&T}),y=E=>{m(E==="clear"?[]:_=>_.includes(E)?_.filter(T=>T!==E):[..._,E])},w=()=>{m([]),u("")},N=E=>{console.log("View details for section:",E)},S=E=>{console.log("Mark complete for section:",E)};return r?s.jsx(zt,{}):n?s.jsxs(ke,{variant:"danger",className:"m-4",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:n})]}):s.jsxs("div",{className:"p-4",children:[s.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search sections, trainees, or courses...",value:c,onChange:u,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(ji,{uniqueStatuses:b,selectedStatuses:d,onStatusToggle:y,onClearFilters:w,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsxs("th",{onClick:()=>p("title"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Section ",s.jsx(pr,{sortConfig:x,columnKey:"title"})]}),s.jsxs("th",{onClick:()=>p("course"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Course ",s.jsx(pr,{sortConfig:x,columnKey:"course"})]}),s.jsxs("th",{onClick:()=>p("trainee"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Trainee ",s.jsx(pr,{sortConfig:x,columnKey:"trainee"})]}),s.jsxs("th",{onClick:()=>p("dueDate"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Due Date ",s.jsx(pr,{sortConfig:x,columnKey:"dueDate"})]}),s.jsxs("th",{onClick:()=>p("status"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Status ",s.jsx(pr,{sortConfig:x,columnKey:"status"})]}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"Actions"})]})}),s.jsx("tbody",{children:j.map(E=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold",children:E.title}),s.jsxs("small",{className:"text-muted",children:[s.jsx(Qe,{size:12,className:"me-1"}),"Est. ",E.estimatedTime]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold",children:E.course}),s.jsxs("small",{className:"text-muted",children:[s.jsx(Ft,{size:12,className:"me-1"}),E.instructor]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold",children:E.trainee}),s.jsxs("small",{className:"text-muted",children:["Last activity: ",E.lastActivity]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold",children:E.dueDate}),s.jsx("small",{className:"text-muted",children:g(E.priority)})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[h(E.status),s.jsx("div",{className:"mt-1",children:s.jsxs("small",{className:"text-muted",children:["Progress: ",E.progress,"%"]})})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>N(E.id)},{label:"Mark Complete",icon:s.jsx(Je,{}),onClick:()=>S(E.id)}]})})]},E.id))})]})})]})},Mce=()=>{const[e,t]=v.useState("upcoming-assessments"),r=[{id:"upcoming-assessments",title:"Upcoming Assessments",icon:Ra,component:s.jsx(Lce,{})},{id:"section-completion",title:"Section Required Completion",icon:Ht,component:s.jsx(Fce,{})}],a=r.find(n=>n.id===e);return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs(H,{className:"border-0",children:[s.jsx(H.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:r.map(n=>{const i=n.icon,l=e===n.id;return s.jsxs("button",{className:`custom-tab ${l?"active":""}`,onClick:()=>t(n.id),children:[s.jsx(i,{size:16,className:"me-2"}),n.title]},n.id)})})}),s.jsx(H.Body,{className:"p-0",children:a&&a.component})]})})})})},Bce=()=>{const e=Ge(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(null),[o,c]=v.useState("all"),[u,d]=v.useState(""),[m,f]=v.useState([]),{sortedData:x,sortConfig:p,handleSort:h}=ur(t);v.useEffect(()=>{(async()=>{try{n(!0),await new Promise(D=>setTimeout(D,1e3)),r([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",completedDate:"2024-01-10",score:85,maxScore:100,status:"completed",grade:"B+",duration:"115 minutes",attempts:1},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",completedDate:"2024-01-09",score:92,maxScore:100,status:"completed",grade:"A-",duration:"88 minutes",attempts:1},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",completedDate:"2024-01-08",score:78,maxScore:100,status:"completed",grade:"C+",duration:"142 minutes",attempts:2},{id:4,title:"Regulatory Assessment - Part 121",course:"Aviation Regulations",trainee:"Sarah Wilson",completedDate:"2024-01-07",score:95,maxScore:100,status:"completed",grade:"A",duration:"95 minutes",attempts:1},{id:5,title:"Emergency Procedures Assessment",course:"Crisis Management",trainee:"David Brown",completedDate:"2024-01-06",score:65,maxScore:100,status:"failed",grade:"D",duration:"120 minutes",attempts:1}])}catch{l("Failed to load assessment results")}finally{n(!1)}})()},[]);const g=C=>{const D={completed:{variant:"success",text:"Completed",icon:Je},failed:{variant:"danger",text:"Failed",icon:fs},inProgress:{variant:"warning",text:"In Progress",icon:Qe},pending:{variant:"info",text:"Pending Review",icon:Qe}}[C]||{variant:"secondary",text:C,icon:Qe},P=D.icon;return s.jsxs(Ne,{bg:D.variant,className:"d-flex align-items-center",children:[s.jsx(P,{size:12,className:"me-1"}),D.text]})},b=C=>C.startsWith("A")?"success":C.startsWith("B")?"primary":C.startsWith("C")?"warning":C.startsWith("D")?"danger":"secondary",j=(C,A)=>{const D=C/A*100;return D>=90?"success":D>=80?"primary":D>=70?"warning":"danger"},y=[...new Set(t.map(C=>C.status))],w=t.filter(C=>{const A=m.length===0||m.includes(C.status),D=C.title.toLowerCase().includes(u.toLowerCase())||C.trainee.toLowerCase().includes(u.toLowerCase())||C.course.toLowerCase().includes(u.toLowerCase());return A&&D}),N=C=>{f(C==="clear"?[]:A=>A.includes(C)?A.filter(D=>D!==C):[...A,C])},S=()=>{f([]),d("")},E=C=>{e(`/trainer/assessment-details/${C}`)},_=C=>{console.log("Downloading result:",C)};if(a)return s.jsx(zt,{rows:5,columns:7});if(i)return s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No assessment results found"}),s.jsx("p",{children:"Try adjusting your search criteria or check back later."})]})});const T=({columnKey:C,children:A,className:D=""})=>{const P=p.key===C,R=P?p.direction:null;return s.jsxs("th",{className:`fw-semibold ${D}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>h(C),onMouseEnter:M=>{M.target.style.backgroundColor="#214760",M.target.style.transform="translateY(-1px)",M.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:M=>{M.target.style.backgroundColor="var(--bs-primary)",M.target.style.transform="translateY(0)",M.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:P?"600":"500",color:"white"},children:A}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:R,size:14,color:"white"})})]}),P&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search assessments, trainees, or courses...",value:u,onChange:d,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(ji,{uniqueStatuses:y,selectedStatuses:m,onStatusToggle:N,onClearFilters:S,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," result",w.length!==1?"s":""]})})})]}),w.length===0?s.jsx(H,{className:"text-center py-5",children:s.jsxs(H.Body,{children:[s.jsx(Je,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No Results Found"}),s.jsx("p",{className:"text-muted",children:u||o!=="all"?"No assessment results match your current filters.":"No assessment results available yet."}),(u||o!=="all")&&s.jsx(se,{variant:"outline-primary",onClick:()=>{d(""),c("all")},children:"Clear Filters"})]})}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(T,{columnKey:"title",className:"show-mobile",children:"Assessment"}),s.jsx(T,{columnKey:"course",className:"show-mobile",children:"Course"}),s.jsx(T,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),s.jsx(T,{columnKey:"score",className:"show-mobile",children:"Score"}),s.jsx(T,{columnKey:"grade",className:"hide-mobile",children:"Grade"}),s.jsx(T,{columnKey:"completedDate",className:"show-mobile",children:"Completed"}),s.jsx(T,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:x.map(C=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:C.title}),s.jsxs("small",{className:"text-muted",children:["Attempt ",C.attempts,"  ",C.duration]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:C.course})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:C.trainee})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`fw-bold text-${j(C.score,C.maxScore)}`,children:[C.score,"/",C.maxScore]}),s.jsxs("small",{className:"text-muted ms-2",children:["(",Math.round(C.score/C.maxScore*100),"%)"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx(Ne,{bg:b(C.grade),className:"fs-6",children:C.grade})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{children:s.jsx("div",{className:"fw-medium",children:C.completedDate})})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:g(C.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>E(C.id)},{label:"Download Report",icon:s.jsx(Ln,{}),onClick:()=>_(C.id)}]})})]},C.id))})]})})]})},zce=()=>s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(Bce,{})}),Uce=()=>{const e=Ge(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(null),[o,c]=v.useState("all"),[u,d]=v.useState(""),[m,f]=v.useState([]),{sortedData:x,sortConfig:p,handleSort:h}=ur(t);v.useEffect(()=>{(async()=>{try{n(!0),await new Promise(A=>setTimeout(A,1e3)),r([{id:1,title:"Aviation Safety Management",code:"ASM-101",department:"Safety & Security",status:"active",startDate:"2024-01-15",endDate:"2024-03-15",enrolledTrainees:25,maxTrainees:30,totalSubjects:8,completedSubjects:3,instructor:"Dr. John Smith",location:"Training Center A",schedule:"Mon, Wed, Fri 9:00-12:00"},{id:2,title:"Aircraft Maintenance Fundamentals",code:"AMF-201",department:"Maintenance",status:"active",startDate:"2024-01-20",endDate:"2024-04-20",enrolledTrainees:18,maxTrainees:20,totalSubjects:12,completedSubjects:5,instructor:"Jane Doe",location:"Lab B",schedule:"Tue, Thu 14:00-17:00"},{id:3,title:"Flight Operations Management",code:"FOM-301",department:"Operations",status:"scheduled",startDate:"2024-02-01",endDate:"2024-05-01",enrolledTrainees:0,maxTrainees:15,totalSubjects:10,completedSubjects:0,instructor:"Mike Johnson",location:"Simulator Room",schedule:"Mon-Fri 8:00-16:00"},{id:4,title:"Aviation Regulations & Compliance",code:"ARC-401",department:"Compliance",status:"completed",startDate:"2023-10-01",endDate:"2023-12-15",enrolledTrainees:22,maxTrainees:25,totalSubjects:6,completedSubjects:6,instructor:"Sarah Wilson",location:"Conference Room C",schedule:"Sat 9:00-17:00"},{id:5,title:"Emergency Response Procedures",code:"ERP-501",department:"Safety & Security",status:"paused",startDate:"2024-01-10",endDate:"2024-02-28",enrolledTrainees:12,maxTrainees:20,totalSubjects:4,completedSubjects:1,instructor:"David Brown",location:"Training Center B",schedule:"Wed, Fri 10:00-14:00"}])}catch{l("Failed to load instructed courses")}finally{n(!1)}})()},[]);const g=T=>{const A={active:{variant:"success",text:"Active"},scheduled:{variant:"primary",text:"Scheduled"},completed:{variant:"secondary",text:"Completed"},paused:{variant:"warning",text:"Paused"},cancelled:{variant:"danger",text:"Cancelled"}}[T]||{variant:"secondary",text:T};return s.jsx(Ne,{bg:A.variant,children:A.text})},b=(T,C)=>C>0?Math.round(T/C*100):0,j=(T,C)=>C>0?Math.round(T/C*100):0,y=[...new Set(t.map(T=>T.status))],w=t.filter(T=>{const C=m.length===0||m.includes(T.status),A=T.title.toLowerCase().includes(u.toLowerCase())||T.code.toLowerCase().includes(u.toLowerCase())||T.department.toLowerCase().includes(u.toLowerCase());return C&&A}),N=T=>{f(T==="clear"?[]:C=>C.includes(T)?C.filter(A=>A!==T):[...C,T])},S=()=>{f([]),d("")},E=T=>{e(he.COURSES_DETAIL(T))};if(a)return s.jsx(zt,{rows:5,columns:7});if(i)return s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No instructed courses found"}),s.jsx("p",{children:"Try adjusting your search criteria or create a new course."})]})});const _=({columnKey:T,children:C,className:A=""})=>{const D=p.key===T,P=D?p.direction:null;return s.jsxs("th",{className:`fw-semibold ${A}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>h(T),onMouseEnter:R=>{R.target.style.backgroundColor="#214760",R.target.style.transform="translateY(-1px)",R.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:R=>{R.target.style.backgroundColor="var(--bs-primary)",R.target.style.transform="translateY(0)",R.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:D?"600":"500",color:"white"},children:C}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:P,size:14,color:"white"})})]}),D&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search courses, codes, or departments...",value:u,onChange:d,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(ji,{uniqueStatuses:y,selectedStatuses:m,onStatusToggle:N,onClearFilters:S,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),w.length===0?s.jsx(H,{className:"text-center py-5",children:s.jsxs(H.Body,{children:[s.jsx(It,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No Courses Found"}),s.jsx("p",{className:"text-muted",children:u||o!=="all"?"No courses match your current filters.":"You haven't been assigned to instruct any courses yet."}),u||m.length>0?s.jsx(se,{variant:"outline-primary",onClick:S,children:"Clear Filters"}):null]})}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(_,{columnKey:"title",className:"show-mobile",children:"Course"}),s.jsx(_,{columnKey:"department",className:"show-mobile",children:"Department"}),s.jsx(_,{columnKey:"schedule",className:"hide-mobile",children:"Schedule"}),s.jsx(_,{columnKey:"enrollment",className:"show-mobile",children:"Enrollment"}),s.jsx(_,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),s.jsx(_,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:x.map(T=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:T.title}),s.jsxs("small",{className:"text-muted",children:[T.code,"  ",T.location]}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:[s.jsx(xr,{size:12,className:"me-1"}),T.startDate," - ",T.endDate]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("span",{className:"text-muted",children:T.department})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:T.schedule}),s.jsx("small",{className:"text-muted",children:T.instructor})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($r,{size:16,className:"me-2 text-muted"}),s.jsxs("span",{className:"fw-medium",children:[T.enrolledTrainees,"/",T.maxTrainees]})]}),s.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:s.jsx("div",{className:"progress-bar bg-info",style:{width:`${j(T.enrolledTrainees,T.maxTrainees)}%`}})}),s.jsxs("small",{className:"text-muted",children:[j(T.enrolledTrainees,T.maxTrainees),"% full"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{size:16,className:"me-2 text-muted"}),s.jsxs("span",{className:"fw-medium",children:[T.completedSubjects,"/",T.totalSubjects]})]}),s.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:s.jsx("div",{className:"progress-bar bg-success",style:{width:`${b(T.completedSubjects,T.totalSubjects)}%`}})}),s.jsxs("small",{className:"text-muted",children:[b(T.completedSubjects,T.totalSubjects),"% complete"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:g(T.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Course Detail",icon:s.jsx(St,{}),onClick:()=>E(T.id)}]})})]},T.id))})]})})]})},$ce=()=>s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(Uce,{})}),Wce=({courseId:e})=>{const t=Ge(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState(""),[d,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(_=>setTimeout(_,1e3)),a([{id:1,title:"Safety Procedures - Module 1",code:"SP-101",duration:"2 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-20",progress:100,description:"Introduction to aviation safety procedures and protocols"},{id:2,title:"Risk Assessment Fundamentals",code:"RAF-102",duration:"3 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-25",progress:100,description:"Understanding risk assessment methodologies in aviation"},{id:3,title:"Emergency Response Protocols",code:"ERP-103",duration:"2.5 hours",status:"in_progress",instructor:"Dr. Smith",completionDate:null,progress:65,description:"Emergency response procedures and communication protocols"},{id:4,title:"Regulatory Compliance",code:"RC-104",duration:"4 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Understanding aviation regulations and compliance requirements"},{id:5,title:"Safety Management Systems",code:"SMS-105",duration:"3.5 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Implementation and management of safety management systems"}])}catch(E){o("Failed to load subjects"),console.error("Error fetching subjects:",E)}finally{i(!1)}})()},[e]);const f=S=>{const _={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[S]||{variant:"secondary",text:"Unknown"};return s.jsx(Ne,{bg:_.variant,children:_.text})},x=S=>{t(he.SUBJECTS_DETAIL(S))},p=[...new Set(r.map(S=>S.status))],h=r.filter(S=>{const E=d.length===0||d.includes(S.status),_=S.title.toLowerCase().includes(c.toLowerCase())||S.code.toLowerCase().includes(c.toLowerCase())||S.description.toLowerCase().includes(c.toLowerCase());return E&&_}),g=S=>{m(S==="clear"?[]:E=>E.includes(S)?E.filter(_=>_!==S):[...E,S])},b=()=>{m([]),u("")},{sortedData:j,sortConfig:y,handleSort:w}=ur(h);if(n)return s.jsx(zt,{rows:5,columns:6});if(l)return s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:l}),s.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(h.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})});const N=({columnKey:S,children:E,className:_=""})=>{const T=y.key===S,C=T?y.direction:null;return s.jsxs("th",{className:`fw-semibold ${_}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>w(S),onMouseEnter:A=>{A.target.style.backgroundColor="#214760",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="var(--bs-primary)",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:T?"600":"500",color:"white"},children:E}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:C,size:14,color:"white"})})]}),T&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search subjects...",value:c,onChange:u,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(ji,{uniqueStatuses:p,selectedStatuses:d,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(N,{columnKey:"title",className:"show-mobile",children:"Subject"}),s.jsx(N,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(N,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),s.jsx(N,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(N,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:j.map(S=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:S.title}),s.jsx("small",{className:"text-muted",children:S.description})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:S.code})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:S.duration})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:f(S.status)}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${S.progress}%`},"aria-valuenow":S.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),s.jsxs("small",{className:"text-muted",children:[S.progress,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>x(S.id)}]})})]},S.id))})]})})]})},Hce=({courseId:e})=>{const t=Ge(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState(""),[d,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(_=>setTimeout(_,1e3)),a([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"active",progress:75,lastActivity:"2024-01-20",completedSubjects:6,totalSubjects:8},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"active",progress:60,lastActivity:"2024-01-19",completedSubjects:5,totalSubjects:8},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"completed",progress:100,lastActivity:"2024-01-25",completedSubjects:8,totalSubjects:8},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"inactive",progress:25,lastActivity:"2024-01-22",completedSubjects:2,totalSubjects:8},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"active",progress:40,lastActivity:"2024-01-23",completedSubjects:3,totalSubjects:8}])}catch(E){o("Failed to load trainees"),console.error("Error fetching trainees:",E)}finally{i(!1)}})()},[e]);const f=S=>{const _={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[S]||{variant:"secondary",text:"Unknown"};return s.jsx(Ne,{bg:_.variant,children:_.text})},x=S=>{t(he.USERS_DETAIL(S))},p=[...new Set(r.map(S=>S.status))],h=r.filter(S=>{const E=d.length===0||d.includes(S.status),_=S.name.toLowerCase().includes(c.toLowerCase())||S.email.toLowerCase().includes(c.toLowerCase())||S.employeeId.toLowerCase().includes(c.toLowerCase())||S.department.toLowerCase().includes(c.toLowerCase());return E&&_}),g=S=>{m(S==="clear"?[]:E=>E.includes(S)?E.filter(_=>_!==S):[...E,S])},b=()=>{m([]),u("")},{sortedData:j,sortConfig:y,handleSort:w}=ur(h);if(n)return s.jsx(zt,{rows:5,columns:7});if(l)return s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:l}),s.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(h.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})});const N=({columnKey:S,children:E,className:_=""})=>{const T=y.key===S,C=T?y.direction:null;return s.jsxs("th",{className:`fw-semibold ${_}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>w(S),onMouseEnter:A=>{A.target.style.backgroundColor="#214760",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="var(--bs-primary)",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:T?"600":"500",color:"white"},children:E}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:C,size:14,color:"white"})})]}),T&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search trainees...",value:c,onChange:u,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(ji,{uniqueStatuses:p,selectedStatuses:d,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(N,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(N,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),s.jsx(N,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(N,{columnKey:"enrollmentDate",className:"show-mobile",children:"Enrollment Date"}),s.jsx(N,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(N,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:j.map(S=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:S.name}),s.jsx("small",{className:"text-muted",children:S.email})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:S.employeeId})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-muted",children:S.department})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:S.enrollmentDate}),s.jsxs("small",{className:"text-muted",children:["Last activity: ",S.lastActivity]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:f(S.status)}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${S.progress}%`},"aria-valuenow":S.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),s.jsxs("small",{className:"text-muted",children:[S.progress,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Profile",icon:s.jsx(St,{}),onClick:()=>x(S.id)}]})})]},S.id))})]})})]})},_2=()=>{const{courseId:e}=gr(),t=Ge(),[r,a]=v.useState("subjects"),[n,i]=v.useState(null),[l,o]=v.useState(!0),[c,u]=v.useState(null);v.useEffect(()=>{(async()=>{try{o(!0),await new Promise(p=>setTimeout(p,1e3)),i({id:e,title:"Aviation Safety Management",code:"ASM-101",department:"Aviation Department",instructor:"Dr. Smith",startDate:"2024-01-15",endDate:"2024-03-15",status:"active",location:"Training Room A",schedule:"Mon, Wed, Fri 09:00-12:00",description:"Comprehensive course covering aviation safety management systems, risk assessment, and regulatory compliance.",maxEnrollment:30,currentEnrollment:25,completedSubjects:8,totalSubjects:12})}catch(x){u("Failed to load course details"),console.error("Error fetching course:",x)}finally{o(!1)}})()},[e]);const d=[{id:"subjects",title:"Subject List",icon:It,component:s.jsx(Wce,{courseId:e})},{id:"trainees",title:"Trainee List",icon:$r,component:s.jsx(Hce,{courseId:e})}],m=d.find(f=>f.id===r);return l?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):c?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:c})]})}):n?s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(he.COURSES_INSTRUCTED),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:n.title}),s.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.department]})]})]})})}),s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs(H,{className:"border-0",children:[s.jsx(H.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:d.map(f=>{const x=f.icon,p=r===f.id;return s.jsxs("button",{className:`custom-tab ${p?"active":""}`,onClick:()=>a(f.id),children:[s.jsx(x,{size:16,className:"me-2"}),f.title]},f.id)})})}),s.jsx(H.Body,{className:"p-0",children:m&&m.component})]})})})]}):s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"warning",children:[s.jsx(ke.Heading,{children:"Course Not Found"}),s.jsx("p",{children:"The requested course could not be found."})]})})},Vce=()=>{const{traineeId:e}=gr(),t=Ge(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(m=>setTimeout(m,1e3)),a({id:e,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",position:"Operations Manager",phone:"+1-555-0123",enrollmentDate:"2024-01-15",status:"active",lastActivity:"2024-01-20",completedCourses:3,totalCourses:5,completedSubjects:12,totalSubjects:20,averageScore:85,certifications:[{name:"Aviation Safety Management",date:"2024-01-20",status:"completed"},{name:"Risk Assessment",date:"2024-01-25",status:"completed"},{name:"Emergency Response",date:"2024-02-01",status:"in_progress"}],currentCourses:[{id:1,name:"Aviation Safety Management",progress:75,instructor:"Dr. Smith"},{id:2,name:"Aircraft Maintenance",progress:45,instructor:"Jane Doe"}]})}catch(d){o("Failed to load trainee details"),console.error("Error fetching trainee:",d)}finally{i(!1)}})()},[e]);const c=u=>{const m={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[u]||{variant:"secondary",text:"Unknown"};return s.jsx(Ne,{bg:m.variant,children:m.text})};return n?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):l?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:l})]})}):r?s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:r.name}),s.jsxs("p",{className:"text-muted mb-0",children:[r.employeeId,"  ",r.department]})]})]})})}),s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(Ft,{size:24,className:"text-primary mb-2"}),s.jsx("h6",{className:"mb-1",children:"Status"}),c(r.status)]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(It,{size:24,className:"text-success mb-2"}),s.jsx("h6",{className:"mb-1",children:"Courses"}),s.jsxs("h4",{className:"mb-0 text-success",children:[r.completedCourses,"/",r.totalCourses]}),s.jsx("small",{className:"text-muted",children:"Completed"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"text-info mb-2",children:s.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),s.jsx("h6",{className:"mb-1",children:"Average Score"}),s.jsxs("h4",{className:"mb-0 text-info",children:[r.averageScore,"%"]}),s.jsx("small",{className:"text-muted",children:"Performance"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(xr,{size:24,className:"text-warning mb-2"}),s.jsx("h6",{className:"mb-1",children:"Enrolled"}),s.jsx("h4",{className:"mb-0 text-warning",children:r.enrollmentDate}),s.jsx("small",{className:"text-muted",children:"Start Date"})]})})})]}),s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{md:6,children:s.jsxs(H,{children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Contact Information"})}),s.jsxs(H.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx(Gi,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Email:"})," ",r.email]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Position:"})," ",r.position]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(xr,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Last Activity:"})," ",r.lastActivity]})]})]})}),s.jsx(U,{md:6,children:s.jsxs(H,{children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Current Courses"})}),s.jsx(H.Body,{children:r.currentCourses.map(u=>s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[s.jsx("h6",{className:"mb-0",children:u.name}),s.jsxs("small",{className:"text-muted",children:[u.progress,"%"]})]}),s.jsx("div",{className:"progress mb-1",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${u.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:["Instructor: ",u.instructor]})]},u.id))})]})})]}),s.jsx(oe,{children:s.jsx(U,{children:s.jsxs(H,{children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Certifications"})}),s.jsx(H.Body,{children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Certification"}),s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Status"})]})}),s.jsx("tbody",{children:r.certifications.map((u,d)=>s.jsxs("tr",{children:[s.jsx("td",{children:u.name}),s.jsx("td",{children:u.date}),s.jsx("td",{children:c(u.status)})]},d))})]})})})]})})})]}):s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"warning",children:[s.jsx(ke.Heading,{children:"Trainee Not Found"}),s.jsx("p",{children:"The requested trainee could not be found."})]})})},Gce=({subjectId:e})=>{const t=Ge(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState(""),[d,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(T=>setTimeout(T,1e3)),a([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(_){o("Failed to load trainees in subject"),console.error("Error fetching trainees:",_)}finally{i(!1)}})()},[e]);const f=E=>{const T={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[E]||{variant:"secondary",text:"Unknown"};return s.jsx(Ne,{bg:T.variant,children:T.text})},x=E=>{t(he.USERS_DETAIL(E))},p=E=>{console.log("Send message to trainee:",E)},h=[...new Set(r.map(E=>E.status))],g=r.filter(E=>{const _=d.length===0||d.includes(E.status),T=E.name.toLowerCase().includes(c.toLowerCase())||E.email.toLowerCase().includes(c.toLowerCase())||E.employeeId.toLowerCase().includes(c.toLowerCase())||E.department.toLowerCase().includes(c.toLowerCase());return _&&T}),b=E=>{m(E==="clear"?[]:_=>_.includes(E)?_.filter(T=>T!==E):[..._,E])},j=()=>{m([]),u("")},{sortedData:y,sortConfig:w,handleSort:N}=ur(g);if(n)return s.jsx(zt,{rows:5,columns:7});if(l)return s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:l}),s.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(g.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})});const S=({columnKey:E,children:_,className:T=""})=>{const C=w.key===E,A=C?w.direction:null;return s.jsxs("th",{className:`fw-semibold ${T}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>N(E),onMouseEnter:D=>{D.target.style.backgroundColor="#214760",D.target.style.transform="translateY(-1px)",D.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:D=>{D.target.style.backgroundColor="var(--bs-primary)",D.target.style.transform="translateY(0)",D.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:C?"600":"500",color:"white"},children:_}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(pr,{direction:A,size:14,color:"white"})})]}),C&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search trainees in this subject...",value:c,onChange:u,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(ji,{uniqueStatuses:h,selectedStatuses:d,onStatusToggle:b,onClearFilters:j,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(S,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(S,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),s.jsx(S,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(S,{columnKey:"progress",className:"show-mobile",children:"Progress"}),s.jsx(S,{columnKey:"score",className:"hide-mobile",children:"Score"}),s.jsx(S,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:y.map(E=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:E.name}),s.jsxs("small",{className:"text-muted",children:[s.jsx(Gi,{size:12,className:"me-1"}),E.email]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:E.employeeId})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-muted",children:E.department})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${E.progress}%`},"aria-valuenow":E.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),s.jsxs("small",{className:"text-muted",children:[E.progress,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:E.score?s.jsxs(Ne,{bg:E.score>=80?"success":E.score>=60?"warning":"danger",children:[E.score,"%"]}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:f(E.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Trainee Details",icon:s.jsx(St,{}),onClick:()=>x(E.id)},{label:"Send Message",icon:s.jsx(Gi,{}),onClick:()=>p(E.id)}]})})]},E.id))})]})})]})},qce=()=>{const{subjectId:e}=gr(),t=Ge(),[r,a]=v.useState("trainees"),[n,i]=v.useState(null),[l,o]=v.useState(!0),[c,u]=v.useState(null);v.useEffect(()=>{(async()=>{try{o(!0),await new Promise(h=>setTimeout(h,1e3)),i({id:e,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols",duration:"2 hours",status:"completed",instructor:"Dr. Smith",course:"Aviation Safety Management",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(p){u("Failed to load subject details"),console.error("Error fetching subject:",p)}finally{o(!1)}})()},[e]);const d=x=>{const h={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[x]||{variant:"secondary",text:"Unknown"};return s.jsx(Ne,{bg:h.variant,children:h.text})},m=[{id:"trainees",title:"Trainee List",icon:Ft,component:s.jsx(Gce,{subjectId:e})}],f=m.find(x=>x.id===r);return l?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):c?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:c})]})}):n?s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:n.title}),s.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.course]})]})]})})}),s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(Qe,{size:24,className:"text-primary mb-2"}),s.jsx("h6",{className:"mb-1",children:"Duration"}),s.jsx("h4",{className:"mb-0 text-primary",children:n.duration}),s.jsx("small",{className:"text-muted",children:"Estimated Time"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(Ft,{size:24,className:"text-success mb-2"}),s.jsx("h6",{className:"mb-1",children:"Trainees"}),s.jsxs("h4",{className:"mb-0 text-success",children:[n.completedTrainees,"/",n.totalTrainees]}),s.jsx("small",{className:"text-muted",children:"Completed"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"text-info mb-2",children:s.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),s.jsx("h6",{className:"mb-1",children:"Average Score"}),s.jsxs("h4",{className:"mb-0 text-info",children:[n.averageScore,"%"]}),s.jsx("small",{className:"text-muted",children:"Performance"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx(Je,{size:24,className:"text-warning mb-2"}),s.jsx("h6",{className:"mb-1",children:"Status"}),d(n.status)]})})})]}),s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{md:6,children:s.jsxs(H,{children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Subject Information"})}),s.jsxs(H.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx(It,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Description:"})," ",n.description]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Instructor:"})," ",n.instructor]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(Qe,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Completion Date:"})," ",n.completionDate]})]})]})}),s.jsx(U,{md:6,children:s.jsxs(H,{children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Materials"})}),s.jsx(H.Body,{children:n.materials.map((x,p)=>s.jsxs("div",{className:"mb-2 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsx("span",{className:"fw-medium",children:x.name}),s.jsx("small",{className:"text-muted d-block",children:x.type})]}),s.jsx("small",{className:"text-muted",children:x.size})]},p))})]})})]}),s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs(H,{children:[s.jsx(H.Header,{children:s.jsx("h5",{className:"mb-0",children:"Assessments"})}),s.jsx(H.Body,{children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Assessment"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Max Score"}),s.jsx("th",{children:"Average Score"})]})}),s.jsx("tbody",{children:n.assessments.map((x,p)=>s.jsxs("tr",{children:[s.jsx("td",{children:x.name}),s.jsx("td",{children:x.type}),s.jsx("td",{children:x.maxScore}),s.jsx("td",{children:x.averageScore})]},p))})]})})})]})})}),s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs(H,{className:"border-0",children:[s.jsx(H.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:m.map(x=>{const p=x.icon,h=r===x.id;return s.jsxs("button",{className:`custom-tab ${h?"active":""}`,onClick:()=>a(x.id),children:[s.jsx(p,{size:16,className:"me-2"}),x.title]},x.id)})})}),s.jsx(H.Body,{className:"p-0",children:f&&f.component})]})})})]}):s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"warning",children:[s.jsx(ke.Heading,{children:"Subject Not Found"}),s.jsx("p",{children:"The requested subject could not be found."})]})})},Kce=()=>{const e=Ge(),[t,r]=v.useState(null),[a,n]=v.useState(null),[i,l]=v.useState(!1),[o,c]=v.useState(!1),[u,d]=v.useState({type:"",text:""}),m=h=>{const g=h.target.files[0];if(g)if(g.type.startsWith("image/")){const b=new FileReader;b.onload=j=>{r(g),n(j.target.result)},b.readAsDataURL(g)}else d({type:"danger",text:"Please upload an image file."})},f=async()=>{if(!t){d({type:"warning",text:"Please upload a signature first."});return}c(!0);try{await new Promise(h=>setTimeout(h,2e3)),d({type:"success",text:"Signature saved successfully!"})}catch{d({type:"danger",text:"Failed to save signature. Please try again."})}finally{c(!1)}},x=()=>{r(null),n(null),d({type:"info",text:"Signature removed."})},p=()=>{e(he.PROFILE)};return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsxs(U,{children:[s.jsx("div",{className:"d-flex align-items-center mb-3",children:s.jsxs(se,{variant:"outline-secondary",onClick:p,className:"me-3",children:[s.jsx(At,{size:16,className:"me-2"}),"Back to Profile"]})}),s.jsx("h2",{className:"mb-2",children:"Configure Signature"}),s.jsx("p",{className:"text-muted",children:"Upload and manage your digital signature for assessments"})]})}),u.text&&s.jsx(ke,{variant:u.type,className:"mb-4",children:u.text}),s.jsxs(oe,{children:[s.jsx(U,{lg:8,children:s.jsxs(H,{children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(Ia,{size:20,className:"me-2"}),"Digital Signature"]})}),s.jsx(H.Body,{className:"p-4",children:s.jsxs(I,{children:[s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{children:"Upload Signature Image"}),s.jsx(I.Control,{type:"file",accept:"image/*",onChange:m,className:"mb-3"}),s.jsx(I.Text,{className:"text-muted",children:"Supported formats: JPG, PNG, GIF. Maximum size: 2MB"})]}),a&&s.jsxs(I.Group,{className:"mb-4",children:[s.jsx(I.Label,{children:"Signature Preview"}),s.jsx("div",{className:"border rounded p-3 text-center bg-light",children:s.jsx("img",{src:a,alt:"Signature Preview",style:{maxWidth:"100%",maxHeight:"200px"},className:"img-fluid"})})]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(se,{variant:"primary",onClick:f,disabled:!t||o,children:o?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{size:16,className:"me-2"}),"Save Signature"]})}),a&&s.jsxs(s.Fragment,{children:[s.jsxs(se,{variant:"outline-info",onClick:()=>l(!0),children:[s.jsx(St,{size:16,className:"me-2"}),"Preview"]}),s.jsxs(se,{variant:"outline-danger",onClick:x,children:[s.jsx(mn,{size:16,className:"me-2"}),"Remove"]})]})]})]})})]})}),s.jsxs(U,{lg:4,children:[s.jsxs(H,{children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Signature Guidelines"})}),s.jsx(H.Body,{children:s.jsxs("ul",{className:"list-unstyled mb-0",children:[s.jsx("li",{className:"mb-2",children:s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Format:"})," Use clear, high-contrast signature"]})}),s.jsx("li",{className:"mb-2",children:s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Size:"})," Recommended 300x100 pixels"]})}),s.jsx("li",{className:"mb-2",children:s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Background:"})," White or transparent background"]})}),s.jsx("li",{className:"mb-2",children:s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Quality:"})," High resolution for clarity"]})}),s.jsx("li",{className:"mb-0",children:s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Usage:"})," Will be used on all assessment documents"]})})]})})]}),s.jsxs(H,{className:"mt-3",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Current Status"})}),s.jsx(H.Body,{children:s.jsx("div",{className:"text-center",children:t?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"text-success mb-2",children:s.jsx(Ia,{size:32})}),s.jsx("h6",{className:"text-success",children:"Signature Configured"}),s.jsx("small",{className:"text-muted",children:"Your signature is ready for use"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"text-muted mb-2",children:s.jsx(Ia,{size:32})}),s.jsx("h6",{className:"text-muted",children:"No Signature"}),s.jsx("small",{className:"text-muted",children:"Upload a signature to get started"})]})})})]})]})]}),s.jsxs(le,{show:i,onHide:()=>l(!1),size:"lg",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:"Signature Preview"})}),s.jsx(le.Body,{className:"text-center",children:a&&s.jsx("div",{className:"border rounded p-4 bg-light",children:s.jsx("img",{src:a,alt:"Signature Preview",style:{maxWidth:"100%",maxHeight:"300px"},className:"img-fluid"})})}),s.jsx(le.Footer,{children:s.jsx(se,{variant:"secondary",onClick:()=>l(!1),children:"Close"})})]})]})},Yce=()=>{const{resultId:e}=gr(),t=Ge(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState("overview");v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(y=>setTimeout(y,1e3)),a({id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",duration:"45 minutes",attempts:1,sections:[{id:1,name:"React Fundamentals",score:20,maxScore:25,status:"completed",timeSpent:"15 minutes"},{id:2,name:"Component Lifecycle",score:18,maxScore:20,status:"completed",timeSpent:"12 minutes"},{id:3,name:"State Management",score:22,maxScore:25,status:"completed",timeSpent:"10 minutes"},{id:4,name:"Advanced Patterns",score:25,maxScore:30,status:"completed",timeSpent:"8 minutes"}],approvalStatus:"pending",approvalNotes:"Waiting for final review from lead trainer."})}catch(j){o("Failed to fetch assessment details."),console.error(j)}finally{i(!1)}})()},[e]);const d=(b,j)=>{const y=b/j*100;return y>=80?"success":y>=60?"warning":"danger"},m=b=>b.includes("A")?"success":b.includes("B")?"info":b.includes("C")?"warning":"danger",f=b=>{const j={completed:{bg:"success",text:"Completed"},in_progress:{bg:"warning",text:"In Progress"},pending:{bg:"secondary",text:"Pending"},failed:{bg:"danger",text:"Failed"}},y=j[b]||j.pending;return s.jsx(Ne,{bg:y.bg,children:y.text})},x=()=>{console.log("Downloading report for result:",e)},p=()=>{t(he.TRAINER_APPROVAL_NOTES(e))};if(n)return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(oe,{children:s.jsx(U,{children:s.jsx(zt,{height:400})})})});if(l)return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(oe,{children:s.jsx(U,{children:s.jsx(ke,{variant:"danger",children:l})})})});if(!r)return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(oe,{children:s.jsx(U,{children:s.jsx(ke,{variant:"info",children:"Assessment result not found"})})})});const h=[{id:"overview",title:"Assessment Overview",icon:vt,component:s.jsx("div",{className:"p-4",children:s.jsxs(oe,{children:[s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),s.jsx("h5",{className:"mb-0",children:r.title})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Course"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.course})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.trainee})]})]})]}),s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`h4 mb-0 text-${d(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),s.jsx(Ne,{bg:m(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Status"}),f(r.status)]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.completedDate})]})]})]})]})})},{id:"sections",title:"Section Breakdown",icon:cS,component:s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Section"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Time Spent"})]})}),s.jsx("tbody",{children:r.sections.map(b=>s.jsxs("tr",{children:[s.jsx("td",{className:"fw-bold",children:b.name}),s.jsx("td",{children:s.jsxs("span",{className:`fw-bold text-${d(b.score,b.maxScore)}`,children:[b.score,"/",b.maxScore]})}),s.jsx("td",{children:f(b.status)}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Qe,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:b.timeSpent})]})})]},b.id))})]})})}],g=h.find(b=>b.id===c);return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:()=>t(he.ASSESSMENTS_RESULTS),children:[s.jsx(At,{size:16,className:"me-2"}),"Back to Results"]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(se,{variant:"outline-primary",onClick:x,children:[s.jsx(Ln,{size:16,className:"me-2"}),"Download Report"]}),s.jsxs(se,{variant:"outline-secondary",onClick:p,children:[s.jsx(St,{size:16,className:"me-2"}),"View Approval Notes"]})]})]})})}),s.jsx(oe,{children:s.jsx(U,{children:s.jsxs(H,{className:"border-0",children:[s.jsx(H.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:h.map(b=>{const j=b.icon,y=c===b.id;return s.jsxs("button",{className:`custom-tab ${y?"active":""}`,onClick:()=>u(b.id),children:[s.jsx(j,{size:16,className:"me-2"}),b.title]},b.id)})})}),s.jsx(H.Body,{className:"p-0",children:g&&g.component})]})})})]})},Xce={NOT_STARTED:{variant:"secondary",text:"Not Started"},ON_GOING:{variant:"info",text:"On Going"},APPROVED:{variant:"success",text:"Approved"},COMPLETED:{variant:"success",text:"Completed"},PENDING:{variant:"warning",text:"Pending"}},Jce=e=>{const t=Xce[e]||{variant:"secondary",text:e||"Unknown"};return s.jsx("span",{className:`badge bg-${t.variant}`,children:t.text})},Zce=e=>{if(!e)return{date:"",time:""};const t=new Date(e);return{date:t.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),time:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}},Xh=()=>{const{entityType:e,entityId:t}=gr(),r=za(),a=Ge(),[n,i]=v.useState({loading:!0,error:null,info:r.state||null,assessments:[]}),l=e==="course"||e==="subject";if(v.useEffect(()=>{(async()=>{if(!t||!l){i(u=>({...u,loading:!1,error:"Invalid assessment context"}));return}try{i(d=>({...d,loading:!0,error:null}));const u=e==="course"?await Za.getCourseAssessments(t):await Za.getSubjectAssessments(t);i({loading:!1,error:null,assessments:u?.assessments||[],info:u?.courseInfo||u?.subjectInfo||r.state||null})}catch(u){console.error("Error loading assessments:",u),te.error("Failed to load assessments"),i(d=>({...d,loading:!1,error:u.response?.data?.message||u.message||"Failed to load assessments"}))}})()},[e,t,l,r.state]),!l)return s.jsx(_e,{className:"py-4",children:s.jsx(ke,{variant:"danger",children:"Invalid assessment type."})});const o=c=>{c.status==="ON_GOING"&&a(he.ASSESSMENTS_SECTIONS(c.id))};return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3 flex-wrap gap-3",children:[s.jsxs(se,{variant:"outline-secondary",className:"d-flex align-items-center justify-content-center",onClick:()=>a(-1),children:[s.jsx(At,{size:16,className:"me-2"}),"Back"]}),s.jsxs("div",{children:[s.jsx("h4",{className:"mb-1",children:e==="course"?"Course Assessments":"Subject Assessments"}),n.info&&s.jsxs("p",{className:"text-muted mb-0",children:[n.info.name,n.info.code?`  ${n.info.code}`:""]})]})]}),s.jsx(H,{className:"shadow-sm",children:s.jsx(H.Body,{children:n.loading?s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(xt,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):n.error?s.jsx(ke,{variant:"danger",className:"mb-0",children:n.error}):n.assessments.length===0?s.jsx("div",{className:"text-center py-4 text-muted",children:"No assessments found."}):s.jsx("div",{className:"scrollable-table-container",style:{maxHeight:"70vh"},children:s.jsxs(Yt,{hover:!0,responsive:!0,className:"mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Assessment"}),s.jsx("th",{children:"Trainee"}),s.jsx("th",{children:"Date & Time"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Result"}),s.jsx("th",{children:"PDF"}),s.jsx("th",{className:"text-center",children:"Action"})]})}),s.jsx("tbody",{children:n.assessments.map(c=>{const u=Zce(c.occuranceDate);return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:c.name})}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:c.trainee?.fullName||""}),s.jsx("small",{className:"text-muted",children:c.trainee?.eid||c.trainee?.email||""})]}),s.jsxs("td",{children:[s.jsx("div",{children:u.date}),s.jsx("small",{className:"text-muted",children:u.time})]}),s.jsx("td",{children:Jce(c.status)}),s.jsx("td",{children:c.resultText||c.resultScore||""}),s.jsx("td",{children:c.pdfUrl?s.jsx("a",{href:c.pdfUrl,target:"_blank",rel:"noreferrer",children:"View"}):s.jsx("span",{className:"text-muted",children:""})}),s.jsx("td",{className:"text-center",children:c.status==="ON_GOING"?s.jsx(se,{size:"sm",variant:"primary",onClick:()=>o(c),children:"Assess"}):s.jsx("span",{className:"text-muted",children:""})})]},c.id)})})]})})})})]})},R4=({assessmentInfo:e,roleInSubject:t,formatDate:r})=>{if(!e)return null;const a=[{label:"Trainee",value:`${e.trainee?.firstName||""} ${e.trainee?.lastName||""}`.trim()||"",subValue:e.trainee?.eid||""},{label:"Assessment Date",value:r(e.occuranceDate),subValue:""},{label:"Status",value:e.status||"",subValue:""},{label:"Role In Subject",value:t||"",subValue:""}];return s.jsxs("div",{className:"assessment-info-banner",children:[s.jsxs("div",{className:"title-block",children:[s.jsx("h2",{className:"assessment-title",children:e.name||"Assessment"}),s.jsxs("p",{className:"text-muted mb-0 assessment-course-subtitle",children:[e.course?.name||e.subject?.name||"",e.course?.code?`  ${e.course.code}`:""]})]}),s.jsx("div",{className:"assessment-summary-inline",children:a.map(n=>s.jsxs("div",{className:"summary-item",children:[s.jsxs("span",{className:"summary-label",children:[n.label,":"]}),s.jsx("span",{className:"summary-value",children:n.value}),n.subValue&&s.jsx("span",{className:"summary-sub-value",children:n.subValue})]},n.label))})]})};R4.propTypes={assessmentInfo:L.object,roleInSubject:L.string,formatDate:L.func.isRequired};const L4=({section:e,formatDate:t})=>{const r=Ge();if(!e)return null;const a=d=>d?s.jsx("span",{className:"text-success d-inline-flex align-items-center",children:s.jsx(z2,{size:16})}):s.jsx("span",{className:"text-danger d-inline-flex align-items-center",children:s.jsx(uS,{size:16})}),n=()=>e.canAssessed?s.jsx(Ne,{bg:"primary",children:"Ready"}):e.canUpdated?s.jsx(Ne,{bg:"warning",children:"Pending Update"}):s.jsx(Ne,{bg:"secondary",children:"Locked"}),i=!e.canAssessed,l=!e.canAssessed&&e.canUpdated,o=[],c=()=>{e.id&&r(he.ASSESSMENTS_SECTION_FIELDS(e.id))},u=()=>{e.id&&r(he.ASSESSMENTS_SECTION_FIELDS(e.id))};return e.canAssessed&&o.push({label:"Assess Section",icon:s.jsx(Yd,{size:14}),onClick:c}),l&&o.push({label:"Update Section",icon:s.jsx(Yd,{size:14}),onClick:u}),s.jsx(H,{className:`assessment-section-card ${i?"disabled":""}`,children:s.jsx(H.Body,{children:s.jsxs("div",{className:"section-card-header",children:[s.jsxs("div",{className:"section-header-grid",children:[s.jsx("div",{className:"section-heading",children:s.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"section-order-pill",children:["#",e.templateSection?.displayOrder??"-"]}),s.jsx("h5",{className:"mb-0",children:e.templateSection?.label||"Unnamed Section"})]})}),s.jsxs("div",{className:"section-inline-flags",children:[s.jsxs("div",{className:"flag-item",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Edit By"}),s.jsx("span",{className:"fw-semibold",children:e.templateSection?.editBy||""})]}),s.jsxs("div",{className:"flag-item",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Submittable"}),a(e.templateSection?.isSubmittable)]}),s.jsxs("div",{className:"flag-item",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Toggle Dependent"}),a(e.templateSection?.isToggleDependent)]})]}),s.jsxs("div",{className:"section-actions",children:[n(),o.length>0&&s.jsx(er,{align:"end",className:"section-action-dropdown",placement:"bottom-end",disabled:i&&!l,trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:18})},items:o})]})]}),s.jsxs("div",{className:"section-subtext",children:[s.jsxs("small",{className:"text-muted",children:["Created: ",t(e.createdAt)]}),e.assessedBy&&s.jsxs("span",{className:"ms-3 text-muted",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Assessed By"})," ",s.jsx("span",{className:"fw-semibold",children:e.assessedBy?.id||""})]})]})]})})})};L4.propTypes={section:L.object.isRequired,formatDate:L.func.isRequired};const k2=()=>{const{assessmentId:e}=gr(),t=Ge(),[r,a]=v.useState({loading:!0,error:null,assessmentInfo:null,sections:[],userRole:null});v.useEffect(()=>{e&&n()},[e]);const n=async()=>{try{a(p=>({...p,loading:!0,error:null}));const x=await Za.getAssessmentSections(e);a({loading:!1,error:null,assessmentInfo:x?.assessmentInfo||null,sections:x?.sections||[],userRole:x?.userRole||null})}catch(x){console.error("Error loading assessment sections:",x),te.error("Failed to load assessment sections"),a(p=>({...p,loading:!1,error:x.response?.data?.message||x.message||"Failed to load assessment sections"}))}},i=v.useMemo(()=>[...r.sections].sort((x,p)=>{const h=x.templateSection?.displayOrder??0,g=p.templateSection?.displayOrder??0;return h-g}),[r.sections]),l=i[0]?.templateSection?.roleInSubject||r.userRole,o=x=>x?new Date(x).toLocaleString():"",c=()=>t(-1),u=async()=>{try{const x=await Za.getAssessmentFormPreview(e),p=x?.previewUrl||x?.url;p?window.open(p,"_blank","noopener"):te.info("No preview available.")}catch(x){console.error("Error previewing form:",x),te.error("Failed to load assessment form preview.")}},d=()=>{te.info("Viewing trainee sections (mock).")},m=()=>{te.success("Assessment opened for trainee (mock).")},f=()=>{te.success("Assessment submitted (mock).")};return s.jsx("div",{className:"assessment-sections-shell",children:s.jsxs(_e,{fluid:!0,className:"py-4 assessment-sections-page",children:[s.jsxs("div",{className:"assessment-header d-flex flex-wrap align-items-center justify-content-between gap-3 mb-4",children:[s.jsxs(se,{variant:"outline-secondary",onClick:c,className:"assess-back-btn",children:[s.jsx(At,{size:16,className:"me-2"}),"Back"]}),s.jsx("div",{className:"assessment-pill",children:"Assessment Details"}),s.jsx(se,{variant:"custom-purple",className:"assess-preview-btn",onClick:u,children:"Assessment Form Preview"})]}),s.jsx(H,{className:"assessment-details-card shadow-sm",children:s.jsx(H.Body,{children:r.loading?s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(xt,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):r.error?s.jsx(ke,{variant:"danger",className:"mb-0",children:r.error}):s.jsxs(s.Fragment,{children:[s.jsx(R4,{assessmentInfo:r.assessmentInfo,roleInSubject:l,formatDate:o}),i.length===0?s.jsx("div",{className:"text-center text-muted py-4",children:"No sections available."}):s.jsx("div",{className:"assessment-section-column",children:i.map(x=>s.jsx(L4,{section:x,formatDate:o},x.id))})]})})}),s.jsxs("div",{className:"assessment-footer-actions mt-4",children:[s.jsx(se,{variant:"outline-secondary",className:"footer-btn",onClick:d,children:"View Trainee Section"}),s.jsx(se,{variant:"outline-primary",className:"footer-btn",onClick:m,children:"Open For Trainee"}),s.jsx(se,{variant:"primary",className:"footer-btn submit-btn",onClick:f,children:"Submit Assessment"})]})]})})},D2=()=>{const{sectionId:e}=gr(),t=Ge();za();const[r,a]=v.useState({loading:!0,error:null,sectionInfo:null,fields:[],fieldValues:{}}),n=v.useCallback(async()=>{if(e)try{a(h=>({...h,loading:!0,error:null}));const p=await Za.getAssessmentSectionFields(e);if(p?.success){const h=p.fields||[],g={};h.forEach(b=>{const j=b.templateField?.id;j&&(g[j]=b.assessmentValue?.answerValue||"")}),a({loading:!1,error:null,sectionInfo:p.assessmentSectionInfo||null,fields:h,fieldValues:g})}else a(h=>({...h,loading:!1,error:"Failed to load section fields"}))}catch(p){console.error("Error loading section fields:",p),te.error("Failed to load section fields"),a(h=>({...h,loading:!1,error:p.response?.data?.message||p.message||"Failed to load section fields"}))}},[e]);v.useEffect(()=>{n()},[n]);const i=(p,h)=>{a(g=>({...g,fieldValues:{...g.fieldValues,[p]:h}}))},l=()=>{const p=[],h={};return r.fields.forEach(g=>{const b=g.templateField;b&&(b.parentId?(h[b.parentId]||(h[b.parentId]=[]),h[b.parentId].push(g)):p.push(g))}),p.sort((g,b)=>(g.templateField?.displayOrder||0)-(b.templateField?.displayOrder||0)),Object.keys(h).forEach(g=>{h[g].sort((b,j)=>(b.templateField?.displayOrder||0)-(j.templateField?.displayOrder||0))}),{parentFields:p,childrenMap:h}},o=(p,h=!1)=>{const g=p.templateField;if(!g)return null;const b=g.id,j=g.fieldType,y=g.label||g.fieldName||"Unnamed Field",w=r.fieldValues[b]||"";return j==="TOGGLE"?s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(I.Label,{className:"field-label",children:y}),s.jsx(I.Check,{type:"switch",checked:w==="true"||w===!0,onChange:N=>i(b,N.target.checked),className:"field-toggle"})]},b):s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(I.Label,{className:"field-label",children:y}),s.jsx(I.Control,{type:"text",value:w,onChange:N=>i(b,N.target.value),placeholder:`Enter ${y.toLowerCase()}`,className:"field-input"})]},b)},c=p=>{const h=p.templateField;if(!h||h.fieldType!=="PART")return null;const g=h.id,b=h.label||h.fieldName||"Unnamed Group",{childrenMap:j}=l(),y=j[g]||[],w=y.length;return s.jsxs("div",{className:"field-group",children:[s.jsxs("div",{className:"field-group-header",children:[s.jsx("h6",{className:"field-group-title",children:b}),w>0&&s.jsxs("span",{className:"field-item-count",children:[w," ITEMS"]})]}),s.jsxs("div",{className:"field-group-content",children:[y.length>0&&s.jsx(oe,{className:"g-3",children:y.map((N,S)=>{if(S%2===0){const E=N,_=y[S+1];return s.jsxs(J.Fragment,{children:[s.jsx(U,{md:6,children:o(E,!0)}),_&&s.jsx(U,{md:6,children:o(_,!0)})]},`row-${S}`)}return null})}),s.jsxs("div",{className:"field-group-actions",children:[s.jsxs(se,{variant:"outline-danger",size:"sm",className:"delete-group-btn",children:[s.jsx(Xe,{size:14,className:"me-1"}),"Delete"]}),s.jsxs(se,{variant:"outline-primary",size:"sm",className:"add-item-btn",children:[s.jsx(Xr,{size:14,className:"me-1"}),"Add"]})]})]})]},g)},u=()=>{t(-1)},d=()=>{te.success("Section saved (mock).")},m=()=>{te.success("Section submitted (mock).")};if(r.loading)return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(xt,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(r.error)return s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(ke,{variant:"danger",className:"mb-0",children:r.error})});const{parentFields:f}=l(),x=r.sectionInfo?.templateSection?.label||"Section";return s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-4",children:[s.jsxs(se,{variant:"outline-secondary",className:"me-3 d-flex align-items-center justify-content-center",onClick:u,style:{borderRadius:"999px",padding:"0.45rem 1.5rem"},children:[s.jsx(At,{size:16,className:"me-2"}),"Back"]}),s.jsxs("div",{children:[s.jsx("h4",{className:"mb-1",children:x}),r.sectionInfo?.templateSection&&s.jsxs("p",{className:"text-muted mb-0",children:[r.sectionInfo.templateSection.editBy,"  ",r.sectionInfo.templateSection.roleInSubject]})]})]}),s.jsx(H,{className:"shadow-sm",children:s.jsx(H.Body,{children:s.jsx("div",{className:"assessment-section-fields",children:s.jsx("div",{className:"fields-container",children:s.jsx(oe,{className:"g-3",children:f.map((p,h)=>{const g=p.templateField;if(!g)return null;if(g.fieldType==="PART")return s.jsx(U,{xs:12,children:c(p)},g.id);if(h%2===0){const b=p,j=f[h+1];return s.jsxs(J.Fragment,{children:[s.jsx(U,{md:6,children:o(b)}),j&&j.templateField?.fieldType!=="PART"&&s.jsx(U,{md:6,children:o(j)})]},`row-${h}`)}return null})})})})})}),s.jsxs("div",{className:"d-flex justify-content-end gap-3 mt-4",children:[s.jsx(se,{variant:"outline-primary",onClick:d,children:"Save"}),s.jsx(se,{variant:"primary",onClick:m,children:"Submit"})]})]})},Qce=()=>{const{resultId:e}=gr(),t=Ge(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null),[c,u]=v.useState(!1),[d,m]=v.useState(!1),[f,x]=v.useState({status:"pending",notes:"",approvedBy:"",approvedDate:""});v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(E=>setTimeout(E,1e3));const S={id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",approvalStatus:"pending",approvalNotes:"",trainerNotes:"Student shows solid foundation but should focus more on advanced state management techniques.",previousApprovals:[{id:1,status:"approved",notes:"Good performance overall",approvedBy:"Dr. Smith",approvedDate:"2024-01-10",type:"initial"}]};a(S),x({status:S.approvalStatus,notes:S.approvalNotes,approvedBy:"",approvedDate:""})}catch(S){o("Failed to load assessment result data"),console.error("Error fetching result data:",S)}finally{i(!1)}})()},[e]);const p=(N,S)=>{const E=N/S*100;return E>=80?"success":E>=60?"warning":"danger"},h=N=>N.includes("A")?"success":N.includes("B")?"info":N.includes("C")?"warning":"danger",g=N=>{const S={approved:{bg:"success",text:"Approved"},pending:{bg:"warning",text:"Pending Approval"},rejected:{bg:"danger",text:"Rejected"}},E=S[N]||S.pending;return s.jsx(Ne,{bg:E.bg,children:E.text})},b=(N,S)=>{x(E=>({...E,[N]:S}))},j=async()=>{try{u(!0),await new Promise(N=>setTimeout(N,1500)),a(N=>({...N,approvalStatus:f.status,approvalNotes:f.notes})),m(!1),console.log("Approval saved successfully")}catch(N){console.error("Error saving approval:",N)}finally{u(!1)}},y=()=>{x(N=>({...N,status:"approved",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)},w=()=>{x(N=>({...N,status:"rejected",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)};return n?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(oe,{children:s.jsx(U,{children:s.jsx(zt,{height:400})})})}):l?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(oe,{children:s.jsx(U,{children:s.jsx(ke,{variant:"danger",children:l})})})}):r?s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:()=>t(`/trainer/assessment-details/${e}`),className:"me-3",children:[s.jsx(At,{size:16,className:"me-2"}),"Back to Details"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Result Approval Note"}),s.jsx("p",{className:"text-muted mb-0",children:"Review and approve assessment results"})]})]})})}),s.jsxs(oe,{children:[s.jsxs(U,{lg:8,children:[s.jsxs(H,{className:"mb-4",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(vt,{size:20,className:"me-2"}),"Assessment Summary"]})}),s.jsx(H.Body,{children:s.jsxs(oe,{children:[s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),s.jsx("h5",{className:"mb-0",children:r.title})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Course"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(It,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.course})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.trainee})]})]})]}),s.jsxs(U,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`h4 mb-0 text-${p(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),s.jsx(Ne,{bg:h(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Current Status"}),g(r.approvalStatus)]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xr,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.completedDate})]})]})]})]})})]}),s.jsxs(H,{className:"mb-4",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(eS,{size:20,className:"me-2"}),"Trainer Notes"]})}),s.jsx(H.Body,{children:s.jsx("p",{className:"mb-0",children:r.trainerNotes})})]}),r.previousApprovals&&r.previousApprovals.length>0&&s.jsxs(H,{className:"mb-4",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(Qe,{size:20,className:"me-2"}),"Approval History"]})}),s.jsx(H.Body,{children:r.previousApprovals.map(N=>s.jsxs("div",{className:"border-bottom pb-3 mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[s.jsxs("div",{children:[s.jsxs("h6",{className:"mb-1",children:[N.type.charAt(0).toUpperCase()+N.type.slice(1)," Approval"]}),s.jsxs("small",{className:"text-muted",children:["Approved by ",N.approvedBy," on ",N.approvedDate]})]}),g(N.status)]}),N.notes&&s.jsx("p",{className:"mb-0 text-muted",children:N.notes})]},N.id))})]})]}),s.jsxs(U,{lg:4,children:[s.jsxs(H,{className:"mb-4",children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Current Status"})}),s.jsx(H.Body,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mb-3",children:g(r.approvalStatus)}),r.approvalNotes&&s.jsxs("div",{children:[s.jsx("h6",{className:"text-muted mb-2",children:"Current Notes"}),s.jsx("p",{className:"small text-muted",children:r.approvalNotes})]})]})})]}),s.jsxs(H,{children:[s.jsx(H.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Approval Actions"})}),s.jsx(H.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(se,{variant:"success",onClick:y,className:"d-flex align-items-center justify-content-center",children:[s.jsx(Je,{size:16,className:"me-2"}),"Approve Result"]}),s.jsxs(se,{variant:"danger",onClick:w,className:"d-flex align-items-center justify-content-center",children:[s.jsx(fs,{size:16,className:"me-2"}),"Reject Result"]})]})})]})]})]}),s.jsxs(le,{show:d,onHide:()=>m(!1),size:"lg",children:[s.jsx(le.Header,{closeButton:!0,children:s.jsx(le.Title,{children:f.status==="approved"?"Approve Assessment Result":"Reject Assessment Result"})}),s.jsx(le.Body,{children:s.jsxs(I,{children:[s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Approval Notes"}),s.jsx(I.Control,{as:"textarea",rows:4,value:f.notes,onChange:N=>b("notes",N.target.value),placeholder:"Enter your approval notes..."})]}),s.jsxs(I.Group,{className:"mb-3",children:[s.jsx(I.Label,{children:"Approved By"}),s.jsx(I.Control,{type:"text",value:f.approvedBy,onChange:N=>b("approvedBy",N.target.value),placeholder:"Enter your name"})]}),s.jsxs(I.Group,{children:[s.jsx(I.Label,{children:"Approval Date"}),s.jsx(I.Control,{type:"date",value:f.approvedDate,onChange:N=>b("approvedDate",N.target.value)})]})]})}),s.jsxs(le.Footer,{children:[s.jsx(se,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),s.jsx(se,{variant:f.status==="approved"?"success":"danger",onClick:j,disabled:c,children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{size:16,className:"me-2"}),f.status==="approved"?"Approve":"Reject"]})})]})]})]}):s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsx(oe,{children:s.jsx(U,{children:s.jsx(ke,{variant:"info",children:"Assessment result not found"})})})})},ede=()=>{const e=Ge(),t=[{title:"View Course Details",description:"Access detailed course information and management",icon:It,path:he.DEPARTMENT_MY_DETAILS,color:"primary"},{title:"Review Assessment Requests",description:"Process pending assessment review requests",icon:Ht,path:he.DEPARTMENT_REVIEW_REQUESTS,color:"warning"},{title:"Department Statistics",description:"View department performance metrics",icon:$r,path:"/department-head/statistics",color:"info"},{title:"Trainee Management",description:"Manage trainee enrollments and progress",icon:$r,path:"/department-head/trainee-management",color:"success"}];return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsxs(_e,{className:"py-4",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{lg:12,children:s.jsxs(H,{className:"border-0 shadow-sm",children:[s.jsx(H.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Department Dashboard"})}),s.jsx(H.Body,{children:s.jsxs(oe,{children:[s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(It,{size:24,className:"text-primary"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"12"}),s.jsx("p",{className:"text-muted mb-0",children:"Active Courses"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx($r,{size:24,className:"text-success"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"156"}),s.jsx("p",{className:"text-muted mb-0",children:"Enrolled Trainees"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Ht,{size:24,className:"text-warning"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"8"}),s.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Ra,{size:24,className:"text-info"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"24"}),s.jsx("p",{className:"text-muted mb-0",children:"Upcoming Assessments"})]})})})]})})]})})}),s.jsx(oe,{className:"mb-4",children:s.jsx(U,{lg:12,children:s.jsxs(H,{className:"h-100 border-0 shadow-sm",children:[s.jsx(H.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(H.Body,{children:s.jsx(oe,{children:t.map((r,a)=>{const n=r.icon;return s.jsx(U,{md:6,lg:3,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(n,{size:24,className:`text-${r.color} me-2`}),s.jsx("h6",{className:"mb-0",children:r.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),s.jsx(un,{size:16,className:`text-${r.color} ms-auto`})]})},a)})})})]})})})]})})},tde=({course:e,index:t,onView:r})=>{const a=i=>{const l={PLANNED:{variant:"info",icon:Qe},ONGOING:{variant:"primary",icon:Je},COMPLETED:{variant:"success",icon:Je},CANCELLED:{variant:"secondary",icon:Qe},active:{variant:"success",icon:Je},inactive:{variant:"secondary",icon:Qe},pending:{variant:"warning",icon:Qe}},o=l[i]||l.pending,c=o.icon;return s.jsxs(Ne,{bg:o.variant,className:"d-flex align-items-center",children:[s.jsx(c,{size:12,className:"me-1"}),i.toUpperCase()]})},n=i=>[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>r(i),permission:fe.VIEW_COURSE_IN_DETAIL}];return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:e.title}),s.jsx("small",{className:"text-muted",children:e.description})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:e.code})}),s.jsx("td",{className:"align-middle show-mobile",children:a(e.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx($r,{size:16,className:"me-1 text-muted"}),s.jsx("span",{children:e.enrolledCount})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:new Date(e.startDate).toLocaleDateString()})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.VIEW_COURSE_IN_DETAIL],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:n(e)})})})]})},rde=()=>{const e=Ge(),{courseId:t}=gr(),{user:r}=xs(),[a,n]=v.useState([]),[i,l]=v.useState(!0),[o,c]=v.useState(null),[u,d]=v.useState(""),[m,f]=v.useState("all"),[x,p]=v.useState(null),[h,g]=v.useState("subjects");v.useEffect(()=>{(async()=>{if(!r||!r.id){l(!1);return}try{l(!0),c(null);const N=await Mt.getPublicDepartments(),E=(Array.isArray(N)?N:N.departments||[]).find(D=>D.headUserId===r.id);if(!E){n([]),l(!1);return}const A=((await Mt.getDepartmentById(E.id)).courses||[]).filter(D=>D.status!=="ARCHIVED").map(D=>({id:D.id,title:D.name,code:D.code,description:D.description||"",status:D.status||"PLANNED",enrolledCount:D.maxNumTrainee||0,startDate:D.startDate,endDate:D.endDate,level:D.level,venue:D.venue,passScore:D.passScore,subjectCount:D.subjectCount||0}));n(A)}catch(N){console.error("Error fetching courses:",N),c("Failed to load courses. Please try again later.")}finally{l(!1)}})()},[r]);const b=a.filter(w=>{const N=w.title.toLowerCase().includes(u.toLowerCase())||w.code.toLowerCase().includes(u.toLowerCase())||w.description&&w.description.toLowerCase().includes(u.toLowerCase()),S=m==="all"||w.status===m;return N&&S}),j=w=>{p(w),e(`${he.DEPARTMENT_MY_DETAILS}/${w.id}`)};return[{id:"subjects",title:"Subject List",icon:It,component:s.jsx("div",{children:"Subject List Component"})},{id:"trainees",title:"Trainee List",icon:$r,component:s.jsx("div",{children:"Trainee List Component"})}].find(w=>w.id===h),i?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading courses..."})]})}):o?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:o})]})}):s.jsx(_e,{fluid:!0,className:"py-4 my-department-details-page",children:s.jsxs(H,{className:"border-0 shadow-sm mb-0",children:[s.jsx(H.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("h4",{className:"mb-0 text-white",children:[s.jsx(It,{className:"me-2"}),"Courses (",b.length,")"]})})}),s.jsxs(H.Body,{children:[s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search courses by title, code, or description...",value:u,onChange:d,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsxs("select",{className:"form-select filter-panel-mobile",value:m,onChange:w=>f(w.target.value),children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"PLANNED",children:"Planned"}),s.jsx("option",{value:"ONGOING",children:"Ongoing"}),s.jsx("option",{value:"COMPLETED",children:"Completed"}),s.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[b.length," course",b.length!==1?"s":""]})})})]}),s.jsx(im,{data:b,loading:i,columns:[{key:"title",title:"Course Title",className:"show-mobile",sortable:!0},{key:"code",title:"Course Code",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"enrolledCount",title:"Enrolled",className:"hide-mobile",sortable:!0},{key:"startDate",title:"Start Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(w,N)=>s.jsx(tde,{course:w,index:N,onView:j},w.id),emptyMessage:"No courses found",emptyDescription:"Try adjusting your search criteria."})]})]})})},sde=({request:e,index:t,onView:r,onApprove:a,onDeny:n})=>{const i=o=>{const c={pending:{variant:"warning",icon:Qe},approved:{variant:"success",icon:Je},denied:{variant:"danger",icon:fs}},u=c[o]||c.pending,d=u.icon;return s.jsxs(Ne,{bg:u.variant,className:"d-flex align-items-center",children:[s.jsx(d,{size:12,className:"me-1"}),o.toUpperCase()]})},l=o=>{const c=[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>r(o),permission:fe.LIST_ASSESSMENTS}];return o.status==="pending"&&c.push({type:"divider"},{label:"Approve Results",icon:s.jsx($2,{}),className:"text-success",onClick:()=>a(o),permission:fe.APPROVE_OR_REJECT_ASSESSMENT},{label:"Deny Results",icon:s.jsx(Xe,{}),className:"text-danger",onClick:()=>n(o),permission:fe.APPROVE_OR_REJECT_ASSESSMENT}),c};return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:e.traineeName}),s.jsx("small",{className:"text-muted",children:e.traineeEmail})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:e.courseTitle}),s.jsx("small",{className:"text-muted",children:e.courseCode})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:e.assessmentTitle}),s.jsx("small",{className:"text-muted",children:e.assessmentType})]})}),s.jsx("td",{className:"align-middle show-mobile",children:i(e.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:new Date(e.submittedDate).toLocaleDateString()})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"fw-medium",children:e.score?`${e.score}%`:"N/A"})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.LIST_ASSESSMENTS,fe.APPROVE_OR_REJECT_ASSESSMENT],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:l(e)})})})]})},Jh=()=>{const e=Ge(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,c]=v.useState("all");v.useEffect(()=>{const h=[{id:1,traineeName:"John Smith",traineeEmail:"john.smith@company.com",courseTitle:"Software Development Fundamentals",courseCode:"SDF-001",assessmentTitle:"Final Assessment",assessmentType:"Practical Exam",status:"pending",submittedDate:"2024-01-15T14:30:00Z",score:85,department:"IT Department"},{id:2,traineeName:"Sarah Johnson",traineeEmail:"sarah.johnson@company.com",courseTitle:"Database Management Systems",courseCode:"DMS-002",assessmentTitle:"Database Design Project",assessmentType:"Project",status:"pending",submittedDate:"2024-01-14T16:45:00Z",score:92,department:"IT Department"},{id:3,traineeName:"Mike Wilson",traineeEmail:"mike.wilson@company.com",courseTitle:"Web Development Advanced",courseCode:"WDA-003",assessmentTitle:"Frontend Development Test",assessmentType:"Written Exam",status:"approved",submittedDate:"2024-01-13T10:20:00Z",score:78,department:"IT Department"},{id:4,traineeName:"Emily Davis",traineeEmail:"emily.davis@company.com",courseTitle:"Software Development Fundamentals",courseCode:"SDF-001",assessmentTitle:"Midterm Assessment",assessmentType:"Practical Exam",status:"denied",submittedDate:"2024-01-12T09:15:00Z",score:45,department:"IT Department"}];setTimeout(()=>{r(h),n(!1)},1e3)},[]);const u=t.filter(h=>{const g=h.traineeName.toLowerCase().includes(i.toLowerCase())||h.courseTitle.toLowerCase().includes(i.toLowerCase())||h.assessmentTitle.toLowerCase().includes(i.toLowerCase()),b=o==="all"||h.status===o;return g&&b}),d=h=>{e(he.DEPARTMENT_REVIEW_REQUEST_DETAIL(h.id))},m=h=>{console.log("Approve request:",h),r(g=>g.map(b=>b.id===h.id?{...b,status:"approved"}:b))},f=h=>{console.log("Deny request:",h),r(g=>g.map(b=>b.id===h.id?{...b,status:"denied"}:b))},p=(()=>{const h=t.reduce((g,b)=>(g[b.status]=(g[b.status]||0)+1,g),{});return{pending:h.pending||0,approved:h.approved||0,denied:h.denied||0,total:t.length}})();return a?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading assessment review requests..."})]})}):s.jsx(_e,{fluid:!0,className:"py-4 assessment-review-requests-page",children:s.jsxs(H,{className:"border-neutral-200 shadow-sm",children:[s.jsx(H.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(oe,{className:"align-items-center",children:s.jsx(U,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e(he.DASHBOARD),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Assessment Review Requests"}),s.jsx("p",{className:"text-muted mb-0",children:"Review and approve/deny assessment requests from your department"})]})]})})})}),s.jsxs(H.Body,{children:[s.jsxs(oe,{className:"mb-4",children:[s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Qe,{size:24,className:"text-warning"})}),s.jsx("h5",{className:"mb-1",children:p.pending}),s.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Je,{size:24,className:"text-success"})}),s.jsx("h5",{className:"mb-1",children:p.approved}),s.jsx("p",{className:"text-muted mb-0",children:"Approved"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-danger bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(fs,{size:24,className:"text-danger"})}),s.jsx("h5",{className:"mb-1",children:p.denied}),s.jsx("p",{className:"text-muted mb-0",children:"Denied"})]})})}),s.jsx(U,{md:3,className:"mb-3",children:s.jsx(H,{className:"h-100 border-0 shadow-sm",children:s.jsxs(H.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Ht,{size:24,className:"text-primary"})}),s.jsx("h5",{className:"mb-1",children:p.total}),s.jsx("p",{className:"text-muted mb-0",children:"Total Requests"})]})})})]}),s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search requests by trainee name, course, or assessment...",value:i,onChange:l,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsxs("select",{className:"form-select filter-panel-mobile",value:o,onChange:h=>c(h.target.value),children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"denied",children:"Denied"})]})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[u.length," request",u.length!==1?"s":""]})})})]}),s.jsx(im,{data:u,loading:a,columns:[{key:"traineeName",title:"Trainee Name",className:"show-mobile",sortable:!0},{key:"courseTitle",title:"Course",className:"show-mobile",sortable:!0},{key:"assessmentTitle",title:"Assessment",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"submittedDate",title:"Submitted Date",className:"hide-mobile",sortable:!0},{key:"score",title:"Score",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(h,g)=>s.jsx(sde,{request:h,index:g,onView:d,onApprove:m,onDeny:f},h.id),emptyMessage:"No assessment requests found",emptyDescription:"Try adjusting your search criteria."})]})]})})},ade=({subjects:e,loading:t,onView:r})=>{const{sortedData:a,sortConfig:n,handleSort:i}=ur(e);if(t)return s.jsx(zt,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"No subjects are available in this course."})]})});const l=({columnKey:o,children:c,className:u=""})=>{const m=n.key===o?n.direction:null;return s.jsx("th",{className:`fw-semibold ${u}`,onClick:()=>i(o),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{style:{color:"white"},children:c}),s.jsx(pr,{direction:m,className:"ms-1",color:"white"})]})})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(l,{columnKey:"title",className:"show-mobile",children:"Subject Title"}),s.jsx(l,{columnKey:"code",className:"show-mobile",children:"Subject Code"}),s.jsx(l,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(l,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),s.jsx(l,{columnKey:"method",className:"hide-mobile",children:"Method"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:a.map((o,c)=>s.jsx(nde,{subject:o,index:c,onView:r},o.id))})]})})},nde=({subject:e,index:t,onView:r})=>{const a=i=>{const l={ON_GOING:{variant:"primary",icon:Je},PLANNED:{variant:"info",icon:Qe},COMPLETED:{variant:"success",icon:Je},CANCELLED:{variant:"secondary",icon:Qe},active:{variant:"success",icon:Je},inactive:{variant:"secondary",icon:Qe},pending:{variant:"warning",icon:Qe}},o=l[i]||l.pending,c=o.icon;return s.jsxs(Ne,{bg:o.variant,className:"d-flex align-items-center",children:[s.jsx(c,{size:12,className:"me-1"}),i.replace(/_/g," ").toUpperCase()]})},n=i=>[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>r(i),permission:fe.VIEW_SUBJECT_DETAIL}];return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:e.name}),s.jsx("small",{className:"text-muted",children:e.description||""})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:e.code})}),s.jsx("td",{className:"align-middle show-mobile",children:a(e.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{className:"text-muted small",children:[e.duration||0," hours"]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:e.method||"N/A"})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.VIEW_SUBJECT_DETAIL],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:n(e)})})})]})},ide=({trainees:e,loading:t,onView:r})=>{const{sortedData:a,sortConfig:n,handleSort:i}=ur(e);if(t)return s.jsx(zt,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"No trainees are enrolled in this course."})]})});const l=({columnKey:o,children:c,className:u=""})=>{const m=n.key===o?n.direction:null;return s.jsx("th",{className:`fw-semibold ${u}`,onClick:()=>i(o),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{style:{color:"white"},children:c}),s.jsx(pr,{direction:m,className:"ms-1",color:"white"})]})})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(l,{columnKey:"name",className:"show-mobile",children:"Trainee Name"}),s.jsx(l,{columnKey:"eid",className:"hide-mobile",children:"Employee ID"}),s.jsx(l,{columnKey:"email",className:"show-mobile",children:"Email"}),s.jsx(l,{columnKey:"enrollmentCount",className:"hide-mobile",children:"Enrollments"}),s.jsx(l,{columnKey:"batches",className:"hide-mobile",children:"Batches"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:a.map((o,c)=>s.jsx(lde,{trainee:o,index:c,onView:r},o.id))})]})})},lde=({trainee:e,index:t,onView:r})=>{const a=n=>[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>r(n),permission:fe.VIEW_USER_IN_DETAIL}];return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:n=>{n.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:n=>{n.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:e.name}),s.jsx("small",{className:"text-muted",children:e.email})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:e.eid||"N/A"})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:e.email})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:e.enrollmentCount||0})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:e.batches&&e.batches.length>0?e.batches.join(", "):"N/A"})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Ar,{permissions:[fe.VIEW_USER_IN_DETAIL],fallback:null,children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:a(e)})})})]})},I2=()=>{const e=Ge(),{courseId:t}=gr(),[r,a]=v.useState(null),[n,i]=v.useState([]),[l,o]=v.useState([]),[c,u]=v.useState(!0),[d,m]=v.useState(null),[f,x]=v.useState("subjects");v.useEffect(()=>{(async()=>{if(!t){u(!1);return}try{u(!0),m(null);const y=await Yr.getCourseById(t),w={id:y.id,title:y.name,code:y.code,description:y.description||"",status:y.status||"PLANNED",enrolledCount:y.traineeCount||0,startDate:y.startDate,endDate:y.endDate,department:y.department?.name||"N/A",departmentCode:y.department?.code||""},N=(y.subjects||[]).map(S=>({id:S.id,name:S.name,code:S.code,description:S.description||"",status:S.status||"PLANNED",duration:S.duration||0,method:S.method||"N/A",roomName:S.roomName,timeSlot:S.timeSlot,startDate:S.startDate,endDate:S.endDate,passScore:S.passScore}));a(w),i(N);try{const _=((await Yr.getCourseTrainees(t)).trainees||[]).map(T=>({id:T.id,eid:T.eid,firstName:T.firstName||"",lastName:T.lastName||"",name:`${T.firstName||""} ${T.lastName||""}`.trim(),email:T.email||"",enrollmentCount:T.enrollmentCount||0,batches:T.batches||[]}));o(_)}catch(S){console.error("Error fetching trainees:",S),o([])}}catch(y){console.error("Error fetching course details:",y),m("Failed to load course details. Please try again later.")}finally{u(!1)}})()},[t]);const p=j=>{e(he.SUBJECTS_IN_COURSE(t,j.id))},h=j=>{e(he.USERS_DETAIL(j.id))},g=[{id:"subjects",title:"Subject List",icon:It,component:s.jsx(ade,{subjects:n,loading:c,onView:p})},{id:"trainees",title:"Trainee List",icon:$r,component:s.jsx(ide,{trainees:l,loading:c,onView:h})}],b=g.find(j=>j.id===f);return c?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):d?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:d})]})}):r?s.jsxs(_e,{fluid:!0,className:"py-4 course-details-page",children:[s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e(he.DEPARTMENT_MY_DETAILS),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:r.title}),s.jsxs("p",{className:"text-muted mb-0",children:[r.code,"  ",r.department," (",r.departmentCode,")"]})]})]})})}),s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs(H,{className:"border-0",children:[s.jsx(H.Header,{className:"department-head-section-header bg-primary text-white border-0 p-0",children:s.jsx("div",{className:"custom-tabs-container",children:g.map(j=>{const y=j.icon,w=f===j.id;return s.jsxs("button",{className:`custom-tab ${w?"active":""}`,onClick:()=>x(j.id),children:[s.jsx(y,{size:16,className:"me-2"}),j.title]},j.id)})})}),s.jsx(H.Body,{className:"p-0",children:b&&b.component})]})})})]}):s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"warning",children:[s.jsx(ke.Heading,{children:"Course Not Found"}),s.jsx("p",{children:"The requested course could not be found."})]})})},ode=({subjectId:e,courseId:t})=>{const r=Ge(),{courseId:a}=gr(),n=t||a,[i,l]=v.useState([]),[o,c]=v.useState(!0),[u,d]=v.useState(null),[m,f]=v.useState(""),[x,p]=v.useState([]);v.useEffect(()=>{(async()=>{try{c(!0),await new Promise(A=>setTimeout(A,1e3)),l([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"TE001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"TE002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"TE003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"TE004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"TE005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(C){d("Failed to load trainees in subject"),console.error("Error fetching trainees:",C)}finally{c(!1)}})()},[e]);const h=T=>{const A={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[T]||{variant:"secondary",text:"Unknown"};return s.jsx(Ne,{bg:A.variant,children:A.text})},g=T=>{r(he.USERS_DETAIL(T))},b=[...new Set(i.map(T=>T.status))],j=i.filter(T=>{const C=x.length===0||x.includes(T.status),A=T.name.toLowerCase().includes(m.toLowerCase())||T.email.toLowerCase().includes(m.toLowerCase())||T.employeeId.toLowerCase().includes(m.toLowerCase())||T.department.toLowerCase().includes(m.toLowerCase());return C&&A}),y=T=>{p(T==="clear"?[]:C=>C.includes(T)?C.filter(A=>A!==T):[...C,T])},w=()=>{p([]),f("")},{sortedData:N,sortConfig:S,handleSort:E}=ur(j),_=({columnKey:T,children:C,className:A=""})=>{const P=S.key===T?S.direction:null;return s.jsx("th",{className:`fw-semibold ${A}`,onClick:()=>E(T),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{style:{color:"white"},children:C}),s.jsx(pr,{direction:P,className:"ms-1",color:"white"})]})})};return o?s.jsx(zt,{rows:5,columns:7}):u?s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:u})]}):j.length===0?s.jsx("div",{className:"text-center py-5 p-4",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})}):s.jsxs("div",{className:"p-4",children:[s.jsx(oe,{className:"mb-3",children:s.jsx(U,{children:s.jsxs("button",{className:"btn btn-link p-0 text-decoration-none",onClick:()=>r(`${he.DEPARTMENT_MY_DETAILS}/${n}`),style:{color:"var(--bs-primary)"},children:[s.jsx(At,{size:20,className:"me-2"}),"Back to Course Details"]})})}),s.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(U,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(rs,{placeholder:"Search trainees in this subject...",value:m,onChange:f,className:"search-bar-mobile"})}),s.jsx(U,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(ji,{uniqueStatuses:b,selectedStatuses:x,onStatusToggle:y,onClearFilters:w,className:"filter-panel-mobile"})}),s.jsx(U,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[j.length," trainee",j.length!==1?"s":""]})})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(Yt,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(_,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(_,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),s.jsx(_,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(_,{columnKey:"progress",className:"show-mobile",children:"Progress"}),s.jsx(_,{columnKey:"score",className:"hide-mobile",children:"Score"}),s.jsx(_,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:N.map((T,C)=>s.jsxs("tr",{className:`${C%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:A=>{A.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:A=>{A.currentTarget.style.backgroundColor=C%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ft,{size:18,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("h6",{className:"mb-0 fw-medium",children:T.name}),s.jsx("small",{className:"text-muted",children:T.email})]})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:T.employeeId})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("span",{children:T.department})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"d-flex justify-content-between mb-1",children:s.jsxs("span",{className:"fw-medium",children:[T.progress,"%"]})}),s.jsx("div",{className:"progress",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${T.progress}%`}})})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:T.score?s.jsx("span",{className:"fw-bold text-success",children:T.score}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"align-middle show-mobile",children:h(T.status)}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(er,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Jt,{size:16})},items:[{label:"View Details",icon:s.jsx(St,{}),onClick:()=>g(T.id)}]})})]},T.id))})]})})]})},O2=()=>{const{courseId:e,subjectId:t}=gr(),r=Ge(),[a,n]=v.useState("trainees"),[i,l]=v.useState(null),[o,c]=v.useState(!0),[u,d]=v.useState(null);v.useEffect(()=>{(async()=>{try{c(!0),await new Promise(h=>setTimeout(h,1e3)),l({id:t,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols. This module covers essential safety protocols, emergency procedures, and compliance requirements for aviation operations.",duration:2,status:"active",instructor:"Dr. Smith",course:"Aviation Safety Management",courseCode:"ASM-101",startDate:"2024-01-15",endDate:"2024-03-15",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,inProgressTrainees:3,pendingTrainees:2,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(p){d("Failed to load subject details"),console.error("Error fetching subject:",p)}finally{c(!1)}})()},[t]);const m=[{id:"trainees",title:"Trainee List",icon:Ft,component:s.jsx(ode,{subjectId:t,courseId:e})}],f=m.find(x=>x.id===a);return o?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):u?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:u})]})}):i?s.jsxs(_e,{fluid:!0,className:"py-4",children:[s.jsx(oe,{className:"mb-3",children:s.jsx(U,{children:s.jsxs("button",{className:"btn btn-link p-0 text-decoration-none",onClick:()=>r(`${he.DEPARTMENT_MY_DETAILS}/${e}`),style:{color:"var(--bs-primary)"},children:[s.jsx(At,{size:20,className:"me-2"}),"Back to Course Details"]})})}),s.jsx(oe,{className:"mb-4",children:s.jsx(U,{children:s.jsxs(H,{className:"border-0 shadow-sm",children:[s.jsx(H.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:m.map(x=>{const p=x.icon,h=a===x.id;return s.jsxs("button",{className:`custom-tab ${h?"active":""}`,onClick:()=>n(x.id),children:[s.jsx(p,{size:16,className:"me-2"}),x.title]},x.id)})})}),s.jsx(H.Body,{className:"p-0",children:f&&f.component})]})})})]}):s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"warning",children:[s.jsx(ke.Heading,{children:"Subject Not Found"}),s.jsx("p",{children:"The requested subject could not be found."})]})})},cde=()=>{const{traineeId:e}=gr(),t=Ge(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e){i(!1);return}try{i(!0),o(null);const m=await $s.getUserById(e),f=m.data||m,x={id:f.id,eid:f.eid,firstName:f.firstName||"",lastName:f.lastName||"",middleName:f.middleName||"",name:`${f.firstName||""} ${f.middleName||""} ${f.lastName||""}`.trim().replace(/\s+/g," "),email:f.email||"",phoneNumber:f.phoneNumber||"N/A",status:f.status||"ACTIVE",gender:f.gender||"N/A",address:f.address||"N/A",avatarUrl:f.avatarUrl,role:f.role?.name||"N/A",department:f.department?.name||"N/A",departmentId:f.department?.id,dob:f.traineeProfile?.dob,enrollmentDate:f.traineeProfile?.enrollmentDate,trainingBatch:f.traineeProfile?.trainingBatch||"N/A",passportNo:f.traineeProfile?.passportNo||"N/A",nation:f.traineeProfile?.nation||"N/A",createdAt:f.createdAt,updatedAt:f.updatedAt};a(x)}catch(m){console.error("Error fetching trainee details:",m),o("Failed to load trainee details. Please try again later.")}finally{i(!1)}})()},[e]);const c=d=>{const f={ACTIVE:{variant:"success",text:"Active"},INACTIVE:{variant:"secondary",text:"Inactive"},SUSPENDED:{variant:"danger",text:"Suspended"},active:{variant:"success",text:"Active"},inactive:{variant:"secondary",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[d]||{variant:"secondary",text:d||"Unknown"};return s.jsx(Ne,{bg:f.variant,children:f.text})},u=d=>{if(!d)return"N/A";try{return new Date(d).toLocaleDateString()}catch{return d}};return n?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):l?s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"danger",children:[s.jsx(ke.Heading,{children:"Error"}),s.jsx("p",{children:l})]})}):r?s.jsxs(_e,{fluid:!0,className:"py-3 py-md-4 px-3 px-md-4",children:[s.jsx(oe,{className:"mb-3 mb-md-4",children:s.jsx(U,{children:s.jsxs("div",{className:"d-flex align-items-center flex-wrap",children:[s.jsxs("button",{className:"btn btn-link p-0 me-2 me-md-3 mb-2 mb-md-0",onClick:()=>t(-1),"aria-label":"Go back",children:[s.jsx(At,{size:18,className:"d-md-none"}),s.jsx(At,{size:20,className:"d-none d-md-block"})]}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h2",{className:"mb-1 h4 h-md-2",children:r.name}),s.jsxs("p",{className:"text-muted mb-0 small",children:[r.eid,"  ",r.department]})]})]})})}),s.jsx("div",{style:{marginBottom:"4rem"},children:s.jsxs(oe,{className:"g-2 g-md-3",children:[s.jsx(U,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(H,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(H.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Ft,{size:20,className:"text-primary d-md-none"}),s.jsx(Ft,{size:24,className:"text-primary d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Status"}),s.jsx("div",{className:"mt-auto d-flex justify-content-center",children:c(r.status)})]})})}),s.jsx(U,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(H,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(H.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Ls,{size:20,className:"text-info d-md-none"}),s.jsx(Ls,{size:24,className:"text-info d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Department"}),s.jsx("h6",{className:"mb-0 text-info small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:r.department}),s.jsx("h6",{className:"mb-0 text-info d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.department})]})})}),s.jsx(U,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(H,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(H.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(xr,{size:20,className:"text-success d-md-none"}),s.jsx(xr,{size:24,className:"text-success d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Enrollment Date"}),s.jsx("h6",{className:"mb-0 text-success small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:u(r.enrollmentDate)}),s.jsx("h6",{className:"mb-0 text-success d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:u(r.enrollmentDate)})]})})}),s.jsx(U,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(H,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(H.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Do,{size:20,className:"text-warning d-md-none"}),s.jsx(Do,{size:24,className:"text-warning d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Training Batch"}),s.jsx("h6",{className:"mb-0 text-warning small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:r.trainingBatch}),s.jsx("h6",{className:"mb-0 text-warning d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.trainingBatch})]})})})]})}),s.jsxs(oe,{className:"mb-4 g-3 g-md-4 align-items-stretch",children:[s.jsx(U,{xs:12,sm:12,md:6,lg:6,className:"mb-3 mb-md-0 d-flex",children:s.jsxs(H,{className:"border-0 shadow-sm w-100 d-flex flex-column",children:[s.jsx(H.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white h6 h-md-5",children:"Personal Information"})}),s.jsxs(H.Body,{className:"p-3 p-md-4 flex-grow-1",children:[s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Employee ID:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.eid})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Gi,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Email:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1 text-break",children:r.email})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(rS,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Phone Number:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.phoneNumber})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Gender:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.gender})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(xr,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Date of Birth:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:u(r.dob)})]})]}),s.jsxs("div",{className:"mb-0 d-flex align-items-start",children:[s.jsx(Ll,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Address:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1 text-break",children:r.address})]})]})]})]})}),s.jsx(U,{xs:12,sm:12,md:6,lg:6,className:"mb-0 d-flex",children:s.jsxs(H,{className:"border-0 shadow-sm w-100 d-flex flex-column",children:[s.jsx(H.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white h6 h-md-5",children:"Trainee Profile"})}),s.jsxs(H.Body,{className:"p-3 p-md-4 flex-grow-1",children:[s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Ls,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Department:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.department})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Ft,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Role:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.role})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(xr,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Enrollment Date:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:u(r.enrollmentDate)})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Do,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Training Batch:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.trainingBatch})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Do,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Passport No:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.passportNo})]})]}),s.jsxs("div",{className:"mb-0 d-flex align-items-start",children:[s.jsx(Ll,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Nation:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.nation})]})]})]})]})})]})]}):s.jsx(_e,{fluid:!0,className:"py-4",children:s.jsxs(ke,{variant:"warning",children:[s.jsx(ke.Heading,{children:"Trainee Not Found"}),s.jsx("p",{children:"The requested trainee could not be found."})]})})},dde=$4([{path:"/",element:s.jsx(tf,{}),errorElement:s.jsx(_t,{})},{path:"/login",element:s.jsx(tf,{}),errorElement:s.jsx(_t,{})},{path:"/reset-password",element:s.jsx(tR,{}),errorElement:s.jsx(_t,{})},{path:"/profile",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_MY_PROFILE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access your profile."}),children:s.jsx(PH,{})})}]},{path:he.DASHBOARD,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(yl,{})}]},{path:he.USERS,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permissions:[fe.VIEW_ALL_USERS,fe.CREATE_USER,fe.UPDATE_USER,fe.DISABLE_USER,fe.ENABLE_USER],requireAll:!1,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access user management."}),children:s.jsx(dH,{})})}]},{path:he.ROLES,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_ALL_ROLES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access role management."}),children:s.jsx(gH,{})})}]},{path:he.DEPARTMENTS,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_ALL_DEPARTMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department management."}),children:s.jsx(SH,{})})},{path:":id",element:s.jsx(rt,{permission:fe.VIEW_DEPARTMENT_IN_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view department details."}),children:s.jsx(kH,{})})}]},{path:he.TEMPLATES,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_ALL_TEMPLATES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access form templates."}),children:s.jsx(Joe,{})})},{path:"editor",element:s.jsx(rt,{permission:fe.CREATE_TEMPLATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to edit form templates."}),children:s.jsx(ace,{})})},{path:"drafts",element:s.jsx(rt,{permission:fe.CREATE_TEMPLATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view drafts."}),children:s.jsx(nce,{})})}]},{path:he.SYSTEM_CONFIG,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_GLOBAL_FIELDS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access system configuration."}),children:s.jsx(uce,{})})}]},{path:he.MAIN_MENU,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(ice,{})}]},{path:he.COURSES_INSTRUCTED,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_ALL_COURSES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view instructed courses."}),children:s.jsx($ce,{})})}]},{path:he.COURSES_ENROLLED,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view enrolled courses."}),children:s.jsx(Goe,{})})}]},{path:"/courses/:courseId",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_ALL_COURSES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(_2,{})})}]},{path:"/courses/:courseId/enroll-trainees",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(w2,{})}]},{path:"/courses/:courseId/subjects/:subjectId",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_SUBJECT_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:s.jsx(O2,{})})}]},{path:he.ASSESSMENTS_UPCOMING,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view upcoming assessments."}),children:s.jsx(Mce,{})})}]},{path:he.ASSESSMENTS_MY_ASSESSMENTS,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view your assessments."}),children:s.jsx(C2,{})})}]},{path:he.ASSESSMENTS_RESULTS,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment results."}),children:s.jsx(zce,{})})}]},{path:he.ASSESSMENTS_SIGNATURE_REQUIRED,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view signature required list."}),children:s.jsx(hce,{})})}]},{path:he.ASSESSMENTS_COMPLETION_REQUIRED,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:s.jsx(A2,{})})}]},{path:"/assessments/assign/:entityType/:entityId",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view these assessments."}),children:s.jsx(Xh,{})})}]},{path:"/assessments/:assessmentId/sections",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment sections."}),children:s.jsx(k2,{})})}]},{path:"/assessments/sections/:sectionId/fields",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section fields."}),children:s.jsx(D2,{})})}]},{path:he.ASSESSMENT_EVENTS,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENT_EVENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access assessment events."}),children:s.jsx(N2,{})})}]},{path:he.REPORTS_CREATE,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.SUBMIT_REPORT_REQUEST,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to create incident/feedback reports."}),children:s.jsx(jce,{})})}]},{path:he.REPORTS_ISSUES,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ALL_REPORTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access issue list."}),children:s.jsx(wce,{})})}]},{path:he.REPORTS_FEEDBACK,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ALL_REPORTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access feedback list."}),children:s.jsx(Nce,{})})}]},{path:he.TRAINER_CONFIGURE_SIGNATURE,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.UPDATE_MY_PROFILE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to configure signature."}),children:s.jsx(Kce,{})})}]},{path:he.DEPARTMENT_MY_DETAILS,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_DEPARTMENT_IN_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department details."}),children:s.jsx(rde,{})})},{path:":courseId",element:s.jsx(rt,{permission:fe.VIEW_COURSE_IN_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(I2,{})})}]},{path:he.DEPARTMENT_REVIEW_REQUESTS,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access assessment review requests."}),children:s.jsx(Jh,{})})},{path:":requestId",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment request details."}),children:s.jsx(Jh,{})})}]},{path:he.TRAINEE_ACADEMIC_DETAILS,element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view academic details."}),children:s.jsx(Woe,{})})}]},{path:"/admin",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"main-menu",element:s.jsx(Dr,{})},{path:"users",element:s.jsx(Dr,{})},{path:"roles",element:s.jsx(Dr,{})},{path:"departments",element:s.jsx(Dr,{})},{path:"departments/:id",element:s.jsx(Dr,{})},{path:"forms",element:s.jsx(Dr,{})},{path:"forms/editor",element:s.jsx(Dr,{})},{path:"forms/drafts",element:s.jsx(Dr,{})},{path:"system-config",element:s.jsx(Dr,{})}]},{path:"/academic",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"dashboard",element:s.jsx(Wle,{})},{path:"departments",element:s.jsx(RH,{})},{path:"course/:courseId",element:s.jsx(Xle,{})},{path:"course-detail/:courseId",element:s.jsx(goe,{})},{path:"course/:courseId/enroll-trainees",element:s.jsx(w2,{})},{path:"subject/:subjectId",element:s.jsx(y2,{})},{path:"course/:courseId/subject/:subjectId",element:s.jsx(y2,{})},{path:"assessment-events",element:s.jsx(N2,{})}]},{path:"/trainee",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(rt,{permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee portal."}),children:s.jsx(S2,{})})},{path:"dashboard",element:s.jsx(rt,{permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee dashboard."}),children:s.jsx(S2,{})})},{path:":traineeId/course/:courseId",element:s.jsx(rt,{permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee courses."}),children:s.jsx(_oe,{})})},{path:":traineeId/course/:courseId/subject/:subjectId",element:s.jsx(rt,{permission:fe.VIEW_TRAINEE_SUBJECT_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee subjects."}),children:s.jsx(Ooe,{})})},{path:":traineeId/assessments",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee assessments."}),children:s.jsx(Roe,{})})},{path:":traineeId/assessment/:assessmentId",element:s.jsx(rt,{permission:fe.VIEW_ASSESSMENT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment details."}),children:s.jsx(Loe,{})})},{path:":traineeId/signature-pad/:documentId",element:s.jsx(rt,{permission:fe.CONFIRM_TRAINEE_PARTICIPATION,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access signature pad."}),children:s.jsx(Moe,{})})},{path:":traineeId/assessment-section/:sectionId",element:s.jsx(rt,{permission:fe.VIEW_ASSESSMENT_SECTIONS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment sections."}),children:s.jsx(zoe,{})})},{path:"academic-details",element:s.jsx(Dr,{})},{path:"enrolled-courses",element:s.jsx(Dr,{})},{path:"signature-required",element:s.jsx(Dr,{})},{path:"completion-required",element:s.jsx(Dr,{})},{path:"your-assessments",element:s.jsx(Dr,{})},{path:"create-incident-feedback-report",element:s.jsx(Dr,{})},{path:"assessment-pending",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment pending list."}),children:s.jsx(C2,{})})},{path:"assessment-pending/section-completion",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:s.jsx(A2,{})})}]},{path:"/sqa",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"issues",element:s.jsx(Dr,{})},{path:"feedback",element:s.jsx(Dr,{})},{path:"templates",element:s.jsx(rt,{permission:fe.LIST_ALL_REPORTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template list."}),children:s.jsx(Ace,{})})},{path:"templates/:templateId",element:s.jsx(rt,{permission:fe.VIEW_TEMPLATE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template details."}),children:s.jsx(Pce,{})})}]},{path:"/trainer",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"dashboard",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainer portal."}),children:s.jsx(Rce,{})})},{path:"upcoming-assessments",element:s.jsx(Dr,{})},{path:"assessment-results",element:s.jsx(Dr,{})},{path:"instructed-courses",element:s.jsx(Dr,{})},{path:"configure-signature",element:s.jsx(Dr,{})},{path:"assessment-details/:resultId",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment details."}),children:s.jsx(Yce,{})})},{path:"assess/:entityType/:entityId",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view these assessments."}),children:s.jsx(Xh,{})})},{path:"assessments/:assessmentId/sections",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment sections."}),children:s.jsx(k2,{})})},{path:"assessments/sections/:sectionId/fields",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section fields."}),children:s.jsx(D2,{})})},{path:"assess/:entityType/:entityId",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view these assessments."}),children:s.jsx(Xh,{})})},{path:"approval-notes/:resultId",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view approval notes."}),children:s.jsx(Qce,{})})},{path:"courses/:courseId",element:s.jsx(rt,{permission:fe.VIEW_ALL_COURSES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(_2,{})})},{path:"trainees/:traineeId",element:s.jsx(rt,{permission:fe.VIEW_USER_IN_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:s.jsx(Vce,{})})},{path:"subjects/:subjectId",element:s.jsx(rt,{permission:fe.VIEW_SUBJECT_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:s.jsx(qce,{})})}]},{path:"/department-head",element:s.jsx(Wt,{children:s.jsx($t,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(yl,{})},{path:"dashboard",element:s.jsx(rt,{permission:fe.VIEW_DEPARTMENT_IN_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department dashboard."}),children:s.jsx(ede,{})})},{path:"my-department-details",element:s.jsx(Dr,{})},{path:"my-department-details/:courseId",element:s.jsx(rt,{permission:fe.VIEW_COURSE_IN_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(I2,{})})},{path:"assessment-review-requests",element:s.jsx(Dr,{})},{path:"assessment-review-requests/:requestId",element:s.jsx(rt,{permission:fe.LIST_ASSESSMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment request details."}),children:s.jsx(Jh,{})})},{path:"courses/:courseId/subjects/:subjectId",element:s.jsx(rt,{permission:fe.VIEW_SUBJECT_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:s.jsx(O2,{})})},{path:"trainees/:traineeId",element:s.jsx(rt,{permission:fe.VIEW_USER_IN_DETAIL,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:s.jsx(cde,{})})}]},{path:"*",element:s.jsx(tf,{}),errorElement:s.jsx(_t,{})}],{basename:Jx()});function ude(){return v.useEffect(()=>{(()=>{const t=window.location;if(t.hostname.includes("github.io")&&t.search.includes("?/")){const r=t.search,a=t.hash,n=r.match(/\?\/(.+?)(?:&|$)/);if(n){const l=`/${n[1].replace(/~and~/g,"&")}${a}`;window.history.replaceState(null,"",l)}}})()},[]),s.jsxs(H6,{children:[s.jsx(W4,{router:dde}),s.jsx(B6,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}G4.createRoot(document.getElementById("root")).render(s.jsx(v.StrictMode,{children:s.jsx(ude,{})}));
