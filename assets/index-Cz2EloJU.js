import{P as F,j as s,B as te,N as Xe,a as B1,T as ar,C as Ce,D as St,b as W,A as De,S as ct,I as z1,F as k,M as ce,R as de,c as H,O as O2,d as P2,e as ke,L as _a,f as F5,g as $t,h as R2,i as Xh}from"./bootstrap-36CUpx7I.js";import{r as v,R as Q,u as ya,b as tt,L as sd,O as L5,c as M5,d as Fx,N as B5,e as el,f as ur,g as z5,h as $5,i as U5}from"./router-C6Ic_n8-.js";import{a as W5,g as mi,r as Lx}from"./vendor-D3F3s8fL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var ad={},$1;function H5(){if($1)return ad;$1=1;var e=W5();return ad.createRoot=e.createRoot,ad.hydrateRoot=e.hydrateRoot,ad}var V5=H5(),G5=["color","size","title","className"];function Jh(){return Jh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Jh.apply(null,arguments)}function q5(e,t){if(e==null)return{};var r,a,n=K5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function K5(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var F2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=q5(e,G5);return Q.createElement("svg",Jh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-airplane",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"}))});F2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var Y5=["color","size","title","className"];function Zh(){return Zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Zh.apply(null,arguments)}function X5(e,t){if(e==null)return{};var r,a,n=J5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function J5(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var L2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=X5(e,Y5);return Q.createElement("svg",Zh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-archive",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}))});L2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var Z5=["color","size","title","className"];function Qh(){return Qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Qh.apply(null,arguments)}function Q5(e,t){if(e==null)return{};var r,a,n=e4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function e4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var M2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Q5(e,Z5);return Q.createElement("svg",Qh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-clockwise",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),Q.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"}))});M2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var t4=["color","size","title","className"];function e0(){return e0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},e0.apply(null,arguments)}function r4(e,t){if(e==null)return{};var r,a,n=s4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function s4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var t0=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=r4(e,t4);return Q.createElement("svg",e0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-down",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"}))});t0.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var a4=["color","size","title","className"];function r0(){return r0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},r0.apply(null,arguments)}function n4(e,t){if(e==null)return{};var r,a,n=i4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function i4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var At=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=n4(e,a4);return Q.createElement("svg",r0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-left",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"}))});At.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var o4=["color","size","title","className"];function s0(){return s0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},s0.apply(null,arguments)}function l4(e,t){if(e==null)return{};var r,a,n=c4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function c4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var un=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=l4(e,o4);return Q.createElement("svg",s0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-arrow-right",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"}))});un.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var d4=["color","size","title","className"];function a0(){return a0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},a0.apply(null,arguments)}function u4(e,t){if(e==null)return{};var r,a,n=m4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function m4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var B2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=u4(e,d4);return Q.createElement("svg",a0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-award",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702z"}),Q.createElement("path",{d:"M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"}))});B2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var f4=["color","size","title","className"];function n0(){return n0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},n0.apply(null,arguments)}function h4(e,t){if(e==null)return{};var r,a,n=p4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function p4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var z2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=h4(e,f4);return Q.createElement("svg",n0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-ban",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M15 8a6.97 6.97 0 0 0-1.71-4.584l-9.874 9.875A7 7 0 0 0 15 8M2.71 12.584l9.874-9.875a7 7 0 0 0-9.874 9.874ZM16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0"}))});z2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var x4=["color","size","title","className"];function i0(){return i0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},i0.apply(null,arguments)}function g4(e,t){if(e==null)return{};var r,a,n=v4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function v4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Bd=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=g4(e,x4);return Q.createElement("svg",i0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-bar-chart",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M4 11H2v3h2zm5-4H7v7h2zm5-5v12h-2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1z"}))});Bd.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var y4=["color","size","title","className"];function o0(){return o0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},o0.apply(null,arguments)}function b4(e,t){if(e==null)return{};var r,a,n=j4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function j4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Dt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=b4(e,y4);return Q.createElement("svg",o0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-book",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"}))});Dt.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var w4=["color","size","title","className"];function l0(){return l0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},l0.apply(null,arguments)}function N4(e,t){if(e==null)return{};var r,a,n=S4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function S4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var c0=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=N4(e,w4);return Q.createElement("svg",l0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-box-arrow-right",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),Q.createElement("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"}))});c0.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var E4=["color","size","title","className"];function d0(){return d0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},d0.apply(null,arguments)}function T4(e,t){if(e==null)return{};var r,a,n=C4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function C4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Vs=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=T4(e,E4);return Q.createElement("svg",d0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-building",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"}),Q.createElement("path",{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"}))});Vs.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var A4=["color","size","title","className"];function u0(){return u0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},u0.apply(null,arguments)}function _4(e,t){if(e==null)return{};var r,a,n=k4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function k4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var fa=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=_4(e,A4);return Q.createElement("svg",u0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-calendar-event",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),Q.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});fa.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var D4=["color","size","title","className"];function m0(){return m0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},m0.apply(null,arguments)}function I4(e,t){if(e==null)return{};var r,a,n=O4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var or=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=I4(e,D4);return Q.createElement("svg",m0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-calendar",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});or.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var P4=["color","size","title","className"];function f0(){return f0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},f0.apply(null,arguments)}function R4(e,t){if(e==null)return{};var r,a,n=F4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function F4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var $2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=R4(e,P4);return Q.createElement("svg",f0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chat-dots",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}),Q.createElement("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"}))});$2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var L4=["color","size","title","className"];function h0(){return h0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},h0.apply(null,arguments)}function M4(e,t){if(e==null)return{};var r,a,n=B4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function B4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var U2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=M4(e,L4);return Q.createElement("svg",h0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-circle-fill",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"}))});U2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var z4=["color","size","title","className"];function p0(){return p0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},p0.apply(null,arguments)}function $4(e,t){if(e==null)return{};var r,a,n=U4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function U4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Je=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=$4(e,z4);return Q.createElement("svg",p0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-circle",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Q.createElement("path",{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"}))});Je.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var W4=["color","size","title","className"];function x0(){return x0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},x0.apply(null,arguments)}function H4(e,t){if(e==null)return{};var r,a,n=V4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function V4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var W2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=H4(e,W4);return Q.createElement("svg",x0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-check-square",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),Q.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});W2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var G4=["color","size","title","className"];function g0(){return g0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},g0.apply(null,arguments)}function q4(e,t){if(e==null)return{};var r,a,n=K4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function K4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ai=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=q4(e,G4);return Q.createElement("svg",g0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-down",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"}))});ai.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var Y4=["color","size","title","className"];function v0(){return v0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},v0.apply(null,arguments)}function X4(e,t){if(e==null)return{};var r,a,n=J4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function J4(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Xu=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=X4(e,Y4);return Q.createElement("svg",v0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-right",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"}))});Xu.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var Z4=["color","size","title","className"];function y0(){return y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},y0.apply(null,arguments)}function Q4(e,t){if(e==null)return{};var r,a,n=eD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function eD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var H2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Q4(e,Z4);return Q.createElement("svg",y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-chevron-up",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"}))});H2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var tD=["color","size","title","className"];function b0(){return b0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},b0.apply(null,arguments)}function rD(e,t){if(e==null)return{};var r,a,n=sD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function sD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var rr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=rD(e,tD);return Q.createElement("svg",b0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clipboard-check",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),Q.createElement("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"}),Q.createElement("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"}))});rr.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var aD=["color","size","title","className"];function j0(){return j0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},j0.apply(null,arguments)}function nD(e,t){if(e==null)return{};var r,a,n=iD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function iD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var V2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=nD(e,aD);return Q.createElement("svg",j0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clock-history",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"}),Q.createElement("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"}),Q.createElement("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"}))});V2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var oD=["color","size","title","className"];function w0(){return w0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},w0.apply(null,arguments)}function lD(e,t){if(e==null)return{};var r,a,n=cD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ke=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=lD(e,oD);return Q.createElement("svg",w0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-clock",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"}),Q.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"}))});Ke.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var dD=["color","size","title","className"];function N0(){return N0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},N0.apply(null,arguments)}function uD(e,t){if(e==null)return{};var r,a,n=mD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var fi=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=uD(e,dD);return Q.createElement("svg",N0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-download",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),Q.createElement("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"}))});fi.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var fD=["color","size","title","className"];function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},S0.apply(null,arguments)}function hD(e,t){if(e==null)return{};var r,a,n=pD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Vi=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=hD(e,fD);return Q.createElement("svg",S0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-envelope",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"}))});Vi.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var xD=["color","size","title","className"];function E0(){return E0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},E0.apply(null,arguments)}function gD(e,t){if(e==null)return{};var r,a,n=vD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Jt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=gD(e,xD);return Q.createElement("svg",E0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-exclamation-triangle",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),Q.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});Jt.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var yD=["color","size","title","className"];function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},T0.apply(null,arguments)}function bD(e,t){if(e==null)return{};var r,a,n=jD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function jD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Yl=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=bD(e,yD);return Q.createElement("svg",T0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-eye-slash",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"}),Q.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"}),Q.createElement("path",{d:"M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"}))});Yl.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var wD=["color","size","title","className"];function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},C0.apply(null,arguments)}function ND(e,t){if(e==null)return{};var r,a,n=SD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function SD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Bt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=ND(e,wD);return Q.createElement("svg",C0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-eye",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),Q.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"}))});Bt.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var ED=["color","size","title","className"];function A0(){return A0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},A0.apply(null,arguments)}function TD(e,t){if(e==null)return{};var r,a,n=CD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function CD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Fo=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=TD(e,ED);return Q.createElement("svg",A0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-excel",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"}),Q.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}))});Fo.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var AD=["color","size","title","className"];function _0(){return _0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},_0.apply(null,arguments)}function _D(e,t){if(e==null)return{};var r,a,n=kD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function kD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tl=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=_D(e,AD);return Q.createElement("svg",_0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-pdf",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),Q.createElement("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"}))});tl.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var DD=["color","size","title","className"];function k0(){return k0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},k0.apply(null,arguments)}function ID(e,t){if(e==null)return{};var r,a,n=OD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var G2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=ID(e,DD);return Q.createElement("svg",k0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-plus",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 6.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V11a.5.5 0 0 1-1 0V9.5H6a.5.5 0 0 1 0-1h1.5V7a.5.5 0 0 1 .5-.5"}),Q.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});G2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var PD=["color","size","title","className"];function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},D0.apply(null,arguments)}function RD(e,t){if(e==null)return{};var r,a,n=FD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ju=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=RD(e,PD);return Q.createElement("svg",D0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark-text",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"}),Q.createElement("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"}))});Ju.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var LD=["color","size","title","className"];function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},I0.apply(null,arguments)}function MD(e,t){if(e==null)return{};var r,a,n=BD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function BD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ni=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=MD(e,LD);return Q.createElement("svg",I0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-earmark",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});ni.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var zD=["color","size","title","className"];function O0(){return O0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},O0.apply(null,arguments)}function $D(e,t){if(e==null)return{};var r,a,n=UD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function UD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var q2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=$D(e,zD);return Q.createElement("svg",O0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-text-fill",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"}))});q2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var WD=["color","size","title","className"];function P0(){return P0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},P0.apply(null,arguments)}function HD(e,t){if(e==null)return{};var r,a,n=VD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function VD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var xt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=HD(e,WD);return Q.createElement("svg",P0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-file-text",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),Q.createElement("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"}))});xt.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var GD=["color","size","title","className"];function R0(){return R0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},R0.apply(null,arguments)}function qD(e,t){if(e==null)return{};var r,a,n=KD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function KD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var oo=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=qD(e,GD);return Q.createElement("svg",R0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-funnel",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"}))});oo.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var YD=["color","size","title","className"];function F0(){return F0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},F0.apply(null,arguments)}function XD(e,t){if(e==null)return{};var r,a,n=JD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function JD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Mx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=XD(e,YD);return Q.createElement("svg",F0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-gear",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),Q.createElement("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"}))});Mx.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var ZD=["color","size","title","className"];function L0(){return L0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},L0.apply(null,arguments)}function QD(e,t){if(e==null)return{};var r,a,n=eI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function eI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Lo=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=QD(e,ZD);return Q.createElement("svg",L0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-geo-alt",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"}),Q.createElement("path",{d:"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});Lo.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var tI=["color","size","title","className"];function M0(){return M0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},M0.apply(null,arguments)}function rI(e,t){if(e==null)return{};var r,a,n=sI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function sI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var K2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=rI(e,tI);return Q.createElement("svg",M0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-house",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"}))});K2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var aI=["color","size","title","className"];function B0(){return B0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},B0.apply(null,arguments)}function nI(e,t){if(e==null)return{};var r,a,n=iI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function iI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Y2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=nI(e,aI);return Q.createElement("svg",B0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-info-circle",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Q.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});Y2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var oI=["color","size","title","className"];function z0(){return z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},z0.apply(null,arguments)}function lI(e,t){if(e==null)return{};var r,a,n=cI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var zd=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=lI(e,oI);return Q.createElement("svg",z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-journal-text",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}),Q.createElement("path",{d:"M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2"}),Q.createElement("path",{d:"M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1z"}))});zd.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var dI=["color","size","title","className"];function $0(){return $0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},$0.apply(null,arguments)}function uI(e,t){if(e==null)return{};var r,a,n=mI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Xl=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=uI(e,dI);return Q.createElement("svg",$0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-key",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),Q.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});Xl.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var fI=["color","size","title","className"];function U0(){return U0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},U0.apply(null,arguments)}function hI(e,t){if(e==null)return{};var r,a,n=pI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var X2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=hI(e,fI);return Q.createElement("svg",U0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list-check",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3.854 2.146a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 3.293l1.146-1.147a.5.5 0 0 1 .708 0m0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 7.293l1.146-1.147a.5.5 0 0 1 .708 0m0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0"}))});X2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var xI=["color","size","title","className"];function W0(){return W0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},W0.apply(null,arguments)}function gI(e,t){if(e==null)return{};var r,a,n=vI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var J2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=gI(e,xI);return Q.createElement("svg",W0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list-ul",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});J2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var yI=["color","size","title","className"];function H0(){return H0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},H0.apply(null,arguments)}function bI(e,t){if(e==null)return{};var r,a,n=jI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function jI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Xd=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=bI(e,yI);return Q.createElement("svg",H0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-list",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"}))});Xd.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var wI=["color","size","title","className"];function V0(){return V0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},V0.apply(null,arguments)}function NI(e,t){if(e==null)return{};var r,a,n=SI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function SI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Il=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=NI(e,wI);return Q.createElement("svg",V0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-passport",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 5a3 3 0 1 0 0 6 3 3 0 0 0 0-6M6 8a2 2 0 1 1 4 0 2 2 0 0 1-4 0m-.5 4a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1z"}),Q.createElement("path",{d:"M3.232 1.776A1.5 1.5 0 0 0 2 3.252v10.95c0 .445.191.838.49 1.11.367.422.908.688 1.51.688h8a2 2 0 0 0 2-2V4a2 2 0 0 0-1-1.732v-.47A1.5 1.5 0 0 0 11.232.321l-8 1.454ZM4 3h8a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1"}))});Il.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var EI=["color","size","title","className"];function G0(){return G0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},G0.apply(null,arguments)}function TI(e,t){if(e==null)return{};var r,a,n=CI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function CI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Gi=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=TI(e,EI);return Q.createElement("svg",G0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pen",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))});Gi.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var AI=["color","size","title","className"];function q0(){return q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},q0.apply(null,arguments)}function _I(e,t){if(e==null)return{};var r,a,n=kI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function kI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Bx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=_I(e,AI);return Q.createElement("svg",q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pencil-square",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),Q.createElement("path",{fillRule:"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"}))});Bx.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var DI=["color","size","title","className"];function K0(){return K0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},K0.apply(null,arguments)}function II(e,t){if(e==null)return{};var r,a,n=OI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Yr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=II(e,DI);return Q.createElement("svg",K0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pencil",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"}))});Yr.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var PI=["color","size","title","className"];function Y0(){return Y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Y0.apply(null,arguments)}function RI(e,t){if(e==null)return{};var r,a,n=FI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Mr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=RI(e,PI);return Q.createElement("svg",Y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-people",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"}))});Mr.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var LI=["color","size","title","className"];function X0(){return X0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},X0.apply(null,arguments)}function MI(e,t){if(e==null)return{};var r,a,n=BI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function BI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Z2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=MI(e,LI);return Q.createElement("svg",X0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-check-fill",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{fillRule:"evenodd",d:"M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"}),Q.createElement("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});Z2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var zI=["color","size","title","className"];function J0(){return J0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},J0.apply(null,arguments)}function $I(e,t){if(e==null)return{};var r,a,n=UI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function UI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var _n=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=$I(e,zI);return Q.createElement("svg",J0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-check",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),Q.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});_n.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var WI=["color","size","title","className"];function Z0(){return Z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Z0.apply(null,arguments)}function HI(e,t){if(e==null)return{};var r,a,n=VI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function VI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var To=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=HI(e,WI);return Q.createElement("svg",Z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-circle",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),Q.createElement("path",{fillRule:"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"}))});To.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var GI=["color","size","title","className"];function Q0(){return Q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Q0.apply(null,arguments)}function qI(e,t){if(e==null)return{};var r,a,n=KI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function KI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Sc=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=qI(e,GI);return Q.createElement("svg",Q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person-x",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m.256 7a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}),Q.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708"}))});Sc.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var YI=["color","size","title","className"];function ep(){return ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ep.apply(null,arguments)}function XI(e,t){if(e==null)return{};var r,a,n=JI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function JI(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Pt=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=XI(e,YI);return Q.createElement("svg",ep({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-person",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}))});Pt.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var ZI=["color","size","title","className"];function tp(){return tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},tp.apply(null,arguments)}function QI(e,t){if(e==null)return{};var r,a,n=eO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function eO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Q2=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=QI(e,ZI);return Q.createElement("svg",tp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-phone",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),Q.createElement("path",{d:"M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}))});Q2.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var tO=["color","size","title","className"];function rp(){return rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},rp.apply(null,arguments)}function rO(e,t){if(e==null)return{};var r,a,n=sO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function sO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var eS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=rO(e,tO);return Q.createElement("svg",rp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-pie-chart",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M7.5 1.018a7 7 0 0 0-4.79 11.566L7.5 7.793zm1 0V7.5h6.482A7 7 0 0 0 8.5 1.018M14.982 8.5H8.207l-4.79 4.79A7 7 0 0 0 14.982 8.5M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8"}))});eS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var aO=["color","size","title","className"];function sp(){return sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},sp.apply(null,arguments)}function nO(e,t){if(e==null)return{};var r,a,n=iO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function iO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ap=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=nO(e,aO);return Q.createElement("svg",sp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-play-circle",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Q.createElement("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"}))});ap.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var oO=["color","size","title","className"];function np(){return np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},np.apply(null,arguments)}function lO(e,t){if(e==null)return{};var r,a,n=cO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var zx=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=lO(e,oO);return Q.createElement("svg",np({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-play",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"}))});zx.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var dO=["color","size","title","className"];function ip(){return ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ip.apply(null,arguments)}function uO(e,t){if(e==null)return{};var r,a,n=mO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var $x=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=uO(e,dO);return Q.createElement("svg",ip({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-plus-circle",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Q.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});$x.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var fO=["color","size","title","className"];function op(){return op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},op.apply(null,arguments)}function hO(e,t){if(e==null)return{};var r,a,n=pO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Gr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=hO(e,fO);return Q.createElement("svg",op({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-plus",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});Gr.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var xO=["color","size","title","className"];function lp(){return lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},lp.apply(null,arguments)}function gO(e,t){if(e==null)return{};var r,a,n=vO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var tS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=gO(e,xO);return Q.createElement("svg",lp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-question-circle",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Q.createElement("path",{d:"M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286m1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94"}))});tS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var yO=["color","size","title","className"];function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},cp.apply(null,arguments)}function bO(e,t){if(e==null)return{};var r,a,n=jO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function jO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var us=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=bO(e,yO);return Q.createElement("svg",cp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-save",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z"}))});us.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var wO=["color","size","title","className"];function dp(){return dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},dp.apply(null,arguments)}function NO(e,t){if(e==null)return{};var r,a,n=SO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function SO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var rS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=NO(e,wO);return Q.createElement("svg",dp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-search",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))});rS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var EO=["color","size","title","className"];function up(){return up=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},up.apply(null,arguments)}function TO(e,t){if(e==null)return{};var r,a,n=CO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function CO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var sS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=TO(e,EO);return Q.createElement("svg",up({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-send",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"}))});sS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var AO=["color","size","title","className"];function mp(){return mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},mp.apply(null,arguments)}function _O(e,t){if(e==null)return{};var r,a,n=kO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function kO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var aS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=_O(e,AO);return Q.createElement("svg",mp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-shield-x",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}),Q.createElement("path",{d:"M6.146 5.146a.5.5 0 0 1 .708 0L8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 0 1 0-.708"}))});aS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var DO=["color","size","title","className"];function fp(){return fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},fp.apply(null,arguments)}function IO(e,t){if(e==null)return{};var r,a,n=OO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ux=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=IO(e,DO);return Q.createElement("svg",fp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-shield",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}))});Ux.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var PO=["color","size","title","className"];function hp(){return hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hp.apply(null,arguments)}function RO(e,t){if(e==null)return{};var r,a,n=FO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function FO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var nS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=RO(e,PO);return Q.createElement("svg",hp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-square",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}))});nS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var LO=["color","size","title","className"];function pp(){return pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pp.apply(null,arguments)}function MO(e,t){if(e==null)return{};var r,a,n=BO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function BO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var iS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=MO(e,LO);return Q.createElement("svg",pp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-star",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"}))});iS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var zO=["color","size","title","className"];function xp(){return xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},xp.apply(null,arguments)}function $O(e,t){if(e==null)return{};var r,a,n=UO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function UO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ar=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=$O(e,zO);return Q.createElement("svg",xp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-three-dots-vertical",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}))});Ar.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var WO=["color","size","title","className"];function gp(){return gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gp.apply(null,arguments)}function HO(e,t){if(e==null)return{};var r,a,n=VO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function VO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Fa=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=HO(e,WO);return Q.createElement("svg",gp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-trash",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),Q.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});Fa.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var GO=["color","size","title","className"];function vp(){return vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},vp.apply(null,arguments)}function qO(e,t){if(e==null)return{};var r,a,n=KO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function KO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var oS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=qO(e,GO);return Q.createElement("svg",vp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-trophy",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"}))});oS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var YO=["color","size","title","className"];function yp(){return yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},yp.apply(null,arguments)}function XO(e,t){if(e==null)return{};var r,a,n=JO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function JO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var js=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=XO(e,YO);return Q.createElement("svg",yp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-upload",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),Q.createElement("path",{d:"M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"}))});js.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var ZO=["color","size","title","className"];function bp(){return bp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},bp.apply(null,arguments)}function QO(e,t){if(e==null)return{};var r,a,n=e3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function e3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var lS=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=QO(e,ZO);return Q.createElement("svg",bp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x-circle-fill",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"}))});lS.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var t3=["color","size","title","className"];function jp(){return jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jp.apply(null,arguments)}function r3(e,t){if(e==null)return{};var r,a,n=s3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function s3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Qr=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=r3(e,t3);return Q.createElement("svg",jp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x-circle",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Q.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});Qr.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};var a3=["color","size","title","className"];function wp(){return wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},wp.apply(null,arguments)}function n3(e,t){if(e==null)return{};var r,a,n=i3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function i3(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var st=v.forwardRef(function(e,t){var r=e.color,a=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=n3(e,a3);return Q.createElement("svg",wp({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:a,className:["bi","bi-x",d].filter(Boolean).join(" ")},u),l?Q.createElement("title",null,l):null,Q.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});st.propTypes={color:F.string,size:F.oneOfType([F.string,F.number]),title:F.string,className:F.string};const o3="/dsfms-template/assets/logo-light-BjNHVeeQ.png";function cS(e,t){return function(){return e.apply(t,arguments)}}const{toString:l3}=Object.prototype,{getPrototypeOf:Wx}=Object,{iterator:Zu,toStringTag:dS}=Symbol,Qu=(e=>t=>{const r=l3.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ja=e=>(e=e.toLowerCase(),t=>Qu(t)===e),em=e=>t=>typeof t===e,{isArray:rl}=Array,Mo=em("undefined");function Ec(e){return e!==null&&!Mo(e)&&e.constructor!==null&&!Mo(e.constructor)&&Qs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const uS=Ja("ArrayBuffer");function c3(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&uS(e.buffer),t}const d3=em("string"),Qs=em("function"),mS=em("number"),Tc=e=>e!==null&&typeof e=="object",u3=e=>e===!0||e===!1,$d=e=>{if(Qu(e)!=="object")return!1;const t=Wx(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(dS in e)&&!(Zu in e)},m3=e=>{if(!Tc(e)||Ec(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},f3=Ja("Date"),h3=Ja("File"),p3=Ja("Blob"),x3=Ja("FileList"),g3=e=>Tc(e)&&Qs(e.pipe),v3=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Qs(e.append)&&((t=Qu(e))==="formdata"||t==="object"&&Qs(e.toString)&&e.toString()==="[object FormData]"))},y3=Ja("URLSearchParams"),[b3,j3,w3,N3]=["ReadableStream","Request","Response","Headers"].map(Ja),S3=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Cc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),rl(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{if(Ec(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(a=0;a<o;a++)l=i[a],t.call(null,e[l],l,e)}}function fS(e,t){if(Ec(e))return null;t=t.toLowerCase();const r=Object.keys(e);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const _i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,hS=e=>!Mo(e)&&e!==_i;function Np(){const{caseless:e,skipUndefined:t}=hS(this)&&this||{},r={},a=(n,i)=>{const o=e&&fS(r,i)||i;$d(r[o])&&$d(n)?r[o]=Np(r[o],n):$d(n)?r[o]=Np({},n):rl(n)?r[o]=n.slice():(!t||!Mo(n))&&(r[o]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Cc(arguments[n],a);return r}const E3=(e,t,r,{allOwnKeys:a}={})=>(Cc(t,(n,i)=>{r&&Qs(n)?e[i]=cS(n,r):e[i]=n},{allOwnKeys:a}),e),T3=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),C3=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},A3=(e,t,r,a)=>{let n,i,o;const l={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)o=n[i],(!a||a(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&Wx(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},_3=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},k3=e=>{if(!e)return null;if(rl(e))return e;let t=e.length;if(!mS(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},D3=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Wx(Uint8Array)),I3=(e,t)=>{const a=(e&&e[Zu]).call(e);let n;for(;(n=a.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},O3=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},P3=Ja("HTMLFormElement"),R3=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),U1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),F3=Ja("RegExp"),pS=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};Cc(r,(n,i)=>{let o;(o=t(n,i,e))!==!1&&(a[i]=o||n)}),Object.defineProperties(e,a)},L3=e=>{pS(e,(t,r)=>{if(Qs(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(Qs(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},M3=(e,t)=>{const r={},a=n=>{n.forEach(i=>{r[i]=!0})};return rl(e)?a(e):a(String(e).split(t)),r},B3=()=>{},z3=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function $3(e){return!!(e&&Qs(e.append)&&e[dS]==="FormData"&&e[Zu])}const U3=e=>{const t=new Array(10),r=(a,n)=>{if(Tc(a)){if(t.indexOf(a)>=0)return;if(Ec(a))return a;if(!("toJSON"in a)){t[n]=a;const i=rl(a)?[]:{};return Cc(a,(o,l)=>{const c=r(o,n+1);!Mo(c)&&(i[l]=c)}),t[n]=void 0,i}}return a};return r(e,0)},W3=Ja("AsyncFunction"),H3=e=>e&&(Tc(e)||Qs(e))&&Qs(e.then)&&Qs(e.catch),xS=((e,t)=>e?setImmediate:t?((r,a)=>(_i.addEventListener("message",({source:n,data:i})=>{n===_i&&i===r&&a.length&&a.shift()()},!1),n=>{a.push(n),_i.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Qs(_i.postMessage)),V3=typeof queueMicrotask<"u"?queueMicrotask.bind(_i):typeof process<"u"&&process.nextTick||xS,G3=e=>e!=null&&Qs(e[Zu]),Ee={isArray:rl,isArrayBuffer:uS,isBuffer:Ec,isFormData:v3,isArrayBufferView:c3,isString:d3,isNumber:mS,isBoolean:u3,isObject:Tc,isPlainObject:$d,isEmptyObject:m3,isReadableStream:b3,isRequest:j3,isResponse:w3,isHeaders:N3,isUndefined:Mo,isDate:f3,isFile:h3,isBlob:p3,isRegExp:F3,isFunction:Qs,isStream:g3,isURLSearchParams:y3,isTypedArray:D3,isFileList:x3,forEach:Cc,merge:Np,extend:E3,trim:S3,stripBOM:T3,inherits:C3,toFlatObject:A3,kindOf:Qu,kindOfTest:Ja,endsWith:_3,toArray:k3,forEachEntry:I3,matchAll:O3,isHTMLForm:P3,hasOwnProperty:U1,hasOwnProp:U1,reduceDescriptors:pS,freezeMethods:L3,toObjectSet:M3,toCamelCase:R3,noop:B3,toFiniteNumber:z3,findKey:fS,global:_i,isContextDefined:hS,isSpecCompliantForm:$3,toJSONObject:U3,isAsyncFn:W3,isThenable:H3,setImmediate:xS,asap:V3,isIterable:G3};function Et(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}Ee.inherits(Et,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ee.toJSONObject(this.config),code:this.code,status:this.status}}});const gS=Et.prototype,vS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{vS[e]={value:e}});Object.defineProperties(Et,vS);Object.defineProperty(gS,"isAxiosError",{value:!0});Et.from=(e,t,r,a,n,i)=>{const o=Object.create(gS);Ee.toFlatObject(e,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Et.call(o,l,c,r,a,n),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const q3=null;function Sp(e){return Ee.isPlainObject(e)||Ee.isArray(e)}function yS(e){return Ee.endsWith(e,"[]")?e.slice(0,-2):e}function W1(e,t,r){return e?e.concat(t).map(function(n,i){return n=yS(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function K3(e){return Ee.isArray(e)&&!e.some(Sp)}const Y3=Ee.toFlatObject(Ee,{},null,function(t){return/^is[A-Z]/.test(t)});function tm(e,t,r){if(!Ee.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Ee.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,g){return!Ee.isUndefined(g[x])});const a=r.metaTokens,n=r.visitor||u,i=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Ee.isSpecCompliantForm(t);if(!Ee.isFunction(n))throw new TypeError("visitor must be a function");function d(p){if(p===null)return"";if(Ee.isDate(p))return p.toISOString();if(Ee.isBoolean(p))return p.toString();if(!c&&Ee.isBlob(p))throw new Et("Blob is not supported. Use a Buffer instead.");return Ee.isArrayBuffer(p)||Ee.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,x,g){let b=p;if(p&&!g&&typeof p=="object"){if(Ee.endsWith(x,"{}"))x=a?x:x.slice(0,-2),p=JSON.stringify(p);else if(Ee.isArray(p)&&K3(p)||(Ee.isFileList(p)||Ee.endsWith(x,"[]"))&&(b=Ee.toArray(p)))return x=yS(x),b.forEach(function(y,w){!(Ee.isUndefined(y)||y===null)&&t.append(o===!0?W1([x],w,i):o===null?x:x+"[]",d(y))}),!1}return Sp(p)?!0:(t.append(W1(g,x,i),d(p)),!1)}const m=[],f=Object.assign(Y3,{defaultVisitor:u,convertValue:d,isVisitable:Sp});function h(p,x){if(!Ee.isUndefined(p)){if(m.indexOf(p)!==-1)throw Error("Circular reference detected in "+x.join("."));m.push(p),Ee.forEach(p,function(b,j){(!(Ee.isUndefined(b)||b===null)&&n.call(t,b,Ee.isString(j)?j.trim():j,x,f))===!0&&h(b,x?x.concat(j):[j])}),m.pop()}}if(!Ee.isObject(e))throw new TypeError("data must be an object");return h(e),t}function H1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Hx(e,t){this._pairs=[],e&&tm(e,this,t)}const bS=Hx.prototype;bS.append=function(t,r){this._pairs.push([t,r])};bS.toString=function(t){const r=t?function(a){return t.call(this,a,H1)}:H1;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function X3(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function jS(e,t,r){if(!t)return e;const a=r&&r.encode||X3;Ee.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=Ee.isURLSearchParams(t)?t.toString():new Hx(t,r).toString(a),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class V1{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ee.forEach(this.handlers,function(a){a!==null&&t(a)})}}const wS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},J3=typeof URLSearchParams<"u"?URLSearchParams:Hx,Z3=typeof FormData<"u"?FormData:null,Q3=typeof Blob<"u"?Blob:null,eP={isBrowser:!0,classes:{URLSearchParams:J3,FormData:Z3,Blob:Q3},protocols:["http","https","file","blob","url","data"]},Vx=typeof window<"u"&&typeof document<"u",Ep=typeof navigator=="object"&&navigator||void 0,tP=Vx&&(!Ep||["ReactNative","NativeScript","NS"].indexOf(Ep.product)<0),rP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",sP=Vx&&window.location.href||"http://localhost",aP=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Vx,hasStandardBrowserEnv:tP,hasStandardBrowserWebWorkerEnv:rP,navigator:Ep,origin:sP},Symbol.toStringTag,{value:"Module"})),Os={...aP,...eP};function nP(e,t){return tm(e,new Os.classes.URLSearchParams,{visitor:function(r,a,n,i){return Os.isNode&&Ee.isBuffer(r)?(this.append(a,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function iP(e){return Ee.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function oP(e){const t={},r=Object.keys(e);let a;const n=r.length;let i;for(a=0;a<n;a++)i=r[a],t[i]=e[i];return t}function NS(e){function t(r,a,n,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=r.length;return o=!o&&Ee.isArray(n)?n.length:o,c?(Ee.hasOwnProp(n,o)?n[o]=[n[o],a]:n[o]=a,!l):((!n[o]||!Ee.isObject(n[o]))&&(n[o]=[]),t(r,a,n[o],i)&&Ee.isArray(n[o])&&(n[o]=oP(n[o])),!l)}if(Ee.isFormData(e)&&Ee.isFunction(e.entries)){const r={};return Ee.forEachEntry(e,(a,n)=>{t(iP(a),n,r,0)}),r}return null}function lP(e,t,r){if(Ee.isString(e))try{return(t||JSON.parse)(e),Ee.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const Ac={transitional:wS,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,i=Ee.isObject(t);if(i&&Ee.isHTMLForm(t)&&(t=new FormData(t)),Ee.isFormData(t))return n?JSON.stringify(NS(t)):t;if(Ee.isArrayBuffer(t)||Ee.isBuffer(t)||Ee.isStream(t)||Ee.isFile(t)||Ee.isBlob(t)||Ee.isReadableStream(t))return t;if(Ee.isArrayBufferView(t))return t.buffer;if(Ee.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return nP(t,this.formSerializer).toString();if((l=Ee.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return tm(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),lP(t)):t}],transformResponse:[function(t){const r=this.transitional||Ac.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Ee.isResponse(t)||Ee.isReadableStream(t))return t;if(t&&Ee.isString(t)&&(a&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Et.from(l,Et.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Os.classes.FormData,Blob:Os.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ee.forEach(["delete","get","head","post","put","patch"],e=>{Ac.headers[e]={}});const cP=Ee.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),dP=e=>{const t={};let r,a,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),a=o.substring(n+1).trim(),!(!r||t[r]&&cP[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},G1=Symbol("internals");function bl(e){return e&&String(e).trim().toLowerCase()}function Ud(e){return e===!1||e==null?e:Ee.isArray(e)?e.map(Ud):String(e)}function uP(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const mP=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Km(e,t,r,a,n){if(Ee.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!Ee.isString(t)){if(Ee.isString(a))return t.indexOf(a)!==-1;if(Ee.isRegExp(a))return a.test(t)}}function fP(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function hP(e,t){const r=Ee.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(n,i,o){return this[a].call(this,t,n,i,o)},configurable:!0})})}let ea=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function i(l,c,d){const u=bl(c);if(!u)throw new Error("header name must be a non-empty string");const m=Ee.findKey(n,u);(!m||n[m]===void 0||d===!0||d===void 0&&n[m]!==!1)&&(n[m||c]=Ud(l))}const o=(l,c)=>Ee.forEach(l,(d,u)=>i(d,u,c));if(Ee.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(Ee.isString(t)&&(t=t.trim())&&!mP(t))o(dP(t),r);else if(Ee.isObject(t)&&Ee.isIterable(t)){let l={},c,d;for(const u of t){if(!Ee.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?Ee.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}o(l,r)}else t!=null&&i(r,t,a);return this}get(t,r){if(t=bl(t),t){const a=Ee.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return uP(n);if(Ee.isFunction(r))return r.call(this,n,a);if(Ee.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=bl(t),t){const a=Ee.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||Km(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function i(o){if(o=bl(o),o){const l=Ee.findKey(a,o);l&&(!r||Km(a,a[l],l,r))&&(delete a[l],n=!0)}}return Ee.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const i=r[a];(!t||Km(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,a={};return Ee.forEach(this,(n,i)=>{const o=Ee.findKey(a,i);if(o){r[o]=Ud(n),delete r[i];return}const l=t?fP(i):String(i).trim();l!==i&&delete r[i],r[l]=Ud(n),a[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Ee.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&Ee.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[G1]=this[G1]={accessors:{}}).accessors,n=this.prototype;function i(o){const l=bl(o);a[l]||(hP(n,o),a[l]=!0)}return Ee.isArray(t)?t.forEach(i):i(t),this}};ea.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ee.reduceDescriptors(ea.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});Ee.freezeMethods(ea);function Ym(e,t){const r=this||Ac,a=t||r,n=ea.from(a.headers);let i=a.data;return Ee.forEach(e,function(l){i=l.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function SS(e){return!!(e&&e.__CANCEL__)}function sl(e,t,r){Et.call(this,e??"canceled",Et.ERR_CANCELED,t,r),this.name="CanceledError"}Ee.inherits(sl,Et,{__CANCEL__:!0});function ES(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new Et("Request failed with status code "+r.status,[Et.ERR_BAD_REQUEST,Et.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function pP(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function xP(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=a[i];o||(o=d),r[n]=c,a[n]=d;let m=i,f=0;for(;m!==n;)f+=r[m++],m=m%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),d-o<t)return;const h=u&&d-u;return h?Math.round(f*1e3/h):void 0}}function gP(e,t){let r=0,a=1e3/t,n,i;const o=(d,u=Date.now())=>{r=u,n=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const u=Date.now(),m=u-r;m>=a?o(d,u):(n=d,i||(i=setTimeout(()=>{i=null,o(n)},a-m)))},()=>n&&o(n)]}const Jd=(e,t,r=3)=>{let a=0;const n=xP(50,250);return gP(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-a,d=n(c),u=o<=l;a=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-o)/d:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},q1=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},K1=e=>(...t)=>Ee.asap(()=>e(...t)),vP=Os.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Os.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Os.origin),Os.navigator&&/(msie|trident)/i.test(Os.navigator.userAgent)):()=>!0,yP=Os.hasStandardBrowserEnv?{write(e,t,r,a,n,i){const o=[e+"="+encodeURIComponent(t)];Ee.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),Ee.isString(a)&&o.push("path="+a),Ee.isString(n)&&o.push("domain="+n),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function bP(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function jP(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function TS(e,t,r){let a=!bP(t);return e&&(a||r==!1)?jP(e,t):t}const Y1=e=>e instanceof ea?{...e}:e;function qi(e,t){t=t||{};const r={};function a(d,u,m,f){return Ee.isPlainObject(d)&&Ee.isPlainObject(u)?Ee.merge.call({caseless:f},d,u):Ee.isPlainObject(u)?Ee.merge({},u):Ee.isArray(u)?u.slice():u}function n(d,u,m,f){if(Ee.isUndefined(u)){if(!Ee.isUndefined(d))return a(void 0,d,m,f)}else return a(d,u,m,f)}function i(d,u){if(!Ee.isUndefined(u))return a(void 0,u)}function o(d,u){if(Ee.isUndefined(u)){if(!Ee.isUndefined(d))return a(void 0,d)}else return a(void 0,u)}function l(d,u,m){if(m in t)return a(d,u);if(m in e)return a(void 0,d)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,u,m)=>n(Y1(d),Y1(u),m,!0)};return Ee.forEach(Object.keys({...e,...t}),function(u){const m=c[u]||n,f=m(e[u],t[u],u);Ee.isUndefined(f)&&m!==l||(r[u]=f)}),r}const CS=e=>{const t=qi({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=ea.from(o),t.url=jS(TS(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Ee.isFormData(r)){if(Os.hasStandardBrowserEnv||Os.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Ee.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([u,m])=>{d.includes(u.toLowerCase())&&o.set(u,m)})}}if(Os.hasStandardBrowserEnv&&(a&&Ee.isFunction(a)&&(a=a(t)),a||a!==!1&&vP(t.url))){const c=n&&i&&yP.read(i);c&&o.set(n,c)}return t},wP=typeof XMLHttpRequest<"u",NP=wP&&function(e){return new Promise(function(r,a){const n=CS(e);let i=n.data;const o=ea.from(n.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=n,u,m,f,h,p;function x(){h&&h(),p&&p(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function b(){if(!g)return;const y=ea.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),S={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:y,config:e,request:g};ES(function(E){r(E),x()},function(E){a(E),x()},S),g=null}"onloadend"in g?g.onloadend=b:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(b)},g.onabort=function(){g&&(a(new Et("Request aborted",Et.ECONNABORTED,e,g)),g=null)},g.onerror=function(w){const S=w&&w.message?w.message:"Network Error",N=new Et(S,Et.ERR_NETWORK,e,g);N.event=w||null,a(N),g=null},g.ontimeout=function(){let w=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const S=n.transitional||wS;n.timeoutErrorMessage&&(w=n.timeoutErrorMessage),a(new Et(w,S.clarifyTimeoutError?Et.ETIMEDOUT:Et.ECONNABORTED,e,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&Ee.forEach(o.toJSON(),function(w,S){g.setRequestHeader(S,w)}),Ee.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),l&&l!=="json"&&(g.responseType=n.responseType),d&&([f,p]=Jd(d,!0),g.addEventListener("progress",f)),c&&g.upload&&([m,h]=Jd(c),g.upload.addEventListener("progress",m),g.upload.addEventListener("loadend",h)),(n.cancelToken||n.signal)&&(u=y=>{g&&(a(!y||y.type?new sl(null,e,g):y),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const j=pP(n.url);if(j&&Os.protocols.indexOf(j)===-1){a(new Et("Unsupported protocol "+j+":",Et.ERR_BAD_REQUEST,e));return}g.send(i||null)})},SP=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,n;const i=function(d){if(!n){n=!0,l();const u=d instanceof Error?d:this.reason;a.abort(u instanceof Et?u:new sl(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,i(new Et(`timeout ${t} of ms exceeded`,Et.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=a;return c.unsubscribe=()=>Ee.asap(l),c}},EP=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let a=0,n;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},TP=async function*(e,t){for await(const r of CP(e))yield*EP(r,t)},CP=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},X1=(e,t,r,a)=>{const n=TP(e,t);let i=0,o,l=c=>{o||(o=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await n.next();if(d){l(),c.close();return}let m=u.byteLength;if(r){let f=i+=m;r(f)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),n.return()}},{highWaterMark:2})},J1=64*1024,{isFunction:nd}=Ee,AP=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ee.global),{ReadableStream:Z1,TextEncoder:Q1}=Ee.global,ey=(e,...t)=>{try{return!!e(...t)}catch{return!1}},_P=e=>{e=Ee.merge.call({skipUndefined:!0},AP,e);const{fetch:t,Request:r,Response:a}=e,n=t?nd(t):typeof fetch=="function",i=nd(r),o=nd(a);if(!n)return!1;const l=n&&nd(Z1),c=n&&(typeof Q1=="function"?(p=>x=>p.encode(x))(new Q1):async p=>new Uint8Array(await new r(p).arrayBuffer())),d=i&&l&&ey(()=>{let p=!1;const x=new r(Os.origin,{body:new Z1,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!x}),u=o&&l&&ey(()=>Ee.isReadableStream(new a("").body)),m={stream:u&&(p=>p.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!m[p]&&(m[p]=(x,g)=>{let b=x&&x[p];if(b)return b.call(x);throw new Et(`Response type '${p}' is not supported`,Et.ERR_NOT_SUPPORT,g)})});const f=async p=>{if(p==null)return 0;if(Ee.isBlob(p))return p.size;if(Ee.isSpecCompliantForm(p))return(await new r(Os.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(Ee.isArrayBufferView(p)||Ee.isArrayBuffer(p))return p.byteLength;if(Ee.isURLSearchParams(p)&&(p=p+""),Ee.isString(p))return(await c(p)).byteLength},h=async(p,x)=>{const g=Ee.toFiniteNumber(p.getContentLength());return g??f(x)};return async p=>{let{url:x,method:g,data:b,signal:j,cancelToken:y,timeout:w,onDownloadProgress:S,onUploadProgress:N,responseType:E,headers:P,withCredentials:T="same-origin",fetchOptions:O}=CS(p),_=t||fetch;E=E?(E+"").toLowerCase():"text";let C=SP([j,y&&y.toAbortSignal()],w),R=null;const M=C&&C.unsubscribe&&(()=>{C.unsubscribe()});let U;try{if(N&&d&&g!=="get"&&g!=="head"&&(U=await h(P,b))!==0){let ne=new r(x,{method:"POST",body:b,duplex:"half"}),A;if(Ee.isFormData(b)&&(A=ne.headers.get("content-type"))&&P.setContentType(A),ne.body){const[D,I]=q1(U,Jd(K1(N)));b=X1(ne.body,J1,D,I)}}Ee.isString(T)||(T=T?"include":"omit");const Z=i&&"credentials"in r.prototype,ee={...O,signal:C,method:g.toUpperCase(),headers:P.normalize().toJSON(),body:b,duplex:"half",credentials:Z?T:void 0};R=i&&new r(x,ee);let re=await(i?_(R,O):_(x,ee));const z=u&&(E==="stream"||E==="response");if(u&&(S||z&&M)){const ne={};["status","statusText","headers"].forEach(V=>{ne[V]=re[V]});const A=Ee.toFiniteNumber(re.headers.get("content-length")),[D,I]=S&&q1(A,Jd(K1(S),!0))||[];re=new a(X1(re.body,J1,D,()=>{I&&I(),M&&M()}),ne)}E=E||"text";let me=await m[Ee.findKey(m,E)||"text"](re,p);return!z&&M&&M(),await new Promise((ne,A)=>{ES(ne,A,{data:me,headers:ea.from(re.headers),status:re.status,statusText:re.statusText,config:p,request:R})})}catch(Z){throw M&&M(),Z&&Z.name==="TypeError"&&/Load failed|fetch/i.test(Z.message)?Object.assign(new Et("Network Error",Et.ERR_NETWORK,p,R),{cause:Z.cause||Z}):Et.from(Z,Z&&Z.code,p,R)}}},kP=new Map,AS=e=>{let t=e?e.env:{};const{fetch:r,Request:a,Response:n}=t,i=[a,n,r];let o=i.length,l=o,c,d,u=kP;for(;l--;)c=i[l],d=u.get(c),d===void 0&&u.set(c,d=l?new Map:_P(t)),u=d;return d};AS();const Tp={http:q3,xhr:NP,fetch:{get:AS}};Ee.forEach(Tp,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ty=e=>`- ${e}`,DP=e=>Ee.isFunction(e)||e===null||e===!1,_S={getAdapter:(e,t)=>{e=Ee.isArray(e)?e:[e];const{length:r}=e;let a,n;const i={};for(let o=0;o<r;o++){a=e[o];let l;if(n=a,!DP(a)&&(n=Tp[(l=String(a)).toLowerCase()],n===void 0))throw new Et(`Unknown adapter '${l}'`);if(n&&(Ee.isFunction(n)||(n=n.get(t))))break;i[l||"#"+o]=n}if(!n){const o=Object.entries(i).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(ty).join(`
`):" "+ty(o[0]):"as no adapter specified";throw new Et("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n},adapters:Tp};function Xm(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new sl(null,e)}function ry(e){return Xm(e),e.headers=ea.from(e.headers),e.data=Ym.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),_S.getAdapter(e.adapter||Ac.adapter,e)(e).then(function(a){return Xm(e),a.data=Ym.call(e,e.transformResponse,a),a.headers=ea.from(a.headers),a},function(a){return SS(a)||(Xm(e),a&&a.response&&(a.response.data=Ym.call(e,e.transformResponse,a.response),a.response.headers=ea.from(a.response.headers))),Promise.reject(a)})}const kS="1.12.2",rm={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{rm[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const sy={};rm.transitional=function(t,r,a){function n(i,o){return"[Axios v"+kS+"] Transitional option '"+i+"'"+o+(a?". "+a:"")}return(i,o,l)=>{if(t===!1)throw new Et(n(o," has been removed"+(r?" in "+r:"")),Et.ERR_DEPRECATED);return r&&!sy[o]&&(sy[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};rm.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function IP(e,t,r){if(typeof e!="object")throw new Et("options must be an object",Et.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const i=a[n],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new Et("option "+i+" must be "+c,Et.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Et("Unknown option "+i,Et.ERR_BAD_OPTION)}}const Wd={assertOptions:IP,validators:rm},tn=Wd.validators;let Fi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new V1,response:new V1}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=qi(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:i}=r;a!==void 0&&Wd.assertOptions(a,{silentJSONParsing:tn.transitional(tn.boolean),forcedJSONParsing:tn.transitional(tn.boolean),clarifyTimeoutError:tn.transitional(tn.boolean)},!1),n!=null&&(Ee.isFunction(n)?r.paramsSerializer={serialize:n}:Wd.assertOptions(n,{encode:tn.function,serialize:tn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Wd.assertOptions(r,{baseUrl:tn.spelling("baseURL"),withXsrfToken:tn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&Ee.merge(i.common,i[r.method]);i&&Ee.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),r.headers=ea.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(c=c&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let u,m=0,f;if(!c){const p=[ry.bind(this),void 0];for(p.unshift(...l),p.push(...d),f=p.length,u=Promise.resolve(r);m<f;)u=u.then(p[m++],p[m++]);return u}f=l.length;let h=r;for(;m<f;){const p=l[m++],x=l[m++];try{h=p(h)}catch(g){x.call(this,g);break}}try{u=ry.call(this,h)}catch(p){return Promise.reject(p)}for(m=0,f=d.length;m<f;)u=u.then(d[m++],d[m++]);return u}getUri(t){t=qi(this.defaults,t);const r=TS(t.baseURL,t.url,t.allowAbsoluteUrls);return jS(r,t.params,t.paramsSerializer)}};Ee.forEach(["delete","get","head","options"],function(t){Fi.prototype[t]=function(r,a){return this.request(qi(a||{},{method:t,url:r,data:(a||{}).data}))}});Ee.forEach(["post","put","patch"],function(t){function r(a){return function(i,o,l){return this.request(qi(l||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Fi.prototype[t]=r(),Fi.prototype[t+"Form"]=r(!0)});let OP=class DS{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const o=new Promise(l=>{a.subscribe(l),i=l}).then(n);return o.cancel=function(){a.unsubscribe(i)},o},t(function(i,o,l){a.reason||(a.reason=new sl(i,o,l),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new DS(function(n){t=n}),cancel:t}}};function PP(e){return function(r){return e.apply(null,r)}}function RP(e){return Ee.isObject(e)&&e.isAxiosError===!0}const Cp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Cp).forEach(([e,t])=>{Cp[t]=e});function IS(e){const t=new Fi(e),r=cS(Fi.prototype.request,t);return Ee.extend(r,Fi.prototype,t,{allOwnKeys:!0}),Ee.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return IS(qi(e,n))},r}const vr=IS(Ac);vr.Axios=Fi;vr.CanceledError=sl;vr.CancelToken=OP;vr.isCancel=SS;vr.VERSION=kS;vr.toFormData=tm;vr.AxiosError=Et;vr.Cancel=vr.CanceledError;vr.all=function(t){return Promise.all(t)};vr.spread=PP;vr.isAxiosError=RP;vr.mergeConfig=qi;vr.AxiosHeaders=ea;vr.formToJSON=e=>NS(Ee.isHTMLForm(e)?new FormData(e):e);vr.getAdapter=_S.getAdapter;vr.HttpStatusCode=Cp;vr.default=vr;const{Axios:Gce,AxiosError:qce,CanceledError:Kce,isCancel:Yce,CancelToken:Xce,VERSION:Jce,all:Zce,Cancel:Qce,isAxiosError:ede,spread:tde,toFormData:rde,AxiosHeaders:sde,HttpStatusCode:ade,formToJSON:nde,getAdapter:ide,mergeConfig:ode}=vr,Bo={BASE_URL:"https://dsfms.id.vn",TIMEOUT:1e4,ENDPOINTS:{AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",STATUS:"/auth/status",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"}}},je={LOGIN:"/login",RESET_PASSWORD:"/reset-password",PROFILE:"/profile",DASHBOARD:"/dashboard",USERS:"/users",USERS_DETAIL:e=>`/users/${e}`,ROLES:"/roles",ROLES_DETAIL:e=>`/roles/${e}`,DEPARTMENTS:"/departments",DEPARTMENTS_DETAIL:e=>`/departments/${e}`,COURSES:"/courses",COURSES_INSTRUCTED:"/courses/instructed",COURSES_ENROLLED:"/courses/enrolled",COURSES_DETAIL:e=>`/courses/${e}`,COURSES_ENROLL_TRAINEES:e=>`/courses/${e}/enroll-trainees`,ACADEMIC_COURSE_DETAIL:e=>`/academic/course-detail/${e}`,SUBJECTS:"/subjects",SUBJECTS_DETAIL:e=>`/subjects/${e}`,SUBJECTS_IN_COURSE:(e,t)=>`/courses/${e}/subjects/${t}`,ASSESSMENTS:"/assessments",ASSESSMENTS_UPCOMING:"/assessments/upcoming",ASSESSMENTS_MY_ASSESSMENTS:"/assessments/my-assessments",ASSESSMENTS_RESULTS:"/assessments/results",ASSESSMENTS_DETAIL:e=>`/assessments/${e}`,ASSESSMENTS_SECTIONS:e=>`/assessments/${e}/sections`,ASSESSMENTS_SECTION_FIELDS:e=>`/assessments/sections/${e}/fields`,ASSESSMENTS_ASSIGN:(e,t)=>`/assessments/assign/${e}/${t}`,ASSESSMENTS_SIGNATURE_REQUIRED:"/assessments/signature-required",ASSESSMENTS_PENDING:"/assessments/pending",ASSESSMENT_EVENTS:"/assessment-events",TEMPLATES:"/templates",TEMPLATES_DETAIL:e=>`/templates/${e}`,TEMPLATES_EDITOR:"/templates/editor",TEMPLATES_DRAFTS:"/templates/drafts",TEMPLATES_HISTORY:e=>`/templates/${e}/history`,TEMPLATES_SECTIONS:e=>`/templates/${e}/sections`,TEMPLATES_FIELDS:e=>`/templates/${e}/fields`,REPORTS:"/reports",REPORTS_ISSUES:"/reports/issues",REPORTS_FEEDBACK:"/reports/feedback",REPORTS_CREATE:"/reports/create",REPORTS_DETAIL:e=>`/reports/${e}`,SYSTEM_CONFIG:"/system-config",GLOBAL_FIELDS:"/system-config/global-fields",MAIN_MENU:"/main-menu",TRAINEE_ACADEMIC_DETAILS:"/academic-details",TRAINEE_SIGNATURE_PAD:e=>`/signature-pad/${e}`,TRAINEE_ASSESSMENT_SECTION:e=>`/assessments/sections/${e}`,TRAINER_CONFIGURE_SIGNATURE:"/configure-signature",TRAINER_APPROVAL_NOTES:e=>`/assessments/approval-notes/${e}`,DEPARTMENT_MY_DETAILS:"/my-department-details",DEPARTMENT_REVIEW_REQUESTS:"/assessment-review-requests",DEPARTMENT_REVIEW_REQUEST_DETAIL:e=>`/assessment-review-requests/${e}`},ay={"/admin/users":je.USERS,"/admin/roles":je.ROLES,"/admin/departments":je.DEPARTMENTS,"/admin/forms":je.TEMPLATES,"/admin/forms/editor":je.TEMPLATES_EDITOR,"/admin/forms/drafts":je.TEMPLATES_DRAFTS,"/admin/system-config":je.SYSTEM_CONFIG,"/admin/main-menu":je.MAIN_MENU,"/trainer/instructed-courses":je.COURSES_INSTRUCTED,"/trainer/upcoming-assessments":je.ASSESSMENTS_UPCOMING,"/trainer/assessment-results":je.ASSESSMENTS_RESULTS,"/trainer/configure-signature":je.TRAINER_CONFIGURE_SIGNATURE,"/trainer/dashboard":je.DASHBOARD,"/trainee/dashboard":je.DASHBOARD,"/trainee/enrolled-courses":je.COURSES_ENROLLED,"/trainee/all-assessments":je.ASSESSMENTS_MY_ASSESSMENTS,"/trainee/your-assessments":je.ASSESSMENTS_MY_ASSESSMENTS,"/trainee/signature-required":je.ASSESSMENTS_SIGNATURE_REQUIRED,"/trainee/completion-required":je.ASSESSMENTS_COMPLETION_REQUIRED,"/trainee/create-incident-feedback-report":je.REPORTS_CREATE,"/trainee/academic-details":je.TRAINEE_ACADEMIC_DETAILS,"/academic/dashboard":je.DASHBOARD,"/academic/departments":je.COURSES,"/academic/assessment-events":je.ASSESSMENT_EVENTS,"/academic/course-detail/:courseId":e=>`/academic/course-detail/${e}`,"/department-head/dashboard":je.DASHBOARD,"/department-head/my-department-details":je.DEPARTMENT_MY_DETAILS,"/department-head/assessment-review-requests":je.DEPARTMENT_REVIEW_REQUESTS,"/sqa/issues":je.REPORTS_ISSUES,"/sqa/feedback":je.REPORTS_FEEDBACK,"/sqa/templates":je.TEMPLATES},OS=e=>{const t=e.split("?")[0].split("#")[0];return ay[t]?ay[t]:(Object.values(je).includes(t),t)},Gx=()=>"/dsfms-template/",FP=(e="/")=>{const r=`${Gx()}${e}`;window.location.href=r},Jm=()=>{FP("/")},qx="https://dsfms.id.vn",be=vr.create({baseURL:qx,timeout:2e4,headers:{"Content-Type":"application/json"}}),Kx=vr.create({baseURL:qx,timeout:2e4,headers:{"Content-Type":"application/json"}});let Zm=!1,Ap=[],id=0;const ny=2,PS=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp<r}catch{return!0}},LP=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp-r<300}catch{return!0}},iy=(e,t=null)=>{Ap.forEach(r=>{e?r.reject(e):r.resolve(t)}),Ap=[]};be.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(PS(t)?console.log(" Token is expired, will trigger refresh in response interceptor"):LP(t)&&console.log(" Token expires soon, consider refreshing"),e.headers.Authorization=`Bearer ${t}`,e.url?.includes("/roles/")&&e.method==="put"&&console.log(" Role update request:",{url:e.url,method:e.method,data:e.data,headers:{Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}}),e.url?.includes("/assign-trainees")&&e.method==="post"&&console.log(" Assign Trainees Request (Interceptor):",{url:e.url,method:e.method,data:e.data,dataType:typeof e.data,dataIsArray:Array.isArray(e.data),dataStringified:JSON.stringify(e.data),headers:{"Content-Type":e.headers["Content-Type"],Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}}),e.url?.includes("/departments/")&&e.method==="put"&&console.log(" Department Update Request (Interceptor):",{url:e.url,method:e.method,baseURL:e.baseURL,fullURL:`${e.baseURL}${e.url}`,data:e.data,headers:{"Content-Type":e.headers["Content-Type"],Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}})),e},e=>Promise.reject(e));be.interceptors.response.use(e=>e,async e=>{const t=e.config,r=e.response?.status;if(r===401&&!t._retry&&!t.url?.includes("/auth/")&&id<ny){if(console.log(" API call failed with 401 (token expired), attempting token refresh..."),Zm)return new Promise((n,i)=>{Ap.push({resolve:n,reject:i})}).then(n=>(t.headers.Authorization=`Bearer ${n}`,be(t))).catch(n=>Promise.reject(n));t._retry=!0,Zm=!0,id++;const a=localStorage.getItem("refreshToken");if(a)try{if(console.log(" Token ht hn (401), ang refresh token..."),PS(a))throw new Error("Refresh token is also expired");const n=await vr.post(`${qx}/auth/refresh`,{refresh_token:a}),{access_token:i,refresh_token:o}=n.data;if(!i||!o)throw new Error("Invalid token response from server");return localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",o),id=0,console.log(" Refresh token thnh cng, retry request gc"),iy(null,i),t.headers.Authorization=`Bearer ${i}`,await be(t)}catch(n){return console.error(" Refresh token tht bi:",n),iy(n,null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Jm(),Promise.reject(n)}finally{Zm=!1}else console.log(" Khng c refresh token, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),Jm()}else{if(r===403)return console.log(" API call failed with 403 (insufficient permissions) - user remains logged in"),Promise.reject(e);id>=ny&&(console.error("  vt qu s ln refresh cho php, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Jm())}return Promise.reject(e)});const od=vr.create({baseURL:"https://dsfms.id.vn",timeout:2e4,headers:{"Content-Type":"application/json"}}),Kn={login:async e=>{try{return(await od.post("/auth/login",e)).data}catch(t){throw t.response?.data||t.message}},refreshToken:async e=>{try{return(await od.post("/auth/refresh",{refresh_token:e})).data}catch(t){throw t.response?.data||t.message}},checkStatus:async()=>{try{return(await be.get("/auth/status")).data}catch(e){throw e.response?.data||e.message}},forgotPassword:async(e,t)=>{try{return(await od.post("/auth/forgot-password",{email:e,magicLink:t})).data}catch(r){throw r.response?.data||r.message}},resetPasswordWithToken:async(e,t,r)=>{try{return(await od.post("/auth/reset-password",{token:e,newPassword:t,confirmPassword:r})).data}catch(a){throw a.response?.data||a.message}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")}},Ys={getUsers:async(e={})=>{try{const r=(await be.get("/users",{params:e})).data;if(r&&r.data){if(Array.isArray(r.data))return{data:r.data};if(r.data.users&&Array.isArray(r.data.users))return{data:r.data.users}}return Array.isArray(r)?{data:r}:r&&r.users&&Array.isArray(r.users)?{data:r.users}:r}catch(t){throw t.response?.data||t.message}},getUserById:async e=>{try{const r=(await be.get(`/users/${e}`)).data;return r?.data&&typeof r.data=="object"?r.data:r}catch(t){throw t.response?.data||t.message}},getProfile:async()=>{try{return(await be.get("/profile")).data}catch(e){throw e.response?.data||e.message}},createUser:async e=>{try{return(await be.post("/users",e)).data}catch(t){throw t.response?.data||t.message}},updateUser:async(e,t)=>{try{return(await be.put(`/users/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteUser:async e=>{try{return(await be.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},bulkImportUsers:async e=>{try{return(await be.post("/users/bulk",{users:e})).data}catch(t){throw t.response?.data||t.message}},getRoles:async()=>{try{const t=(await be.get("/roles")).data;return t&&t.data&&typeof t.data=="object"?t.data:t}catch(e){throw e.response?.data||e.message}},enableUser:async e=>{try{return(await be.patch(`/users/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableUser:async e=>{try{return(await be.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleUserStatus:async(e,t)=>{try{return(await be.patch(`/users/${e}`,{status:t})).data}catch(r){throw r.response?.data||r.message}},resetPassword:async e=>{try{return(await be.put("/profile/reset-password",{newPassword:e.newPassword,confirmNewPassword:e.confirmPassword})).data}catch(t){throw t.response?.data||t.message}},getTrainers:async(e={})=>{try{return(await be.get("/users",{params:{roleName:"TRAINER",...e}})).data}catch(t){throw t.response?.data||t.message}}},Yn=e=>e&&e.data&&typeof e.data=="object"?e.data:e,Cs={getPublicRoles:async()=>{try{const e=await Kx.get("/public/roles");return e.data?.data||e.data||[]}catch(e){throw console.error("Error fetching public roles:",e),e}},getRoles:async(e={})=>{try{const t=await be.get("/roles",{params:e});return Yn(t.data)}catch(t){throw t.response?.data||t.message}},getRoleById:async e=>{try{const t=await be.get(`/roles/${e}`);return Yn(t.data)}catch(t){throw t.response?.data||t.message}},createRole:async e=>{try{const t=await be.post("/roles",e);return Yn(t.data)}catch(t){throw t.response?.data||t.message}},updateRole:async(e,t)=>{try{console.log(" API updateRole called with:",{id:e,roleData:t,url:`/roles/${e}`,method:"PUT"});const r=await be.put(`/roles/${e}`,t),a=Yn(r.data);return console.log(" API updateRole success:",a),a}catch(r){throw console.error(" API updateRole error:",{status:r.response?.status,statusText:r.response?.statusText,data:r.response?.data,message:r.message}),r.response?.data||r.message}},deleteRole:async e=>{try{const t=await be.delete(`/roles/${e}`);return Yn(t.data)}catch(t){throw t.response?.data||t.message}},toggleRoleStatus:async e=>{try{const t=await be.patch(`/roles/${e}/toggle-status`);return Yn(t.data)}catch(t){throw t.response?.data||t.message}},enableRole:async e=>{try{const t=await be.patch(`/roles/${e}/enable`);return Yn(t.data)}catch(t){throw t.response?.data||t.message}},disableRole:async e=>{try{const t=await be.delete(`/roles/${e}`);return Yn(t.data)}catch(t){throw t.response?.data||t.message}}},Vt={getPublicDepartments:async()=>{try{const e=await Kx.get("/public/departments");return e.data?.data||e.data||[]}catch(e){throw console.error("Error fetching public departments:",e),e}},getDepartments:async(e={})=>{try{const t=await be.get("/departments",{params:{includeDeleted:!0,...e}});return t.data?.data?.departments||t.data?.departments||[]}catch(t){throw console.error("Error fetching departments:",t),t}},getDepartmentById:async e=>{try{const t=await be.get(`/departments/${e}`,{params:{includeDeleted:!0}});return t.data?.data||t.data||{}}catch(t){throw console.error("Error fetching department:",t),t}},getMyDepartment:async()=>{try{const e=await be.get("/departments/me");return e.data?.data||e.data||{}}catch(e){throw console.error("Error fetching my department:",e),e}},createDepartment:async e=>{try{console.log(" API - Creating department with data:",e);const t=await be.post("/departments",e);return console.log(" API - Department created successfully:",t.data),t.data}catch(t){throw console.error(" API - Error creating department:",t),console.error(" API - Error response:",t.response?.data),console.error(" API - Error status:",t.response?.status),t}},updateDepartment:async(e,t)=>{try{console.log(" API - Updating department:",{id:e,departmentData:t});const r=await be.put(`/departments/${e}`,t);return console.log(" API - Department updated successfully:",r.data),r.data}catch(r){if(console.error(" API - Error updating department:",r),console.error(" API - Error response:",r.response?.data),console.error(" API - Error status:",r.response?.status),console.error(" API - Request config:",{url:r.config?.url,method:r.config?.method,data:r.config?.data}),r.code==="ERR_NETWORK"||r.message==="Network Error"){const a=new Error("Network error: Unable to connect to server. Please check your internet connection or contact support.");throw a.code="NETWORK_ERROR",a}else if(r.response?.status===502){const a=new Error("Server error (502): Bad Gateway. The server is temporarily unavailable. Please try again later.");throw a.code="BAD_GATEWAY",a}else if(r.response?.status===403){const a=new Error("Permission denied: You do not have permission to update this department.");throw a.code="PERMISSION_DENIED",a}throw r}},deleteDepartment:async e=>{try{return(await be.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error deleting department:",t),t}},disableDepartment:async e=>{try{return(await be.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error disabling department:",t),t}},enableDepartment:async e=>{try{return(await be.patch(`/departments/${e}/enable`)).data}catch(t){throw console.error("Error enabling department:",t),t}},toggleDepartmentStatus:async e=>{try{return(await be.patch(`/departments/${e}/toggle-status`)).data}catch(t){throw console.error("Error toggling department status:",t),t}},bulkDeleteDepartments:async e=>{try{return(await be.delete("/departments/bulk",{data:{ids:e}})).data}catch(t){throw console.error("Error bulk deleting departments:",t),t}},bulkToggleStatus:async(e,t)=>{try{return(await be.patch("/departments/bulk/toggle-status",{ids:e,status:t})).data}catch(r){throw console.error("Error bulk toggling department status:",r),r}},getDepartmentHeads:async()=>{try{return(await be.get("/departments/helpers/department-heads")).data}catch(e){throw console.error("Error fetching department heads:",e),e}},assignTrainersToDepartment:async(e,t)=>{try{return(await be.patch(`/departments/${e}/add-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error assigning trainers to department:",r),r}},removeTrainersFromDepartment:async(e,t)=>{try{return(await be.patch(`/departments/${e}/remove-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error removing trainers from department:",r),r}}},Nr={getPublicCourses:async()=>{try{const e=await Kx.get("/public/courses");return e.data?.data||e.data||[]}catch(e){throw console.error("Error fetching public courses:",e),e}},getCourses:async(e={})=>{try{return(await be.get("/courses",{params:e})).data}catch(t){throw console.error("Error fetching courses:",t),t}},getCourseById:async e=>{try{return(await be.get(`/courses/${e}`)).data}catch(t){throw console.error("Error fetching course:",t),t}},createCourse:async e=>{try{return(await be.post("/courses",e)).data}catch(t){throw console.error("Error creating course:",t),t}},updateCourse:async(e,t)=>{try{return(await be.put(`/courses/${e}`,t)).data}catch(r){throw console.error("Error updating course:",r),r}},archiveCourse:async e=>{try{return(await be.delete(`/courses/${e}/archive`)).data}catch(t){throw console.error("Error archiving course:",t),t}},getCoursesByDepartment:async(e,t={})=>{try{return(await be.get("/courses",{params:{departmentId:e,...t}})).data}catch(r){throw console.error("Error fetching courses by department:",r),r}},getDepartmentWithCourses:async e=>{try{return(await be.get(`/courses/department/${e}`)).data}catch(t){throw console.error("Error fetching department with courses:",t),t}},getDepartmentById:async e=>{try{const t=await be.get(`/departments/${e}`,{params:{includeDeleted:!0}});return t.data?.data||t.data||{}}catch(t){throw console.error("Error fetching department by ID:",t),t}},getTraineeEnrollments:async e=>(await be.get(`/courses/trainees/${e}/enrollments`)).data,getTraineeEnrollmentsByStatus:async(e,t="ENROLLED")=>{try{return(await be.get(`/courses/trainees/${e}/enrollments`,{params:{status:t}})).data}catch(r){throw console.error("Error fetching trainee enrollments:",r),r}},getCourseTrainees:async e=>{try{return(await be.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching course trainees:",t),t}},getCourseEnrollmentBatches:async e=>{try{return(await be.get(`/courses/${e}/enrollments/batches`)).data}catch(t){throw console.error("Error fetching course enrollment batches:",t),t}},deleteBatchEnrollments:async(e,t)=>{try{return(await be.delete(`/courses/${e}/enrollments/batches/${t}`)).data}catch(r){throw console.error("Error deleting batch enrollments:",r),r}},getAvailableTrainersForCourse:async e=>{try{return(await be.get(`/subjects/courses/${e}/available-trainers`)).data}catch(t){throw console.error("Error fetching available trainers for course:",t),t.response?.data||t.message}},assignTrainerToCourse:async(e,t)=>{try{return(await be.post(`/courses/${e}/trainers`,t)).data}catch(r){throw console.error("Error assigning trainer to course:",r),r}},removeTrainerFromCourse:async(e,t)=>{try{return(await be.delete(`/courses/${e}/trainers/${t}`)).data}catch(r){throw console.error("Error removing trainer from course:",r),r}}},Zd={getTrainees:async(e={})=>{try{return(await be.get("/trainees",{params:e})).data}catch(t){throw t.response?.data||t.message}},getTraineeById:async e=>{try{return(await be.get(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},createTrainee:async e=>{try{return(await be.post("/trainees",e)).data}catch(t){throw t.response?.data||t.message}},updateTrainee:async(e,t)=>{try{return(await be.put(`/trainees/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteTrainee:async e=>{try{return(await be.delete(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleTraineeStatus:async e=>{try{return(await be.patch(`/trainees/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},getTraineeCourses:async e=>{try{return(await be.get(`/trainees/${e}/courses`)).data}catch(t){throw t.response?.data||t.message}},getTraineeSubjects:async(e,t=null)=>{try{const r=t?`/trainees/${e}/subjects?courseId=${t}`:`/trainees/${e}/subjects`;return(await be.get(r)).data}catch(r){throw r.response?.data||r.message}},getTraineeAssessments:async e=>{try{return(await be.get(`/trainees/${e}/assessments`)).data}catch(t){throw t.response?.data||t.message}},enrollTrainee:async(e,t)=>{try{return(await be.post(`/trainees/${e}/enroll`,{courseId:t})).data}catch(r){throw r.response?.data||r.message}},unenrollTrainee:async(e,t)=>{try{return(await be.delete(`/trainees/${e}/enroll/${t}`)).data}catch(r){throw r.response?.data||r.message}},bulkImportTrainees:async e=>{try{return(await be.post("/trainees/bulk-import",e)).data}catch(t){throw t.response?.data||t.message}},getTraineesForEnrollment:async(e={})=>{try{return(await be.get("/subjects/active-trainees",{params:e})).data}catch(t){throw t.response?.data||t.message}},lookupTrainees:async e=>{try{console.log("API call - lookupTrainees with:",e);const t={traineesList:e};console.log("Sending request with format:",t);const r=await be.post("/subjects/trainees/lookup",t);return console.log("API response:",r.data),r.data}catch(t){throw console.error("Lookup failed:",t.response?.data),t.response?.data||t.message}},getTraineesByCourseId:async e=>{try{return(await be.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching trainees by course ID:",t),t}}},Jr={getSubjects:async(e={})=>{try{return(await be.get("/subjects",{params:e})).data}catch(t){throw t}},getSubjectsByCourse:async(e,t={})=>{const r=`/subjects/course/${e}`;try{return(await be.get(r,{params:t})).data}catch(a){throw a}},getSubjectById:async e=>{try{const t=await be.get(`/subjects/${e}`,{data:void 0,transformRequest:[(r,a)=>{delete a["Content-Type"]}]});return t.data&&t.data.data?t.data.data:t.data}catch(t){throw t}},createSubject:async e=>{try{return(await be.post("/subjects",e)).data}catch(t){throw t}},updateSubject:async(e,t)=>{try{return(await be.put(`/subjects/${e}`,t)).data}catch(r){throw r}},deleteSubject:async e=>{try{return(await be.delete(`/subjects/${e}`)).data}catch(t){throw t}},archiveSubject:async e=>{try{return(await be.delete(`/subjects/${e}/archive`)).data}catch(t){throw t}},bulkImportSubjects:async e=>{try{const r={courseId:e[0]?.courseId,subjects:e.map(n=>{const{courseId:i,...o}=n;return o})},a=await be.post("/subjects/bulk",r);return a.status===304?{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"}:a.data}catch(t){if(t.response?.status===304)return{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"};throw t}},assignTrainees:async(e,t)=>{try{const r={batchCode:t.batchCode||t.batch_code||"",traineeUserIds:t.traineeUserIds||t.trainee_user_ids||[]};if(!r.batchCode||typeof r.batchCode!="string")throw new Error("batchCode must be a non-empty string");if(!Array.isArray(r.traineeUserIds)||r.traineeUserIds.length===0)throw new Error("traineeUserIds must be a non-empty array");const a={batchCode:String(r.batchCode).trim(),traineeUserIds:Array.isArray(r.traineeUserIds)?[...r.traineeUserIds]:[]};return(await be.post(`/subjects/${e}/assign-trainees`,a)).data}catch(r){throw r}},removeTraineeFromSubject:async(e,t,r)=>{try{const a={batchCode:r};return(await be.delete(`/subjects/${e}/trainees/${t}`,{data:a})).data}catch(a){throw a}},addTrainerToSubject:async(e,t)=>{try{if(!t||typeof t!="object")throw new Error("Trainer data is required and must be an object");const r=t.trainer_user_id,a=t.trainerUserId,n=t.role_in_subject,i=t.roleInSubject,o=a||r,l=i||n;if(!o)throw new Error("trainerUserId is required");if(!l)throw new Error("roleInSubject is required");const c=["EXAMINER","ASSESSMENT_REVIEWER"];if(!c.includes(l))throw new Error(`Invalid roleInSubject: ${l}. Must be one of: ${c.join(", ")}`);const d=String(o).trim(),u=String(l).trim();if(!d||d==="")throw new Error("trainerUserId cannot be empty");if(!u||u==="")throw new Error("roleInSubject cannot be empty");const m={trainerUserId:d,roleInSubject:u};return(await be.post(`/subjects/${e}/trainers`,m,{headers:{"Content-Type":"application/json"}})).data}catch(r){throw r.response?.data?r.response.data:new Error(r.message||"Failed to add trainer to subject")}},getSubjectTrainers:async e=>{try{return(await be.get(`/subjects/${e}/trainers`)).data}catch(t){throw t.response?.data||t.message}},updateTrainerRole:async(e,t,r)=>{try{const a={roleInSubject:r.roleInSubject};return(await be.put(`/subjects/${e}/trainers/${t}`,a)).data}catch(a){throw a.response?.data||a.message}},removeTrainerFromSubject:async(e,t)=>{try{return(await be.delete(`/subjects/${e}/trainers/${t}`)).data}catch(r){throw r.response?.data||r.message}},getTraineeCourseSubjects:async e=>{try{return(await be.get(`/subjects/trainees/${e}/course-subjects`)).data}catch(t){throw t}}},tr={getTemplates:async(e={})=>{try{return(await be.get("/templates",{params:e})).data}catch(t){throw t}},getTemplateById:async e=>{try{return(await be.get(`/templates/${e}`)).data}catch(t){throw t}},getTemplatesByDepartment:async(e,t={})=>{try{return(await be.get(`/templates/department/${e}`,{params:{status:"PUBLISHED",...t}})).data}catch(r){throw r}},getMyTemplates:async()=>{try{return(await be.get("/templates")).data}catch(e){throw e}},createTemplate:async e=>{try{return(await be.post("/templates",e)).data}catch(t){throw t}},updateTemplate:async(e,t)=>{try{return(await be.put(`/templates/${e}`,t)).data}catch(r){throw r}},deleteTemplate:async e=>{try{return(await be.delete(`/templates/${e}`)).data}catch(t){throw t}},deleteDraft:async e=>{try{return(await be.delete(`/templates/draft/${e}`)).data}catch(t){throw t}},getTemplatePDF:async e=>{try{return(await be.get(`/templates/pdf/${e}`,{responseType:"blob"})).data}catch(t){throw t}},getTemplatePdfConfig:async e=>{try{return(await be.get(`/templates/pdf-config/${e}`,{responseType:"blob"})).data}catch(t){throw t}},reviewTemplate:async(e,t)=>{try{return(await be.patch(`/templates/${e}/review`,t)).data}catch(r){throw r}},extractFields:async e=>{try{return(await be.post("/templates/extract-fields-from-url",{url:e})).data}catch(t){throw t}},createVersion:async e=>{try{return(await be.post("/templates/create-version",e)).data}catch(t){throw t}},disableTemplate:async e=>{try{return(await be.patch(`/templates/${e}/status`,{status:"DISABLE"})).data}catch(t){throw t}}},mn={uploadDocument:async(e,t)=>{console.log(" uploadDocument called - FRESH VERSION 2025-01-17");const r=["files"];for(const a of r)try{const n=new FormData;n.append(a,e),console.log(` Testing field name: "${a}"`);const i=await be.post(`/media/docs/upload/${t}`,n,{headers:{"Content-Type":void 0}});return console.log(` Success with field name: "${a}"`,i.data),i.data&&i.data.data&&i.data.data.length>0&&i.data.data[0].url?console.log(` File uploaded successfully! URL: ${i.data.data[0].url}`):i.data&&i.data.url?console.log(` File uploaded successfully! URL: ${i.data.url}`):i.data&&i.data.fileUrl?console.log(` File uploaded successfully! URL: ${i.data.fileUrl}`):i.data&&i.data.path?console.log(` File uploaded successfully! Path: ${i.data.path}`):console.log(" File uploaded successfully! Response:",i.data),i.data}catch(n){console.log(` Failed with field name: "${a}"`,n.response?.data?.message)}throw new Error('Upload failed with field name "files". Please check backend logs.')},getDocsType:e=>e.substring(0,3).toLowerCase(),buildUploadUrl:e=>`https://dsfms.id.vn/media/docs/upload/${e}`,uploadFromUrl:async(e,t)=>{try{console.log(" Uploading from URL:",e),console.log(" File name:",t);const r=await be.post("/media/docs/upload-from-url",{sourceUrl:e,fileName:t});if(r.data&&r.data.data&&r.data.data.length>0){const a=r.data.data[0].url;return console.log(" File uploaded from URL successfully! New URL:",a),a}else throw new Error("Invalid response format from upload-from-url API")}catch(r){throw console.error(" Error uploading from URL:",r),r}},uploadImage:async(e,t)=>{try{const r=new FormData;r.append("files",e);const a=await be.post(`/media/images/upload/${t}`,r,{headers:{"Content-Type":"multipart/form-data"}});if(a.data&&a.data.data&&a.data.data.length>0)return a.data.data[0].url;if(a.data&&a.data.url)return a.data.url;if(a.data&&a.data.fileUrl)return a.data.fileUrl;if(a.data&&a.data.path)return a.data.path;throw new Error("Invalid response format from upload image API")}catch(r){throw console.error(" Error uploading image:",r),r}}},Sr={getAssessmentEvents:async(e={})=>{try{return(await be.get("/assessments/events",{params:e})).data}catch(t){throw console.error("Error fetching assessment events:",t),t}},updateAssessmentEvent:async(e={},t={})=>{try{return(await be.put("/assessments/events/update",t,{params:e})).data}catch(r){throw console.error("Error updating assessment event:",r),r}},createAssessmentEvent:async e=>{try{return(await be.post("/assessments",e)).data}catch(t){throw console.error("Error creating assessment event:",t),t}},createBulkAssessmentEvent:async e=>{try{return(await be.post("/assessments/bulk",e)).data}catch(t){throw console.error("Error creating bulk assessment event:",t),t}},getUserEvents:async(e={})=>{try{return(await be.get("/assessments/user-events",{params:e})).data}catch(t){throw console.error("Error fetching user assessment events:",t),t}},getCourseAssessments:async(e,t={})=>{try{return(await be.get("/assessments/course",{params:{courseId:e,...t}})).data}catch(r){throw console.error("Error fetching course assessments:",r),r}},getSubjectAssessments:async(e,t={})=>{try{return(await be.get("/assessments/subject",{params:{subjectId:e,...t}})).data}catch(r){throw console.error("Error fetching subject assessments:",r),r}},getCourseEvents:async(e={})=>{try{return(await be.post("/assessments/events/course",e)).data}catch(t){throw console.error("Error fetching course assessment events:",t),t}},getSubjectEvents:async(e={})=>{try{return(await be.post("/assessments/events/subject",e)).data}catch(t){throw console.error("Error fetching subject assessment events:",t),t}},getAssessmentSections:async e=>{try{return(await be.get(`/assessments/${e}/sections`)).data}catch(t){throw console.error("Error fetching assessment sections:",t),t}},getAssessmentFormPreview:async e=>{try{return(await be.get(`/assessments/${e}/preview`)).data}catch(t){throw console.error("Error fetching assessment preview:",t),t}},getAssessmentSectionFields:async e=>{try{return(await be.get(`/assessments/sections/${e}/fields`)).data}catch(t){throw console.error("Error fetching assessment section fields:",t),t}},confirmParticipation:async(e,t={})=>{try{return(await be.put(`/assessments/${e}/confirm-participation`,t)).data}catch(r){throw console.error("Error confirming participation:",r),r}},saveSectionValues:async e=>{try{return(await be.post("/assessments/sections/save-values",e)).data}catch(t){throw console.error("Error saving section values:",t),t}},updateSectionValues:async e=>{try{return(await be.put("/assessments/sections/update-values",e)).data}catch(t){throw console.error("Error updating section values:",t),t}},updateTraineeLock:async(e,t)=>{try{return(await be.put(`/assessments/${e}/trainee-lock`,{isTraineeLocked:t})).data}catch(r){throw console.error("Error updating trainee lock:",r),r}},submitAssessment:async e=>{try{return(await be.post(`/assessments/${e}/submit`)).data}catch(t){throw console.error("Error submitting assessment:",t),t}},getDepartmentAssessments:async(e={})=>{try{return(await be.get("/assessments/department",{params:e})).data}catch(t){throw console.error("Error fetching department assessments:",t),t}},approveRejectAssessment:async(e,t,r="")=>{try{const a={action:t};return t==="REJECTED"&&r&&(a.comment=r),(await be.put(`/assessments/${e}/approve-reject`,a)).data}catch(a){throw console.error("Error approving/rejecting assessment:",a),a}}},Jl={getGlobalFields:async()=>{try{return(await be.get("/global-fields")).data}catch(e){throw e}},getGlobalFieldDetail:async e=>{try{return(await be.get(`/global-fields/${e}/detail`)).data}catch(t){throw t}},getGlobalFieldById:async e=>{try{return(await be.get(`/global-fields/${e}`)).data}catch(t){throw t}},createGlobalField:async e=>{try{return(await be.post("/global-fields",e)).data}catch(t){throw t}},updateGlobalField:async(e,t)=>{try{return(await be.patch(`/global-fields/${e}`,t)).data}catch(r){throw r}},deleteGlobalField:async e=>{try{return(await be.delete(`/global-fields/${e}`)).data}catch(t){throw t}}},jl={"Validation failed":{default:"Invalid data. Please check your information and try again.",fields:{firstName:"First name is required",lastName:"Last name is required",email:"Email is invalid or already exists",phoneNumber:"Phone number is invalid",password:"Password must be at least 8 characters",role:"Role is invalid",department:"Department is invalid",address:"Address is required",gender:"Gender is invalid",dob:"Date of birth is invalid",trainingBatch:"Training batch is required",passportNo:"Passport number is invalid",nation:"Nationality is required",certificationNumber:"Certification number is invalid",specialization:"Specialization is required",yearsOfExp:"Years of experience must be a positive number"}},Unauthorized:"You do not have permission to access. Please login again.","Unauthorized access":"Wrong username or password. Please check your credentials and try again.","Access token is missing":"Your session has expired. Please login again.","Invalid refresh token":"Your session is invalid. Please login again.","User not found or inactive":"Account does not exist or has been deactivated.","Email or password is incorrect":"Email or password is incorrect.","Wrong password or username":"Wrong password or username. Please check your credentials and try again.",Forbidden:"You do not have permission to perform this action. Please contact your administrator.","Insufficient permissions":"You do not have sufficient permissions to perform this action.","Access denied":"Access denied. You do not have permission to access this resource.","User not found":"User not found.","User already exists":"User already exists.","Cannot delete user":"Cannot delete this user.","Cannot update user":"Cannot update user information.","Role not found":"Role not found.","Role already exists":"Role already exists.","Cannot delete role":"Cannot delete this role.","Prohibited action on base role":"Cannot modify base roles. Base roles are system-defined and cannot be edited.","Department not found":"Department not found.","Department already exists":"Department already exists.","Cannot delete department":"Cannot delete this department.","Internal server error":"System error. Please try again later.","Network error":"Connection error. Please check your network and try again.","Request timeout":"Request timeout. Please try again.","Not found":"Data not found.",Conflict:"Data already exists or conflicts.","Too many requests":"Too many requests. Please try again later."},Ha=(e,t={})=>{if(e?.response?.status===403)return"You do not have permission to perform this action. Please contact your administrator.";if(e?.response?.status===401)return"Your session has expired. Please login again.";if(typeof e=="string")return jl[e]||e;if(e&&typeof e=="object"){const{message:r,errors:a}=e;let n=r;if(Array.isArray(r))if(r.length>0){const o=r[0];typeof o=="object"&&o!==null?n=o.message||o.field||"Validation failed":n=o}else n="Validation failed";let i=jl[n];if(i&&typeof i=="object"&&i.default?i=i.default:(!i||typeof i!="string")&&(i=n),a&&Array.isArray(a)&&a.length>0){const o=a.map(l=>{if(typeof l=="string"){const c=l.match(/(\w+)\s+(.+)/);if(c){const[,d,u]=c;return jl[n]?.fields?.[d]||u}return l}else if(typeof l=="object"&&l!==null)return l.field&&l.message?jl[n]?.fields?.[l.field]||l.message:l.property&&l.constraints?jl[n]?.fields?.[l.property]||Object.values(l.constraints)[0]||l.property:JSON.stringify(l);return String(l)});return`${i}

Details:
${o.join(`
`)}`}return i}return e?.response?.data?Ha(e.response.data,t):e?.message||"An unknown error occurred. Please try again."},RS=v.createContext({user:null,setUser:()=>{},userRole:null,userPermissions:[],isAuthenticated:!1,setIsAuthenticated:()=>{},isLoading:!0,login:async()=>({success:!1}),logout:()=>{},refreshToken:async()=>({success:!1}),fetchUserRoleAndPermissions:async()=>({role:null,permissions:[]})}),MP=({children:e})=>{const[t,r]=v.useState(null),[a,n]=v.useState(null),[i,o]=v.useState([]),[l,c]=v.useState(!1),[d,u]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const j=localStorage.getItem("authToken"),y=localStorage.getItem("user"),w=localStorage.getItem("refreshToken");if(j&&y&&w)try{const S=JSON.parse(atob(j.split(".")[1])),N=Date.now()/1e3;if(S.exp<N)try{const E=await Kn.refreshToken(w);localStorage.setItem("authToken",E.access_token),localStorage.setItem("refreshToken",E.refresh_token);const P=JSON.parse(y);r(P),c(!0);try{const{role:T,permissions:O}=await f(P.role,P.roleId);if(T&&O)n(T),o(O);else throw new Error("Failed to fetch role and permissions")}catch(T){console.error("Failed to fetch role and permissions on initialization:",T),Kn.logout(),r(null),n(null),o([]),c(!1)}}catch{Kn.logout(),r(null),n(null),o([]),c(!1)}else{const E=JSON.parse(y);r(E),c(!0);try{const{role:P,permissions:T}=await f(E.role,E.roleId);if(P&&T)n(P),o(T);else throw new Error("Failed to fetch role and permissions")}catch(P){console.error("Failed to fetch role and permissions on initialization:",P),Kn.logout(),r(null),n(null),o([]),c(!1)}}}catch(S){console.error(" Error parsing token or user data:",S),Kn.logout(),r(null),n(null),o([]),c(!1)}else r(null),n(null),o([]),c(!1)}catch(j){console.error("Error accessing localStorage:",j),r(null),n(null),o([]),c(!1)}finally{u(!1)}})()},[]),v.useEffect(()=>{if(!l||d)return;const b=async()=>{const y=localStorage.getItem("authToken"),w=localStorage.getItem("refreshToken");if(!y||!w){x();return}try{const S=JSON.parse(atob(y.split(".")[1])),N=Date.now()/1e3;S.exp-N<300&&((await p()).success||(console.error(" Token refresh failed in validation"),x()))}catch(S){console.error(" Token validation failed:",S);try{(await p()).success||(console.error(" Token refresh failed after validation error"),x())}catch(N){console.error(" Token refresh failed:",N),x()}}},j=setTimeout(()=>{b();const y=setInterval(b,120*1e3);return()=>clearInterval(y)},500);return()=>clearTimeout(j)},[l,d]);const m=b=>{const j=b?.data||b;if(!j)return console.warn(" No role data provided to normalizePermissionsFromResponse"),[];if(j.permissionGroups&&Array.isArray(j.permissionGroups)){const y=[];return j.permissionGroups.forEach(w=>{w.permissions&&Array.isArray(w.permissions)&&w.permissions.forEach(S=>{S.code&&S.name?y.push({code:S.code,name:S.name,featureGroup:w.featureGroup||"Unknown"}):console.warn(" Invalid permission format (missing code or name):",S)})}),y}return j.permissions&&Array.isArray(j.permissions)?(console.log(" ========== USING OLD FORMAT (permissions array) =========="),console.log(" This format is deprecated. BE should return permissionGroups."),j.permissions.map(w=>w.code?{code:w.code,name:w.name||w.viewName||w.description||"Unknown",featureGroup:w.module||w.viewModule||"Unknown"}:(console.warn(" Old format permission without code field:",w),{code:w.id||`LEGACY-${w.name||"UNKNOWN"}`,name:w.name||w.viewName||w.description||"Unknown",featureGroup:w.module||w.viewModule||"Unknown"}))):(console.warn(" No permissions found in role data (neither permissionGroups nor permissions array)"),[])},f=async(b,j)=>{try{if(j)try{const y=await Cs.getRoleById(j),w=m(y),S={id:y?.data?.id||y?.id,name:y?.data?.name||y?.name||b,description:y?.data?.description||y?.description||`${b} role`,isActive:y?.data?.isActive!==void 0?y.data.isActive:y?.isActive!==void 0?y.isActive:!0,permissionCount:w.length};return n(S),o(w),{role:S,permissions:w}}catch(y){if(console.error("Error fetching role by ID:",y),y.response?.status===403){console.warn("User does not have permission to view role details, trying alternative approach");try{console.log(" ========== FALLBACK: Using /users/me API ==========");const S=await be.get("/users/me");if(console.log(" User Profile Response:",{hasRole:!!S.data?.role,hasPermissions:!!S.data?.role?.permissions,permissionsCount:S.data?.role?.permissions?.length||0}),S.data&&S.data.role){const N=m(S.data.role),E={id:j,name:b,description:`${b} role`,isActive:"ACTIVE",permissionCount:N.length};return console.log(" Permissions from /users/me (normalized):",N.slice(0,5).map(P=>({code:P.code,name:P.name,featureGroup:P.featureGroup}))),n(E),o(N),{role:E,permissions:N}}}catch(S){console.error("Failed to get user profile:",S)}console.warn("Cannot fetch permissions, creating minimal role");const w={id:j,name:b,description:`${b} role`,isActive:"ACTIVE",permissions:[]};return n(w),o([]),{role:w,permissions:[]}}throw new Error("Failed to fetch role details. Please contact administrator.")}try{const y=await Cs.getRoles(),w=y.data||y;let S;if(w&&w.roles&&Array.isArray(w.roles))S=w.roles;else if(Array.isArray(w))S=w;else throw new Error("Invalid roles data structure");const N=S.find(E=>E.name===b);if(N){const E=await Cs.getRoleById(N.id),P=m(E),T={id:E?.data?.id||E?.id||N.id,name:E?.data?.name||E?.name||b,description:E?.data?.description||E?.description||`${b} role`,isActive:E?.data?.isActive!==void 0?E.data.isActive:E?.isActive!==void 0?E.isActive:!0,permissionCount:P.length};return n(T),o(P),{role:T,permissions:P}}throw new Error(`Role '${b}' not found`)}catch(y){throw console.error("Fallback method failed:",y),new Error(`Role '${b}' not found. Please contact administrator.`)}}catch(y){return console.error("Error fetching user role and permissions:",y),{role:null,permissions:[]}}},h=async b=>{try{u(!0);const j=await Kn.login(b);localStorage.setItem("authToken",j.access_token),localStorage.setItem("refreshToken",j.refresh_token);let y;try{const N=JSON.parse(atob(j.access_token.split(".")[1]));if(!N.userId||!N.roleName)throw new Error("Invalid token: missing required fields (userId, roleName)");y={id:N.userId,email:b.email,fullName:N.fullName||N.name||"User",role:N.roleName,roleId:N.roleId,department:N.department||"IT",lastLogin:new Date().toISOString()},b.email==="depthead@test.com"&&(y.role="DEPARTMENT_HEAD",y.roleId="dept-head-001")}catch(N){throw console.error("Error decoding token:",N),new Error("Invalid token format or missing required fields")}localStorage.setItem("user",JSON.stringify(y));const{role:w,permissions:S}=await f(y.role,y.roleId);if(!w||!S)throw console.error(" Failed to fetch user role and permissions"),new Error("Failed to fetch user role and permissions");return r(y),n(w),o(S),c(!0),{success:!0,user:y,role:w,permissions:S}}catch(j){return{success:!1,error:Ha(j)||"Login failed"}}finally{u(!1)}},p=async()=>{try{const b=localStorage.getItem("refreshToken");if(!b)throw new Error("No refresh token available");const j=await Kn.refreshToken(b);return localStorage.setItem("authToken",j.access_token),localStorage.setItem("refreshToken",j.refresh_token),{success:!0,tokens:j}}catch(b){return console.error("Manual token refresh failed:",b),x(),{success:!1,error:b.message}}},x=()=>{Kn.logout(),r(null),n(null),o([]),c(!1)},g={user:t,setUser:r,userRole:a,userPermissions:i,isAuthenticated:l,setIsAuthenticated:c,isLoading:d,login:h,logout:x,refreshToken:p,fetchUserRoleAndPermissions:f};try{return s.jsx(RS.Provider,{value:g,children:e})}catch(b){return console.error(" AuthProvider error:",b),s.jsxs("div",{style:{padding:"20px",color:"red"},children:[s.jsx("h3",{children:"Authentication Error"}),s.jsx("p",{children:"There was an error initializing the authentication system."}),s.jsxs("details",{children:[s.jsx("summary",{children:"Error Details"}),s.jsx("pre",{children:b.message})]})]})}},zr=()=>{const e=v.useContext(RS);if(!e)throw console.error("AuthContext is null or undefined. Make sure AuthProvider is properly wrapping the component tree."),new Error("useAuth must be used within an AuthProvider");return e},BP={getPermissions:async(e={})=>{try{return(await be.get("/permissions",{params:e})).data}catch(t){throw t.response?.data||t.message}},getPermissionById:async e=>{try{return(await be.get(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},createPermission:async e=>{try{return(await be.post("/permissions",e)).data}catch(t){throw t.response?.data||t.message}},updatePermission:async(e,t)=>{try{return(await be.put(`/permissions/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deletePermission:async e=>{try{return(await be.delete(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},enablePermission:async e=>{try{return(await be.patch(`/permissions/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},getPermissionGroups:async()=>{try{return(await be.get("/permission-groups")).data}catch(e){throw e.response?.data||e.message}}},oy=e=>{if(!e)return"";const t=e.split(" ");if(t.length>=2){const r=t[0],a=t[1],i=a.split("/").filter(c=>c&&!c.startsWith(":"))[0]||"Resource",l={GET:"View",POST:"Create",PUT:"Update",PATCH:"Update",DELETE:"Delete"}[r]||r;return a.includes("forgot-password")?"Forgot Password":a.includes("reset-password")?"Reset Password":a.includes("enable")?`Enable ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("archive")?`Archive ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("restore")?`Restore ${i.charAt(0).toUpperCase()+i.slice(1)}`:a.includes("add-trainers")?"Add Trainers to Department":a.includes("remove-trainers")?"Remove Trainers from Department":a.includes("new-feature")?"Create New Feature":a.includes("bulk-import")?"Bulk Import Data":a.includes("export-report")?"Export Report":zP(l,i,a)}return e},zP=(e,t,r)=>{if(r.includes("-")){const a=r.split("/").filter(o=>o&&!o.startsWith(":")),i=a[a.length-1].split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");return`${e} ${i}`}return`${e} ${t.charAt(0).toUpperCase()+t.slice(1)}`},Fn=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!1),[n,i]=v.useState(null),{userPermissions:o,userRole:l}=zr(),c=v.useCallback(async()=>{a(!0),i(null);try{o&&o.length>0?t(o):(t([]),console.log(" No userPermissions available"))}catch(w){console.error("Error setting permissions:",w),i(w),t([])}finally{a(!1)}},[o]),d=v.useCallback(()=>e.map(w=>({id:w.id,title:w.viewName||w.description||oy(w.name),description:w.description||"",module:w.module,method:w.method,path:w.path,isActive:w.isActive,viewName:w.viewName,viewModule:w.viewModule})),[e]),u=v.useCallback(()=>{const w=d(),S={};return w.forEach(N=>{const E=N.module,P=N.viewModule||`${N.module} Management`;S[E]||(S[E]={id:E,name:P,description:`Manage ${P.toLowerCase()} related permissions`,permissions:[]}),S[E].permissions.push({id:N.id,title:N.title,description:N.description,isActive:N.isActive,method:N.method,path:N.path})}),Object.values(S).sort((N,E)=>N.name.localeCompare(E.name))},[d]),m=v.useCallback(w=>{const S=e.find(N=>N.id===w);return S?S.isActive==="ACTIVE":!0},[e]),f=v.useCallback(w=>e.find(S=>S.id===w),[e]),h=v.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(w=>w.code).filter(Boolean)),[o]),p=v.useCallback(w=>!o||o.length===0||!w||typeof w!="string"?!1:h.has(w),[o,h]),x=v.useCallback(w=>!o||o.length===0||!Array.isArray(w)||w.length===0?!1:w.some(p),[o,p]),g=v.useCallback(w=>!o||o.length===0||!Array.isArray(w)||w.length===0?!1:w.every(p),[o,p]),b=v.useCallback(w=>!o||o.length===0?!1:o.some(S=>S.module===w),[o]),j=v.useCallback(()=>!o||o.length===0?[]:[...new Set(o.map(S=>S.module))],[o]),y=v.useCallback(()=>{if(!o||o.length===0)return[];const w=o.map(N=>({id:N.id,title:N.viewName||N.description||oy(N.name),description:N.description||"",module:N.module,method:N.method,path:N.path,isActive:N.isActive,viewName:N.viewName,viewModule:N.viewModule})),S={};return w.forEach(N=>{const E=N.module,P=N.viewModule||`${N.module} Management`;S[E]||(S[E]={id:E,name:P,description:`Manage ${P.toLowerCase()} related permissions`,permissions:[]}),S[E].permissions.push({id:N.id,title:N.title,description:N.description,isActive:N.isActive,method:N.method,path:N.path})}),Object.values(S).sort((N,E)=>N.name.localeCompare(E.name))},[o]);return v.useEffect(()=>{c()},[c]),{permissions:e,loading:r,error:n,fetchPermissions:c,getUIPermissions:d,getPermissionGroups:u,isPermissionActive:m,getApiPermission:f,hasPermission:p,hasAnyPermission:x,hasAllPermissions:g,hasModuleAccess:b,getAccessibleModules:j,getUserPermissionGroups:y,userPermissions:o,userRole:l}},$P=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!1),[n,i]=v.useState(null),o=v.useCallback(async()=>{a(!0),i(null);try{const l=await BP.getPermissionGroups();let c=[];l&&l.data&&Array.isArray(l.data)?c=l.data:Array.isArray(l)&&(c=l);const d=[];c.forEach(u=>{u.permissions&&Array.isArray(u.permissions)&&u.permissions.forEach(m=>{d.push({id:m.code,code:m.code,name:m.name,module:u.featureGroup,viewName:m.name,viewModule:u.featureGroup,isActive:!0})})}),t(d)}catch(l){console.error("Error fetching permission groups from API:",l),i(l),t([])}finally{a(!1)}},[]);return{allPermissions:e,loading:r,error:n,fetchAllPermissions:o}};function FS(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=FS(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function Mt(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=FS(e))&&(a&&(a+=" "),a+=t);return a}function UP(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}UP(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var _c=e=>typeof e=="number"&&!isNaN(e),Ki=e=>typeof e=="string",kn=e=>typeof e=="function",WP=e=>Ki(e)||_c(e),_p=e=>Ki(e)||kn(e)?e:null,HP=(e,t)=>e===!1||_c(e)&&e>0?e:t,kp=e=>v.isValidElement(e)||Ki(e)||kn(e)||_c(e);function VP(e,t,r=300){let{scrollHeight:a,style:n}=e;requestAnimationFrame(()=>{n.minHeight="initial",n.height=a+"px",n.transition=`all ${r}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(t,r)})})}function GP({enter:e,exit:t,appendPosition:r=!1,collapse:a=!0,collapseDuration:n=300}){return function({children:i,position:o,preventExitTransition:l,done:c,nodeRef:d,isIn:u,playToast:m}){let f=r?`${e}--${o}`:e,h=r?`${t}--${o}`:t,p=v.useRef(0);return v.useLayoutEffect(()=>{let x=d.current,g=f.split(" "),b=j=>{j.target===d.current&&(m(),x.removeEventListener("animationend",b),x.removeEventListener("animationcancel",b),p.current===0&&j.type!=="animationcancel"&&x.classList.remove(...g))};x.classList.add(...g),x.addEventListener("animationend",b),x.addEventListener("animationcancel",b)},[]),v.useEffect(()=>{let x=d.current,g=()=>{x.removeEventListener("animationend",g),a?VP(x,c,n):c()};u||(l?g():(p.current=1,x.className+=` ${h}`,x.addEventListener("animationend",g)))},[u]),Q.createElement(Q.Fragment,null,i)}}function ly(e,t){return{content:LS(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function LS(e,t,r=!1){return v.isValidElement(e)&&!Ki(e.type)?v.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):kn(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function qP({closeToast:e,theme:t,ariaLabel:r="close"}){return Q.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:a=>{a.stopPropagation(),e(!0)},"aria-label":r},Q.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Q.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function KP({delay:e,isRunning:t,closeToast:r,type:a="default",hide:n,className:i,controlledProgress:o,progress:l,rtl:c,isIn:d,theme:u}){let m=n||o&&l===0,f={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};o&&(f.transform=`scaleX(${l})`);let h=Mt("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${u}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":c}),p=kn(i)?i({rtl:c,type:a,defaultClassName:h}):Mt(h,i),x={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{d&&r()}};return Q.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":m},Q.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${u} Toastify__progress-bar--${a}`}),Q.createElement("div",{role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:p,style:f,...x}))}var YP=1,MS=()=>`${YP++}`;function XP(e,t,r){let a=1,n=0,i=[],o=[],l=t,c=new Map,d=new Set,u=j=>(d.add(j),()=>d.delete(j)),m=()=>{o=Array.from(c.values()),d.forEach(j=>j())},f=({containerId:j,toastId:y,updateId:w})=>{let S=j?j!==e:e!==1,N=c.has(y)&&w==null;return S||N},h=(j,y)=>{c.forEach(w=>{var S;(y==null||y===w.props.toastId)&&((S=w.toggle)==null||S.call(w,j))})},p=j=>{var y,w;(w=(y=j.props)==null?void 0:y.onClose)==null||w.call(y,j.removalReason),j.isActive=!1},x=j=>{if(j==null)c.forEach(p);else{let y=c.get(j);y&&p(y)}m()},g=()=>{n-=i.length,i=[]},b=j=>{var y,w;let{toastId:S,updateId:N}=j.props,E=N==null;j.staleId&&c.delete(j.staleId),j.isActive=!0,c.set(S,j),m(),r(ly(j,E?"added":"updated")),E&&((w=(y=j.props).onOpen)==null||w.call(y))};return{id:e,props:l,observe:u,toggle:h,removeToast:x,toasts:c,clearQueue:g,buildToast:(j,y)=>{if(f(y))return;let{toastId:w,updateId:S,data:N,staleId:E,delay:P}=y,T=S==null;T&&n++;let O={...l,style:l.toastStyle,key:a++,...Object.fromEntries(Object.entries(y).filter(([C,R])=>R!=null)),toastId:w,updateId:S,data:N,isIn:!1,className:_p(y.className||l.toastClassName),progressClassName:_p(y.progressClassName||l.progressClassName),autoClose:y.isLoading?!1:HP(y.autoClose,l.autoClose),closeToast(C){c.get(w).removalReason=C,x(w)},deleteToast(){let C=c.get(w);if(C!=null){if(r(ly(C,"removed")),c.delete(w),n--,n<0&&(n=0),i.length>0){b(i.shift());return}m()}}};O.closeButton=l.closeButton,y.closeButton===!1||kp(y.closeButton)?O.closeButton=y.closeButton:y.closeButton===!0&&(O.closeButton=kp(l.closeButton)?l.closeButton:!0);let _={content:j,props:O,staleId:E};l.limit&&l.limit>0&&n>l.limit&&T?i.push(_):_c(P)?setTimeout(()=>{b(_)},P):b(_)},setProps(j){l=j},setToggle:(j,y)=>{let w=c.get(j);w&&(w.toggle=y)},isToastActive:j=>{var y;return(y=c.get(j))==null?void 0:y.isActive},getSnapshot:()=>o}}var Ws=new Map,Zl=[],Dp=new Set,JP=e=>Dp.forEach(t=>t(e)),BS=()=>Ws.size>0;function ZP(){Zl.forEach(e=>$S(e.content,e.options)),Zl=[]}var QP=(e,{containerId:t})=>{var r;return(r=Ws.get(t||1))==null?void 0:r.toasts.get(e)};function zS(e,t){var r;if(t)return!!((r=Ws.get(t))!=null&&r.isToastActive(e));let a=!1;return Ws.forEach(n=>{n.isToastActive(e)&&(a=!0)}),a}function eR(e){if(!BS()){Zl=Zl.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||WP(e))Ws.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Ws.get(e.containerId);t?t.removeToast(e.id):Ws.forEach(r=>{r.removeToast(e.id)})}}var tR=(e={})=>{Ws.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function $S(e,t){kp(e)&&(BS()||Zl.push({content:e,options:t}),Ws.forEach(r=>{r.buildToast(e,t)}))}function rR(e){var t;(t=Ws.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function US(e,t){Ws.forEach(r=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===r.id)&&r.toggle(e,t?.id)})}function sR(e){let t=e.containerId||1;return{subscribe(r){let a=XP(t,e,JP);Ws.set(t,a);let n=a.observe(r);return ZP(),()=>{n(),Ws.delete(t)}},setProps(r){var a;(a=Ws.get(t))==null||a.setProps(r)},getSnapshot(){var r;return(r=Ws.get(t))==null?void 0:r.getSnapshot()}}}function aR(e){return Dp.add(e),()=>{Dp.delete(e)}}function nR(e){return e&&(Ki(e.toastId)||_c(e.toastId))?e.toastId:MS()}function kc(e,t){return $S(e,t),t.toastId}function sm(e,t){return{...t,type:t&&t.type||e,toastId:nR(t)}}function am(e){return(t,r)=>kc(t,sm(e,r))}function J(e,t){return kc(e,sm("default",t))}J.loading=(e,t)=>kc(e,sm("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function iR(e,{pending:t,error:r,success:a},n){let i;t&&(i=Ki(t)?J.loading(t,n):J.loading(t.render,{...n,...t}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(d,u,m)=>{if(u==null){J.dismiss(i);return}let f={type:d,...o,...n,data:m},h=Ki(u)?{render:u}:u;return i?J.update(i,{...f,...h}):J(h.render,{...f,...h}),m},c=kn(e)?e():e;return c.then(d=>l("success",a,d)).catch(d=>l("error",r,d)),c}J.promise=iR;J.success=am("success");J.info=am("info");J.error=am("error");J.warning=am("warning");J.warn=J.warning;J.dark=(e,t)=>kc(e,sm("default",{theme:"dark",...t}));function oR(e){eR(e)}J.dismiss=oR;J.clearWaitingQueue=tR;J.isActive=zS;J.update=(e,t={})=>{let r=QP(e,t);if(r){let{props:a,content:n}=r,i={delay:100,...a,...t,toastId:t.toastId||e,updateId:MS()};i.toastId!==e&&(i.staleId=e);let o=i.render||n;delete i.render,kc(o,i)}};J.done=e=>{J.update(e,{progress:1})};J.onChange=aR;J.play=e=>US(!0,e);J.pause=e=>US(!1,e);function lR(e){var t;let{subscribe:r,getSnapshot:a,setProps:n}=v.useRef(sR(e)).current;n(e);let i=(t=v.useSyncExternalStore(r,a,a))==null?void 0:t.slice();function o(l){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(d=>{let{position:u}=d.props;c.has(u)||c.set(u,[]),c.get(u).push(d)}),Array.from(c,d=>l(d[0],d[1]))}return{getToastToRender:o,isToastActive:zS,count:i?.length}}function cR(e){let[t,r]=v.useState(!1),[a,n]=v.useState(!1),i=v.useRef(null),o=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:d,onClick:u,closeOnClick:m}=e;rR({id:e.toastId,containerId:e.containerId,fn:r}),v.useEffect(()=>{if(e.pauseOnFocusLoss)return f(),()=>{h()}},[e.pauseOnFocusLoss]);function f(){document.hasFocus()||b(),window.addEventListener("focus",g),window.addEventListener("blur",b)}function h(){window.removeEventListener("focus",g),window.removeEventListener("blur",b)}function p(E){if(e.draggable===!0||e.draggable===E.pointerType){j();let P=i.current;o.canCloseOnClick=!0,o.canDrag=!0,P.style.transition="none",e.draggableDirection==="x"?(o.start=E.clientX,o.removalDistance=P.offsetWidth*(e.draggablePercent/100)):(o.start=E.clientY,o.removalDistance=P.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function x(E){let{top:P,bottom:T,left:O,right:_}=i.current.getBoundingClientRect();E.nativeEvent.type!=="touchend"&&e.pauseOnHover&&E.clientX>=O&&E.clientX<=_&&E.clientY>=P&&E.clientY<=T?b():g()}function g(){r(!0)}function b(){r(!1)}function j(){o.didMove=!1,document.addEventListener("pointermove",w),document.addEventListener("pointerup",S)}function y(){document.removeEventListener("pointermove",w),document.removeEventListener("pointerup",S)}function w(E){let P=i.current;if(o.canDrag&&P){o.didMove=!0,t&&b(),e.draggableDirection==="x"?o.delta=E.clientX-o.start:o.delta=E.clientY-o.start,o.start!==E.clientX&&(o.canCloseOnClick=!1);let T=e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;P.style.transform=`translate3d(${T},0)`,P.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function S(){y();let E=i.current;if(o.canDrag&&o.didMove&&E){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){n(!0),e.closeToast(!0),e.collapseAll();return}E.style.transition="transform 0.2s, opacity 0.2s",E.style.removeProperty("transform"),E.style.removeProperty("opacity")}}let N={onPointerDown:p,onPointerUp:x};return l&&c&&(N.onMouseEnter=b,e.stacked||(N.onMouseLeave=g)),m&&(N.onClick=E=>{u&&u(E),o.canCloseOnClick&&d(!0)}),{playToast:g,pauseToast:b,isRunning:t,preventExitTransition:a,toastRef:i,eventHandlers:N}}var dR=typeof window<"u"?v.useLayoutEffect:v.useEffect,nm=({theme:e,type:t,isLoading:r,...a})=>Q.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...a});function uR(e){return Q.createElement(nm,{...e},Q.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function mR(e){return Q.createElement(nm,{...e},Q.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function fR(e){return Q.createElement(nm,{...e},Q.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function hR(e){return Q.createElement(nm,{...e},Q.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function pR(){return Q.createElement("div",{className:"Toastify__spinner"})}var Ip={info:mR,warning:uR,success:fR,error:hR,spinner:pR},xR=e=>e in Ip;function gR({theme:e,type:t,isLoading:r,icon:a}){let n=null,i={theme:e,type:t};return a===!1||(kn(a)?n=a({...i,isLoading:r}):v.isValidElement(a)?n=v.cloneElement(a,i):r?n=Ip.spinner():xR(t)&&(n=Ip[t](i))),n}var vR=e=>{let{isRunning:t,preventExitTransition:r,toastRef:a,eventHandlers:n,playToast:i}=cR(e),{closeButton:o,children:l,autoClose:c,onClick:d,type:u,hideProgressBar:m,closeToast:f,transition:h,position:p,className:x,style:g,progressClassName:b,updateId:j,role:y,progress:w,rtl:S,toastId:N,deleteToast:E,isIn:P,isLoading:T,closeOnClick:O,theme:_,ariaLabel:C}=e,R=Mt("Toastify__toast",`Toastify__toast-theme--${_}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":S},{"Toastify__toast--close-on-click":O}),M=kn(x)?x({rtl:S,position:p,type:u,defaultClassName:R}):Mt(R,x),U=gR(e),Z=!!w||!c,ee={closeToast:f,type:u,theme:_},re=null;return o===!1||(kn(o)?re=o(ee):v.isValidElement(o)?re=v.cloneElement(o,ee):re=qP(ee)),Q.createElement(h,{isIn:P,done:E,position:p,preventExitTransition:r,nodeRef:a,playToast:i},Q.createElement("div",{id:N,tabIndex:0,onClick:d,"data-in":P,className:M,...n,style:g,ref:a,...P&&{role:y,"aria-label":C}},U!=null&&Q.createElement("div",{className:Mt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!T})},U),LS(l,e,!t),re,!e.customProgressBar&&Q.createElement(KP,{...j&&!Z?{key:`p-${j}`}:{},rtl:S,theme:_,delay:c,isRunning:t,isIn:P,closeToast:f,hide:m,type:u,className:b,controlledProgress:Z,progress:w||0})))},yR=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),bR=GP(yR("bounce",!0)),jR={position:"top-right",transition:bR,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function wR(e){let t={...jR,...e},r=e.stacked,[a,n]=v.useState(!0),i=v.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=lR(t),{className:d,style:u,rtl:m,containerId:f,hotKeys:h}=t;function p(g){let b=Mt("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":m});return kn(d)?d({position:g,rtl:m,defaultClassName:b}):Mt(b,_p(d))}function x(){r&&(n(!0),J.play())}return dR(()=>{var g;if(r){let b=i.current.querySelectorAll('[data-in="true"]'),j=12,y=(g=t.position)==null?void 0:g.includes("top"),w=0,S=0;Array.from(b).reverse().forEach((N,E)=>{let P=N;P.classList.add("Toastify__toast--stacked"),E>0&&(P.dataset.collapsed=`${a}`),P.dataset.pos||(P.dataset.pos=y?"top":"bot");let T=w*(a?.2:1)+(a?0:j*E);P.style.setProperty("--y",`${y?T:T*-1}px`),P.style.setProperty("--g",`${j}`),P.style.setProperty("--s",`${1-(a?S:0)}`),w+=P.offsetHeight,S+=.025})}},[a,c,r]),v.useEffect(()=>{function g(b){var j;let y=i.current;h(b)&&((j=y.querySelector('[tabIndex="0"]'))==null||j.focus(),n(!1),J.pause()),b.key==="Escape"&&(document.activeElement===y||y!=null&&y.contains(document.activeElement))&&(n(!0),J.play())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[h]),Q.createElement("section",{ref:i,className:"Toastify",id:f,onMouseEnter:()=>{r&&(n(!1),J.pause())},onMouseLeave:x,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},o((g,b)=>{let j=b.length?{...u}:{...u,pointerEvents:"none"};return Q.createElement("div",{tabIndex:-1,className:p(g),"data-stacked":r,style:j,key:`c-${g}`},b.map(({content:y,props:w})=>Q.createElement(vR,{...w,stacked:r,collapseAll:x,isIn:l(w.toastId,w.containerId),key:`t-${w.key}`},y)))}))}const rn=e=>e.map(t=>({id:t.id,name:t.name,code:t.code,type:t.code,description:t.description,departmentHeadId:t.headUserId,departmentHead:t.headUser?{id:t.headUser.id,name:t.headUser.name||t.headUser.email,email:t.headUser.email,role:t.headUser.role,lastName:t.headUser.lastName,middleName:t.headUser.middleName,firstName:t.headUser.firstName}:null,status:t.isActive===!0?"ACTIVE":"INACTIVE",coursesCount:t.courseCount||t.coursesCount||0,traineesCount:t.traineeCount||t.traineesCount||0,trainersCount:t.trainerCount||t.trainersCount||0,createdAt:t.createdAt,updatedAt:t.updatedAt,deletedAt:t.deletedAt})),Yx=(e=!0,t="all")=>{const[r,a]=v.useState([]),[n,i]=v.useState([]),[o,l]=v.useState(!1),[c,d]=v.useState(null),[u,m]=v.useState(""),[f,h]=v.useState({type:"",status:""}),[p,x]=v.useState({key:null,direction:"asc"}),[g,b]=v.useState([]);v.useEffect(()=>{if(!e)return;(async()=>{l(!0),d(null);try{let re;if(t==="my"){const me=await Vt.getMyDepartment();re=me&&Object.keys(me).length>0?[me]:[]}else re=await Vt.getDepartments();Array.isArray(re)||(console.error("Expected array but got:",typeof re,re),re=[]);const z=rn(re);a(z)}catch(re){console.error("Error loading departments:",re);const z=re?.response?.data?.message||re?.message||"Failed to load departments";d(z),a([])}finally{l(!1)}})()},[e,t]),v.useEffect(()=>{let ee=r;u&&(ee=ee.filter(re=>re.name.toLowerCase().includes(u.toLowerCase())||re.code.toLowerCase().includes(u.toLowerCase())||re.description.toLowerCase().includes(u.toLowerCase()))),f.type&&(ee=ee.filter(re=>re.type===f.type)),f.status&&(ee=ee.filter(re=>re.status===f.status)),i(ee)},[r,u,f]);const j=ee=>{let re="asc";p.key===ee&&p.direction==="asc"&&(re="desc"),x({key:ee,direction:re});const z=[...n].sort((me,ne)=>me[ee]<ne[ee]?re==="asc"?-1:1:me[ee]>ne[ee]?re==="asc"?1:-1:0);i(z)},y=async ee=>{l(!0),d(null);try{const re=await Vt.createDepartment(ee),z=await Vt.getDepartments(),me=rn(z);return a(me),re}catch(re){throw console.error("Error creating department:",re),d("Failed to create department"),re}finally{l(!1)}},w=async(ee,re)=>{l(!0),d(null);try{const z=await Vt.updateDepartment(ee,re),me=await Vt.getDepartments(),ne=rn(me);return a(ne),z}catch(z){throw console.error("Error updating department:",z),d("Failed to update department"),z}finally{l(!1)}},S=async ee=>{l(!0),d(null);try{await Vt.deleteDepartment(ee);const re=await Vt.getDepartments(),z=rn(re);a(z)}catch(re){throw console.error("Error deleting department:",re),d("Failed to delete department"),re}finally{l(!1)}},N=async ee=>{l(!0),d(null);try{await Vt.toggleDepartmentStatus(ee);const re=await Vt.getDepartments(),z=rn(re);a(z)}catch(re){throw console.error("Error toggling department status:",re),J.error("Failed to toggle department status"),re}finally{l(!1)}},E=async ee=>{l(!0),d(null);try{await Vt.disableDepartment(ee);const re=await Vt.getDepartments(),z=rn(re);a(z)}catch(re){throw console.error("Error disabling department:",re),J.error("Failed to disable department"),re}finally{l(!1)}},P=async ee=>{l(!0),d(null);try{await Vt.enableDepartment(ee);const re=await Vt.getDepartments(),z=rn(re);a(z)}catch(re){throw console.error("Error enabling department:",re),J.error("Failed to enable department"),re}finally{l(!1)}},T=async ee=>{l(!0),d(null);try{await Vt.bulkDeleteDepartments(ee);const re=await Vt.getDepartments(),z=rn(re);a(z),b([])}catch(re){throw console.error("Error bulk deleting departments:",re),J.error("Failed to delete departments"),re}finally{l(!1)}},O=async(ee,re)=>{l(!0),d(null);try{await Vt.bulkToggleStatus(ee,re);const z=await Vt.getDepartments(),me=rn(z);a(me),b([])}catch(z){throw console.error("Error bulk toggling department status:",z),J.error("Failed to update department status"),z}finally{l(!1)}},_=ee=>{b(re=>re.includes(ee)?re.filter(z=>z!==ee):[...re,ee])},C=()=>{g.length===n.length?b([]):b(n.map(ee=>ee.id))},R=(ee,re)=>{h(z=>({...z,[ee]:re}))},M=()=>{h({type:"",status:""}),m("")},U=v.useCallback(async()=>{try{return(await Vt.getDepartmentHeads())?.users||[]}catch(ee){return console.error("Error fetching department heads:",ee),J.error("Failed to load department heads"),[]}},[]);return{departments:n,selectedDepartments:g,loading:o,error:c,searchTerm:u,setSearchTerm:m,filters:f,sortConfig:p,createDepartment:y,updateDepartment:w,deleteDepartment:S,toggleDepartmentStatus:N,disableDepartment:E,enableDepartment:P,bulkDeleteDepartments:T,bulkToggleStatus:O,sortDepartments:j,handleSelectDepartment:_,handleSelectAll:C,handleFilterChange:R,clearFilters:M,getAvailableUsers:U,refreshDepartments:async()=>{l(!0),d(null);try{const ee=await Vt.getDepartments(),re=rn(ee);a(re)}catch(ee){console.error("Error refreshing departments:",ee),d("Failed to refresh departments")}finally{l(!1)}},setError:d}},Te={VIEW_ALL_USERS:"PERM-003",VIEW_USER_DETAILS:"PERM-004",UPDATE_USER:"PERM-005",CREATE_ROLE:"PERM-007",VIEW_ALL_ROLES:"PERM-008",UPDATE_ROLE:"PERM-009",CREATE_DEPARTMENT:"PERM-011",VIEW_ALL_DEPARTMENTS:"PERM-012",VIEW_DEPARTMENT_DETAILS:"PERM-013",UPDATE_DEPARTMENT:"PERM-014",CREATE_COURSE:"PERM-016",VIEW_ALL_COURSES:"PERM-017",VIEW_COURSE_DETAILS:"PERM-018",UPDATE_COURSE:"PERM-019",ARCHIVE_COURSE:"PERM-020",ASSIGN_TRAINERS:"PERM-021",REMOVE_TRAINERS:"PERM-022",CREATE_BULK_SUBJECTS:"PERM-023",CREATE_SUBJECT:"PERM-024",VIEW_SUBJECT_DETAILS:"PERM-026",UPDATE_SUBJECT:"PERM-027",ARCHIVE_SUBJECT:"PERM-028",BULK_ENROLL_TRAINEES:"PERM-029",ENROLL_SINGLE_TRAINEE:"PERM-030",VIEW_ALL_ENROLLMENTS:"PERM-031",REMOVE_TRAINEE_FROM_ENROLLMENT:"PERM-032",CREATE_TEMPLATE:"PERM-033",EDIT_DRAFT_TEMPLATE:"PERM-034",UPDATE_TEMPLATE_VERSION:"PERM-037",APPROVE_DENY_TEMPLATE:"PERM-039",VIEW_ALL_TEMPLATE:"PERM-040",VIEW_TEMPLATE_DETAILS:"PERM-041",DOWNLOAD_TEMPLATE_AS_PDF:"PERM-042",VIEW_ALL_INCIDENT_FEEDBACK_REPORT:"PERM-043",VIEW_INCIDENT_FEEDBACK_REPORT_DETAILS:"PERM-044",VIEW_SUBMITTED_REPORTS:"PERM-045",SUBMIT_INCIDENT_FEEDBACK_REPORT:"PERM-046",ACKNOWLEDGE_INCIDENT_REPORTS:"PERM-048",CREATE_GLOBAL_FIELD:"PERM-050",VIEW_ALL_GLOBAL_FIELDS:"PERM-051",UPDATE_GLOBAL_FIELD:"PERM-053"},NR={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT","ACADEMIC DEPARTMENT":"ACADEMIC_DEPARTMENT",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD","DEPARTMENT HEAD":"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD"},SR=e=>{if(!e)return null;const t=typeof e=="string"?e:e?.name||"";if(!t)return null;const r=t.toUpperCase().replace(/\s+/g,"_").trim();return NR[r]||r},Xx=(e,t=[])=>{if(!t||t.length===0)return!0;const r=SR(e?.role);return r?t.some(a=>a===r):!1},ER=[{id:"main-menu",label:"Main Menu",path:je.MAIN_MENU,icon:"list",roleOnly:["ADMINISTRATOR"]},{id:"users",label:"User Management",path:je.USERS,icon:"people",permissions:[Te.VIEW_ALL_USERS]},{id:"roles",label:"Role Management",path:je.ROLES,icon:"shield",permissions:[Te.VIEW_ALL_ROLES]},{id:"departments",label:"Departments",path:je.DEPARTMENTS,icon:"building",permissions:[Te.VIEW_ALL_DEPARTMENTS,Te.UPDATE_DEPARTMENT],requireAll:!0},{id:"forms",label:"Template List",path:je.TEMPLATES,icon:"fileText",customPermissionLogic:e=>e(Te.VIEW_ALL_TEMPLATE)},{id:"system-config",label:"Global Fields",path:je.SYSTEM_CONFIG,icon:"gear",permissions:[Te.VIEW_ALL_GLOBAL_FIELDS]},{id:"academic-dashboard",label:"Academic Dashboard",path:"/academic/dashboard",icon:"house",roleOnly:["ACADEMIC_DEPARTMENT"]},{id:"trainee-dashboard",label:"Trainee Dashboard",path:je.DASHBOARD,icon:"house",roleOnly:["TRAINEE"]},{id:"enrolled-courses",label:"Enrolled Course List",path:je.COURSES_ENROLLED,icon:"book",roleOnly:["TRAINEE"]},{id:"all-assessments",label:"All Assessments",path:je.ASSESSMENTS_MY_ASSESSMENTS,icon:"checkCircle",roleOnly:["TRAINEE"],children:[{id:"your-assessments",label:"Your Assessments",path:je.ASSESSMENTS_MY_ASSESSMENTS,roleOnly:["TRAINEE"]},{id:"signature-required",label:"Signature Required List",path:je.ASSESSMENTS_SIGNATURE_REQUIRED,roleOnly:["TRAINEE"]}]},{id:"create-issue",label:"Issue Reporting",path:je.REPORTS_CREATE,icon:"fileEarmarkText",permissions:[Te.VIEW_SUBMITTED_REPORTS]},{id:"assigned-assessments",label:"Assigned Assessments",path:je.ASSESSMENTS_UPCOMING,icon:"clock",roleOnly:["TRAINER"]},{id:"instructed-courses",label:"Instructed Course",path:je.COURSES_INSTRUCTED,icon:"book",roleOnly:["TRAINER"]},{id:"department-dashboard",label:"Department Dashboard",path:"/department-head/dashboard",icon:"building",roleOnly:["DEPARTMENT_HEAD"]},{id:"assessment-review-requests",label:"Assessment Review Requests",path:je.DEPARTMENT_REVIEW_REQUESTS,icon:"clipboardCheck",roleOnly:["DEPARTMENT_HEAD"]},{id:"incidents-feedback",label:"Incidents / Feedback Report",path:je.REPORTS,icon:"exclamationTriangle",permissions:[Te.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,Te.ACKNOWLEDGE_INCIDENT_REPORTS],requireAll:!0}],TR=(e,t)=>!e.permissions||e.permissions.length===0?!0:e.requireAll?e.permissions.every(r=>t(r)):e.permissions.some(r=>t(r)),CR=(e,t)=>!e.excludePermissions||e.excludePermissions.length===0?!1:e.excludePermissions.some(r=>t(r)),WS=(e,t,r)=>e.reduce((a,n)=>{if(n.roleOnly&&!Xx(t,n.roleOnly)||CR(n,r))return a;let i;n.customPermissionLogic?i=n.customPermissionLogic(r):i=TR(n,r);let o=[];return n.children&&n.children.length>0&&(o=WS(n.children,t,r)),(i||o.length>0||!n.permissions&&!n.customPermissionLogic&&(!n.children||n.children.length===0))&&a.push({...n,children:o}),a},[]),HS=(e,t)=>WS(ER,e,t),AR=(e,t,r=je.DASHBOARD)=>{if(!e)return r;const a=HS(e,t);return a.length===0?r:a[0].path||r},_R=e=>Xx(e,["ACADEMIC_DEPARTMENT"]),kR=e=>Xx(e,["DEPARTMENT_HEAD"]),cy=({collapsed:e,onClose:t})=>{const{hasPermission:r}=Fn(),{user:a}=zr(),n=ya(),i=tt(),o=v.useMemo(()=>_R(a),[a]),l=v.useMemo(()=>{const y=r(Te.VIEW_ALL_DEPARTMENTS),w=r(Te.UPDATE_DEPARTMENT),S=r(Te.VIEW_DEPARTMENT_DETAILS);return y&&!w?{show:!0,mode:"all"}:S&&!y?{show:!0,mode:"my"}:{show:!1,mode:null}},[r]),{departments:c,loading:d}=Yx(l.show,l.mode),[u,m]=v.useState(!1),[f,h]=v.useState(null),[p,x]=v.useState(!1),g=v.useRef(null);v.useEffect(()=>{if(g.current&&u){const y=g.current,w=y.scrollHeight>y.clientHeight;x(w)}},[u,c]);const b=v.useMemo(()=>HS(a,r),[a,r]),j=v.useMemo(()=>({list:Xd,people:Mr,shield:Ux,building:Vs,fileText:xt,gear:Mx,house:K2,personCheck:_n,clock:Ke,book:Dt,clipboardCheck:rr,exclamationTriangle:Jt,checkCircle:Je,fileEarmarkText:Ju}),[]);return s.jsxs("div",{className:`bg-primary-custom text-white d-flex flex-column transition-all ${e?"sidebar-collapsed":""}`,style:{width:e?"60px":"260px",minHeight:"100vh",transition:"width 0.3s ease",position:"fixed",top:0,left:0,height:"100vh",overflowY:"hidden",overflowX:"hidden",zIndex:t?1051:1e3,flexShrink:0,pointerEvents:"auto"},onClick:y=>{y.stopPropagation()},children:[s.jsxs("div",{className:"p-3 border-bottom border-secondary bg-gradient-primary-custom position-relative",style:{zIndex:1},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[!e&&s.jsx(s.Fragment,{children:s.jsx("img",{src:o3,alt:"Logo",style:{width:"50%",marginRight:"0px"}})}),e&&s.jsx("div",{children:s.jsx(F2,{size:24})})]}),t&&s.jsx(te,{variant:"link",className:"position-absolute top-0 end-0 text-white p-2 d-lg-none",onClick:y=>{y.preventDefault(),y.stopPropagation(),t&&t()},onTouchEnd:y=>{y.preventDefault(),y.stopPropagation(),t&&t()},style:{border:"none",background:"transparent",zIndex:1052,minWidth:"40px",minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",pointerEvents:"auto"},"aria-label":"Close sidebar",children:s.jsx(st,{size:24})})]}),s.jsxs(Xe,{className:"flex-column flex-grow-1 p-3 bg-gradient-primary-custom",children:[b.map(y=>{const w=j[y.icon]||Xd,S=y.children?.some(T=>n.pathname===T.path),N=n.pathname===y.path||S,E=y.children&&y.children.length>0,P=f===y.id;return E?s.jsx(Xe.Item,{className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${N?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:N?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(i(y.path),t&&t()):h(T=>T===y.id?null:y.id)},children:[s.jsx(w,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:y.label}),s.jsx(ai,{size:16,className:`ms-auto transition-transform ${P?"rotate-180":""}`,style:{transition:"transform 0.3s ease"}})]})]}),!e&&P&&y.children?.length>0&&s.jsx("div",{className:"mt-2 ms-4",children:y.children.map(T=>s.jsx(sd,{to:T.path,className:"sidebar-nav-link text-white d-flex align-items-center py-2 pe-1 rounded nav-link",style:{backgroundColor:n.pathname===T.path?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:"normal",overflowWrap:"break-word"},onClick:()=>{t&&t()},children:s.jsx("span",{className:"sidebar-nav-label",children:T.label})},T.id))})]})},y.id):s.jsx(Xe.Item,{className:"mb-3",children:s.jsxs(sd,{to:y.path,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${N?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:N?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",overflowWrap:e?"normal":"break-word"},onClick:()=>{t&&t()},children:[s.jsx(w,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsx("span",{className:"sidebar-nav-label",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:y.label})]})},y.id)}),o&&s.jsx(Xe.Item,{className:"mb-3",children:s.jsxs(sd,{to:je.ASSESSMENT_EVENTS,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${n.pathname===je.ASSESSMENT_EVENTS?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:n.pathname===je.ASSESSMENT_EVENTS?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",overflowWrap:e?"normal":"break-word"},onClick:()=>{t&&t()},children:[s.jsx(fa,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsx("span",{className:"sidebar-nav-label",style:{overflowWrap:"break-word",lineHeight:"1.2"},children:"Assessment Event"})]})}),l.show&&s.jsx(Xe.Item,{className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${n.pathname.startsWith("/academic/departments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:n.pathname.startsWith("/academic/departments")?"rgba(255, 255, 255, 0.1)":"transparent"},children:[s.jsx(Vs,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{cursor:"pointer",overflowWrap:"break-word",lineHeight:"1.2"},onClick:()=>{m(!u),l.mode==="my"&&c.length===1?i(`/academic/course/${c[0].id}`):i("/academic/departments")},children:"Department"}),s.jsx(ai,{size:16,className:"ms-auto",style:{transition:"transform 0.3s ease",cursor:"pointer",transform:u?"rotate(180deg)":"rotate(0deg)"},onClick:()=>{m(!u)}})]})]}),!e&&u&&s.jsx("div",{ref:g,className:`position-absolute start-0 end-0 mt-1 sidebar-department-dropdown ${p?"scrollable":""}`,style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:d?s.jsx("div",{className:"px-3 py-2 text-white-50 sidebar-department-loading",children:s.jsx("small",{children:"Loading departments..."})}):c.length>0?c.map(y=>s.jsxs(sd,{to:`/academic/course/${y.id}`,className:`d-block px-3 py-2 text-white text-decoration-none d-flex align-items-center sidebar-department-item ${n.pathname===`/academic/course/${y.id}`?"active":""}`,style:{fontSize:"0.875rem",backgroundColor:n.pathname===`/academic/course/${y.id}`?"rgba(255, 255, 255, 0.15)":"transparent",overflowWrap:"break-word",whiteSpace:"normal"},onClick:()=>{t&&t()},children:[s.jsx(Xu,{size:12,className:"me-2 sidebar-department-chevron"}),y.code]},y.id)):s.jsx("div",{className:"px-3 py-2 text-white-50",children:s.jsx("small",{children:"No departments found"})})})]})})]})]})},on={getProfile:async()=>{try{const e=await be.get("/profile");return e.data&&e.data.data?e.data.data:e.data}catch(e){throw console.error("Error fetching profile:",e),e}},updateAvatar:async e=>{try{const t=new FormData;t.append("avatar",e);const r=await be.put("/profile",t,{headers:{"Content-Type":"multipart/form-data"}});return r.data&&r.data.data?r.data.data:r.data}catch(t){throw console.error("Error updating avatar:",t),t}},updateProfile:async e=>{try{const t=new FormData;e instanceof File?t.append("avatar",e):typeof e=="object"&&e!==null&&Object.keys(e).forEach(a=>{const n=e[a];n!=null&&t.append(a,n)}),console.log("updateProfile - sending FormData with keys:",Array.from(t.keys()));const r=await be.put("/profile",t,{headers:{"Content-Type":"multipart/form-data"}});return console.log("updateProfile - response:",r.data),r.data&&r.data.data?r.data.data:r.data}catch(t){throw console.error("Error updating profile:",t),console.error("Error response:",t.response?.data),t.response?.data?.errors&&console.error("Validation errors:",t.response.data.errors),t}},resetPassword:async e=>{try{return(await be.put("/profile/password",e)).data}catch(t){throw console.error("Error resetting password:",t),t}},updateSignature:async e=>{try{return(await be.put("/profile/signature",{signatureImageUrl:e})).data}catch(t){throw console.error("Error updating signature:",t),t}}},DR=()=>{const[e,t]=v.useState(null),[r,a]=v.useState(!0),[n,i]=v.useState(null),o=async()=>{try{a(!0),i(null);const u=await on.getProfile();t(u)}catch(u){console.error("Error fetching profile:",u),i(u.message||"Failed to fetch profile")}finally{a(!1)}},l=async u=>{try{a(!0),i(null);const m=await on.updateProfile(u);return t(m),m}catch(m){throw console.error("Error updating profile:",m),i(m.message||"Failed to update profile"),m}finally{a(!1)}},c=()=>{if(!e)return"Loading...";const{firstName:u,lastName:m,middleName:f}=e,h=[];return u&&h.push(u),f&&h.push(f),m&&h.push(m),h.join(" ")||"User"},d=()=>e?.role?e.role.name:"User";return v.useEffect(()=>{o()},[]),{profile:e,loading:r,error:n,fetchProfile:o,updateProfile:l,getDisplayName:c,getRoleName:d}},IR={position:"absolute",top:"100%",right:"0",zIndex:9999,minWidth:"250px",maxWidth:"300px",backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",borderRadius:"0.375rem",padding:"0.5rem 0",width:"auto",height:"auto",overflow:"visible",boxShadow:"none !important",WebkitBoxShadow:"none !important",MozBoxShadow:"none !important"},OR=({onToggleSidebar:e})=>{const t=ya(),r=tt(),[a,n]=v.useState(!1),[i,o]=v.useState(!1),l=v.useRef(null),{user:c,isLoading:d}=zr(),{profile:u,getDisplayName:m,loading:f}=DR(),h=()=>{if(!c||f)return"Loading...";if(u&&m&&m()&&m()!=="Loading..."){const w=m();if(w&&w.trim()!=="")return w}if(u&&u.firstName){const w=[u.firstName];u.middleName&&w.push(u.middleName),u.lastName&&w.push(u.lastName);const S=w.join(" ").trim();if(S)return S}if(c.fullName&&c.fullName!=="User"&&c.fullName.trim()!=="")return c.fullName;if(c.firstName&&c.lastName)return`${c.firstName} ${c.lastName}`;try{const w=localStorage.getItem("authToken");if(w){const S=JSON.parse(atob(w.split(".")[1]));if(S.fullName&&S.fullName!=="User")return S.fullName;if(S.name&&S.name!=="User")return S.name;if(S.firstName&&S.lastName)return`${S.firstName} ${S.lastName}`}}catch(w){console.error("Error parsing JWT token for display name:",w)}return c.name||"User"},p=()=>c&&c.email||"No email",x=w=>{const S=OS(w),N={"/profile":"Profile","/dashboard":"Dashboard","/users":"User Management","/roles":"Role Management","/departments":"Department Management","/templates":"Template List","/templates/editor":"Template Editor","/templates/drafts":"Your Drafts","/main-menu":"Main Menu","/system-config":"Global Field List","/courses/instructed":"Instructed Courses","/courses/enrolled":"Enrolled Course List","/assessments/upcoming":"Upcoming Assessments","/assessments/my-assessments":"Your Assessments","/assessments/results":"Assessment Results","/assessments/signature-required":"Signature Required List","/assessments/completion-required":"Section Completion Required List","/assessment-events":"Assessment Event","/reports":"Incidents / Feedback Report","/reports/create":"Issue Reporting","/reports/issues":"Incidents / Feedback Report","/reports/feedback":"Incidents / Feedback Report","/reports/:reportId":"Report Details","/configure-signature":"Configure Signature","/my-department-details":"My Department Details","/assessment-review-requests":"Assessment Review Requests","/academic-details":"Academic Details","/admin":"Dashboard","/admin/dashboard":"Dashboard","/admin/users":"User Management","/admin/roles":"Role Management","/admin/departments":"Department Management","/admin/forms":"Template List","/admin/forms/drafts":"Your Drafts","/admin/main-menu":"Main Menu","/admin/system-config":"Global Field List","/academic":"Academic Dashboard","/academic/dashboard":"Academic Dashboard","/academic/departments":"Department Management","/academic/assessment-events":"Assessment Event","/trainee":"Trainee Dashboard","/trainee/dashboard":"Trainee Dashboard","/trainee/academic-details":"Academic Details","/trainee/enrolled-courses":"Enrolled Course List","/trainee/signature-required":"Signature Required List","/trainee/completion-required":"Section Completion Required List","/trainee/your-assessments":"Your Assessments","/trainee/create-incident-feedback-report":"Issue Reporting","/trainee/assessment-pending/section-completion":"Section Completion Required List","/trainer":"Trainer Dashboard","/trainer/dashboard":"Trainer Dashboard","/trainer/upcoming-assessments":"Upcoming Assessments","/trainer/assessment-results":"Assessment Results","/trainer/assess":"Assessments","/trainer/assessments":"Assessment Sections","/trainer/instructed-courses":"Instructed Courses","/trainer/courses":"Course Details","/trainer/configure-signature":"Configure Signature","/trainer/section-completion":"Section Completion","/trainer/assessment-details":"Assessment Result Details","/trainer/approval-notes":"Result Approval Note","/sqa":"Issue List","/sqa/issues":"Issue List","/sqa/feedback":"Feedback List","/sqa/templates":"Template List","/sqa/templates/history":"Template History","/sqa/templates/sections":"Template Sections","/sqa/templates/fields":"Template Fields","/sqa/templates/pdf-preview":"PDF Preview","/department-head":"Department Dashboard","/department-head/dashboard":"Department Dashboard","/department-head/my-department-details":"My Department Details","/department-head/assessment-review-requests":"Assessment Review Requests"};return w.startsWith("/department-head/my-department-details/")&&w!=="/department-head/my-department-details"&&!w.includes("/subjects/")?"Course Details":w.startsWith("/admin/departments/")&&w!=="/admin/departments"?"Department Details":w.startsWith("/academic/departments/")&&w!=="/academic/departments"?"Department Management":w.includes("/enroll-trainees")?"Trainee Enrollments":w.startsWith("/academic/course/")&&!w.includes("/subject/")?"Department Details":w.startsWith("/academic/course-detail/")?"Course Details":w.includes("/subject/")?"Subject Details":w.includes("/enroll-trainees")?"Enroll Trainees":w.match(/^\/trainee\/[^/]+\/course\/[^/]+$/)?"Enrolled Course Details":w.match(/^\/trainee\/[^/]+\/course\/[^/]+\/subject\/[^/]+$/)?"Enrolled Subject Details":w.startsWith("/templates/editor")||w.startsWith("/admin/forms/editor")?"Template Editor":w.match(/^\/trainee\/[^/]+\/assessment\/[^/]+$/)||w.match(/^\/trainee\/[^/]+\/assessments$/)?"Assessment Details":w.match(/^\/trainee\/[^/]+\/signature-pad\/[^/]+$/)?"Digital Signature":w.match(/^\/trainee\/[^/]+\/assessment-section\/[^/]+$/)?"Assessment Section":w.match(/^\/courses\/[^/]+$/)&&!w.includes("/enroll-trainees")&&!w.includes("/subjects/")?"Course Details":w.match(/^\/assessments\/assign\/[^/]+\/[^/]+$/)?"Assessments":w.match(/^\/assessments\/[^/]+\/sections$/)?"Assessment Sections":w.match(/^\/assessments\/sections\/[^/]+\/fields$/)?"Field":w.match(/^\/courses\/[^/]+\/enroll-trainees$/)?"Trainee Enrollments":w.match(/^\/courses\/[^/]+\/subjects\/[^/]+$/)?"Subject Details":w.match(/^\/departments\/[^/]+$/)?"Department Details":w.match(/^\/my-department-details\/[^/]+$/)&&!w.includes("/subjects/")?"Course Details":w.match(/^\/assessment-review-requests\/[^/]+$/)?"Assessment Review Request Details":w.match(/^\/reports\/[^/]+$/)&&w!=="/reports"&&w!=="/reports/create"?"Report Details":w.match(/^\/templates\/[^/]+$/)&&w!=="/templates"&&!w.startsWith("/templates/editor")&&!w.startsWith("/templates/drafts")||w.startsWith("/sqa/templates/")&&w!=="/sqa/templates"?"Template Detail":w.startsWith("/trainer/trainees/")?"Trainee Details":w.startsWith("/trainer/subjects/")?"Subject Details":w.startsWith("/trainer/courses/")?"Course Details":w.startsWith("/trainer/assessment-details/")?"Assessment Result Details":w.match(/^\/trainer\/assessments\/sections\/[^/]+\/fields$/)?"Field":w.startsWith("/trainer/assessments/")?"Assessment Sections":w.startsWith("/trainer/assess/")?"Assessments":w.startsWith("/trainer/approval-notes/")?"Result Approval Note":w.includes("/department-head/courses/")&&w.includes("/subjects/")?"Subject Details":w.startsWith("/department-head/trainees/")||w.startsWith("/trainee/")&&w!=="/trainee"&&!w.startsWith("/trainee/dashboard")&&!w.startsWith("/trainee/academic-details")&&!w.startsWith("/trainee/enrolled-courses")&&!w.startsWith("/trainee/assessment-pending")&&!w.startsWith("/trainee/create-incident-feedback-report")&&!w.startsWith("/trainee/signature-required")&&!w.startsWith("/trainee/completion-required")&&!w.startsWith("/trainee/your-assessments")?"Trainee Details":N[S]||N[w]||"Dashboard"},g=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user");const w=()=>window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/";window.location.href=w()},b=()=>{n(!a)},j=()=>{n(!1)},y=()=>{r("/profile"),n(!1)};return v.useEffect(()=>{const w=S=>{l.current&&!l.current.contains(S.target)&&o(!1)};return i&&document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[i]),s.jsxs(s.Fragment,{children:[s.jsx(B1,{bg:"white",expand:"lg",className:"border-bottom border-neutral-200 shadow-sm",style:{minHeight:"60px"},children:s.jsxs("div",{className:"container-fluid",children:[s.jsx(te,{variant:"link",className:"text-primary-custom p-2 me-3",onClick:e,style:{border:"none",background:"transparent"},children:s.jsx(Xd,{size:20})}),s.jsx(B1.Brand,{className:"text-primary-custom fw-bold custom-title",children:x(t.pathname)}),s.jsx("div",{className:"d-none d-lg-block ms-auto",style:{position:"relative"},children:s.jsxs("div",{ref:l,style:{position:"relative"},children:[s.jsxs("button",{className:"text-primary-custom p-0 d-flex align-items-center",style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",boxShadow:"none",WebkitBoxShadow:"none",MozBoxShadow:"none"},onClick:()=>o(!i),children:[s.jsx(To,{size:32,className:"me-2"}),s.jsx("span",{children:d||f?"Loading...":h()})]}),s.jsxs("div",{className:`custom-dropdown ${i?"show":"hide"}`,style:IR,children:[s.jsxs("div",{className:"dropdown-header",style:{padding:"0.5rem 1rem",wordBreak:"break-all"},children:[s.jsx("div",{className:"fw-bold text-primary-custom",children:d||f?"Loading...":h()}),s.jsx("small",{className:"text-muted",style:{wordBreak:"break-all",whiteSpace:"normal",lineHeight:"1.2"},children:d?"Loading...":p()})]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item d-flex align-items-center text-primary-custom",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),y()},children:[s.jsx(To,{className:"me-2",size:16}),"Profile"]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item d-flex align-items-center text-danger",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),g()},children:[s.jsx(c0,{className:"me-2",size:16}),"Logout"]})]})]})}),s.jsx("div",{className:"d-lg-none text-primary-custom p-2",onClick:b,style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",marginLeft:"auto"},children:s.jsx(To,{size:32})})]})}),a&&s.jsx("div",{className:`profile-menu-overlay ${a?"show":""}`,onClick:j}),s.jsxs("div",{className:`profile-menu-slide ${a?"show":""}`,children:[s.jsxs("div",{className:"profile-menu-header",children:[s.jsx("button",{className:"profile-menu-close",onClick:j,"aria-label":"Close profile menu",children:s.jsx(st,{size:20})}),s.jsx("div",{className:"profile-avatar",children:s.jsx(To,{size:40})}),s.jsx("div",{className:"profile-name",children:d||f?"Loading...":h()}),s.jsx("div",{className:"profile-email",children:d?"Loading...":p()})]}),s.jsxs("ul",{className:"profile-menu-items",children:[s.jsx("li",{className:"profile-menu-item",children:s.jsxs("a",{href:"#",className:"profile-menu-link",onClick:w=>{w.preventDefault(),y()},children:[s.jsx(To,{className:"icon"}),"Profile"]})}),s.jsx("li",{className:"profile-menu-item",children:s.jsxs("a",{href:"#",className:"profile-menu-link danger",onClick:w=>{w.preventDefault(),j(),g()},children:[s.jsx(c0,{className:"icon"}),"Logout"]})})]})]})]})},PR=({children:e})=>{const[t,r]=v.useState(()=>{try{const d=localStorage.getItem("sidebarCollapsed");return d?d==="true":!1}catch{return!1}}),[a,n]=v.useState(!1),[i,o]=v.useState(!1);v.useEffect(()=>{a&&console.log(" Sidebar state:",{isMobile:a,sidebarOpen:i})},[a,i]),v.useEffect(()=>{const d=()=>{const u=window.innerWidth<=768;n(u),!u&&i&&o(!1)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[i]),v.useEffect(()=>{try{localStorage.setItem("sidebarCollapsed",t)}catch{}},[t]);const l=()=>{a?o(!i):r(!t)},c=v.useCallback(()=>{console.log(" closeSidebar called",{isMobile:a,sidebarOpen:i}),a&&(console.log(" Setting sidebarOpen to false"),o(!1))},[a,i]);return s.jsxs("div",{className:"d-flex",style:{height:"100vh",overflow:"hidden"},children:[s.jsx("div",{className:`sidebar-desktop ${t?"sidebar-collapsed":""}`,children:s.jsx(cy,{collapsed:t})}),a&&s.jsxs(s.Fragment,{children:[i&&s.jsx("div",{className:"sidebar-mobile-overlay",onClick:d=>{d.preventDefault(),d.stopPropagation(),c()},onTouchEnd:d=>{d.preventDefault(),d.stopPropagation(),c()},style:{cursor:"pointer"}}),s.jsx("div",{className:`sidebar-mobile ${i?"show":""}`,onClick:d=>{d.stopPropagation()},children:i&&s.jsx(cy,{collapsed:!1,onClose:c})})]}),s.jsxs("div",{className:`flex-grow-1 d-flex flex-column ${a?"main-content-mobile":""} ${!a&&t?"sidebar-collapsed-active":""}`,style:{marginLeft:a?"0":t?"60px":"260px",transition:"margin-left 0.3s ease",width:a?"100%":`calc(100% - ${t?"60px":"260px"})`},children:[s.jsx(OR,{onToggleSidebar:l}),s.jsx("main",{className:"flex-grow-1 bg-light-custom",style:{overflowY:"auto"},children:e})]})]})},Ft=()=>s.jsx(PR,{children:s.jsx(L5,{})}),_r=(e,t=null,r="asc")=>{const[a,n]=v.useState({key:t,direction:r});return{sortedData:v.useMemo(()=>!a.key||!e?e:[...e].sort((d,u)=>{let m=d[a.key],f=u[a.key];if(a.key.includes(".")){const h=a.key.split(".");m=h.reduce((p,x)=>p?.[x],d),f=h.reduce((p,x)=>p?.[x],u)}if(a.key.includes("length")){const h=a.key.replace(".length","");m=d[h]?.length||0,f=u[h]?.length||0}return typeof m=="string"&&typeof f=="string"&&(m=m.toLowerCase(),f=f.toLowerCase()),m<f?a.direction==="asc"?-1:1:m>f?a.direction==="asc"?1:-1:0}),[e,a]),sortConfig:a,handleSort:d=>{let u="asc";if(a.key===d&&a.direction==="asc")u="desc";else if(a.key===d&&a.direction==="desc"){n({key:null,direction:"asc"});return}n({key:d,direction:u})},getSortIcon:d=>a.key!==d?"":a.direction==="asc"?"":"",getSortClass:d=>a.key!==d?"text-muted":(a.direction==="asc","text-primary")}},VS=({data:e,loading:t,columns:r,renderRow:a,emptyMessage:n="No data found",emptyDescription:i="Try adjusting your search criteria."})=>{const{sortedData:o,sortConfig:l,handleSort:c}=_r(e);if(t)return s.jsx(nr,{rows:5,columns:r.length});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:n}),s.jsx("p",{children:i})]})});const d=({columnKey:u,children:m,className:f=""})=>{const h=l.key===u,p=h?l.direction:null;return s.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:p,size:14,color:"white"})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsx("tr",{children:r.map((u,m)=>u.sortable?s.jsx(d,{columnKey:u.key,className:u.className||"",children:u.title},m):s.jsx("th",{className:`fw-semibold ${u.className||""}`,style:{textTransform:"uppercase",letterSpacing:"0.5px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:u.title},m))})}),s.jsx("tbody",{children:o.map((u,m)=>a(u,m))})]})})},RR=({children:e})=>s.jsx(MP,{children:e}),_t=()=>{const e=M5(),t=tt(),a=(o=>o?.status===404?{title:"404 - Page Not Found",message:"The page you're looking for doesn't exist.",suggestion:"Check the URL or go back to the dashboard."}:o?.status===403?{title:"403 - Access Denied",message:"You don't have permission to access this page.",suggestion:"Contact your administrator for access."}:{title:"Something went wrong",message:o?.message||"An unexpected error occurred.",suggestion:"Please try refreshing the page or contact support."})(e),n=()=>{t((window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/")+"/admin")},i=()=>{t(-1)};return s.jsx(Ce,{fluid:!0,className:"py-5",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-50",children:s.jsxs("div",{className:"text-center",style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h1",{className:"display-1 text-muted",children:""}),s.jsx("h2",{className:"text-primary-custom mb-3",children:a.title}),s.jsx("p",{className:"text-muted mb-4",children:a.message}),s.jsx("p",{className:"small text-muted",children:a.suggestion})]}),s.jsxs("div",{className:"d-flex gap-3 justify-content-center",children:[s.jsx(te,{variant:"primary",onClick:n,className:"px-4",children:"Go to Dashboard"}),s.jsx(te,{variant:"outline-secondary",onClick:i,className:"px-4",children:"Go Back"})]}),!1]})})})},FR=({title:e="Filter",options:t=[],selectedValue:r,onSelect:a,className:n="",variant:i="outline-secondary"})=>{const o=t.find(l=>l.value===r);return s.jsxs(St,{className:n,children:[s.jsxs(St.Toggle,{variant:i,className:"d-flex align-items-center",style:{borderColor:"var(--bs-neutral)",color:r?"var(--bs-primary)":"var(--bs-secondary)"},children:[s.jsx(oo,{className:"me-2",size:16}),o?o.label:e]}),s.jsxs(St.Menu,{className:"border-0 shadow",children:[s.jsxs(St.Item,{onClick:()=>a(""),className:r?"":"text-primary-custom bg-light",children:["All ",e,"s"]}),s.jsx(St.Divider,{}),t.map(l=>s.jsx(St.Item,{onClick:()=>a(l.value),className:r===l.value?"text-primary-custom bg-light":"",children:l.label},l.value))]})]})},nr=({rows:e=5,columns:t=4})=>{const r=()=>s.jsx("tr",{children:Array.from({length:t}).map((a,n)=>s.jsx("td",{children:s.jsx("div",{className:"placeholder-glow",style:{height:"20px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px",animation:"placeholder-glow 2s ease-in-out infinite alternate"},children:s.jsx("span",{className:"placeholder col-12"})})},n))});return s.jsxs(W,{className:"border-neutral-200",children:[s.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("div",{className:"placeholder-glow",style:{height:"24px",width:"200px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})}),s.jsx("div",{className:"placeholder-glow",style:{height:"32px",width:"100px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})})]})}),s.jsx(W.Body,{className:"p-0",children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"bg-neutral-50",children:s.jsx("tr",{children:Array.from({length:t}).map((a,n)=>s.jsx("th",{className:"border-neutral-200",children:s.jsx("div",{className:"placeholder-glow",style:{height:"16px",backgroundColor:"var(--bs-neutral-300)",borderRadius:"4px"},children:s.jsx("span",{className:"placeholder col-12"})})},n))})}),s.jsx("tbody",{children:Array.from({length:e}).map((a,n)=>s.jsx(r,{},n))})]})})})]})},zt=({permission:e,permissions:t=[],requireAll:r=!1,children:a,redirectTo:n=null})=>{const{hasPermission:i,hasAnyPermission:o,hasAllPermissions:l}=Fn(),{user:c}=zr();return(!e&&(!t||t.length===0)||c?.role==="TRAINEE"?!0:e?i(e):t&&t.length>0?r?l(t):o(t):!1)?a:s.jsxs("div",{className:"p-4 text-center text-muted",children:[s.jsx("h4",{children:"Access Denied"}),s.jsx("p",{children:"You don't have permission to access this page."}),s.jsxs("p",{className:"small text-muted",children:["Required permission: ",e||t.join(", ")]}),s.jsxs("p",{className:"small text-muted",children:["Your role: ",c?.role||"Unknown"]})]})},yt=({permission:e,permissions:t=[],requireAll:r=!1,children:a,fallback:n=null,showMessage:i=!1,message:o="You do not have permission to access this feature."})=>{const{hasPermission:l,hasAnyPermission:c,hasAllPermissions:d}=Fn();return(()=>{if(!e&&(!t||t.length===0))return!0;if(e)return l(e);if(t&&t.length>0){const m=t.filter(f=>f&&typeof f=="string");return m.length===0?!0:r?d(m):c(m)}return!1})()?a:n||(i?s.jsxs(De,{variant:"warning",className:"mt-3",children:[s.jsx(De.Heading,{children:"Access Denied"}),s.jsx("p",{children:o})]}):null)},Rr=({trigger:e,items:t=[],align:r="end",className:a="",onItemClick:n,placement:i="bottom-end",disabled:o=!1,...l})=>{const[c,d]=v.useState(!1),[u,m]=v.useState({top:0,left:0}),f=v.useRef(null),h=v.useRef(null),p=()=>{if(!f.current)return;const y=f.current.getBoundingClientRect(),w=200,S=150,N=4;let E,P;switch(i){case"bottom-start":E=y.bottom+N,P=y.left;break;case"bottom-end":E=y.bottom+N,P=y.right-w;break;case"top-start":E=y.top-S-N,P=y.left;break;case"top-end":E=y.top-S-N,P=y.right-w;break;default:E=y.bottom+N,P=y.right-w}E+S>window.innerHeight&&(E=y.top-S-N),E<0&&(E=N),P+w>window.innerWidth&&(P=window.innerWidth-w-N),P<0&&(P=N),m({top:E,left:P})},x=y=>{y.preventDefault(),y.stopPropagation(),!o&&(c||p(),d(!c))},g=()=>{d(!1)},b=y=>{y.onClick&&y.onClick(),n&&n(y),g()};v.useEffect(()=>{const y=S=>{c&&f.current&&!f.current.contains(S.target)&&h.current&&!h.current.contains(S.target)&&g()},w=S=>{S.key==="Escape"&&g()};return c&&(document.addEventListener("mousedown",y),document.addEventListener("keydown",w),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",y),document.removeEventListener("keydown",w),document.body.style.overflow=""}},[c]),v.useEffect(()=>{if(c){const y=()=>p(),w=()=>p();return window.addEventListener("scroll",y,!0),window.addEventListener("resize",w),()=>{window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",w)}}},[c,i]);const j=c&&Fx.createPortal(s.jsx("div",{ref:h,className:"dropdown-menu show portal-dropdown border-0",style:{position:"fixed",top:u.top,left:u.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:t.map((y,w)=>y.type==="header"?s.jsx("div",{className:`dropdown-header ${y.className||""}`,children:y.content},w):y.type==="divider"?s.jsx("div",{className:"dropdown-divider"},w):s.jsxs("button",{onClick:()=>b(y),className:`dropdown-item ${y.className||""}`,disabled:y.disabled,children:[y.icon&&s.jsx("span",{className:"me-2",children:y.icon}),y.label]},w))}),document.body);return s.jsxs("div",{className:`dropdown ${a}`,children:[s.jsx("button",{ref:f,className:`btn ${e?.variant==="link"?"btn-link":"btn-light"} ${e?.className||""}`,type:"button",onClick:x,disabled:o,"aria-expanded":c,"aria-haspopup":"true",style:e?.style||{},children:e?.children}),j]})},Lt=({children:e})=>{const{isAuthenticated:t,isLoading:r}=zr();return ya(),r?s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Checking authentication..."})]})}):t?e:s.jsx(B5,{to:"/",replace:!0})},ws=({placeholder:e="Search...",value:t,onChange:r,className:a="",size:n="md"})=>s.jsxs(z1,{className:a,size:n,children:[s.jsx(z1.Text,{className:"bg-white border-end-0",children:s.jsx(rS,{className:"text-primary-custom"})}),s.jsx(k.Control,{type:"text",placeholder:e,value:t,onChange:i=>r(i.target.value),className:"border-start-0",style:{borderColor:"var(--bs-neutral)",boxShadow:"none"},onFocus:i=>{i.target.style.borderColor="var(--bs-primary)",i.target.style.boxShadow="0 0 0 0.25rem rgba(27, 60, 83, 0.25)"},onBlur:i=>{i.target.style.borderColor="var(--bs-neutral)",i.target.style.boxShadow="none"}})]}),rs=({direction:e,size:t=16,color:r})=>{const a=r||"var(--bs-primary)",n={fontSize:`${t}px`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"inline-block",lineHeight:1,fontWeight:"bold"};return e==="asc"?s.jsx("span",{style:{...n,color:a,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):e==="desc"?s.jsx("span",{style:{...n,color:a,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):s.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"1px",lineHeight:1,verticalAlign:"middle"},className:r?"":"text-muted sort-icon",children:[s.jsx("span",{style:{display:"inline-block",fontSize:`${t}px`,color:r||void 0,opacity:r?.8:.5,lineHeight:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:"bold"},children:""}),s.jsx("span",{style:{display:"inline-block",fontSize:`${t}px`,color:r||void 0,opacity:r?.8:.5,lineHeight:1,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:"bold"},children:""})]})},ld=({name:e,value:t,onChange:r,options:a=[],placeholder:n="Select an option",disabled:i=!1,isInvalid:o=!1,className:l="",style:c={},...d})=>{const u=v.useRef(null),[m,f]=v.useState(!1),h=b=>{if(i)return;const y=b.target.getBoundingClientRect(),S=window.innerHeight*.15,E=y.top-S;E>0&&window.scrollTo({top:window.scrollY+E,behavior:"instant"}),f(!0)},p=b=>{i||setTimeout(()=>{const y=b.target.getBoundingClientRect(),S=window.innerHeight*.15,E=y.top-S;E>0&&window.scrollTo({top:window.scrollY+E,behavior:"instant"})},10)},x=b=>{f(!1),r&&r(b)},g=()=>{f(!1)};return s.jsxs(k.Select,{ref:u,name:e,value:t,onChange:x,onBlur:g,onClick:h,onFocus:p,disabled:i,isInvalid:o,className:l,style:{position:"relative",zIndex:1001,...c},...d,children:[s.jsx("option",{value:"",children:n}),a.map(b=>typeof b=="object"?s.jsx("option",{value:b.value,children:b.label},b.value):s.jsx("option",{value:b,children:b},b))]})},wr=()=>{const e=tt(),t=ya();return v.useEffect(()=>{const r=OS(t.pathname),a=t.search||"",n=t.hash||"",i=r+a+n;r!==t.pathname&&e(i,{replace:!0,state:t.state})},[t.pathname,t.search,t.hash,t.state,e]),null},LR=({show:e,onHide:t,pdfUrl:r,title:a="PDF Viewer"})=>s.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,fullscreen:"lg-down",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:a})}),s.jsx(ce.Body,{style:{padding:0,height:"70vh",minHeight:"500px"},children:r?s.jsx("iframe",{src:`${r}#toolbar=0`,style:{width:"100%",height:"100%",border:"none"},title:"PDF Viewer"}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsx("p",{className:"text-muted",children:"No PDF available"})})})]}),MR=(e=je.DASHBOARD)=>{const{user:t,userPermissions:r,isLoading:a}=zr(),{hasPermission:n}=Fn();return{firstRoute:v.useMemo(()=>a||!t||!r||r.length===0?e:AR(t,n,e),[t,r,n,a,e]),isLoading:a||!t||!r||r.length===0}},jo=()=>{const{user:e,isLoading:t}=zr(),r=tt(),a=ya(),{firstRoute:n,isLoading:i}=MR(je.DASHBOARD),o=v.useRef(!1);return v.useEffect(()=>{if(!(t||i||!e)){if(a.pathname===n){o.current=!0;return}o.current||(o.current=!0,r(n,{replace:!0}))}},[e,t,i,n,r,a.pathname]),t||i||!e?s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Loading..."})]})}):null},BR=({show:e,onHide:t})=>{const[r,a]=v.useState(""),[n,i]=v.useState(!1),[o,l]=v.useState(""),c=async u=>{u.preventDefault(),l(""),i(!0);try{const m=await fetch(`${Bo.BASE_URL}${Bo.ENDPOINTS.AUTH.FORGOT_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,magicLink:`${window.location.origin}${Gx()}reset-password/`})});if(!m.ok){m.status===405?l("Forgot password feature is not available on this server. Please contact support."):m.status===404?l("Forgot password endpoint not found. Please contact support."):l(`Server error (${m.status}). Please try again later.`);return}try{await m.json()}catch(f){console.error("JSON parsing error:",f),l("Server returned invalid response. Please try again later.");return}J.success("Password reset link has been sent to your email!"),a(""),t()}catch(m){console.error("Forgot password error:",m),m.name==="TypeError"&&m.message.includes("fetch")?l("Cannot connect to server. Please check your internet connection."):l("An unexpected error occurred. Please try again later.")}finally{i(!1)}},d=()=>{a(""),l(""),t()};return s.jsxs(ce,{show:e,onHide:d,centered:!0,children:[s.jsxs(ce.Header,{className:"border-0 pb-0",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[s.jsxs(ce.Title,{className:"d-flex align-items-center text-white",children:[s.jsx(Vi,{className:"me-2",size:20}),"Forgot Password"]}),s.jsx(te,{variant:"link",onClick:d,className:"p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:s.jsx(st,{})})]}),s.jsxs(ce.Body,{className:"pt-0",children:[s.jsx("p",{className:"text-muted mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),o&&s.jsx(De,{variant:"danger",className:"mb-3",children:o}),s.jsxs(k,{onSubmit:c,children:[s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Email Address"}),s.jsx(k.Control,{type:"email",placeholder:"Enter your email",value:r,onChange:u=>a(u.target.value),required:!0,disabled:n,className:"py-3 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}})]}),s.jsxs("div",{className:"d-grid gap-2",children:[s.jsx(te,{type:"submit",variant:"primary",size:"lg",disabled:n||!r.trim(),className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:u=>{u.target.style.transform="translateY(-2px)",u.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:u=>{u.target.style.transform="translateY(0)",u.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Sending..."]}):"Send Reset Link"}),s.jsx(te,{type:"button",variant:"outline-secondary",onClick:d,disabled:n,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:u=>{u.target.style.background="var(--bs-neutral-100)",u.target.style.borderColor="var(--bs-primary)",u.target.style.transform="translateY(-1px)"},onMouseLeave:u=>{u.target.style.background="rgba(255, 255, 255, 0.8)",u.target.style.borderColor="var(--bs-neutral-300)",u.target.style.transform="translateY(0)"},children:"Cancel"})]})]})]})]})};function Qm(){const[e,t]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState(!1),[o,l]=v.useState(!1),[c,d]=v.useState(!1),u=tt();ya();const{login:m,isAuthenticated:f,isLoading:h}=zr();if(v.useEffect(()=>{f&&u("/dashboard",{replace:!0})},[f,u]),h)return s.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("div",{className:"mt-3",children:"Loading..."})]})});if(f)return null;const p=async x=>{x.preventDefault(),l(!0);try{const g=await m({email:e,password:r});g.success?u("/dashboard",{replace:!0}):J.error(g.error||"Email or password is incorrect. Please try again.")}catch{J.error("Login failed. Please try again.")}finally{l(!1)}};return s.jsxs("div",{className:"min-vh-100 d-flex position-relative overflow-hidden",children:[s.jsx("div",{className:"position-absolute w-100 h-100",style:{backgroundImage:'url("./login-background.png")',backgroundSize:"cover",backgroundPosition:"center",filter:"blur(1px)",zIndex:-1}}),s.jsx("div",{className:"position-absolute w-100 h-100 bg-dark",style:{opacity:.3,zIndex:0}}),s.jsx(Ce,{fluid:!0,className:"position-relative",style:{zIndex:1},children:s.jsxs(de,{className:"min-vh-100",children:[s.jsx(H,{lg:6,className:"d-flex align-items-center justify-content-center p-5 d-none d-lg-flex",children:s.jsxs("div",{className:"text-white text-start",style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"d-flex align-items-center mb-4",children:[s.jsx("div",{className:"dashed-line me-3"}),s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})})]}),s.jsxs("h1",{className:"display-4 fw-bold mb-4 custom-title",style:{lineHeight:"1.1"},children:["AVIATION",s.jsx("br",{}),"ACADEMY"]}),s.jsx("p",{className:"fs-5 mb-3",style:{opacity:.9},children:"Where Your Dream Destinations Become Reality."}),s.jsx("p",{className:"fs-6",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]})}),s.jsx(H,{lg:6,xs:12,className:"d-flex align-items-center justify-content-center p-3 p-lg-5",children:s.jsxs("div",{className:"w-100 login-form-container",style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)",padding:"2rem",position:"relative",overflow:"hidden"},children:[s.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",zIndex:1}}),s.jsx("div",{style:{position:"absolute",top:"20%",left:"-50%",width:"200%",height:"60%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",transform:"rotate(-15deg)",zIndex:0}}),s.jsxs("div",{style:{position:"relative",zIndex:2},children:[s.jsxs("div",{className:"text-center mb-4 d-lg-none",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[s.jsx("div",{className:"dashed-line me-3"}),s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})}),s.jsx("div",{className:"dashed-line ms-3"})]}),s.jsxs("h1",{className:"text-white fw-bold mb-2 mobile-title",style:{lineHeight:"1.1",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:["AVIATION",s.jsx("br",{}),"ACADEMY"]}),s.jsx("p",{className:"text-white mb-2 mobile-subtitle",style:{opacity:.9,textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Where Your Dream Destinations Become Reality."}),s.jsx("p",{className:"text-white-50 mobile-description",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]}),s.jsxs(k,{onSubmit:p,children:[s.jsxs(k.Group,{className:"mb-3",controlId:"email",children:[s.jsx(k.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Email"}),s.jsx(k.Control,{type:"email",value:e,onChange:x=>t(x.target.value),placeholder:"Enter your email",className:"bg-white border-0 rounded-3 py-3",style:{fontSize:"1rem"},required:!0})]}),s.jsxs(k.Group,{className:"mb-4",controlId:"password",children:[s.jsx(k.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(k.Control,{type:n?"text":"password",value:r,onChange:x=>a(x.target.value),placeholder:"Enter your password",className:"bg-white border-0 rounded-3 py-3 pe-5",style:{fontSize:"1rem"},required:!0}),s.jsx("span",{role:"button",tabIndex:0,onClick:()=>i(x=>!x),onKeyPress:x=>{(x.key==="Enter"||x.key===" ")&&i(g=>!g)},"aria-label":"Toggle password visibility",className:"position-absolute top-50 translate-middle-y end-0 me-3 d-flex align-items-center justify-content-center",style:{width:24,height:24,cursor:"pointer"},children:n?s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#6b7280",strokeWidth:"1.5"})]}):s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[s.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),s.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"})]})})]})]}),s.jsx(te,{type:"submit",variant:"primary",className:"w-100 py-4 fw-bold rounded-3 mb-3",style:{fontSize:"1.1rem"},disabled:o,children:o?s.jsxs(s.Fragment,{children:[s.jsx(ct,{size:"sm",className:"me-2"})," Signing In..."]}):"Sign In"}),s.jsx("div",{className:"text-center mb-2",children:s.jsx("button",{type:"button",onClick:()=>d(!0),className:"btn btn-link text-decoration-none fw-semibold px-2 border-0 p-0",style:{fontSize:"0.9rem",color:"rgba(201, 212, 229, 0.8)",boxShadow:"none",textShadow:"none",cursor:"pointer",background:"none"},children:"Forgot password?"})}),s.jsx("div",{className:"text-center mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}}),s.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}})]})}),s.jsxs("div",{className:"text-center",children:[s.jsx("small",{className:"text-white-50 d-block mb-2",children:"Test Credentials:"}),s.jsx("div",{className:"text-white-50 small",children:s.jsx("div",{children:"Admin: michael.brown@admin.com / Admin@123"})})]})]})]})]})})]})}),s.jsx("style",{children:`
        .dashed-line {
          width: 60px;
          height: 2px;
          background: repeating-linear-gradient(
            to right,
            white 0px,
            white 8px,
            transparent 8px,
            transparent 16px
          );
        }
        
        /* Mobile responsive styles */
        .mobile-title {
          font-size: 1.8rem;
        }
        
        .mobile-subtitle {
          font-size: 0.9rem;
        }
        
        .mobile-description {
          font-size: 0.75rem;
        }
        
        /* Tablet styles */
        @media (min-width: 576px) and (max-width: 991.98px) {
          .mobile-title {
            font-size: 2.2rem;
          }
          
          .mobile-subtitle {
            font-size: 1rem;
          }
          
          .mobile-description {
            font-size: 0.85rem;
          }
        }
        
        /* Mobile styles */
        @media (max-width: 575.98px) {
          .dashed-line {
            width: 40px;
          }
          
          .login-form-container {
            padding: 1.5rem !important;
          }
        }
      `}),s.jsx(BR,{show:c,onHide:()=>d(!1)})]})}const zR=()=>{const[e]=el(),t=tt(),[r,a]=v.useState({newPassword:"",confirmPassword:""}),[n,i]=v.useState(!1),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[u,m]=v.useState(""),[f,h]=v.useState("");v.useEffect(()=>{const g=e.get("token");g&&h(g)},[e]);const p=g=>{const{name:b,value:j}=g.target;a(y=>({...y,[b]:j})),u&&m("")},x=async g=>{if(g.preventDefault(),m(""),!r.newPassword||!r.confirmPassword){m("Please fill in all fields.");return}if(r.newPassword!==r.confirmPassword){m("Passwords do not match.");return}d(!0);try{const b=await fetch(`${Bo.BASE_URL}${Bo.ENDPOINTS.AUTH.RESET_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:f,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!b.ok){b.status===405?m("Reset password feature is not available on this server. Please contact support."):b.status===404?m("Reset password endpoint not found. Please contact support."):b.status===400?m("Invalid token or password. Please request a new reset link."):m(`Server error (${b.status}). Please try again later.`);return}try{await b.json()}catch(j){console.error("JSON parsing error:",j),m("Server returned invalid response. Please try again later.");return}J.success("Password has been reset successfully! You can now login with your new password."),t("/login")}catch(b){console.error("Reset password error:",b),b.name==="TypeError"&&b.message.includes("fetch")?m("Cannot connect to server. Please check your internet connection."):m("An unexpected error occurred. Please try again later.")}finally{d(!1)}};return s.jsx("div",{className:"min-vh-100 d-flex align-items-center",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:s.jsx(Ce,{children:s.jsx(de,{className:"justify-content-center",children:s.jsx(H,{md:6,lg:5,xl:4,children:s.jsx(W,{className:"shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(27, 60, 83, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},children:s.jsxs(W.Body,{className:"p-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)"},children:s.jsx(Xl,{size:24,className:"text-white"})}),s.jsx("h4",{className:"fw-bold mb-2",style:{color:"var(--bs-primary)"},children:"Reset Password"}),s.jsx("p",{className:"text-muted",children:"Enter your new password below"})]}),u&&s.jsx(De,{variant:"danger",className:"mb-3",children:u}),s.jsxs(k,{onSubmit:x,children:[s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(k.Control,{type:n?"text":"password",name:"newPassword",value:r.newPassword,onChange:p,placeholder:"Enter new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),s.jsx(te,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>i(!n),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:n?s.jsx(Yl,{size:16}):s.jsx(Bt,{size:16})})]})]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Confirm New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(k.Control,{type:o?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:p,placeholder:"Confirm new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),s.jsx(te,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>l(!o),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:o?s.jsx(Yl,{size:16}):s.jsx(Bt,{size:16})})]})]}),s.jsxs("div",{className:"d-grid gap-2",children:[s.jsx(te,{type:"submit",variant:"primary",size:"lg",disabled:c||!r.newPassword||!r.confirmPassword,className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:g=>{g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resetting..."]}):"Reset Password"}),s.jsx(te,{type:"button",variant:"outline-secondary",onClick:()=>t("/login"),disabled:c,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.background="var(--bs-neutral-100)",g.target.style.borderColor="var(--bs-primary)",g.target.style.transform="translateY(-1px)"},onMouseLeave:g=>{g.target.style.background="rgba(255, 255, 255, 0.8)",g.target.style.borderColor="var(--bs-neutral-300)",g.target.style.transform="translateY(0)"},children:"Back to Login"})]})]})]})})})})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Qd={};Qd.version="0.18.5";var GS=1252,$R=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Jx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Zx=function(e){$R.indexOf(e)!=-1&&(GS=Jx[0]=e)};function UR(){Zx(1252)}var qa=function(e){Zx(e)};function Qx(){qa(1200),UR()}function dy(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function WR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function qS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ol=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?WR(e.slice(2)):t==254&&r==255?qS(e.slice(2)):t==65279?e.slice(1):e},cd=function(t){return String.fromCharCode(t)},uy=function(t){return String.fromCharCode(t)},Ql,ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ec(e){for(var t="",r=0,a=0,n=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,a=e.charCodeAt(d++),o=(r&3)<<4|a>>4,n=e.charCodeAt(d++),l=(a&15)<<2|n>>6,c=n&63,isNaN(a)?l=c=64:isNaN(n)&&(c=64),t+=ti.charAt(i)+ti.charAt(o)+ti.charAt(l)+ti.charAt(c);return t}function pa(e){var t="",r=0,a=0,n=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=ti.indexOf(e.charAt(d++)),o=ti.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=ti.indexOf(e.charAt(d++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=ti.indexOf(e.charAt(d++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var kt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ln=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function ii(e){return kt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function my(e){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ca=function(t){return kt?Ln(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function im(e){if(typeof ArrayBuffer>"u")return ca(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function hi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function HR(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function eg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return eg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ls=kt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ln(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function VR(e){for(var t=[],r=0,a=e.length+250,n=ii(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=ii(65535),a=65530)}return t.push(n.slice(0,r)),ls(t)}var Gs=/\u0000/g,Pl=/[\u0001-\u0006]/g;function ko(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ka(e,t){var r=""+e;return r.length>=t?r:Ir("0",t-r.length)+r}function tg(e,t){var r=""+e;return r.length>=t?r:Ir(" ",t-r.length)+r}function eu(e,t){var r=""+e;return r.length>=t?r:r+Ir(" ",t-r.length)}function GR(e,t){var r=""+Math.round(e);return r.length>=t?r:Ir("0",t-r.length)+r}function qR(e,t){var r=""+e;return r.length>=t?r:Ir("0",t-r.length)+r}var fy=Math.pow(2,32);function wo(e,t){if(e>fy||e<-fy)return GR(e,t);var r=Math.round(e);return qR(r,t)}function tu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var hy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ef=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function KR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},py={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},YR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ru(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,o=1,l=0,c=1,d=0,u=0,m=Math.floor(n);d<t&&(m=Math.floor(n),l=m*o+i,u=m*d+c,!(n-m<5e-8));)n=1/(n-m),i=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=o)),!r)return[0,a*l,u];var f=Math.floor(a*l/u);return[f,a*l-f*u,u]}function ki(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,o=[],l={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=t6(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var KS=new Date(1899,11,31,0,0,0),XR=KS.getTime(),JR=new Date(1900,2,1,0,0,0);function YS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=JR&&(r+=1440*60*1e3),(r-(XR+(e.getTimezoneOffset()-KS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function rg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ZR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function QR(e){var t=e<0?12:11,r=rg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function e6(e){var t=rg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function tc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=QR(e):t===10?r=e.toFixed(10).substr(0,12):r=e6(e),rg(ZR(r.toUpperCase()))}function Yi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):tc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return La(14,YS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function t6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function r6(e,t,r,a){var n="",i=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return ef[r.m-1][1];case 5:return ef[r.m-1][0];default:return ef[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return hy[r.q][0];default:return hy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ka(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=Ka(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?Ka(c,d):"";return u}function ri(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var XS=/%/g;function s6(e,t,r){var a=t.replace(XS,""),n=t.length-a.length;return Sn(e,a,r*Math.pow(10,2*n))+Ir("%",n)}function a6(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Sn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function JS(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+JS(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ZS=/# (\?+)( ?)\/( ?)(\d+)/;function n6(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),o=n-i*a,l=a;return r+(i===0?"":""+i)+" "+(o===0?Ir(" ",e[1].length+1+e[4].length):tg(o,e[1].length)+e[2]+"/"+e[3]+Ka(l,e[4].length))}function i6(e,t,r){return r+(t===0?"":""+t)+Ir(" ",e[1].length+2+e[4].length)}var QS=/^#*0*\.([0#]+)/,eE=/\).*[0#]/,tE=/\(###\) ###\\?-####/;function zs(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function xy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function gy(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function o6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function l6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ea(e,t,r){if(e.charCodeAt(0)===40&&!t.match(eE)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ea("n",a,r):"("+Ea("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return a6(e,t,r);if(t.indexOf("%")!==-1)return s6(e,t,r);if(t.indexOf("E")!==-1)return JS(t,r);if(t.charCodeAt(0)===36)return"$"+Ea(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+wo(c,t.length);if(t.match(/^[#?]+$/))return n=wo(r,0),n==="0"&&(n=""),n.length>t.length?n:zs(t.substr(0,t.length-n.length))+n;if(i=t.match(ZS))return n6(i,c,d);if(t.match(/^#+0+$/))return d+wo(c,t.length-t.indexOf("0"));if(i=t.match(QS))return n=xy(r,i[1].length).replace(/^([^\.]+)$/,"$1."+zs(i[1])).replace(/\.$/,"."+zs(i[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+Ir("0",zs(i[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+xy(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ri(wo(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ea(e,t,-r):ri(""+(Math.floor(r)+o6(r,i[1].length)))+"."+Ka(gy(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ea(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ko(Ea(e,t.replace(/[\\-]/g,""),r)),o=0,ko(ko(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<n.length?n.charAt(o++):p==="0"?"0":""}));if(t.match(tE))return n=Ea(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ru(c,Math.pow(10,o)-1,!1),n=""+d,u=Sn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=eu(l[2],o),u.length<i[4].length&&(u=zs(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ru(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?tg(l[1],o)+i[2]+"/"+i[3]+eu(l[2],o):Ir(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=wo(r,0),t.length<=n.length?n:zs(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var m=t.indexOf(".")-o,f=t.length-n.length-m;return zs(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=gy(r,i[1].length),r<0?"-"+Ea(e,t,-r):ri(l6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ka(0,3-p.length):"")+p})+"."+Ka(o,i[1].length);switch(t){case"###,##0.00":return Ea(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ri(wo(c,0));return h!=="0"?d+h:"";case"###,###.00":return Ea(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ea(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function c6(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Sn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function d6(e,t,r){var a=t.replace(XS,""),n=t.length-a.length;return Sn(e,a,r*Math.pow(10,2*n))+Ir("%",n)}function rE(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+rE(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function an(e,t,r){if(e.charCodeAt(0)===40&&!t.match(eE)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?an("n",a,r):"("+an("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return c6(e,t,r);if(t.indexOf("%")!==-1)return d6(e,t,r);if(t.indexOf("E")!==-1)return rE(t,r);if(t.charCodeAt(0)===36)return"$"+an(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ka(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:zs(t.substr(0,t.length-n.length))+n;if(i=t.match(ZS))return i6(i,c,d);if(t.match(/^#+0+$/))return d+Ka(c,t.length-t.indexOf("0"));if(i=t.match(QS))return n=(""+r).replace(/^([^\.]+)$/,"$1."+zs(i[1])).replace(/\.$/,"."+zs(i[1])),n=n.replace(/\.(\d*)$/,function(p,x){return"."+x+Ir("0",zs(i[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ri(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+an(e,t,-r):ri(""+r)+"."+Ir("0",i[1].length);if(i=t.match(/^#,#*,#0/))return an(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ko(an(e,t.replace(/[\\-]/g,""),r)),o=0,ko(ko(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<n.length?n.charAt(o++):p==="0"?"0":""}));if(t.match(tE))return n=an(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ru(c,Math.pow(10,o)-1,!1),n=""+d,u=Sn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=eu(l[2],o),u.length<i[4].length&&(u=zs(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ru(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?tg(l[1],o)+i[2]+"/"+i[3]+eu(l[2],o):Ir(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:zs(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var m=t.indexOf(".")-o,f=t.length-n.length-m;return zs(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+an(e,t,-r):ri(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ka(0,3-p.length):"")+p})+"."+Ka(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ri(""+c);return h!=="0"?d+h:"";default:if(t.match(/\.[0#?]*$/))return an(e,t.slice(0,t.lastIndexOf(".")),r)+zs(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Sn(e,t,r){return(r|0)===r?an(e,t,r):Ea(e,t,r)}function u6(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var sE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function al(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":tu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(sE))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function m6(e,t,r,a){for(var n=[],i="",o=0,l="",c="t",d,u,m,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!tu(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(m);n[n.length]={t:"t",v:i},++o;break;case"\\":var h=e.charAt(++o),p=h==="("||h===")"?h:"t";n[n.length]={t:p,v:h},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ki(t,r,e.charAt(o+1)==="2"),d==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ki(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),n[n.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var x={t:l,v:l};if(d==null&&(d=ki(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(x.v=d.H>=12?"P":"A"),x.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(x.v=d.H>=12?"PM":"AM"),x.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(x.v=d.H>=12?"":""),x.t="T",o+=5,f="h"):(x.t="t",++o),d==null&&x.t==="T")return"";n[n.length]=x,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(sE)){if(d==null&&(d=ki(t,r),d==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",al(e)||(n[n.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var g=0,b=0,j;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=f,c="h",g<1&&(g=1);break;case"s":(j=n[o].v.match(/\.0+$/))&&(b=Math.max(b,j[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[o].v.match(/[Hh]/)&&(g=1),g<2&&n[o].v.match(/[Mm]/)&&(g=2),g<3&&n[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var y="",w;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=r6(n[o].t.charCodeAt(0),n[o].v,d,b),n[o].t="t";break;case"n":case"?":for(w=o+1;n[w]!=null&&((l=n[w].t)==="?"||l==="D"||(l===" "||l==="t")&&n[w+1]!=null&&(n[w+1].t==="?"||n[w+1].t==="t"&&n[w+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[w].v==="/"||n[w].v===" "&&n[w+1]!=null&&n[w+1].t=="?"));)n[o].v+=n[w].v,n[w]={v:"",t:";"},++w;y+=n[o].v,o=w-1;break;case"G":n[o].t="t",n[o].v=Yi(t,r);break}var S="",N,E;if(y.length>0){y.charCodeAt(0)==40?(N=t<0&&y.charCodeAt(0)===45?-t:t,E=Sn("n",y,N)):(N=t<0&&a>1?-t:t,E=Sn("n",y,N),N<0&&n[0]&&n[0].t=="t"&&(E=E.substr(1),n[0].v="-"+n[0].v)),w=E.length-1;var P=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){P=o;break}var T=n.length;if(P===n.length&&E.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(w>=n[o].v.length-1?(w-=n[o].v.length,n[o].v=E.substr(w+1,n[o].v.length)):w<0?n[o].v="":(n[o].v=E.substr(0,w+1),w=-1),n[o].t="t",T=o);w>=0&&T<n.length&&(n[T].v=E.substr(0,w+1)+n[T].v)}else if(P!==n.length&&E.indexOf("E")===-1){for(w=E.indexOf(".")-1,o=P;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(u=n[o].v.indexOf(".")>-1&&o===P?n[o].v.indexOf(".")-1:n[o].v.length-1,S=n[o].v.substr(u+1);u>=0;--u)w>=0&&(n[o].v.charAt(u)==="0"||n[o].v.charAt(u)==="#")&&(S=E.charAt(w--)+S);n[o].v=S,n[o].t="t",T=o}for(w>=0&&T<n.length&&(n[T].v=E.substr(0,w+1)+n[T].v),w=E.indexOf(".")+1,o=P;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==P)){for(u=n[o].v.indexOf(".")>-1&&o===P?n[o].v.indexOf(".")+1:0,S=n[o].v.substr(0,u);u<n[o].v.length;++u)w<E.length&&(S+=E.charAt(w++));n[o].v=S,n[o].t="t",T=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(N=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Sn(n[o].t,n[o].v,N),n[o].t="t");var O="";for(o=0;o!==n.length;++o)n[o]!=null&&(O+=n[o].v);return O}var vy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yy(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function f6(e,t){var r=u6(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(vy),l=r[1].match(vy);return yy(t,o)?[a,r[0]]:yy(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,i]}function La(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:ut)[e],a==null&&(a=r.table&&r.table[py[e]]||ut[py[e]]),a==null&&(a=YR[e]||"General");break}if(tu(a,0))return Yi(t,r);t instanceof Date&&(t=YS(t,r.date1904));var n=f6(a,t);if(tu(n[1]))return Yi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return m6(n[1],t,r,n[0])}function En(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ut[r]==null){t<0&&(t=r);continue}if(ut[r]==e){t=r;break}}t<0&&(t=391)}return ut[t]=e,t}function om(e){for(var t=0;t!=392;++t)e[t]!==void 0&&En(e[t],t)}function nl(){ut=KR()}var h6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},aE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function p6(e){var t=typeof e=="number"?ut[e]:e;return t=t.replace(aE,"(\\d+)"),new RegExp("^"+t+"$")}function x6(e,t,r){var a=-1,n=-1,i=-1,o=-1,l=-1,c=-1;(t.match(aE)||[]).forEach(function(m,f){var h=parseInt(r[f+1],10);switch(m.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:n=h;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:a==-1&&n==-1&&i==-1?u:d+"T"+u}var g6=(function(){var e={};e.version="1.2.0";function t(){for(var E=0,P=new Array(256),T=0;T!=256;++T)E=T,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,P[T]=E;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function a(E){var P=0,T=0,O=0,_=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)_[O]=E[O];for(O=0;O!=256;++O)for(T=E[O],P=256+O;P<4096;P+=256)T=_[P]=T>>>8^E[T&255];var C=[];for(O=1;O!=16;++O)C[O-1]=typeof Int32Array<"u"?_.subarray(O*256,O*256+256):_.slice(O*256,O*256+256);return C}var n=a(r),i=n[0],o=n[1],l=n[2],c=n[3],d=n[4],u=n[5],m=n[6],f=n[7],h=n[8],p=n[9],x=n[10],g=n[11],b=n[12],j=n[13],y=n[14];function w(E,P){for(var T=P^-1,O=0,_=E.length;O<_;)T=T>>>8^r[(T^E.charCodeAt(O++))&255];return~T}function S(E,P){for(var T=P^-1,O=E.length-15,_=0;_<O;)T=y[E[_++]^T&255]^j[E[_++]^T>>8&255]^b[E[_++]^T>>16&255]^g[E[_++]^T>>>24]^x[E[_++]]^p[E[_++]]^h[E[_++]]^f[E[_++]]^m[E[_++]]^u[E[_++]]^d[E[_++]]^c[E[_++]]^l[E[_++]]^o[E[_++]]^i[E[_++]]^r[E[_++]];for(O+=15;_<O;)T=T>>>8^r[(T^E[_++])&255];return~T}function N(E,P){for(var T=P^-1,O=0,_=E.length,C=0,R=0;O<_;)C=E.charCodeAt(O++),C<128?T=T>>>8^r[(T^C)&255]:C<2048?(T=T>>>8^r[(T^(192|C>>6&31))&255],T=T>>>8^r[(T^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,R=E.charCodeAt(O++)&1023,T=T>>>8^r[(T^(240|C>>8&7))&255],T=T>>>8^r[(T^(128|C>>2&63))&255],T=T>>>8^r[(T^(128|R>>6&15|(C&3)<<4))&255],T=T>>>8^r[(T^(128|R&63))&255]):(T=T>>>8^r[(T^(224|C>>12&15))&255],T=T>>>8^r[(T^(128|C>>6&63))&255],T=T>>>8^r[(T^(128|C&63))&255]);return~T}return e.table=r,e.bstr=w,e.buf=S,e.str=N,e})(),lt=(function(){var t={};t.version="1.2.1";function r(B,X){for(var q=B.split("/"),Y=X.split("/"),oe=0,le=0,xe=Math.min(q.length,Y.length);oe<xe;++oe){if(le=q[oe].length-Y[oe].length)return le;if(q[oe]!=Y[oe])return q[oe]<Y[oe]?-1:1}return q.length-Y.length}function a(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:a(B.slice(0,-1));var X=B.lastIndexOf("/");return X===-1?B:B.slice(0,X+1)}function n(B){if(B.charAt(B.length-1)=="/")return n(B.slice(0,-1));var X=B.lastIndexOf("/");return X===-1?B:B.slice(X+1)}function i(B,X){typeof X=="string"&&(X=new Date(X));var q=X.getHours();q=q<<6|X.getMinutes(),q=q<<5|X.getSeconds()>>>1,B.write_shift(2,q);var Y=X.getFullYear()-1980;Y=Y<<4|X.getMonth()+1,Y=Y<<5|X.getDate(),B.write_shift(2,Y)}function o(B){var X=B.read_shift(2)&65535,q=B.read_shift(2)&65535,Y=new Date,oe=q&31;q>>>=5;var le=q&15;q>>>=4,Y.setMilliseconds(0),Y.setFullYear(q+1980),Y.setMonth(le-1),Y.setDate(oe);var xe=X&31;X>>>=5;var Se=X&63;return X>>>=6,Y.setHours(X),Y.setMinutes(Se),Y.setSeconds(xe<<1),Y}function l(B){vs(B,0);for(var X={},q=0;B.l<=B.length-4;){var Y=B.read_shift(2),oe=B.read_shift(2),le=B.l+oe,xe={};switch(Y){case 21589:q=B.read_shift(1),q&1&&(xe.mtime=B.read_shift(4)),oe>5&&(q&2&&(xe.atime=B.read_shift(4)),q&4&&(xe.ctime=B.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}B.l=le,X[Y]=xe}return X}var c;function d(){return c||(c={})}function u(B,X){if(B[0]==80&&B[1]==75)return wi(B,X);if((B[0]|32)==109&&(B[1]|32)==105)return et(B,X);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var q=3,Y=512,oe=0,le=0,xe=0,Se=0,fe=0,ge=[],ve=B.slice(0,512);vs(ve,0);var Ie=m(ve);switch(q=Ie[0],q){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ie[1]==0)return wi(B,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}Y!==512&&(ve=B.slice(0,Y),vs(ve,28));var $e=B.slice(0,Y);f(ve,q);var qe=ve.read_shift(4,"i");if(q===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);ve.l+=4,xe=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),Se=ve.read_shift(4,"i"),oe=ve.read_shift(4,"i"),fe=ve.read_shift(4,"i"),le=ve.read_shift(4,"i");for(var Le=-1,Ge=0;Ge<109&&(Le=ve.read_shift(4,"i"),!(Le<0));++Ge)ge[Ge]=Le;var wt=h(B,Y);g(fe,le,wt,Y,ge);var br=j(wt,xe,ge,Y);br[xe].name="!Directory",oe>0&&Se!==R&&(br[Se].name="!MiniFAT"),br[ge[0]].name="!FAT",br.fat_addrs=ge,br.ssz=Y;var jr={},Ss=[],gl=[],vl=[];y(xe,br,wt,Ss,oe,jr,gl,Se),p(gl,vl,Ss),Ss.shift();var yl={FileIndex:gl,FullPaths:vl};return X&&X.raw&&(yl.raw={header:$e,sectors:wt}),yl}function m(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(M,"Header Signature: "),B.l+=16;var X=B.read_shift(2,"u");return[B.read_shift(2,"u"),X]}function f(B,X){var q=9;switch(B.l+=2,q=B.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function h(B,X){for(var q=Math.ceil(B.length/X)-1,Y=[],oe=1;oe<q;++oe)Y[oe-1]=B.slice(oe*X,(oe+1)*X);return Y[q-1]=B.slice(q*X),Y}function p(B,X,q){for(var Y=0,oe=0,le=0,xe=0,Se=0,fe=q.length,ge=[],ve=[];Y<fe;++Y)ge[Y]=ve[Y]=Y,X[Y]=q[Y];for(;Se<ve.length;++Se)Y=ve[Se],oe=B[Y].L,le=B[Y].R,xe=B[Y].C,ge[Y]===Y&&(oe!==-1&&ge[oe]!==oe&&(ge[Y]=ge[oe]),le!==-1&&ge[le]!==le&&(ge[Y]=ge[le])),xe!==-1&&(ge[xe]=Y),oe!==-1&&Y!=ge[Y]&&(ge[oe]=ge[Y],ve.lastIndexOf(oe)<Se&&ve.push(oe)),le!==-1&&Y!=ge[Y]&&(ge[le]=ge[Y],ve.lastIndexOf(le)<Se&&ve.push(le));for(Y=1;Y<fe;++Y)ge[Y]===Y&&(le!==-1&&ge[le]!==le?ge[Y]=ge[le]:oe!==-1&&ge[oe]!==oe&&(ge[Y]=ge[oe]));for(Y=1;Y<fe;++Y)if(B[Y].type!==0){if(Se=Y,Se!=ge[Se])do Se=ge[Se],X[Y]=X[Se]+"/"+X[Y];while(Se!==0&&ge[Se]!==-1&&Se!=ge[Se]);ge[Y]=-1}for(X[0]+="/",Y=1;Y<fe;++Y)B[Y].type!==2&&(X[Y]+="/")}function x(B,X,q){for(var Y=B.start,oe=B.size,le=[],xe=Y;q&&oe>0&&xe>=0;)le.push(X.slice(xe*C,xe*C+C)),oe-=C,xe=Ai(q,xe*4);return le.length===0?Ae(0):ls(le).slice(0,B.size)}function g(B,X,q,Y,oe){var le=R;if(B===R){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var xe=q[B],Se=(Y>>>2)-1;if(!xe)return;for(var fe=0;fe<Se&&(le=Ai(xe,fe*4))!==R;++fe)oe.push(le);g(Ai(xe,Y-4),X-1,q,Y,oe)}}function b(B,X,q,Y,oe){var le=[],xe=[];oe||(oe=[]);var Se=Y-1,fe=0,ge=0;for(fe=X;fe>=0;){oe[fe]=!0,le[le.length]=fe,xe.push(B[fe]);var ve=q[Math.floor(fe*4/Y)];if(ge=fe*4&Se,Y<4+ge)throw new Error("FAT boundary crossed: "+fe+" 4 "+Y);if(!B[ve])break;fe=Ai(B[ve],ge)}return{nodes:le,data:Dy([xe])}}function j(B,X,q,Y){var oe=B.length,le=[],xe=[],Se=[],fe=[],ge=Y-1,ve=0,Ie=0,$e=0,qe=0;for(ve=0;ve<oe;++ve)if(Se=[],$e=ve+X,$e>=oe&&($e-=oe),!xe[$e]){fe=[];var Le=[];for(Ie=$e;Ie>=0;){Le[Ie]=!0,xe[Ie]=!0,Se[Se.length]=Ie,fe.push(B[Ie]);var Ge=q[Math.floor(Ie*4/Y)];if(qe=Ie*4&ge,Y<4+qe)throw new Error("FAT boundary crossed: "+Ie+" 4 "+Y);if(!B[Ge]||(Ie=Ai(B[Ge],qe),Le[Ie]))break}le[$e]={nodes:Se,data:Dy([fe])}}return le}function y(B,X,q,Y,oe,le,xe,Se){for(var fe=0,ge=Y.length?2:0,ve=X[B].data,Ie=0,$e=0,qe;Ie<ve.length;Ie+=128){var Le=ve.slice(Ie,Ie+128);vs(Le,64),$e=Le.read_shift(2),qe=cg(Le,0,$e-ge),Y.push(qe);var Ge={name:qe,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},wt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);wt!==0&&(Ge.ct=w(Le,Le.l-8));var br=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);br!==0&&(Ge.mt=w(Le,Le.l-8)),Ge.start=Le.read_shift(4,"i"),Ge.size=Le.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=R,Ge.name=""),Ge.type===5?(fe=Ge.start,oe>0&&fe!==R&&(X[fe].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",X[Ge.start]===void 0&&(X[Ge.start]=b(q,Ge.start,X.fat_addrs,X.ssz)),X[Ge.start].name=Ge.name,Ge.content=X[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:fe!==R&&Ge.start!==R&&X[fe]&&(Ge.content=x(Ge,X[fe].data,(X[Se]||{}).data))),Ge.content&&vs(Ge.content,0),le[qe]=Ge,xe.push(Ge)}}function w(B,X){return new Date((la(B,X+4)/1e7*Math.pow(2,32)+la(B,X)/1e7-11644473600)*1e3)}function S(B,X){return d(),u(c.readFileSync(B),X)}function N(B,X){var q=X&&X.type;switch(q||kt&&Buffer.isBuffer(B)&&(q="buffer"),q||"base64"){case"file":return S(B,X);case"base64":return u(ca(pa(B)),X);case"binary":return u(ca(B),X)}return u(B,X)}function E(B,X){var q=X||{},Y=q.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=Y+"/",B.FileIndex[0]={name:Y,type:5}),q.CLSID&&(B.FileIndex[0].clsid=q.CLSID),P(B)}function P(B){var X="Sh33tJ5";if(!lt.find(B,"/"+X)){var q=Ae(4);q[0]=55,q[1]=q[3]=50,q[2]=54,B.FileIndex.push({name:X,type:2,content:q,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+X),T(B)}}function T(B,X){E(B);for(var q=!1,Y=!1,oe=B.FullPaths.length-1;oe>=0;--oe){var le=B.FileIndex[oe];switch(le.type){case 0:Y?q=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(le.R*le.L*le.C)&&(q=!0),le.R>-1&&le.L>-1&&le.R==le.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!X)){var xe=new Date(1987,1,19),Se=0,fe=Object.create?Object.create(null):{},ge=[];for(oe=0;oe<B.FullPaths.length;++oe)fe[B.FullPaths[oe]]=!0,B.FileIndex[oe].type!==0&&ge.push([B.FullPaths[oe],B.FileIndex[oe]]);for(oe=0;oe<ge.length;++oe){var ve=a(ge[oe][0]);Y=fe[ve],Y||(ge.push([ve,{name:n(ve).replace("/",""),type:1,clsid:Z,ct:xe,mt:xe,content:null}]),fe[ve]=!0)}for(ge.sort(function(qe,Le){return r(qe[0],Le[0])}),B.FullPaths=[],B.FileIndex=[],oe=0;oe<ge.length;++oe)B.FullPaths[oe]=ge[oe][0],B.FileIndex[oe]=ge[oe][1];for(oe=0;oe<ge.length;++oe){var Ie=B.FileIndex[oe],$e=B.FullPaths[oe];if(Ie.name=n($e).replace("/",""),Ie.L=Ie.R=Ie.C=-(Ie.color=1),Ie.size=Ie.content?Ie.content.length:0,Ie.start=0,Ie.clsid=Ie.clsid||Z,oe===0)Ie.C=ge.length>1?1:-1,Ie.size=0,Ie.type=5;else if($e.slice(-1)=="/"){for(Se=oe+1;Se<ge.length&&a(B.FullPaths[Se])!=$e;++Se);for(Ie.C=Se>=ge.length?-1:Se,Se=oe+1;Se<ge.length&&a(B.FullPaths[Se])!=a($e);++Se);Ie.R=Se>=ge.length?-1:Se,Ie.type=1}else a(B.FullPaths[oe+1]||"")==a($e)&&(Ie.R=oe+1),Ie.type=2}}}function O(B,X){var q=X||{};if(q.fileType=="mad")return He(B,q);switch(T(B),q.fileType){case"zip":return Bs(B,q)}var Y=(function(qe){for(var Le=0,Ge=0,wt=0;wt<qe.FileIndex.length;++wt){var br=qe.FileIndex[wt];if(br.content){var jr=br.content.length;jr>0&&(jr<4096?Le+=jr+63>>6:Ge+=jr+511>>9)}}for(var Ss=qe.FullPaths.length+3>>2,gl=Le+7>>3,vl=Le+127>>7,yl=gl+Ge+Ss+vl,Ni=yl+127>>7,qm=Ni<=109?0:Math.ceil((Ni-109)/127);yl+Ni+qm+127>>7>Ni;)qm=++Ni<=109?0:Math.ceil((Ni-109)/127);var vn=[1,qm,Ni,vl,Ss,Ge,Le,0];return qe.FileIndex[0].size=Le<<6,vn[7]=(qe.FileIndex[0].start=vn[0]+vn[1]+vn[2]+vn[3]+vn[4]+vn[5])+(vn[6]+7>>3),vn})(B),oe=Ae(Y[7]<<9),le=0,xe=0;{for(le=0;le<8;++le)oe.write_shift(1,U[le]);for(le=0;le<8;++le)oe.write_shift(2,0);for(oe.write_shift(2,62),oe.write_shift(2,3),oe.write_shift(2,65534),oe.write_shift(2,9),oe.write_shift(2,6),le=0;le<3;++le)oe.write_shift(2,0);for(oe.write_shift(4,0),oe.write_shift(4,Y[2]),oe.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),oe.write_shift(4,0),oe.write_shift(4,4096),oe.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:R),oe.write_shift(4,Y[3]),oe.write_shift(-4,Y[1]?Y[0]-1:R),oe.write_shift(4,Y[1]),le=0;le<109;++le)oe.write_shift(-4,le<Y[2]?Y[1]+le:-1)}if(Y[1])for(xe=0;xe<Y[1];++xe){for(;le<236+xe*127;++le)oe.write_shift(-4,le<Y[2]?Y[1]+le:-1);oe.write_shift(-4,xe===Y[1]-1?R:xe+1)}var Se=function(qe){for(xe+=qe;le<xe-1;++le)oe.write_shift(-4,le+1);qe&&(++le,oe.write_shift(-4,R))};for(xe=le=0,xe+=Y[1];le<xe;++le)oe.write_shift(-4,ee.DIFSECT);for(xe+=Y[2];le<xe;++le)oe.write_shift(-4,ee.FATSECT);Se(Y[3]),Se(Y[4]);for(var fe=0,ge=0,ve=B.FileIndex[0];fe<B.FileIndex.length;++fe)ve=B.FileIndex[fe],ve.content&&(ge=ve.content.length,!(ge<4096)&&(ve.start=xe,Se(ge+511>>9)));for(Se(Y[6]+7>>3);oe.l&511;)oe.write_shift(-4,ee.ENDOFCHAIN);for(xe=le=0,fe=0;fe<B.FileIndex.length;++fe)ve=B.FileIndex[fe],ve.content&&(ge=ve.content.length,!(!ge||ge>=4096)&&(ve.start=xe,Se(ge+63>>6)));for(;oe.l&511;)oe.write_shift(-4,ee.ENDOFCHAIN);for(le=0;le<Y[4]<<2;++le){var Ie=B.FullPaths[le];if(!Ie||Ie.length===0){for(fe=0;fe<17;++fe)oe.write_shift(4,0);for(fe=0;fe<3;++fe)oe.write_shift(4,-1);for(fe=0;fe<12;++fe)oe.write_shift(4,0);continue}ve=B.FileIndex[le],le===0&&(ve.start=ve.size?ve.start-1:R);var $e=le===0&&q.root||ve.name;if(ge=2*($e.length+1),oe.write_shift(64,$e,"utf16le"),oe.write_shift(2,ge),oe.write_shift(1,ve.type),oe.write_shift(1,ve.color),oe.write_shift(-4,ve.L),oe.write_shift(-4,ve.R),oe.write_shift(-4,ve.C),ve.clsid)oe.write_shift(16,ve.clsid,"hex");else for(fe=0;fe<4;++fe)oe.write_shift(4,0);oe.write_shift(4,ve.state||0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,ve.start),oe.write_shift(4,ve.size),oe.write_shift(4,0)}for(le=1;le<B.FileIndex.length;++le)if(ve=B.FileIndex[le],ve.size>=4096)if(oe.l=ve.start+1<<9,kt&&Buffer.isBuffer(ve.content))ve.content.copy(oe,oe.l,0,ve.size),oe.l+=ve.size+511&-512;else{for(fe=0;fe<ve.size;++fe)oe.write_shift(1,ve.content[fe]);for(;fe&511;++fe)oe.write_shift(1,0)}for(le=1;le<B.FileIndex.length;++le)if(ve=B.FileIndex[le],ve.size>0&&ve.size<4096)if(kt&&Buffer.isBuffer(ve.content))ve.content.copy(oe,oe.l,0,ve.size),oe.l+=ve.size+63&-64;else{for(fe=0;fe<ve.size;++fe)oe.write_shift(1,ve.content[fe]);for(;fe&63;++fe)oe.write_shift(1,0)}if(kt)oe.l=oe.length;else for(;oe.l<oe.length;)oe.write_shift(1,0);return oe}function _(B,X){var q=B.FullPaths.map(function(fe){return fe.toUpperCase()}),Y=q.map(function(fe){var ge=fe.split("/");return ge[ge.length-(fe.slice(-1)=="/"?2:1)]}),oe=!1;X.charCodeAt(0)===47?(oe=!0,X=q[0].slice(0,-1)+X):oe=X.indexOf("/")!==-1;var le=X.toUpperCase(),xe=oe===!0?q.indexOf(le):Y.indexOf(le);if(xe!==-1)return B.FileIndex[xe];var Se=!le.match(Pl);for(le=le.replace(Gs,""),Se&&(le=le.replace(Pl,"!")),xe=0;xe<q.length;++xe)if((Se?q[xe].replace(Pl,"!"):q[xe]).replace(Gs,"")==le||(Se?Y[xe].replace(Pl,"!"):Y[xe]).replace(Gs,"")==le)return B.FileIndex[xe];return null}var C=64,R=-2,M="d0cf11e0a1b11ae1",U=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(B,X,q){d();var Y=O(B,q);c.writeFileSync(X,Y)}function z(B){for(var X=new Array(B.length),q=0;q<B.length;++q)X[q]=String.fromCharCode(B[q]);return X.join("")}function me(B,X){var q=O(B,X);switch(X&&X.type||"buffer"){case"file":return d(),c.writeFileSync(X.filename,q),q;case"binary":return typeof q=="string"?q:z(q);case"base64":return ec(typeof q=="string"?q:z(q));case"buffer":if(kt)return Buffer.isBuffer(q)?q:Ln(q);case"array":return typeof q=="string"?ca(q):q}return q}var ne;function A(B){try{var X=B.InflateRaw,q=new X;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)ne=B;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function D(B,X){if(!ne)return gn(B,X);var q=ne.InflateRaw,Y=new q,oe=Y._processChunk(B.slice(B.l),Y._finishFlushFlag);return B.l+=Y.bytesRead,oe}function I(B){return ne?ne.deflateRawSync(B):ht(B)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(B){var X=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(X>>16|X>>8|X)&255}for(var K=typeof Uint8Array<"u",G=K?new Uint8Array(256):[],ue=0;ue<256;++ue)G[ue]=ae(ue);function L(B,X){var q=G[B&255];return X<=8?q>>>8-X:(q=q<<8|G[B>>8&255],X<=16?q>>>16-X:(q=q<<8|G[B>>16&255],q>>>24-X))}function Ne(B,X){var q=X&7,Y=X>>>3;return(B[Y]|(q<=6?0:B[Y+1]<<8))>>>q&3}function Oe(B,X){var q=X&7,Y=X>>>3;return(B[Y]|(q<=5?0:B[Y+1]<<8))>>>q&7}function We(B,X){var q=X&7,Y=X>>>3;return(B[Y]|(q<=4?0:B[Y+1]<<8))>>>q&15}function Qe(B,X){var q=X&7,Y=X>>>3;return(B[Y]|(q<=3?0:B[Y+1]<<8))>>>q&31}function Pe(B,X){var q=X&7,Y=X>>>3;return(B[Y]|(q<=1?0:B[Y+1]<<8))>>>q&127}function rt(B,X,q){var Y=X&7,oe=X>>>3,le=(1<<q)-1,xe=B[oe]>>>Y;return q<8-Y||(xe|=B[oe+1]<<8-Y,q<16-Y)||(xe|=B[oe+2]<<16-Y,q<24-Y)||(xe|=B[oe+3]<<24-Y),xe&le}function Ht(B,X,q){var Y=X&7,oe=X>>>3;return Y<=5?B[oe]|=(q&7)<<Y:(B[oe]|=q<<Y&255,B[oe+1]=(q&7)>>8-Y),X+3}function gt(B,X,q){var Y=X&7,oe=X>>>3;return q=(q&1)<<Y,B[oe]|=q,X+1}function Ue(B,X,q){var Y=X&7,oe=X>>>3;return q<<=Y,B[oe]|=q&255,q>>>=8,B[oe+1]=q,X+8}function he(B,X,q){var Y=X&7,oe=X>>>3;return q<<=Y,B[oe]|=q&255,q>>>=8,B[oe+1]=q&255,B[oe+2]=q>>>8,X+16}function Me(B,X){var q=B.length,Y=2*q>X?2*q:X+5,oe=0;if(q>=X)return B;if(kt){var le=my(Y);if(B.copy)B.copy(le);else for(;oe<B.length;++oe)le[oe]=B[oe];return le}else if(K){var xe=new Uint8Array(Y);if(xe.set)xe.set(B);else for(;oe<q;++oe)xe[oe]=B[oe];return xe}return B.length=Y,B}function Fe(B){for(var X=new Array(B),q=0;q<B;++q)X[q]=0;return X}function Ye(B,X,q){var Y=1,oe=0,le=0,xe=0,Se=0,fe=B.length,ge=K?new Uint16Array(32):Fe(32);for(le=0;le<32;++le)ge[le]=0;for(le=fe;le<q;++le)B[le]=0;fe=B.length;var ve=K?new Uint16Array(fe):Fe(fe);for(le=0;le<fe;++le)ge[oe=B[le]]++,Y<oe&&(Y=oe),ve[le]=0;for(ge[0]=0,le=1;le<=Y;++le)ge[le+16]=Se=Se+ge[le-1]<<1;for(le=0;le<fe;++le)Se=B[le],Se!=0&&(ve[le]=ge[Se+16]++);var Ie=0;for(le=0;le<fe;++le)if(Ie=B[le],Ie!=0)for(Se=L(ve[le],Y)>>Y-Ie,xe=(1<<Y+4-Ie)-1;xe>=0;--xe)X[Se|xe<<Ie]=Ie&15|le<<4;return Y}var Rt=K?new Uint16Array(512):Fe(512),Ot=K?new Uint16Array(32):Fe(32);if(!K){for(var vt=0;vt<512;++vt)Rt[vt]=0;for(vt=0;vt<32;++vt)Ot[vt]=0}(function(){for(var B=[],X=0;X<32;X++)B.push(5);Ye(B,Ot,32);var q=[];for(X=0;X<=143;X++)q.push(8);for(;X<=255;X++)q.push(9);for(;X<=279;X++)q.push(7);for(;X<=287;X++)q.push(8);Ye(q,Rt,288)})();var ft=(function(){for(var X=K?new Uint8Array(32768):[],q=0,Y=0;q<se.length-1;++q)for(;Y<se[q+1];++Y)X[Y]=q;for(;Y<32768;++Y)X[Y]=29;var oe=K?new Uint8Array(259):[];for(q=0,Y=0;q<ie.length-1;++q)for(;Y<ie[q+1];++Y)oe[Y]=q;function le(Se,fe){for(var ge=0;ge<Se.length;){var ve=Math.min(65535,Se.length-ge),Ie=ge+ve==Se.length;for(fe.write_shift(1,+Ie),fe.write_shift(2,ve),fe.write_shift(2,~ve&65535);ve-- >0;)fe[fe.l++]=Se[ge++]}return fe.l}function xe(Se,fe){for(var ge=0,ve=0,Ie=K?new Uint16Array(32768):[];ve<Se.length;){var $e=Math.min(65535,Se.length-ve);if($e<10){for(ge=Ht(fe,ge,+(ve+$e==Se.length)),ge&7&&(ge+=8-(ge&7)),fe.l=ge/8|0,fe.write_shift(2,$e),fe.write_shift(2,~$e&65535);$e-- >0;)fe[fe.l++]=Se[ve++];ge=fe.l*8;continue}ge=Ht(fe,ge,+(ve+$e==Se.length)+2);for(var qe=0;$e-- >0;){var Le=Se[ve];qe=(qe<<5^Le)&32767;var Ge=-1,wt=0;if((Ge=Ie[qe])&&(Ge|=ve&-32768,Ge>ve&&(Ge-=32768),Ge<ve))for(;Se[Ge+wt]==Se[ve+wt]&&wt<250;)++wt;if(wt>2){Le=oe[wt],Le<=22?ge=Ue(fe,ge,G[Le+1]>>1)-1:(Ue(fe,ge,3),ge+=5,Ue(fe,ge,G[Le-23]>>5),ge+=3);var br=Le<8?0:Le-4>>2;br>0&&(he(fe,ge,wt-ie[Le]),ge+=br),Le=X[ve-Ge],ge=Ue(fe,ge,G[Le]>>3),ge-=3;var jr=Le<4?0:Le-2>>1;jr>0&&(he(fe,ge,ve-Ge-se[Le]),ge+=jr);for(var Ss=0;Ss<wt;++Ss)Ie[qe]=ve&32767,qe=(qe<<5^Se[ve])&32767,++ve;$e-=wt-1}else Le<=143?Le=Le+48:ge=gt(fe,ge,1),ge=Ue(fe,ge,G[Le]),Ie[qe]=ve&32767,++ve}ge=Ue(fe,ge,0)-1}return fe.l=(ge+7)/8|0,fe.l}return function(fe,ge){return fe.length<8?le(fe,ge):xe(fe,ge)}})();function ht(B){var X=Ae(50+Math.floor(B.length*1.1)),q=ft(B,X);return X.slice(0,q)}var Nt=K?new Uint16Array(32768):Fe(32768),Dr=K?new Uint16Array(32768):Fe(32768),ot=K?new Uint16Array(128):Fe(128),dt=1,Yt=1;function Qa(B,X){var q=Qe(B,X)+257;X+=5;var Y=Qe(B,X)+1;X+=5;var oe=We(B,X)+4;X+=4;for(var le=0,xe=K?new Uint8Array(19):Fe(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,ge=K?new Uint8Array(8):Fe(8),ve=K?new Uint8Array(8):Fe(8),Ie=xe.length,$e=0;$e<oe;++$e)xe[V[$e]]=le=Oe(B,X),fe<le&&(fe=le),ge[le]++,X+=3;var qe=0;for(ge[0]=0,$e=1;$e<=fe;++$e)ve[$e]=qe=qe+ge[$e-1]<<1;for($e=0;$e<Ie;++$e)(qe=xe[$e])!=0&&(Se[$e]=ve[qe]++);var Le=0;for($e=0;$e<Ie;++$e)if(Le=xe[$e],Le!=0){qe=G[Se[$e]]>>8-Le;for(var Ge=(1<<7-Le)-1;Ge>=0;--Ge)ot[qe|Ge<<Le]=Le&7|$e<<3}var wt=[];for(fe=1;wt.length<q+Y;)switch(qe=ot[Pe(B,X)],X+=qe&7,qe>>>=3){case 16:for(le=3+Ne(B,X),X+=2,qe=wt[wt.length-1];le-- >0;)wt.push(qe);break;case 17:for(le=3+Oe(B,X),X+=3;le-- >0;)wt.push(0);break;case 18:for(le=11+Pe(B,X),X+=7;le-- >0;)wt.push(0);break;default:wt.push(qe),fe<qe&&(fe=qe);break}var br=wt.slice(0,q),jr=wt.slice(q);for($e=q;$e<286;++$e)br[$e]=0;for($e=Y;$e<30;++$e)jr[$e]=0;return dt=Ye(br,Nt,286),Yt=Ye(jr,Dr,30),X}function ji(B,X){if(B[0]==3&&!(B[1]&3))return[ii(X),2];for(var q=0,Y=0,oe=my(X||1<<18),le=0,xe=oe.length>>>0,Se=0,fe=0;(Y&1)==0;){if(Y=Oe(B,q),q+=3,Y>>>1)Y>>1==1?(Se=9,fe=5):(q=Qa(B,q),Se=dt,fe=Yt);else{q&7&&(q+=8-(q&7));var ge=B[q>>>3]|B[(q>>>3)+1]<<8;if(q+=32,ge>0)for(!X&&xe<le+ge&&(oe=Me(oe,le+ge),xe=oe.length);ge-- >0;)oe[le++]=B[q>>>3],q+=8;continue}for(;;){!X&&xe<le+32767&&(oe=Me(oe,le+32767),xe=oe.length);var ve=rt(B,q,Se),Ie=Y>>>1==1?Rt[ve]:Nt[ve];if(q+=Ie&15,Ie>>>=4,(Ie>>>8&255)===0)oe[le++]=Ie;else{if(Ie==256)break;Ie-=257;var $e=Ie<8?0:Ie-4>>2;$e>5&&($e=0);var qe=le+ie[Ie];$e>0&&(qe+=rt(B,q,$e),q+=$e),ve=rt(B,q,fe),Ie=Y>>>1==1?Ot[ve]:Dr[ve],q+=Ie&15,Ie>>>=4;var Le=Ie<4?0:Ie-2>>1,Ge=se[Ie];for(Le>0&&(Ge+=rt(B,q,Le),q+=Le),!X&&xe<qe&&(oe=Me(oe,qe+100),xe=oe.length);le<qe;)oe[le]=oe[le-Ge],++le}}}return X?[oe,q+7>>>3]:[oe.slice(0,le),q+7>>>3]}function gn(B,X){var q=B.slice(B.l||0),Y=ji(q,X);return B.l+=Y[1],Y[0]}function Gn(B,X){if(B)typeof console<"u"&&console.error(X);else throw new Error(X)}function wi(B,X){var q=B;vs(q,0);var Y=[],oe=[],le={FileIndex:Y,FullPaths:oe};E(le,{root:X.root});for(var xe=q.length-4;(q[xe]!=80||q[xe+1]!=75||q[xe+2]!=5||q[xe+3]!=6)&&xe>=0;)--xe;q.l=xe+4,q.l+=4;var Se=q.read_shift(2);q.l+=6;var fe=q.read_shift(4);for(q.l=fe,xe=0;xe<Se;++xe){q.l+=20;var ge=q.read_shift(4),ve=q.read_shift(4),Ie=q.read_shift(2),$e=q.read_shift(2),qe=q.read_shift(2);q.l+=8;var Le=q.read_shift(4),Ge=l(q.slice(q.l+Ie,q.l+Ie+$e));q.l+=Ie+$e+qe;var wt=q.l;q.l=Le+4,Ks(q,ge,ve,le,Ge),q.l=wt}return le}function Ks(B,X,q,Y,oe){B.l+=2;var le=B.read_shift(2),xe=B.read_shift(2),Se=o(B);if(le&8257)throw new Error("Unsupported ZIP encryption");for(var fe=B.read_shift(4),ge=B.read_shift(4),ve=B.read_shift(4),Ie=B.read_shift(2),$e=B.read_shift(2),qe="",Le=0;Le<Ie;++Le)qe+=String.fromCharCode(B[B.l++]);if($e){var Ge=l(B.slice(B.l,B.l+$e));(Ge[21589]||{}).mt&&(Se=Ge[21589].mt),((oe||{})[21589]||{}).mt&&(Se=oe[21589].mt)}B.l+=$e;var wt=B.slice(B.l,B.l+ge);switch(xe){case 8:wt=D(B,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var br=!1;le&8&&(fe=B.read_shift(4),fe==134695760&&(fe=B.read_shift(4),br=!0),ge=B.read_shift(4),ve=B.read_shift(4)),ge!=X&&Gn(br,"Bad compressed size: "+X+" != "+ge),ve!=q&&Gn(br,"Bad uncompressed size: "+q+" != "+ve),bt(Y,qe,wt,{unsafe:!0,mt:Se})}function Bs(B,X){var q=X||{},Y=[],oe=[],le=Ae(1),xe=q.compression?8:0,Se=0,fe=0,ge=0,ve=0,Ie=0,$e=B.FullPaths[0],qe=$e,Le=B.FileIndex[0],Ge=[],wt=0;for(fe=1;fe<B.FullPaths.length;++fe)if(qe=B.FullPaths[fe].slice($e.length),Le=B.FileIndex[fe],!(!Le.size||!Le.content||qe=="Sh33tJ5")){var br=ve,jr=Ae(qe.length);for(ge=0;ge<qe.length;++ge)jr.write_shift(1,qe.charCodeAt(ge)&127);jr=jr.slice(0,jr.l),Ge[Ie]=g6.buf(Le.content,0);var Ss=Le.content;xe==8&&(Ss=I(Ss)),le=Ae(30),le.write_shift(4,67324752),le.write_shift(2,20),le.write_shift(2,Se),le.write_shift(2,xe),Le.mt?i(le,Le.mt):le.write_shift(4,0),le.write_shift(-4,Ge[Ie]),le.write_shift(4,Ss.length),le.write_shift(4,Le.content.length),le.write_shift(2,jr.length),le.write_shift(2,0),ve+=le.length,Y.push(le),ve+=jr.length,Y.push(jr),ve+=Ss.length,Y.push(Ss),le=Ae(46),le.write_shift(4,33639248),le.write_shift(2,0),le.write_shift(2,20),le.write_shift(2,Se),le.write_shift(2,xe),le.write_shift(4,0),le.write_shift(-4,Ge[Ie]),le.write_shift(4,Ss.length),le.write_shift(4,Le.content.length),le.write_shift(2,jr.length),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(4,0),le.write_shift(4,br),wt+=le.l,oe.push(le),wt+=jr.length,oe.push(jr),++Ie}return le=Ae(22),le.write_shift(4,101010256),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,Ie),le.write_shift(2,Ie),le.write_shift(4,wt),le.write_shift(4,ve),le.write_shift(2,0),ls([ls(Y),ls(oe),le])}var Ns={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function qn(B,X){if(B.ctype)return B.ctype;var q=B.name||"",Y=q.match(/\.([^\.]+)$/);return Y&&Ns[Y[1]]||X&&(Y=(q=X).match(/[\.\\]([^\.\\])+$/),Y&&Ns[Y[1]])?Ns[Y[1]]:"application/octet-stream"}function en(B){for(var X=ec(B),q=[],Y=0;Y<X.length;Y+=76)q.push(X.slice(Y,Y+76));return q.join(`\r
`)+`\r
`}function ye(B){var X=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var ve=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],Y=X.split(`\r
`),oe=0;oe<Y.length;++oe){var le=Y[oe];if(le.length==0){q.push("");continue}for(var xe=0;xe<le.length;){var Se=76,fe=le.slice(xe,xe+Se);fe.charAt(Se-1)=="="?Se--:fe.charAt(Se-2)=="="?Se-=2:fe.charAt(Se-3)=="="&&(Se-=3),fe=le.slice(xe,xe+Se),xe+=Se,xe<le.length&&(fe+="="),q.push(fe)}}return q.join(`\r
`)}function pe(B){for(var X=[],q=0;q<B.length;++q){for(var Y=B[q];q<=B.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+B[++q];X.push(Y)}for(var oe=0;oe<X.length;++oe)X[oe]=X[oe].replace(/[=][0-9A-Fa-f]{2}/g,function(le){return String.fromCharCode(parseInt(le.slice(1),16))});return ca(X.join(`\r
`))}function _e(B,X,q){for(var Y="",oe="",le="",xe,Se=0;Se<10;++Se){var fe=X[Se];if(!fe||fe.match(/^\s*$/))break;var ge=fe.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":Y=ge[2].trim();break;case"content-type":le=ge[2].trim();break;case"content-transfer-encoding":oe=ge[2].trim();break}}switch(++Se,oe.toLowerCase()){case"base64":xe=ca(pa(X.slice(Se).join("")));break;case"quoted-printable":xe=pe(X.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+oe)}var ve=bt(B,Y.slice(q.length),xe,{unsafe:!0});le&&(ve.ctype=le)}function et(B,X){if(z(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=X&&X.root||"",Y=(kt&&Buffer.isBuffer(B)?B.toString("binary"):z(B)).split(`\r
`),oe=0,le="";for(oe=0;oe<Y.length;++oe)if(le=Y[oe],!!/^Content-Location:/i.test(le)&&(le=le.slice(le.indexOf("file")),q||(q=le.slice(0,le.lastIndexOf("/")+1)),le.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),le.slice(0,q.length)!=q););var xe=(Y[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var Se="--"+(xe[1]||""),fe=[],ge=[],ve={FileIndex:fe,FullPaths:ge};E(ve);var Ie,$e=0;for(oe=0;oe<Y.length;++oe){var qe=Y[oe];qe!==Se&&qe!==Se+"--"||($e++&&_e(ve,Y.slice(Ie,oe),q),Ie=oe)}return ve}function He(B,X){var q=X||{},Y=q.boundary||"SheetJS";Y="------="+Y;for(var oe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],le=B.FullPaths[0],xe=le,Se=B.FileIndex[0],fe=1;fe<B.FullPaths.length;++fe)if(xe=B.FullPaths[fe].slice(le.length),Se=B.FileIndex[fe],!(!Se.size||!Se.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wt){return"_x"+wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wt){return"_u"+wt.charCodeAt(0).toString(16)+"_"});for(var ge=Se.content,ve=kt&&Buffer.isBuffer(ge)?ge.toString("binary"):z(ge),Ie=0,$e=Math.min(1024,ve.length),qe=0,Le=0;Le<=$e;++Le)(qe=ve.charCodeAt(Le))>=32&&qe<128&&++Ie;var Ge=Ie>=$e*4/5;oe.push(Y),oe.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+xe),oe.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),oe.push("Content-Type: "+qn(Se,xe)),oe.push(""),oe.push(Ge?ye(ve):en(ve))}return oe.push(Y+`--\r
`),oe.join(`\r
`)}function Ve(B){var X={};return E(X,B),X}function bt(B,X,q,Y){var oe=Y&&Y.unsafe;oe||E(B);var le=!oe&&lt.find(B,X);if(!le){var xe=B.FullPaths[0];X.slice(0,xe.length)==xe?xe=X:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+X).replace("//","/")),le={name:n(X),type:2},B.FileIndex.push(le),B.FullPaths.push(xe),oe||lt.utils.cfb_gc(B)}return le.content=q,le.size=q?q.length:0,Y&&(Y.CLSID&&(le.clsid=Y.CLSID),Y.mt&&(le.mt=Y.mt),Y.ct&&(le.ct=Y.ct)),le}function cr(B,X){E(B);var q=lt.find(B,X);if(q){for(var Y=0;Y<B.FileIndex.length;++Y)if(B.FileIndex[Y]==q)return B.FileIndex.splice(Y,1),B.FullPaths.splice(Y,1),!0}return!1}function nt(B,X,q){E(B);var Y=lt.find(B,X);if(Y){for(var oe=0;oe<B.FileIndex.length;++oe)if(B.FileIndex[oe]==Y)return B.FileIndex[oe].name=n(q),B.FullPaths[oe]=q,!0}return!1}function jt(B){T(B,!0)}return t.find=_,t.read=N,t.parse=u,t.write=me,t.writeFile=re,t.utils={cfb_new:Ve,cfb_add:bt,cfb_del:cr,cfb_mov:nt,cfb_gc:jt,ReadShift:Bl,CheckField:TE,prep_blob:vs,bconcat:ls,use_zlib:A,_deflateRaw:ht,_inflateRaw:gn,consts:ee},t})();function v6(e){return typeof e=="string"?im(e):Array.isArray(e)?HR(e):e}function Dc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=im(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?ln(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([v6(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=hi(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function y6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Pr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function by(e,t){for(var r=[],a=Pr(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function lm(e){for(var t=[],r=Pr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function cm(e){for(var t=[],r=Pr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function b6(e){for(var t=[],r=Pr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var su=new Date(1899,11,30,0,0,0);function es(e,t){var r=e.getTime(),a=su.getTime()+(e.getTimezoneOffset()-su.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var nE=new Date,j6=su.getTime()+(nE.getTimezoneOffset()-su.getTimezoneOffset())*6e4,jy=nE.getTimezoneOffset();function dm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+j6),t.getTimezoneOffset()!==jy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-jy)*6e4),t}function w6(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var wy=new Date("2017-02-19T19:06:09.000Z"),iE=isNaN(wy.getFullYear())?new Date("2/19/17"):wy,N6=iE.getFullYear()==2017;function hr(e,t){var r=new Date(e);if(N6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(iE.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Xi(e,t){if(kt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ln(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ln(qS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ln(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ln(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function pr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=pr(e[r]));return t}function Ir(e,t){for(var r="";r.length<t;)r+=e;return r}function Ya(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var S6=["january","february","march","april","may","june","july","august","september","october","november","december"];function zo(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&S6.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var E6=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],l=1;l<i.length;++l)o.push(n),o.push(i[l]);return o}})();function oE(e){return e?e.content&&e.type?Xi(e.content,!0):e.data?Ol(e.data):e.asNodeBuffer&&kt?Ol(e.asNodeBuffer().toString("binary")):e.asBinary?Ol(e.asBinary()):e._data&&e._data.getContent?Ol(Xi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function lE(e){if(!e)return null;if(e.data)return dy(e.data);if(e.asNodeBuffer&&kt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?dy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function T6(e){return e&&e.name.slice(-4)===".bin"?lE(e):oE(e)}function ka(e,t){for(var r=e.FullPaths||Pr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function sg(e,t){var r=ka(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Hr(e,t,r){if(!r)return T6(sg(e,t));if(!t)return null;try{return Hr(e,t)}catch{return null}}function da(e,t,r){if(!r)return oE(sg(e,t));if(!t)return null;try{return da(e,t)}catch{return null}}function C6(e,t,r){return lE(sg(e,t))}function Ny(e){for(var t=e.FullPaths||Pr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Ct(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return kt?a=Ln(r):a=VR(r),lt.utils.cfb_add(e,t,a)}lt.utils.cfb_add(e,t,r)}else e.file(t,r)}function ag(){return lt.utils.cfb_new()}function cE(e,t){switch(t.type){case"base64":return lt.read(e,{type:"base64"});case"binary":return lt.read(e,{type:"binary"});case"buffer":case"array":return lt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Rl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var $r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,A6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Sy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_6=/<[^>]*>/g,Ms=$r.match(Sy)?Sy:_6,k6=/<\w*:/,D6=/<(\/?)\w+:/;function pt(e,t,r){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(A6),l=0,c="",d=0,u="",m="",f=1;if(o)for(d=0;d!=o.length;++d){for(m=o[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(u=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(f=(n=m.charCodeAt(i+1))==34||n==39?1:0,c=m.slice(i+1+f,m.length-f),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=c,a[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(a[h]&&u.slice(l-3,l)=="ext")continue;a[h]=c,a[h.toLowerCase()]=c}}return a}function pn(e){return e.replace(D6,"<$1")}var dE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ng=lm(dE),Ut=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(l,c){return dE[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,o)+r(n.slice(o+3))}})(),ig=/[&<>'"]/g,I6=/[\u0000-\u0008\u000b-\u001f]/g;function sr(e){var t=e+"";return t.replace(ig,function(r){return ng[r]}).replace(I6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ey(e){return sr(e).replace(/ /g,"_x0020_")}var uE=/[\u0000-\u001f]/g;function og(e){var t=e+"";return t.replace(ig,function(r){return ng[r]}).replace(/\n/g,"<br/>").replace(uE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function O6(e){var t=e+"";return t.replace(ig,function(r){return ng[r]}).replace(uE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Ty=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function P6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function fr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function tf(e){for(var t="",r=0,a=0,n=0,i=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Cy(e){var t=ii(2*e.length),r,a,n=1,i=0,o=0,l;for(a=0;a<e.length;a+=n)n=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Ay(e){return Ln(e,"binary").toString("utf8")}var dd="foo bar baz",ir=kt&&(Ay(dd)==tf(dd)&&Ay||Cy(dd)==tf(dd)&&Cy)||tf,ln=kt?function(e){return Ln(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},rc=(function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),mE=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),R6=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),F6=/<\/?(?:vt:)?variant>/g,L6=/<(?:vt:)([^>]*)>([\s\S]*)</;function _y(e,t){var r=pt(e),a=e.match(R6(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var o=i.replace(F6,"").match(L6);o&&n.push({v:ir(o[2]),t:o[1]})}),n}var fE=/(^\s|\s$|\n)/;function bs(e,t){return"<"+e+(t.match(fE)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function sc(e){return Pr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?sc(r):"")+(t!=null?(t.match(fE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Op(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function M6(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",sr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",sr(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",Op(e));throw new Error("Unable to serialize "+e)}function lg(e){if(kt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ir(hi(eg(e)));throw new Error("Bad input format: expected Buffer or string")}var ac=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},lo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function B6(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function z6(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=a?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var ky=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Dy=kt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ln(t)})):ky(e)}:ky,Iy=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(jn(e,n)));return a.join("").replace(Gs,"")},cg=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Gs,""):Iy(e,t,r)}:Iy,Oy=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},hE=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Oy(e,t,r)}:Oy,Py=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Co(e,n)));return a.join("")},Ic=kt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Py(t,r,a)}:Py,pE=function(e,t){var r=la(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},xE=pE,gE=function(e,t){var r=la(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},vE=gE,yE=function(e,t){var r=2*la(e,t);return r>0?Ic(e,t+4,t+4+r-1):""},bE=yE,jE=function(t,r){var a=la(t,r);return a>0?cg(t,r+4,r+4+a):""},wE=jE,NE=function(e,t){var r=la(e,t);return r>0?Ic(e,t+4,t+4+r):""},SE=NE,EE=function(e,t){return B6(e,t)},au=EE,dg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};kt&&(xE=function(t,r){if(!Buffer.isBuffer(t))return pE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},vE=function(t,r){if(!Buffer.isBuffer(t))return gE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},bE=function(t,r){if(!Buffer.isBuffer(t))return yE(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},wE=function(t,r){if(!Buffer.isBuffer(t))return jE(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},SE=function(t,r){if(!Buffer.isBuffer(t))return NE(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},au=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):EE(t,r)},dg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Co=function(e,t){return e[t]},jn=function(e,t){return e[t+1]*256+e[t]},$6=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},la=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ai=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},U6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Bl(e,t){var r="",a,n,i=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,kt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(jn(this,d)),d+=2;e*=2;break;case"utf8":r=Ic(this,this.l,this.l+e);break;case"utf16le":e*=2,r=cg(this,this.l,this.l+e);break;case"wstr":return Bl.call(this,e,"dbcs");case"lpstr-ansi":r=xE(this,this.l),e=4+la(this,this.l);break;case"lpstr-cp":r=vE(this,this.l),e=4+la(this,this.l);break;case"lpwstr":r=bE(this,this.l),e=4+2*la(this,this.l);break;case"lpp4":e=4+la(this,this.l),r=wE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+la(this,this.l),r=SE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Co(this,this.l+e++))!==0;)i.push(cd(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=jn(this,this.l+e))!==0;)i.push(cd(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Co(this,d),this.l=d+1,l=Bl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(cd(jn(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Co(this,d),this.l=d+1,l=Bl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(cd(Co(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return a=Co(this,this.l),this.l++,a;case 2:return a=(t==="i"?$6:jn)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Ai:U6)(this,this.l),this.l+=4,a):(n=la(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=au(this,this.l):n=au([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=hE(this,this.l,e);break}}return this.l+=e,r}var W6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},H6=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},V6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function G6(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)V6(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,W6(this,t,this.l);break;case 8:if(a=8,r==="f"){z6(this,t,this.l);break}case 16:break;case-4:a=4,H6(this,t,this.l);break}return this.l+=a,this}function TE(e,t){var r=hE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function vs(e,t){e.l=t,e.read_shift=Bl,e.chk=TE,e.write_shift=G6}function Ls(e,t){e.l+=t}function Ae(e){var t=ii(e);return vs(t,0),t}function Mn(e,t,r){if(e){var a,n,i;vs(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=dc[l]||dc[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=c,t(u,d,l))return}}}function ta(){var e=[],t=kt?256:2048,r=function(d){var u=Ae(d);return vs(u,0),u},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(n(),a=r(Math.max(d+1,t)))},o=function(){return n(),ls(e)},l=function(d){n(),a=d,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function Re(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=dc[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&dg(r)&&e.push(r)}}function zl(e,t,r){var a=pr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Ry(e,t,r){var a=pr(e);return a.s=zl(a.s,t.s,r),a.e=zl(a.e,t.s,r),a}function $l(e,t){if(e.cRel&&e.c<0)for(e=pr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=pr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=mt(e);return!e.cRel&&e.cRel!=null&&(r=Y6(r)),!e.rRel&&e.rRel!=null&&(r=q6(r)),r}function rf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Er(e.s.c)+":"+(e.e.cRel?"":"$")+Er(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Br(e.s.r)+":"+(e.e.rRel?"":"$")+Br(e.e.r):$l(e.s,t.biff)+":"+$l(e.e,t.biff)}function ug(e){return parseInt(K6(e),10)-1}function Br(e){return""+(e+1)}function q6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K6(e){return e.replace(/\$(\d+)$/,"$1")}function mg(e){for(var t=X6(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Er(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Y6(e){return e.replace(/^([A-Z])/,"$$$1")}function X6(e){return e.replace(/^\$([A-Z])/,"$1")}function J6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function mt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ra(e){var t=e.indexOf(":");return t==-1?{s:Tr(e),e:Tr(e)}:{s:Tr(e.slice(0,t)),e:Tr(e.slice(t+1))}}function Tt(e,t){return typeof t>"u"||typeof t=="number"?Tt(e.s,e.e):(typeof e!="string"&&(e=mt(e)),typeof t!="string"&&(t=mt(t)),e==t?e:e+":"+t)}function Wt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function Fy(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=La(e.z,r?es(t):t)}catch{}try{return e.w=La((e.XF||{}).numFmtId||(r?14:0),r?es(t):t)}catch{return""+t}}function Dn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Bn[e.v]||e.v:t==null?Fy(e,e.v):Fy(e,t))}function pi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function CE(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),o=0,l=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Tr(a.origin):a.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Wt(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[m].length;++f)if(!(typeof t[m][f]>"u")){var h={v:t[m][f]},p=o+m,x=l+f;if(d.s.r>p&&(d.s.r=p),d.s.c>x&&(d.s.c=x),d.e.r<p&&(d.e.r=p),d.e.c<x&&(d.e.c=x),t[m][f]&&typeof t[m][f]=="object"&&!Array.isArray(t[m][f])&&!(t[m][f]instanceof Date))h=t[m][f];else if(Array.isArray(h.v)&&(h.f=t[m][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||ut[14],a.cellDates?(h.t="d",h.w=La(h.z,es(h.v))):(h.t="n",h.v=es(h.v),h.w=La(h.z,h.v))):h.t="s";if(n)i[p]||(i[p]=[]),i[p][x]&&i[p][x].z&&(h.z=i[p][x].z),i[p][x]=h;else{var g=mt({c:x,r:p});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return d.s.c<1e7&&(i["!ref"]=Tt(d)),i}function il(e,t){return CE(null,e,t)}function Z6(e){return e.read_shift(4,"i")}function Xa(e,t){return t||(t=Ae(4)),t.write_shift(4,e),t}function Rs(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function cs(e,t){var r=!1;return t==null&&(r=!0,t=Ae(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Q6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function eF(e,t){return t||(t=Ae(4)),t.write_shift(2,0),t.write_shift(2,0),t}function fg(e,t){var r=e.l,a=e.read_shift(1),n=Rs(e),i=[],o={t:n,h:n};if((a&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(Q6(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function tF(e,t){var r=!1;return t==null&&(r=!0,t=Ae(15+4*e.t.length)),t.write_shift(1,0),cs(e.t,t),r?t.slice(0,t.l):t}var rF=fg;function sF(e,t){var r=!1;return t==null&&(r=!0,t=Ae(23+4*e.t.length)),t.write_shift(1,1),cs(e.t,t),t.write_shift(4,1),eF({},t),r?t.slice(0,t.l):t}function za(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function co(e,t){return t==null&&(t=Ae(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function uo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function mo(e,t){return t==null&&(t=Ae(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var aF=Rs,AE=cs;function hg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function nu(e,t){var r=!1;return t==null&&(r=!0,t=Ae(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var nF=Rs,Pp=hg,pg=nu;function xg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?au([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ai(t,0)>>2;return r?n/100:n}function _E(e,t){t==null&&(t=Ae(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function kE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function iF(e,t){return t||(t=Ae(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var fo=kE,ol=iF;function Ps(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ji(e,t){return(t||Ae(8)).write_shift(8,e,"f")}function oF(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var d=Li[n];d&&(t.rgb=ic(d));break;case 2:t.rgb=ic([o,l,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function iu(e,t){if(t||(t=Ae(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function lF(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function cF(e,t){t||(t=Ae(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function DE(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function dF(e){return DE(e,1)}function uF(e){return DE(e,2)}var gg=2,Xs=3,ud=11,Ly=12,ou=19,md=64,mF=65,fF=71,hF=4108,pF=4126,is=80,IE=81,xF=[is,IE],Rp={1:{n:"CodePage",t:gg},2:{n:"Category",t:is},3:{n:"PresentationFormat",t:is},4:{n:"ByteCount",t:Xs},5:{n:"LineCount",t:Xs},6:{n:"ParagraphCount",t:Xs},7:{n:"SlideCount",t:Xs},8:{n:"NoteCount",t:Xs},9:{n:"HiddenCount",t:Xs},10:{n:"MultimediaClipCount",t:Xs},11:{n:"ScaleCrop",t:ud},12:{n:"HeadingPairs",t:hF},13:{n:"TitlesOfParts",t:pF},14:{n:"Manager",t:is},15:{n:"Company",t:is},16:{n:"LinksUpToDate",t:ud},17:{n:"CharacterCount",t:Xs},19:{n:"SharedDoc",t:ud},22:{n:"HyperlinksChanged",t:ud},23:{n:"AppVersion",t:Xs,p:"version"},24:{n:"DigSig",t:mF},26:{n:"ContentType",t:is},27:{n:"ContentStatus",t:is},28:{n:"Language",t:is},29:{n:"Version",t:is},255:{},2147483648:{n:"Locale",t:ou},2147483651:{n:"Behavior",t:ou},1919054434:{}},Fp={1:{n:"CodePage",t:gg},2:{n:"Title",t:is},3:{n:"Subject",t:is},4:{n:"Author",t:is},5:{n:"Keywords",t:is},6:{n:"Comments",t:is},7:{n:"Template",t:is},8:{n:"LastAuthor",t:is},9:{n:"RevNumber",t:is},10:{n:"EditTime",t:md},11:{n:"LastPrinted",t:md},12:{n:"CreatedDate",t:md},13:{n:"ModifiedDate",t:md},14:{n:"PageCount",t:Xs},15:{n:"WordCount",t:Xs},16:{n:"CharCount",t:Xs},17:{n:"Thumbnail",t:fF},18:{n:"Application",t:is},19:{n:"DocSecurity",t:Xs},255:{},2147483648:{n:"Locale",t:ou},2147483651:{n:"Behavior",t:ou},1919054434:{}},My={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},gF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vF(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var yF=vF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Li=pr(yF),Bn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},OE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Lp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function vg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bF(e){var t=vg();if(!e||!e.match)return t;var r={};if((e.match(Ms)||[]).forEach(function(a){var n=pt(a);switch(n[0].replace(k6,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Lp[n.ContentType]]!==void 0&&t[Lp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Zr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function PE(e,t){var r=b6(Lp),a=[],n;a[a.length]=$r,a[a.length]=Be("Types",null,{xmlns:Zr.CT,"xmlns:xsd":Zr.xsd,"xmlns:xsi":Zr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Be("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=Be("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:fd[c][t.bookType]||fd[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:fd[c][t.bookType]||fd[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){a[a.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var It={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function nc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ul(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Ms)||[]).forEach(function(n){var i=pt(n);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Rl(i.Target,t);r[l]=o,a[i.Id]=o}}),r["!id"]=a,r}function Do(e){var t=[$r,Be("Relationships",null,{xmlns:Zr.RELS})];return Pr(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Qt(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[It.HLINK,It.XPATH,It.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var jF="application/vnd.oasis.opendocument.spreadsheet";function wF(e,t){for(var r=lg(e),a,n;a=ac.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=pt(a[0],!1),n.path=="/"&&n.type!==jF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function NF(e){var t=[$r];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function By(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function SF(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function EF(e){var t=[$r];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(By(e[r][0],e[r][1])),t.push(SF("",e[r][0]));return t.push(By("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function RE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Qd.version+"</meta:generator></office:meta></office:document-meta>"}var Ra=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],TF=(function(){for(var e=new Array(Ra.length),t=0;t<Ra.length;++t){var r=Ra[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function FE(e){var t={};e=ir(e);for(var r=0;r<Ra.length;++r){var a=Ra[r],n=e.match(TF[r]);n!=null&&n.length>0&&(t[a[1]]=Ut(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=hr(t[a[1]]))}return t}function sf(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=sr(t),a[a.length]=r?Be(e,t,r):bs(e,t))}function LE(e,t){var r=t||{},a=[$r,Be("cp:coreProperties",null,{"xmlns:cp":Zr.CORE_PROPS,"xmlns:dc":Zr.dc,"xmlns:dcterms":Zr.dcterms,"xmlns:dcmitype":Zr.dcmitype,"xmlns:xsi":Zr.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&sf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Op(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&sf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Op(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=Ra.length;++i){var o=Ra[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&sf(o[0],l,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Mi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ME=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function BE(e,t,r,a){var n=[];if(typeof e=="string")n=_y(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?_y(t,a).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var d=0;d!==n.length;d+=2){switch(c=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function CF(e,t,r){var a={};return t||(t={}),e=ir(e),Mi.forEach(function(n){var i=(e.match(rc(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Ut(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&BE(a.HeadingPairs,a.TitlesOfParts,t,r),t}function zE(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=$r,t[t.length]=Be("Properties",null,{xmlns:Zr.EXT_PROPS,"xmlns:vt":Zr.vt}),Mi.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=sr(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+sr(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var AF=/<[^>]+>[^<]*/g;function _F(e,t){var r={},a="",n=e.match(AF);if(n)for(var i=0;i!=n.length;++i){var o=n[i],l=pt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ut(l.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Ut(u);break;case"bool":r[a]=fr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=hr(u);break;case"cy":case"error":r[a]=Ut(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function $E(e){var t=[$r,Be("Properties",null,{xmlns:Zr.CUST_PROPS,"xmlns:vt":Zr.vt})];if(!e)return t.join("");var r=1;return Pr(e).forEach(function(n){++r,t[t.length]=Be("property",M6(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:sr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Mp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},af;function kF(e,t,r){af||(af=lm(Mp)),t=af[t]||t,e[t]=r}function DF(e,t){var r=[];return Pr(Mp).map(function(a){for(var n=0;n<Ra.length;++n)if(Ra[n][1]==a)return Ra[n];for(n=0;n<Mi.length;++n)if(Mi[n][1]==a)return Mi[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(bs(Mp[a[1]]||a[1],n))}}),Be("DocumentProperties",r.join(""),{xmlns:oa.o})}function IF(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Pr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Ra.length;++o)if(i==Ra[o][1])return;for(o=0;o<Mi.length;++o)if(i==Mi[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(Be(Ey(i),l,{"dt:dt":c}))}}),t&&Pr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Be(Ey(i),o,{"dt:dt":l}))}}),"<"+a+' xmlns="'+oa.o+'">'+n.join("")+"</"+a+">"}function yg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function OF(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var o=Ae(8);return o.write_shift(4,a),o.write_shift(4,n),o}function UE(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function WE(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function HE(e,t,r){return t===31?WE(e):UE(e,t,r)}function Bp(e,t,r){return HE(e,t,r===!1?0:4)}function PF(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return HE(e,t,0)}function RF(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Gs,""),e.l-n&2&&(e.l+=2)}return r}function FF(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Gs,"");return r}function LF(e){var t=e.l,r=lu(e,IE);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=lu(e,Xs);return[r,a]}function MF(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(LF(e));return r}function zy(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var i=e.read_shift(4),o=e.read_shift(4);a[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Gs,"").replace(Pl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function VE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function BF(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function lu(e,t,r){var a=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==Ly&&a!==t&&xF.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Ly?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return UE(e,a,4).replace(Gs,"");case 31:return WE(e);case 64:return yg(e);case 65:return VE(e);case 71:return BF(e);case 80:return Bp(e,a,!i.raw).replace(Gs,"");case 81:return PF(e,a).replace(Gs,"");case 4108:return MF(e);case 4126:case 4127:return a==4127?RF(e):FF(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function $y(e,t){var r=Ae(4),a=Ae(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Ae(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=OF(t);break;case 31:case 80:for(a=Ae(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ls([r,a])}function Uy(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=n;++o){var u=e.read_shift(4),m=e.read_shift(4);i[o]=[u,m+r]}i.sort(function(j,y){return j[1]-y[1]});var f={};for(o=0;o!=n;++o){if(e.l!==i[o][1]){var h=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(h=!1,e.l=i[o][1]),h)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var p=t[i[o][0]];if(f[p.n]=lu(e,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qa(l=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(i[o][0]===1){if(l=f.CodePage=lu(e,gg),qa(l),c!==-1){var x=e.l;e.l=i[c][1],d=zy(e,l),e.l=x}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}d=zy(e,l)}else{var g=d[i[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=VE(e);break;case 30:e.l+=4,b=Bp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=Bp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Fr(e,4);break;case 64:e.l+=4,b=hr(yg(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[g]=b}}return e.l=r+a,f}var GE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function zF(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Wy(e,t,r){var a=Ae(8),n=[],i=[],o=8,l=0,c=Ae(8),d=Ae(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),n.push(d),o+=8+c.length,!t){d=Ae(8),d.write_shift(4,0),n.unshift(d);var u=[Ae(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(c=Ae(8+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=ls(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(GE.indexOf(e[l][0])>-1||ME.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],h=0;if(t){h=+t[e[l][0]];var p=r[h];if(p.p=="version"&&typeof f=="string"){var x=f.split(".");f=(+x[0]<<16)+(+x[1]||0)}c=$y(p.t,f)}else{var g=zF(f);g==-1&&(g=31,f=String(f)),c=$y(g,f)}i.push(c),d=Ae(8),d.write_shift(4,t?h:2+l),n.push(d),o+=8+c.length}var b=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,b),b+=i[l].length;return a.write_shift(4,o),a.write_shift(4,i.length),ls([a].concat(n).concat(i))}function Hy(e,t,r){var a=e.content;if(!a)return{};vs(a,0);var n,i,o,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),u=a.read_shift(16);if(u!==lt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),l=a.read_shift(4),n===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);n===2&&(o=a.read_shift(16),c=a.read_shift(4));var m=Uy(a,t),f={SystemIdentifier:d};for(var h in m)f[h]=m[h];if(f.FMTID=i,n===1)return f;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var p;try{p=Uy(a,null)}catch{}for(h in p)f[h]=p[h];return f.FMTID=[i,o],f}function Vy(e,t,r,a,n,i){var o=Ae(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,lt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var c=Wy(e,r,a);if(l.push(c),n){var d=Wy(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return ls(l)}function Xn(e,t){return e.read_shift(t),null}function $F(e,t){t||(t=Ae(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function UF(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Fr(e,t){return e.read_shift(t)===1}function $s(e,t){return t||(t=Ae(2)),t.write_shift(2,+!!e),t}function Vr(e){return e.read_shift(2,"u")}function Da(e,t){return t||(t=Ae(2)),t.write_shift(2,e),t}function qE(e,t){return UF(e,t,Vr)}function WF(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function KE(e,t,r){return r||(r=Ae(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Oc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return o}function HF(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,i=1+(r&1),o=0,l,c={};n&&(o=e.read_shift(2)),a&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return n&&(e.l+=4*o),a&&(e.l+=l),c.t=u,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function VF(e){var t=e.t||"",r=Ae(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Ae(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return ls(n)}function Zi(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Pc(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Zi(e,a,r)}function ho(e,t,r){if(r.biff>5)return Pc(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function YE(e,t,r){return r||(r=Ae(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function GF(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function qF(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Gs,"");return a&&(e.l+=24),n}function KF(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Gs,"");return r+o}function YF(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return qF(e);case"0303000000000000c000000000000046":return KF(e);default:throw new Error("Unsupported Moniker "+r)}}function hd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Gs,""):"";return r}function Gy(e,t){t||(t=Ae(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function XF(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,o,l,c,d="",u,m;n&16&&(i=hd(e,r-e.l)),n&128&&(o=hd(e,r-e.l)),(n&257)===257&&(l=hd(e,r-e.l)),(n&257)===1&&(c=YF(e,r-e.l)),n&8&&(d=hd(e,r-e.l)),n&32&&(u=e.read_shift(16)),n&64&&(m=yg(e)),e.l=r;var f=o||l||c||"";f&&d&&(f+="#"+d),f||(f="#"+d),n&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return u&&(h.guid=u),m&&(h.time=m),i&&(h.Tooltip=i),h}function JF(e){var t=Ae(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),Gy(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&Gy(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function XE(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function JE(e,t){var r=XE(e);return r[3]=0,r}function xn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Qi(e,t,r,a){return a||(a=Ae(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function ZF(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function QF(e,t,r){return t===0?"":ho(e,t,r)}function eL(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,i,o]}function ZE(e){var t=e.read_shift(2),r=xg(e);return[t,r]}function tL(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=Oc(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function um(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function QE(e,t){return t||(t=Ae(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function eT(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var rL=eT;function tT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function sL(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function aL(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Es(e){e.l+=2,e.l+=e.read_shift(2)}var nL={0:Es,4:Es,5:Es,6:Es,7:aL,8:Es,9:Es,10:Es,11:Es,12:Es,13:sL,14:Es,15:Es,16:Es,17:Es,18:Es,19:Es,20:Es,21:tT};function iL(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(nL[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function pd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function bg(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ae(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function oL(e,t){return t===0||e.read_shift(2),1200}function lL(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=ho(e,0,r);return e.read_shift(t+a-e.l),n}function cL(e,t){var r=!t||t.biff==8,a=Ae(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function dL(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function uL(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=Oc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:i,name:o}}function mL(e,t){var r=!t||t.biff>=8?2:1,a=Ae(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function fL(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),i=[],o=0;o!=n&&e.l<r;++o)i.push(HF(e));return i.Count=a,i.Unique=n,i}function hL(e,t){var r=Ae(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=VF(e[n]);var i=ls([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function pL(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function xL(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function gL(e){var t=ZF(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function vL(e){return e.read_shift(2),e.read_shift(4)}function qy(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function yL(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function bL(){var e=Ae(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function jL(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function wL(e){var t=Ae(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function NL(){}function SL(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Oc(e,0,r),a}function EL(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=Ae(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function TL(e){var t=xn(e);return t.isst=e.read_shift(4),t}function CL(e,t,r,a){var n=Ae(10);return Qi(e,t,a,n),n.write_shift(4,r),n}function AL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=xn(e);r.biff==2&&e.l++;var i=Pc(e,a-e.l,r);return n.val=i,n}function _L(e,t,r,a,n){var i=!n||n.biff==8,o=Ae(8+ +i+(1+i)*r.length);return Qi(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function kL(e,t,r){var a=e.read_shift(2),n=ho(e,0,r);return[a,n]}function DL(e,t,r,a){var n=r&&r.biff==5;a||(a=Ae(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var IL=ho;function Ky(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:l},e:{r:o,c}}}function OL(e,t){var r=t.biff==8||!t.biff?4:2,a=Ae(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function PL(e){var t=e.read_shift(2),r=e.read_shift(2),a=ZE(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function RL(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(ZE(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:i}}function FL(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:i}}function LL(e,t,r,a){var n={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=gF[l>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function ML(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=LL(e,t,a.fStyle,r),a}function Yy(e,t,r,a){var n=r&&r.biff==5;a||(a=Ae(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function BL(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function zL(e){var t=Ae(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Xy(e,t,r){var a=xn(e);(r.biff==2||t==9)&&++e.l;var n=WF(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function $L(e,t,r,a,n,i){var o=Ae(8);return Qi(e,t,a,o),KE(r,i,o),o}function UL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=xn(e),n=Ps(e);return a.val=n,a}function WL(e,t,r,a){var n=Ae(14);return Qi(e,t,a,n),Ji(r,n),n}var Jy=QF;function HL(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Zi(e,i),l=[];a>e.l;)l.push(Pc(e));return[i,n,o,l]}function Zy(e,t,r){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=tL(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var VL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Qy(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Zi(e,o,r);n&32&&(d=VL[d.charCodeAt(0)]);var u=a-e.l;r&&r.biff==2&&--u;var m=a==e.l||l===0||!(u>0)?[]:iz(e,u,r,l);return{chKey:i,Name:d,itab:c,rgce:m}}function rT(e,t,r){if(r.biff<8)return GL(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(eL(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function GL(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Oc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function qL(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),i=Zi(e,a,r),o=Zi(e,n,r);return[i,o]}function KL(e,t,r){var a=eT(e);e.l++;var n=e.read_shift(1);return t-=8,[oz(e,t,r),n,a]}function eb(e,t,r){var a=rL(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,az(e,t,r)]}function YL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function XL(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=ho(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},l,o,i]}}function JL(e,t,r){return XL(e,t,r)}function ZL(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(um(e));return r}function QL(e){var t=Ae(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)QE(e[r],t);return t}function e8(e,t,r){if(r&&r.biff<8)return r8(e,t,r);var a=tT(e),n=iL(e,t-22,a[1]);return{cmo:a,ft:n}}var t8={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function r8(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((t8[a]||Ls)(e,t,r)),{cmo:[n,a,i],ft:o}}function s8(e,t,r){var a=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=GF(e,6,r);var l=e.read_shift(2);e.read_shift(2),Vr(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],m=Zi(e,e.lens[d+1]-e.lens[d]-1);if(n+=m,n.length>=(u?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function a8(e,t){var r=um(e);e.l+=16;var a=XF(e,t-24);return[r,a]}function n8(e){var t=Ae(24),r=Tr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return ls([t,JF(e[1])])}function i8(e,t){e.read_shift(2);var r=um(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Gs,""),[r,a]}function o8(e){var t=e[1].Tooltip,r=Ae(10+2*(t.length+1));r.write_shift(2,2048);var a=Tr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function l8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=My[r]||r,r=e.read_shift(2),t[1]=My[r]||r,t}function c8(e){return e||(e=Ae(4)),e.write_shift(2,1),e.write_shift(2,1),e}function d8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(JE(e));return r}function u8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(JE(e));return r}function m8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function sT(e,t,r){if(!r.cellStyles)return Ls(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var d={s:n,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function f8(e,t){var r=Ae(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function h8(e,t){var r={};return t<32||(e.l+=16,r.header=Ps(e),r.footer=Ps(e),e.l+=2),r}function p8(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function x8(e){for(var t=Ae(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var g8=xn,v8=qE,y8=Pc;function b8(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function j8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=xn(e);++e.l;var n=ho(e,t-7,r);return a.t="str",a.val=n,a}function w8(e){var t=xn(e);++e.l;var r=Ps(e);return t.t="n",t.val=r,t}function N8(e,t,r){var a=Ae(15);return Mc(a,e,t),a.write_shift(8,r,"f"),a}function S8(e){var t=xn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function E8(e,t,r){var a=Ae(9);return Mc(a,e,t),a.write_shift(2,r),a}function T8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function C8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function A8(e,t,r){var a=e.l+t,n=xn(e),i=e.read_shift(2),o=Zi(e,i,r);return e.l=a,n.t="str",n.val=o,n}var _8=[2,3,48,49,131,139,140,245],zp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=ii(1);switch(c.type){case"base64":u=ca(pa(l));break;case"binary":u=ca(l);break;case"buffer":case"array":u=l;break}vs(u,0);var m=u.read_shift(1),f=!!(m&136),h=!1,p=!1;switch(m){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var x=0,g=521;m==2&&(x=u.read_shift(2)),u.l+=3,m!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),m!=2&&(g=u.read_shift(2));var b=u.read_shift(2),j=c.codepage||1252;m!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(j=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var y=[],w={},S=Math.min(u.length,m==2?521:g-10-(h?264:0)),N=p?32:11;u.l<S&&u[u.l]!=13;)switch(w={},w.name=Ql.utils.decode(j,u.slice(u.l,u.l+N)).replace(/[\u0000\r\n].*$/g,""),u.l+=N,w.type=String.fromCharCode(u.read_shift(1)),m!=2&&!p&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),m==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&y.push(w),m!=2&&(u.l+=p?13:14),w.type){case"B":(!h||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var E=0,P=0;for(d[0]=[],P=0;P!=y.length;++P)d[0][P]=y[P].name;for(;x-- >0;){if(u[u.l]===42){u.l+=b;continue}for(++u.l,d[++E]=[],P=0,P=0;P!=y.length;++P){var T=u.slice(u.l,u.l+y[P].len);u.l+=y[P].len,vs(T,0);var O=Ql.utils.decode(j,T);switch(y[P].type){case"C":O.trim().length&&(d[E][P]=O.replace(/\s+$/,""));break;case"D":O.length===8?d[E][P]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):d[E][P]=O;break;case"F":d[E][P]=parseFloat(O.trim());break;case"+":case"I":d[E][P]=p?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":d[E][P]=!0;break;case"N":case"F":d[E][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[E][P]="##MEMO##"+(p?parseInt(O.trim(),10):T.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(d[E][P]=+O||0);break;case"@":d[E][P]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":d[E][P]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":d[E][P]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[E][P]=-T.read_shift(-8,"f");break;case"B":if(h&&y[P].len==8){d[E][P]=T.read_shift(8,"f");break}case"G":case"P":T.l+=y[P].len;break;case"0":if(y[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[P].type)}}}if(m!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=y,d}function a(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=il(r(l,d),d);return u["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,u}function n(l,c){try{return pi(a(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&qa(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=ta(),m=uu(l,{header:1,raw:!0,cellDates:!0}),f=m[0],h=m.slice(1),p=l["!cols"]||[],x=0,g=0,b=0,j=1;for(x=0;x<f.length;++x){if(((p[x]||{}).DBF||{}).name){f[x]=p[x].DBF.name,++b;continue}if(f[x]!=null){if(++b,typeof f[x]=="number"&&(f[x]=f[x].toString(10)),typeof f[x]!="string")throw new Error("DBF Invalid column name "+f[x]+" |"+typeof f[x]+"|");if(f.indexOf(f[x])!==x){for(g=0;g<1024;++g)if(f.indexOf(f[x]+"_"+g)==-1){f[x]+="_"+g;break}}}}var y=Wt(l["!ref"]),w=[],S=[],N=[];for(x=0;x<=y.e.c-y.s.c;++x){var E="",P="",T=0,O=[];for(g=0;g<h.length;++g)h[g][x]!=null&&O.push(h[g][x]);if(O.length==0||f[x]==null){w[x]="?";continue}for(g=0;g<O.length;++g){switch(typeof O[g]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=O[g]instanceof Date?"D":"C";break;default:P="C"}T=Math.max(T,String(O[g]).length),E=E&&E!=P?"C":P}T>250&&(T=250),P=((p[x]||{}).DBF||{}).type,P=="C"&&p[x].DBF.len>T&&(T=p[x].DBF.len),E=="B"&&P=="N"&&(E="N",N[x]=p[x].DBF.dec,T=p[x].DBF.len),S[x]=E=="C"||P=="N"?T:i[E]||0,j+=S[x],w[x]=E}var _=u.next(32);for(_.write_shift(4,318902576),_.write_shift(4,h.length),_.write_shift(2,296+32*b),_.write_shift(2,j),x=0;x<4;++x)_.write_shift(4,0);for(_.write_shift(4,0|(+t[GS]||3)<<8),x=0,g=0;x<f.length;++x)if(f[x]!=null){var C=u.next(32),R=(f[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,R,"sbcs"),C.write_shift(1,w[x]=="?"?"C":w[x],"sbcs"),C.write_shift(4,g),C.write_shift(1,S[x]||i[w[x]]||0),C.write_shift(1,N[x]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),g+=S[x]||i[w[x]]||0}var M=u.next(264);for(M.write_shift(4,13),x=0;x<65;++x)M.write_shift(4,0);for(x=0;x<h.length;++x){var U=u.next(j);for(U.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(w[g]){case"L":U.write_shift(1,h[x][g]==null?63:h[x][g]?84:70);break;case"B":U.write_shift(8,h[x][g]||0,"f");break;case"N":var Z="0";for(typeof h[x][g]=="number"&&(Z=h[x][g].toFixed(N[g]||0)),b=0;b<S[g]-Z.length;++b)U.write_shift(1,32);U.write_shift(1,Z,"sbcs");break;case"D":h[x][g]?(U.write_shift(4,("0000"+h[x][g].getFullYear()).slice(-4),"sbcs"),U.write_shift(2,("00"+(h[x][g].getMonth()+1)).slice(-2),"sbcs"),U.write_shift(2,("00"+h[x][g].getDate()).slice(-2),"sbcs")):U.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(h[x][g]!=null?h[x][g]:"").slice(0,S[g]);for(U.write_shift(1,ee,"sbcs"),b=0;b<S[g]-ee.length;++b)U.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}})(),aT=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Pr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var p=e[h];return typeof p=="number"?uy(p):p},a=function(f,h,p){var x=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?f:uy(x)};e["|"]=254;function n(f,h){switch(h.type){case"base64":return i(pa(f),h);case"binary":return i(f,h);case"buffer":return i(kt&&Buffer.isBuffer(f)?f.toString("binary"):hi(f),h);case"array":return i(Xi(f),h)}throw new Error("Unrecognized type "+h.type)}function i(f,h){var p=f.split(/[\n\r]+/),x=-1,g=-1,b=0,j=0,y=[],w=[],S=null,N={},E=[],P=[],T=[],O=0,_;for(+h.codepage>=0&&qa(+h.codepage);b!==p.length;++b){O=0;var C=p[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),R=C.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),M=R[0],U;if(C.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&w.push(C.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,ee=!1,re=!1,z=!1,me=-1,ne=-1;for(j=1;j<R.length;++j)switch(R[j].charAt(0)){case"A":break;case"X":g=parseInt(R[j].slice(1))-1,ee=!0;break;case"Y":for(x=parseInt(R[j].slice(1))-1,ee||(g=0),_=y.length;_<=x;++_)y[_]=[];break;case"K":U=R[j].slice(1),U.charAt(0)==='"'?U=U.slice(1,U.length-1):U==="TRUE"?U=!0:U==="FALSE"?U=!1:isNaN(Ya(U))?isNaN(zo(U).getDate())||(U=hr(U)):(U=Ya(U),S!==null&&al(S)&&(U=dm(U))),Z=!0;break;case"E":z=!0;var A=Io(R[j].slice(1),{r:x,c:g});y[x][g]=[y[x][g],A];break;case"S":re=!0,y[x][g]=[y[x][g],"S5S"];break;case"G":break;case"R":me=parseInt(R[j].slice(1))-1;break;case"C":ne=parseInt(R[j].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}if(Z&&(y[x][g]&&y[x][g].length==2?y[x][g][0]=U:y[x][g]=U,S=null),re){if(z)throw new Error("SYLK shared formula cannot have own formula");var D=me>-1&&y[me][ne];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");y[x][g][1]=wT(D[1],{r:x-me,c:g-ne})}break;case"F":var I=0;for(j=1;j<R.length;++j)switch(R[j].charAt(0)){case"X":g=parseInt(R[j].slice(1))-1,++I;break;case"Y":for(x=parseInt(R[j].slice(1))-1,_=y.length;_<=x;++_)y[_]=[];break;case"M":O=parseInt(R[j].slice(1))/20;break;case"F":break;case"G":break;case"P":S=w[parseInt(R[j].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=R[j].slice(1).split(" "),_=parseInt(T[0],10);_<=parseInt(T[1],10);++_)O=parseInt(T[2],10),P[_-1]=O===0?{hidden:!0}:{wch:O},oi(P[_-1]);break;case"C":g=parseInt(R[j].slice(1))-1,P[g]||(P[g]={});break;case"R":x=parseInt(R[j].slice(1))-1,E[x]||(E[x]={}),O>0?(E[x].hpt=O,E[x].hpx=Uo(O)):O===0&&(E[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}I<1&&(S=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}}return E.length>0&&(N["!rows"]=E),P.length>0&&(N["!cols"]=P),h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),[y,N]}function o(f,h){var p=n(f,h),x=p[0],g=p[1],b=il(x,h);return Pr(g).forEach(function(j){b[j]=g[j]}),b}function l(f,h){return pi(o(f,h),h)}function c(f,h,p,x){var g="C;Y"+(p+1)+";X"+(x+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+Tg(f.f,{r:p,c:x}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(f,h){h.forEach(function(p,x){var g="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=oc(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=lc(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function u(f,h){h.forEach(function(p,x){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*cc(p.hpx)+";"),g.length>2&&f.push(g+"R"+(x+1))})}function m(f,h){var p=["ID;PWXL;N;E"],x=[],g=Wt(f["!ref"]),b,j=Array.isArray(f),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&d(p,f["!cols"]),f["!rows"]&&u(p,f["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var w=g.s.r;w<=g.e.r;++w)for(var S=g.s.c;S<=g.e.c;++S){var N=mt({r:w,c:S});b=j?(f[w]||[])[S]:f[N],!(!b||b.v==null&&(!b.f||b.F))&&x.push(c(b,f,w,S))}return p.join(y)+y+x.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:m}})(),nT=(function(){function e(i,o){switch(o.type){case"base64":return t(pa(i),o);case"binary":return t(i,o);case"buffer":return t(kt&&Buffer.isBuffer(i)?i.toString("binary"):hi(i),o);case"array":return t(Xi(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,d=-1,u=0,m=[];u!==l.length;++u){if(l[u].trim()==="BOT"){m[++c]=[],d=0;continue}if(!(c<0)){var f=l[u].trim().split(","),h=f[0],p=f[1];++u;for(var x=l[u]||"";(x.match(/["]/g)||[]).length&1&&u<l.length-1;)x+=`
`+l[++u];switch(x=x.trim(),+h){case-1:if(x==="BOT"){m[++c]=[],d=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?m[c][d]=!0:x==="FALSE"?m[c][d]=!1:isNaN(Ya(p))?isNaN(zo(p).getDate())?m[c][d]=p:m[c][d]=hr(p):m[c][d]=Ya(p),++d;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),m[c][d++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(i,o){return il(e(i,o),o)}function a(i,o){return pi(r(i,o),o)}var n=(function(){var i=function(c,d,u,m,f){c.push(d),c.push(u+","+m),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,d,u,m){c.push(d+","+u),c.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var d=[],u=Wt(c["!ref"]),m,f=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(d,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var x=mt({r:h,c:p});if(m=f?(c[h]||[])[p]:c[x],!m){o(d,1,0,"");continue}switch(m.t){case"n":var g=m.w;!g&&m.v!=null&&(g=m.v),g==null?m.f&&!m.F?o(d,1,0,"="+m.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=La(m.z||ut[14],es(hr(m.v)))),o(d,0,m.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var b=`\r
`,j=d.join(b);return j}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),iT=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,f){for(var h=m.split(`
`),p=-1,x=-1,g=0,b=[];g!==h.length;++g){var j=h[g].trim().split(":");if(j[0]==="cell"){var y=Tr(j[1]);if(b.length<=y.r)for(p=b.length;p<=y.r;++p)b[p]||(b[p]=[]);switch(p=y.r,x=y.c,j[2]){case"t":b[p][x]=e(j[3]);break;case"v":b[p][x]=+j[3];break;case"vtf":var w=j[j.length-1];case"vtc":switch(j[3]){case"nl":b[p][x]=!!+j[4];break;default:b[p][x]=+j[4];break}j[2]=="vtf"&&(b[p][x]=[b[p][x],w])}}}return f&&f.sheetRows&&(b=b.slice(0,f.sheetRows)),b}function a(m,f){return il(r(m,f),f)}function n(m,f){return pi(a(m,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var f=[],h=[],p,x="",g=ra(m["!ref"]),b=Array.isArray(m),j=g.s.r;j<=g.e.r;++j)for(var y=g.s.c;y<=g.e.c;++y)if(x=mt({r:j,c:y}),p=b?(m[j]||[])[y]:m[x],!(!p||p.v==null||p.t==="z")){switch(h=["cell",x,"t"],p.t){case"s":case"str":h.push(t(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=t(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var w=es(hr(p.v));h[2]="vtc",h[3]="nd",h[4]=""+w,h[5]=p.w||La(p.z||ut[14],w);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(m){return[i,o,l,o,d(m),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:u}})(),$o=(function(){function e(u,m,f,h,p){p.raw?m[f][h]=u:u===""||(u==="TRUE"?m[f][h]=!0:u==="FALSE"?m[f][h]=!1:isNaN(Ya(u))?isNaN(zo(u).getDate())?m[f][h]=u:m[f][h]=hr(u):m[f][h]=Ya(u))}function t(u,m){var f=m||{},h=[];if(!u||u.length===0)return h;for(var p=u.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var g=10,b=0,j=0;j<=x;++j)b=p[j].indexOf(" "),b==-1?b=p[j].length:b++,g=Math.max(g,b);for(j=0;j<=x;++j){h[j]=[];var y=0;for(e(p[j].slice(0,g).trim(),h,j,y,f),y=1;y<=(p[j].length-g)/10+1;++y)e(p[j].slice(g+(y-1)*10,g+y*10).trim(),h,j,y,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(u){for(var m={},f=!1,h=0,p=0;h<u.length;++h)(p=u.charCodeAt(h))==34?f=!f:!f&&p in r&&(m[p]=(m[p]||0)+1);p=[];for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&p.push([m[h],h]);if(!p.length){m=a;for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&p.push([m[h],h])}return p.sort(function(x,g){return x[0]-g[0]||a[x[1]]-a[g[1]]}),r[p.pop()[1]]||44}function i(u,m){var f=m||{},h="",p=f.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=n(u.slice(0,1024)):f&&f.FS?h=f.FS:h=n(u.slice(0,1024));var g=0,b=0,j=0,y=0,w=0,S=h.charCodeAt(0),N=!1,E=0,P=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var T=f.dateNF!=null?p6(f.dateNF):null;function O(){var _=u.slice(y,w),C={};if(_.charAt(0)=='"'&&_.charAt(_.length-1)=='"'&&(_=_.slice(1,-1).replace(/""/g,'"')),_.length===0)C.t="z";else if(f.raw)C.t="s",C.v=_;else if(_.trim().length===0)C.t="s",C.v=_;else if(_.charCodeAt(0)==61)_.charCodeAt(1)==34&&_.charCodeAt(_.length-1)==34?(C.t="s",C.v=_.slice(2,-1).replace(/""/g,'"')):HB(_)?(C.t="n",C.f=_.slice(1)):(C.t="s",C.v=_);else if(_=="TRUE")C.t="b",C.v=!0;else if(_=="FALSE")C.t="b",C.v=!1;else if(!isNaN(j=Ya(_)))C.t="n",f.cellText!==!1&&(C.w=_),C.v=j;else if(!isNaN(zo(_).getDate())||T&&_.match(T)){C.z=f.dateNF||ut[14];var R=0;T&&_.match(T)&&(_=x6(_,f.dateNF,_.match(T)||[]),R=1),f.cellDates?(C.t="d",C.v=hr(_,R)):(C.t="n",C.v=es(hr(_,R))),f.cellText!==!1&&(C.w=La(C.z,C.v instanceof Date?es(C.v):C.v)),f.cellNF||delete C.z}else C.t="s",C.v=_;if(C.t=="z"||(f.dense?(p[g]||(p[g]=[]),p[g][b]=C):p[mt({c:b,r:g})]=C),y=w+1,P=u.charCodeAt(y),x.e.c<b&&(x.e.c=b),x.e.r<g&&(x.e.r=g),E==S)++b;else if(b=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;w<u.length;++w)switch(E=u.charCodeAt(w)){case 34:P===34&&(N=!N);break;case S:case 10:case 13:if(!N&&O())break e;break}return w-y>0&&O(),p["!ref"]=Tt(x),p}function o(u,m){return!(m&&m.PRN)||m.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,m):il(t(u,m),m)}function l(u,m){var f="",h=m.type=="string"?[0,0,0,0]:Pg(u,m);switch(m.type){case"base64":f=pa(u);break;case"binary":f=u;break;case"buffer":m.codepage==65001?f=u.toString("utf8"):m.codepage&&typeof Ql<"u"||(f=kt&&Buffer.isBuffer(u)?u.toString("binary"):hi(u));break;case"array":f=Xi(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+m.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=ir(f.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?f=ir(f):m.type=="binary"&&typeof Ql<"u",f.slice(0,19)=="socialcalc:version:"?iT.to_sheet(m.type=="string"?f:ir(f),m):o(f,m)}function c(u,m){return pi(l(u,m),m)}function d(u){for(var m=[],f=Wt(u["!ref"]),h,p=Array.isArray(u),x=f.s.r;x<=f.e.r;++x){for(var g=[],b=f.s.c;b<=f.e.c;++b){var j=mt({r:x,c:b});if(h=p?(u[x]||[])[b]:u[j],!h||h.v==null){g.push("          ");continue}for(var y=(h.w||(Dn(h),h.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(b===0?" ":""))}m.push(g.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})();function k8(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=aT.to_workbook(e,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return $o.to_workbook(e,t)}}var Bi=(function(){function e(A,D,I){if(A){vs(A,A.l||0);for(var V=I.Enum||me;A.l<A.length;){var ie=A.read_shift(2),se=V[ie]||V[65535],ae=A.read_shift(2),K=A.l+ae,G=se.f&&se.f(A,ae,I);if(A.l=K,D(G,se,ie))return}}}function t(A,D){switch(D.type){case"base64":return r(ca(pa(A)),D);case"binary":return r(ca(A),D);case"buffer":case"array":return r(A,D)}throw"Unsupported type "+D.type}function r(A,D){if(!A)return A;var I=D||{},V=I.dense?[]:{},ie="Sheet1",se="",ae=0,K={},G=[],ue=[],L={s:{r:0,c:0},e:{r:0,c:0}},Ne=I.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)I.Enum=me,e(A,function(Pe,rt,Ht){switch(Ht){case 0:I.vers=Pe,Pe>=4096&&(I.qpro=!0);break;case 6:L=Pe;break;case 204:Pe&&(se=Pe);break;case 222:se=Pe;break;case 15:case 51:I.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:Ht==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=I.dateNF||ut[14],I.cellDates&&(Pe[1].t="d",Pe[1].v=dm(Pe[1].v))),I.qpro&&Pe[3]>ae&&(V["!ref"]=Tt(L),K[ie]=V,G.push(ie),V=I.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},ae=Pe[3],ie=se||"Sheet"+(ae+1),se="");var gt=I.dense?(V[Pe[0].r]||[])[Pe[0].c]:V[mt(Pe[0])];if(gt){gt.t=Pe[1].t,gt.v=Pe[1].v,Pe[1].z!=null&&(gt.z=Pe[1].z),Pe[1].f!=null&&(gt.f=Pe[1].f);break}I.dense?(V[Pe[0].r]||(V[Pe[0].r]=[]),V[Pe[0].r][Pe[0].c]=Pe[1]):V[mt(Pe[0])]=Pe[1];break}},I);else if(A[2]==26||A[2]==14)I.Enum=ne,A[2]==14&&(I.qpro=!0,A.l=0),e(A,function(Pe,rt,Ht){switch(Ht){case 204:ie=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>ae&&(V["!ref"]=Tt(L),K[ie]=V,G.push(ie),V=I.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},ae=Pe[3],ie="Sheet"+(ae+1)),Ne>0&&Pe[0].r>=Ne)break;I.dense?(V[Pe[0].r]||(V[Pe[0].r]=[]),V[Pe[0].r][Pe[0].c]=Pe[1]):V[mt(Pe[0])]=Pe[1],L.e.c<Pe[0].c&&(L.e.c=Pe[0].c),L.e.r<Pe[0].r&&(L.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(ue[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:ue[Pe[0]]=Pe[1],Pe[0]==ae&&(ie=Pe[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(V["!ref"]=Tt(L),K[se||ie]=V,G.push(se||ie),!ue.length)return{SheetNames:G,Sheets:K};for(var Oe={},We=[],Qe=0;Qe<ue.length;++Qe)K[G[Qe]]?(We.push(ue[Qe]||G[Qe]),Oe[ue[Qe]]=K[ue[Qe]]||K[G[Qe]]):(We.push(ue[Qe]),Oe[ue[Qe]]={"!ref":"A1"});return{SheetNames:We,Sheets:Oe}}function a(A,D){var I=D||{};if(+I.codepage>=0&&qa(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var V=ta(),ie=Wt(A["!ref"]),se=Array.isArray(A),ae=[];ze(V,0,i(1030)),ze(V,6,c(ie));for(var K=Math.min(ie.e.r,8191),G=ie.s.r;G<=K;++G)for(var ue=Br(G),L=ie.s.c;L<=ie.e.c;++L){G===ie.s.r&&(ae[L]=Er(L));var Ne=ae[L]+ue,Oe=se?(A[G]||[])[L]:A[Ne];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")(Oe.v|0)==Oe.v&&Oe.v>=-32768&&Oe.v<=32767?ze(V,13,h(G,L,Oe.v)):ze(V,14,x(G,L,Oe.v));else{var We=Dn(Oe);ze(V,15,m(G,L,We.slice(0,239)))}}return ze(V,1),V.end()}function n(A,D){var I=D||{};if(+I.codepage>=0&&qa(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var V=ta();ze(V,0,o(A));for(var ie=0,se=0;ie<A.SheetNames.length;++ie)(A.Sheets[A.SheetNames[ie]]||{})["!ref"]&&ze(V,27,z(A.SheetNames[ie],se++));var ae=0;for(ie=0;ie<A.SheetNames.length;++ie){var K=A.Sheets[A.SheetNames[ie]];if(!(!K||!K["!ref"])){for(var G=Wt(K["!ref"]),ue=Array.isArray(K),L=[],Ne=Math.min(G.e.r,8191),Oe=G.s.r;Oe<=Ne;++Oe)for(var We=Br(Oe),Qe=G.s.c;Qe<=G.e.c;++Qe){Oe===G.s.r&&(L[Qe]=Er(Qe));var Pe=L[Qe]+We,rt=ue?(K[Oe]||[])[Qe]:K[Pe];if(!(!rt||rt.t=="z"))if(rt.t=="n")ze(V,23,O(Oe,Qe,ae,rt.v));else{var Ht=Dn(rt);ze(V,22,E(Oe,Qe,ae,Ht.slice(0,239)))}}++ae}}return ze(V,1),V.end()}function i(A){var D=Ae(2);return D.write_shift(2,A),D}function o(A){var D=Ae(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var I=0,V=0,ie=0,se=0;se<A.SheetNames.length;++se){var ae=A.SheetNames[se],K=A.Sheets[ae];if(!(!K||!K["!ref"])){++ie;var G=ra(K["!ref"]);I<G.e.r&&(I=G.e.r),V<G.e.c&&(V=G.e.c)}}return I>8191&&(I=8191),D.write_shift(2,I),D.write_shift(1,ie),D.write_shift(1,V),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function l(A,D,I){var V={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&I.qpro?(V.s.c=A.read_shift(1),A.l++,V.s.r=A.read_shift(2),V.e.c=A.read_shift(1),A.l++,V.e.r=A.read_shift(2),V):(V.s.c=A.read_shift(2),V.s.r=A.read_shift(2),D==12&&I.qpro&&(A.l+=2),V.e.c=A.read_shift(2),V.e.r=A.read_shift(2),D==12&&I.qpro&&(A.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function c(A){var D=Ae(8);return D.write_shift(2,A.s.c),D.write_shift(2,A.s.r),D.write_shift(2,A.e.c),D.write_shift(2,A.e.r),D}function d(A,D,I){var V=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(V[0].c=A.read_shift(1),V[3]=A.read_shift(1),V[0].r=A.read_shift(2),A.l+=2):(V[2]=A.read_shift(1),V[0].c=A.read_shift(2),V[0].r=A.read_shift(2)),V}function u(A,D,I){var V=A.l+D,ie=d(A,D,I);if(ie[1].t="s",I.vers==20768){A.l++;var se=A.read_shift(1);return ie[1].v=A.read_shift(se,"utf8"),ie}return I.qpro&&A.l++,ie[1].v=A.read_shift(V-A.l,"cstr"),ie}function m(A,D,I){var V=Ae(7+I.length);V.write_shift(1,255),V.write_shift(2,D),V.write_shift(2,A),V.write_shift(1,39);for(var ie=0;ie<V.length;++ie){var se=I.charCodeAt(ie);V.write_shift(1,se>=128?95:se)}return V.write_shift(1,0),V}function f(A,D,I){var V=d(A,D,I);return V[1].v=A.read_shift(2,"i"),V}function h(A,D,I){var V=Ae(7);return V.write_shift(1,255),V.write_shift(2,D),V.write_shift(2,A),V.write_shift(2,I,"i"),V}function p(A,D,I){var V=d(A,D,I);return V[1].v=A.read_shift(8,"f"),V}function x(A,D,I){var V=Ae(13);return V.write_shift(1,255),V.write_shift(2,D),V.write_shift(2,A),V.write_shift(8,I,"f"),V}function g(A,D,I){var V=A.l+D,ie=d(A,D,I);if(ie[1].v=A.read_shift(8,"f"),I.qpro)A.l=V;else{var se=A.read_shift(2);w(A.slice(A.l,A.l+se),ie),A.l+=se}return ie}function b(A,D,I){var V=D&32768;return D&=-32769,D=(V?A:0)+(D>=8192?D-16384:D),(V?"":"$")+(I?Er(D):Br(D))}var j={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(A,D){vs(A,0);for(var I=[],V=0,ie="",se="",ae="",K="";A.l<A.length;){var G=A[A.l++];switch(G){case 0:I.push(A.read_shift(8,"f"));break;case 1:se=b(D[0].c,A.read_shift(2),!0),ie=b(D[0].r,A.read_shift(2),!1),I.push(se+ie);break;case 2:{var ue=b(D[0].c,A.read_shift(2),!0),L=b(D[0].r,A.read_shift(2),!1);se=b(D[0].c,A.read_shift(2),!0),ie=b(D[0].r,A.read_shift(2),!1),I.push(ue+L+":"+se+ie)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(A.read_shift(2));break;case 6:{for(var Ne="";G=A[A.l++];)Ne+=String.fromCharCode(G);I.push('"'+Ne.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:K=I.pop(),ae=I.pop(),I.push(["AND","OR"][G-20]+"("+ae+","+K+")");break;default:if(G<32&&y[G])K=I.pop(),ae=I.pop(),I.push(ae+y[G]+K);else if(j[G]){if(V=j[G][1],V==69&&(V=A[A.l++]),V>I.length){console.error("WK1 bad formula parse 0x"+G.toString(16)+":|"+I.join("|")+"|");return}var Oe=I.slice(-V);I.length-=V,I.push(j[G][0]+"("+Oe.join(",")+")")}else return G<=7?console.error("WK1 invalid opcode "+G.toString(16)):G<=24?console.error("WK1 unsupported op "+G.toString(16)):G<=30?console.error("WK1 invalid opcode "+G.toString(16)):G<=115?console.error("WK1 unsupported function opcode "+G.toString(16)):console.error("WK1 unrecognized opcode "+G.toString(16))}}I.length==1?D[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function S(A){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=A.read_shift(2),D[3]=A[A.l++],D[0].c=A[A.l++],D}function N(A,D){var I=S(A);return I[1].t="s",I[1].v=A.read_shift(D-4,"cstr"),I}function E(A,D,I,V){var ie=Ae(6+V.length);ie.write_shift(2,A),ie.write_shift(1,I),ie.write_shift(1,D),ie.write_shift(1,39);for(var se=0;se<V.length;++se){var ae=V.charCodeAt(se);ie.write_shift(1,ae>=128?95:ae)}return ie.write_shift(1,0),ie}function P(A,D){var I=S(A);I[1].v=A.read_shift(2);var V=I[1].v>>1;if(I[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return I[1].v=V,I}function T(A,D){var I=S(A),V=A.read_shift(4),ie=A.read_shift(4),se=A.read_shift(2);if(se==65535)return V===0&&ie===3221225472?(I[1].t="e",I[1].v=15):V===0&&ie===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ae=se&32768;return se=(se&32767)-16446,I[1].v=(1-ae*2)*(ie*Math.pow(2,se+32)+V*Math.pow(2,se)),I}function O(A,D,I,V){var ie=Ae(14);if(ie.write_shift(2,A),ie.write_shift(1,I),ie.write_shift(1,D),V==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var se=0,ae=0,K=0,G=0;return V<0&&(se=1,V=-V),ae=Math.log2(V)|0,V/=Math.pow(2,ae-31),G=V>>>0,(G&2147483648)==0&&(V/=2,++ae,G=V>>>0),V-=G,G|=2147483648,G>>>=0,V*=Math.pow(2,32),K=V>>>0,ie.write_shift(4,K),ie.write_shift(4,G),ae+=16383+(se?32768:0),ie.write_shift(2,ae),ie}function _(A,D){var I=T(A);return A.l+=D-14,I}function C(A,D){var I=S(A),V=A.read_shift(4);return I[1].v=V>>6,I}function R(A,D){var I=S(A),V=A.read_shift(8,"f");return I[1].v=V,I}function M(A,D){var I=R(A);return A.l+=D-10,I}function U(A,D){return A[A.l+D-1]==0?A.read_shift(D,"cstr"):""}function Z(A,D){var I=A[A.l++];I>D-1&&(I=D-1);for(var V="";V.length<I;)V+=String.fromCharCode(A[A.l++]);return V}function ee(A,D,I){if(!(!I.qpro||D<21)){var V=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var ie=A.read_shift(D-21,"cstr");return[V,ie]}}function re(A,D){for(var I={},V=A.l+D;A.l<V;){var ie=A.read_shift(2);if(ie==14e3){for(I[ie]=[0,""],I[ie][0]=A.read_shift(2);A[A.l];)I[ie][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return I}function z(A,D){var I=Ae(5+A.length);I.write_shift(2,14e3),I.write_shift(2,D);for(var V=0;V<A.length;++V){var ie=A.charCodeAt(V);I[I.l++]=ie>127?95:ie}return I[I.l++]=0,I}var me={0:{n:"BOF",f:Vr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:U},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:_},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:U},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}})();function D8(e){var t={},r=e.match(Ms),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=pt(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Jx[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var I8=(function(){var e=rc("t"),t=rc("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Ut(o[1])},c=i.match(t);return c&&(l.s=D8(c[1])),l}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(l){return l.v})}})(),O8=(function(){var t=/(\r\n|\n)/g;function r(n,i,o){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),n.b&&(i.push("<b>"),o.push("</b>")),n.i&&(i.push("<i>"),o.push("</i>")),n.strike&&(i.push("<s>"),o.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),P8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,R8=/<(?:\w+:)?r>/,F8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function jg(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ut(ir(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ir(e),r&&(a.h=og(a.t))):e.match(R8)&&(a.r=ir(e),a.t=Ut(ir((e.replace(F8,"").match(P8)||[]).join("").replace(Ms,""))),r&&(a.h=O8(I8(a.r)))),a):{t:""}}var L8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,M8=/<(?:\w+:)?(?:si|sstItem)>/g,B8=/<\/(?:\w+:)?(?:si|sstItem)>/;function z8(e,t){var r=[],a="";if(!e)return r;var n=e.match(L8);if(n){a=n[2].replace(M8,"").split(B8);for(var i=0;i!=a.length;++i){var o=jg(a[i].trim(),t);o!=null&&(r[r.length]=o)}n=pt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var $8=/^\s|\s$|[\t\n\r]/;function oT(e,t){if(!t.bookSST)return"";var r=[$r];r[r.length]=Be("sst",null,{xmlns:lo[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match($8)&&(i+=' xml:space="preserve"'),i+=">"+sr(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function U8(e){return[e.read_shift(4),e.read_shift(4)]}function W8(e,t){var r=[],a=!1;return Mn(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function H8(e,t){return t||(t=Ae(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var V8=tF;function G8(e){var t=ta();Re(t,159,H8(e));for(var r=0;r<e.length;++r)Re(t,19,V8(e[r]));return Re(t,160),t.end()}function lT(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Tn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function q8(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Tn(e,4),t.U=Tn(e,4),t.W=Tn(e,4),t}function K8(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function Y8(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(K8(e));return t}function X8(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function J8(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Tn(e,4),t.U=Tn(e,4),t.W=Tn(e,4),t}function Z8(e){var t=J8(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function cT(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function dT(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Q8(e){var t=Tn(e);switch(t.Minor){case 2:return[t.Minor,eM(e)];case 3:return[t.Minor,tM()];case 4:return[t.Minor,rM(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function eM(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=cT(e,r),n=dT(e,e.length-e.l);return{t:"Std",h:a,v:n}}function tM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function rM(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Ms,function(i){var o=pt(i);switch(pn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){a[l]=o[l]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function sM(e,t){var r={},a=r.EncryptionVersionInfo=Tn(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=cT(e,n),t-=n,r.EncryptionVerifier=dT(e,t),r}function aM(e){var t={},r=t.EncryptionVersionInfo=Tn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function wg(e){var t=0,r,a=lT(e),n=a.length+1,i,o,l,c,d;for(r=ii(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)o=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var uT=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,l){return a(o^l)},i=function(o){for(var l=t[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],m=0;m!=7;++m)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=lT(o),c=i(l),d=l.length,u=ii(16),m=0;m!=16;++m)u[m]=0;var f,h,p;for((d&1)===1&&(f=c>>8,u[d]=n(e[0],f),--d,f=c&255,h=l[l.length-1],u[d]=n(h,f));d>0;)--d,f=c>>8,u[d]=n(l[d],f),--d,f=c&255,u[d]=n(l[d],f);for(d=15,p=15-l.length;p>0;)f=c>>8,u[d]=n(e[p],f),--d,--p,f=c&255,u[d]=n(l[d],f),--d,--p;return u}})(),nM=function(e,t,r,a,n){n||(n=t),a||(a=uT(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=a[r],o=(o>>5|o<<3)&255,n[i]=o,++r;return[n,r,a]},iM=function(e){var t=0,r=uT(e);return function(a){var n=nM("",a,t,r);return t=n[1],n[0]}};function oM(e,t,r,a){var n={key:Vr(e),verificationBytes:Vr(e)};return r.password&&(n.verifier=wg(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=iM(r.password)),n}function lM(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=aM(e):a.Data=sM(e,t),a}function cM(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?lM(e,t-2,a):oM(e,r.biff>=8?t:t-2,r,a),a}var mT=(function(){function e(n,i){switch(i.type){case"base64":return t(pa(n),i);case"binary":return t(n,i);case"buffer":return t(kt&&Buffer.isBuffer(n)?n.toString("binary"):hi(n),i);case"array":return t(Xi(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,m){Array.isArray(l)&&(l[m]=[]);for(var f=/\\\w+\b/g,h=0,p,x=-1;p=f.exec(u);){switch(p[0]){case"\\cell":var g=u.slice(h,f.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var b={v:g,t:"s"};Array.isArray(l)?l[m][x]=b:l[mt({r:m,c:x})]=b}break}h=f.lastIndex}x>d.e.c&&(d.e.c=x)}),l["!ref"]=Tt(d),l}function r(n,i){return pi(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],o=Wt(n["!ref"]),l,c=Array.isArray(n),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var m=mt({r:d,c:u});l=c?(n[d]||[])[u]:n[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Dn(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function dM(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ic(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function uM(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),i=Math.min(t,r,a),o=n-i;if(o===0)return[0,0,t];var l=0,c=0,d=n+i;switch(c=o/(d>1?2-d:d),n){case t:l=((r-a)/o+6)%6;break;case r:l=(a-t)/o+2;break;case a:l=(t-r)/o+4;break}return[l/6,c,d/2]}function mM(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),i=a-n/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,o[0]+=n,o[1]+=c;break;case 1:c=n*(2-l),o[0]+=c,o[1]+=n;break;case 2:c=n*(l-2),o[1]+=n,o[2]+=c;break;case 3:c=n*(4-l),o[1]+=c,o[2]+=n;break;case 4:c=n*(l-4),o[2]+=n,o[0]+=c;break;case 5:c=n*(6-l),o[2]+=c,o[0]+=n;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function cu(e,t){if(t===0)return e;var r=uM(dM(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ic(mM(r))}var fT=6,fM=15,hM=1,Ds=fT;function oc(e){return Math.floor((e+Math.round(128/Ds)/256)*Ds)}function lc(e){return Math.floor((e-5)/Ds*100+.5)/100}function du(e){return Math.round((e*Ds+5)/Ds*256)/256}function nf(e){return du(lc(oc(e)))}function Ng(e){var t=Math.abs(e-nf(e)),r=Ds;if(t>.005)for(Ds=hM;Ds<fM;++Ds)Math.abs(e-nf(e))<=t&&(t=Math.abs(e-nf(e)),r=Ds);Ds=r}function oi(e){e.width?(e.wpx=oc(e.width),e.wch=lc(e.wpx),e.MDW=Ds):e.wpx?(e.wch=lc(e.wpx),e.width=du(e.wch),e.MDW=Ds):typeof e.wch=="number"&&(e.width=du(e.wch),e.wpx=oc(e.width),e.MDW=Ds),e.customWidth&&delete e.customWidth}var pM=96,hT=pM;function cc(e){return e*96/hT}function Uo(e){return e*hT/96}var xM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function gM(e,t,r,a){t.Borders=[];var n={},i=!1;(e[0].match(Ms)||[]).forEach(function(o){var l=pt(o);switch(pn(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=fr(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=fr(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function vM(e,t,r,a){t.Fills=[];var n={},i=!1;(e[0].match(Ms)||[]).forEach(function(o){var l=pt(o);switch(pn(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function yM(e,t,r,a){t.Fonts=[];var n={},i=!1;(e[0].match(Ms)||[]).forEach(function(o){var l=pt(o);switch(pn(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=ir(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?fr(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?fr(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?fr(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?fr(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?fr(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?fr(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?fr(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Jx[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=fr(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=Li[n.color.index];n.color.index==81&&(c=Li[1]),c||(c=Li[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=cu(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function bM(e,t,r){t.NumberFmt=[];for(var a=Pr(ut),n=0;n<a.length;++n)t.NumberFmt[a[n]]=ut[a[n]];var i=e[0].match(Ms);if(i)for(n=0;n<i.length;++n){var o=pt(i[n]);switch(pn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Ut(ir(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}En(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function jM(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:a,formatCode:sr(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var xd=["numFmtId","fillId","fontId","borderId","xfId"],gd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function wM(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(Ms)||[]).forEach(function(i){var o=pt(i),l=0;switch(pn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],l=0;l<xd.length;++l)a[xd[l]]&&(a[xd[l]]=parseInt(a[xd[l]],10));for(l=0;l<gd.length;++l)a[gd[l]]&&(a[gd[l]]=fr(a[gd[l]]));if(t.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[l]){a.numFmtId=l;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=fr(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function NM(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var SM=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&bM(m,u,d),(m=l.match(n))&&yM(m,u,c,d),(m=l.match(a))&&vM(m,u,c,d),(m=l.match(i))&&gM(m,u,c,d),(m=l.match(r))&&wM(m,u,d),u}})();function pT(e,t){var r=[$r,Be("styleSheet",null,{xmlns:lo[0],"xmlns:vt":Zr.vt})],a;return e.SSF&&(a=jM(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=NM(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function EM(e,t){var r=e.read_shift(2),a=Rs(e);return[r,a]}function TM(e,t,r){r||(r=Ae(6+4*t.length)),r.write_shift(2,e),cs(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function CM(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=lF(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=oF(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Rs(e),a}function AM(e,t){t||(t=Ae(153)),t.write_shift(2,e.sz*20),cF(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),iu(e.color,t);var a=0;return a=2,t.write_shift(1,a),cs(e.name,t),t.length>t.l?t.slice(0,t.l):t}var _M=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],of,kM=Ls;function tb(e,t){t||(t=Ae(84)),of||(of=lm(_M));var r=of[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(iu({auto:1},t),iu({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function DM(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function xT(e,t,r){r||(r=Ae(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function wl(e,t){return t||(t=Ae(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var IM=Ls;function OM(e,t){return t||(t=Ae(51)),t.write_shift(1,0),wl(null,t),wl(null,t),wl(null,t),wl(null,t),wl(null,t),t.length>t.l?t.slice(0,t.l):t}function PM(e,t){return t||(t=Ae(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),nu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function RM(e,t,r){var a=Ae(2052);return a.write_shift(4,e),nu(t,a),nu(r,a),a.length>a.l?a.slice(0,a.l):a}function FM(e,t,r){var a={};a.NumberFmt=[];for(var n in ut)a.NumberFmt[n]=ut[n];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return Mn(e,function(c,d,u){switch(u){case 44:a.NumberFmt[c[0]]=c[1],En(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=cu(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function LM(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(Re(e,615,Xa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Re(e,44,TM(n,t[n]))}),Re(e,616))}}function MM(e){var t=1;Re(e,611,Xa(t)),Re(e,43,AM({sz:12,color:{theme:1},name:"Calibri",family:2})),Re(e,612)}function BM(e){var t=2;Re(e,603,Xa(t)),Re(e,45,tb({patternType:"none"})),Re(e,45,tb({patternType:"gray125"})),Re(e,604)}function zM(e){var t=1;Re(e,613,Xa(t)),Re(e,46,OM()),Re(e,614)}function $M(e){var t=1;Re(e,626,Xa(t)),Re(e,47,xT({numFmtId:0},65535)),Re(e,627)}function UM(e,t){Re(e,617,Xa(t.length)),t.forEach(function(r){Re(e,47,xT(r,0))}),Re(e,618)}function WM(e){var t=1;Re(e,619,Xa(t)),Re(e,48,PM({xfId:0,name:"Normal"})),Re(e,620)}function HM(e){var t=0;Re(e,505,Xa(t)),Re(e,506)}function VM(e){var t=0;Re(e,508,RM(t,"TableStyleMedium9","PivotStyleMedium4")),Re(e,509)}function GM(e,t){var r=ta();return Re(r,278),LM(r,e.SSF),MM(r),BM(r),zM(r),$M(r),UM(r,t.cellXfs),WM(r),HM(r),VM(r),Re(r,279),r.end()}var qM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function KM(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Ms)||[]).forEach(function(n){var i=pt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[qM.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function YM(){}function XM(){}var JM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ZM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,QM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function eB(e,t,r){t.themeElements={};var a;[["clrScheme",JM,KM],["fontScheme",ZM,YM],["fmtScheme",QM,XM]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var tB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function gT(e,t){(!e||e.length===0)&&(e=Sg());var r,a={};if(!(r=e.match(tB)))throw new Error("themeElements not found in theme");return eB(r[0],a,t),a.raw=e,a}function Sg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[$r];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rB(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var o;try{o=cE(i,{type:"array"})}catch{return}var l=da(o,"theme/theme/theme1.xml",!0);if(l)return gT(l,r)}}function sB(e){return e.read_shift(4)}function aB(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=nB(e,4);break;case 2:t.xclrValue=XE(e);break;case 3:t.xclrValue=sB(e);break;case 4:e.l+=4;break}return e.l+=8,t}function nB(e,t){return Ls(e,t)}function iB(e,t){return Ls(e,t)}function oB(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=aB(e);break;case 6:a[1]=iB(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function lB(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(oB(e,r-e.l));return{ixfe:a,ext:i}}function cB(e,t){t.forEach(function(r){r[0]})}function dB(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Rs(e)}}function uB(e){var t=Ae(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),cs(e.name,t),t.slice(0,t.l)}function mB(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function fB(e){var t=Ae(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function hB(e,t){var r=Ae(8+2*t.length);return r.write_shift(4,e),cs(t,r),r.slice(0,r.l)}function pB(e){return e.l+=4,e.read_shift(4)!=0}function xB(e,t){var r=Ae(8);return r.write_shift(4,e),r.write_shift(4,1),r}function gB(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],o=!1,l=2;return Mn(e,function(c,d,u){switch(u){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(m){l==1?a.Cell.push({type:a.Types[m[0]-1].name,index:m[1]}):l==0&&a.Value.push({type:a.Types[m[0]-1].name,index:m[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function vB(){var e=ta();return Re(e,332),Re(e,334,Xa(1)),Re(e,335,uB({name:"XLDAPR",version:12e4,flags:3496657072})),Re(e,336),Re(e,339,hB(1,"XLDAPR")),Re(e,52),Re(e,35,Xa(514)),Re(e,4096,Xa(0)),Re(e,4097,Da(1)),Re(e,36),Re(e,53),Re(e,340),Re(e,337,xB(1)),Re(e,51,fB([[1,0]])),Re(e,338),Re(e,333),e.end()}function yB(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,o;return e.replace(Ms,function(l){var c=pt(l);switch(pn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==c.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function vT(){var e=[$r];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function bB(e){var t=[];if(!e)return t;var r=1;return(e.match(Ms)||[]).forEach(function(a){var n=pt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function jB(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=mt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function wB(e,t,r){var a=[];return Mn(e,function(i,o,l){switch(l){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function NB(e,t,r,a){if(!e)return e;var n=a||{},i=!1;Mn(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function SB(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Ao=1024;function yT(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Be("xml",null,{"xmlns:v":oa.v,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:mv":oa.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Ao<e*1e3;)Ao+=1e3;return t.forEach(function(i){var o=Tr(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",c,l),u={on:"t",obscured:"t"};++Ao,n=n.concat(["<v:shape"+sc({id:"_x0000_s"+Ao,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,u),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bs("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),bs("x:AutoFill","False"),bs("x:Row",String(o.r)),bs("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function rb(e,t,r,a){var n=Array.isArray(e),i;t.forEach(function(o){var l=Tr(o.ref);if(n?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},n?e[l.r][l.c]=i:e[o.ref]=i;var c=Wt(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Tt(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&a){for(m=0;m<a.length;++m)if(u.a==a[m].id){u.a=a[m].name||u.a;break}}i.c.push(u)})}function EB(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=pt(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Tr(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!m&&!!m[1]&&jg(m[1])||{r:"",t:"",h:""};d.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),d.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=f.h),a.push(d)}}}}),a}function bT(e){var t=[$r,Be("comments",null,{xmlns:lo[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=sr(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf(sr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(bs("t",sr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(bs("t",sr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function TB(e,t){var r=[],a=!1,n={},i=0;return e.replace(Ms,function(l,c){var d=pt(l);switch(pn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function CB(e,t,r){var a=[$r,Be("ThreadedComments",null,{xmlns:Zr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Be("threadedComment",bs("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function AB(e,t){var r=[],a=!1;return e.replace(Ms,function(i){var o=pt(i);switch(pn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function _B(e){var t=[$r,Be("personList",null,{xmlns:Zr.TCMNT,"xmlns:x":lo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function kB(e){var t={};t.iauthor=e.read_shift(4);var r=fo(e);return t.rfx=r.s,t.ref=mt(r.s),e.l+=16,t}function DB(e,t){return t==null&&(t=Ae(36)),t.write_shift(4,e[1].iauthor),ol(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var IB=Rs;function OB(e){return cs(e.slice(0,54))}function PB(e,t){var r=[],a=[],n={},i=!1;return Mn(e,function(l,c,d){switch(d){case 632:a.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function RB(e){var t=ta(),r=[];return Re(t,628),Re(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Re(t,632,OB(n.a)))})}),Re(t,631),Re(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:Tr(a[0]),e:Tr(a[0])};Re(t,635,DB([i,n])),n.t&&n.t.length>0&&Re(t,637,sF(n)),Re(t,636),delete n.iauthor})}),Re(t,634),Re(t,629),t.end()}var FB="application/vnd.ms-office.vbaProject";function LB(e){var t=lt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");lt.utils.cfb_add(t,n,e.FileIndex[a].content)}}),lt.write(t)}function MB(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&lt.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var jT=["xlsb","xlsm","xlam","biff8","xla"];function BB(){return{"!type":"dialog"}}function zB(){return{"!type":"dialog"}}function $B(){return{"!type":"macro"}}function UB(){return{"!type":"macro"}}var Io=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,n+(l?"":"$")+Er(u)+(c?"":"$")+Br(d)}return function(n,i){return t=i,n.replace(e,r)}})(),Eg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Tg=(function(){return function(t,r){return t.replace(Eg,function(a,n,i,o,l,c){var d=mg(o)-(i?0:r.c),u=ug(c)-(l?0:r.r),m=u==0?"":l?u+1:"["+u+"]",f=d==0?"":i?d+1:"["+d+"]";return n+"R"+m+"C"+f})}})();function wT(e,t){return e.replace(Eg,function(r,a,n,i,o,l){return a+(n=="$"?n+i:Er(mg(i)+t.c))+(o=="$"?o+l:Br(ug(l)+t.r))})}function WB(e,t,r){var a=ra(t),n=a.s,i=Tr(r),o={r:i.r-n.r,c:i.c-n.c};return wT(e,o)}function HB(e){return e.length!=1}function sb(e){return e.replace(/_xlfn\./g,"")}function Wr(e){e.l+=1}function li(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function NT(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return ST(e);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),o=li(e),l=li(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function ST(e){var t=li(e),r=li(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function VB(e,t,r){if(r.biff<8)return ST(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=li(e),o=li(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function ET(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return GB(e);var a=e.read_shift(r&&r.biff==12?4:2),n=li(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function GB(e){var t=li(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function qB(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function KB(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return YB(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function YB(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function XB(e,t,r){var a=(e[e.l++]&96)>>5,n=NT(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function JB(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=NT(e,i,r);return[a,n,o]}function ZB(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function QB(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function e7(e,t,r){var a=(e[e.l++]&96)>>5,n=VB(e,t-1,r);return[a,n]}function t7(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function ab(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function r7(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function s7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function a7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function n7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function i7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function TT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function o7(e){return e.read_shift(2),TT(e)}function l7(e){return e.read_shift(2),TT(e)}function c7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=ET(e,0,r);return[a,n]}function d7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=KB(e,0,r);return[a,n]}function u7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=ET(e,0,r);return[a,n,i]}function m7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[pz[n],_T[n],a]}function f7(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:h7(e);return[n,(i[0]===0?_T:hz)[i[1]]]}function h7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function p7(e,t,r){e.l+=r&&r.biff==2?3:4}function x7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function g7(e){return e.l++,Bn[e.read_shift(1)]}function v7(e){return e.l++,e.read_shift(2)}function y7(e){return e.l++,e.read_shift(1)!==0}function b7(e){return e.l++,Ps(e)}function j7(e,t,r){return e.l++,Oc(e,t-1,r)}function w7(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Fr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Bn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ps(e);break;case 2:r[1]=ho(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function N7(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?fo:um)(e));return n}function S7(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=w7(e,r.biff);return o}function E7(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function T7(e,t,r){if(r.biff==5)return C7(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function C7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function A7(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function _7(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function k7(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function D7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var I7=Ls,O7=Ls,P7=Ls;function Rc(e,t,r){return e.l+=2,[qB(e)]}function Cg(e){return e.l+=6,[]}var R7=Rc,F7=Cg,L7=Cg,M7=Rc;function CT(e){return e.l+=2,[Vr(e),e.read_shift(2)&1]}var B7=Rc,z7=CT,$7=Cg,U7=Rc,W7=Rc,H7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function V7(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=H7[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:i}}function G7(e){return e.l+=2,[e.read_shift(4)]}function q7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function K7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Y7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function X7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function J7(e){return e.l+=4,[0,0]}var nb={1:{n:"PtgExp",f:x7},2:{n:"PtgTbl",f:P7},3:{n:"PtgAdd",f:Wr},4:{n:"PtgSub",f:Wr},5:{n:"PtgMul",f:Wr},6:{n:"PtgDiv",f:Wr},7:{n:"PtgPower",f:Wr},8:{n:"PtgConcat",f:Wr},9:{n:"PtgLt",f:Wr},10:{n:"PtgLe",f:Wr},11:{n:"PtgEq",f:Wr},12:{n:"PtgGe",f:Wr},13:{n:"PtgGt",f:Wr},14:{n:"PtgNe",f:Wr},15:{n:"PtgIsect",f:Wr},16:{n:"PtgUnion",f:Wr},17:{n:"PtgRange",f:Wr},18:{n:"PtgUplus",f:Wr},19:{n:"PtgUminus",f:Wr},20:{n:"PtgPercent",f:Wr},21:{n:"PtgParen",f:Wr},22:{n:"PtgMissArg",f:Wr},23:{n:"PtgStr",f:j7},26:{n:"PtgSheet",f:q7},27:{n:"PtgEndSheet",f:K7},28:{n:"PtgErr",f:g7},29:{n:"PtgBool",f:y7},30:{n:"PtgInt",f:v7},31:{n:"PtgNum",f:b7},32:{n:"PtgArray",f:t7},33:{n:"PtgFunc",f:m7},34:{n:"PtgFuncVar",f:f7},35:{n:"PtgName",f:E7},36:{n:"PtgRef",f:c7},37:{n:"PtgArea",f:XB},38:{n:"PtgMemArea",f:A7},39:{n:"PtgMemErr",f:I7},40:{n:"PtgMemNoMem",f:O7},41:{n:"PtgMemFunc",f:_7},42:{n:"PtgRefErr",f:k7},43:{n:"PtgAreaErr",f:ZB},44:{n:"PtgRefN",f:d7},45:{n:"PtgAreaN",f:e7},46:{n:"PtgMemAreaN",f:Y7},47:{n:"PtgMemNoMemN",f:X7},57:{n:"PtgNameX",f:T7},58:{n:"PtgRef3d",f:u7},59:{n:"PtgArea3d",f:JB},60:{n:"PtgRefErr3d",f:D7},61:{n:"PtgAreaErr3d",f:QB},255:{}},Z7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Q7={1:{n:"PtgElfLel",f:CT},2:{n:"PtgElfRw",f:U7},3:{n:"PtgElfCol",f:R7},6:{n:"PtgElfRwV",f:W7},7:{n:"PtgElfColV",f:M7},10:{n:"PtgElfRadical",f:B7},11:{n:"PtgElfRadicalS",f:$7},13:{n:"PtgElfColS",f:F7},15:{n:"PtgElfColSV",f:L7},16:{n:"PtgElfRadicalLel",f:z7},25:{n:"PtgList",f:V7},29:{n:"PtgSxName",f:G7},255:{}},ez={0:{n:"PtgAttrNoop",f:J7},1:{n:"PtgAttrSemi",f:i7},2:{n:"PtgAttrIf",f:a7},4:{n:"PtgAttrChoose",f:r7},8:{n:"PtgAttrGoto",f:s7},16:{n:"PtgAttrSum",f:p7},32:{n:"PtgAttrBaxcel",f:ab},33:{n:"PtgAttrBaxcel",f:ab},64:{n:"PtgAttrSpace",f:o7},65:{n:"PtgAttrSpaceSemi",f:l7},128:{n:"PtgAttrIfError",f:n7},255:{}};function Fc(e,t,r,a){if(a.biff<8)return Ls(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=S7(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=N7(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(Ls(e,t)),i}function Lc(e,t,r){for(var a=e.l+t,n,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],n=nb[i]||nb[Z7[i]],(i===24||i===25)&&(n=(i===24?Q7:ez)[e[e.l+1]]),!n||!n.f?Ls(e,t):o.push([n.n,n.f(e,t,r)]);return o}function tz(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var rz={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sz(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function AT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function ib(e,t,r){var a=AT(e,t,r);return a=="#REF"?a:sz(a,r)}function _s(e,t,r,a,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,m=0,f=0,h,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,g="",b=0,j=e[0].length;b<j;++b){var y=e[0][b];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:g=Ir(" ",e[0][x][1][1]);break;case 1:g=Ir("\r",e[0][x][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}d=d+g,x=-1}l.push(d+rz[y[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=zl(y[1][1],o,n),l.push($l(u,i));break;case"PtgRefN":u=r?zl(y[1][1],r,n):y[1][1],l.push($l(u,i));break;case"PtgRef3d":m=y[1][1],u=zl(y[1][2],o,n),p=ib(a,m,n),l.push(p+"!"+$l(u,i));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],S=y[1][1];w||(w=0),w&=127;var N=w==0?[]:l.slice(-w);l.length-=w,S==="User"&&(S=N.shift()),l.push(S+"("+N.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":h=Ry(y[1][1],r?{s:r}:o,n),l.push(rf(h,n));break;case"PtgArea":h=Ry(y[1][1],o,n),l.push(rf(h,n));break;case"PtgArea3d":m=y[1][1],h=y[1][2],p=ib(a,m,n),l.push(p+"!"+rf(h,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var E=(a.names||[])[f-1]||(a[0]||[])[f],P=E?E.Name:"SH33TJSNAME"+String(f);P&&P.slice(0,6)=="_xlfn."&&!n.xlfn&&(P=P.slice(6)),l.push(P);break;case"PtgNameX":var T=y[1][1];f=y[1][2];var O;if(n.biff<=5)T<0&&(T=-T),a[T]&&(O=a[T][f]);else{var _="";if(((a[T]||[])[0]||[])[0]==14849||(((a[T]||[])[0]||[])[0]==1025?a[T][f]&&a[T][f].itab>0&&(_=a.SheetNames[a[T][f].itab-1]+"!"):_=a.SheetNames[f-1]+"!"),a[T]&&a[T][f])_+=a[T][f].Name;else if(a[0]&&a[0][f])_+=a[0][f].Name;else{var C=(AT(a,T,n)||"").split(";;");C[f-1]?_=C[f-1]:_+="SH33TJSERRX"}l.push(_);break}O||(O={Name:"SH33TJSERRY"}),l.push(O.Name);break;case"PtgParen":var R="(",M=")";if(x>=0){switch(g="",e[0][x][1][0]){case 2:R=Ir(" ",e[0][x][1][1])+R;break;case 3:R=Ir("\r",e[0][x][1][1])+R;break;case 4:M=Ir(" ",e[0][x][1][1])+M;break;case 5:M=Ir("\r",e[0][x][1][1])+M;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(R+l.pop()+M);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var U={c:r.c,r:r.r};if(a.sharedf[mt(u)]){var Z=a.sharedf[mt(u)];l.push(_s(Z,o,U,a,n))}else{var ee=!1;for(c=0;c!=a.arrayf.length;++c)if(d=a.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(_s(d[1],o,U,a,n)),ee=!0;break}ee||l.push(y[1])}break;case"PtgArray":l.push("{"+tz(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&re.indexOf(e[0][b][0])==-1){y=e[0][x];var z=!0;switch(y[1][0]){case 4:z=!1;case 0:g=Ir(" ",y[1][1]);break;case 5:z=!1;case 1:g=Ir("\r",y[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((z?g:"")+l.pop()+(z?"":g)),x=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function az(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],Ls(e,t-2)];var l=Lc(e,o,r);return t!==o+n&&(i=Fc(e,t-o-n,l,r)),e.l=a,[l,i]}function nz(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],Ls(e,t-2)];var l=Lc(e,o,r);return t!==o+n&&(i=Fc(e,t-o-n,l,r)),e.l=a,[l,i]}function iz(e,t,r,a){var n=e.l+t,i=Lc(e,a,r),o;return n!==e.l&&(o=Fc(e,n-e.l,i,r)),[i,o]}function oz(e,t,r){var a=e.l+t,n,i=e.read_shift(2),o=Lc(e,i,r);return i==65535?[[],Ls(e,t-2)]:(t!==i+2&&(n=Fc(e,a-i-2,o,r)),[o,n])}function lz(e){var t;if(jn(e,e.l+6)!==65535)return[Ps(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function cz(e){if(e==null){var t=Ae(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ji(e);return Ji(0)}function lf(e,t,r){var a=e.l+t,n=xn(e);r.biff==2&&++e.l;var i=lz(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=nz(e,a-e.l,r);return{cell:n,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function dz(e,t,r,a,n){var i=Qi(t,r,n),o=cz(e.v),l=Ae(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=Ae(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var m=ls([i,o,l,d]);return m}function mm(e,t,r){var a=e.read_shift(4),n=Lc(e,a,r),i=e.read_shift(4),o=i>0?Fc(e,i,n,r):null;return[n,o]}var uz=mm,fm=mm,mz=mm,fz=mm,hz={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_T={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},pz={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ob(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function xz(e){var t="of:="+e.replace(Eg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function cf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function gz(e){return e.replace(/\./,"!")}var Wl={},Oo={},Hl=typeof Map<"u";function Ag(e,t,r){var a=0,n=e.length;if(r){if(Hl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Hl?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(Hl?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function hm(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Ds=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=lc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=du(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function zi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function xi(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){En(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function kT(e,t,r,a,n,i){try{a.cellNF&&(e.z=ut[t])}catch(l){if(a.WTF)throw l}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=hr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ut[t]==null&&En(h6[t]||"General",t),e.t==="e")e.w=e.w||Bn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=tc(e.v);else if(e.t==="d"){var o=es(e.v);(o|0)===o?e.w=o.toString(10):e.w=tc(o)}else{if(e.v===void 0)return"";e.w=Yi(e.v,Oo)}else e.t==="d"?e.w=La(t,es(e.v),Oo):e.w=La(t,e.v,Oo)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=cu(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=cu(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&i.Fills)throw l}}}function vz(e,t,r){if(e&&e["!ref"]){var a=Wt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function yz(e,t){var r=Wt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Tt(r))}var bz=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jz=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,wz=/<(?:\w:)?hyperlink [^>]*>/mg,Nz=/"(\w*:\w*)"/,Sz=/<(?:\w:)?col\b[^>]*[\/]?>/g,Ez=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Tz=/<(?:\w:)?pageMargins[^>]*\/>/g,DT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Cz=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Az=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _z(e,t,r,a,n,i,o){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",m=e.match(jz);m?(d=e.slice(0,m.index),u=e.slice(m.index+m[0].length)):d=u=e;var f=d.match(DT);f?_g(f[0],l,n,r):(f=d.match(Cz))&&Dz(f[0],f[1]||"",l,n,r);var h=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=d.slice(h,h+50).match(Nz);p&&yz(l,p[1])}var x=d.match(Az);x&&x[1]&&Hz(x[1],n);var g=[];if(t.cellStyles){var b=d.match(Sz);b&&Bz(g,b)}m&&qz(m[1],l,t,c,i,o);var j=u.match(Ez);j&&(l["!autofilter"]=$z(j[0]));var y=[],w=u.match(bz);if(w)for(h=0;h!=w.length;++h)y[h]=Wt(w[h].slice(w[h].indexOf('"')+1));var S=u.match(wz);S&&Fz(l,S,a);var N=u.match(Tz);if(N&&(l["!margins"]=Lz(pt(N[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Tt(c)),t.sheetRows>0&&l["!ref"]){var E=Wt(l["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Tt(E))}return g.length>0&&(l["!cols"]=g),y.length>0&&(l["!merges"]=y),l}function kz(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Tt(e[r])+'"/>';return t+"</mergeCells>"}function _g(e,t,r,a){var n=pt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Ut(ir(n.codeName)))}function Dz(e,t,r,a,n){_g(e.slice(0,e.indexOf(">")),r,a,n)}function Iz(e,t,r,a,n){var i=!1,o={},l=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=ln(sr(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+Be("outlinePr",null,d)}!i&&!l||(n[n.length]=Be("sheetPr",l,o))}var Oz=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Pz=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Rz(e){var t={sheet:1};return Oz.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Pz.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=wg(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function Fz(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var i=pt(ir(t[n]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Ut(i.location))):(i.Target="#"+Ut(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=Wt(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=mt({c:d,r:c});a?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function Lz(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Mz(e){return zi(e),Be("pageMargins",null,e)}function Bz(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=pt(t[a],!0);n.hidden&&(n.hidden=fr(n.hidden));var i=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Ng(n.width)),oi(n);i<=o;)e[i++]=pr(n)}}function zz(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Be("col",null,hm(n,a)));return r[r.length]="</cols>",r.join("")}function $z(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Uz(e,t,r,a){var n=typeof e.ref=="string"?e.ref:Tt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=ra(n);o.s.r==o.e.r&&(o.e.r=ra(t["!ref"]).e.r,n=Tt(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Be("autoFilter",null,{ref:n})}var Wz=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Hz(e,t){t.Views||(t.Views=[{}]),(e.match(Wz)||[]).forEach(function(r,a){var n=pt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),fr(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function Vz(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,n),{})}function Gz(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Bn[e.v];break;case"d":a&&a.cellDates?n=hr(e.v,-1).toISOString():(e=pr(e),e.t="n",n=""+(e.v=es(hr(e.v)))),typeof e.z>"u"&&(e.z=ut[14]);break;default:n=e.v;break}var l=bs("v",sr(n)),c={r:t},d=xi(a.cellXfs,e,a);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=bs("v",""+Ag(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Be("f",sr(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Be("c",l,c)}var qz=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=rc("v"),o=rc("f");return function(c,d,u,m,f,h){for(var p=0,x="",g=[],b=[],j=0,y=0,w=0,S="",N,E,P=0,T=0,O,_,C=0,R=0,M=Array.isArray(h.CellXf),U,Z=[],ee=[],re=Array.isArray(d),z=[],me={},ne=!1,A=!!u.sheetStubs,D=c.split(t),I=0,V=D.length;I!=V;++I){x=D[I].trim();var ie=x.length;if(ie!==0){var se=0;e:for(p=0;p<ie;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(E=pt(x.slice(se,p),!0),P=E.r!=null?parseInt(E.r,10):P+1,T=-1,u.sheetRows&&u.sheetRows<P)continue;me={},ne=!1,E.ht&&(ne=!0,me.hpt=parseFloat(E.ht),me.hpx=Uo(me.hpt)),E.hidden=="1"&&(ne=!0,me.hidden=!0),E.outlineLevel!=null&&(ne=!0,me.level=+E.outlineLevel),ne&&(z[P-1]=me)}break;case"<":se=p;break}if(se>=p)break;if(E=pt(x.slice(se,p),!0),P=E.r!=null?parseInt(E.r,10):P+1,T=-1,!(u.sheetRows&&u.sheetRows<P)){m.s.r>P-1&&(m.s.r=P-1),m.e.r<P-1&&(m.e.r=P-1),u&&u.cellStyles&&(me={},ne=!1,E.ht&&(ne=!0,me.hpt=parseFloat(E.ht),me.hpx=Uo(me.hpt)),E.hidden=="1"&&(ne=!0,me.hidden=!0),E.outlineLevel!=null&&(ne=!0,me.level=+E.outlineLevel),ne&&(z[P-1]=me)),g=x.slice(p).split(e);for(var ae=0;ae!=g.length&&g[ae].trim().charAt(0)=="<";++ae);for(g=g.slice(ae),p=0;p!=g.length;++p)if(x=g[p].trim(),x.length!==0){if(b=x.match(r),j=p,y=0,w=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,b!=null&&b.length===2){for(j=0,S=b[1],y=0;y!=S.length&&!((w=S.charCodeAt(y)-64)<1||w>26);++y)j=26*j+w;--j,T=j}else++T;for(y=0;y!=x.length&&x.charCodeAt(y)!==62;++y);if(++y,E=pt(x.slice(0,y),!0),E.r||(E.r=mt({r:P-1,c:T})),S=x.slice(y),N={t:""},(b=S.match(i))!=null&&b[1]!==""&&(N.v=Ut(b[1])),u.cellFormula){if((b=S.match(o))!=null&&b[1]!==""){if(N.f=Ut(ir(b[1])).replace(/\r\n/g,`
`),u.xlfn||(N.f=sb(N.f)),b[0].indexOf('t="array"')>-1)N.F=(S.match(n)||[])[1],N.F.indexOf(":")>-1&&Z.push([Wt(N.F),N.F]);else if(b[0].indexOf('t="shared"')>-1){_=pt(b[0]);var K=Ut(ir(b[1]));u.xlfn||(K=sb(K)),ee[parseInt(_.si,10)]=[_,K,E.r]}}else(b=S.match(/<f[^>]*\/>/))&&(_=pt(b[0]),ee[_.si]&&(N.f=WB(ee[_.si][1],ee[_.si][2],E.r)));var G=Tr(E.r);for(y=0;y<Z.length;++y)G.r>=Z[y][0].s.r&&G.r<=Z[y][0].e.r&&G.c>=Z[y][0].s.c&&G.c<=Z[y][0].e.c&&(N.F=Z[y][1])}if(E.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(A)N.t="z";else continue;else N.t=E.t||"n";switch(m.s.c>T&&(m.s.c=T),m.e.c<T&&(m.e.c=T),N.t){case"n":if(N.v==""||N.v==null){if(!A)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!A)continue;N.t="z"}else O=Wl[parseInt(N.v,10)],N.v=O.t,N.r=O.r,u.cellHTML&&(N.h=O.h);break;case"str":N.t="s",N.v=N.v!=null?ir(N.v):"",u.cellHTML&&(N.h=og(N.v));break;case"inlineStr":b=S.match(a),N.t="s",b!=null&&(O=jg(b[1]))?(N.v=O.t,u.cellHTML&&(N.h=O.h)):N.v="";break;case"b":N.v=fr(N.v);break;case"d":u.cellDates?N.v=hr(N.v,1):(N.v=es(hr(N.v,1)),N.t="n");break;case"e":(!u||u.cellText!==!1)&&(N.w=N.v),N.v=OE[N.v];break}if(C=R=0,U=null,M&&E.s!==void 0&&(U=h.CellXf[E.s],U!=null&&(U.numFmtId!=null&&(C=U.numFmtId),u.cellStyles&&U.fillId!=null&&(R=U.fillId))),kT(N,C,R,u,f,h),u.cellDates&&M&&N.t=="n"&&al(ut[C])&&(N.t="d",N.v=dm(N.v)),E.cm&&u.xlmeta){var ue=(u.xlmeta.Cell||[])[+E.cm-1];ue&&ue.type=="XLDAPR"&&(N.D=!0)}if(re){var L=Tr(E.r);d[L.r]||(d[L.r]=[]),d[L.r][L.c]=N}else d[E.r]=N}}}}z.length>0&&(d["!rows"]=z)}})();function Kz(e,t,r,a){var n=[],i=[],o=Wt(e["!ref"]),l="",c,d="",u=[],m=0,f=0,h=e["!rows"],p=Array.isArray(e),x={r:d},g,b=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=Er(f);for(m=o.s.r;m<=o.e.r;++m){for(i=[],d=Br(m),f=o.s.c;f<=o.e.c;++f){c=u[f]+d;var j=p?(e[m]||[])[f]:e[c];j!==void 0&&(l=Gz(j,c,e,t))!=null&&i.push(l)}(i.length>0||h&&h[m])&&(x={r:d},h&&h[m]&&(g=h[m],g.hidden&&(x.hidden=1),b=-1,g.hpx?b=cc(g.hpx):g.hpt&&(b=g.hpt),b>-1&&(x.ht=b,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),n[n.length]=Be("row",i.join(""),x))}if(h)for(;m<h.length;++m)h&&h[m]&&(x={r:m+1},g=h[m],g.hidden&&(x.hidden=1),b=-1,g.hpx?b=cc(g.hpx):g.hpt&&(b=g.hpt),b>-1&&(x.ht=b,x.customHeight=1),g.level&&(x.outlineLevel=g.level),n[n.length]=Be("row","",x));return n.join("")}function IT(e,t,r,a){var n=[$r,Be("worksheet",null,{xmlns:lo[0],"xmlns:r":Zr.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=Wt(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=Tt(u)}a||(a={}),c["!comments"]=[];var m=[];Iz(c,r,e,t,n),n[n.length]=Be("dimension",null,{ref:d}),n[n.length]=Vz(c,t,e,r),t.sheetFormat&&(n[n.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=zz(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Kz(c,t),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=Rz(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Uz(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=kz(c["!merges"]));var f=-1,h,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(h={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=Qt(a,-1,sr(x[1].Target).replace(/#.*$/,""),It.HLINK),h["r:id"]="rId"+p),(f=x[1].Target.indexOf("#"))>-1&&(h.location=sr(x[1].Target.slice(f+1))),x[1].Tooltip&&(h.tooltip=sr(x[1].Tooltip)),n[n.length]=Be("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=Mz(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=bs("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(p=Qt(a,-1,"../drawings/drawing"+(e+1)+".xml",It.DRAW),n[n.length]=Be("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=m),c["!comments"].length>0&&(p=Qt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",It.VML),n[n.length]=Be("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Yz(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function Xz(e,t,r){var a=Ae(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=cc(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var l=0,c=a.l;a.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var m=-1,f=-1,h=u<<10;h<u+1<<10;++h){d.c=h;var p=Array.isArray(r)?(r[d.r]||[])[d.c]:r[mt(d)];p&&(m<0&&(m=h),f=h)}m<0||(++l,a.write_shift(4,m),a.write_shift(4,f))}var x=a.l;return a.l=c,a.write_shift(4,l),a.l=x,a.length>a.l?a.slice(0,a.l):a}function Jz(e,t,r,a){var n=Xz(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&Re(e,0,n)}var Zz=fo,Qz=ol;function e$(){}function t$(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=aF(e),r}function r$(e,t,r){r==null&&(r=Ae(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return iu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),AE(e,r),r.slice(0,r.l)}function s$(e){var t=za(e);return[t]}function a$(e,t,r){return r==null&&(r=Ae(8)),co(t,r)}function n$(e){var t=uo(e);return[t]}function i$(e,t,r){return r==null&&(r=Ae(4)),mo(t,r)}function o$(e){var t=za(e),r=e.read_shift(1);return[t,r,"b"]}function l$(e,t,r){return r==null&&(r=Ae(9)),co(t,r),r.write_shift(1,e.v?1:0),r}function c$(e){var t=uo(e),r=e.read_shift(1);return[t,r,"b"]}function d$(e,t,r){return r==null&&(r=Ae(5)),mo(t,r),r.write_shift(1,e.v?1:0),r}function u$(e){var t=za(e),r=e.read_shift(1);return[t,r,"e"]}function m$(e,t,r){return r==null&&(r=Ae(9)),co(t,r),r.write_shift(1,e.v),r}function f$(e){var t=uo(e),r=e.read_shift(1);return[t,r,"e"]}function h$(e,t,r){return r==null&&(r=Ae(8)),mo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function p$(e){var t=za(e),r=e.read_shift(4);return[t,r,"s"]}function x$(e,t,r){return r==null&&(r=Ae(12)),co(t,r),r.write_shift(4,t.v),r}function g$(e){var t=uo(e),r=e.read_shift(4);return[t,r,"s"]}function v$(e,t,r){return r==null&&(r=Ae(8)),mo(t,r),r.write_shift(4,t.v),r}function y$(e){var t=za(e),r=Ps(e);return[t,r,"n"]}function b$(e,t,r){return r==null&&(r=Ae(16)),co(t,r),Ji(e.v,r),r}function OT(e){var t=uo(e),r=Ps(e);return[t,r,"n"]}function j$(e,t,r){return r==null&&(r=Ae(12)),mo(t,r),Ji(e.v,r),r}function w$(e){var t=za(e),r=xg(e);return[t,r,"n"]}function N$(e,t,r){return r==null&&(r=Ae(12)),co(t,r),_E(e.v,r),r}function S$(e){var t=uo(e),r=xg(e);return[t,r,"n"]}function E$(e,t,r){return r==null&&(r=Ae(8)),mo(t,r),_E(e.v,r),r}function T$(e){var t=za(e),r=fg(e);return[t,r,"is"]}function C$(e){var t=za(e),r=Rs(e);return[t,r,"str"]}function A$(e,t,r){return r==null&&(r=Ae(12+4*e.v.length)),co(t,r),cs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function _$(e){var t=uo(e),r=Rs(e);return[t,r,"str"]}function k$(e,t,r){return r==null&&(r=Ae(8+4*e.v.length)),mo(t,r),cs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function D$(e,t,r){var a=e.l+t,n=za(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var l=fm(e,a-e.l,r);o[3]=_s(l,null,n,r.supbooks,r)}else e.l=a;return o}function I$(e,t,r){var a=e.l+t,n=za(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var l=fm(e,a-e.l,r);o[3]=_s(l,null,n,r.supbooks,r)}else e.l=a;return o}function O$(e,t,r){var a=e.l+t,n=za(e);n.r=r["!row"];var i=Ps(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var l=fm(e,a-e.l,r);o[3]=_s(l,null,n,r.supbooks,r)}else e.l=a;return o}function P$(e,t,r){var a=e.l+t,n=za(e);n.r=r["!row"];var i=Rs(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var l=fm(e,a-e.l,r);o[3]=_s(l,null,n,r.supbooks,r)}else e.l=a;return o}var R$=fo,F$=ol;function L$(e,t){return t==null&&(t=Ae(4)),t.write_shift(4,e),t}function M$(e,t){var r=e.l+t,a=fo(e),n=hg(e),i=Rs(e),o=Rs(e),l=Rs(e);e.l=r;var c={rfx:a,relId:n,loc:i,display:l};return o&&(c.Tooltip=o),c}function B$(e,t){var r=Ae(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ol({s:Tr(e[0]),e:Tr(e[0])},r),pg("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return cs(n||"",r),cs(e[1].Tooltip||"",r),cs("",r),r.slice(0,r.l)}function z$(){}function $$(e,t,r){var a=e.l+t,n=kE(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var l=uz(e,a-e.l,r);o[1]=l}else e.l=a;return o}function U$(e,t,r){var a=e.l+t,n=fo(e),i=[n];if(r.cellFormula){var o=fz(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function W$(e,t,r){r==null&&(r=Ae(18));var a=hm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var PT=["left","right","top","bottom","header","footer"];function H$(e){var t={};return PT.forEach(function(r){t[r]=Ps(e)}),t}function V$(e,t){return t==null&&(t=Ae(48)),zi(e),PT.forEach(function(r){Ji(e[r],t)}),t}function G$(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function q$(e,t,r){r==null&&(r=Ae(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function K$(e){var t=Ae(24);return t.write_shift(4,4),t.write_shift(4,1),ol(e,t),t}function Y$(e,t){return t==null&&(t=Ae(66)),t.write_shift(2,e.password?wg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function X$(){}function J$(){}function Z$(e,t,r,a,n,i,o){if(!e)return e;var l=t||{};a||(a={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,f=!1,h,p,x,g,b,j,y,w,S,N=[];l.biff=12,l["!row"]=0;var E=0,P=!1,T=[],O={},_=l.supbooks||n.supbooks||[[]];if(_.sharedf=O,_.arrayf=T,_.SheetNames=n.SheetNames||n.Sheets.map(function(re){return re.name}),!l.supbooks&&(l.supbooks=_,n.Names))for(var C=0;C<n.Names.length;++C)_[0][C+1]=n.Names[C];var R=[],M=[],U=!1;dc[16]={n:"BrtShortReal",f:OT};var Z;if(Mn(e,function(z,me,ne){if(!f)switch(ne){case 148:d=z;break;case 0:h=z,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),w=Br(g=h.r),l["!row"]=h.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=Uo(z.hpt)),M[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:z[2]},z[2]){case"n":p.v=z[1];break;case"s":y=Wl[z[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!z[1];break;case"e":p.v=z[1],l.cellText!==!1&&(p.w=Bn[p.v]);break;case"str":p.t="s",p.v=z[1];break;case"is":p.t="s",p.v=z[1].t;break}if((x=o.CellXf[z[0].iStyleRef])&&kT(p,x.numFmtId,null,l,i,o),b=z[0].c==-1?b+1:z[0].c,l.dense?(c[g]||(c[g]=[]),c[g][b]=p):c[Er(b)+w]=p,l.cellFormula){for(P=!1,E=0;E<T.length;++E){var A=T[E];h.r>=A[0].s.r&&h.r<=A[0].e.r&&b>=A[0].s.c&&b<=A[0].e.c&&(p.F=Tt(A[0]),P=!0)}!P&&z.length>3&&(p.f=z[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>b&&(u.s.c=b),u.e.r<h.r&&(u.e.r=h.r),u.e.c<b&&(u.e.c=b),l.cellDates&&x&&p.t=="n"&&al(ut[x.numFmtId])){var D=ki(p.v);D&&(p.t="d",p.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}Z&&(Z.type=="XLDAPR"&&(p.D=!0),Z=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;p={t:"z",v:void 0},b=z[0].c==-1?b+1:z[0].c,l.dense?(c[g]||(c[g]=[]),c[g][b]=p):c[Er(b)+w]=p,u.s.r>h.r&&(u.s.r=h.r),u.s.c>b&&(u.s.c=b),u.e.r<h.r&&(u.e.r=h.r),u.e.c<b&&(u.e.c=b),Z&&(Z.type=="XLDAPR"&&(p.D=!0),Z=void 0);break;case 176:N.push(z);break;case 49:Z=((l.xlmeta||{}).Cell||[])[z-1];break;case 494:var I=a["!id"][z.relId];for(I?(z.Target=I.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=I):z.relId==""&&(z.Target="#"+z.loc),g=z.rfx.s.r;g<=z.rfx.e.r;++g)for(b=z.rfx.s.c;b<=z.rfx.e.c;++b)l.dense?(c[g]||(c[g]=[]),c[g][b]||(c[g][b]={t:"z",v:void 0}),c[g][b].l=z):(j=mt({c:b,r:g}),c[j]||(c[j]={t:"z",v:void 0}),c[j].l=z);break;case 426:if(!l.cellFormula)break;T.push(z),S=l.dense?c[g][b]:c[Er(b)+w],S.f=_s(z[1],u,{r:h.r,c:b},_,l),S.F=Tt(z[0]);break;case 427:if(!l.cellFormula)break;O[mt(z[0].s)]=z[1],S=l.dense?c[g][b]:c[Er(b)+w],S.f=_s(z[1],u,{r:h.r,c:b},_,l);break;case 60:if(!l.cellStyles)break;for(;z.e>=z.s;)R[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},U||(U=!0,Ng(z.w/256)),oi(R[z.e+1]);break;case 161:c["!autofilter"]={ref:Tt(z)};break;case 476:c["!margins"]=z;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),z.name&&(n.Sheets[r].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),z.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!me.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+ne.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Tt(d||u)),l.sheetRows&&c["!ref"]){var ee=Wt(c["!ref"]);l.sheetRows<=+ee.e.r&&(ee.e.r=l.sheetRows-1,ee.e.r>u.e.r&&(ee.e.r=u.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>u.e.c&&(ee.e.c=u.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Tt(ee))}return N.length>0&&(c["!merges"]=N),R.length>0&&(c["!cols"]=R),M.length>0&&(c["!rows"]=M),c}function Q$(e,t,r,a,n,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=pr(t),t.z=t.z||ut[14],t.v=es(hr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:a};switch(c.s=xi(n.cellXfs,t,n),t.l&&i["!links"].push([mt(c),t.l]),t.c&&i["!comments"].push([mt(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=Ag(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,o?Re(e,18,v$(t,c)):Re(e,7,x$(t,c))):(c.t="str",o?Re(e,17,k$(t,c)):Re(e,6,A$(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Re(e,13,E$(t,c)):Re(e,2,N$(t,c)):o?Re(e,16,j$(t,c)):Re(e,5,b$(t,c)),!0;case"b":return c.t="b",o?Re(e,15,d$(t,c)):Re(e,4,l$(t,c)),!0;case"e":return c.t="e",o?Re(e,14,h$(t,c)):Re(e,3,m$(t,c)),!0}return o?Re(e,12,i$(t,c)):Re(e,1,a$(t,c)),!0}function eU(e,t,r,a){var n=Wt(t["!ref"]||"A1"),i,o="",l=[];Re(e,145);var c=Array.isArray(t),d=n.e.r;t["!rows"]&&(d=Math.max(n.e.r,t["!rows"].length-1));for(var u=n.s.r;u<=d;++u){o=Br(u),Jz(e,t,n,u);var m=!1;if(u<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){u===n.s.r&&(l[f]=Er(f)),i=l[f]+o;var h=c?(t[u]||[])[f]:t[i];if(!h){m=!1;continue}m=Q$(e,h,u,f,a,t,m)}}Re(e,146)}function tU(e,t){!t||!t["!merges"]||(Re(e,177,L$(t["!merges"].length)),t["!merges"].forEach(function(r){Re(e,176,F$(r))}),Re(e,178))}function rU(e,t){!t||!t["!cols"]||(Re(e,390),t["!cols"].forEach(function(r,a){r&&Re(e,60,W$(a,r))}),Re(e,391))}function sU(e,t){!t||!t["!ref"]||(Re(e,648),Re(e,649,K$(Wt(t["!ref"]))),Re(e,650))}function aU(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Qt(r,-1,a[1].Target.replace(/#.*$/,""),It.HLINK);Re(e,494,B$(a,n))}}),delete t["!links"]}function nU(e,t,r,a){if(t["!comments"].length>0){var n=Qt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",It.VML);Re(e,551,pg("rId"+n)),t["!legacy"]=n}}function iU(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:Tt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ra(i);l.s.r==l.e.r&&(l.e.r=ra(t["!ref"]).e.r,i=Tt(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),Re(e,161,ol(Wt(i))),Re(e,162)}}function oU(e,t,r){Re(e,133),Re(e,137,q$(t,r)),Re(e,138),Re(e,134)}function lU(e,t){t["!protect"]&&Re(e,535,Y$(t["!protect"]))}function cU(e,t,r,a){var n=ta(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Wt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Re(n,129),(r.vbaraw||o["!outline"])&&Re(n,147,r$(l,o["!outline"])),Re(n,148,Qz(c)),oU(n,o,r.Workbook),rU(n,o),eU(n,o,e,t),lU(n,o),iU(n,o,r,e),tU(n,o),aU(n,o,a),o["!margins"]&&Re(n,476,V$(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&sU(n,o),nU(n,o,e,a),Re(n,130),n.end()}function dU(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=Ut((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,n,a]}function uU(e,t,r,a,n,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var f=dU(m);u.s.r=u.s.c=0,u.e.c=l,d=Er(l),f[0].forEach(function(h,p){o[d+Br(p)]={t:"n",v:h,z:f[1]},c=p}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Tt(u)),o}function mU(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(DT);return l&&_g(l[0],i,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function fU(e,t){e.l+=10;var r=Rs(e);return{name:r}}function hU(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Mn(e,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var kg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xU=[],gU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function lb(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var i=t[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=fr(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function cb(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=fr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function RT(e){cb(e.WBProps,kg),cb(e.CalcPr,gU),lb(e.WBView,pU),lb(e.Sheets,xU),Oo.date1904=fr(e.WBProps.date1904)}function vU(e){return!e.Workbook||!e.Workbook.WBProps?"false":fr(e.Workbook.WBProps.date1904)?"true":"false"}var yU="][*?/\\".split("");function FT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yU.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function bU(e,t,r){e.forEach(function(a,n){FT(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function jU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];bU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)vz(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var wU=/<\w+:workbook/;function NU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},o=0;if(e.replace(Ms,function(c,d){var u=pt(c);switch(pn(u[0])){case"<?xml":break;case"<workbook":c.match(wU)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[n];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":kg.forEach(function(m){if(u[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=fr(u[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(u[m[0]],10);break;default:r.WBProps[m[0]]=u[m[0]]}}),u.codeName&&(r.WBProps.CodeName=ir(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ut(ir(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=ir(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),fr(u.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=Ut(ir(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),lo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return RT(r),r}function LT(e){var t=[$r];t[t.length]=Be("workbook",null,{xmlns:lo[0],"xmlns:r":Zr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(kg.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(a[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Be("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:sr(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Be("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Be("definedName",sr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function SU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pp(e),r.name=Rs(e),r}function EU(e,t){return t||(t=Ae(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),pg(e.strRelID,t),cs(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function TU(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Rs(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function CU(e,t){t||(t=Ae(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),AE(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function AU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _U(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=nF(e),o=mz(e,0,r),l=hg(e);e.l=a;var c={Name:i,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function kU(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],dc[16]={n:"BrtFRTArchID$",f:AU},Mn(e,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=_s(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(u),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),RT(r),r.Names=i,r.supbooks=o,r}function DU(e,t){Re(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Re(e,156,EU(n))}Re(e,144)}function IU(e,t){t||(t=Ae(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return cs("SheetJS",t),cs(Qd.version,t),cs(Qd.version,t),cs("7262",t),t.length>t.l?t.slice(0,t.l):t}function OU(e,t){t||(t=Ae(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function PU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(Re(e,135),Re(e,158,OU(n)),Re(e,136))}}function RU(e,t){var r=ta();return Re(r,131),Re(r,128,IU()),Re(r,153,CU(e.Workbook&&e.Workbook.WBProps||null)),PU(r,e),DU(r,e),Re(r,132),r.end()}function FU(e,t,r){return t.slice(-4)===".bin"?kU(e,r):NU(e,r)}function LU(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?Z$(e,a,r,n,i,o,l):_z(e,a,r,n,i,o,l)}function MU(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?hU(e,a,r,n,i):mU(e,a,r,n,i)}function BU(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?$B():UB()}function zU(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?BB():zB()}function $U(e,t,r,a){return t.slice(-4)===".bin"?FM(e,r,a):SM(e,r,a)}function UU(e,t,r){return gT(e,r)}function WU(e,t,r){return t.slice(-4)===".bin"?W8(e,r):z8(e,r)}function HU(e,t,r){return t.slice(-4)===".bin"?PB(e,r):EB(e,r)}function VU(e,t,r){return t.slice(-4)===".bin"?wB(e):bB(e)}function GU(e,t,r,a){return r.slice(-4)===".bin"?NB(e,t,r,a):void 0}function qU(e,t,r){return t.slice(-4)===".bin"?gB(e,t,r):yB(e,t,r)}function KU(e,t,r){return(t.slice(-4)===".bin"?RU:LT)(e)}function YU(e,t,r,a,n){return(t.slice(-4)===".bin"?cU:IT)(e,r,a,n)}function XU(e,t,r){return(t.slice(-4)===".bin"?GM:pT)(e,r)}function JU(e,t,r){return(t.slice(-4)===".bin"?G8:oT)(e,r)}function ZU(e,t,r){return(t.slice(-4)===".bin"?RB:bT)(e)}function QU(e){return(e.slice(-4)===".bin"?vB:vT)()}var MT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,BT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Wa(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(MT),i,o,l,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(BT),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),a[l]=i[2].slice(1,i[2].length-1));return a}function e9(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(MT),n,i,o,l;if(a)for(l=0;l!=a.length;++l)n=a[l].match(BT),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),r[o]=n[2].slice(1,n[2].length-1));return r}var Vl;function t9(e,t){var r=Vl[e]||Ut(e);return r==="General"?Yi(t):La(r,t)}function r9(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=fr(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=hr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ut(t)]=n}function s9(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Bn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=tc(e.v):e.w=Yi(e.v):e.w=t9(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=Vl[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&al(a)){var n=ki(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function a9(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=xM[a.Pattern]||a.Pattern)}e[t.ID]=t}function n9(e,t,r,a,n,i,o,l,c,d){var u="General",m=a.StyleID,f={};d=d||{};var h=[],p=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);i[m]!==void 0&&(i[m].nf&&(u=i[m].nf),i[m].Interior&&h.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=fr(e);break;case"String":a.t="s",a.r=Ty(Ut(e)),a.v=e.indexOf("<")>-1?Ut(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(hr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Ut(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=OE[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=Ty(t||e));break}if(s9(a,u,d),d.cellFormula!==!1)if(a.Formula){var x=Ut(a.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),a.f=Io(x,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Io("RC:RC",n):a.ArrayRange&&(a.F=Io(a.ArrayRange,n),c.push([Wt(a.F),a.F]))}else for(p=0;p<c.length;++p)n.r>=c[p][0].s.r&&n.r<=c[p][0].e.r&&n.c>=c[p][0].s.c&&n.c<=c[p][0].e.c&&(a.F=c[p][1]);d.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),a.s=f),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function i9(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function df(e,t){var r=t||{};nl();var a=Ol(lg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=ir(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=pr(r);return o.type="string",$o.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(rt){n.indexOf("<"+rt)>=0&&(i=!0)}),i)return V9(a,r);Vl={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},m=[],f=r.dense?[]:{},h="",p={},x={},g=Wa('<Data ss:Type="String">'),b=0,j=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},N={},E="",P=0,T=[],O={},_={},C=0,R=[],M=[],U={},Z=[],ee,re=!1,z=[],me=[],ne={},A=0,D=0,I={Sheets:[],WBProps:{date1904:!1}},V={};ac.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";l=ac.exec(a);)switch(l[3]=(ie=l[3]).toLowerCase()){case"data":if(ie=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?n9(a.slice(b,l.index),E,g,c[c.length-1][0]=="comment"?U:p,{c:j,r:y},S,Z[j],x,z,r):(E="",g=Wa(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(M.length>0&&(p.c=M),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(f[y]||(f[y]=[]),f[y][j]=p):f[Er(j)+Br(y)]=p),p.HRef&&(p.l={Target:Ut(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(A=j+(parseInt(p.MergeAcross,10)|0),D=y+(parseInt(p.MergeDown,10)|0),T.push({s:{c:j,r:y},e:{c:A,r:D}})),!r.sheetStubs)p.MergeAcross?j=A+1:++j;else if(p.MergeAcross||p.MergeDown){for(var se=j;se<=A;++se)for(var ae=y;ae<=D;++ae)(se>j||ae>y)&&(r.dense?(f[ae]||(f[ae]=[]),f[ae][se]={t:"z"}):f[Er(se)+Br(ae)]={t:"z"});j=A+1}else++j;else p=e9(l[0]),p.Index&&(j=+p.Index-1),j<w.s.c&&(w.s.c=j),j>w.e.c&&(w.e.c=j),l[0].slice(-2)==="/>"&&++j,M=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),l[0].slice(-2)==="/>"&&(x=Wa(l[0]),x.Index&&(y=+x.Index-1)),j=0,++y):(x=Wa(l[0]),x.Index&&(y=+x.Index-1),ne={},(x.AutoFitHeight=="0"||x.Height)&&(ne.hpx=parseInt(x.Height,10),ne.hpt=cc(ne.hpx),me[y]=ne),x.Hidden=="1"&&(ne.hidden=!0,me[y]=ne));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));m.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=Tt(w),r.sheetRows&&r.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=r.sheetRows-1,f["!ref"]=Tt(w))),T.length&&(f["!merges"]=T),Z.length>0&&(f["!cols"]=Z),me.length>0&&(f["!rows"]=me),u[h]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=j=0,c.push([l[3],!1]),d=Wa(l[0]),h=Ut(d.Name),f=r.dense?[]:{},T=[],z=[],me=[],V={name:h,Hidden:0},I.Sheets.push(V);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),Z=[],re=!1}break;case"style":l[1]==="/"?a9(S,N,r):N=Wa(l[0]);break;case"numberformat":N.nf=Ut(Wa(l[0]).Format||"General"),Vl[N.nf]&&(N.nf=Vl[N.nf]);for(var K=0;K!=392&&ut[K]!=N.nf;++K);if(K==392){for(K=57;K!=392;++K)if(ut[K]==null){En(N.nf,K);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ee=Wa(l[0]),ee.Hidden&&(ee.hidden=!0,delete ee.Hidden),ee.Width&&(ee.wpx=parseInt(ee.Width,10)),!re&&ee.wpx>10){re=!0,Ds=fT;for(var G=0;G<Z.length;++G)Z[G]&&oi(Z[G])}re&&oi(ee),Z[ee.Index-1||Z.length]=ee;for(var ue=0;ue<+ee.Span;++ue)Z[Z.length]=pr(ee);break;case"namedrange":if(l[1]==="/")break;I.Names||(I.Names=[]);var L=pt(l[0]),Ne={Name:L.Name,Ref:Io(L.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(Ne.Sheet=I.Sheets.length-1),I.Names.push(Ne);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?E+=a.slice(P,l.index):P=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=Wa(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?kF(O,ie,a.slice(C,l.index)):C=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));i9(U),M.push(U)}else c.push([l[3],!1]),d=Wa(l[0]),U={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Oe=Wa(l[0]);f["!autofilter"]={ref:Io(Oe.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return hb(a,r);var We=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:We=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:We=!1}break;case"excelworkbook":switch(l[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:We=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:We=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(C,l.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else C=l.index+l[0].length;break;case"header":f["!margins"]||zi(f["!margins"]={},"xlml"),isNaN(+pt(l[0]).Margin)||(f["!margins"].header=+pt(l[0]).Margin);break;case"footer":f["!margins"]||zi(f["!margins"]={},"xlml"),isNaN(+pt(l[0]).Margin)||(f["!margins"].footer=+pt(l[0]).Margin);break;case"pagemargins":var Qe=pt(l[0]);f["!margins"]||zi(f["!margins"]={},"xlml"),isNaN(+Qe.Top)||(f["!margins"].top=+Qe.Top),isNaN(+Qe.Left)||(f["!margins"].left=+Qe.Left),isNaN(+Qe.Right)||(f["!margins"].right=+Qe.Right),isNaN(+Qe.Bottom)||(f["!margins"].bottom=+Qe.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:We=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:We=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:We=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:We=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:We=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:We=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:We=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:We=!1}break;case"smarttags":break;default:We=!1;break}if(We||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?r9(_,ie,R,a.slice(C,l.index)):(R=l,C=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=u),Pe.SheetNames=m,Pe.Workbook=I,Pe.SSF=pr(ut),Pe.Props=O,Pe.Custprops=_,Pe}function $p(e,t){switch(Ig(t=t||{}),t.type||"base64"){case"base64":return df(pa(e),t);case"binary":case"buffer":case"file":return df(e,t);case"array":return df(hi(e),t)}}function o9(e,t){var r=[];return e.Props&&r.push(DF(e.Props,t)),e.Custprops&&r.push(IF(e.Props,e.Custprops)),r.join("")}function l9(){return""}function c9(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(Be("NumberFormat",null,{"ss:Format":sr(ut[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Be("Style",i.join(""),o))}),Be("Styles",r.join(""))}function zT(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Tg(e.Ref,{r:0,c:0})})}function d9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(zT(n)))}return Be("Names",r.join(""))}function u9(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(zT(l)))}return i.join("")}function m9(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Be("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(bs("ProtectContents","True")),e["!protect"].objects&&n.push(bs("ProtectObjects","True")),e["!protect"].scenarios&&n.push(bs("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(bs("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(bs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Be("WorksheetOptions",n.join(""),{xmlns:oa.x})}function f9(e){return e.map(function(t){var r=P6(t.t||""),a=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",a,{"ss:Author":t.a})}).join("")}function h9(e,t,r,a,n,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+sr(Tg(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Tr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=sr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=sr(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var m="",f="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":m="Number",f=String(e.v);break;case"b":m="Boolean",f=e.v?"1":"0";break;case"e":m="Error",f=Bn[e.v];break;case"d":m="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ut[14]);break;case"s":m="String",f=O6(e.v||"");break}var h=xi(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var p=e.v!=null?f:"",x=e.t=="z"?"":'<Data ss:Type="'+m+'">'+p+"</Data>";return(e.c||[]).length>0&&(x+=f9(e.c)),Be("Cell",x,l)}function p9(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Uo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function x9(e,t,r,a){if(!e["!ref"])return"";var n=Wt(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,b){oi(g);var j=!!g.width,y=hm(b,g),w={"ss:Index":b+1};j&&(w["ss:Width"]=oc(y.width)),g.hidden&&(w["ss:Hidden"]="1"),l.push(Be("Column",null,w))});for(var c=Array.isArray(e),d=n.s.r;d<=n.e.r;++d){for(var u=[p9(d,(e["!rows"]||[])[d])],m=n.s.c;m<=n.e.c;++m){var f=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>m)&&!(i[o].s.r>d)&&!(i[o].e.c<m)&&!(i[o].e.r<d)){(i[o].s.c!=m||i[o].s.r!=d)&&(f=!0);break}if(!f){var h={r:d,c:m},p=mt(h),x=c?(e[d]||[])[m]:e[p];u.push(h9(x,p,e,t,r,a,h))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function g9(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],o=i?u9(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?x9(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(m9(i,t,e,r)),a.join("")}function v9(e,t){t||(t={}),e.SSF||(e.SSF=pr(ut)),e.SSF&&(nl(),om(e.SSF),t.revssf=cm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(o9(e,t)),r.push(l9()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Be("Worksheet",g9(a,t,e),{"ss:Name":sr(e.SheetNames[a])}));return r[2]=c9(e,t),r[3]=d9(e),$r+Be("Workbook",r.join(""),{xmlns:oa.ss,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:ss":oa.ss,"xmlns:dt":oa.dt,"xmlns:html":oa.html})}function y9(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=dF(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=uF(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var b9=[60,1084,2066,2165,2175];function j9(e,t,r,a,n){var i=a,o=[],l=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}o.push(l),r.l+=i;for(var c=jn(r,r.l),d=Up[c],u=0;d!=null&&b9.indexOf(c)>-1;)i=jn(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+i),o.push(l),r.l+=4+i,d=Up[c=jn(r,r.l)];var m=ls(o);vs(m,0);var f=0;m.lens=[];for(var h=0;h<o.length;++h)m.lens.push(f),f+=o[h].length;if(m.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+a;return t.f(m,m.length,n)}function sn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ut[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Bn[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=tc(e.v):e.w=Yi(e.v):e.w=La(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&al(ut[a]||String(a))){var n=ki(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function vd(e,t,r){return{v:e,ixfe:t,t:r}}function w9(e,t){var r={opts:{}},a={},n=t.dense?[]:{},i={},o={},l=null,c=[],d="",u={},m,f="",h,p,x,g,b={},j=[],y,w,S=[],N=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},T=function(ht){return ht<8?Li[ht]:ht<64&&N[ht-8]||Li[ht]},O=function(ht,Nt,Dr){var ot=Nt.XF.data;if(!(!ot||!ot.patternType||!Dr||!Dr.cellStyles)){Nt.s={},Nt.s.patternType=ot.patternType;var dt;(dt=ic(T(ot.icvFore)))&&(Nt.s.fgColor={rgb:dt}),(dt=ic(T(ot.icvBack)))&&(Nt.s.bgColor={rgb:dt})}},_=function(ht,Nt,Dr){if(!(ne>1)&&!(Dr.sheetRows&&ht.r>=Dr.sheetRows)){if(Dr.cellStyles&&Nt.XF&&Nt.XF.data&&O(ht,Nt,Dr),delete Nt.ixfe,delete Nt.XF,m=ht,f=mt(ht),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ht.r<o.s.r&&(o.s.r=ht.r),ht.c<o.s.c&&(o.s.c=ht.c),ht.r+1>o.e.r&&(o.e.r=ht.r+1),ht.c+1>o.e.c&&(o.e.c=ht.c+1),Dr.cellFormula&&Nt.f){for(var ot=0;ot<j.length;++ot)if(!(j[ot][0].s.c>ht.c||j[ot][0].s.r>ht.r)&&!(j[ot][0].e.c<ht.c||j[ot][0].e.r<ht.r)){Nt.F=Tt(j[ot][0]),(j[ot][0].s.c!=ht.c||j[ot][0].s.r!=ht.r)&&delete Nt.f,Nt.f&&(Nt.f=""+_s(j[ot][1],o,ht,z,C));break}}Dr.dense?(n[ht.r]||(n[ht.r]=[]),n[ht.r][ht.c]=Nt):n[f]=Nt}},C={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:j,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var R,M=[],U=[],Z=[],ee=[],re=!1,z=[];z.SheetNames=C.snames,z.sharedf=C.sharedf,z.arrayf=C.arrayf,z.names=[],z.XTI=[];var me=0,ne=0,A=0,D=[],I=[],V;C.codepage=1200,qa(1200);for(var ie=!1;e.l<e.length-1;){var se=e.l,ae=e.read_shift(2);if(ae===0&&me===10)break;var K=e.l===e.length?0:e.read_shift(2),G=Up[ae];if(G&&G.f){if(t.bookSheets&&me===133&&ae!==133)break;if(me=ae,G.r===2||G.r==12){var ue=e.read_shift(2);if(K-=2,!C.enc&&ue!==ae&&((ue&255)<<8|ue>>8)!==ae)throw new Error("rt mismatch: "+ue+"!="+ae);G.r==12&&(e.l+=10,K-=10)}var L={};if(ae===10?L=G.f(e,K,C):L=j9(ae,G,e,K,C),ne==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(ae){case 34:r.opts.Date1904=E.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=L,!t.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=L;break;case 66:var Ne=Number(L);switch(Ne){case 21010:Ne=1200;break;case 32768:Ne=1e4;break;case 32769:Ne=1252;break}qa(C.codepage=Ne),ie=!0;break;case 317:C.rrtabid=L;break;case 25:C.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:C.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(n["!type"]="dialog"),L.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),L.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:S.push(L);break;case 430:z.push([L]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(L);break;case 24:case 536:V={Name:L.Name,Ref:_s(L.rgce,o,null,z,C)},L.itab>0&&(V.Sheet=L.itab-1),z.names.push(V),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(I[L.itab-1]={ref:Tt(L.rgce[0][0][1][2])});break;case 22:C.ExternCount=L;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(L),z.XTI=z.XTI.concat(L);break;case 2196:if(C.biff<8)break;V!=null&&(V.Comment=L[1]);break;case 18:n["!protect"]=L;break;case 19:L!==0&&C.WTF&&console.error("Password verifier: "+L);break;case 133:i[L.pos]=L,C.snames.push(L.name);break;case 10:{if(--ne)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=Tt(o),t.sheetRows&&t.sheetRows<=o.e.r){var Oe=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Tt(o),o.e.r=Oe}o.e.r++,o.e.c++}M.length>0&&(n["!merges"]=M),U.length>0&&(n["!objects"]=U),Z.length>0&&(n["!cols"]=Z),ee.length>0&&(n["!rows"]=ee),E.Sheets.push(P)}d===""?u=n:a[d]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),C.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(C.biff=5,ie=!0,qa(C.codepage=28591)),C.biff==8&&L.BIFFVer==0&&L.dt==16&&(C.biff=2),ne++)break;if(n=t.dense?[]:{},C.biff<8&&!ie&&(ie=!0,qa(C.codepage=t.codepage||1252)),C.biff<5||L.BIFFVer==0&&L.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var We={pos:e.l-K,name:d};i[We.pos]=We,C.snames.push(d)}else d=(i[se]||{name:""}).name;L.dt==32&&(n["!type"]="chart"),L.dt==64&&(n["!type"]="macro"),M=[],U=[],C.arrayf=j=[],Z=[],ee=[],re=!1,P={Hidden:(i[se]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[L.r]||[])[L.c]:n[mt({c:L.c,r:L.r})])&&++L.c,y={ixfe:L.ixfe,XF:S[L.ixfe]||{},v:L.val,t:"n"},A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_({c:L.c,r:L.r},y,t);break;case 5:case 517:y={ixfe:L.ixfe,XF:S[L.ixfe],v:L.val,t:L.t},A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_({c:L.c,r:L.r},y,t);break;case 638:y={ixfe:L.ixfe,XF:S[L.ixfe],v:L.rknum,t:"n"},A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_({c:L.c,r:L.r},y,t);break;case 189:for(var Qe=L.c;Qe<=L.C;++Qe){var Pe=L.rkrec[Qe-L.c][0];y={ixfe:Pe,XF:S[Pe],v:L.rkrec[Qe-L.c][1],t:"n"},A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_({c:Qe,r:L.r},y,t)}break;case 6:case 518:case 1030:{if(L.val=="String"){l=L;break}if(y=vd(L.val,L.cell.ixfe,L.tt),y.XF=S[y.ixfe],t.cellFormula){var rt=L.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var Ht=rt[0][0][1][0],gt=rt[0][0][1][1],Ue=mt({r:Ht,c:gt});b[Ue]?y.f=""+_s(L.formula,o,L.cell,z,C):y.F=((t.dense?(n[Ht]||[])[gt]:n[Ue])||{}).F}else y.f=""+_s(L.formula,o,L.cell,z,C)}A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_(L.cell,y,t),l=L}break;case 7:case 519:if(l)l.val=L,y=vd(L,l.cell.ixfe,"s"),y.XF=S[y.ixfe],t.cellFormula&&(y.f=""+_s(l.formula,o,l.cell,z,C)),A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{j.push(L);var he=mt(L[0].s);if(h=t.dense?(n[L[0].s.r]||[])[L[0].s.c]:n[he],t.cellFormula&&h){if(!l||!he||!h)break;h.f=""+_s(L[1],o,L[0],z,C),h.F=Tt(L[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!l)break;b[mt(l.cell)]=L[0],h=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[mt(l.cell)],(h||{}).f=""+_s(L[0],o,m,z,C)}}break;case 253:y=vd(c[L.isst].t,L.ixfe,"s"),c[L.isst].h&&(y.h=c[L.isst].h),y.XF=S[y.ixfe],A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_({c:L.c,r:L.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:L.ixfe,XF:S[L.ixfe],t:"z"},A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_({c:L.c,r:L.r},y,t));break;case 190:if(t.sheetStubs)for(var Me=L.c;Me<=L.C;++Me){var Fe=L.ixfe[Me-L.c];y={ixfe:Fe,XF:S[Fe],t:"z"},A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_({c:Me,r:L.r},y,t)}break;case 214:case 516:case 4:y=vd(L.val,L.ixfe,"s"),y.XF=S[y.ixfe],A>0&&(y.z=D[y.ixfe>>8&63]),sn(y,t,r.opts.Date1904),_({c:L.c,r:L.r},y,t);break;case 0:case 512:ne===1&&(o=L);break;case 252:c=L;break;case 1054:if(C.biff==4){D[A++]=L[1];for(var Ye=0;Ye<A+163&&ut[Ye]!=L[1];++Ye);Ye>=163&&En(L[1],A+163)}else En(L[1],L[0]);break;case 30:{D[A++]=L;for(var Rt=0;Rt<A+163&&ut[Rt]!=L;++Rt);Rt>=163&&En(L,A+163)}break;case 229:M=M.concat(L);break;case 93:U[L.cmo[0]]=C.lastobj=L;break;case 438:C.lastobj.TxO=L;break;case 127:C.lastobj.ImData=L;break;case 440:for(g=L[0].s.r;g<=L[0].e.r;++g)for(x=L[0].s.c;x<=L[0].e.c;++x)h=t.dense?(n[g]||[])[x]:n[mt({c:x,r:g})],h&&(h.l=L[1]);break;case 2048:for(g=L[0].s.r;g<=L[0].e.r;++g)for(x=L[0].s.c;x<=L[0].e.c;++x)h=t.dense?(n[g]||[])[x]:n[mt({c:x,r:g})],h&&h.l&&(h.l.Tooltip=L[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;h=t.dense?(n[L[0].r]||[])[L[0].c]:n[mt(L[0])];var Ot=U[L[2]];h||(t.dense?(n[L[0].r]||(n[L[0].r]=[]),h=n[L[0].r][L[0].c]={t:"z"}):h=n[mt(L[0])]={t:"z"},o.e.r=Math.max(o.e.r,L[0].r),o.s.r=Math.min(o.s.r,L[0].r),o.e.c=Math.max(o.e.c,L[0].c),o.s.c=Math.min(o.s.c,L[0].c)),h.c||(h.c=[]),p={a:L[1],t:Ot.TxO.t},h.c.push(p)}break;case 2173:cB(S[L.ixfe],L.ext);break;case 125:{if(!C.cellStyles)break;for(;L.e>=L.s;)Z[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},re||(re=!0,Ng(L.w/256)),oi(Z[L.e+1])}break;case 520:{var vt={};L.level!=null&&(ee[L.r]=vt,vt.level=L.level),L.hidden&&(ee[L.r]=vt,vt.hidden=!0),L.hpt&&(ee[L.r]=vt,vt.hpt=L.hpt,vt.hpx=Uo(L.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||zi(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=L;break;case 161:n["!margins"]||zi(n["!margins"]={}),n["!margins"].header=L.header,n["!margins"].footer=L.footer;break;case 574:L.RTL&&(E.Views[0].RTL=!0);break;case 146:N=L;break;case 2198:R=L;break;case 140:w=L;break;case 442:d?P.CodeName=L||P.name:E.WBProps.CodeName=L||"ThisWorkbook";break}}else G||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=K}return r.SheetNames=Pr(i).sort(function(ft,ht){return Number(ft)-Number(ht)}).map(function(ft){return i[ft].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&I.forEach(function(ft,ht){r.Sheets[r.SheetNames[ht]]["!autofilter"]=ft}),r.Strings=c,r.SSF=pr(ut),C.enc&&(r.Encryption=C.enc),R&&(r.Themes=R),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),z.names.length>0&&(E.Names=z.names),r.Workbook=E,r}var Gl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function N9(e,t,r){var a=lt.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Hy(a,Rp,Gl.DSI);for(var i in n)t[i]=n[i]}catch(d){if(r.WTF)throw d}var o=lt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=Hy(o,Fp,Gl.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(BE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function S9(e,t){var r=[],a=[],n=[],i=0,o,l=by(Rp,"n"),c=by(Fp,"n");if(e.Props)for(o=Pr(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:n).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Pr(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:n).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<n.length;++i)GE.indexOf(n[i][0])>-1||ME.indexOf(n[i][0])>-1||n[i][1]!=null&&d.push(n[i]);a.length&&lt.utils.cfb_add(t,"/SummaryInformation",Vy(a,Gl.SI,c,Fp)),(r.length||d.length)&&lt.utils.cfb_add(t,"/DocumentSummaryInformation",Vy(r,Gl.DSI,l,Rp,d.length?d:null,Gl.UDI))}function $T(e,t){t||(t={}),Ig(t),Qx(),t.codepage&&Zx(t.codepage);var r,a;if(e.FullPaths){if(lt.find(e,"/encryption"))throw new Error("File is password-protected");r=lt.find(e,"!CompObj"),a=lt.find(e,"/Workbook")||lt.find(e,"/Book")}else{switch(t.type){case"base64":e=ca(pa(e));break;case"binary":e=ca(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}vs(e,0),a={content:e}}var n,i;if(r&&y9(r),t.bookProps&&!t.bookSheets)n={};else{var o=kt?"buffer":"array";if(a&&a.content)n=w9(a.content,t);else if((i=lt.find(e,"PerfectOffice_MAIN"))&&i.content)n=Bi.to_workbook(i.content,(t.type=o,t));else if((i=lt.find(e,"NativeContent_MAIN"))&&i.content)n=Bi.to_workbook(i.content,(t.type=o,t));else throw(i=lt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&lt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=LB(e))}var l={};return e.FullPaths&&N9(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function E9(e,t){var r=t||{},a=lt.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return lt.utils.cfb_add(a,n,UT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&S9(e,a),r.biff==8&&e.vbaraw&&MB(a,lt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var dc={0:{f:Yz},1:{f:s$},2:{f:w$},3:{f:u$},4:{f:o$},5:{f:y$},6:{f:C$},7:{f:p$},8:{f:P$},9:{f:O$},10:{f:D$},11:{f:I$},12:{f:n$},13:{f:S$},14:{f:f$},15:{f:c$},16:{f:OT},17:{f:_$},18:{f:g$},19:{f:fg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_U},40:{},42:{},43:{f:CM},44:{f:EM},45:{f:kM},46:{f:IM},47:{f:DM},48:{},49:{f:Z6},50:{},51:{f:mB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:sT},62:{f:T$},63:{f:jB},64:{f:X$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ls,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:G$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:t$},148:{f:Zz,p:16},151:{f:z$},152:{},153:{f:TU},154:{},155:{},156:{f:SU},157:{},158:{},159:{T:1,f:U8},160:{T:-1},161:{T:1,f:fo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:R$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:dB},336:{T:-1},337:{f:pB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$$},427:{f:U$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:H$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:e$},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:M$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:IB},633:{T:1},634:{T:-1},635:{T:1,f:kB},636:{T:-1},637:{f:rF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:J$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Up={6:{f:lf},10:{f:Xn},12:{f:Vr},13:{f:Vr},14:{f:Fr},15:{f:Fr},16:{f:Ps},17:{f:Fr},18:{f:Fr},19:{f:Vr},20:{f:Jy},21:{f:Jy},23:{f:rT},24:{f:Qy},25:{f:Fr},26:{},27:{},28:{f:JL},29:{},34:{f:Fr},35:{f:Zy},38:{f:Ps},39:{f:Ps},40:{f:Ps},41:{f:Ps},42:{f:Fr},43:{f:Fr},47:{f:cM},49:{f:SL},51:{f:Vr},60:{},61:{f:yL},64:{f:Fr},65:{f:NL},66:{f:Vr},77:{},80:{},81:{},82:{},85:{f:Vr},89:{},90:{},91:{},92:{f:lL},93:{f:e8},94:{},95:{f:Fr},96:{},97:{},99:{f:Fr},125:{f:sT},128:{f:BL},129:{f:dL},130:{f:Vr},131:{f:Fr},132:{f:Fr},133:{f:uL},134:{},140:{f:l8},141:{f:Vr},144:{},146:{f:u8},151:{},152:{},153:{},154:{},155:{},156:{f:Vr},157:{},158:{},160:{f:v8},161:{f:h8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:RL},190:{f:FL},193:{f:Xn},197:{},198:{},199:{},200:{},201:{},202:{f:Fr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Vr},220:{},221:{f:Fr},222:{},224:{f:ML},225:{f:oL},226:{f:Xn},227:{},229:{f:ZL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:fL},253:{f:TL},255:{f:pL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:qE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Fr},353:{f:Xn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:HL},431:{f:Fr},432:{},433:{},434:{},437:{},438:{f:s8},439:{f:Fr},440:{f:a8},441:{},442:{f:Pc},443:{},444:{f:Vr},445:{},446:{},448:{f:Xn},449:{f:vL,r:2},450:{f:Xn},512:{f:Ky},513:{f:g8},515:{f:UL},516:{f:AL},517:{f:Xy},519:{f:y8},520:{f:xL},523:{},545:{f:eb},549:{f:qy},566:{},574:{f:jL},638:{f:PL},659:{},1048:{},1054:{f:kL},1084:{},1212:{f:KL},2048:{f:i8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:pd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Xn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:m8,r:12},2173:{f:lB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Fr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:qL,r:12},2197:{},2198:{f:rB,r:12},2199:{},2200:{},2201:{},2202:{f:YL,r:12},2203:{f:Xn},2204:{},2205:{},2206:{},2207:{},2211:{f:gL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Vr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:p8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:d8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ky},1:{},2:{f:S8},3:{f:w8},4:{f:j8},5:{f:Xy},7:{f:T8},8:{},9:{f:pd},11:{},22:{f:Vr},30:{f:IL},31:{},32:{},33:{f:eb},36:{},37:{f:qy},50:{f:C8},62:{},52:{},67:{},68:{f:Vr},69:{},86:{},126:{},127:{f:b8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:A8},223:{},234:{},354:{},421:{},518:{f:lf},521:{f:pd},536:{f:Qy},547:{f:Zy},561:{},579:{},1030:{f:lf},1033:{f:pd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&dg(r)&&e.push(r)}}function T9(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return ze(e,t,r,n);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<n;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Mc(e,t,r){return e||(e=Ae(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function C9(e,t,r,a){var n=Ae(9);return Mc(n,e,t),KE(r,a||"b",n),n}function A9(e,t,r){var a=Ae(8+2*r.length);return Mc(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function _9(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?es(hr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?ze(e,2,E8(r,a,n)):ze(e,3,N8(r,a,n));return;case"b":case"e":ze(e,5,C9(r,a,t.v,t.t));return;case"s":case"str":ze(e,4,A9(r,a,(t.v||"").slice(0,255)));return}ze(e,1,Mc(null,r,a))}function k9(e,t,r,a){var n=Array.isArray(t),i=Wt(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Tt(i)}for(var d=i.s.r;d<=i.e.r;++d){l=Br(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=Er(u)),o=c[u]+l;var m=n?(t[d]||[])[u]:t[o];m&&_9(e,m,d,u)}}}function D9(e,t){for(var r=t||{},a=ta(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(a,r.biff==4?1033:r.biff==3?521:9,bg(e,16,r)),k9(a,e.Sheets[e.SheetNames[n]],n,r),ze(a,10),a.end()}function I9(e,t,r){ze(e,49,EL({sz:12,name:"Arial"},r))}function O9(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&ze(e,1054,DL(n,t[n],r))})}function P9(e,t){var r=Ae(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(e,2151,r),r=Ae(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),QE(Wt(t["!ref"]||"A1"),r),r.write_shift(4,4),ze(e,2152,r)}function R9(e,t){for(var r=0;r<16;++r)ze(e,224,Yy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){ze(e,224,Yy(a,0,t))})}function F9(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];ze(e,440,n8(a)),a[1].Tooltip&&ze(e,2048,o8(a))}delete t["!links"]}function L9(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&ze(e,125,f8(hm(n,a),n))})}}function M9(e,t,r,a,n){var i=16+xi(n.cellXfs,t,n);if(t.v==null&&!t.bf){ze(e,513,Qi(r,a,i));return}if(t.bf)ze(e,6,dz(t,r,a,n,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?es(hr(t.v)):t.v;ze(e,515,WL(r,a,o,i));break;case"b":case"e":ze(e,517,$L(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var l=Ag(n.Strings,t.v,n.revStrings);ze(e,253,CL(r,a,l,i))}else ze(e,516,_L(r,a,(t.v||"").slice(0,255),i,n));break;default:ze(e,513,Qi(r,a,i))}}function B9(e,t,r){var a=ta(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,m="",f=[],h=Wt(i["!ref"]||"A1"),p=d?65536:16384;if(h.e.c>255||h.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}ze(a,2057,bg(r,16,t)),ze(a,13,Da(1)),ze(a,12,Da(100)),ze(a,15,$s(!0)),ze(a,17,$s(!1)),ze(a,16,Ji(.001)),ze(a,95,$s(!0)),ze(a,42,$s(!1)),ze(a,43,$s(!1)),ze(a,130,Da(1)),ze(a,128,zL()),ze(a,131,$s(!1)),ze(a,132,$s(!1)),d&&L9(a,i["!cols"]),ze(a,512,OL(h,t)),d&&(i["!links"]=[]);for(var x=h.s.r;x<=h.e.r;++x){m=Br(x);for(var g=h.s.c;g<=h.e.c;++g){x===h.s.r&&(f[g]=Er(g)),u=f[g]+m;var b=c?(i[x]||[])[g]:i[u];b&&(M9(a,b,x,g,t),d&&b.l&&i["!links"].push([u,b.l]))}}var j=l.CodeName||l.name||n;return d&&ze(a,574,wL((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&ze(a,229,QL(i["!merges"])),d&&F9(a,i),ze(a,442,YE(j)),d&&P9(a,i),ze(a,10),a.end()}function z9(e,t,r){var a=ta(),n=(e||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(ze(a,2057,bg(e,5,r)),r.bookType=="xla"&&ze(a,135),ze(a,225,l?Da(1200):null),ze(a,193,$F(2)),c&&ze(a,191),c&&ze(a,192),ze(a,226),ze(a,92,cL("SheetJS",r)),ze(a,66,Da(l?1200:1252)),l&&ze(a,353,Da(0)),l&&ze(a,448),ze(a,317,x8(e.SheetNames.length)),l&&e.vbaraw&&ze(a,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";ze(a,442,YE(d))}ze(a,156,Da(17)),ze(a,25,$s(!1)),ze(a,18,$s(!1)),ze(a,19,Da(0)),l&&ze(a,431,$s(!1)),l&&ze(a,444,Da(0)),ze(a,61,bL()),ze(a,64,$s(!1)),ze(a,141,Da(0)),ze(a,34,$s(vU(e)=="true")),ze(a,14,$s(!0)),l&&ze(a,439,$s(!1)),ze(a,218,Da(0)),I9(a,e,r),O9(a,e.SSF,r),R9(a,r),l&&ze(a,352,$s(!1));var u=a.end(),m=ta();l&&ze(m,140,c8()),l&&r.Strings&&T9(m,252,hL(r.Strings)),ze(m,10);var f=m.end(),h=ta(),p=0,x=0;for(x=0;x<e.SheetNames.length;++x)p+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var g=u.length+p+f.length;for(x=0;x<e.SheetNames.length;++x){var b=i[x]||{};ze(h,133,mL({pos:g,hs:b.Hidden||0,dt:0,name:e.SheetNames[x]},r)),g+=t[x].length}var j=h.end();if(p!=j.length)throw new Error("BS8 "+p+" != "+j.length);var y=[];return u.length&&y.push(u),j.length&&y.push(j),f.length&&y.push(f),ls(y)}function $9(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=pr(ut)),e&&e.SSF&&(nl(),om(e.SSF),r.revssf=cm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Og(r),r.cellXfs=[],xi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=B9(n,r,e);return a.unshift(z9(e,a,r)),ls(a)}function UT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=ra(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return $9(e,t);case 4:case 3:case 2:return D9(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function db(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=n.index,l=i&&i.index||e.length,c=E6(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,m=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<c.length;++o){var x=c[o].trim(),g=x.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var b=x.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var j=b[l].trim();if(j.match(/<t[dh]/i)){for(var y=j,w=0;y.charAt(0)=="<"&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var S=0;S<p.length;++S){var N=p[S];N.s.c==u&&N.s.r<d&&d<=N.e.r&&(u=N.e.c+1,S=-1)}var E=pt(j.slice(0,j.indexOf(">")));f=E.colspan?+E.colspan:1,((m=+E.rowspan)>1||f>1)&&p.push({s:{r:d,c:u},e:{r:d+(m||1)-1,c:u+f-1}});var P=E.t||E["data-t"]||"";if(!y.length){u+=f;continue}if(y=mE(y),h.s.r>d&&(h.s.r=d),h.e.r<d&&(h.e.r=d),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!y.length){u+=f;continue}var T={t:"s",v:y};r.raw||!y.trim().length||P=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(Ya(y))?isNaN(zo(y).getDate())||(T={t:"d",v:hr(y)},r.cellDates||(T={t:"n",v:es(T.v)}),T.z=r.dateNF||ut[14]):T={t:"n",v:Ya(y)}),r.dense?(a[d]||(a[d]=[]),a[d][u]=T):a[mt({r:d,c:u})]=T,u+=f}}}}return a["!ref"]=Tt(h),p.length&&(a["!merges"]=p),a}function U9(e,t,r,a){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>o)&&!(n[d].e.r<r||n[d].e.c<o)){if(n[d].s.r<r||n[d].s.c<o){l=-1;break}l=n[d].e.r-n[d].s.r+1,c=n[d].e.c-n[d].s.c+1;break}if(!(l<0)){var u=mt({r,c:o}),m=a.dense?(e[r]||[])[o]:e[u],f=m&&m.v!=null&&(m.h||og(m.w||(Dn(m),m.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),a.editable?f='<span contenteditable="true">'+f+"</span>":m&&(h["data-t"]=m&&m.t||"z",m.v!=null&&(h["data-v"]=m.v),m.z!=null&&(h["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+m.l.Target+'">'+f+"</a>")),h.id=(a.id||"sjs")+"-"+u,i.push(Be("td",f,h))}}var p="<tr>";return p+i.join("")+"</tr>"}var W9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',H9="</body></html>";function V9(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return pi(db(r[0],t),t);var a=Lg();return r.forEach(function(n,i){Mg(a,db(n,t),"Sheet"+(i+1))}),a}function G9(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function WT(e,t){var r=t||{},a=r.header!=null?r.header:W9,n=r.footer!=null?r.footer:H9,i=[a],o=ra(e["!ref"]);r.dense=Array.isArray(e),i.push(G9(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(U9(e,o,l,r));return i.push("</table>"+n),i.join("")}function HT(e,t,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?Tr(a.origin):a.origin;n=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var u=ra(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),n==-1&&(d.e.r=n=u.e.r+1)}var m=[],f=0,h=e["!rows"]||(e["!rows"]=[]),p=0,x=0,g=0,b=0,j=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<l.length&&x<c;++p){var w=l[p];if(ub(w)){if(a.display)continue;h[x]={hidden:!0}}var S=w.children;for(g=b=0;g<S.length;++g){var N=S[g];if(!(a.display&&ub(N))){var E=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):mE(N.innerHTML),P=N.getAttribute("data-z")||N.getAttribute("z");for(f=0;f<m.length;++f){var T=m[f];T.s.c==b+i&&T.s.r<x+n&&x+n<=T.e.r&&(b=T.e.c+1-i,f=-1)}y=+N.getAttribute("colspan")||1,((j=+N.getAttribute("rowspan")||1)>1||y>1)&&m.push({s:{r:x+n,c:b+i},e:{r:x+n+(j||1)-1,c:b+i+(y||1)-1}});var O={t:"s",v:E},_=N.getAttribute("data-t")||N.getAttribute("t")||"";E!=null&&(E.length==0?O.t=_||"z":a.raw||E.trim().length==0||_=="s"||(E==="TRUE"?O={t:"b",v:!0}:E==="FALSE"?O={t:"b",v:!1}:isNaN(Ya(E))?isNaN(zo(E).getDate())||(O={t:"d",v:hr(E)},a.cellDates||(O={t:"n",v:es(O.v)}),O.z=a.dateNF||ut[14]):O={t:"n",v:Ya(E)})),O.z===void 0&&P!=null&&(O.z=P);var C="",R=N.getElementsByTagName("A");if(R&&R.length)for(var M=0;M<R.length&&!(R[M].hasAttribute("href")&&(C=R[M].getAttribute("href"),C.charAt(0)!="#"));++M);C&&C.charAt(0)!="#"&&(O.l={Target:C}),a.dense?(e[x+n]||(e[x+n]=[]),e[x+n][b+i]=O):e[mt({c:b+i,r:x+n})]=O,d.e.c<b+i&&(d.e.c=b+i),b+=y}}++x}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,x-1+n),e["!ref"]=Tt(d),x>=c&&(e["!fullref"]=Tt((d.e.r=l.length-p+x-1+n,d))),e}function VT(e,t){var r=t||{},a=r.dense?[]:{};return HT(a,e,t)}function q9(e,t){return pi(VT(e,t),t)}function ub(e){var t="",r=K9(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function K9(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Y9(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ut(t.replace(/<[^>]*>/g,""));return[r]}var mb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function GT(e,t){var r=t||{},a=lg(e),n=[],i,o,l={name:""},c="",d=0,u,m,f={},h=[],p=r.dense?[]:{},x,g,b={value:""},j="",y=0,w=[],S=-1,N=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,T={},O=[],_={},C=0,R=0,M=[],U=1,Z=1,ee=[],re={Names:[]},z={},me=["",""],ne=[],A={},D="",I=0,V=!1,ie=!1,se=0;for(ac.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=ac.exec(a);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?p["!ref"]=Tt(E):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=Tt(E)),O.length&&(p["!merges"]=O),M.length&&(p["!rows"]=M),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),f[u.name]=p,ie=!1):x[0].charAt(x[0].length-2)!=="/"&&(u=pt(x[0],!1),S=N=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,p=r.dense?[]:{},O=[],M=[],ie=!0);break;case"table-row-group":x[1]==="/"?--P:++P;break;case"table-row":case"":if(x[1]==="/"){S+=U,U=1;break}if(m=pt(x[0],!1),m.?S=m.-1:S==-1&&(S=0),U=+m["number-rows-repeated"]||1,U<10)for(se=0;se<U;++se)P>0&&(M[S+se]={level:P});N=-1;break;case"covered-table-cell":x[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(p[S]||(p[S]=[]),p[S][N]={t:"z"}):p[mt({r:S,c:N})]={t:"z"}),j="",w=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++N,b=pt(x[0],!1),Z=parseInt(b["number-columns-repeated"]||"1",10),g={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(g.f=ob(Ut(b.formula))),(b.||b["value-type"])=="string"&&(g.t="s",g.v=Ut(b["string-value"]||""),r.dense?(p[S]||(p[S]=[]),p[S][N]=g):p[mt({r:S,c:N})]=g),N+=Z-1;else if(x[1]!=="/"){++N,j="",y=0,w=[],Z=1;var ae=U?S+U-1:S;if(N>E.e.c&&(E.e.c=N),N<E.s.c&&(E.s.c=N),S<E.s.r&&(E.s.r=S),ae>E.e.r&&(E.e.r=ae),b=pt(x[0],!1),ne=[],A={},g={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Ut(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(C=parseInt(b["number-matrix-rows-spanned"],10)||0,R=parseInt(b["number-matrix-columns-spanned"],10)||0,_={s:{r:S,c:N},e:{r:S+C-1,c:N+R-1}},g.F=Tt(_),ee.push([_,g.F])),b.formula)g.f=ob(b.formula);else for(se=0;se<ee.length;++se)S>=ee[se][0].s.r&&S<=ee[se][0].e.r&&N>=ee[se][0].s.c&&N<=ee[se][0].e.c&&(g.F=ee[se][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(C=parseInt(b["number-rows-spanned"],10)||0,R=parseInt(b["number-columns-spanned"],10)||0,_={s:{r:S,c:N},e:{r:S+C-1,c:N+R-1}},O.push(_)),b["number-columns-repeated"]&&(Z=parseInt(b["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=fr(b["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(b.value);break;case"percentage":g.t="n",g.v=parseFloat(b.value);break;case"currency":g.t="n",g.v=parseFloat(b.value);break;case"date":g.t="d",g.v=hr(b["date-value"]),r.cellDates||(g.t="n",g.v=es(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=w6(b["time-value"])/86400,r.cellDates&&(g.t="d",g.v=dm(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(b.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",b["string-value"]!=null&&(j=Ut(b["string-value"]),w=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(V=!1,g.t==="s"&&(g.v=j||"",w.length&&(g.R=w),V=y==0),z.Target&&(g.l=z),ne.length>0&&(g.c=ne,ne=[]),j&&r.cellText!==!1&&(g.w=j),V&&(g.t="z",delete g.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var K=0;K<U;++K){if(Z=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(p[S+K]||(p[S+K]=[]),p[S+K][N]=K==0?g:pr(g);--Z>0;)p[S+K][N+Z]=pr(g);else for(p[mt({r:S+K,c:N})]=g;--Z>0;)p[mt({r:S+K,c:N+Z})]=pr(g);E.e.c<=N&&(E.e.c=N)}Z=parseInt(b["number-columns-repeated"]||"1",10),N+=Z-1,Z=0,g={},j="",w=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i;A.t=j,w.length&&(A.R=w),A.a=D,ne.push(A)}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);D="",I=0,j="",y=0,w=[];break;case"creator":x[1]==="/"?D=a.slice(I,x.index):I=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);j="",y=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(T[l.name]=c,(i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(c="",l=pt(x[0],!1),n.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=pt(x[0],!1),c+=mb[x[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=pt(x[0],!1),c+=mb[x[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(d,x.index);break}else d=x.index+x[0].length;break;case"named-range":o=pt(x[0],!1),me=cf(o["cell-range-address"]);var G={Name:o.name,Ref:me[0]+"!"+me[1]};ie&&(G.Sheet=h.length),re.Names.push(G);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(x[1]==="/"&&(!b||!b["string-value"])){var ue=Y9(a.slice(y,x.index));j=(j.length>0?j+`
`:"")+ue[0]}else pt(x[0],!1),y=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{me=cf(pt(x[0])["target-range-address"]),f[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(z=pt(x[0],!1),!z.href)break;z.Target=Ut(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(me=cf(z.Target.slice(1)),z.Target="#"+me[0]+"!"+me[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var L={Sheets:f,SheetNames:h,Workbook:re};return r.bookSheets&&delete L.Sheets,L}function fb(e,t){t=t||{},ka(e,"META-INF/manifest.xml")&&wF(Hr(e,"META-INF/manifest.xml"),t);var r=da(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=GT(ir(r),t);return ka(e,"meta.xml")&&(a.Props=FE(Hr(e,"meta.xml"))),a}function hb(e,t){return GT(e,t)}var X9=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+sc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return $r+t}})(),pb=(function(){var e=function(i){return sr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,l){var c=[];c.push('      <table:table table:name="'+sr(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,m=ra(i["!ref"]||"A1"),f=i["!merges"]||[],h=0,p=Array.isArray(i);if(i["!cols"])for(u=0;u<=m.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",g=i["!rows"]||[];for(d=0;d<m.s.r;++d)x=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;d<=m.e.r;++d){for(x=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+x+`>
`),u=0;u<m.s.c;++u)c.push(t);for(;u<=m.e.c;++u){var b=!1,j={},y="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>u)&&!(f[h].s.r>d)&&!(f[h].e.c<u)&&!(f[h].e.r<d)){(f[h].s.c!=u||f[h].s.r!=d)&&(b=!0),j["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,j["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(b){c.push(r);continue}var w=mt({r:d,c:u}),S=p?(i[d]||[])[u]:i[w];if(S&&S.f&&(j["table:formula"]=sr(xz(S.f)),S.F&&S.F.slice(0,w.length)==w)){var N=ra(S.F);j["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,j["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":y=S.v?"TRUE":"FALSE",j["office:value-type"]="boolean",j["office:boolean-value"]=S.v?"true":"false";break;case"n":y=S.w||String(S.v||0),j["office:value-type"]="float",j["office:value"]=S.v||0;break;case"s":case"str":y=S.v==null?"":S.v,j["office:value-type"]="string";break;case"d":y=S.w||hr(S.v).toISOString(),j["office:value-type"]="date",j["office:date-value"]=hr(S.v).toISOString(),j["table:style-name"]="ce1";break;default:c.push(t);continue}var E=e(y);if(S.l&&S.l.Target){var P=S.l.Target;P=P.charAt(0)=="#"?"#"+gz(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),E=Be("text:a",E,{"xlink:href":P.replace(/&/g,"&amp;")})}c.push("          "+Be("table:table-cell",Be("text:p",E,{}),j)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var m=d["!cols"][u];if(m.width==null&&m.wpx==null&&m.wch==null)continue;oi(m),m.ods=l;var f=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var m=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[$r],d=sc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=sc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(RE().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)c.push(a(o.Sheets[o.SheetNames[m]],o,m));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function qT(e,t){if(t.bookType=="fods")return pb(e,t);var r=ag(),a="",n=[],i=[];return a="mimetype",Ct(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Ct(r,a,pb(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Ct(r,a,X9(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Ct(r,a,$r+RE()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Ct(r,a,EF(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Ct(r,a,NF(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function eo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Wp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ir(hi(e))}function J9(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ca(ln(e))}function Z9(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function ci(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function xb(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Q9(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function eW(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function uc(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Zt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Or(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Gt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=uc(e,r),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=uc(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var d={data:l,type:i};t[n]==null?t[n]=[d]:t[n].push(d)}return t}function ps(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Zt(a*8+n.type)),n.type==2&&t.push(Zt(n.data.length)),t.push(n.data))})}),ci(t)}function Dg(e,t){return e?.map(function(r){return t(r.data)})||[]}function Ta(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=uc(e,a),i=Gt(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:Or(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Gt(l.data),d=Or(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=Or(i[3][0].data)>>>0>0),r.push(o)}return r}function No(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Zt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Zt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Zt(o.data.length)}],a[2].push({data:ps(o.meta),type:2})});var i=ps(a);t.push(Zt(i.length)),t.push(i),n.forEach(function(o){return t.push(o)})}),ci(t)}function tW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=uc(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[ci(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(n.push(n[0].slice(-c)),d-=c;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-c,-c+d))}}var u=ci(n);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function Ca(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(tW(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ci(t)}function So(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Zt(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return ci(t)}function rW(e,t,r,a){var n=eo(e),i=n.getUint32(4,!0),o=(a>1?12:8)+xb(i&(a>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(l=n.getUint32(o,!0),o+=4),o+=xb(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(o,!0),o+=4),i&32&&(d=n.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:u};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(c>-1)m={t:"s",v:t[c]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function sW(e,t,r){var a=eo(e),n=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);n&1&&(c=Q9(e,i),i+=16),n&2&&(d=a.getFloat64(i,!0),i+=8),n&4&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(l=a.getUint32(i,!0),i+=4),n&16&&(o=a.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:c};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:u};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return m}function uf(e,t){var r=new Uint8Array(32),a=eo(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,eW(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function mf(e,t){var r=new Uint8Array(32),a=eo(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function aW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return rW(e,t,r,e[0]);case 5:return sW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function As(e){var t=Gt(e);return uc(t[1][0].data)}function gb(e,t){var r=Gt(t.data),a=Or(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(o){var l=Gt(o.data),c=Or(l[1][0].data)>>>0;switch(a){case 1:i[c]=Wp(l[3][0].data);break;case 8:{var d=e[As(l[9][0].data)][0],u=Gt(d.data),m=e[As(u[1][0].data)][0],f=Or(m.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=Gt(m.data);i[c]=h[3].map(function(p){return Wp(p.data)}).join("")}break}}),i}function nW(e,t){var r,a,n,i,o,l,c,d,u,m,f,h,p,x,g=Gt(e),b=Or(g[1][0].data)>>>0,j=Or(g[2][0].data)>>>0,y=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&Or(g[8][0].data)>0||!1,w,S;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&t!=0)w=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,S=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((m=(u=g[4])==null?void 0:u[0])!=null&&m.data&&t!=1)w=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,S=(x=(p=g[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=y?4:1,E=eo(w),P=[],T=0;T<w.length/2;++T){var O=E.getUint16(T*2,!0);O<65535&&P.push([T,O])}if(P.length!=j)throw"Expected ".concat(j," cells, found ").concat(P.length);var _=[];for(T=0;T<P.length-1;++T)_[P[T][0]]=S.subarray(P[T][1]*N,P[T+1][1]*N);return P.length>=1&&(_[P[P.length-1][0]]=S.subarray(P[P.length-1][1]*N)),{R:b,cells:_}}function iW(e,t){var r,a=Gt(t.data),n=(r=a?.[7])!=null&&r[0]?Or(a[7][0].data)>>>0>0?1:0:-1,i=Dg(a[5],function(o){return nW(o,n)});return{nrows:Or(a[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function oW(e,t,r){var a,n=Gt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Or(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Or(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Tt(i);var o=Gt(n[4][0].data),l=gb(e,e[As(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?gb(e,e[As(o[17][0].data)][0]):[],d=Gt(o[3][0].data),u=0;d[1].forEach(function(m){var f=Gt(m.data),h=e[As(f[2][0].data)][0],p=Or(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=iW(e,h);x.data.forEach(function(g,b){g.forEach(function(j,y){var w=mt({r:u+b,c:y}),S=aW(j,l,c);S&&(r[w]=S)})}),u+=x.nrows})}function lW(e,t){var r=Gt(t.data),a={"!ref":"A1"},n=e[As(r[2][0].data)],i=Or(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return oW(e,n[0],a),a}function cW(e,t){var r,a=Gt(t.data),n={name:(r=a[1])!=null&&r[0]?Wp(a[1][0].data):"",sheets:[]},i=Dg(a[2],As);return i.forEach(function(o){e[o].forEach(function(l){var c=Or(l.meta[1][0].data);c==6e3&&n.sheets.push(lW(e,l))})}),n}function dW(e,t){var r=Lg(),a=Gt(t.data),n=Dg(a[1],As);if(n.forEach(function(i){e[i].forEach(function(o){var l=Or(o.meta[1][0].data);if(l==2){var c=cW(e,o);c.sheets.forEach(function(d,u){Mg(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ff(e){var t,r,a,n,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=Ca(c.content)}catch(m){return console.log("?? "+c.content.length+" "+(m.message||m))}var u;try{u=Ta(d)}catch(m){return console.log("## "+(m.message||m))}u.forEach(function(m){i[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((n=(a=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Or(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var u=Or(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return dW(i,l)}function uW(e,t,r){var a,n,i,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Or(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=eo(e[7][0].data),u=0,m=[],f=eo(e[4][0].data),h=0,p=[],x=0;x<t.length;++x){if(t[x]==null){d.setUint16(x*2,65535,!0),f.setUint16(x*2,65535);continue}d.setUint16(x*2,u,!0),f.setUint16(x*2,h,!0);var g,b;switch(typeof t[x]){case"string":g=uf({t:"s",v:t[x]},r),b=mf({t:"s",v:t[x]},r);break;case"number":g=uf({t:"n",v:t[x]},r),b=mf({t:"n",v:t[x]},r);break;case"boolean":g=uf({t:"b",v:t[x]},r),b=mf({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}m.push(g),u+=g.length,p.push(b),h+=b.length,++c}for(e[2][0].data=Zt(c);x<e[7][0].data.length/2;++x)d.setUint16(x*2,65535,!0),f.setUint16(x*2,65535,!0);return e[6][0].data=ci(m),e[3][0].data=ci(p),c}function mW(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=ra(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Tt(a)));var i=uu(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(D){return D.forEach(function(I){typeof I=="string"&&o.push(I)})});var l={},c=[],d=lt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(D,I){return[D,d.FullPaths[I]]}).forEach(function(D){var I=D[0],V=D[1];if(I.type==2&&I.name.match(/\.iwa/)){var ie=I.content,se=Ca(ie),ae=Ta(se);ae.forEach(function(K){c.push(K.id),l[K.id]={deps:[],location:V,type:Or(K.messages[0].meta[1][0].data)}})}}),c.sort(function(D,I){return D-I});var u=c.filter(function(D){return D>1}).map(function(D){return[D,Zt(D)]});d.FileIndex.map(function(D,I){return[D,d.FullPaths[I]]}).forEach(function(D){var I=D[0];if(D[1],!!I.name.match(/\.iwa/)){var V=Ta(Ca(I.content));V.forEach(function(ie){ie.messages.forEach(function(se){u.forEach(function(ae){ie.messages.some(function(K){return Or(K.meta[1][0].data)!=11006&&Z9(K.data,ae[1])})&&l[ae[0]].deps.push(ie.id)})})})}});for(var m=lt.find(d,l[1].location),f=Ta(Ca(m.content)),h,p=0;p<f.length;++p){var x=f[p];x.id==1&&(h=x)}var g=As(Gt(h.messages[0].data)[1][0].data);for(m=lt.find(d,l[g].location),f=Ta(Ca(m.content)),p=0;p<f.length;++p)x=f[p],x.id==g&&(h=x);for(g=As(Gt(h.messages[0].data)[2][0].data),m=lt.find(d,l[g].location),f=Ta(Ca(m.content)),p=0;p<f.length;++p)x=f[p],x.id==g&&(h=x);for(g=As(Gt(h.messages[0].data)[2][0].data),m=lt.find(d,l[g].location),f=Ta(Ca(m.content)),p=0;p<f.length;++p)x=f[p],x.id==g&&(h=x);var b=Gt(h.messages[0].data);{b[6][0].data=Zt(a.e.r+1),b[7][0].data=Zt(a.e.c+1);var j=As(b[46][0].data),y=lt.find(d,l[j].location),w=Ta(Ca(y.content));{for(var S=0;S<w.length&&w[S].id!=j;++S);if(w[S].id!=j)throw"Bad ColumnRowUIDMapArchive";var N=Gt(w[S].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var E=0;E<=a.e.c;++E){var P=[];P[1]=P[2]=[{type:0,data:Zt(E+420690)}],N[1].push({type:2,data:ps(P)}),N[2].push({type:0,data:Zt(E)}),N[3].push({type:0,data:Zt(E)})}N[4]=[],N[5]=[],N[6]=[];for(var T=0;T<=a.e.r;++T)P=[],P[1]=P[2]=[{type:0,data:Zt(T+726270)}],N[4].push({type:2,data:ps(P)}),N[5].push({type:0,data:Zt(T)}),N[6].push({type:0,data:Zt(T)});w[S].messages[0].data=ps(N)}y.content=So(No(w)),y.size=y.content.length,delete b[46];var O=Gt(b[4][0].data);{O[7][0].data=Zt(a.e.r+1);var _=Gt(O[1][0].data),C=As(_[2][0].data);y=lt.find(d,l[C].location),w=Ta(Ca(y.content));{if(w[0].id!=C)throw"Bad HeaderStorageBucket";var R=Gt(w[0].messages[0].data);for(T=0;T<i.length;++T){var M=Gt(R[2][0].data);M[1][0].data=Zt(T),M[4][0].data=Zt(i[T].length),R[2][T]={type:R[2][0].type,data:ps(M)}}w[0].messages[0].data=ps(R)}y.content=So(No(w)),y.size=y.content.length;var U=As(O[2][0].data);y=lt.find(d,l[U].location),w=Ta(Ca(y.content));{if(w[0].id!=U)throw"Bad HeaderStorageBucket";for(R=Gt(w[0].messages[0].data),E=0;E<=a.e.c;++E)M=Gt(R[2][0].data),M[1][0].data=Zt(E),M[4][0].data=Zt(a.e.r+1),R[2][E]={type:R[2][0].type,data:ps(M)};w[0].messages[0].data=ps(R)}y.content=So(No(w)),y.size=y.content.length;var Z=As(O[4][0].data);(function(){for(var D=lt.find(d,l[Z].location),I=Ta(Ca(D.content)),V,ie=0;ie<I.length;++ie){var se=I[ie];se.id==Z&&(V=se)}var ae=Gt(V.messages[0].data);{ae[3]=[];var K=[];o.forEach(function(L,Ne){K[1]=[{type:0,data:Zt(Ne)}],K[2]=[{type:0,data:Zt(1)}],K[3]=[{type:2,data:J9(L)}],ae[3].push({type:2,data:ps(K)})})}V.messages[0].data=ps(ae);var G=No(I),ue=So(G);D.content=ue,D.size=D.content.length})();var ee=Gt(O[3][0].data);{var re=ee[1][0];delete ee[2];var z=Gt(re.data);{var me=As(z[2][0].data);(function(){for(var D=lt.find(d,l[me].location),I=Ta(Ca(D.content)),V,ie=0;ie<I.length;++ie){var se=I[ie];se.id==me&&(V=se)}var ae=Gt(V.messages[0].data);{delete ae[6],delete ee[7];var K=new Uint8Array(ae[5][0].data);ae[5]=[];for(var G=0,ue=0;ue<=a.e.r;++ue){var L=Gt(K);G+=uW(L,i[ue],o),L[1][0].data=Zt(ue),ae[5].push({data:ps(L),type:2})}ae[1]=[{type:0,data:Zt(a.e.c+1)}],ae[2]=[{type:0,data:Zt(a.e.r+1)}],ae[3]=[{type:0,data:Zt(G)}],ae[4]=[{type:0,data:Zt(a.e.r+1)}]}V.messages[0].data=ps(ae);var Ne=No(I),Oe=So(Ne);D.content=Oe,D.size=D.content.length})()}re.data=ps(z)}O[3][0].data=ps(ee)}b[4][0].data=ps(O)}h.messages[0].data=ps(b);var ne=No(f),A=So(ne);return m.content=A,m.size=m.content.length,d}function KT(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Ig(e){KT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Og(e){KT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function fW(e){return It.WS.indexOf(e)>-1?"sheet":e==It.CS?"chart":e==It.DS?"dialog":e==It.MS?"macro":e&&e.length?e:"sheet"}function hW(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,fW(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function pW(e,t,r,a,n,i,o,l,c,d,u,m){try{i[a]=Ul(da(e,r,!0),t);var f=Hr(e,t),h;switch(l){case"sheet":h=LU(f,t,n,c,i[a],d,u,m);break;case"chart":if(h=MU(f,t,n,c,i[a],d,u,m),!h||!h["!drawel"])break;var p=Rl(h["!drawel"].Target,t),x=nc(p),g=SB(da(e,p,!0),Ul(da(e,x,!0),p)),b=Rl(g,p),j=nc(b);h=uU(da(e,b,!0),b,c,Ul(da(e,j,!0),b),d,h);break;case"macro":h=BU(f,t,n,c,i[a],d,u,m);break;case"dialog":h=zU(f,t,n,c,i[a],d,u,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[a]=h;var y=[];i&&i[a]&&Pr(i[a]).forEach(function(w){var S="";if(i[a][w].Type==It.CMNT){S=Rl(i[a][w].Target,t);var N=HU(Hr(e,S,!0),S,c);if(!N||!N.length)return;rb(h,N,!1)}i[a][w].Type==It.TCMNT&&(S=Rl(i[a][w].Target,t),y=y.concat(TB(Hr(e,S,!0),c)))}),y&&y.length&&rb(h,y,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function ja(e){return e.charAt(0)=="/"?e.slice(1):e}function xW(e,t){if(nl(),t=t||{},Ig(t),ka(e,"META-INF/manifest.xml")||ka(e,"objectdata.xml"))return fb(e,t);if(ka(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ff<"u"){if(e.FileIndex)return ff(e);var r=lt.utils.cfb_new();return Ny(e).forEach(function(M){Ct(r,M,C6(e,M))}),ff(r)}throw new Error("Unsupported NUMBERS file")}if(!ka(e,"[Content_Types].xml"))throw ka(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ka(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Ny(e),n=bF(da(e,"[Content_Types].xml")),i=!1,o,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",Hr(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!Hr(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(Wl=[],n.sst)try{Wl=WU(Hr(e,ja(n.sst)),n.sst,t)}catch(M){if(t.WTF)throw M}t.cellStyles&&n.themes.length&&(c=UU(da(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(d=$U(Hr(e,ja(n.style)),n.style,c,t))}n.links.map(function(M){try{var U=Ul(da(e,nc(ja(M))),M);return GU(Hr(e,ja(M)),U,M,t)}catch{}});var u=FU(Hr(e,ja(n.workbooks[0])),n.workbooks[0],t),m={},f="";n.coreprops.length&&(f=Hr(e,ja(n.coreprops[0]),!0),f&&(m=FE(f)),n.extprops.length!==0&&(f=Hr(e,ja(n.extprops[0]),!0),f&&CF(f,m,t)));var h={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(f=da(e,ja(n.custprops[0]),!0),f&&(h=_F(f,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(U){return U.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(p.Props=m,p.Custprops=h),t.bookSheets&&typeof o<"u"&&(p.SheetNames=o),t.bookSheets?p.SheetNames:t.bookProps))return p;o={};var x={};t.bookDeps&&n.calcchain&&(x=VU(Hr(e,ja(n.calcchain)),n.calcchain));var g=0,b={},j,y;{var w=u.Sheets;m.Worksheets=w.length,m.SheetNames=[];for(var S=0;S!=w.length;++S)m.SheetNames[S]=w[S].name}var N=i?"bin":"xml",E=n.workbooks[0].lastIndexOf("/"),P=(n.workbooks[0].slice(0,E+1)+"_rels/"+n.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");ka(e,P)||(P="xl/_rels/workbook."+N+".rels");var T=Ul(da(e,P,!0),P.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=qU(Hr(e,ja(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=AB(Hr(e,ja(n.people[0])),t)),T&&(T=hW(T,u.Sheets));var O=Hr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=m.Worksheets;++g){var _="sheet";if(T&&T[g]?(j="xl/"+T[g][1].replace(/[\/]?xl\//,""),ka(e,j)||(j=T[g][1]),ka(e,j)||(j=P.replace(/_rels\/.*$/,"")+T[g][1]),_=T[g][2]):(j="xl/worksheets/sheet"+(g+1-O)+"."+N,j=j.replace(/sheet0\./,"sheet.")),y=j.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(m.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,R=0;R!=t.sheets.length;++R)typeof t.sheets[R]=="number"&&t.sheets[R]==g&&(C=1),typeof t.sheets[R]=="string"&&t.sheets[R].toLowerCase()==m.SheetNames[g].toLowerCase()&&(C=1);if(!C)continue e}}pW(e,j,y,m.SheetNames[g],g,b,o,_,t,u,c,d)}return p={Directory:n,Workbook:u,Props:m,Custprops:h,Deps:x,Sheets:o,SheetNames:m.SheetNames,Strings:Wl,Styles:d,Themes:c,SSF:pr(ut)},t&&t.bookFiles&&(e.files?(p.keys=a,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(M,U){M=M.replace(/^Root Entry[\/]/,""),p.keys.push(M),p.files[M]=e.FileIndex[U]}))),t&&t.bookVBA&&(n.vba.length>0?p.vbaraw=Hr(e,ja(n.vba[0]),!0):n.defaults&&n.defaults.bin===FB&&(p.vbaraw=Hr(e,"xl/vbaProject.bin",!0))),p}function gW(e,t){var r=t||{},a="Workbook",n=lt.find(e,a);try{if(a="/!DataSpaces/Version",n=lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(q8(n.content),a="/!DataSpaces/DataSpaceMap",n=lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Y8(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=X8(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);Z8(n.content)}catch{}if(a="/EncryptionInfo",n=lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=Q8(n.content);if(a="/EncryptedPackage",n=lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function vW(e,t){return t.bookType=="ods"?qT(e,t):t.bookType=="numbers"?mW(e,t):t.bookType=="xlsb"?yW(e,t):bW(e,t)}function yW(e,t){Ao=1024,e&&!e.SSF&&(e.SSF=pr(ut)),e&&e.SSF&&(nl(),om(e.SSF),t.revssf=cm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=jT.indexOf(t.bookType)>-1,n=vg();Og(t=t||{});var i=ag(),o="",l=0;if(t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ct(i,o,LE(e.Props,t)),n.coreprops.push(o),Qt(t.rels,2,o,It.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ct(i,o,zE(e.Props)),n.extprops.push(o),Qt(t.rels,3,o,It.EXT_PROPS),e.Custprops!==e.Props&&Pr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ct(i,o,$E(e.Custprops)),n.custprops.push(o),Qt(t.rels,4,o,It.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ct(i,o,YU(l-1,o,t,e,u)),n.sheets.push(o),Qt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,It.WS[0])}if(m){var h=m["!comments"],p=!1,x="";h&&h.length>0&&(x="xl/comments"+l+"."+r,Ct(i,x,ZU(h,x)),n.comments.push(x),Qt(u,-1,"../comments"+l+"."+r,It.CMNT),p=!0),m["!legacy"]&&p&&Ct(i,"xl/drawings/vmlDrawing"+l+".vml",yT(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}u["!id"].rId1&&Ct(i,nc(o),Do(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ct(i,o,JU(t.Strings,o,t)),n.strs.push(o),Qt(t.wbrels,-1,"sharedStrings."+r,It.SST)),o="xl/workbook."+r,Ct(i,o,KU(e,o)),n.workbooks.push(o),Qt(t.rels,1,o,It.WB),o="xl/theme/theme1.xml",Ct(i,o,Sg(e.Themes,t)),n.themes.push(o),Qt(t.wbrels,-1,"theme/theme1.xml",It.THEME),o="xl/styles."+r,Ct(i,o,XU(e,o,t)),n.styles.push(o),Qt(t.wbrels,-1,"styles."+r,It.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ct(i,o,e.vbaraw),n.vba.push(o),Qt(t.wbrels,-1,"vbaProject.bin",It.VBA)),o="xl/metadata."+r,Ct(i,o,QU(o)),n.metadata.push(o),Qt(t.wbrels,-1,"metadata."+r,It.XLMETA),Ct(i,"[Content_Types].xml",PE(n,t)),Ct(i,"_rels/.rels",Do(t.rels)),Ct(i,"xl/_rels/workbook."+r+".rels",Do(t.wbrels)),delete t.revssf,delete t.ssf,i}function bW(e,t){Ao=1024,e&&!e.SSF&&(e.SSF=pr(ut)),e&&e.SSF&&(nl(),om(e.SSF),t.revssf=cm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=jT.indexOf(t.bookType)>-1,n=vg();Og(t=t||{});var i=ag(),o="",l=0;if(t.cellXfs=[],xi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ct(i,o,LE(e.Props,t)),n.coreprops.push(o),Qt(t.rels,2,o,It.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ct(i,o,zE(e.Props)),n.extprops.push(o),Qt(t.rels,3,o,It.EXT_PROPS),e.Custprops!==e.Props&&Pr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ct(i,o,$E(e.Custprops)),n.custprops.push(o),Qt(t.rels,4,o,It.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ct(i,o,IT(l-1,t,e,m)),n.sheets.push(o),Qt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,It.WS[0])}if(f){var p=f["!comments"],x=!1,g="";if(p&&p.length>0){var b=!1;p.forEach(function(j){j[1].forEach(function(y){y.T==!0&&(b=!0)})}),b&&(g="xl/threadedComments/threadedComment"+l+"."+r,Ct(i,g,CB(p,u,t)),n.threadedcomments.push(g),Qt(m,-1,"../threadedComments/threadedComment"+l+"."+r,It.TCMNT)),g="xl/comments"+l+"."+r,Ct(i,g,bT(p)),n.comments.push(g),Qt(m,-1,"../comments"+l+"."+r,It.CMNT),x=!0}f["!legacy"]&&x&&Ct(i,"xl/drawings/vmlDrawing"+l+".vml",yT(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&Ct(i,nc(o),Do(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ct(i,o,oT(t.Strings,t)),n.strs.push(o),Qt(t.wbrels,-1,"sharedStrings."+r,It.SST)),o="xl/workbook."+r,Ct(i,o,LT(e)),n.workbooks.push(o),Qt(t.rels,1,o,It.WB),o="xl/theme/theme1.xml",Ct(i,o,Sg(e.Themes,t)),n.themes.push(o),Qt(t.wbrels,-1,"theme/theme1.xml",It.THEME),o="xl/styles."+r,Ct(i,o,pT(e,t)),n.styles.push(o),Qt(t.wbrels,-1,"styles."+r,It.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ct(i,o,e.vbaraw),n.vba.push(o),Qt(t.wbrels,-1,"vbaProject.bin",It.VBA)),o="xl/metadata."+r,Ct(i,o,vT()),n.metadata.push(o),Qt(t.wbrels,-1,"metadata."+r,It.XLMETA),u.length>1&&(o="xl/persons/person.xml",Ct(i,o,_B(u)),n.people.push(o),Qt(t.wbrels,-1,"persons/person.xml",It.PEOPLE)),Ct(i,"[Content_Types].xml",PE(n,t)),Ct(i,"_rels/.rels",Do(t.rels)),Ct(i,"xl/_rels/workbook."+r+".rels",Do(t.wbrels)),delete t.revssf,delete t.ssf,i}function Pg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=pa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function jW(e,t){return lt.find(e,"EncryptedPackage")?gW(e,t):$T(e,t)}function wW(e,t){var r,a=e,n=t||{};return n.type||(n.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r=cE(a,n),xW(r,n)}function YT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return $p(e.slice(r),t);default:break e}return $o.to_workbook(e,t)}function NW(e,t){var r="",a=Pg(e,t);switch(t.type){case"base64":r=pa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Xi(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=ir(r)),t.type="binary",YT(r,t)}function SW(e,t){var r=e;return t.type=="base64"&&(r=pa(r)),r=Ql.utils.decode(1200,r.slice(2),"str"),t.type="binary",YT(r,t)}function EW(e){return e.match(/[^\x00-\x7F]/)?ln(e):e}function hf(e,t,r,a){return a?(r.type="string",$o.to_workbook(e,r)):$o.to_workbook(t,r)}function mc(e,t){Qx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return mc(new Uint8Array(e),(r=pr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Oo={},r.dateNF&&(Oo.dateNF=r.dateNF),r.type||(r.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=kt?"buffer":"binary",a=y6(e),typeof Uint8Array<"u"&&!kt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=EW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=pr(r),r.type="array",mc(eg(a),r)}switch((n=Pg(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return jW(lt.read(a,r),r);break;case 9:if(n[1]<=8)return $T(a,r);break;case 60:return $p(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return k8(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return nT.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?wW(a,r):hf(e,a,r,i);case 239:return n[3]===60?$p(a,r):hf(e,a,r,i);case 255:if(n[1]===254)return SW(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Bi.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Bi.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return zp.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return mT.to_workbook(a,r);break;case 10:case 13:case 32:return NW(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _8.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?zp.to_workbook(a,r):hf(e,a,r,i)}function XT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Dc(t.file,lt.write(e,{type:kt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return lt.write(e,t)}function TW(e,t){var r=pr(t||{}),a=vW(e,r);return CW(a,r)}function CW(e,t){var r={},a=kt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?lt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(im(n))}return t.password&&typeof encrypt_agile<"u"?XT(encrypt_agile(n,t.password),t):t.type==="file"?Dc(t.file,n):t.type=="string"?ir(n):n}function AW(e,t){var r=t||{},a=E9(e,r);return XT(a,r)}function nn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return ec(ln(a));case"binary":return ln(a);case"string":return e;case"file":return Dc(t.file,a,"utf8");case"buffer":return kt?Ln(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):nn(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function _W(e,t){switch(t.type){case"base64":return ec(e);case"binary":return e;case"string":return e;case"file":return Dc(t.file,e,"binary");case"buffer":return kt?Ln(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function yd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?ec(r):t.type=="string"?ir(r):r;case"file":return Dc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function JT(e,t){Qx(),jU(e);var r=pr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=JT(e,r);return r.type="array",im(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return nn(v9(e,r),r);case"slk":case"sylk":return nn(aT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return nn(WT(e.Sheets[e.SheetNames[n]],r),r);case"txt":return _W(ZT(e.Sheets[e.SheetNames[n]],r),r);case"csv":return nn(Fg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return nn(nT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return yd(zp.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return nn($o.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return nn(mT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return nn(iT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return nn(qT(e,r),r);case"wk1":return yd(Bi.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return yd(Bi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),yd(UT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),AW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return TW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kW(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Rg(e,t,r){var a=r||{};return a.type="file",a.file=t,kW(a),JT(e,a)}function DW(e,t,r,a,n,i,o,l){var c=Br(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var p=o?e[r][h]:e[a[h]+c];if(p===void 0||p.t===void 0){if(d===void 0)continue;i[h]!=null&&(f[i[h]]=d);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[h]!=null){if(x==null)if(p.t=="e"&&x===null)f[i[h]]=null;else if(d!==void 0)f[i[h]]=d;else if(u&&x===null)f[i[h]]=null;else continue;else f[i[h]]=u&&(p.t!=="n"||p.t==="n"&&l.rawNumbers!==!1)?x:Dn(p,x,l);x!=null&&(m=!1)}}return{row:f,isempty:m}}function uu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof u){case"string":c=Wt(u);break;case"number":c=Wt(e["!ref"]),c.s.r=u;break;default:c=u}a>0&&(n=0);var m=Br(c.s.r),f=[],h=[],p=0,x=0,g=Array.isArray(e),b=c.s.r,j=0,y={};g&&!e[b]&&(e[b]=[]);var w=d.skipHidden&&e["!cols"]||[],S=d.skipHidden&&e["!rows"]||[];for(j=c.s.c;j<=c.e.c;++j)if(!(w[j]||{}).hidden)switch(f[j]=Er(j),r=g?e[b][j]:e[f[j]+m],a){case 1:i[j]=j-c.s.c;break;case 2:i[j]=f[j];break;case 3:i[j]=d.header[j-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Dn(r,null,d),x=y[o]||0,!x)y[o]=1;else{do l=o+"_"+x++;while(y[l]);y[o]=x,y[l]=1}i[j]=l}for(b=c.s.r+n;b<=c.e.r;++b)if(!(S[b]||{}).hidden){var N=DW(e,c,b,f,a,i,g,d);(N.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(h[p++]=N.row)}return h.length=p,h}var vb=/"/g;function IW(e,t,r,a,n,i,o,l){for(var c=!0,d=[],u="",m=Br(r),f=t.s.c;f<=t.e.c;++f)if(a[f]){var h=l.dense?(e[r]||[])[f]:e[a[f]+m];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:Dn(h,null,l));for(var p=0,x=0;p!==u.length;++p)if((x=u.charCodeAt(p))===n||x===i||x===34||l.forceQuotes){u='"'+u.replace(vb,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(vb,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function Fg(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Wt(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",m=[];a.dense=Array.isArray(e);for(var f=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(f[p]||{}).hidden||(m[p]=Er(p));for(var x=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||(u=IW(e,n,g,m,o,c,i,a),u!=null&&(a.strip&&(u=u.replace(d,"")),(u||a.blankrows!==!1)&&r.push((x++?l:"")+u)));return delete a.dense,r.join("")}function ZT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Fg(e,t);return r}function OW(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Wt(e["!ref"]),i="",o=[],l,c=[],d=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=Er(l);for(var u=n.s.r;u<=n.e.r;++u)for(i=Br(u),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+i,r=d?(e[u]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function QT(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Tr(a.origin):a.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var m=Wt(i["!ref"]);u.e.c=Math.max(u.e.c,m.e.c),u.e.r=Math.max(u.e.r,m.e.r),o==-1&&(o=m.e.r+1,u.e.r=o+t.length-1+n)}else o==-1&&(o=0,u.e.r=t.length-1+n);var f=a.header||[],h=0;t.forEach(function(x,g){Pr(x).forEach(function(b){(h=f.indexOf(b))==-1&&(f[h=f.length]=b);var j=x[b],y="z",w="",S=mt({c:l+h,r:o+g+n});d=fc(i,S),j&&typeof j=="object"&&!(j instanceof Date)?i[S]=j:(typeof j=="number"?y="n":typeof j=="boolean"?y="b":typeof j=="string"?y="s":j instanceof Date?(y="d",a.cellDates||(y="n",j=es(j)),w=a.dateNF||ut[14]):j===null&&a.nullError&&(y="e",j=0),d?(d.t=y,d.v=j,delete d.w,delete d.R,w&&(d.z=w)):i[S]=d={t:y,v:j},w&&(d.z=w))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var p=Br(o);if(n)for(h=0;h<f.length;++h)i[Er(h+l)+p]={t:"s",v:f[h]};return i["!ref"]=Tt(u),i}function PW(e,t){return QT(null,e,t)}function fc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Tr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?fc(e,mt(t)):fc(e,mt({r:t,c:r||0}))}function RW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Lg(){return{SheetNames:[],Sheets:{}}}function Mg(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(FT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function FW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=RW(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function LW(e,t){return e.z=t,e}function eC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function MW(e,t,r){return eC(e,"#"+t,r)}function BW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function zW(e,t,r,a){for(var n=typeof t!="string"?t:Wt(t),i=typeof t=="string"?t:Tt(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=fc(e,o,l);c.t="n",c.F=i,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var Oa={encode_col:Er,encode_row:Br,encode_cell:mt,encode_range:Tt,decode_col:mg,decode_row:ug,split_cell:J6,decode_cell:Tr,decode_range:ra,format_cell:Dn,sheet_add_aoa:CE,sheet_add_json:QT,sheet_add_dom:HT,aoa_to_sheet:il,json_to_sheet:PW,table_to_sheet:VT,table_to_book:q9,sheet_to_csv:Fg,sheet_to_txt:ZT,sheet_to_json:uu,sheet_to_html:WT,sheet_to_formulae:OW,sheet_to_row_object_array:uu,sheet_get_cell:fc,book_new:Lg,book_append_sheet:Mg,book_set_sheet_visibility:FW,cell_set_number_format:LW,cell_set_hyperlink:eC,cell_set_internal_link:MW,cell_add_comment:BW,sheet_set_array_formula:zW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const $W=({show:e,onClose:t,onImport:r,loading:a=!1})=>{const[n,i]=v.useState(!1),[o,l]=v.useState(null),[c,d]=v.useState([]),[u,m]=v.useState([]),[f,h]=v.useState([]),[p,x]=v.useState([]),[g,b]=v.useState(!1),j=v.useRef(null),y=["first_name","last_name","email","role"],w=["first_name","middle_name","last_name","address","email","phone_number","avatar_url","gender","role","certification_number","specialization","years_of_experience","bio","date_of_birth","enrollment_date","training_batch","passport_no","nation"];v.useEffect(()=>{e&&S()},[e]);const S=async()=>{try{b(!0);const A=await Cs.getPublicRoles();console.log(" Roles fetched from public API:",{rolesCount:A.length,roles:A.map(D=>({id:D.id,name:D.name}))}),x(A)}catch(A){console.error("Failed to fetch roles:",A),m(["Failed to load roles. Please refresh the page."]),x([])}finally{b(!1)}},N=A=>{if(!A)return"";try{return decodeURIComponent(escape(A)).trim()}catch{return A.toString().trim()}},E=A=>{if(!A)return"";try{let D;if(A instanceof Date)D=A;else{const V=A.toString().trim();if(!V||V===""||V==="null"||V==="undefined")return"";if(V.includes("/")){const ie=V.split("/");ie.length===3&&(D=new Date(ie[2],ie[0]-1,ie[1]))}else if(V.includes("-")){const ie=V.split("-");ie.length===3&&(ie[0].length===4?D=new Date(ie[0],ie[1]-1,ie[2]):D=new Date(ie[2],ie[1]-1,ie[0]))}else D=new Date(V)}if(isNaN(D.getTime()))return"";const I=D.getFullYear();return I<1900||I>2100?"":D.toISOString()}catch(D){return console.error("Error formatting date:",D,"Input:",A),""}},P=A=>{if(!A)return"MALE";const D=A.toString().toUpperCase().trim();return D==="MALE"||D==="FEMALE"?D:{M:"MALE",F:"FEMALE"}[D]||"MALE"},T=A=>{if(!A)return null;const D=A.toString().toUpperCase().trim();return["MALE","FEMALE","M","F"].includes(D)?null:"Invalid gender value. Accepted values: MALE, FEMALE, M, F"},O=A=>A?A.toString().toUpperCase().trim().replace(/\s+/g,"_"):"",_=A=>{if(!A||!p.length)return console.warn(" findRoleId: No roleName or roles not loaded",{roleName:A,rolesCount:p.length}),null;const D=O(A);console.log(" Finding role:",{input:A,normalized:D,availableRoles:p.map(ae=>({name:ae.name,normalized:O(ae.name),id:ae.id}))});const I=p.find(ae=>{const K=O(ae.name),G=K===D;return G&&console.log(" Direct match:",{input:A,inputNormalized:D,dbRole:ae.name,dbRoleNormalized:K,match:G}),G});if(I)return console.log(" Direct match found:",I.name,I.id),I.id;console.log(" Direct match failed, checking normalization..."),p.forEach(ae=>{const K=O(ae.name);K===D&&console.log(" Found potential match:",{input:A,inputNormalized:D,dbRole:ae.name,dbRoleNormalized:K,match:K===D})});const ie={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE"}[D];if(ie){const ae=p.find(K=>O(K.name)===ie);if(ae)return console.log(" Partial match found:",ae.name,ae.id),ae.id}const se=p.find(ae=>{const K=O(ae.name),G=K.includes(D)||D.includes(K);return G&&console.log(" Fuzzy match candidate:",{input:A,inputNormalized:D,dbRole:ae.name,dbRoleNormalized:K}),G});return se?(console.log(" Fuzzy match found:",se.name,se.id),se.id):(console.warn(" No role match found for:",{input:A,normalized:D,availableRoles:p.map(ae=>({name:ae.name,normalized:O(ae.name)}))}),null)},C=A=>{if(!A||!p.length)return null;const D=O(A),I=p.find(ae=>O(ae.name)===D);if(I)return I.name;const ie={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPARTMENT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT","ACADEMIC DEPARTMENT":"ACADEMIC_DEPARTMENT"}[D];if(ie){const ae=p.find(K=>O(K.name)===ie);if(ae)return ae.name}const se=p.find(ae=>{const K=O(ae.name);return K.includes(D)||D.includes(K)});return se?se.name:null},R=()=>{const A=[w,["Trn","Th","Hoa","456 L Vn S, Qun 3, TP.HCM","tran.thi.hoa.trainer@example.com","+84 912 345 678","","FEMALE","TRAINER","CERT555","Cabin Safety","7","Hun luyn vin Cabin Safety vi 7 nm kinh nghim quc t","1988-06-21","","","B987654321","Vietnam"]],D=Oa.aoa_to_sheet(A),I=Oa.book_new();Oa.book_append_sheet(I,D,"Users"),Rg(I,"User_Upload_Template.xlsx",{bookType:"xlsx",type:"binary"})},M=A=>{A.preventDefault(),A.stopPropagation(),A.type==="dragenter"||A.type==="dragover"?i(!0):A.type==="dragleave"&&i(!1)},U=A=>{A.preventDefault(),A.stopPropagation(),i(!1),A.dataTransfer.files&&A.dataTransfer.files[0]&&ee(A.dataTransfer.files[0])},Z=A=>{A.target.files&&A.target.files[0]&&ee(A.target.files[0])},ee=A=>{if(!A.name.match(/\.(xlsx|xls)$/)){m(["Please upload an Excel file (.xlsx or .xls)"]);return}if(A.size>100*1024*1024){m(["File size must be less than 100MB"]);return}if(l(A),m([]),h([]),d([]),g){h(["Roles are still loading. Please wait a moment and try again."]);return}if(p.length===0){h(["Roles are not loaded yet. Please refresh the page and try again."]);return}console.log(" Processing file with roles loaded:",{rolesCount:p.length,roles:p.map(I=>I.name)});const D=new FileReader;D.onload=I=>{try{const V=new Uint8Array(I.target.result),ie=mc(V,{type:"array",cellText:!1,cellDates:!0,raw:!1}),se=ie.SheetNames[0],ae=ie.Sheets[se],K=Oa.sheet_to_json(ae,{header:1,defval:"",raw:!1}),G=K.filter(rt=>!rt||rt.length===0?!1:rt.some(Ht=>Ht!=null&&Ht!==""&&String(Ht).trim()!==""));if(console.log(" File parsing results:",{totalRowsParsed:K.length,nonEmptyRowsFound:G.length,firstRow:K[0],sampleRows:K.slice(0,3)}),G.length<2){m(["File must contain at least a header row and one data row. Please check if your file has empty rows or formatting issues."]),console.error(" File validation failed:",{totalRows:K.length,nonEmptyRows:G.length,firstFewRows:K.slice(0,3),allRows:K});return}const ue=G[0].map(rt=>rt?rt.toString().trim().toLowerCase().replace(/\s+/g,"_"):""),L=G.slice(1).filter(rt=>rt.some(Ht=>Ht!=null&&Ht!==""&&String(Ht).trim()!==""));if(L.length===0){m(["File must contain at least one data row with content. Please check if your data rows are empty or have formatting issues."]),console.error("No valid data rows found after filtering:",{totalRows:K.length,nonEmptyRows:G.length,dataRowsAfterFilter:L.length});return}const Ne={first_name:"first_name",firstname:"first_name","first name":"first_name",middle_name:"middle_name",middlename:"middle_name","middle name":"middle_name",last_name:"last_name",lastname:"last_name","last name":"last_name",full_name:"full_name",fullname:"full_name","full name":"full_name",name:"full_name",address:"address",email:"email",phone_number:"phone_number",phonenumber:"phone_number","phone number":"phone_number",phone:"phone_number",role:"role",certification_number:"certification_number",certificationnumber:"certification_number","certification number":"certification_number",certification:"certification_number",specialization:"specialization",years_of_experience:"years_of_experience",yearsofexperience:"years_of_experience","years of experience":"years_of_experience",experience:"years_of_experience",date_of_birth:"date_of_birth",dateofbirth:"date_of_birth","date of birth":"date_of_birth",dob:"date_of_birth",training_batch:"training_batch",trainingbatch:"training_batch","training batch":"training_batch",batch:"training_batch",passport_no:"passport_no",passportno:"passport_no","passport no":"passport_no",passport:"passport_no",nation:"nation",nationality:"nation",country:"nation",gender:"gender",sex:"gender"},We=ue.map(rt=>Ne[rt]||rt).filter(rt=>w.includes(rt)),Qe=y.filter(rt=>!We.includes(rt));if(Qe.length>0){h([`Your file is missing these essential data to create a user: ${Qe.join(", ")}`]);return}p.length===0&&(console.warn(" Roles not loaded yet, validation may fail"),h([" Roles are still loading. Role validation may fail. Please wait and try again if you see role errors."]));const Pe=L.map((rt,Ht)=>{const gt={};let Ue=!1;const he=[];ue.forEach((Fe,Ye)=>{const Rt=Ne[Fe]||Fe;if(w.includes(Rt)){let Ot="";rt[Ye]!==null&&rt[Ye]!==void 0&&(typeof rt[Ye]=="string"?Ot=N(rt[Ye]):typeof rt[Ye]=="number"?Ot=rt[Ye].toString():Ot=N(rt[Ye].toString())),Rt==="gender"&&(Ot=P(Ot)),gt[Rt]=Ot}}),We.forEach(Fe=>{const Ye=gt[Fe]||"";if(y.includes(Fe)&&!Ye&&(Ue=!0,he.push("Required field missing")),Fe==="email"&&Ye&&!/\S+@\S+\.\S+/.test(Ye)&&(Ue=!0,he.push("Invalid email")),Fe==="role"&&Ye)if(p.length>0){const Rt=_(Ye);if(Rt)console.log(" Role validated successfully:",Ye,"",Rt);else{Ue=!0;const Ot=O(Ye),vt=p.map(ft=>({original:ft.name,normalized:O(ft.name)}));console.error(" Role validation failed:",{input:Ye,normalizedInput:Ot,availableRoles:p.map(ft=>ft.name),availableNormalized:vt}),he.push(`Invalid role: "${Ye}". Available roles: ${p.map(ft=>ft.name).join(", ")}`)}}else console.warn(" Roles not loaded, cannot validate role:",Ye);if(Fe==="phone_number"&&Ye&&Ye.length>15&&(Ue=!0,he.push("Phone number too long (max 15 characters)")),Fe==="years_of_experience"&&Ye&&isNaN(Ye)&&(Ue=!0,he.push("Invalid experience value")),Fe==="gender"&&Ye){const Rt=T(Ye);Rt&&(Ue=!0,he.push(Rt))}});const Me=C(gt.role);return Me==="TRAINER"?((!gt.specialization||gt.specialization.trim()==="")&&(Ue=!0,he.push("Trainer requires specialization")),(!gt.years_of_experience||gt.years_of_experience.trim()==="")&&(Ue=!0,he.push("Trainer requires years of experience"))):Me==="TRAINEE"&&(!gt.date_of_birth||gt.date_of_birth.trim()===""?(Ue=!0,he.push("Trainee requires date of birth")):E(gt.date_of_birth)||(Ue=!0,he.push(`Invalid date format for date of birth: "${gt.date_of_birth}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)),(!gt.training_batch||gt.training_batch.trim()==="")&&(Ue=!0,he.push("Trainee requires training batch")),(!gt.passport_no||gt.passport_no.trim()==="")&&(Ue=!0,he.push("Trainee requires passport number")),(!gt.nation||gt.nation.trim()==="")&&(Ue=!0,he.push("Trainee requires nation")),gt.enrollment_date&&gt.enrollment_date.trim()!==""&&(E(gt.enrollment_date)||(Ue=!0,he.push(`Invalid date format for enrollment date: "${gt.enrollment_date}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)))),{id:Ht+1,...gt,hasError:Ue,errors:he,status:Ue?"error":"valid"}});d(Pe)}catch{m(["Error reading file. Please make sure it's a valid Excel file."])}},D.readAsArrayBuffer(A)},re=async()=>{const A=c.filter(I=>!I.hasError);if(A.length===0){m(["No valid users to import"]);return}if(!p.length){m(["Roles not loaded. Please wait and try again."]);return}const D=A.map(I=>{const V=I.phone_number?I.phone_number.substring(0,15):"",ie=_(I.role),se=C(I.role);if(!ie||!se)throw new Error(`Role "${I.role}" not found in system`);const ae={firstName:I.first_name||"",middleName:I.middle_name||"",lastName:I.last_name||"",address:I.address||"",email:I.email||"",phoneNumber:V,avatarUrl:I.avatar_url||"",gender:P(I.gender),role:{id:ie,name:se}};if(se==="TRAINER")ae.trainerProfile={specialization:I.specialization||"",yearsOfExp:I.years_of_experience?parseInt(I.years_of_experience):0,certificationNumber:I.certification_number||"",bio:I.bio||""};else if(se==="TRAINEE"){const K={trainingBatch:I.training_batch||"",passportNo:I.passport_no||"",nation:I.nation||""},G=E(I.date_of_birth);G&&(K.dob=G);const ue=E(I.enrollment_date);ue?K.enrollmentDate=ue:K.enrollmentDate=new Date().toISOString(),ae.traineeProfile=K}return ae});try{await r(D),z()}catch(I){m([I.message||"Failed to import users. Please try again."])}},z=()=>{l(null),d([]),m([]),h([]),i(!1),t()},me=A=>{d(D=>D.filter(I=>I.id!==A))},ne=A=>A==="valid"?s.jsx(Je,{className:"text-success",size:16}):s.jsx(Qr,{className:"text-danger",size:16});return s.jsxs(ce,{show:e,onHide:z,size:"xl",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-2",size:20}),"Bulk Import Users"]}),s.jsx(te,{variant:"link",onClick:z,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[g&&s.jsxs("div",{className:"text-center mb-3",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",style:{width:"1.5rem",height:"1.5rem",borderWidth:"0.2em"},children:s.jsx("span",{className:"visually-hidden",children:"Loading roles..."})}),s.jsx("span",{className:"ms-2 text-muted",children:"Loading roles..."})]}),s.jsx(W,{className:"mb-4",children:s.jsxs(W.Body,{children:[s.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:M,onDragLeave:M,onDragOver:M,onDrop:U,onClick:()=>j.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Fo,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:j,type:"file",accept:".xlsx,.xls",onChange:Z,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[o&&s.jsxs("p",{className:"text-success mb-1",children:[s.jsx("strong",{children:"Uploaded file:"})," ",o.name]}),s.jsx("p",{className:"text-muted mb-0",children:"Up to 100 records per upload."}),s.jsxs("small",{className:"text-info d-block mt-1",children:[s.jsx("strong",{children:"Gender format:"})," M/F or MALE/FEMALE"]})]}),s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:R,className:"d-flex align-items-center",children:[s.jsx(fi,{className:"me-1",size:14}),"Download Template"]})]})]})}),u.length>0&&s.jsx("div",{className:"alert alert-danger mb-3",children:s.jsx("ul",{className:"mb-0",children:u.map((A,D)=>s.jsx("li",{children:A},D))})}),f.length>0&&s.jsx(De,{variant:"warning",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:f.map((A,D)=>s.jsx("li",{children:A},D))})}),c.length>0&&s.jsxs(W,{children:[s.jsx(W.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),s.jsx(W.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(ar,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"120px"},children:"FIRST NAME"}),s.jsx("th",{style:{minWidth:"120px"},children:"MIDDLE NAME"}),s.jsx("th",{style:{minWidth:"120px"},children:"LAST NAME"}),s.jsx("th",{style:{minWidth:"200px"},children:"EMAIL"}),s.jsx("th",{style:{minWidth:"120px"},children:"ROLE"}),s.jsx("th",{style:{minWidth:"150px"},children:"PHONE NUMBER"}),s.jsx("th",{style:{minWidth:"100px"},children:"GENDER"}),s.jsx("th",{style:{minWidth:"150px"},children:"CERTIFICATION"}),s.jsx("th",{style:{minWidth:"150px"},children:"SPECIALIZATION"}),s.jsx("th",{style:{minWidth:"100px"},children:"EXPERIENCE"}),s.jsx("th",{style:{minWidth:"120px"},children:"DATE OF BIRTH"}),s.jsx("th",{style:{minWidth:"120px"},children:"TRAINING BATCH"}),s.jsx("th",{style:{minWidth:"120px"},children:"PASSPORT NO"}),s.jsx("th",{style:{minWidth:"100px"},children:"NATION"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),s.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),s.jsx("tbody",{children:c.map(A=>s.jsxs("tr",{className:A.hasError?"table-danger":"",children:[s.jsx("td",{children:A.id}),s.jsx("td",{children:A.first_name||A.full_name||"-"}),s.jsx("td",{children:A.middle_name||"-"}),s.jsx("td",{children:A.last_name||"-"}),s.jsx("td",{children:A.email||"-"}),s.jsx("td",{children:A.role||"-"}),s.jsx("td",{children:A.phone_number||"-"}),s.jsx("td",{children:A.gender?s.jsx("span",{title:`Original: ${A.gender}`,children:P(A.gender)}):"-"}),s.jsx("td",{children:A.certification_number||"-"}),s.jsx("td",{children:A.specialization||"-"}),s.jsx("td",{children:A.years_of_experience||"-"}),s.jsx("td",{children:A.date_of_birth||"-"}),s.jsx("td",{children:A.training_batch||"-"}),s.jsx("td",{children:A.passport_no||"-"}),s.jsx("td",{children:A.nation||"-"}),s.jsx("td",{className:"text-center",children:ne(A.status)}),s.jsx("td",{children:A.errors.length>0&&s.jsx("small",{className:"text-danger",children:A.errors.length>1?`${A.errors[0]} (+${A.errors.length-1} more)`:A.errors[0]})}),s.jsx("td",{children:s.jsx(te,{variant:"outline-danger",size:"sm",onClick:()=>me(A.id),children:s.jsx(Fa,{size:14})})})]},A.id))})]})})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:z,disabled:a,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),c.length>0&&s.jsx(O2,{placement:"top",overlay:s.jsxs(P2,{id:"import-tooltip",children:["Only ",c.filter(A=>!A.hasError).length,"/",c.length," users will be imported into DSFMS"]}),children:s.jsx(te,{variant:"primary",onClick:re,disabled:a||c.filter(A=>!A.hasError).length===0,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:16}),"Import All (",c.filter(A=>!A.hasError).length," users)"]})})})]})]})},UW=({show:e,user:t,onConfirm:r,onCancel:a,loading:n=!1})=>{if(!t)return null;const i=t.status==="ACTIVE",o=i?"Disable":"Enable",c=i?Sc:Je;return s.jsxs(ce,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(ce.Header,{closeButton:!0,className:`border-0 ${i?"bg-warning-subtle":"bg-success-subtle"}`,children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Jt,{className:`me-2 ${i?"text-warning":"text-success"}`,size:20}),o," User"]})}),s.jsxs(ce.Body,{className:"py-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:`rounded-circle d-inline-flex align-items-center justify-content-center mb-3 ${i?"bg-warning-subtle":"bg-success-subtle"}`,style:{width:"64px",height:"64px"},children:s.jsx(c,{size:32,className:i?"text-warning":"text-success"})}),s.jsx("h5",{className:"mb-3",children:i?"Disable User Account":"Enable User Account"}),s.jsx("p",{className:"text-muted mb-4",children:i?"Are you sure you want to disable this user account? This action will:":"Are you sure you want to enable this user account? This action will:"})]}),s.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("div",{className:"me-3",children:s.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:t.fullName}),s.jsx("small",{className:"text-muted",children:t.email})]})]}),s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"EID"}),s.jsx("div",{className:"fw-medium",children:t.eid})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"Role"}),s.jsx("div",{className:"fw-medium",children:t.role})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"text-muted small",children:"Department"}),s.jsx("div",{className:"fw-medium",children:t.department})]})]})]}),i?s.jsxs(De,{variant:"warning",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" What happens when disabled:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsx("li",{children:"User cannot log into the system"}),s.jsx("li",{children:"All active sessions will be terminated"}),s.jsx("li",{children:"User data will be preserved but access restricted"}),s.jsx("li",{children:"User can be re-enabled later by an administrator"})]})]}):s.jsxs(De,{variant:"success",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" What happens when enabled:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsx("li",{children:"User can log into the system normally"}),s.jsx("li",{children:"All permissions and access will be restored"}),s.jsx("li",{children:"User will receive notification of account activation"}),s.jsx("li",{children:"Previous data and settings will be available"})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 bg-light",children:[s.jsx(te,{variant:"outline-secondary",onClick:a,disabled:n,children:"Cancel"}),s.jsx(te,{variant:i?"warning":"success",onClick:r,disabled:n,className:"d-flex align-items-center",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"me-2",size:16}),o," User"]})})]})]})},WW=({uniqueRoles:e,uniqueDepartments:t,selectedRoles:r,selectedDepartments:a,onRoleToggle:n,onDepartmentToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||a.length>0;return s.jsxs(St,{className:`filter-panel-dropdown ${l}`,children:[s.jsx(St.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(oo,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(St.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Roles"}),r.length>0&&s.jsx(te,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:s.jsx(st,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>s.jsx(k.Check,{type:"checkbox",id:`role-${d}`,label:d,checked:r.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Departments"}),a.length>0&&s.jsx(te,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(st,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>s.jsx(k.Check,{type:"checkbox",id:`dept-${d}`,label:d,checked:a.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(te,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[s.jsx(st,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},HW=({show:e,user:t,newRole:r,onConfirm:a,onCancel:n,loading:i=!1})=>{if(!t)return null;const o=d=>{switch(d){case"ADMIN":return"AD";case"ACADEMIC_DEPT":return"AC";case"DEPT_HEAD":return"DH";case"TRAINER":return"TR";case"TRAINEE":return"TN";case"SQA_AUDITOR":return"QA";default:return"EM"}},l=o(t.role),c=o(r);return s.jsxs(ce,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(ce.Header,{closeButton:!0,className:"bg-warning-subtle border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Jt,{className:"me-2 text-warning",size:20}),"Role Change Confirmation"]})}),s.jsxs(ce.Body,{className:"py-4",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"bg-warning-subtle rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"64px",height:"64px"},children:s.jsx(Jt,{size:32,className:"text-warning"})}),s.jsx("h5",{className:"mb-3",children:"Role Change Will Update EID"}),s.jsx("p",{className:"text-muted mb-4",children:"Changing the user's role will automatically update their Employee ID (EID) to match the new role prefix."})]}),s.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx("div",{className:"me-3",children:s.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:t.fullName}),s.jsx("small",{className:"text-muted",children:t.email})]})]}),s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"text-muted small",children:"Current Role"}),s.jsx("div",{className:"fw-medium",children:t.role})]}),s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"text-muted small",children:"New Role"}),s.jsx("div",{className:"fw-medium text-primary",children:r})]})]})]}),s.jsxs(De,{variant:"warning",className:"mb-0",children:[s.jsx("div",{className:"fw-semibold mb-2",children:" EID Change Details:"}),s.jsxs("ul",{className:"mb-0 small",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Current EID:"})," ",t.eid," (Prefix: ",l,")"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"New EID:"})," ",c,"XXXXXX (Prefix: ",c,")"]}),s.jsx("li",{children:"The EID will be automatically updated to reflect the new role"}),s.jsx("li",{children:"This change cannot be undone easily"})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 bg-light",children:[s.jsxs(te,{variant:"outline-secondary",onClick:n,disabled:i,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"warning",onClick:()=>{a()},disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Je,{className:"me-2",size:16}),"Confirm Role Change"]})})]})]})},VW=({show:e,user:t,mode:r,onSave:a,onClose:n})=>{const[i,o]=v.useState({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",bio:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),[l,c]=v.useState({}),[d,u]=v.useState(!1),[m,f]=v.useState([]),[h,p]=v.useState(!1),x=async()=>{p(!0);try{const E=(await Cs.getPublicRoles()).map(P=>P.name);f(E)}catch(N){console.error("Error fetching roles:",N),J.error("Failed to load roles"),f([])}finally{p(!1)}},g=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Egypt","Estonia","Finland","France","Georgia","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Jordan","Kazakhstan","Kuwait","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Uzbekistan","Vietnam","Yemen"];v.useEffect(()=>{e&&x()},[e]),v.useEffect(()=>{t&&r!=="add"?o({firstName:t.firstName||"",middleName:t.middleName||"",lastName:t.lastName||"",address:t.address||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:t.role||"",roleId:t.roleId||"",certificationNumber:t.certificationNumber||"",specialization:t.specialization||"",yearsOfExperience:t.yearsOfExperience||"",bio:t.bio||"",dateOfBirth:t.dateOfBirth||"",trainingBatch:t.trainingBatch||"",passportNo:t.passportNo||"",nation:t.nation||"",department:t.department||""}):r==="add"&&o({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",certificationNumber:"",specialization:"",yearsOfExperience:"",bio:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),c({})},[t,r,e]);const b=()=>{const N={};if(i.firstName.trim()?/^[a-zA-Z\s]+$/.test(i.firstName.trim())||(N.firstName="First name can only contain letters and spaces"):N.firstName="First name is required",i.lastName.trim()?/^[a-zA-Z\s]+$/.test(i.lastName.trim())||(N.lastName="Last name can only contain letters and spaces"):N.lastName="Last name is required",i.middleName.trim()&&!/^[a-zA-Z\s]+$/.test(i.middleName.trim())&&(N.middleName="Middle name can only contain letters and spaces"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(N.email="Email is invalid"):N.email="Email is required",!i.phoneNumber.trim())N.phoneNumber="Phone number is required";else if(!/^[+]?[0-9\s\-()]+$/.test(i.phoneNumber))N.phoneNumber="Phone number cannot contain letters";else{const E=i.phoneNumber.replace(/[^\d+]/g,"");(E.length<7||E.length>16)&&(N.phoneNumber="Phone number must be 7-16 digits")}return i.role||(N.role="Role is required"),i.role==="TRAINER"&&(i.specialization.trim()||(N.specialization="Specialization is required for trainers"),i.certificationNumber.trim()||(N.certificationNumber="Certification number is required for trainers"),!i.bio||!i.bio.trim()?N.bio="Bio is required for trainers":i.bio.trim().length<1&&(N.bio="Bio must be at least 1 character"),i.department&&i.department.trim()!==""&&(N.department="Department is not allowed for Trainer role")),i.role==="TRAINEE"&&(i.trainingBatch.trim()||(N.trainingBatch="Training batch is required for trainees"),i.passportNo.trim()?/^\d{1,20}$/.test(i.passportNo.trim())||(N.passportNo="Passport number must be 1-20 digits only"):N.passportNo="Passport number is required for trainees",i.dateOfBirth.trim()?i.dateOfBirth.length!==10||!/^\d{4}-\d{2}-\d{2}$/.test(i.dateOfBirth)?N.dateOfBirth="Please enter date in YYYY-MM-DD format":new Date(i.dateOfBirth)>=new Date&&(N.dateOfBirth="Date of birth must be in the past"):N.dateOfBirth="Date of birth is required for trainees"),c(N),Object.keys(N).length===0},j=async N=>{if(N.preventDefault(),!!b()&&!d){u(!0);try{await a(i)}catch(E){console.error("Error in handleSubmit:",E)}finally{u(!1)}}},y=(N,E)=>{o(P=>({...P,[N]:E})),c(P=>{const T={...P};return T[N]&&delete T[N],N==="role"&&(delete T.specialization,delete T.certificationNumber,delete T.bio,delete T.trainingBatch,delete T.passportNo,delete T.dateOfBirth,delete T.department),N==="department"&&(delete T.department,i.role==="TRAINER"&&E&&E.trim()!==""&&(T.department="Department is not allowed for Trainer role")),N==="role"&&E==="TRAINER"&&o(O=>({...O,department:""})),T})},w=()=>{switch(r){case"add":return"Add New User";case"edit":return"Edit User";case"view":return"User Details";default:return"User"}},S=r==="view";return s.jsxs(ce,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(Bt,{className:"me-2",size:20}):s.jsx(us,{className:"me-2",size:20}),w()]})}),s.jsxs(k,{onSubmit:j,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(l).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([N,E])=>s.jsx("li",{children:E},N))})]}),s.jsxs(de,{children:[s.jsx(H,{md:4,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"First Name *"}),s.jsx(k.Control,{type:"text",value:i.firstName,onChange:N=>y("firstName",N.target.value),isInvalid:!!l.firstName,readOnly:S,style:{borderColor:l.firstName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.firstName})]})}),s.jsx(H,{md:4,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Middle Name"}),s.jsx(k.Control,{type:"text",value:i.middleName,onChange:N=>y("middleName",N.target.value),isInvalid:!!l.middleName,readOnly:S,style:{borderColor:l.middleName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.middleName})]})}),s.jsx(H,{md:4,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Last Name *"}),s.jsx(k.Control,{type:"text",value:i.lastName,onChange:N=>y("lastName",N.target.value),isInvalid:!!l.lastName,readOnly:S,style:{borderColor:l.lastName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.lastName})]})})]}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Email *"}),s.jsx(k.Control,{type:"email",value:i.email,onChange:N=>y("email",N.target.value),isInvalid:!!l.email,readOnly:S,style:{borderColor:l.email?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.email})]})})}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Phone Number *"}),s.jsx(k.Control,{type:"tel",value:i.phoneNumber,onChange:N=>y("phoneNumber",N.target.value),isInvalid:!!l.phoneNumber,readOnly:S,placeholder:"Enter phone number",style:{borderColor:l.phoneNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.phoneNumber})]})})}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Address (optional)"}),s.jsx(k.Control,{as:"textarea",rows:3,value:i.address,onChange:N=>y("address",N.target.value),readOnly:S,placeholder:"Enter address (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),s.jsxs(de,{children:[s.jsx(H,{md:i.role==="DEPT_HEAD"||i.role==="TRAINER"?6:12,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Role *"}),s.jsxs(k.Select,{value:i.role,onChange:N=>y("role",N.target.value),isInvalid:!!l.role,disabled:S||h,style:{borderColor:l.role?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:h?"Loading roles...":"Select a role"}),m.map(N=>s.jsx("option",{value:N,children:N},N))]}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.role})]})}),i.role==="DEPARTMENT_HEAD"&&s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Department"}),s.jsx(k.Control,{type:"text",value:i.department,onChange:N=>y("department",N.target.value),isInvalid:!!l.department,readOnly:S,placeholder:"Enter department name (optional)",style:{borderColor:l.department?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.department})]})})]}),i.role==="TRAINER"&&s.jsxs(s.Fragment,{children:[s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Specialization *"}),s.jsx(k.Control,{type:"text",value:i.specialization,onChange:N=>y("specialization",N.target.value),isInvalid:!!l.specialization,readOnly:S,placeholder:"Enter specialization",style:{borderColor:l.specialization?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.specialization})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Certification Number *"}),s.jsx(k.Control,{type:"text",value:i.certificationNumber,onChange:N=>y("certificationNumber",N.target.value),isInvalid:!!l.certificationNumber,readOnly:S,placeholder:"Enter certification number",style:{borderColor:l.certificationNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.certificationNumber})]})})]}),s.jsx(de,{children:s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Years of Experience"}),s.jsx(k.Control,{type:"number",value:i.yearsOfExperience,onChange:N=>y("yearsOfExperience",N.target.value),readOnly:S,placeholder:"Enter years of experience",min:"0",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Bio *"}),s.jsx(k.Control,{as:"textarea",rows:4,value:i.bio,onChange:N=>y("bio",N.target.value),isInvalid:!!l.bio,readOnly:S,placeholder:"Enter trainer bio (at least 1 character, no unsupported characters)",style:{borderColor:l.bio?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.bio}),s.jsx(k.Text,{className:"text-muted",children:"Bio is required and must contain at least 1 character. Only letters, numbers, spaces, and common punctuation are allowed."})]})})})]}),i.role==="TRAINEE"&&s.jsxs(s.Fragment,{children:[s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Date of Birth *"}),s.jsx(k.Control,{type:"date",value:i.dateOfBirth,onChange:N=>{const E=N.target.value;(E===""||E.length===10&&/^\d{4}-\d{2}-\d{2}$/.test(E))&&y("dateOfBirth",E)},isInvalid:!!l.dateOfBirth,readOnly:S,max:"2024-12-31",min:"1900-01-01",style:{borderColor:l.dateOfBirth?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.dateOfBirth})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Training Batch *"}),s.jsx(k.Control,{type:"text",value:i.trainingBatch,onChange:N=>y("trainingBatch",N.target.value),isInvalid:!!l.trainingBatch,readOnly:S,placeholder:"Enter training batch",style:{borderColor:l.trainingBatch?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.trainingBatch})]})})]}),s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Passport No *"}),s.jsx(k.Control,{type:"text",value:i.passportNo,onChange:N=>y("passportNo",N.target.value),isInvalid:!!l.passportNo,readOnly:S,placeholder:"Enter passport number",style:{borderColor:l.passportNo?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.passportNo})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Nation"}),s.jsxs(k.Select,{value:i.nation,onChange:N=>y("nation",N.target.value),disabled:S,style:{borderColor:"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:"Select a nation"}),g.map(N=>s.jsx("option",{value:N,children:N},N))]})]})})]})]}),r==="view"&&t&&s.jsx(de,{children:s.jsx(H,{children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Employee ID"}),s.jsx(k.Control,{type:"text",value:t.eid,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:n,disabled:d,children:[s.jsx(st,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(te,{variant:"primary-custom",type:"submit",disabled:d,children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),r==="add"?"Add User":"Save Changes"]})})]})]})]})},GW=({user:e,index:t,onView:r,onEdit:a,onDisable:n})=>{const i=c=>c==="ACTIVE"?"success":"secondary",o=c=>c==="ACTIVE"?"":"",l=e.role==="ADMINISTRATOR";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:c=>{c.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:c=>{c.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"fw-semibold text-primary-custom",children:e.eid})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:e.fullName})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:e.email})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx(ke,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.role})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.department})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs(ke,{bg:i(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:o(e.status)}),e.status]})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(yt,{permissions:[Te.VIEW_USER_IN_DETAIL,Te.UPDATE_USER],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>r(e),permission:Te.VIEW_USER_IN_DETAIL},{label:"Edit User",icon:s.jsx(Yr,{}),onClick:()=>a(e),permission:Te.UPDATE_USER,disabled:l||e.status==="DISABLED"},{type:"divider"},{label:e.status==="ACTIVE"?"Disable User":"Enable User",icon:s.jsx(Sc,{}),className:"text-danger",onClick:()=>n(e),permission:Te.UPDATE_USER,disabled:l}]})})})]})},qW=({users:e,loading:t,onView:r,onEdit:a,onDisable:n})=>{const{sortedData:i,sortConfig:o,handleSort:l}=_r(e);if(t)return s.jsx(nr,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No users found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new user."})]})});const c=({columnKey:d,children:u,className:m=""})=>{const f=o.key===d,h=f?o.direction:null;return s.jsxs("th",{className:`fw-semibold ${m}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>l(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:f?"600":"500",color:"white"},children:u}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:h,size:14,color:"white"})})]}),f&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive user-management-table",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(c,{columnKey:"eid",className:"show-mobile",children:"EID"}),s.jsx(c,{columnKey:"fullName",className:"show-mobile",children:"Full Name"}),s.jsx(c,{columnKey:"email",className:"show-mobile",children:"Email"}),s.jsx(c,{columnKey:"role",className:"show-mobile",children:"Role"}),s.jsx(c,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:i.map((d,u)=>s.jsx(GW,{user:d,index:u,onView:r,onEdit:a,onDisable:n},d.id))})]})})},KW=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(""),[n,i]=v.useState([]),[o,l]=v.useState([]),[c,d]=v.useState(!1),[u,m]=v.useState(null),[f,h]=v.useState("view"),[p,x]=v.useState(!1),[g,b]=v.useState(null),[j,y]=v.useState(!1),[w,S]=v.useState(null);v.useEffect(()=>{(async()=>{x(!0);try{const I=await Ys.getUsers();let V=[];Array.isArray(I)?V=I:Array.isArray(I?.data)?V=I.data:I?.users&&Array.isArray(I.users)?V=I.users:(console.warn(" Unexpected users response format:",I),V=[]);const ie=V.map(se=>({id:se.id,eid:se.eid,fullName:[se.firstName,se.middleName,se.lastName].filter(Boolean).join(" "),firstName:se.firstName,middleName:se.middleName,lastName:se.lastName,role:se.role?.name||"N/A",roleId:se.role?.id||"",department:se.department?.name||"N/A",status:se.status,email:se.email,phoneNumber:se.phoneNumber||"",address:se.address||"",certificationNumber:se.certificationNumber||"",specialization:se.specialization||"",yearsOfExperience:se.yearsOfExperience||"",bio:se.bio||"",dateOfBirth:se.dateOfBirth||"",trainingBatch:se.trainingBatch||"",passportNo:se.passportNo||"",nation:se.nation||"",createdAt:se.createdAt,lastLogin:se.lastLogin||""}));t(ie),b(null)}catch(I){const V=Ha(I,{});b(V)}finally{x(!1)}})()},[]);const N=[...new Set(e.map(D=>D.role).filter(Boolean))],E=[...new Set(e.map(D=>D.department).filter(Boolean))].filter((D,I,V)=>D&&D!=="N/A"&&V.indexOf(D)===I),P=e.filter(D=>{const I=!r||D.fullName.toLowerCase().includes(r.toLowerCase())||D.eid.toLowerCase().includes(r.toLowerCase())||D.email.toLowerCase().includes(r.toLowerCase()),V=n.length===0||n.includes(D.role),ie=o.length===0||o.includes(D.department);return I&&V&&ie}),T=D=>a(D),O=D=>{i(I=>I.includes(D)?I.filter(V=>V!==D):[...I,D])},_=D=>{l(I=>I.includes(D)?I.filter(V=>V!==D):[...I,D])},C=()=>{i([]),l([]),a("")},R=async D=>{try{x(!0);const I=await Ys.getUserById(D.id),V={id:I.id,eid:I.eid,fullName:[I.firstName,I.middleName,I.lastName].filter(Boolean).join(" "),firstName:I.firstName,middleName:I.middleName,lastName:I.lastName,role:I.role?.name||"N/A",roleId:I.role?.id||"",department:I.department?.name||"N/A",status:I.status,email:I.email,phoneNumber:I.phoneNumber||"",address:I.address||"",certificationNumber:I.trainerProfile?.certificationNumber||"",specialization:I.trainerProfile?.specialization||"",yearsOfExperience:I.trainerProfile?.yearsOfExp||"",bio:I.trainerProfile?.bio||"",dateOfBirth:I.traineeProfile?.dob?I.traineeProfile.dob.split("T")[0]:"",trainingBatch:I.traineeProfile?.trainingBatch||"",passportNo:I.traineeProfile?.passportNo||"",nation:I.traineeProfile?.nation||"",createdAt:I.createdAt,lastLogin:I.lastLogin||""};m(V),h("view"),d(!0)}catch{b("Unable to load user details")}finally{x(!1)}},M=async D=>{try{x(!0);const I=await Ys.getUserById(D.id),V={id:I.id,eid:I.eid,fullName:[I.firstName,I.middleName,I.lastName].filter(Boolean).join(" "),firstName:I.firstName,middleName:I.middleName,lastName:I.lastName,role:I.role?.name||"N/A",roleId:I.role?.id||"",department:I.department?.name||"N/A",status:I.status,email:I.email,phoneNumber:I.phoneNumber||"",address:I.address||"",certificationNumber:I.trainerProfile?.certificationNumber||"",specialization:I.trainerProfile?.specialization||"",yearsOfExperience:I.trainerProfile?.yearsOfExp||"",bio:I.trainerProfile?.bio||"",dateOfBirth:I.traineeProfile?.dob?I.traineeProfile.dob.split("T")[0]:"",trainingBatch:I.traineeProfile?.trainingBatch||"",passportNo:I.traineeProfile?.passportNo||"",nation:I.traineeProfile?.nation||"",createdAt:I.createdAt,lastLogin:I.lastLogin||""};m(V),h("edit"),d(!0)}catch{b("Unable to load user details")}finally{x(!1)}},U=()=>{m(null),h("add"),d(!0)},Z=async D=>{try{x(!0);let I,V;D.status==="ACTIVE"?(I=await Ys.disableUser(D.id),V="disabled"):(I=await Ys.enableUser(D.id),V="enabled");const ie=await Ys.getUsers();let se=[];Array.isArray(ie)?se=ie:Array.isArray(ie?.data)?se=ie.data:ie?.users&&Array.isArray(ie.users)?se=ie.users:(console.warn(" Unexpected users response format:",ie),se=[]);const ae=se.map(G=>({id:G.id,eid:G.eid,fullName:[G.firstName,G.middleName,G.lastName].filter(Boolean).join(" "),firstName:G.firstName,middleName:G.middleName,lastName:G.lastName,role:G.role?.name||"N/A",roleId:G.role?.id||"",department:G.department?.name||"N/A",status:G.status,email:G.email,phoneNumber:G.phoneNumber||"",address:G.address||"",certificationNumber:G.trainerProfile?.certificationNumber||"",specialization:G.trainerProfile?.specialization||"",yearsOfExperience:G.trainerProfile?.yearsOfExp||"",bio:G.trainerProfile?.bio||"",dateOfBirth:G.traineeProfile?.dob?G.traineeProfile.dob.split("T")[0]:"",trainingBatch:G.traineeProfile?.trainingBatch||"",passportNo:G.traineeProfile?.passportNo||"",nation:G.traineeProfile?.nation||"",createdAt:G.createdAt,lastLogin:G.lastLogin||""}));t(ae);const K=I?.message||`User has been ${V} successfully!`;J.success(K)}catch(I){const V=Ha(I,{});b(V),J.error(V)}finally{x(!1)}},ee=async D=>{try{if(x(!0),f==="edit"&&u&&u.role!==D.role){S(D),y(!0),x(!1);return}await re(D)}catch{x(!1)}},re=async D=>{try{x(!0);let I=null;try{const G=(await Cs.getPublicRoles()).find(ue=>ue.name===D.role);if(G)I=G.id;else throw new Error(`Role '${D.role}' not found in backend`)}catch(K){throw new Error(`Failed to get role ID for '${D.role}': ${K.message}`)}const V={firstName:D.firstName,middleName:D.middleName||"",lastName:D.lastName,address:D.address||"",email:D.email,gender:"MALE",avatarUrl:"",phoneNumber:D.phoneNumber||"",role:{id:I,name:D.role}};D.role==="TRAINER"?V.trainerProfile={specialization:D.specialization||"",certificationNumber:D.certificationNumber||"",yearsOfExp:D.yearsOfExperience?parseInt(D.yearsOfExperience):0,bio:D.bio||""}:D.role==="TRAINEE"&&(D.dateOfBirth||D.trainingBatch||D.passportNo||D.nation)&&(V.traineeProfile={dob:D.dateOfBirth?new Date(D.dateOfBirth).toISOString():null,enrollmentDate:new Date().toISOString(),trainingBatch:D.trainingBatch||"",passportNo:D.passportNo||"",nation:D.nation||""}),f==="add"?(await Ys.createUser(V),J.success("User created successfully!")):f==="edit"&&(await Ys.updateUser(u.id,V),J.success("User updated successfully!")),d(!1);const ie=await Ys.getUsers();let se=[];if(Array.isArray(ie)?se=ie:Array.isArray(ie?.data)?se=ie.data:ie?.users&&Array.isArray(ie.users)?se=ie.users:(console.warn(" Unexpected users response format:",ie),se=[]),f==="edit"&&u?.id){const K=se.find(G=>G.id===u.id)}const ae=se.map(K=>({id:K.id,eid:K.eid,fullName:[K.firstName,K.middleName,K.lastName].filter(Boolean).join(" "),firstName:K.firstName,middleName:K.middleName,lastName:K.lastName,role:K.role?.name||"N/A",roleId:K.role?.id||"",department:K.department?.name||"N/A",status:K.status,email:K.email,phoneNumber:K.phoneNumber||"",address:K.address||"",certificationNumber:K.trainerProfile?.certificationNumber||"",specialization:K.trainerProfile?.specialization||"",yearsOfExperience:K.trainerProfile?.yearsOfExp||"",bio:K.trainerProfile?.bio||"",dateOfBirth:K.traineeProfile?.dob?K.traineeProfile.dob.split("T")[0]:"",trainingBatch:K.traineeProfile?.trainingBatch||"",passportNo:K.traineeProfile?.passportNo||"",nation:K.traineeProfile?.nation||"",createdAt:K.createdAt,lastLogin:K.lastLogin||""}));t(ae)}catch(I){const V=Ha(I,{});throw b(V),new Error(V)}finally{x(!1)}};return{users:P,searchTerm:r,selectedRoles:n,selectedDepartments:o,uniqueRoles:N,uniqueDepartments:E,modalShow:c,selectedUser:u,modalMode:f,loading:p,error:g,confirmRoleChange:j,pendingUserData:w,handleSearch:T,handleRoleToggle:O,handleDepartmentToggle:_,handleClearFilters:C,handleView:R,handleEdit:M,handleAdd:U,handleDisable:Z,handleSave:ee,handleBulkImport:async D=>{try{x(!0);const I=await Ys.bulkImportUsers(D),V=I?.success??I?.data?.success??[],ie=I?.failed??I?.data?.failed??[],se=I?.summary??I?.data?.summary,ae=I?.message||I?.data?.message;if(se){const{total:L,successful:Ne,failed:Oe}=se;let We=ae||"Bulk user creation completed";(Ne>0||Oe>0)&&(We+=` (${Ne} successful, ${Oe} failed out of ${L} total)`),Oe>0?(J.warning(We,{toastId:"bulk-import-summary",autoClose:6e3}),ie.forEach((Qe,Pe)=>{const rt=Qe?.error;rt&&setTimeout(()=>{J.error(rt,{autoClose:6e3,toastId:`bulk-import-failed-${Pe}`})},Pe*200)})):Ne>0&&J.success(We,{toastId:"bulk-import-success",autoClose:5e3})}else{if(V.length>0){const L=ae||`Successfully imported ${V.length} users!`;J.success(L,{toastId:"bulk-import-success"})}ie.length>0&&ie.forEach((L,Ne)=>{const Oe=L?.error;Oe&&setTimeout(()=>{J.error(Oe,{autoClose:6e3,toastId:`bulk-import-failed-${Ne}`})},Ne*200)})}console.log("Refreshing user list after bulk import...");const K=await Ys.getUsers({_t:new Date().getTime()});let G=[];Array.isArray(K)?G=K:Array.isArray(K?.data)?G=K.data:K?.users&&Array.isArray(K.users)?G=K.users:(console.warn(" Unexpected users response format:",K),G=[]);const ue=G.map(L=>({id:L.id,eid:L.eid,fullName:[L.firstName,L.middleName,L.lastName].filter(Boolean).join(" "),firstName:L.firstName,middleName:L.middleName,lastName:L.lastName,role:L.role?.name||"N/A",roleId:L.role?.id||"",department:L.department?.name||"N/A",status:L.status,email:L.email,phoneNumber:L.phoneNumber||"",address:L.address||"",certificationNumber:L.trainerProfile?.certificationNumber||"",specialization:L.trainerProfile?.specialization||"",yearsOfExperience:L.trainerProfile?.yearsOfExp||"",bio:L.trainerProfile?.bio||"",dateOfBirth:L.traineeProfile?.dob?L.traineeProfile.dob.split("T")[0]:"",trainingBatch:L.traineeProfile?.trainingBatch||"",passportNo:L.traineeProfile?.passportNo||"",nation:L.traineeProfile?.nation||"",createdAt:L.createdAt,lastLogin:L.lastLogin||""}));t(ue)}catch(I){const V=Ha(I,{});b(V),J.error(V)}finally{x(!1)}},handleModalClose:()=>{d(!1),m(null)},handleConfirmRoleChange:async()=>{y(!1),w&&(await re(w),S(null))},handleCancelRoleChange:()=>{y(!1),S(null)},setError:b}},YW=()=>{const[e,t]=el();tt();const[r,a]=v.useState(!1),[n,i]=v.useState(null),[o,l]=v.useState(!1),[c,d]=v.useState(!1);v.useEffect(()=>{if(e.get("action")==="bulk-import"){d(!0);const I=new URLSearchParams(e);I.delete("action"),t(I,{replace:!0})}},[e,t]);const{users:u,loading:m,error:f,searchTerm:h,selectedRoles:p,selectedDepartments:x,uniqueRoles:g,uniqueDepartments:b,modalShow:j,selectedUser:y,modalMode:w,confirmRoleChange:S,pendingUserData:N,handleSearch:E,handleRoleToggle:P,handleDepartmentToggle:T,handleClearFilters:O,handleView:_,handleEdit:C,handleAdd:R,handleDisable:M,handleSave:U,handleBulkImport:Z,handleModalClose:ee,handleConfirmRoleChange:re,handleCancelRoleChange:z}=KW(),me=D=>{i(D),a(!0)},ne=async()=>{if(n){l(!0);try{await M(n),a(!1),i(null)}catch(D){console.error("Error disabling user:",D)}finally{l(!1)}}},A=()=>{a(!1),i(null)};return Q.useEffect(()=>{f&&J.error(f)},[f]),s.jsx(Ce,{fluid:!0,className:"py-4 user-management-page",children:s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(de,{className:"align-items-center",children:s.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(yt,{permission:Te.BULK_CREATE_USERS,fallback:null,children:s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:()=>d(!0),className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-1",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Bulk Import"}),s.jsx("span",{className:"d-sm-none",children:"Import"})]})}),s.jsx(yt,{permission:Te.CREATE_USER,fallback:null,children:s.jsxs(te,{variant:"primary-custom",size:"sm",onClick:R,className:"d-flex align-items-center",children:[s.jsx(Gr,{className:"me-1",size:16}),"Add User"]})})]})})})}),s.jsxs(W.Body,{children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search users by name, EID, or email...",value:h,onChange:E,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(WW,{uniqueRoles:g,uniqueDepartments:b,selectedRoles:p,selectedDepartments:x,onRoleToggle:P,onDepartmentToggle:T,onClearFilters:O,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[u.length," user",u.length!==1?"s":""]})})})]}),s.jsxs("div",{className:"position-relative user-management-table-wrapper",children:[s.jsx(qW,{users:u,loading:m,onView:_,onEdit:C,onDisable:me}),u.length>8&&s.jsxs("div",{className:"scroll-indicator",children:[s.jsx(ai,{size:12,className:"me-1"}),"Scroll to see more users"]})]}),s.jsx(VW,{show:j,user:y,mode:w,onSave:U,onClose:ee}),s.jsx($W,{show:c,onClose:()=>{if(d(!1),e.get("action")==="bulk-import"){const D=new URLSearchParams(e);D.delete("action"),t(D,{replace:!0})}},onImport:Z,loading:m}),s.jsx(UW,{show:r,user:n,onConfirm:ne,onCancel:A,loading:o}),s.jsx(HW,{show:S,user:y,newRole:N?.role,onConfirm:re,onCancel:z,loading:m})]})]})})},XW=({show:e,role:t,onConfirm:r,onCancel:a,loading:n})=>{if(!t)return null;const i=t.status==="Active",o=i?"Disable":"Enable",c=i?aS:Je;return s.jsxs(ce,{show:e,onHide:a,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(ce.Header,{closeButton:!0,className:"text-white border-0",style:{backgroundColor:i?"var(--bs-secondary)":"#28a745",borderBottom:"none"},children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(c,{size:24,className:"me-2"}),o," Role: ",t.name]})}),s.jsxs(ce.Body,{className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 text-white",style:{width:"50px",height:"50px",backgroundColor:i?"var(--bs-secondary)":"#28a745",fontSize:"1.5rem",fontWeight:"bold"},children:t.name.charAt(0).toUpperCase()}),s.jsx("div",{children:s.jsx("h6",{className:"mb-0",children:t.name})})]}),i?s.jsxs(De,{variant:"warning",className:"mb-3",style:{backgroundColor:"#f0e8e0",borderColor:"var(--bs-secondary)",color:"var(--bs-dark)"},children:[s.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[s.jsx(Jt,{className:"me-2",style:{color:"var(--bs-secondary)"}})," Warning: Disabling Role"]}),s.jsxs("p",{className:"mb-1",children:["This action will disable the ",s.jsx("span",{className:"fw-bold",children:t.name})," role."]}),s.jsxs("ul",{className:"mb-0 ps-3",children:[s.jsx("li",{children:"Users with this role will lose access to associated permissions."}),s.jsx("li",{children:"Role data will be preserved but access will be restricted."}),s.jsx("li",{children:"Role can be re-enabled later by an administrator."}),s.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}):s.jsxs(De,{variant:"success",className:"mb-3",children:[s.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[s.jsx(Je,{className:"me-2"})," Confirm: Enabling Role"]}),s.jsxs("p",{className:"mb-1",children:["This action will restore the ",s.jsx("span",{className:"fw-bold",children:t.name})," role."]}),s.jsxs("ul",{className:"mb-0 ps-3",children:[s.jsx("li",{children:"Users with this role will regain access to associated permissions."}),s.jsx("li",{children:"All role permissions and access will be restored."}),s.jsx("li",{children:"Role will be available for assignment to new users."}),s.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(te,{variant:"outline-secondary",onClick:a,disabled:n,children:"Cancel"}),s.jsx(te,{variant:i?"secondary":"success",onClick:r,disabled:n,className:"d-flex align-items-center",style:i?{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#fff"}:{},children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{size:16,className:"me-2"}),o," Role"]})})]})]})]})},JW=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:a,className:n=""})=>{const i=t.length>0;return s.jsxs(St,{className:`filter-panel-dropdown ${n}`,children:[s.jsx(St.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(oo,{size:14,className:"me-2"}),"Filters",i&&s.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),s.jsxs(St.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"280px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&s.jsx(te,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:s.jsx(st,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(o=>s.jsx(k.Check,{type:"checkbox",id:`status-${o}`,label:o,checked:t.includes(o),onChange:()=>r(o),className:"mb-1"},o))})]}),i&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(te,{variant:"outline-danger",size:"sm",className:"w-100",onClick:a,children:[s.jsx(st,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},ZW=["ADMINISTRATOR"],yb=e=>ZW.includes(e?.toUpperCase()),QW=({show:e,role:t,mode:r,onSave:a,onClose:n})=>{const[i,o]=v.useState({name:"",description:"",permissionGroupCodes:[]}),[l,c]=v.useState({}),[d,u]=v.useState(!1),[m,f]=v.useState({}),{allPermissions:h,loading:p,error:x,fetchAllPermissions:g}=$P(),b=v.useMemo(()=>{if(!h||h.length===0)return[];const O={};return h.forEach(_=>{const C=_.module||_.viewModule,R=_.viewModule||_.module||"Other";O[C]||(O[C]={id:C,name:R,description:`Manage ${R.toLowerCase()} related permissions`,permissions:[]});const M=_.code||_.id;M&&O[C].permissions.push({id:M,code:_.code,title:_.viewName||_.name,description:_.description||"",isActive:_.isActive!==!1})}),Object.values(O).sort((_,C)=>_.name.localeCompare(C.name))},[h]),j=v.useMemo(()=>{const O=b;if(r==="view"&&t?.permissions){const _=t.permissions.map(C=>typeof C=="string"?C:C.id?C.id:C.code?C.code:C);return console.log(" View Mode - Assigned IDs:",_),O.map(C=>({...C,permissions:C.permissions.filter(R=>_.includes(R.id)||_.includes(R.code))})).filter(C=>C.permissions.length>0)}return O},[b,r,t?.permissions]);v.useEffect(()=>{if(t&&r!=="add"){const O=t.permissions?t.permissions.map(_=>typeof _=="string"?_:_.code||_.id||_):[];o({name:t.name||"",description:t.description||"",permissionGroupCodes:O})}else r==="add"&&o({name:"",description:"",permissionGroupCodes:[]});c({})},[t,r,e,h]),v.useEffect(()=>{e&&g()},[e,g]),v.useEffect(()=>{if(r==="view"){const O={};j.map(C=>C.id).forEach(C=>{O[C]=!0}),f(O)}else if(r==="edit"){const O={};j.map(C=>C.id).forEach(C=>{O[C]=!0}),f(O)}else f({})},[r,j]);const y=()=>{const O={};return i.name.trim()?/^[a-zA-Z0-9\s_]+$/.test(i.name.trim())||(O.name="Role name cannot contain special characters"):O.name="Role name is required",i.permissionGroupCodes.length===0&&(O.permissionGroupCodes="At least one permission is required"),c(O),Object.keys(O).length===0},w=async O=>{if(O.preventDefault(),!!y()){u(!0);try{await a(i)}catch(_){console.error("Error saving role:",_)}finally{u(!1)}}},S=(O,_)=>{o(C=>({...C,[O]:_})),l[O]&&c(C=>({...C,[O]:""}))},N=O=>{!O||O===null||O===void 0||(o(_=>{const C=_.permissionGroupCodes||[],R=C.some(M=>String(M)===String(O));return{..._,permissionGroupCodes:R?C.filter(M=>String(M)!==String(O)):[...C,O]}}),l.permissionGroupCodes&&c(_=>({..._,permissionGroupCodes:""})))},E=O=>{f(_=>({..._,[O]:!_[O]}))},P=()=>{switch(r){case"add":return"Add New Role";case"edit":return"Edit Role";case"view":return"Role Details";default:return"Role"}},T=r==="view";return s.jsxs(ce,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(ce.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(Bt,{className:"me-2",size:20}):s.jsx(Ux,{className:"me-2",size:20}),P()]})}),s.jsxs(k,{onSubmit:w,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t&&yb(t.name)&&r==="edit"&&s.jsxs(De,{variant:"warning",className:"mb-3",children:[s.jsx(Jt,{className:"me-2"}),s.jsx("strong",{children:"Base Role Warning:"})," This role cannot be modified."]}),Object.keys(l).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([O,_])=>s.jsx("li",{children:_},O))})]}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsx(k.Group,{className:"mb-3",children:s.jsxs(de,{className:"align-items-center",children:[s.jsx(H,{md:2,children:s.jsx(k.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Role Name *"})}),s.jsxs(H,{md:4,children:[s.jsx(k.Control,{type:"text",size:"sm",value:i.name,onChange:O=>{const _=O.target.value;/^[a-zA-Z0-9\s_]*$/.test(_)&&S("name",_)},isInvalid:!!l.name,readOnly:T,style:{borderColor:l.name?"#dc3545":"var(--bs-primary)",borderWidth:"1px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.name})]})]})})})}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsx(k.Group,{className:"mb-3",children:s.jsxs(de,{className:"align-items-start",children:[s.jsx(H,{md:2,children:s.jsx(k.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Description"})}),s.jsx(H,{md:4,children:s.jsx(k.Control,{as:"textarea",rows:2,size:"sm",value:i.description,onChange:O=>S("description",O.target.value),readOnly:T,placeholder:"Enter role description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"1px",resize:"none"}})})]})})})}),s.jsx(de,{children:s.jsx(H,{children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold fs-5 mb-3",children:"Permissions *"}),l.permissionGroupCodes&&s.jsx("div",{className:"text-danger small mb-2",children:l.permissionGroupCodes}),x&&s.jsxs("div",{className:"text-danger small mb-2",children:["Error loading permissions: ",x.message||"Unknown error"]}),s.jsx("div",{className:"border rounded p-4 bg-light",style:{maxHeight:"450px",overflowY:"auto",borderColor:"var(--bs-primary)",borderWidth:"2px"},children:p?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),"Loading permissions..."]}):j.length>0?s.jsx(s.Fragment,{children:j.map(O=>{const _=m[O.id];return s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:`d-flex align-items-center p-2 bg-light rounded permission-group-header ${T?"":"cursor-pointer"}`,onClick:()=>!T&&E(O.id),role:T?void 0:"button",tabIndex:T?void 0:0,onKeyDown:T?void 0:C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),E(O.id))},"aria-expanded":T?void 0:_,children:s.jsxs("div",{className:"d-flex align-items-center",children:[!T&&(_?s.jsx(ai,{className:"me-2",size:16}):s.jsx(Xu,{className:"me-2",size:16})),s.jsxs("div",{children:[s.jsx("div",{className:"fw-bold text-primary-custom",children:O.name}),s.jsx("small",{className:"text-muted",children:O.description})]})]})}),_&&O.permissions.length>0&&s.jsx("div",{className:"ms-3 mt-2",children:s.jsx(_a,{variant:"flush",children:O.permissions.map(C=>{const R=C.id;return R?s.jsx(_a.Item,{className:"border-0 px-0 py-2 permission-item",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"form-check me-3",children:s.jsx("input",{type:"checkbox",className:"form-check-input",id:`permission-${R}`,checked:i.permissionGroupCodes.some(M=>String(M)===String(R)),onChange:M=>{M.stopPropagation(),!T&&R&&N(R)},onClick:M=>{M.stopPropagation()},disabled:T,style:{cursor:T?"not-allowed":"pointer",width:"1.25rem",height:"1.25rem"}})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("div",{className:"fw-medium text-dark",children:C.title}),s.jsx("small",{className:"text-muted",children:C.description})]}),!T&&i.permissionGroupCodes.some(M=>String(M)===String(R))&&s.jsx(ke,{bg:"primary",className:"ms-2",children:"Selected"})]})},`${O.id}-${R}`):null})})})]},O.id)})}):s.jsx("div",{className:"text-center py-4 text-muted",children:"No permissions available"})}),s.jsx("div",{className:"mt-2",children:s.jsxs("small",{className:"text-muted",children:[i.permissionGroupCodes.length," of ",j.reduce((O,_)=>O+_.permissions.length,0)," permissions assigned"]})})]})})}),r==="view"&&t&&s.jsx(de,{children:s.jsx(H,{children:s.jsxs("div",{className:"bg-light-custom p-3 rounded",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Role Information"}),s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Assigned Users:"}),s.jsx("div",{className:"fw-medium",children:t.assignedUsers||0})]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("small",{className:"text-muted",children:"Total Permissions:"}),s.jsx("div",{className:"fw-medium",children:i.permissionGroupCodes.length})]})]})]})})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:n,disabled:d,children:[s.jsx(st,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(te,{variant:"primary-custom",type:"submit",disabled:d||t&&yb(t.name),children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),r==="add"?"Add Role":"Save Changes"]})})]})]})]})},eH=({roles:e,loading:t,actionsComponent:r,onView:a,onEdit:n,onDisable:i})=>{const{sortedData:o,sortConfig:l,handleSort:c}=_r(e);if(t)return s.jsx(nr,{rows:4,columns:4});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No roles found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new role."})]})});const d=({columnKey:u,children:m,className:f=""})=>{const h=l.key===u,p=h?l.direction:null;return s.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"700":"600",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:p,size:14,color:"white"})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(d,{columnKey:"name",className:"show-mobile",children:"Role Name"}),s.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(d,{columnKey:"assignedUsers",className:"show-mobile",children:"Assigned Users"}),s.jsx(d,{columnKey:"lastModified",className:"show-mobile",children:"Last Modified"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:o.map((u,m)=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:u.name}),s.jsx("td",{className:"show-mobile",children:s.jsxs(ke,{bg:u.status==="Active"?"success":"secondary",className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:u.status==="Active"?"":""}),u.status]})}),s.jsx("td",{className:"show-mobile",children:u.assignedUsers}),s.jsx("td",{className:"show-mobile",children:u.lastModified}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(r,{role:u})})]},u.id))})]})})},bb=e=>{if(!e||!Array.isArray(e))return[];const t=[];return e.forEach(r=>{r.permissions&&Array.isArray(r.permissions)&&r.permissions.forEach(a=>{t.push({code:a.code,name:a.name,id:a.code})})}),t},Nl=e=>e===!0||e==="ACTIVE",tH=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(""),[n,i]=v.useState([]),[o,l]=v.useState(!1),[c,d]=v.useState(null),[u,m]=v.useState("view"),[f,h]=v.useState(!1),[p,x]=v.useState(null);v.useEffect(()=>{(async()=>{h(!0);try{const C=await Cs.getRoles({includeDeleted:!0}),M=(Array.isArray(C)?C:C?.roles||[]).map(U=>({id:U.id,name:U.name,description:U.description||"",assignedUsers:U.userCount||0,status:Nl(U.isActive)?"Active":"Inactive",createdAt:U.createdAt?U.createdAt.split("T")[0]:"",lastModified:U.updatedAt?U.updatedAt.split("T")[0]:"",isActive:U.isActive,permissions:U.permissions||[],originalData:U}));t(M),x(null)}catch(C){const R=Ha(C,{});x(R),console.error("Error fetching roles:",C)}finally{h(!1)}})()},[]);const g=_=>a(_),b=_=>{i(_==="clear"?[]:C=>C.includes(_)?C.filter(R=>R!==_):[...C,_])},j=()=>{i([])},y=async _=>{try{h(!0);const C=await Cs.getRoleById(_.id),R=bb(C.permissionGroups),M={...C,permissions:R};d(M),m("view"),l(!0)}catch(C){const R=Ha(C,{});x(R),console.error("Error fetching role details:",C)}finally{h(!1)}},w=async _=>{try{h(!0);const C=await Cs.getRoleById(_.id),R=bb(C.permissionGroups),M={id:C.id,name:C.name,description:C.description||"",assignedUsers:C.userCount||0,status:Nl(C.isActive)?"Active":"Inactive",createdAt:C.createdAt?C.createdAt.split("T")[0]:"",lastModified:C.updatedAt?C.updatedAt.split("T")[0]:"",isActive:C.isActive,permissions:R,originalData:C};d(M),m("edit"),l(!0),x(null)}catch(C){const R=Ha(C,{});x(R)}finally{h(!1)}},S=()=>{d(null),m("add"),l(!0)},N=async _=>{if(window.confirm("Are you sure you want to delete this role?")){h(!0);try{await new Promise(C=>setTimeout(C,1e3)),t(C=>C.filter(R=>R.id!==_)),x(null)}catch{x("Failed to delete role")}finally{h(!1)}}},E=async _=>{h(!0);try{u==="add"?(await Cs.createRole(_),J.success("Role created successfully!")):(await Cs.updateRole(c.id,_),J.success("Role updated successfully!"));const C=await Cs.getRoles({includeDeleted:!0}),M=(Array.isArray(C)?C:C?.roles||[]).map(U=>({id:U.id,name:U.name,description:U.description||"",assignedUsers:U.userCount||0,status:Nl(U.isActive)?"Active":"Inactive",createdAt:U.createdAt?U.createdAt.split("T")[0]:"",lastModified:U.updatedAt?U.updatedAt.split("T")[0]:"",isActive:U.isActive,originalData:U}));t(M),l(!1),d(null),x(null)}catch(C){const R=Ha(C,{});x(R),J.error(R)}finally{h(!1)}},P=async _=>{h(!0);try{const C=e.find(me=>me.id===_);if(!C)throw new Error("Role not found");let R,M;Nl(C.isActive)?(R=await Cs.disableRole(_),M="disabled"):(R=await Cs.enableRole(_),M="enabled");const Z=await Cs.getRoles({includeDeleted:!0}),re=(Array.isArray(Z)?Z:Z?.roles||[]).map(me=>({id:me.id,name:me.name,description:me.description||"",assignedUsers:me.userCount||0,status:Nl(me.isActive)?"Active":"Inactive",createdAt:me.createdAt?me.createdAt.split("T")[0]:"",lastModified:me.updatedAt?me.updatedAt.split("T")[0]:"",isActive:me.isActive,originalData:me}));t(re);const z=R?.message||`Role has been ${M} successfully!`;J.success(z),x(null)}catch(C){const R=Ha(C,{});x(R)}finally{h(!1)}},T=[...new Set(e.map(_=>_.status))];return{roles:e.filter(_=>{const C=_.name.toLowerCase().includes(r.toLowerCase()),R=n.length===0||n.includes(_.status);return C&&R}),loading:f,error:p,searchTerm:r,selectedStatuses:n,uniqueStatuses:T,modalShow:o,selectedRole:c,modalMode:u,handleSearch:g,handleStatusToggle:b,handleClearFilters:j,handleView:y,handleEdit:w,handleAdd:S,handleDelete:N,handleSave:E,handleDisable:P,handleModalClose:()=>l(!1),setError:x}},rH=()=>{const[e,t]=v.useState(!1),[r,a]=v.useState(null),[n,i]=v.useState(!1),{roles:o,loading:l,error:c,searchTerm:d,selectedStatuses:u,uniqueStatuses:m,modalShow:f,selectedRole:h,modalMode:p,handleSearch:x,handleStatusToggle:g,handleClearFilters:b,handleView:j,handleEdit:y,handleAdd:w,handleSave:S,handleDisable:N,handleModalClose:E}=tH(),P=C=>{a(C),t(!0)},T=async()=>{if(r){i(!0);try{await N(r.id),t(!1),a(null)}catch(C){console.error("Error disabling role:",C)}finally{i(!1)}}},O=()=>{t(!1),a(null)},_=({role:C})=>s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>j(C),permission:Te.VIEW_ROLE_IN_DETAIL},{label:"Edit Role",icon:s.jsx(Yr,{}),onClick:()=>y(C),permission:Te.UPDATE_ROLE},...C.name.toUpperCase()!=="ADMINISTRATOR"?[{type:"divider"},{label:C.status==="Active"?"Disable Role":"Enable Role",icon:s.jsx(Sc,{}),className:C.status==="Active"?"text-warning":"text-success",onClick:()=>P(C),permission:Te.DISABLE_ROLE}]:[]]});return Q.useEffect(()=>{c&&J.error(c)},[c]),s.jsx(Ce,{fluid:!0,className:"py-4 role-management-page",children:s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"bg-light-custom border-neutral-200",children:s.jsx(de,{className:"align-items-center",children:s.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(yt,{permission:Te.CREATE_ROLE,fallback:null,children:s.jsxs(te,{variant:"primary-custom",size:"sm",onClick:w,className:"d-flex align-items-center",children:[s.jsx(Gr,{className:"me-1",size:16}),"Add Role"]})})})})})}),s.jsxs(W.Body,{children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search roles by name...",value:d,onChange:x,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(JW,{uniqueStatuses:m,selectedStatuses:u,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[o.length," role",o.length!==1?"s":""]})})})]}),s.jsx(eH,{roles:o,loading:l,actionsComponent:_,onView:j,onEdit:y,onDisable:N}),s.jsx(QW,{show:f,role:h,mode:p,onSave:S,onClose:E}),s.jsx(XW,{show:e,role:r,onConfirm:T,onCancel:O,loading:n})]})]})})},sH=({show:e,department:t,onClose:r})=>{if(!e||!t)return null;const a=n=>{switch(n){case"CCT":return"bg-info";case"FCTD":return"bg-success";case"GOT":return"bg-warning";case"SQA":return"bg-secondary";default:return"bg-dark"}};return s.jsxs(ce,{show:e,onHide:r,size:"lg",centered:!0,style:{maxHeight:"100vh"},children:[s.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Vs,{className:"me-2",size:20}),"Department Details"]})}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(de,{className:"mb-4",children:[s.jsxs(H,{md:8,children:[s.jsx("h3",{className:"fw-bold text-dark mb-2",children:t.name}),s.jsx("p",{className:"text-muted mb-3",children:t.description})]}),s.jsx(H,{md:4,className:"text-end",children:s.jsx(ke,{bg:t.status==="ACTIVE"?"success":"secondary",className:"px-3 py-2 fs-6",children:t.status})})]}),s.jsxs(de,{className:"mb-4",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Code"}),s.jsx("div",{className:"p-3 bg-light rounded",children:s.jsx(ke,{bg:"primary",className:"px-3 py-2 fs-6",children:t.code})})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Type"}),s.jsx("div",{className:"p-3 bg-light rounded",children:s.jsx(ke,{bg:a(t.type).replace("bg-",""),className:"px-3 py-2 fs-6",children:t.type})})]})})]}),s.jsx(de,{className:"mb-4",children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Head"}),s.jsx("div",{className:"p-3 bg-light rounded",children:t.departmentHead?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(_n,{className:"me-3 text-primary",size:24}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold text-dark",children:t.departmentHead.name}),s.jsx("div",{className:"text-muted",children:t.departmentHead.email})]})]}):s.jsx("span",{className:"text-muted italic",children:"Not assigned"})})]})})}),s.jsx(de,{className:"mb-4",children:s.jsxs(H,{md:12,children:[s.jsx("label",{className:"form-label fw-semibold text-dark mb-3",children:"Department Statistics"}),s.jsxs(de,{children:[s.jsx(H,{md:4,children:s.jsxs("div",{className:"bg-primary bg-opacity-10 p-4 rounded text-center",children:[s.jsx(Dt,{className:"text-primary mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-primary mb-1",children:t.coursesCount||0}),s.jsx("div",{className:"text-primary fw-semibold",children:"Courses"})]})}),s.jsx(H,{md:4,children:s.jsxs("div",{className:"bg-success bg-opacity-10 p-4 rounded text-center",children:[s.jsx(Mr,{className:"text-success mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-success mb-1",children:t.traineesCount||0}),s.jsx("div",{className:"text-success fw-semibold",children:"Trainees"})]})}),s.jsx(H,{md:4,children:s.jsxs("div",{className:"bg-info bg-opacity-10 p-4 rounded text-center",children:[s.jsx(_n,{className:"text-info mb-2",size:32}),s.jsx("div",{className:"h3 fw-bold text-info mb-1",children:t.trainersCount||0}),s.jsx("div",{className:"text-info fw-semibold",children:"Trainers"})]})})]})]})}),s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Created Date"}),s.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.createdAt).toLocaleDateString()})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label fw-semibold text-dark",children:"Last Updated"}),s.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.updatedAt).toLocaleDateString()})]})})]})]}),s.jsx(ce.Footer,{className:"border-0 p-4",children:s.jsxs("button",{className:"btn btn-secondary",onClick:r,children:[s.jsx(st,{className:"me-2",size:16}),"Close"]})})]})},aH=({uniqueTypes:e,uniqueStatuses:t,selectedTypes:r,selectedStatuses:a,onTypeToggle:n,onStatusToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||a.length>0;return s.jsxs(St,{className:`filter-panel-dropdown ${l}`,children:[s.jsx(St.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(oo,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(St.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Department Code"}),r.length>0&&s.jsx(te,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:s.jsx(st,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>s.jsx(k.Check,{type:"checkbox",id:`type-${d}`,label:d,checked:r.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),a.length>0&&s.jsx(te,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(st,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>s.jsx(k.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:a.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(te,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[s.jsx(st,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},nH=({show:e,department:t,mode:r,onSave:a,onClose:n,availableUsers:i})=>{const[o,l]=v.useState({name:"",code:"",description:"",departmentHeadId:""}),[c,d]=v.useState({}),[u,m]=v.useState(!1);v.useEffect(()=>{t&&r!=="add"?l({name:t.name||"",code:t.code||"",description:t.description||"",departmentHeadId:t.departmentHeadId||""}):r==="add"&&l({name:"",code:"",description:"",departmentHeadId:""}),d({})},[t,r,e]);const f=()=>{const b={};return o.name.trim()?o.name.trim().length<3?b.name="Department name must be at least 3 characters":/^[a-zA-Z0-9\s]+$/.test(o.name.trim())||(b.name="Department name cannot contain special characters"):b.name="Department name is required",o.code.trim()||(b.code="Department code is required"),o.departmentHeadId||(b.departmentHeadId="Department head is required"),d(b),Object.keys(b).length===0},h=async b=>{if(b.preventDefault(),!!f()){m(!0);try{const j={name:o.name.trim(),code:o.code.trim(),description:o.description.trim(),headUserId:o.departmentHeadId};console.log(" Department data being sent:",j),await a(j)}catch(j){console.error("Error saving department:",j)}finally{m(!1)}}},p=(b,j)=>{l(y=>({...y,[b]:j})),c[b]&&d(y=>({...y,[b]:""}))},x=()=>{switch(r){case"add":return"Add New Department";case"edit":return"Edit Department";case"view":return"Department Details";default:return"Department"}},g=r==="view";return s.jsxs(ce,{show:e,onHide:n,size:"lg",centered:!0,children:[s.jsx(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[r==="view"?s.jsx(Bt,{className:"me-2",size:20}):s.jsx(us,{className:"me-2",size:20}),x()]})}),s.jsxs(k,{onSubmit:h,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(c).length>0&&s.jsxs("div",{className:"alert alert-danger mb-3",children:[s.jsx("strong",{children:"Please fix the following errors:"}),s.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(c).map(([b,j])=>s.jsx("li",{children:j},b))})]}),s.jsxs(de,{children:[s.jsx(H,{md:8,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Department Name *"}),s.jsx(k.Control,{type:"text",value:o.name,onChange:b=>p("name",b.target.value),isInvalid:!!c.name,readOnly:g,placeholder:"Enter department name",style:{borderColor:c.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:c.name})]})}),s.jsx(H,{md:4,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Department Code *"}),s.jsx(k.Control,{type:"text",value:o.code,onChange:b=>p("code",b.target.value.toUpperCase()),isInvalid:!!c.code,readOnly:g,placeholder:"e.g., CCT",style:{borderColor:c.code?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),s.jsx(k.Control.Feedback,{type:"invalid",children:c.code})]})})]}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Department Head *"}),s.jsxs(k.Select,{value:o.departmentHeadId,onChange:b=>p("departmentHeadId",b.target.value),isInvalid:!!c.departmentHeadId,disabled:g,style:{borderColor:c.departmentHeadId?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[s.jsx("option",{value:"",children:"Select department head"}),i.map(b=>s.jsxs("option",{value:b.id,children:[b.lastName,b.middleName?" "+b.middleName:""," ",b.firstName," (",b.eid,")"]},b.id))]}),s.jsx(k.Control.Feedback,{type:"invalid",children:c.departmentHeadId})]})})}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Description"}),s.jsx(k.Control,{as:"textarea",rows:4,value:o.description,onChange:b=>p("description",b.target.value),readOnly:g,placeholder:"Enter department description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),r==="view"&&t&&s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Courses Count"}),s.jsx(k.Control,{type:"text",value:t.coursesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Trainees Count"}),s.jsx(k.Control,{type:"text",value:t.traineesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Trainers Count"}),s.jsx(k.Control,{type:"text",value:t.trainersCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Created Date"}),s.jsx(k.Control,{type:"text",value:new Date(t.createdAt).toLocaleDateString(),readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:n,disabled:u,children:[s.jsx(st,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&s.jsx(te,{variant:"primary-custom",type:"submit",disabled:u,children:u?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),r==="add"?"Add Department":"Save Changes"]})})]})]})]})},iH=({department:e,index:t,onView:r,onToggleStatus:a})=>{const n=o=>o==="ACTIVE"?"success":"secondary",i=o=>o==="ACTIVE"?"":"";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:e.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(ke,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.code})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.departmentHead?(()=>{const{lastName:o,middleName:l,firstName:c}=e.departmentHead;return[o,l,c].filter(Boolean).join(" ")||e.departmentHead.name||"Not assigned"})():"Not assigned"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.coursesCount})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.traineesCount})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:e.trainersCount})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsxs(ke,{bg:n(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:i(e.status)}),e.status]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(yt,{permissions:[Te.VIEW_DEPARTMENT_IN_DETAIL,Te.UPDATE_DEPARTMENT],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[...e.status==="ACTIVE"?[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>r(e),permission:Te.VIEW_DEPARTMENT_IN_DETAIL}]:[],...e.status==="ACTIVE"?[{type:"divider"}]:[],{label:e.status==="ACTIVE"?"Deactivate":"Activate",icon:s.jsx(Sc,{}),className:e.status==="ACTIVE"?"text-danger":"text-success",onClick:()=>a(e),permission:Te.UPDATE_DEPARTMENT}]})})})]})},oH=({departments:e,loading:t,onView:r,onToggleStatus:a})=>{const{sortedData:n,sortConfig:i,handleSort:o}=_r(e);if(t)return s.jsx(nr,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No departments found"}),s.jsx("p",{children:"Try adjusting your search criteria or add a new department."})]})});const l=({columnKey:c,children:d,className:u=""})=>{const m=i.key===c,f=m?i.direction:null;return s.jsxs("th",{className:`fw-semibold ${u}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(c),onMouseEnter:h=>{h.target.style.backgroundColor="#214760",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="var(--bs-primary)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"600":"500",color:"white"},children:d}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:f,size:14,color:"white"})})]}),m&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"scrollable-table-container",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive table-padded",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(l,{columnKey:"name",className:"show-mobile",children:"Department Name"}),s.jsx(l,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(l,{columnKey:"departmentHead.name",className:"hide-mobile",children:"Department Head"}),s.jsx(l,{columnKey:"coursesCount",className:"hide-mobile",children:"Courses"}),s.jsx(l,{columnKey:"traineesCount",className:"hide-mobile",children:"Trainees"}),s.jsx(l,{columnKey:"trainersCount",className:"hide-mobile",children:"Trainers"}),s.jsx(l,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:n.map((c,d)=>s.jsx(iH,{department:c,index:d,onView:r,onToggleStatus:a},c.id))})]})})},lH=({show:e,department:t,onConfirm:r,onCancel:a,isProcessing:n})=>{const[i,o]=v.useState({courseCount:0,traineeCount:0,trainerCount:0}),[l,c]=v.useState(!1),[d,u]=v.useState(null),[m,f]=v.useState(null);v.useEffect(()=>{e&&t?.id&&h()},[e,t?.id]);const h=async()=>{if(t?.id){c(!0);try{const j=await Vt.getDepartmentById(t.id);console.log(" DisableDepartmentModal - Full API response:",j),console.log(" DisableDepartmentModal - Department Head data:",j.departmentHead||j.headUser),u(j);const y=j.departmentHead||j.headUser;if(y&&y.id&&!y.eid)try{const w=await Ys.getUserById(y.id);console.log(" DisableDepartmentModal - Head User detail from API:",w),f(w)}catch(w){console.warn(" Could not fetch headUser detail:",w)}o({courseCount:j.courseCount||j.coursesCount||0,traineeCount:j.traineeCount||j.traineesCount||0,trainerCount:j.trainerCount||j.trainersCount||0})}catch(j){console.error("Error fetching department statistics:",j),u(null),f(null),o({courseCount:t.courseCount||t.coursesCount||0,traineeCount:t.traineeCount||t.traineesCount||0,trainerCount:t.trainerCount||t.trainersCount||0})}finally{c(!1)}}};if(!t)return null;const p=t.status==="ACTIVE",x=p?"deactivate":"activate",g=p?"Deactivate":"Activate",b=!p||i.courseCount===0&&i.traineeCount===0&&i.trainerCount===0;return s.jsxs(ce,{show:e,onHide:a,centered:!0,children:[s.jsx(ce.Header,{className:"border-0 pb-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Jt,{className:"me-2 text-warning",size:20}),g," Department"]})}),s.jsxs(ce.Body,{className:"pt-0",children:[s.jsx(De,{variant:p?"warning":"info",className:"mb-3",style:{backgroundColor:"#e3f2fd",borderColor:"#1b3c53",color:"#1b3c53"},children:s.jsx("div",{className:"d-flex align-items-start",children:s.jsxs("div",{children:[s.jsxs("strong",{children:["Are you sure you want to ",x," this department?"]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Department:"})," ",t.name," (",t.code,")"]}),p&&s.jsx("div",{className:"mt-2",children:b?s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Warning:"})," Deactivating this department will:",s.jsxs("ul",{className:"mb-0 mt-1",children:[s.jsx("li",{children:"Make it unavailable for new course assignments"}),s.jsx("li",{children:"Hide it from department selection dropdowns"}),s.jsx("li",{children:"Not affect existing courses and users"})]})]}):s.jsxs("div",{className:"text-danger",children:[s.jsx("strong",{children:"Cannot deactivate:"})," This department has active courses, trainees, or trainers. Please remove all courses, trainees, and trainers before deactivating."]})}),!p&&s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Note:"})," Activating this department will make it available for:",s.jsxs("ul",{className:"mb-0 mt-1",children:[s.jsx("li",{children:"New course assignments"}),s.jsx("li",{children:"Department selection in forms"}),s.jsx("li",{children:"User management operations"})]})]})]})})}),s.jsxs("div",{className:"bg-light p-4 rounded",children:[s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("strong",{className:"mb-1",children:"Department Head:"}),s.jsx("span",{className:"text-muted text-break",children:(()=>{const j=d||t;let y=j.departmentHead||j.headUser;if(y&&m&&(y={...y,...m}),y){console.log(" Department Head object:",y);let w="";if(y.name)w=y.name;else if(y.firstName||y.lastName){const N=[];y.firstName&&N.push(y.firstName),y.middleName&&N.push(y.middleName),y.lastName&&N.push(y.lastName),w=N.join(" ").trim()}else y.fullName&&(w=y.fullName);const S=m?.eid||m?.employeeId||y.eid||y.employeeId||"";if(console.log(" Name:",w,"EID:",S||"NOT FOUND"),w&&S)return`${w} [${S}]`;if(w)return w;if(S)return`[${S}]`;if(y.email)return console.warn(" No name or EID found in headUser object, showing email as fallback"),console.warn(" headUser object keys:",Object.keys(y)),y.email}return"N/A"})()})]})}),s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("strong",{className:"mb-1",children:"Current Status:"}),s.jsx("span",{className:`badge ${t.status==="ACTIVE"?"bg-success":"bg-secondary"}`,style:{width:"fit-content",backgroundColor:t.status==="ACTIVE"?"#28a745":"#1b3c53"},children:t.status})]})})]}),s.jsx("hr",{className:"my-3"}),s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[l?s.jsx(ct,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.courseCount}),s.jsx("small",{className:"text-muted",children:"Courses"})]})}),s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[l?s.jsx(ct,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.traineeCount}),s.jsx("small",{className:"text-muted",children:"Trainees"})]})}),s.jsx("div",{className:"col-4",children:s.jsxs("div",{className:"text-center",children:[l?s.jsx(ct,{animation:"border",size:"sm",className:"text-primary"}):s.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.trainerCount}),s.jsx("small",{className:"text-muted",children:"Trainers"})]})})]})]})]}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsxs(te,{variant:"outline-secondary",onClick:a,disabled:n,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:p?"warning":"success",onClick:r,disabled:n||p&&!b,style:{backgroundColor:p?"#ffc107":"#28a745",borderColor:p?"#ffc107":"#28a745",opacity:p&&!b?.5:1},children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Jt,{className:"me-2",size:16}),p&&!b?"Cannot Deactivate":`${g} Department`]})})]})]})},cH=()=>{const e=tt(),{hasPermission:t}=Fn(),r=t(Te.VIEW_ALL_DEPARTMENTS),{loading:a,searchTerm:n,setSearchTerm:i,createDepartment:o,updateDepartment:l,disableDepartment:c,enableDepartment:d,getAvailableUsers:u}=Yx(r),[m,f]=v.useState(!1),[h,p]=v.useState(!1),[x,g]=v.useState(!1),[b,j]=v.useState("add"),[y,w]=v.useState(null),[S,N]=v.useState([]),[E,P]=v.useState(!0),[T,O]=v.useState([]),[_,C]=v.useState([]),[R,M]=v.useState([]);v.useEffect(()=>{(async()=>{try{P(!0);let ue;if(r)ue=await Vt.getDepartments();else{const Ne=await Vt.getMyDepartment();ue=Ne?[Ne]:[]}const L=ue.map(Ne=>({id:Ne.id,name:Ne.name,code:Ne.code,type:Ne.code,description:Ne.description,departmentHeadId:Ne.headUserId,departmentHead:Ne.headUser?{id:Ne.headUser.id,name:Ne.headUser.name||Ne.headUser.email,email:Ne.headUser.email,role:Ne.headUser.role,lastName:Ne.headUser.lastName,middleName:Ne.headUser.middleName,firstName:Ne.headUser.firstName}:null,status:Ne.isActive===!0?"ACTIVE":"INACTIVE",coursesCount:Ne.courseCount||Ne.coursesCount||0,traineesCount:Ne.traineeCount||Ne.traineesCount||0,trainersCount:Ne.trainerCount||Ne.trainersCount||0,createdAt:Ne.createdAt,updatedAt:Ne.updatedAt,deletedAt:Ne.deletedAt,courses:Ne.courses||[]}));N(L)}catch(ue){console.error("Error loading departments:",ue),J.error("Failed to load departments"),N([])}finally{P(!1)}})()},[r]),v.useEffect(()=>{(async()=>{try{const ue=await u();M(ue)}catch(ue){console.error("Error loading available users:",ue),M([])}})()},[u]);const U=()=>{w(null),j("add"),f(!0)},Z=G=>{e(je.DEPARTMENTS_DETAIL(G.id))},ee=G=>{w(G),p(!0)},re=()=>{f(!1),w(null),j("add")},z=()=>{p(!1),w(null)},me=()=>{g(!1),w(null)},ne=async G=>{try{b==="add"?(await o(G),J.success("Department created successfully")):b==="edit"&&(await l(y.id,G),J.success("Department updated successfully")),re()}catch(ue){console.error("Error saving department:",ue);const L=ue?.response?.data;let Ne=ue?.message||"Failed to save department";if(L?.message&&(Array.isArray(L.message)?Ne=L.message.map(Oe=>Oe.message||Oe).join(", "):Ne=L.message),L?.errors&&Array.isArray(L.errors)){const Oe=L.errors.map(We=>We.message||JSON.stringify(We)).filter(Boolean).join(", ");Oe&&(Ne=Oe)}J.error(Ne)}},A=async()=>{try{y&&(y.status==="ACTIVE"?(await c(y.id),J.success("Department disabled successfully")):(await d(y.id),J.success("Department enabled successfully")),z())}catch(G){console.error("Error toggling department status:",G),J.error("Failed to toggle department status")}},D=G=>{i(G)},I=G=>{O(G==="clear"?[]:ue=>ue.includes(G)?ue.filter(L=>L!==G):[...ue,G])},V=G=>{C(G==="clear"?[]:ue=>ue.includes(G)?ue.filter(L=>L!==G):[...ue,G])},ie=()=>{O([]),C([])},se=[...new Set(S.map(G=>G.type).filter(Boolean))],ae=["ACTIVE","INACTIVE"],K=S.filter(G=>{const ue=T.length===0||T.includes(G.type),L=_.length===0||_.includes(G.status),Ne=!n||G.name.toLowerCase().includes(n.toLowerCase())||G.code.toLowerCase().includes(n.toLowerCase())||G.description.toLowerCase().includes(n.toLowerCase());return ue&&L&&Ne});return s.jsxs(Ce,{fluid:!0,className:"py-4 department-management-page",children:[s.jsxs(W,{className:"shadow-sm",children:[s.jsx(W.Header,{className:"bg-white border-0 pb-0",children:s.jsx(de,{className:"align-items-center",children:s.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(yt,{permission:Te.CREATE_DEPARTMENT,fallback:null,children:s.jsxs(te,{variant:"primary-custom",size:"sm",onClick:U,className:"d-flex align-items-center",children:[s.jsx(Gr,{className:"me-1",size:16}),"Add Department"]})})})})})}),s.jsxs(W.Body,{children:[s.jsxs(de,{className:"mb-4 form-mobile-stack",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search departments by name, code, or description...",value:n,onChange:D,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(aH,{uniqueTypes:se,uniqueStatuses:ae,selectedTypes:T,selectedStatuses:_,onTypeToggle:I,onStatusToggle:V,onClearFilters:ie,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[K.length," department",K.length!==1?"s":""]})})})]}),s.jsx("div",{className:"position-relative mt-3",children:s.jsx(oH,{departments:K,loading:E||a,onView:Z,onToggleStatus:ee})})]})]}),m&&s.jsx(nH,{show:m,department:y,mode:b,onSave:ne,onClose:re,availableUsers:R}),h&&y&&s.jsx(lH,{show:h,department:y,onConfirm:A,onCancel:z,isProcessing:a}),x&&y&&s.jsx(sH,{show:x,department:y,onClose:me})]})},dH=({department:e,onBack:t})=>s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-start mb-3",children:[s.jsx(te,{variant:"outline-secondary",onClick:t,className:"me-3 mt-1",size:"sm",children:s.jsx(At,{})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:e.name}),s.jsx("p",{className:"text-muted mb-0",children:e.description})]})]})})}),uH=({activeTab:e,onTabChange:t})=>{const r=[{id:"info",label:"Department Info",icon:Y2,description:"View department overview"},{id:"edit",label:"Edit Details",icon:Yr,description:"Modify department information"}];return s.jsxs("div",{className:"department-tabs",children:[s.jsx("div",{className:"tab-navigation",children:r.map(a=>{const n=a.icon,i=e===a.id;return s.jsxs("button",{className:`tab-button ${i?"active":""}`,onClick:()=>t(a.id),children:[s.jsx("div",{className:"tab-icon",children:s.jsx(n,{size:20})}),s.jsxs("div",{className:"tab-content",children:[s.jsx("div",{className:"tab-label",children:a.label}),s.jsx("div",{className:"tab-description",children:a.description})]}),i&&s.jsx("div",{className:"tab-indicator"})]},a.id)})}),s.jsx("div",{className:"tab-separator"})]})},mH=e=>({id:e.id,name:e.name,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),fH=({department:e,onUpdate:t})=>{const[r,a]=v.useState({name:e.name||"",code:e.code||"",description:e.description||"",headUserId:e.headUserId||""}),[n,i]=v.useState(!1),[o,l]=v.useState([]);v.useEffect(()=>{(async()=>{try{const m=await Vt.getDepartmentHeads(),f=m?.users||m?.data?.users||[];l(f)}catch(m){console.error("Error loading department heads:",m),J.error("Failed to load department heads"),l([])}})()},[]);const c=u=>{const{name:m,value:f}=u.target;a(h=>({...h,[m]:f}))},d=async u=>{u.preventDefault(),i(!0);try{if(!r.name||r.name.trim()===""){J.error("Department name is required"),i(!1);return}if(!r.code||r.code.trim()===""){J.error("Department code is required"),i(!1);return}console.log(" Submitting department update:",{departmentId:e.id,formData:r});const m=await Vt.updateDepartment(e.id,r),f=mH(m);t(f),J.success("Department updated successfully!")}catch(m){console.error(" Error updating department:",m);let f="Failed to update department";m.code==="NETWORK_ERROR"?f="Network error: Unable to connect to server. Please check your connection.":m.code==="BAD_GATEWAY"?f="Server error (502): The server is temporarily unavailable. Please try again later.":m.code==="PERMISSION_DENIED"?f="Permission denied: You do not have permission to update this department.":m.response?.data?.message?f=m.response.data.message:m.message&&(f=m.message),J.error(f)}finally{i(!1)}};return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Edit Department Details"}),s.jsxs("form",{onSubmit:d,children:[s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"name",className:"form-label",children:"Department Name"}),s.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",value:r.name,onChange:c,required:!0})]})})}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"code",className:"form-label",children:"Department Code"}),s.jsx("input",{type:"text",className:"form-control",id:"code",name:"code",value:r.code,onChange:c,placeholder:"e.g., CCT",required:!0})]})})}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"headUserId",className:"form-label",children:"Department Head"}),s.jsxs("select",{className:"form-select",id:"headUserId",name:"headUserId",value:r.headUserId,onChange:c,children:[s.jsx("option",{value:"",children:"Select Department Head"}),Array.isArray(o)&&o.map(u=>s.jsxs("option",{value:u.id,children:["[",u.eid,"] - ",u.lastName,u.middleName?" "+u.middleName:""," ",u.firstName]},u.id))]})]})})}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),s.jsx("textarea",{className:"form-control",id:"description",name:"description",rows:"4",value:r.description,onChange:c})]}),s.jsx("div",{className:"d-flex gap-2",children:s.jsx(te,{type:"submit",variant:"primary",disabled:n,children:n?"Updating...":"Update Department"})})]})]})},jb=({department:e})=>{const t=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return s.jsxs("div",{className:"department-info",children:[s.jsx("h4",{className:"mb-4",children:"Department Overview"}),s.jsxs(de,{className:"g-4",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"info-card info-card-basic",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(Dt,{className:"info-icon"}),s.jsx("h6",{children:"Basic Information"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Name:"}),s.jsx("span",{className:"info-value",children:e.name})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Code:"}),s.jsx("span",{className:"info-value",children:e.code||"N/A"})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Description:"}),s.jsx("span",{className:"info-value",children:e.description||"No description provided"})]})]})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"info-card info-card-statistics",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(Mr,{className:"info-icon"}),s.jsx("h6",{children:"Department Statistics"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Courses:"}),s.jsx("span",{className:"info-value",children:e.courseCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Trainees:"}),s.jsx("span",{className:"info-value",children:e.traineeCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Total Trainers:"}),s.jsx("span",{className:"info-value",children:e.trainerCount||0})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Head of Department:"}),s.jsx("span",{className:"info-value",children:e.headUser?`${e.headUser.lastName}${e.headUser.middleName?" "+e.headUser.middleName:""} ${e.headUser.firstName}`.trim():"Not assigned"})]})]})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"info-card info-card-timeline",children:[s.jsxs("div",{className:"info-header",children:[s.jsx(or,{className:"info-icon"}),s.jsx("h6",{children:"Timeline"})]}),s.jsxs("div",{className:"info-content",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Created:"}),s.jsx("span",{className:"info-value",children:t(e.createdAt)})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Last Updated:"}),s.jsx("span",{className:"info-value",children:t(e.updatedAt)})]}),e.deletedAt&&s.jsxs("div",{className:"info-item",children:[s.jsx("span",{className:"info-label",children:"Deleted:"}),s.jsx("span",{className:"info-value",children:t(e.deletedAt)})]})]})]})})]})]})},hH=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,trainers:e.trainers||[],createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),pH=()=>{const{id:e}=ur(),t=tt(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState("info"),u=v.useCallback(async()=>{if(!e){J.error("Department ID is required"),i(!1);return}i(!0),l(null);try{const p=await Vt.getDepartmentById(e),x=hH(p);a(x)}catch(p){console.error("Error loading department:",p),J.error("Failed to load department details"),l("Failed to load department details")}finally{i(!1)}},[e]);v.useEffect(()=>{u()},[u]);const m=()=>{t(je.DEPARTMENTS)},f=p=>{d(p)};if(n)return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:s.jsx(ct,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(o)return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsxs("div",{className:"text-danger mb-3",children:[s.jsx("h5",{children:"Unable to load department"}),s.jsx("p",{className:"text-muted",children:"Please try again or contact support if the problem persists."})]}),s.jsxs(te,{variant:"outline-primary",onClick:m,children:[s.jsx(At,{className:"me-2"}),"Back to Departments"]})]})});if(!r)return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsxs("div",{className:"text-warning mb-3",children:[s.jsx("h5",{children:"Department not found"}),s.jsx("p",{className:"text-muted",children:"The department you're looking for doesn't exist or has been removed."})]}),s.jsxs(te,{variant:"outline-primary",onClick:m,children:[s.jsx(At,{className:"me-2"}),"Back to Departments"]})]})});const h=()=>{switch(c){case"info":return s.jsx(jb,{department:r});case"edit":return s.jsx(fH,{department:r,onUpdate:a});default:return s.jsx(jb,{department:r})}};return s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(dH,{department:r,onBack:m}),s.jsx(uH,{activeTab:c,onTabChange:f}),s.jsx(de,{children:s.jsx(H,{children:s.jsx(W,{className:"shadow-sm",children:s.jsx(W.Body,{className:"p-4",children:h()})})})})]})},xH=({show:e,onClose:t,onSave:r,loading:a=!1})=>{const[n,i]=v.useState({newPassword:"",confirmPassword:""}),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[u,m]=v.useState({show:!1,message:"",variant:"success"}),f=x=>{const{name:g,value:b}=x.target;i(j=>({...j,[g]:b})),u.show&&m({show:!1,message:"",variant:"success"})},h=async x=>{if(x.preventDefault(),n.newPassword!==n.confirmPassword){m({show:!0,message:"New password and confirm password do not match.",variant:"danger"});return}if(n.newPassword.length<6){m({show:!0,message:"New password must be at least 6 characters long.",variant:"danger"});return}try{await r(n),m({show:!0,message:"Password updated successfully!",variant:"success"}),i({newPassword:"",confirmPassword:""}),setTimeout(()=>{t(),m({show:!1,message:"",variant:"success"})},1500)}catch{m({show:!0,message:"Failed to update password. Please check your current password.",variant:"danger"})}},p=()=>{i({newPassword:"",confirmPassword:""}),m({show:!1,message:"",variant:"success"}),t()};return s.jsxs(ce,{show:e,onHide:p,size:"md",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary text-white",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Xl,{className:"me-2",size:20}),"Change Password"]}),s.jsx(te,{variant:"link",className:"text-white p-0",onClick:p,style:{textDecoration:"none"},children:s.jsx(st,{size:20})})]}),s.jsxs(ce.Body,{className:"p-4",children:[u.show&&s.jsx(De,{variant:u?.variant,className:"mb-3",children:u?.message}),s.jsxs(k,{onSubmit:h,children:[s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"fw-semibold",children:"New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(k.Control,{type:o?"text":"password",name:"newPassword",value:n.newPassword,onChange:f,required:!0,minLength:6,placeholder:"Enter new password"}),s.jsx(te,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>l(!o),type:"button",children:o?s.jsx(Yl,{size:16}):s.jsx(Bt,{size:16})})]})]}),s.jsxs(k.Group,{className:"mb-4",children:[s.jsx(k.Label,{className:"fw-semibold",children:"Confirm New Password"}),s.jsxs("div",{className:"position-relative",children:[s.jsx(k.Control,{type:c?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:f,required:!0,minLength:6,placeholder:"Confirm new password"}),s.jsx(te,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>d(!c),type:"button",children:c?s.jsx(Yl,{size:16}):s.jsx(Bt,{size:16})})]})]}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx(te,{variant:"outline-secondary",onClick:p,disabled:a,children:"Cancel"}),s.jsx(te,{type:"submit",variant:"secondary",disabled:a,children:a?"Updating...":s.jsxs(s.Fragment,{children:[s.jsx(Xl,{size:16,className:"me-1"}),"Change Password"]})})]})]})]})]})},gH=({profileData:e,user:t,onResetPassword:r,onAvatarSelected:a,onConfigureSignature:n,onSaveChanges:i,loading:o})=>{const l=v.useRef(null),[c,d]=v.useState(!1),[u,m]=v.useState(null),f=w=>({ADMIN:"danger",DEPT_HEAD:"primary",TRAINER:"info",TRAINEE:"success",ACADEMIC_DEPT:"warning",ACADEMIC_DEPARTMENT:"warning",SQA_AUDITOR:"secondary"})[w]||"secondary",h=()=>e&&[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||"User Name",p=()=>e?.email||t?.email||"user@example.com",x=()=>{const w=e?.role?.name||t?.role||"USER";return w==="ACADEMIC_DEPARTMENT"||w==="ACADEMIC_DEPT"?"ACADEMIC_DEPT":w},g=u||e?.avatarUrl||"",b=()=>{l.current&&l.current.click()},j=(w,S=200,N=200,E=.8)=>new Promise(P=>{const T=document.createElement("canvas"),O=T.getContext("2d"),_=new window.Image;_.onload=()=>{let{width:C,height:R}=_;C>R?C>S&&(R=R*S/C,C=S):R>N&&(C=C*N/R,R=N),T.width=C,T.height=R,O.drawImage(_,0,0,C,R);const M=T.toDataURL("image/jpeg",E);P(M)},_.src=URL.createObjectURL(w)}),y=async w=>{const S=w.target.files&&w.target.files[0];if(S){if(S.size>5*1024*1024){J.error("File size too large. Please choose an image smaller than 5MB.");return}try{const N=await j(S,200,200,.7);m(N),a&&a(S)}catch(N){console.error("Preview avatar failed:",N),m(null)}}};return s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[g?s.jsx(F5,{roundedCircle:!0,src:g,alt:"Avatar",style:{width:"120px",height:"120px",objectFit:"cover"}}):s.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center",style:{width:"120px",height:"120px",margin:"0 auto"},children:s.jsx(Pt,{size:48,className:"text-white"})}),s.jsx("button",{className:"position-absolute rounded-circle border border-2 border-white shadow-sm",style:{width:"36px",height:"36px",bottom:"0px",right:"0px",transform:"translate(40%, 30%)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",cursor:"pointer",fontSize:"18px",color:"#456882",fontWeight:"bold",backgroundColor:"#d2c1b6",lineHeight:"1"},onClick:b,disabled:c,children:""}),s.jsx("input",{ref:l,type:"file",accept:"image/*",className:"d-none",onChange:y})]}),s.jsx("h4",{className:"mb-1",children:h()}),s.jsx("p",{className:"text-muted mb-2",children:p()}),s.jsx(ke,{bg:f(x()),className:"mb-3",children:x()}),s.jsx("div",{className:"text-start",children:s.jsxs("div",{className:"d-flex flex-column gap-2",children:[s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:r,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[s.jsx(Xl,{size:14,className:"me-2"}),"Reset Password"]}),x()==="TRAINER"&&s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:n,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[s.jsx(Gi,{size:14,className:"me-2"}),"Configure Signature"]}),s.jsx(te,{variant:"primary",size:"sm",onClick:i,disabled:o,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:o?"Saving...":s.jsxs(s.Fragment,{children:[s.jsx(us,{size:14,className:"me-2"}),"Save Changes"]})})]})})]})})},vH=({profileData:e,user:t,onUpdate:r,loading:a=!1})=>{const[n,i]=v.useState(!1),[o,l]=v.useState({firstName:"",lastName:"",middleName:"",email:"",phoneNumber:"",address:"",gender:"",avatarUrl:""}),[c,d]=v.useState(!1);v.useEffect(()=>{if(e&&e.firstName){const f={firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",email:e.email||"",phoneNumber:e.phoneNumber||"",address:e.address||"",gender:e.gender||"",avatarUrl:e.avatarUrl||""};l(f),d(!0)}},[e,c]);const u=f=>{const{name:h,value:p}=f.target;l(x=>({...x,[h]:p}))},m=async f=>{f.preventDefault(),i(!0);try{r?await r(o):(await on.updateProfile(o),J.success("Personal information updated successfully!"))}catch(h){console.error("Error updating personal info:",h),r||J.error("Failed to update personal information. Please try again.")}finally{i(!1)}};return s.jsxs(W,{children:[s.jsx(W.Header,{className:"bg-primary text-white border-0",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{size:20,className:"me-2 text-white"}),s.jsx("h5",{className:"mb-0 text-white",children:"Personal Information"})]})}),s.jsx(W.Body,{children:s.jsxs(k,{onSubmit:m,children:[s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"First Name"}),s.jsx(k.Control,{type:"text",name:"firstName",value:o.firstName,onChange:u,disabled:!0,required:!0})]})}),s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Middle Name"}),s.jsx(k.Control,{type:"text",name:"middleName",value:o.middleName,onChange:u,disabled:!0})]})}),s.jsx("div",{className:"col-md-4 mb-3",children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Last Name"}),s.jsx(k.Control,{type:"text",name:"lastName",value:o.lastName,onChange:u,disabled:!0,required:!0})]})})]}),s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Email"}),s.jsx(k.Control,{type:"email",name:"email",value:o.email,onChange:u,disabled:!0,required:!0})]})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Phone Number"}),s.jsx(k.Control,{type:"tel",name:"phoneNumber",value:o.phoneNumber,onChange:u,disabled:!0})]})})]}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Gender"}),s.jsxs(k.Select,{name:"gender",value:o.gender,onChange:u,disabled:!0,children:[s.jsx("option",{value:"",children:"Select Gender"}),s.jsx("option",{value:"MALE",children:"Male"}),s.jsx("option",{value:"FEMALE",children:"Female"})]})]})})}),s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-md-12 mb-3",children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Address"}),s.jsx(k.Control,{as:"textarea",rows:3,name:"address",value:o.address,onChange:u,placeholder:"Enter your address",disabled:!0})]})})})]})})]})},yH=()=>{const{user:e}=zr(),t=tt(),[r,a]=v.useState(!1),[n,i]=v.useState(!1),[o,l]=v.useState(null),[c,d]=v.useState(!0),[u,m]=v.useState(null),f=async()=>{try{d(!0);const b=await on.getProfile();l(b)}catch(b){console.error("Failed to refresh profile:",b)}finally{d(!1)}};v.useEffect(()=>{f()},[]);const h=async b=>{a(!0);try{if(u){const j=await on.updateProfile(u);l(j),m(null)}else{const j=await on.updateProfile(b);l(j)}J.success("Profile updated successfully!")}catch(j){throw console.error("Error updating profile:",j),J.error("Failed to update profile. Please try again."),j}finally{a(!1)}},p=b=>{m(b)},x=async b=>{a(!0);try{const j=await on.resetPassword(b);J.success(j.message||"Password updated successfully!")}catch(j){throw J.error(j.message||"Failed to update password. Please check your current password."),j}finally{a(!1)}},g=()=>{e?.role,t(je.TRAINER_CONFIGURE_SIGNATURE)};return c?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(de,{children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading profile data..."})]})})})}):s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsxs(de,{children:[s.jsx(H,{lg:4,className:"mb-4",children:s.jsx(gH,{profileData:o,user:e,onResetPassword:()=>i(!0),onAvatarSelected:p,onConfigureSignature:g,onSaveChanges:h,loading:r})}),s.jsx(H,{lg:8,className:"mb-4",children:s.jsx(vH,{profileData:o,user:e,onUpdate:null})})]}),s.jsx(xH,{show:n,onClose:()=>i(!1),onSave:x,loading:r})]})},bH=()=>{const{user:e}=zr(),{hasPermission:t}=Fn(),r=tt(),a=v.useMemo(()=>{const d=t(Te.VIEW_ALL_DEPARTMENTS),u=t(Te.UPDATE_DEPARTMENT),m=t(Te.VIEW_DEPARTMENT_DETAILS);return d&&!u?"all":m&&!d?"my":d?"all":null},[t]),{departments:n,loading:i,error:o}=Yx(a!==null,a||"all"),l=n.filter(d=>d.status==="ACTIVE"),c=d=>{r(`/academic/course/${d}`)};return s.jsx("div",{className:"course-selection",style:{paddingBottom:"2rem"},children:s.jsxs(Ce,{className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"text-center",children:[s.jsx(Vs,{size:48,className:"text-primary mb-3"}),s.jsx("h2",{className:"mb-2",children:"Academic Department Management"}),s.jsx("p",{className:"text-muted",children:"Select a department to view its details, including list of courses and related subjects"}),s.jsxs("p",{className:"text-muted small",children:["Total Departments: ",s.jsx("strong",{children:l.length})]})]})})}),s.jsx(de,{className:"mb-5",children:i?s.jsxs(H,{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading departments..."})]}):o?s.jsx(H,{className:"text-center py-5",children:s.jsxs("p",{className:"text-danger",children:["Error loading departments: ",typeof o=="string"?o:o?.message||"Unknown error"]})}):l.map(d=>s.jsx(H,{md:6,lg:4,className:"mb-4",children:s.jsx(W,{className:"h-100 border-0 shadow-sm course-card d-flex flex-column",children:s.jsxs(W.Body,{className:"p-4 d-flex flex-column h-100",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"course-icon me-3",children:s.jsx(Dt,{size:24,className:"text-primary"})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h5",{className:"mb-1",children:d.name}),s.jsx(ke,{bg:"secondary",className:"text-white",children:d.code})]})]}),s.jsx("div",{className:"text-muted description-container",children:d.description||s.jsx("span",{className:"text-muted fst-italic",children:"No description available"})}),s.jsx(yt,{permission:Te.VIEW_COURSE_DETAILS,fallback:null,children:s.jsxs(te,{variant:"outline-primary",className:"w-100",onClick:()=>c(d.id),children:["View Details",s.jsx(un,{size:16,className:"ms-2"})]})}),"                  "]})})},d.id))})]})})};var pf={},xf={},wb;function jH(){return wb||(wb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(xf)),xf}var gf={},Nb;function tC(){return Nb||(Nb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(gf)),gf}var vf={},Sb;function Bg(){return Sb||(Sb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(vf)),vf}var yf={},bf={},Eb;function wH(){return Eb||(Eb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const a=String(r);return a==="0"&&Object.is(Number(r),-0)?"-0":a}e.toString=t})(bf)),bf}var Tb;function zg(){return Tb||(Tb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wH(),r=Bg();function a(n){if(Array.isArray(n))return n.map(r.toKey);if(typeof n=="symbol")return[n];n=t.toString(n);const i=[],o=n.length;if(o===0)return i;let l=0,c="",d="",u=!1;for(n.charCodeAt(0)===46&&(i.push(""),l++);l<o;){const m=n[l];d?m==="\\"&&l+1<o?(l++,c+=n[l]):m===d?d="":c+=m:u?m==='"'||m==="'"?d=m:m==="]"?(u=!1,i.push(c),c=""):c+=m:m==="["?(u=!0,c&&(i.push(c),c="")):m==="."?c&&(i.push(c),c=""):c+=m,l++}return c&&i.push(c),i}e.toPath=a})(yf)),yf}var Cb;function $g(){return Cb||(Cb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jH(),r=tC(),a=Bg(),n=zg();function i(l,c,d){if(l==null)return d;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?r.isDeepKey(c)?i(l,n.toPath(c),d):d:u}case"number":case"symbol":{typeof c=="number"&&(c=a.toKey(c));const u=l[c];return u===void 0?d:u}default:{if(Array.isArray(c))return o(l,c,d);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?d:u}}}function o(l,c,d){if(c.length===0)return d;let u=l;for(let m=0;m<c.length;m++){if(u==null||t.isUnsafeProperty(c[m]))return d;u=u[c[m]]}return u===void 0?d:u}e.get=i})(pf)),pf}var jf,Ab;function NH(){return Ab||(Ab=1,jf=$g().get),jf}var SH=NH();const to=mi(SH);var wf={exports:{}},Xt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _b;function EH(){if(_b)return Xt;_b=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,m=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,j=e?Symbol.for("react.scope"):60119;function y(S){if(typeof S=="object"&&S!==null){var N=S.$$typeof;switch(N){case t:switch(S=S.type,S){case c:case d:case a:case i:case n:case m:return S;default:switch(S=S&&S.$$typeof,S){case l:case u:case p:case h:case o:return S;default:return N}}case r:return N}}}function w(S){return y(S)===d}return Xt.AsyncMode=c,Xt.ConcurrentMode=d,Xt.ContextConsumer=l,Xt.ContextProvider=o,Xt.Element=t,Xt.ForwardRef=u,Xt.Fragment=a,Xt.Lazy=p,Xt.Memo=h,Xt.Portal=r,Xt.Profiler=i,Xt.StrictMode=n,Xt.Suspense=m,Xt.isAsyncMode=function(S){return w(S)||y(S)===c},Xt.isConcurrentMode=w,Xt.isContextConsumer=function(S){return y(S)===l},Xt.isContextProvider=function(S){return y(S)===o},Xt.isElement=function(S){return typeof S=="object"&&S!==null&&S.$$typeof===t},Xt.isForwardRef=function(S){return y(S)===u},Xt.isFragment=function(S){return y(S)===a},Xt.isLazy=function(S){return y(S)===p},Xt.isMemo=function(S){return y(S)===h},Xt.isPortal=function(S){return y(S)===r},Xt.isProfiler=function(S){return y(S)===i},Xt.isStrictMode=function(S){return y(S)===n},Xt.isSuspense=function(S){return y(S)===m},Xt.isValidElementType=function(S){return typeof S=="string"||typeof S=="function"||S===a||S===d||S===i||S===n||S===m||S===f||typeof S=="object"&&S!==null&&(S.$$typeof===p||S.$$typeof===h||S.$$typeof===o||S.$$typeof===l||S.$$typeof===u||S.$$typeof===g||S.$$typeof===b||S.$$typeof===j||S.$$typeof===x)},Xt.typeOf=y,Xt}var kb;function TH(){return kb||(kb=1,wf.exports=EH()),wf.exports}var CH=TH(),ds=e=>e===0?0:e>0?1:-1,xa=e=>typeof e=="number"&&e!=+e,Di=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,it=e=>(typeof e=="number"||e instanceof Number)&&!xa(e),fn=e=>it(e)||typeof e=="string",AH=0,hc=e=>{var t=++AH;return"".concat(e||"").concat(t)},Fs=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!it(t)&&typeof t!="string")return a;var i;if(Di(t)){if(r==null)return a;var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return xa(i)&&(i=a),n&&r!=null&&i>r&&(i=r),i},rC=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},a=0;a<t;a++)if(!r[e[a]])r[e[a]]=!0;else return!0;return!1};function ys(e,t,r){return it(e)&&it(t)?e+r*(t-e):t}function _H(e,t,r){if(!(!e||!e.length))return e.find(a=>a&&(typeof t=="function"?t(a):to(a,t))===r)}var ms=e=>e===null||typeof e>"u",Bc=e=>ms(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),kH=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Ug(e){if(typeof e!="string")return!1;var t=kH;return t.includes(e)}var DH=["viewBox","children"],Db=["points","pathLength"],Nf={svg:DH,polygon:Db,polyline:Db},IH=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var a={};return Object.keys(r).forEach(n=>{Ug(n)&&(a[n]=(i=>r[n](r,i)))}),a},OH=(e,t,r)=>a=>(e(t,r,a),null),zc=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(n=>{var i=e[n];Ug(n)&&typeof i=="function"&&(a||(a={}),a[n]=OH(i,t,r))}),a},PH=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function sC(e){if(typeof e!="string")return!1;var t=PH;return t.includes(e)}function gi(e){var t=Object.entries(e).filter(r=>{var[a]=r;return sC(a)});return Object.fromEntries(t)}var Ib=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",Ob=null,Sf=null,aC=e=>{if(e===Ob&&Array.isArray(Sf))return Sf;var t=[];return v.Children.forEach(e,r=>{ms(r)||(CH.isFragment(r)?t=t.concat(aC(r.props.children)):t.push(r))}),Sf=t,Ob=e,t};function Wg(e,t){var r=[],a=[];return Array.isArray(t)?a=t.map(n=>Ib(n)):a=[Ib(t)],aC(e).forEach(n=>{var i=to(n,"type.displayName")||to(n,"type.name");a.indexOf(i)!==-1&&r.push(n)}),r}var RH=(e,t,r,a)=>{var n;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(n=a&&Nf?.[a])!==null&&n!==void 0?n:[],o=t.startsWith("data-"),l=typeof e!="function"&&(!!a&&i.includes(t)||sC(t)),c=!!r&&Ug(t);return o||l||c},ts=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var a=e;if(v.isValidElement(e)&&(a=e.props),typeof a!="object"&&typeof a!="function")return null;var n={};return Object.keys(a).forEach(i=>{var o;RH((o=a)===null||o===void 0?void 0:o[i],i,t,r)&&(n[i]=a[i])}),n},FH=["children","width","height","viewBox","className","style","title","desc"];function Hp(){return Hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Hp.apply(null,arguments)}function LH(e,t){if(e==null)return{};var r,a,n=MH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function MH(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Hg=v.forwardRef((e,t)=>{var{children:r,width:a,height:n,viewBox:i,className:o,style:l,title:c,desc:d}=e,u=LH(e,FH),m=i||{width:a,height:n,x:0,y:0},f=Mt("recharts-surface",o);return v.createElement("svg",Hp({},ts(u,!0,"svg"),{className:f,width:a,height:n,style:l,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),v.createElement("title",null,c),v.createElement("desc",null,d),r)}),BH=["children","className"];function Vp(){return Vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Vp.apply(null,arguments)}function zH(e,t){if(e==null)return{};var r,a,n=$H(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function $H(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var sa=v.forwardRef((e,t)=>{var{children:r,className:a}=e,n=zH(e,BH),i=Mt("recharts-layer",a);return v.createElement("g",Vp({className:i},ts(n,!0),{ref:t}),r)}),nC=v.createContext(null),UH=()=>v.useContext(nC);function dr(e){return function(){return e}}const iC=Math.cos,mu=Math.sin,Za=Math.sqrt,fu=Math.PI,pm=2*fu,Gp=Math.PI,qp=2*Gp,Ei=1e-6,WH=qp-Ei;function oC(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function HH(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return oC;const r=10**t;return function(a){this._+=a[0];for(let n=1,i=a.length;n<i;++n)this._+=Math.round(arguments[n]*r)/r+a[n]}}class VH{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?oC:HH(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,n){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+n}`}bezierCurveTo(t,r,a,n,i,o){this._append`C${+t},${+r},${+a},${+n},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,a,n,i){if(t=+t,r=+r,a=+a,n=+n,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=a-t,d=n-r,u=o-t,m=l-r,f=u*u+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>Ei)if(!(Math.abs(m*c-d*u)>Ei)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=a-o,p=n-l,x=c*c+d*d,g=h*h+p*p,b=Math.sqrt(x),j=Math.sqrt(f),y=i*Math.tan((Gp-Math.acos((x+f-g)/(2*b*j)))/2),w=y/j,S=y/b;Math.abs(w-1)>Ei&&this._append`L${t+w*u},${r+w*m}`,this._append`A${i},${i},0,0,${+(m*h>u*p)},${this._x1=t+S*c},${this._y1=r+S*d}`}}arc(t,r,a,n,i,o){if(t=+t,r=+r,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let l=a*Math.cos(n),c=a*Math.sin(n),d=t+l,u=r+c,m=1^o,f=o?n-i:i-n;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Ei||Math.abs(this._y1-u)>Ei)&&this._append`L${d},${u}`,a&&(f<0&&(f=f%qp+qp),f>WH?this._append`A${a},${a},0,1,${m},${t-l},${r-c}A${a},${a},0,1,${m},${this._x1=d},${this._y1=u}`:f>Ei&&this._append`A${a},${a},0,${+(f>=Gp)},${m},${this._x1=t+a*Math.cos(i)},${this._y1=r+a*Math.sin(i)}`)}rect(t,r,a,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+n}h${-a}Z`}toString(){return this._}}function Vg(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return e},()=>new VH(t)}function Gg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function lC(e){this._context=e}lC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function xm(e){return new lC(e)}function cC(e){return e[0]}function dC(e){return e[1]}function uC(e,t){var r=dr(!0),a=null,n=xm,i=null,o=Vg(l);e=typeof e=="function"?e:e===void 0?cC:dr(e),t=typeof t=="function"?t:t===void 0?dC:dr(t);function l(c){var d,u=(c=Gg(c)).length,m,f=!1,h;for(a==null&&(i=n(h=o())),d=0;d<=u;++d)!(d<u&&r(m=c[d],d,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(m,d,c),+t(m,d,c));if(h)return i=null,h+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:dr(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:dr(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:dr(!!c),l):r},l.curve=function(c){return arguments.length?(n=c,a!=null&&(i=n(a)),l):n},l.context=function(c){return arguments.length?(c==null?a=i=null:i=n(a=c),l):a},l}function bd(e,t,r){var a=null,n=dr(!0),i=null,o=xm,l=null,c=Vg(d);e=typeof e=="function"?e:e===void 0?cC:dr(+e),t=typeof t=="function"?t:dr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?dC:dr(+r);function d(m){var f,h,p,x=(m=Gg(m)).length,g,b=!1,j,y=new Array(x),w=new Array(x);for(i==null&&(l=o(j=c())),f=0;f<=x;++f){if(!(f<x&&n(g=m[f],f,m))===b)if(b=!b)h=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),p=f-1;p>=h;--p)l.point(y[p],w[p]);l.lineEnd(),l.areaEnd()}b&&(y[f]=+e(g,f,m),w[f]=+t(g,f,m),l.point(a?+a(g,f,m):y[f],r?+r(g,f,m):w[f]))}if(j)return l=null,j+""||null}function u(){return uC().defined(n).curve(o).context(i)}return d.x=function(m){return arguments.length?(e=typeof m=="function"?m:dr(+m),a=null,d):e},d.x0=function(m){return arguments.length?(e=typeof m=="function"?m:dr(+m),d):e},d.x1=function(m){return arguments.length?(a=m==null?null:typeof m=="function"?m:dr(+m),d):a},d.y=function(m){return arguments.length?(t=typeof m=="function"?m:dr(+m),r=null,d):t},d.y0=function(m){return arguments.length?(t=typeof m=="function"?m:dr(+m),d):t},d.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:dr(+m),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(a).y(t)},d.defined=function(m){return arguments.length?(n=typeof m=="function"?m:dr(!!m),d):n},d.curve=function(m){return arguments.length?(o=m,i!=null&&(l=o(i)),d):o},d.context=function(m){return arguments.length?(m==null?i=l=null:l=o(i=m),d):i},d}class mC{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function GH(e){return new mC(e,!0)}function qH(e){return new mC(e,!1)}const qg={draw(e,t){const r=Za(t/fu);e.moveTo(r,0),e.arc(0,0,r,0,pm)}},KH={draw(e,t){const r=Za(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},fC=Za(1/3),YH=fC*2,XH={draw(e,t){const r=Za(t/YH),a=r*fC;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},JH={draw(e,t){const r=Za(t),a=-r/2;e.rect(a,a,r,r)}},ZH=.8908130915292852,hC=mu(fu/10)/mu(7*fu/10),QH=mu(pm/10)*hC,eV=-iC(pm/10)*hC,tV={draw(e,t){const r=Za(t*ZH),a=QH*r,n=eV*r;e.moveTo(0,-r),e.lineTo(a,n);for(let i=1;i<5;++i){const o=pm*i/5,l=iC(o),c=mu(o);e.lineTo(c*r,-l*r),e.lineTo(l*a-c*n,c*a+l*n)}e.closePath()}},Ef=Za(3),rV={draw(e,t){const r=-Za(t/(Ef*3));e.moveTo(0,r*2),e.lineTo(-Ef*r,-r),e.lineTo(Ef*r,-r),e.closePath()}},wa=-.5,Na=Za(3)/2,Kp=1/Za(12),sV=(Kp/2+1)*3,aV={draw(e,t){const r=Za(t/sV),a=r/2,n=r*Kp,i=a,o=r*Kp+r,l=-i,c=o;e.moveTo(a,n),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(wa*a-Na*n,Na*a+wa*n),e.lineTo(wa*i-Na*o,Na*i+wa*o),e.lineTo(wa*l-Na*c,Na*l+wa*c),e.lineTo(wa*a+Na*n,wa*n-Na*a),e.lineTo(wa*i+Na*o,wa*o-Na*i),e.lineTo(wa*l+Na*c,wa*c-Na*l),e.closePath()}};function nV(e,t){let r=null,a=Vg(n);e=typeof e=="function"?e:dr(e||qg),t=typeof t=="function"?t:dr(t===void 0?64:+t);function n(){let i;if(r||(r=i=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return n.type=function(i){return arguments.length?(e=typeof i=="function"?i:dr(i),n):e},n.size=function(i){return arguments.length?(t=typeof i=="function"?i:dr(+i),n):t},n.context=function(i){return arguments.length?(r=i??null,n):r},n}function hu(){}function pu(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function pC(e){this._context=e}pC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:pu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:pu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function iV(e){return new pC(e)}function xC(e){this._context=e}xC.prototype={areaStart:hu,areaEnd:hu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:pu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function oV(e){return new xC(e)}function gC(e){this._context=e}gC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:pu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lV(e){return new gC(e)}function vC(e){this._context=e}vC.prototype={areaStart:hu,areaEnd:hu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function cV(e){return new vC(e)}function Pb(e){return e<0?-1:1}function Rb(e,t,r){var a=e._x1-e._x0,n=t-e._x1,i=(e._y1-e._y0)/(a||n<0&&-0),o=(r-e._y1)/(n||a<0&&-0),l=(i*n+o*a)/(a+n);return(Pb(i)+Pb(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function Fb(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Tf(e,t,r){var a=e._x0,n=e._y0,i=e._x1,o=e._y1,l=(i-a)/3;e._context.bezierCurveTo(a+l,n+l*t,i-l,o-l*r,i,o)}function xu(e){this._context=e}xu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tf(this,this._t0,Fb(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Tf(this,Fb(this,r=Rb(this,e,t)),r);break;default:Tf(this,this._t0,r=Rb(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function yC(e){this._context=new bC(e)}(yC.prototype=Object.create(xu.prototype)).point=function(e,t){xu.prototype.point.call(this,t,e)};function bC(e){this._context=e}bC.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,n,i){this._context.bezierCurveTo(t,e,a,r,i,n)}};function dV(e){return new xu(e)}function uV(e){return new yC(e)}function jC(e){this._context=e}jC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var a=Lb(e),n=Lb(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(a[0][i],n[0][i],a[1][i],n[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Lb(e){var t,r=e.length-1,a,n=new Array(r),i=new Array(r),o=new Array(r);for(n[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)n[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(n[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)a=n[t]/i[t-1],i[t]-=a,o[t]-=a*o[t-1];for(n[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)n[t]=(o[t]-n[t+1])/i[t];for(i[r-1]=(e[r]+n[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-n[t+1];return[n,i]}function mV(e){return new jC(e)}function gm(e,t){this._context=e,this._t=t}gm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function fV(e){return new gm(e,.5)}function hV(e){return new gm(e,0)}function pV(e){return new gm(e,1)}function Wo(e,t){if((o=e.length)>1)for(var r=1,a,n,i=e[t[0]],o,l=i.length;r<o;++r)for(n=i,i=e[t[r]],a=0;a<l;++a)i[a][1]+=i[a][0]=isNaN(n[a][1])?n[a][0]:n[a][1]}function Yp(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function xV(e,t){return e[t]}function gV(e){const t=[];return t.key=e,t}function vV(){var e=dr([]),t=Yp,r=Wo,a=xV;function n(i){var o=Array.from(e.apply(this,arguments),gV),l,c=o.length,d=-1,u;for(const m of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+a(m,o[l].key,d,i)]).data=m;for(l=0,u=Gg(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return n.keys=function(i){return arguments.length?(e=typeof i=="function"?i:dr(Array.from(i)),n):e},n.value=function(i){return arguments.length?(a=typeof i=="function"?i:dr(+i),n):a},n.order=function(i){return arguments.length?(t=i==null?Yp:typeof i=="function"?i:dr(Array.from(i)),n):t},n.offset=function(i){return arguments.length?(r=i??Wo,n):r},n}function yV(e,t){if((a=e.length)>0){for(var r,a,n=0,i=e[0].length,o;n<i;++n){for(o=r=0;r<a;++r)o+=e[r][n][1]||0;if(o)for(r=0;r<a;++r)e[r][n][1]/=o}Wo(e,t)}}function bV(e,t){if((n=e.length)>0){for(var r=0,a=e[t[0]],n,i=a.length;r<i;++r){for(var o=0,l=0;o<n;++o)l+=e[o][r][1]||0;a[r][1]+=a[r][0]=-l/2}Wo(e,t)}}function jV(e,t){if(!(!((o=e.length)>0)||!((i=(n=e[t[0]]).length)>0))){for(var r=0,a=1,n,i,o;a<i;++a){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],m=u[a][1]||0,f=u[a-1][1]||0,h=(m-f)/2,p=0;p<l;++p){var x=e[t[p]],g=x[a][1]||0,b=x[a-1][1]||0;h+=g-b}c+=m,d+=h*m}n[a-1][1]+=n[a-1][0]=r,c&&(r-=d/c)}n[a-1][1]+=n[a-1][0]=r,Wo(e,t)}}var wV=["type","size","sizeType"];function Xp(){return Xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Xp.apply(null,arguments)}function Mb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Bb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mb(Object(r),!0).forEach(function(a){NV(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function NV(e,t,r){return(t=SV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SV(e){var t=EV(e,"string");return typeof t=="symbol"?t:t+""}function EV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TV(e,t){if(e==null)return{};var r,a,n=CV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function CV(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var wC={symbolCircle:qg,symbolCross:KH,symbolDiamond:XH,symbolSquare:JH,symbolStar:tV,symbolTriangle:rV,symbolWye:aV},AV=Math.PI/180,_V=e=>{var t="symbol".concat(Bc(e));return wC[t]||qg},kV=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*AV;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},DV=(e,t)=>{wC["symbol".concat(Bc(e))]=t},Kg=e=>{var{type:t="circle",size:r=64,sizeType:a="area"}=e,n=TV(e,wV),i=Bb(Bb({},n),{},{type:t,size:r,sizeType:a}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var f=_V(o),h=nV().type(f).size(kV(r,a,o));return h()},{className:c,cx:d,cy:u}=i,m=ts(i,!0);return d===+d&&u===+u&&r===+r?v.createElement("path",Xp({},m,{className:Mt("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:l()})):null};Kg.registerSymbol=DV;function Jp(){return Jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Jp.apply(null,arguments)}function zb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function IV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zb(Object(r),!0).forEach(function(a){Yg(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Yg(e,t,r){return(t=OV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OV(e){var t=PV(e,"string");return typeof t=="symbol"?t:t+""}function PV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sa=32;class Xg extends v.PureComponent{renderIcon(t,r){var{inactiveColor:a}=this.props,n=Sa/2,i=Sa/6,o=Sa/3,l=t.inactive?a:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return v.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:n,x2:Sa,y2:n,className:"recharts-legend-icon"});if(c==="line")return v.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(n,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(n,`
            H`).concat(Sa,"M").concat(2*o,",").concat(n,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(n),className:"recharts-legend-icon"});if(c==="rect")return v.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Sa/8,"h").concat(Sa,"v").concat(Sa*3/4,"h").concat(-Sa,"z"),className:"recharts-legend-icon"});if(v.isValidElement(t.legendIcon)){var d=IV({},t);return delete d.legendIcon,v.cloneElement(t.legendIcon,d)}return v.createElement(Kg,{fill:l,cx:n,cy:n,size:Sa,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:a,formatter:n,inactiveColor:i,iconType:o}=this.props,l={x:0,y:0,width:Sa,height:Sa},c={display:a==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((u,m)=>{var f=u.formatter||n,h=Mt({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:u.inactive});if(u.type==="none")return null;var p=u.inactive?i:u.color,x=f?f(u.value,u,m):u.value;return v.createElement("li",Jp({className:h,style:c,key:"legend-item-".concat(m)},zc(this.props,u,m)),v.createElement(Hg,{width:r,height:r,viewBox:l,style:d,"aria-label":"".concat(x," legend icon")},this.renderIcon(u,o)),v.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},x))})}render(){var{payload:t,layout:r,align:a}=this.props;if(!t||!t.length)return null;var n={padding:0,margin:0,textAlign:r==="horizontal"?a:"left"};return v.createElement("ul",{className:"recharts-default-legend",style:n},this.renderItems())}}Yg(Xg,"displayName","Legend");Yg(Xg,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Cf={},Af={},$b;function RV(){return $b||($b=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){const n=new Map;for(let i=0;i<r.length;i++){const o=r[i],l=a(o);n.has(l)||n.set(l,o)}return Array.from(n.values())}e.uniqBy=t})(Af)),Af}var _f={},Ub;function NC(){return Ub||(Ub=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(_f)),_f}var kf={},Df={},If={},Wb;function FV(){return Wb||(Wb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(If)),If}var Hb;function Jg(){return Hb||(Hb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FV();function r(a){return a!=null&&typeof a!="function"&&t.isLength(a.length)}e.isArrayLike=r})(Df)),Df}var Of={},Vb;function LV(){return Vb||(Vb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Of)),Of}var Gb;function MV(){return Gb||(Gb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Jg(),r=LV();function a(n){return r.isObjectLike(n)&&t.isArrayLike(n)}e.isArrayLikeObject=a})(kf)),kf}var Pf={},Rf={},qb;function BV(){return qb||(qb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$g();function r(a){return function(n){return t.get(n,a)}}e.property=r})(Rf)),Rf}var Ff={},Lf={},Mf={},Bf={},Kb;function SC(){return Kb||(Kb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Bf)),Bf}var zf={},Yb;function EC(){return Yb||(Yb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(zf)),zf}var $f={},Xb;function TC(){return Xb||(Xb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){return r===a||Number.isNaN(r)&&Number.isNaN(a)}e.eq=t})($f)),$f}var Jb;function zV(){return Jb||(Jb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zg(),r=SC(),a=EC(),n=TC();function i(m,f,h){return typeof h!="function"?t.isMatch(m,f):o(m,f,function p(x,g,b,j,y,w){const S=h(x,g,b,j,y,w);return S!==void 0?!!S:o(x,g,p,w)},new Map)}function o(m,f,h,p){if(f===m)return!0;switch(typeof f){case"object":return l(m,f,h,p);case"function":return Object.keys(f).length>0?o(m,{...f},h,p):n.eq(m,f);default:return r.isObject(m)?typeof f=="string"?f==="":!0:n.eq(m,f)}}function l(m,f,h,p){if(f==null)return!0;if(Array.isArray(f))return d(m,f,h,p);if(f instanceof Map)return c(m,f,h,p);if(f instanceof Set)return u(m,f,h,p);const x=Object.keys(f);if(m==null)return x.length===0;if(x.length===0)return!0;if(p&&p.has(f))return p.get(f)===m;p&&p.set(f,m);try{for(let g=0;g<x.length;g++){const b=x[g];if(!a.isPrimitive(m)&&!(b in m)||f[b]===void 0&&m[b]!==void 0||f[b]===null&&m[b]!==null||!h(m[b],f[b],b,m,f,p))return!1}return!0}finally{p&&p.delete(f)}}function c(m,f,h,p){if(f.size===0)return!0;if(!(m instanceof Map))return!1;for(const[x,g]of f.entries()){const b=m.get(x);if(h(b,g,x,m,f,p)===!1)return!1}return!0}function d(m,f,h,p){if(f.length===0)return!0;if(!Array.isArray(m))return!1;const x=new Set;for(let g=0;g<f.length;g++){const b=f[g];let j=!1;for(let y=0;y<m.length;y++){if(x.has(y))continue;const w=m[y];let S=!1;if(h(w,b,g,m,f,p)&&(S=!0),S){x.add(y),j=!0;break}}if(!j)return!1}return!0}function u(m,f,h,p){return f.size===0?!0:m instanceof Set?d([...m],[...f],h,p):!1}e.isMatchWith=i,e.isSetMatch=u})(Mf)),Mf}var Zb;function Zg(){return Zb||(Zb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zV();function r(a,n){return t.isMatchWith(a,n,()=>{})}e.isMatch=r})(Lf)),Lf}var Uf={},Wf={},Hf={},Qb;function $V(){return Qb||(Qb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(a=>Object.prototype.propertyIsEnumerable.call(r,a))}e.getSymbols=t})(Hf)),Hf}var Vf={},ej;function CC(){return ej||(ej=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Vf)),Vf}var Gf={},tj;function AC(){return tj||(tj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",a="[object Number]",n="[object Boolean]",i="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",d="[object Set]",u="[object Array]",m="[object Function]",f="[object ArrayBuffer]",h="[object Object]",p="[object Error]",x="[object DataView]",g="[object Uint8Array]",b="[object Uint8ClampedArray]",j="[object Uint16Array]",y="[object Uint32Array]",w="[object BigUint64Array]",S="[object Int8Array]",N="[object Int16Array]",E="[object Int32Array]",P="[object BigInt64Array]",T="[object Float32Array]",O="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=f,e.arrayTag=u,e.bigInt64ArrayTag=P,e.bigUint64ArrayTag=w,e.booleanTag=n,e.dataViewTag=x,e.dateTag=l,e.errorTag=p,e.float32ArrayTag=T,e.float64ArrayTag=O,e.functionTag=m,e.int16ArrayTag=N,e.int32ArrayTag=E,e.int8ArrayTag=S,e.mapTag=c,e.numberTag=a,e.objectTag=h,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=j,e.uint32ArrayTag=y,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=b})(Gf)),Gf}var qf={},rj;function UV(){return rj||(rj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(qf)),qf}var sj;function _C(){return sj||(sj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$V(),r=CC(),a=AC(),n=EC(),i=UV();function o(u,m){return l(u,void 0,u,new Map,m)}function l(u,m,f,h=new Map,p=void 0){const x=p?.(u,m,f,h);if(x!==void 0)return x;if(n.isPrimitive(u))return u;if(h.has(u))return h.get(u);if(Array.isArray(u)){const g=new Array(u.length);h.set(u,g);for(let b=0;b<u.length;b++)g[b]=l(u[b],b,f,h,p);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;h.set(u,g);for(const[b,j]of u)g.set(b,l(j,b,f,h,p));return g}if(u instanceof Set){const g=new Set;h.set(u,g);for(const b of u)g.add(l(b,void 0,f,h,p));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(i.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);h.set(u,g);for(let b=0;b<u.length;b++)g[b]=l(u[b],b,f,h,p);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return h.set(u,g),c(g,u,f,h,p),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return h.set(u,g),c(g,u,f,h,p),g}if(typeof Blob<"u"&&u instanceof Blob){const g=new Blob([u],{type:u.type});return h.set(u,g),c(g,u,f,h,p),g}if(u instanceof Error){const g=new u.constructor;return h.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,c(g,u,f,h,p),g}if(u instanceof Boolean){const g=new Boolean(u.valueOf());return h.set(u,g),c(g,u,f,h,p),g}if(u instanceof Number){const g=new Number(u.valueOf());return h.set(u,g),c(g,u,f,h,p),g}if(u instanceof String){const g=new String(u.valueOf());return h.set(u,g),c(g,u,f,h,p),g}if(typeof u=="object"&&d(u)){const g=Object.create(Object.getPrototypeOf(u));return h.set(u,g),c(g,u,f,h,p),g}return u}function c(u,m,f=u,h,p){const x=[...Object.keys(m),...t.getSymbols(m)];for(let g=0;g<x.length;g++){const b=x[g],j=Object.getOwnPropertyDescriptor(u,b);(j==null||j.writable)&&(u[b]=l(m[b],b,f,h,p))}}function d(u){switch(r.getTag(u)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(Wf)),Wf}var aj;function WV(){return aj||(aj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_C();function r(a){return t.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=r})(Uf)),Uf}var nj;function HV(){return nj||(nj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zg(),r=WV();function a(n){return n=r.cloneDeep(n),i=>t.isMatch(i,n)}e.matches=a})(Ff)),Ff}var Kf={},Yf={},Xf={},ij;function VV(){return ij||(ij=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_C(),r=AC();function a(n,i){return t.cloneDeepWith(n,(o,l,c,d)=>{const u=i?.(o,l,c,d);if(u!==void 0)return u;if(typeof n=="object")switch(Object.prototype.toString.call(n)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new n.constructor(n?.valueOf());return t.copyProperties(m,n),m}case r.argumentsTag:{const m={};return t.copyProperties(m,n),m.length=n.length,m[Symbol.iterator]=n[Symbol.iterator],m}default:return}})}e.cloneDeepWith=a})(Xf)),Xf}var oj;function GV(){return oj||(oj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VV();function r(a){return t.cloneDeepWith(a)}e.cloneDeep=r})(Yf)),Yf}var Jf={},Zf={},lj;function kC(){return lj||(lj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(a,n=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<n;case"symbol":return!1;case"string":return t.test(a)}}e.isIndex=r})(Zf)),Zf}var Qf={},cj;function qV(){return cj||(cj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CC();function r(a){return a!==null&&typeof a=="object"&&t.getTag(a)==="[object Arguments]"}e.isArguments=r})(Qf)),Qf}var dj;function KV(){return dj||(dj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tC(),r=kC(),a=qV(),n=zg();function i(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&o?.[l]==null?c=n.toPath(l):c=[l],c.length===0)return!1;let d=o;for(let u=0;u<c.length;u++){const m=c[u];if((d==null||!Object.hasOwn(d,m))&&!((Array.isArray(d)||a.isArguments(d))&&r.isIndex(m)&&m<d.length))return!1;d=d[m]}return!0}e.has=i})(Jf)),Jf}var uj;function YV(){return uj||(uj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zg(),r=Bg(),a=GV(),n=$g(),i=KV();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=a.cloneDeep(c),function(d){const u=n.get(d,l);return u===void 0?i.has(d,l):c===void 0?u===void 0:t.isMatch(u,c)}}e.matchesProperty=o})(Kf)),Kf}var mj;function XV(){return mj||(mj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NC(),r=BV(),a=HV(),n=YV();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?n.matchesProperty(o[0],o[1]):a.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=i})(Pf)),Pf}var fj;function JV(){return fj||(fj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RV(),r=NC(),a=MV(),n=XV();function i(o,l=r.identity){return a.isArrayLikeObject(o)?t.uniqBy(Array.from(o),n.iteratee(l)):[]}e.uniqBy=i})(Cf)),Cf}var eh,hj;function ZV(){return hj||(hj=1,eh=JV().uniqBy),eh}var QV=ZV();const pj=mi(QV);function DC(e,t,r){return t===!0?pj(e,r):typeof t=="function"?pj(e,t):e}var th={exports:{}},rh={},sh={exports:{}},ah={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xj;function eG(){if(xj)return ah;xj=1;var e=Lx();function t(m,f){return m===f&&(m!==0||1/m===1/f)||m!==m&&f!==f}var r=typeof Object.is=="function"?Object.is:t,a=e.useState,n=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function l(m,f){var h=f(),p=a({inst:{value:h,getSnapshot:f}}),x=p[0].inst,g=p[1];return i(function(){x.value=h,x.getSnapshot=f,c(x)&&g({inst:x})},[m,h,f]),n(function(){return c(x)&&g({inst:x}),m(function(){c(x)&&g({inst:x})})},[m]),o(h),h}function c(m){var f=m.getSnapshot;m=m.value;try{var h=f();return!r(m,h)}catch{return!0}}function d(m,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return ah.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,ah}var gj;function tG(){return gj||(gj=1,sh.exports=eG()),sh.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vj;function rG(){if(vj)return rh;vj=1;var e=Lx(),t=tG();function r(d,u){return d===u&&(d!==0||1/d===1/u)||d!==d&&u!==u}var a=typeof Object.is=="function"?Object.is:r,n=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;return rh.useSyncExternalStoreWithSelector=function(d,u,m,f,h){var p=i(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=l(function(){function b(N){if(!j){if(j=!0,y=N,N=f(N),h!==void 0&&x.hasValue){var E=x.value;if(h(E,N))return w=E}return w=N}if(E=w,a(y,N))return E;var P=f(N);return h!==void 0&&h(E,P)?(y=N,E):(y=N,w=P)}var j=!1,y,w,S=m===void 0?null:m;return[function(){return b(u())},S===null?void 0:function(){return b(S())}]},[u,m,f,h]);var g=n(d,p[0],p[1]);return o(function(){x.hasValue=!0,x.value=g},[g]),c(g),g},rh}var yj;function sG(){return yj||(yj=1,th.exports=rG()),th.exports}var aG=sG(),Qg=v.createContext(null),nG=e=>e,kr=()=>{var e=v.useContext(Qg);return e?e.store.dispatch:nG},Hd=()=>{},iG=()=>Hd,oG=(e,t)=>e===t;function at(e){var t=v.useContext(Qg);return aG.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:iG,t?t.store.getState:Hd,t?t.store.getState:Hd,t?e:Hd,oG)}function lG(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function cG(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function dG(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${t}[${r}]`)}}var bj=e=>Array.isArray(e)?e:[e];function uG(e){const t=Array.isArray(e[0])?e[0]:e;return dG(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function mG(e,t){const r=[],{length:a}=e;for(let n=0;n<a;n++)r.push(e[n].apply(null,t));return r}var fG=class{constructor(e){this.value=e}deref(){return this.value}},hG=typeof WeakRef<"u"?WeakRef:fG,pG=0,jj=1;function jd(){return{s:pG,v:void 0,o:null,p:null}}function IC(e,t={}){let r=jd();const{resultEqualityCheck:a}=t;let n,i=0;function o(){let l=r;const{length:c}=arguments;for(let m=0,f=c;m<f;m++){const h=arguments[m];if(typeof h=="function"||typeof h=="object"&&h!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const x=p.get(h);x===void 0?(l=jd(),p.set(h,l)):l=x}else{let p=l.p;p===null&&(l.p=p=new Map);const x=p.get(h);x===void 0?(l=jd(),p.set(h,l)):l=x}}const d=l;let u;if(l.s===jj)u=l.v;else if(u=e.apply(null,arguments),i++,a){const m=n?.deref?.()??n;m!=null&&a(m,u)&&(u=m,i!==0&&i--),n=typeof u=="object"&&u!==null||typeof u=="function"?new hG(u):u}return d.s=jj,d.v=u,u}return o.clearCache=()=>{r=jd(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function xG(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,a=(...n)=>{let i=0,o=0,l,c={},d=n.pop();typeof d=="object"&&(c=d,d=n.pop()),lG(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...r,...c},{memoize:m,memoizeOptions:f=[],argsMemoize:h=IC,argsMemoizeOptions:p=[]}=u,x=bj(f),g=bj(p),b=uG(n),j=m(function(){return i++,d.apply(null,arguments)},...x),y=h(function(){o++;const S=mG(b,arguments);return l=j.apply(null,S),l},...g);return Object.assign(y,{resultFunc:d,memoizedResultFunc:j,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:h})};return Object.assign(a,{withTypes:()=>a}),a}var we=xG(IC),gG=Object.assign((e,t=we)=>{cG(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),a=r.map(i=>e[i]);return t(a,(...i)=>i.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>gG}),nh={},ih={},oh={},wj;function vG(){return wj||(wj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const r=(a,n,i)=>{if(a!==n){const o=t(a),l=t(n);if(o===l&&o===0){if(a<n)return i==="desc"?1:-1;if(a>n)return i==="desc"?-1:1}return i==="desc"?l-o:o-l}return 0};e.compareValues=r})(oh)),oh}var lh={},ch={},Nj;function OC(){return Nj||(Nj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(ch)),ch}var Sj;function yG(){return Sj||(Sj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OC(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function n(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(a.test(i)||!r.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=n})(lh)),lh}var Ej;function bG(){return Ej||(Ej=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vG(),r=yG(),a=zg();function n(i,o,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const d=(h,p)=>{let x=h;for(let g=0;g<p.length&&x!=null;++g)x=x[p[g]];return x},u=(h,p)=>p==null||h==null?p:typeof h=="object"&&"key"in h?Object.hasOwn(p,h.key)?p[h.key]:d(p,h.path):typeof h=="function"?h(p):Array.isArray(h)?d(p,h):typeof p=="object"?p[h]:p,m=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:a.toPath(h)}));return i.map(h=>({original:h,criteria:m.map(p=>u(p,h))})).slice().sort((h,p)=>{for(let x=0;x<m.length;x++){const g=t.compareValues(h.criteria[x],p.criteria[x],l[x]);if(g!==0)return g}return 0}).map(h=>h.original)}e.orderBy=n})(ih)),ih}var dh={},Tj;function jG(){return Tj||(Tj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a=1){const n=[],i=Math.floor(a),o=(l,c)=>{for(let d=0;d<l.length;d++){const u=l[d];Array.isArray(u)&&c<i?o(u,c+1):n.push(u)}};return o(r,0),n}e.flatten=t})(dh)),dh}var uh={},Cj;function PC(){return Cj||(Cj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kC(),r=Jg(),a=SC(),n=TC();function i(o,l,c){return a.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?n.eq(c[l],o):!1}e.isIterateeCall=i})(uh)),uh}var Aj;function wG(){return Aj||(Aj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bG(),r=jG(),a=PC();function n(i,...o){const l=o.length;return l>1&&a.isIterateeCall(i,o[0],o[1])?o=[]:l>2&&a.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,r.flatten(o),["asc"])}e.sortBy=n})(nh)),nh}var mh,_j;function NG(){return _j||(_j=1,mh=wG().sortBy),mh}var SG=NG();const vm=mi(SG);var RC=e=>e.legend.settings,EG=e=>e.legend.size,TG=e=>e.legend.payload,CG=we([TG,RC],(e,t)=>{var{itemSorter:r}=t,a=e.flat(1);return r?vm(a,r):a});function AG(){return at(CG)}var wd=1;function FC(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),a=v.useCallback(n=>{if(n!=null){var i=n.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>wd||Math.abs(o.left-t.left)>wd||Math.abs(o.top-t.top)>wd||Math.abs(o.width-t.width)>wd)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function xs(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var _G=typeof Symbol=="function"&&Symbol.observable||"@@observable",kj=_G,fh=()=>Math.random().toString(36).substring(7).split("").join("."),kG={INIT:`@@redux/INIT${fh()}`,REPLACE:`@@redux/REPLACE${fh()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${fh()}`},gu=kG;function ev(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function LC(e,t,r){if(typeof e!="function")throw new Error(xs(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(xs(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(xs(1));return r(LC)(e,t)}let a=e,n=t,i=new Map,o=i,l=0,c=!1;function d(){o===i&&(o=new Map,i.forEach((g,b)=>{o.set(b,g)}))}function u(){if(c)throw new Error(xs(3));return n}function m(g){if(typeof g!="function")throw new Error(xs(4));if(c)throw new Error(xs(5));let b=!0;d();const j=l++;return o.set(j,g),function(){if(b){if(c)throw new Error(xs(6));b=!1,d(),o.delete(j),i=null}}}function f(g){if(!ev(g))throw new Error(xs(7));if(typeof g.type>"u")throw new Error(xs(8));if(typeof g.type!="string")throw new Error(xs(17));if(c)throw new Error(xs(9));try{c=!0,n=a(n,g)}finally{c=!1}return(i=o).forEach(j=>{j()}),g}function h(g){if(typeof g!="function")throw new Error(xs(10));a=g,f({type:gu.REPLACE})}function p(){const g=m;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(xs(11));function j(){const w=b;w.next&&w.next(u())}return j(),{unsubscribe:g(j)}},[kj](){return this}}}return f({type:gu.INIT}),{dispatch:f,subscribe:m,getState:u,replaceReducer:h,[kj]:p}}function DG(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:gu.INIT})>"u")throw new Error(xs(12));if(typeof r(void 0,{type:gu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(xs(13))})}function MC(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}const a=Object.keys(r);let n;try{DG(r)}catch(i){n=i}return function(o={},l){if(n)throw n;let c=!1;const d={};for(let u=0;u<a.length;u++){const m=a[u],f=r[m],h=o[m],p=f(h,l);if(typeof p>"u")throw l&&l.type,new Error(xs(14));d[m]=p,c=c||p!==h}return c=c||a.length!==Object.keys(o).length,c?d:o}}function vu(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...a)=>t(r(...a)))}function IG(...e){return t=>(r,a)=>{const n=t(r,a);let i=()=>{throw new Error(xs(15))};const o={getState:n.getState,dispatch:(c,...d)=>i(c,...d)},l=e.map(c=>c(o));return i=vu(...l)(n.dispatch),{...n,dispatch:i}}}function BC(e){return ev(e)&&"type"in e&&typeof e.type=="string"}var zC=Symbol.for("immer-nothing"),Dj=Symbol.for("immer-draftable"),ga=Symbol.for("immer-state");function Va(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ho=Object.getPrototypeOf;function ro(e){return!!e&&!!e[ga]}function In(e){return e?$C(e)||Array.isArray(e)||!!e[Dj]||!!e.constructor?.[Dj]||$c(e)||bm(e):!1}var OG=Object.prototype.constructor.toString();function $C(e){if(!e||typeof e!="object")return!1;const t=Ho(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===OG}function yu(e,t){ym(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,a)=>t(a,r,e))}function ym(e){const t=e[ga];return t?t.type_:Array.isArray(e)?1:$c(e)?2:bm(e)?3:0}function Zp(e,t){return ym(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function UC(e,t,r){const a=ym(e);a===2?e.set(t,r):a===3?e.add(r):e[t]=r}function PG(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function $c(e){return e instanceof Map}function bm(e){return e instanceof Set}function Ti(e){return e.copy_||e.base_}function Qp(e,t){if($c(e))return new Map(e);if(bm(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=$C(e);if(t===!0||t==="class_only"&&!r){const a=Object.getOwnPropertyDescriptors(e);delete a[ga];let n=Reflect.ownKeys(a);for(let i=0;i<n.length;i++){const o=n[i],l=a[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(a[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(Ho(e),a)}else{const a=Ho(e);if(a!==null&&r)return{...e};const n=Object.create(a);return Object.assign(n,e)}}function tv(e,t=!1){return jm(e)||ro(e)||!In(e)||(ym(e)>1&&Object.defineProperties(e,{set:{value:Nd},add:{value:Nd},clear:{value:Nd},delete:{value:Nd}}),Object.freeze(e),t&&Object.values(e).forEach(r=>tv(r,!0))),e}function Nd(){Va(2)}function jm(e){return Object.isFrozen(e)}var RG={};function so(e){const t=RG[e];return t||Va(0,e),t}var pc;function WC(){return pc}function FG(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ij(e,t){t&&(so("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ex(e){tx(e),e.drafts_.forEach(LG),e.drafts_=null}function tx(e){e===pc&&(pc=e.parent_)}function Oj(e){return pc=FG(pc,e)}function LG(e){const t=e[ga];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Pj(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ga].modified_&&(ex(t),Va(4)),In(e)&&(e=bu(t,e),t.parent_||ju(t,e)),t.patches_&&so("Patches").generateReplacementPatches_(r[ga].base_,e,t.patches_,t.inversePatches_)):e=bu(t,r,[]),ex(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==zC?e:void 0}function bu(e,t,r){if(jm(t))return t;const a=t[ga];if(!a)return yu(t,(n,i)=>Rj(e,a,t,n,i,r)),t;if(a.scope_!==e)return t;if(!a.modified_)return ju(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const n=a.copy_;let i=n,o=!1;a.type_===3&&(i=new Set(n),n.clear(),o=!0),yu(i,(l,c)=>Rj(e,a,n,l,c,r,o)),ju(e,n,!1),r&&e.patches_&&so("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function Rj(e,t,r,a,n,i,o){if(ro(n)){const l=i&&t&&t.type_!==3&&!Zp(t.assigned_,a)?i.concat(a):void 0,c=bu(e,n,l);if(UC(r,a,c),ro(c))e.canAutoFreeze_=!1;else return}else o&&r.add(n);if(In(n)&&!jm(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;bu(e,n),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&($c(r)?r.has(a):Object.prototype.propertyIsEnumerable.call(r,a))&&ju(e,n)}}function ju(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&tv(t,r)}function MG(e,t){const r=Array.isArray(e),a={type_:r?1:0,scope_:t?t.scope_:WC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=a,i=rv;r&&(n=[a],i=xc);const{revoke:o,proxy:l}=Proxy.revocable(n,i);return a.draft_=l,a.revoke_=o,l}var rv={get(e,t){if(t===ga)return e;const r=Ti(e);if(!Zp(r,t))return BG(e,r,t);const a=r[t];return e.finalized_||!In(a)?a:a===hh(e.base_,t)?(ph(e),e.copy_[t]=sx(a,e)):a},has(e,t){return t in Ti(e)},ownKeys(e){return Reflect.ownKeys(Ti(e))},set(e,t,r){const a=HC(Ti(e),t);if(a?.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){const n=hh(Ti(e),t),i=n?.[ga];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(PG(r,n)&&(r!==void 0||Zp(e.base_,t)))return!0;ph(e),rx(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return hh(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,ph(e),rx(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ti(e),a=Reflect.getOwnPropertyDescriptor(r,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:r[t]}},defineProperty(){Va(11)},getPrototypeOf(e){return Ho(e.base_)},setPrototypeOf(){Va(12)}},xc={};yu(rv,(e,t)=>{xc[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});xc.deleteProperty=function(e,t){return xc.set.call(this,e,t,void 0)};xc.set=function(e,t,r){return rv.set.call(this,e[0],t,r,e[0])};function hh(e,t){const r=e[ga];return(r?Ti(r):e)[t]}function BG(e,t,r){const a=HC(t,r);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}function HC(e,t){if(!(t in e))return;let r=Ho(e);for(;r;){const a=Object.getOwnPropertyDescriptor(r,t);if(a)return a;r=Ho(r)}}function rx(e){e.modified_||(e.modified_=!0,e.parent_&&rx(e.parent_))}function ph(e){e.copy_||(e.copy_=Qp(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var zG=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,a)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(c=i,...d){return o.produce(c,u=>r.call(this,u,...d))}}typeof r!="function"&&Va(6),a!==void 0&&typeof a!="function"&&Va(7);let n;if(In(t)){const i=Oj(this),o=sx(t,void 0);let l=!0;try{n=r(o),l=!1}finally{l?ex(i):tx(i)}return Ij(i,a),Pj(n,i)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===zC&&(n=void 0),this.autoFreeze_&&tv(n,!0),a){const i=[],o=[];so("Patches").generateReplacementPatches_(t,n,i,o),a(i,o)}return n}else Va(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let a,n;return[this.produce(t,r,(o,l)=>{a=o,n=l}),a,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){In(e)||Va(8),ro(e)&&(e=Cn(e));const t=Oj(this),r=sx(e,void 0);return r[ga].isManual_=!0,tx(t),r}finishDraft(e,t){const r=e&&e[ga];(!r||!r.isManual_)&&Va(9);const{scope_:a}=r;return Ij(a,t),Pj(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const a=so("Patches").applyPatches_;return ro(e)?a(e,t):this.produce(e,n=>a(n,t))}};function sx(e,t){const r=$c(e)?so("MapSet").proxyMap_(e,t):bm(e)?so("MapSet").proxySet_(e,t):MG(e,t);return(t?t.scope_:WC()).drafts_.push(r),r}function Cn(e){return ro(e)||Va(10,e),VC(e)}function VC(e){if(!In(e)||jm(e))return e;const t=e[ga];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Qp(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Qp(e,!0);return yu(r,(a,n)=>{UC(r,a,VC(n))}),t&&(t.finalized_=!1),r}var $G=new zG,GC=$G.produce;function qC(e){return({dispatch:r,getState:a})=>n=>i=>typeof i=="function"?i(r,a,e):n(i)}var UG=qC(),WG=qC,HG=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?vu:vu.apply(null,arguments)};function Ma(e,t){function r(...a){if(t){let n=t(...a);if(!n)throw new Error(ha(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:a[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=a=>BC(a)&&a.type===e,r}var KC=class Fl extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Fl.prototype)}static get[Symbol.species](){return Fl}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Fl(...t[0].concat(this)):new Fl(...t.concat(this))}};function Fj(e){return In(e)?GC(e,()=>{}):e}function Sd(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function VG(e){return typeof e=="boolean"}var GG=()=>function(t){const{thunk:r=!0,immutableCheck:a=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=t??{};let o=new KC;return r&&(VG(r)?o.push(UG):o.push(WG(r.extraArgument))),o},qG="RTK_autoBatch",Lj=e=>t=>{setTimeout(t,e)},KG=(e={type:"raf"})=>t=>(...r)=>{const a=t(...r);let n=!0,i=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Lj(10):e.type==="callback"?e.queueNotification:Lj(e.timeout),d=()=>{o=!1,i&&(i=!1,l.forEach(u=>u()))};return Object.assign({},a,{subscribe(u){const m=()=>n&&u(),f=a.subscribe(m);return l.add(u),()=>{f(),l.delete(u)}},dispatch(u){try{return n=!u?.meta?.[qG],i=!n,i&&(o||(o=!0,c(d))),a.dispatch(u)}finally{n=!0}}})},YG=e=>function(r){const{autoBatch:a=!0}=r??{};let n=new KC(e);return a&&n.push(KG(typeof a=="object"?a:void 0)),n};function XG(e){const t=GG(),{reducer:r=void 0,middleware:a,devTools:n=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(ev(r))l=MC(r);else throw new Error(ha(1));let c;typeof a=="function"?c=a(t):c=t();let d=vu;n&&(d=HG({trace:!1,...typeof n=="object"&&n}));const u=IG(...c),m=YG(u);let f=typeof o=="function"?o(m):m();const h=d(...f);return LC(l,i,h)}function YC(e){const t={},r=[];let a;const n={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(ha(28));if(l in t)throw new Error(ha(29));return t[l]=o,n},addAsyncThunk(i,o){return o.pending&&(t[i.pending.type]=o.pending),o.rejected&&(t[i.rejected.type]=o.rejected),o.fulfilled&&(t[i.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:i.settled,reducer:o.settled}),n},addMatcher(i,o){return r.push({matcher:i,reducer:o}),n},addDefaultCase(i){return a=i,n}};return e(n),[t,r,a]}function JG(e){return typeof e=="function"}function ZG(e,t){let[r,a,n]=YC(t),i;if(JG(e))i=()=>Fj(e());else{const l=Fj(e);i=()=>l}function o(l=i(),c){let d=[r[c.type],...a.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[n]),d.reduce((u,m)=>{if(m)if(ro(u)){const h=m(u,c);return h===void 0?u:h}else{if(In(u))return GC(u,f=>m(f,c));{const f=m(u,c);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},l)}return o.getInitialState=i,o}var QG="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",eq=(e=21)=>{let t="",r=e;for(;r--;)t+=QG[Math.random()*64|0];return t},tq=Symbol.for("rtk-slice-createasyncthunk");function rq(e,t){return`${e}/${t}`}function sq({creators:e}={}){const t=e?.asyncThunk?.[tq];return function(a){const{name:n,reducerPath:i=n}=a;if(!n)throw new Error(ha(11));const o=(typeof a.reducers=="function"?a.reducers(nq()):a.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(y,w){const S=typeof y=="string"?y:y.type;if(!S)throw new Error(ha(12));if(S in c.sliceCaseReducersByType)throw new Error(ha(13));return c.sliceCaseReducersByType[S]=w,d},addMatcher(y,w){return c.sliceMatchers.push({matcher:y,reducer:w}),d},exposeAction(y,w){return c.actionCreators[y]=w,d},exposeCaseReducer(y,w){return c.sliceCaseReducersByName[y]=w,d}};l.forEach(y=>{const w=o[y],S={reducerName:y,type:rq(n,y),createNotation:typeof a.reducers=="function"};oq(w)?cq(S,w,d,t):iq(S,w,d)});function u(){const[y={},w=[],S=void 0]=typeof a.extraReducers=="function"?YC(a.extraReducers):[a.extraReducers],N={...y,...c.sliceCaseReducersByType};return ZG(a.initialState,E=>{for(let P in N)E.addCase(P,N[P]);for(let P of c.sliceMatchers)E.addMatcher(P.matcher,P.reducer);for(let P of w)E.addMatcher(P.matcher,P.reducer);S&&E.addDefaultCase(S)})}const m=y=>y,f=new Map,h=new WeakMap;let p;function x(y,w){return p||(p=u()),p(y,w)}function g(){return p||(p=u()),p.getInitialState()}function b(y,w=!1){function S(E){let P=E[y];return typeof P>"u"&&w&&(P=Sd(h,S,g)),P}function N(E=m){const P=Sd(f,w,()=>new WeakMap);return Sd(P,E,()=>{const T={};for(const[O,_]of Object.entries(a.selectors??{}))T[O]=aq(_,E,()=>Sd(h,E,g),w);return T})}return{reducerPath:y,getSelectors:N,get selectors(){return N(S)},selectSlice:S}}const j={name:n,reducer:x,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,...b(i),injectInto(y,{reducerPath:w,...S}={}){const N=w??i;return y.inject({reducerPath:N,reducer:x},S),{...j,...b(N,!0)}}};return j}}function aq(e,t,r,a){function n(i,...o){let l=t(i);return typeof l>"u"&&a&&(l=r()),e(l,...o)}return n.unwrapped=e,n}var ba=sq();function nq(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function iq({type:e,reducerName:t,createNotation:r},a,n){let i,o;if("reducer"in a){if(r&&!lq(a))throw new Error(ha(17));i=a.reducer,o=a.prepare}else i=a;n.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?Ma(e,o):Ma(e))}function oq(e){return e._reducerDefinitionType==="asyncThunk"}function lq(e){return e._reducerDefinitionType==="reducerWithPrepare"}function cq({type:e,reducerName:t},r,a,n){if(!n)throw new Error(ha(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=r,m=n(e,i,u);a.exposeAction(t,m),o&&a.addCase(m.fulfilled,o),l&&a.addCase(m.pending,l),c&&a.addCase(m.rejected,c),d&&a.addMatcher(m.settled,d),a.exposeCaseReducer(t,{fulfilled:o||Ed,pending:l||Ed,rejected:c||Ed,settled:d||Ed})}function Ed(){}var dq="task",XC="listener",JC="completed",sv="cancelled",uq=`task-${sv}`,mq=`task-${JC}`,ax=`${XC}-${sv}`,fq=`${XC}-${JC}`,wm=class{constructor(e){this.code=e,this.message=`${dq} ${sv} (reason: ${e})`}name="TaskAbortError";message},av=(e,t)=>{if(typeof e!="function")throw new TypeError(ha(32))},wu=()=>{},ZC=(e,t=wu)=>(e.catch(t),e),QC=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),$i=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Ui=e=>{if(e.aborted){const{reason:t}=e;throw new wm(t)}};function eA(e,t){let r=wu;return new Promise((a,n)=>{const i=()=>n(new wm(e.reason));if(e.aborted){i();return}r=QC(e,i),t.finally(()=>r()).then(a,n)}).finally(()=>{r=wu})}var hq=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof wm?"cancelled":"rejected",error:r}}finally{t?.()}},Nu=e=>t=>ZC(eA(e,t).then(r=>(Ui(e),r))),tA=e=>{const t=Nu(e);return r=>t(new Promise(a=>setTimeout(a,r)))},{assign:Po}=Object,Mj={},Nm="listenerMiddleware",pq=(e,t)=>{const r=a=>QC(e,()=>$i(a,e.reason));return(a,n)=>{av(a);const i=new AbortController;r(i);const o=hq(async()=>{Ui(e),Ui(i.signal);const l=await a({pause:Nu(i.signal),delay:tA(i.signal),signal:i.signal});return Ui(i.signal),l},()=>$i(i,mq));return n?.autoJoin&&t.push(o.catch(wu)),{result:Nu(e)(o),cancel(){$i(i,uq)}}}},xq=(e,t)=>{const r=async(a,n)=>{Ui(t);let i=()=>{};const l=[new Promise((c,d)=>{let u=e({predicate:a,effect:(m,f)=>{f.unsubscribe(),c([m,f.getState(),f.getOriginalState()])}});i=()=>{u(),d()}})];n!=null&&l.push(new Promise(c=>setTimeout(c,n,null)));try{const c=await eA(t,Promise.race(l));return Ui(t),c}finally{i()}};return(a,n)=>ZC(r(a,n))},rA=e=>{let{type:t,actionCreator:r,matcher:a,predicate:n,effect:i}=e;if(t)n=Ma(t).match;else if(r)t=r.type,n=r.match;else if(a)n=a;else if(!n)throw new Error(ha(21));return av(i),{predicate:n,type:t,effect:i}},sA=Po(e=>{const{type:t,predicate:r,effect:a}=rA(e);return{id:eq(),effect:a,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ha(22))}}},{withTypes:()=>sA}),Bj=(e,t)=>{const{type:r,effect:a,predicate:n}=rA(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===a)},nx=e=>{e.pending.forEach(t=>{$i(t,ax)})},gq=e=>()=>{e.forEach(nx),e.clear()},zj=(e,t,r)=>{try{e(t,r)}catch(a){setTimeout(()=>{throw a},0)}},aA=Po(Ma(`${Nm}/add`),{withTypes:()=>aA}),vq=Ma(`${Nm}/removeAll`),nA=Po(Ma(`${Nm}/remove`),{withTypes:()=>nA}),yq=(...e)=>{console.error(`${Nm}/error`,...e)},Uc=(e={})=>{const t=new Map,{extra:r,onError:a=yq}=e;av(a);const n=u=>(u.unsubscribe=()=>t.delete(u.id),t.set(u.id,u),m=>{u.unsubscribe(),m?.cancelActive&&nx(u)}),i=u=>{const m=Bj(t,u)??sA(u);return n(m)};Po(i,{withTypes:()=>i});const o=u=>{const m=Bj(t,u);return m&&(m.unsubscribe(),u.cancelActive&&nx(m)),!!m};Po(o,{withTypes:()=>o});const l=async(u,m,f,h)=>{const p=new AbortController,x=xq(i,p.signal),g=[];try{u.pending.add(p),await Promise.resolve(u.effect(m,Po({},f,{getOriginalState:h,condition:(b,j)=>x(b,j).then(Boolean),take:x,delay:tA(p.signal),pause:Nu(p.signal),extra:r,signal:p.signal,fork:pq(p.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{t.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((b,j,y)=>{b!==p&&($i(b,ax),y.delete(b))})},cancel:()=>{$i(p,ax),u.pending.delete(p)},throwIfCancelled:()=>{Ui(p.signal)}})))}catch(b){b instanceof wm||zj(a,b,{raisedBy:"effect"})}finally{await Promise.all(g),$i(p,fq),u.pending.delete(p)}},c=gq(t);return{middleware:u=>m=>f=>{if(!BC(f))return m(f);if(aA.match(f))return i(f.payload);if(vq.match(f)){c();return}if(nA.match(f))return o(f.payload);let h=u.getState();const p=()=>{if(h===Mj)throw new Error(ha(23));return h};let x;try{if(x=m(f),t.size>0){const g=u.getState(),b=Array.from(t.values());for(const j of b){let y=!1;try{y=j.predicate(f,g,h)}catch(w){y=!1,zj(a,w,{raisedBy:"predicate"})}y&&l(j,f,u,p)}}}finally{h=Mj}return x},startListening:i,stopListening:o,clearListeners:c}};function ha(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var bq={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},iA=ba({name:"chartLayout",initialState:bq,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,a,n,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(a=t.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(n=t.payload.bottom)!==null&&n!==void 0?n:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:jq,setLayout:wq,setChartSize:Nq,setScale:Sq}=iA.actions,Eq=iA.reducer;function $j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Uj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$j(Object(r),!0).forEach(function(a){Tq(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$j(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Tq(e,t,r){return(t=Cq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cq(e){var t=Aq(e,"string");return typeof t=="symbol"?t:t+""}function Aq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Su=Math.PI/180,_q=e=>e*180/Math.PI,qr=(e,t,r,a)=>({x:e+Math.cos(-Su*a)*r,y:t+Math.sin(-Su*a)*r}),oA=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(r-(a.top||0)-(a.bottom||0)))/2},kq=(e,t)=>{var{x:r,y:a}=e,{x:n,y:i}=t;return Math.sqrt((r-n)**2+(a-i)**2)},Dq=(e,t)=>{var{x:r,y:a}=e,{cx:n,cy:i}=t,o=kq({x:r,y:a},{x:n,y:i});if(o<=0)return{radius:o,angle:0};var l=(r-n)/o,c=Math.acos(l);return a>i&&(c=2*Math.PI-c),{radius:o,angle:_q(c),angleInRadian:c}},Iq=e=>{var{startAngle:t,endAngle:r}=e,a=Math.floor(t/360),n=Math.floor(r/360),i=Math.min(a,n);return{startAngle:t-i*360,endAngle:r-i*360}},Oq=(e,t)=>{var{startAngle:r,endAngle:a}=t,n=Math.floor(r/360),i=Math.floor(a/360),o=Math.min(n,i);return e+o*360},Pq=(e,t)=>{var{x:r,y:a}=e,{radius:n,angle:i}=Dq({x:r,y:a},t),{innerRadius:o,outerRadius:l}=t;if(n<o||n>l||n===0)return null;var{startAngle:c,endAngle:d}=Iq(t),u=i,m;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;m=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;m=u>=d&&u<=c}return m?Uj(Uj({},t),{},{radius:n,angle:Oq(u,t)}):null};function lA(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Wj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ia(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wj(Object(r),!0).forEach(function(a){Rq(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Rq(e,t,r){return(t=Fq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fq(e){var t=Lq(e,"string");return typeof t=="symbol"?t:t+""}function Lq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cr(e,t,r){return ms(e)||ms(t)?r:fn(t)?to(e,t,r):typeof t=="function"?t(e):r}var Mq=(e,t,r,a,n)=>{var i,o=-1,l=(i=t?.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(a==="angleAxis"&&n!=null&&Math.abs(Math.abs(n[1]-n[0])-360)<=1e-6)for(var c=0;c<l;c++){var d=c>0?r[c-1].coordinate:r[l-1].coordinate,u=r[c].coordinate,m=c>=l-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(ds(u-d)!==ds(m-u)){var h=[];if(ds(m-u)===ds(n[1]-n[0])){f=m;var p=u+n[1]-n[0];h[0]=Math.min(p,(p+d)/2),h[1]=Math.max(p,(p+d)/2)}else{f=d;var x=m+n[1]-n[0];h[0]=Math.min(u,(x+u)/2),h[1]=Math.max(u,(x+u)/2)}var g=[Math.min(u,(f+u)/2),Math.max(u,(f+u)/2)];if(e>g[0]&&e<=g[1]||e>=h[0]&&e<=h[1]){({index:o}=r[c]);break}}else{var b=Math.min(d,m),j=Math.max(d,m);if(e>(b+u)/2&&e<=(j+u)/2){({index:o}=r[c]);break}}}else if(t){for(var y=0;y<l;y++)if(y===0&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y>0&&y<l-1&&e>(t[y].coordinate+t[y-1].coordinate)/2&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y===l-1&&e>(t[y].coordinate+t[y-1].coordinate)/2){({index:o}=t[y]);break}}return o},Bq=(e,t,r)=>{if(t&&r){var{width:a,height:n}=r,{align:i,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&i!=="center"&&it(e[i]))return Ia(Ia({},e),{},{[i]:e[i]+(a||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&o!=="middle"&&it(e[o]))return Ia(Ia({},e),{},{[o]:e[o]+(n||0)})}return e},po=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",cA=(e,t,r,a)=>{if(a)return e.map(l=>l.coordinate);var n,i,o=e.map(l=>(l.coordinate===t&&(n=!0),l.coordinate===r&&(i=!0),l.coordinate));return n||o.push(t),i||o.push(r),o},dA=(e,t,r)=>{if(!e)return null;var{duplicateDomain:a,type:n,range:i,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:d,tickCount:u,ticks:m,niceTicks:f,axisType:h}=e;if(!o)return null;var p=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,x=n==="category"&&o.bandwidth?o.bandwidth()/p:0;if(x=h==="angleAxis"&&i&&i.length>=2?ds(i[0]-i[1])*2*x:x,m||f){var g=(m||f||[]).map((b,j)=>{var y=a?a.indexOf(b):b;return{coordinate:o(y)+x,value:b,offset:x,index:j}});return g.filter(b=>!xa(b.coordinate))}return c&&d?d.map((b,j)=>({coordinate:o(b)+x,value:b,index:j,offset:x})):o.ticks&&u!=null?o.ticks(u).map((b,j)=>({coordinate:o(b)+x,value:b,offset:x,index:j})):o.domain().map((b,j)=>({coordinate:o(b)+x,value:a?a[b]:b,index:j,offset:x}))},Hj=1e-4,zq=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,a=e.range(),n=Math.min(a[0],a[1])-Hj,i=Math.max(a[0],a[1])+Hj,o=e(t[0]),l=e(t[r-1]);(o<n||o>i||l<n||l>i)&&e.domain([t[0],t[r-1]])}},$q=(e,t)=>{if(!t||t.length!==2||!it(t[0])||!it(t[1]))return e;var r=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]),n=[e[0],e[1]];return(!it(e[0])||e[0]<r)&&(n[0]=r),(!it(e[1])||e[1]>a)&&(n[1]=a),n[0]>a&&(n[0]=a),n[1]<r&&(n[1]=r),n},Uq=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var n=0,i=0,o=0;o<t;++o){var l=xa(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=n,e[o][r][1]=n+l,n=e[o][r][1]):(e[o][r][0]=i,e[o][r][1]=i+l,i=e[o][r][1])}},Wq=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var n=0,i=0;i<t;++i){var o=xa(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=n,e[i][r][1]=n+o,n=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},Hq={sign:Uq,expand:yV,none:Wo,silhouette:bV,wiggle:jV,positive:Wq},Vq=(e,t,r)=>{var a=Hq[r],n=vV().keys(t).value((i,o)=>+Cr(i,o,0)).order(Yp).offset(a);return n(e)};function Gq(e){return e==null?void 0:String(e)}var Vj=e=>{var{axis:t,ticks:r,offset:a,bandSize:n,entry:i,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+a:null;var l=Cr(i,t.dataKey,t.scale.domain()[o]);return ms(l)?null:t.scale(l)-n/2+a},qq=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var a=Math.min(r[0],r[1]),n=Math.max(r[0],r[1]);return a<=0&&n>=0?0:n<0?n:a}return r[0]},Kq=e=>{var t=e.flat(2).filter(it);return[Math.min(...t),Math.max(...t)]},Yq=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Xq=(e,t,r)=>{if(e!=null)return Yq(Object.keys(e).reduce((a,n)=>{var i=e[n],{stackedData:o}=i,l=o.reduce((c,d)=>{var u=lA(d,t,r),m=Kq(u);return[Math.min(c[0],m[0]),Math.max(c[1],m[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]))},Gj=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,qj=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,nv=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!r||a>0)return a}if(e&&t&&t.length>=2){for(var n=vm(t,u=>u.coordinate),i=1/0,o=1,l=n.length;o<l;o++){var c=n[o],d=n[o-1];i=Math.min((c.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function Kj(e){var{tooltipEntrySettings:t,dataKey:r,payload:a,value:n,name:i}=e;return Ia(Ia({},t),{},{dataKey:r,payload:a,value:n,name:i})}function Sm(e,t){if(e)return String(e);if(typeof t=="string")return t}function Jq(e,t,r,a,n){if(r==="horizontal"||r==="vertical"){var i=e>=n.left&&e<=n.left+n.width&&t>=n.top&&t<=n.top+n.height;return i?{x:e,y:t}:null}return a?Pq({x:e,y:t},a):null}var Zq=(e,t,r,a)=>{var n=t.find(d=>d&&d.index===r);if(n){if(e==="horizontal")return{x:n.coordinate,y:a.y};if(e==="vertical")return{x:a.x,y:n.coordinate};if(e==="centric"){var i=n.coordinate,{radius:o}=a;return Ia(Ia(Ia({},a),qr(a.cx,a.cy,o,i)),{},{angle:i,radius:o})}var l=n.coordinate,{angle:c}=a;return Ia(Ia(Ia({},a),qr(a.cx,a.cy,l,c)),{},{angle:c,radius:l})}return{x:0,y:0}},Qq=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,zn=e=>e.layout.width,$n=e=>e.layout.height,eK=e=>e.layout.scale,uA=e=>e.layout.margin,Em=we(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Tm=we(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),mA="data-recharts-item-index",fA="data-recharts-item-data-key",Wc=60;function Yj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Td(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yj(Object(r),!0).forEach(function(a){tK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function tK(e,t,r){return(t=rK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rK(e){var t=sK(e,"string");return typeof t=="symbol"?t:t+""}function sK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aK=e=>e.brush.height;function nK(e){var t=Tm(e);return t.reduce((r,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var n=typeof a.width=="number"?a.width:Wc;return r+n}return r},0)}function iK(e){var t=Tm(e);return t.reduce((r,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var n=typeof a.width=="number"?a.width:Wc;return r+n}return r},0)}function oK(e){var t=Em(e);return t.reduce((r,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?r+a.height:r,0)}function lK(e){var t=Em(e);return t.reduce((r,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?r+a.height:r,0)}var ss=we([zn,$n,uA,aK,nK,iK,oK,lK,RC,EG],(e,t,r,a,n,i,o,l,c,d)=>{var u={left:(r.left||0)+n,right:(r.right||0)+i},m={top:(r.top||0)+o,bottom:(r.bottom||0)+l},f=Td(Td({},m),u),h=f.bottom;f.bottom+=a,f=Bq(f,c,d);var p=e-f.left-f.right,x=t-f.top-f.bottom;return Td(Td({brushBottom:h},f),{},{width:Math.max(p,0),height:Math.max(x,0)})}),cK=we(ss,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),iv=we(zn,$n,(e,t)=>({x:0,y:0,width:e,height:t})),dK=v.createContext(null),$a=()=>v.useContext(dK)!=null,Cm=e=>e.brush,Am=we([Cm,ss,uA],(e,t,r)=>({height:e.height,x:it(e.x)?e.x:t.left,y:it(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:it(e.width)?e.width:t.width})),ov=()=>{var e,t=$a(),r=at(cK),a=at(Am),n=(e=at(Cm))===null||e===void 0?void 0:e.padding;return!t||!a||!n?r:{width:a.width-n.left-n.right,height:a.height-n.top-n.bottom,x:n.left,y:n.top}},uK={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},hA=()=>{var e;return(e=at(ss))!==null&&e!==void 0?e:uK},lv=()=>at(zn),cv=()=>at($n),mK=()=>at(e=>e.layout.margin),Kt=e=>e.layout.layoutType,dv=()=>at(Kt),fK={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},pA=ba({name:"legend",initialState:fK,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Cn(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:Xj,setLegendSettings:hK,addLegendPayload:xA,removeLegendPayload:gA}=pA.actions,pK=pA.reducer,xK=["contextPayload"];function ix(){return ix=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ix.apply(null,arguments)}function Jj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Vo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jj(Object(r),!0).forEach(function(a){uv(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function uv(e,t,r){return(t=gK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=vK(e,"string");return typeof t=="symbol"?t:t+""}function vK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yK(e,t){if(e==null)return{};var r,a,n=bK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bK(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function jK(e){return e.value}function wK(e){var{contextPayload:t}=e,r=yK(e,xK),a=DC(t,e.payloadUniqBy,jK),n=Vo(Vo({},r),{},{payload:a});return v.isValidElement(e.content)?v.cloneElement(e.content,n):typeof e.content=="function"?v.createElement(e.content,n):v.createElement(Xg,n)}function NK(e,t,r,a,n,i){var{layout:o,align:l,verticalAlign:c}=t,d,u;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?d={left:((a||0)-i.width)/2}:d=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?u={top:((n||0)-i.height)/2}:u=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Vo(Vo({},d),u)}function SK(e){var t=kr();return v.useEffect(()=>{t(hK(e))},[t,e]),null}function EK(e){var t=kr();return v.useEffect(()=>(t(Xj(e)),()=>{t(Xj({width:0,height:0}))}),[t,e]),null}function TK(e){var t=AG(),r=UH(),a=mK(),{width:n,height:i,wrapperStyle:o,portal:l}=e,[c,d]=FC([t]),u=lv(),m=cv();if(u==null||m==null)return null;var f=u-(a.left||0)-(a.right||0),h=Ii.getWidthOrHeight(e.layout,i,n,f),p=l?o:Vo(Vo({position:"absolute",width:h?.width||n||"auto",height:h?.height||i||"auto"},NK(o,e,a,u,m,c)),o),x=l??r;if(x==null)return null;var g=v.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},v.createElement(SK,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),v.createElement(EK,{width:c.width,height:c.height}),v.createElement(wK,ix({},e,h,{margin:a,chartWidth:u,chartHeight:m,contextPayload:t})));return Fx.createPortal(g,x)}class Ii extends v.PureComponent{static getWidthOrHeight(t,r,a,n){return t==="vertical"&&it(r)?{height:r}:t==="horizontal"?{width:a||n}:null}render(){return v.createElement(TK,this.props)}}uv(Ii,"displayName","Legend");uv(Ii,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function ox(){return ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ox.apply(null,arguments)}function Zj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function xh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zj(Object(r),!0).forEach(function(a){CK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function CK(e,t,r){return(t=AK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AK(e){var t=_K(e,"string");return typeof t=="symbol"?t:t+""}function _K(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kK(e){return Array.isArray(e)&&fn(e[0])&&fn(e[1])?e.join(" ~ "):e}var DK=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:a={},labelStyle:n={},payload:i,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:m,accessibilityLayer:f=!1}=e,h=()=>{if(i&&i.length){var S={padding:0,margin:0},N=(l?vm(i,l):i).map((E,P)=>{if(E.type==="none")return null;var T=E.formatter||o||kK,{value:O,name:_}=E,C=O,R=_;if(T){var M=T(O,_,E,P,i);if(Array.isArray(M))[C,R]=M;else if(M!=null)C=M;else return null}var U=xh({display:"block",paddingTop:4,paddingBottom:4,color:E.color||"#000"},a);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(P),style:U},fn(R)?v.createElement("span",{className:"recharts-tooltip-item-name"},R):null,fn(R)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},C),v.createElement("span",{className:"recharts-tooltip-item-unit"},E.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:S},N)}return null},p=xh({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),x=xh({margin:0},n),g=!ms(u),b=g?u:"",j=Mt("recharts-default-tooltip",c),y=Mt("recharts-tooltip-label",d);g&&m&&i!==void 0&&i!==null&&(b=m(u,i));var w=f?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",ox({className:j,style:p},w),v.createElement("p",{className:y,style:x},v.isValidElement(b)?b:"".concat(b)),h())},Sl="recharts-tooltip-wrapper",IK={visibility:"hidden"};function OK(e){var{coordinate:t,translateX:r,translateY:a}=e;return Mt(Sl,{["".concat(Sl,"-right")]:it(r)&&t&&it(t.x)&&r>=t.x,["".concat(Sl,"-left")]:it(r)&&t&&it(t.x)&&r<t.x,["".concat(Sl,"-bottom")]:it(a)&&t&&it(t.y)&&a>=t.y,["".concat(Sl,"-top")]:it(a)&&t&&it(t.y)&&a<t.y})}function Qj(e){var{allowEscapeViewBox:t,coordinate:r,key:a,offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:d}=e;if(i&&it(i[a]))return i[a];var u=r[a]-l-(n>0?n:0),m=r[a]+n;if(t[a])return o[a]?u:m;var f=c[a];if(f==null)return 0;if(o[a]){var h=u,p=f;return h<p?Math.max(m,f):Math.max(u,f)}if(d==null)return 0;var x=m+l,g=f+d;return x>g?Math.max(u,f):Math.max(m,f)}function PK(e){var{translateX:t,translateY:r,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function RK(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:a,position:n,reverseDirection:i,tooltipBox:o,useTranslate3d:l,viewBox:c}=e,d,u,m;return o.height>0&&o.width>0&&r?(u=Qj({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:a,position:n,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),m=Qj({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:a,position:n,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=PK({translateX:u,translateY:m,useTranslate3d:l})):d=IK,{cssProperties:d,cssClasses:OK({translateX:u,translateY:m,coordinate:r})}}function ew(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Cd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ew(Object(r),!0).forEach(function(a){lx(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ew(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function lx(e,t,r){return(t=FK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FK(e){var t=LK(e,"string");return typeof t=="symbol"?t:t+""}function LK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class MK extends v.PureComponent{constructor(){super(...arguments),lx(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),lx(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,a,n,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&r!==void 0?r:0,y:(n=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&n!==void 0?n:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:a,animationEasing:n,children:i,coordinate:o,hasPayload:l,isAnimationActive:c,offset:d,position:u,reverseDirection:m,useTranslate3d:f,viewBox:h,wrapperStyle:p,lastBoundingBox:x,innerRef:g,hasPortalFromProps:b}=this.props,{cssClasses:j,cssProperties:y}=RK({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:d,position:u,reverseDirection:m,tooltipBox:{height:x.height,width:x.width},useTranslate3d:f,viewBox:h}),w=b?{}:Cd(Cd({transition:c&&t?"transform ".concat(a,"ms ").concat(n):void 0},y),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),S=Cd(Cd({},w),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},p);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:j,style:S,ref:g},i)}}var BK=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),xo={devToolsEnabled:!1,isSsr:BK()},vA=()=>at(e=>e.rootProps.accessibilityLayer);function va(e){return Number.isFinite(e)}function Go(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function cx(){return cx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},cx.apply(null,arguments)}function tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function rw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tw(Object(r),!0).forEach(function(a){zK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function zK(e,t,r){return(t=$K(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $K(e){var t=UK(e,"string");return typeof t=="symbol"?t:t+""}function UK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sw={curveBasisClosed:oV,curveBasisOpen:lV,curveBasis:iV,curveBumpX:GH,curveBumpY:qH,curveLinearClosed:cV,curveLinear:xm,curveMonotoneX:dV,curveMonotoneY:uV,curveNatural:mV,curveStep:fV,curveStepAfter:pV,curveStepBefore:hV},Ad=e=>va(e.x)&&va(e.y),El=e=>e.x,Tl=e=>e.y,WK=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Bc(e));return(r==="curveMonotone"||r==="curveBump")&&t?sw["".concat(r).concat(t==="vertical"?"Y":"X")]:sw[r]||xm},HK=e=>{var{type:t="linear",points:r=[],baseLine:a,layout:n,connectNulls:i=!1}=e,o=WK(t,n),l=i?r.filter(Ad):r,c;if(Array.isArray(a)){var d=i?a.filter(m=>Ad(m)):a,u=l.map((m,f)=>rw(rw({},m),{},{base:d[f]}));return n==="vertical"?c=bd().y(Tl).x1(El).x0(m=>m.base.x):c=bd().x(El).y1(Tl).y0(m=>m.base.y),c.defined(Ad).curve(o),c(u)}return n==="vertical"&&it(a)?c=bd().y(Tl).x1(El).x0(a):it(a)?c=bd().x(El).y1(Tl).y0(a):c=uC().x(El).y(Tl),c.defined(Ad).curve(o),c(l)},yA=e=>{var{className:t,points:r,path:a,pathRef:n}=e;if((!r||!r.length)&&!a)return null;var i=r&&r.length?HK(e):a;return v.createElement("path",cx({},gi(e),IH(e),{className:Mt("recharts-curve",t),d:i===null?void 0:i,ref:n}))},VK=["x","y","top","left","width","height","className"];function dx(){return dx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},dx.apply(null,arguments)}function aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function GK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aw(Object(r),!0).forEach(function(a){qK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function qK(e,t,r){return(t=KK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KK(e){var t=YK(e,"string");return typeof t=="symbol"?t:t+""}function YK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XK(e,t){if(e==null)return{};var r,a,n=JK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function JK(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ZK=(e,t,r,a,n,i)=>"M".concat(e,",").concat(n,"v").concat(a,"M").concat(i,",").concat(t,"h").concat(r),QK=e=>{var{x:t=0,y:r=0,top:a=0,left:n=0,width:i=0,height:o=0,className:l}=e,c=XK(e,VK),d=GK({x:t,y:r,top:a,left:n,width:i,height:o},c);return!it(t)||!it(r)||!it(i)||!it(o)||!it(a)||!it(n)?null:v.createElement("path",dx({},ts(d,!0),{className:Mt("recharts-cross",l),d:ZK(t,r,i,o,a,n)}))};function eY(e,t,r,a){var n=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-n:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-n,width:e==="horizontal"?a:r.width-1,height:e==="horizontal"?r.height-1:a}}function nw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function tY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nw(Object(r),!0).forEach(function(a){rY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function rY(e,t,r){return(t=sY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sY(e){var t=aY(e,"string");return typeof t=="symbol"?t:t+""}function aY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qs(e,t){var r=tY({},e),a=t,n=Object.keys(t),i=n.reduce((o,l)=>(o[l]===void 0&&a[l]!==void 0&&(o[l]=a[l]),o),r);return i}function nY(){}function iw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function ow(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iw(Object(r),!0).forEach(function(a){iY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function iY(e,t,r){return(t=oY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oY(e){var t=lY(e,"string");return typeof t=="symbol"?t:t+""}function lY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cY=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),bA=(e,t,r)=>e.map(a=>"".concat(cY(a)," ").concat(t,"ms ").concat(r)).join(","),dY=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,a)=>r.filter(n=>a.includes(n))),gc=(e,t)=>Object.keys(t).reduce((r,a)=>ow(ow({},r),{},{[a]:e(a,t[a])}),{});function lw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function gs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lw(Object(r),!0).forEach(function(a){uY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function uY(e,t,r){return(t=mY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mY(e){var t=fY(e,"string");return typeof t=="symbol"?t:t+""}function fY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Eu=(e,t,r)=>e+(t-e)*r,ux=e=>{var{from:t,to:r}=e;return t!==r},jA=(e,t,r)=>{var a=gc((n,i)=>{if(ux(i)){var[o,l]=e(i.from,i.to,i.velocity);return gs(gs({},i),{},{from:o,velocity:l})}return i},t);return r<1?gc((n,i)=>ux(i)?gs(gs({},i),{},{velocity:Eu(i.velocity,a[n].velocity,r),from:Eu(i.from,a[n].from,r)}):i,t):jA(e,a,r-1)};function hY(e,t,r,a,n,i){var o,l=a.reduce((f,h)=>gs(gs({},f),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>gc((f,h)=>h.from,l),d=()=>!Object.values(l).filter(ux).length,u=null,m=f=>{o||(o=f);var h=f-o,p=h/r.dt;l=jA(r,l,p),n(gs(gs(gs({},e),t),c())),o=f,d()||(u=i.setTimeout(m))};return()=>(u=i.setTimeout(m),()=>{u()})}function pY(e,t,r,a,n,i,o){var l=null,c=n.reduce((m,f)=>gs(gs({},m),{},{[f]:[e[f],t[f]]}),{}),d,u=m=>{d||(d=m);var f=(m-d)/a,h=gc((x,g)=>Eu(...g,r(f)),c);if(i(gs(gs(gs({},e),t),h)),f<1)l=o.setTimeout(u);else{var p=gc((x,g)=>Eu(...g,r(1)),c);i(gs(gs(gs({},e),t),p))}};return()=>(l=o.setTimeout(u),()=>{l()})}const xY=(e,t,r,a,n,i)=>{var o=dY(e,t);return r.isStepper===!0?hY(e,t,r,o,n,i):pY(e,t,r,a,o,n,i)};var Tu=1e-4,wA=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],NA=(e,t)=>e.map((r,a)=>r*t**a).reduce((r,a)=>r+a),cw=(e,t)=>r=>{var a=wA(e,t);return NA(a,r)},gY=(e,t)=>r=>{var a=wA(e,t),n=[...a.map((i,o)=>i*o).slice(1),0];return NA(n,r)},dw=function(){for(var t,r,a,n,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];if(o.length===1)switch(o[0]){case"linear":[t,a,r,n]=[0,0,1,1];break;case"ease":[t,a,r,n]=[.25,.1,.25,1];break;case"ease-in":[t,a,r,n]=[.42,0,1,1];break;case"ease-out":[t,a,r,n]=[.42,0,.58,1];break;case"ease-in-out":[t,a,r,n]=[0,0,.58,1];break;default:{var c=o[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,a,r,n]=c[1].split(")")[0].split(",").map(p=>parseFloat(p)))}}else o.length===4&&([t,a,r,n]=o);var d=cw(t,r),u=cw(a,n),m=gY(t,r),f=p=>p>1?1:p<0?0:p,h=p=>{for(var x=p>1?1:p,g=x,b=0;b<8;++b){var j=d(g)-x,y=m(g);if(Math.abs(j-x)<Tu||y<Tu)return u(g);g=f(g-j/y)}return u(g)};return h.isStepper=!1,h},vY=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:a=8,dt:n=17}=t,i=(o,l,c)=>{var d=-(o-l)*r,u=c*a,m=c+(d-u)*n/1e3,f=c*n/1e3+o;return Math.abs(f-l)<Tu&&Math.abs(m)<Tu?[l,0]:[f,m]};return i.isStepper=!0,i.dt=n,i},yY=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return dw(e);case"spring":return vY();default:if(e.split("(")[0]==="cubic-bezier")return dw(e)}return typeof e=="function"?e:null};function bY(e){var t,r=()=>null,a=!1,n=null,i=o=>{if(!a){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...d]=l;if(typeof c=="number"){n=e.setTimeout(i.bind(null,d),c);return}i(c),n=e.setTimeout(i.bind(null,d));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{a=!0},start:o=>{a=!1,n&&(n(),n=null),i(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class jY{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),n=null,i=o=>{o-a>=r?t(o):typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(i))};return n=requestAnimationFrame(i),()=>{cancelAnimationFrame(n)}}}function wY(){return bY(new jY)}var NY=v.createContext(wY);function SY(e,t){var r=v.useContext(NY);return v.useMemo(()=>t??r(e),[e,t,r])}var EY={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},uw={t:0},gh={t:1};function _m(e){var t=qs(e,EY),{isActive:r,canBegin:a,duration:n,easing:i,begin:o,onAnimationEnd:l,onAnimationStart:c,children:d}=t,u=SY(t.animationId,t.animationManager),[m,f]=v.useState(r?uw:gh),h=v.useRef(null);return v.useEffect(()=>{r||f(gh)},[r]),v.useEffect(()=>{if(!r||!a)return nY;var p=xY(uw,gh,yY(i),n,f,u.getTimeoutController()),x=()=>{h.current=p()};return u.start([c,o,x,n,l]),()=>{u.stop(),h.current&&h.current(),l()}},[r,a,n,i,o,c,l,u]),d(m.t)}function km(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(hc(t)),a=v.useRef(e);return a.current!==e&&(r.current=hc(t),a.current=e),r.current}function mw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function fw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mw(Object(r),!0).forEach(function(a){TY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function TY(e,t,r){return(t=CY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CY(e){var t=AY(e,"string");return typeof t=="symbol"?t:t+""}function AY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cu(){return Cu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Cu.apply(null,arguments)}var hw=(e,t,r,a,n)=>{var i=Math.min(Math.abs(r)/2,Math.abs(a)/2),o=a>=0?1:-1,l=r>=0?1:-1,c=a>=0&&r>=0||a<0&&r<0?1:0,d;if(i>0&&n instanceof Array){for(var u=[0,0,0,0],m=0,f=4;m<f;m++)u[m]=n[m]>i?i:n[m];d="M".concat(e,",").concat(t+o*u[0]),u[0]>0&&(d+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+l*u[0],",").concat(t)),d+="L ".concat(e+r-l*u[1],",").concat(t),u[1]>0&&(d+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+o*u[1])),d+="L ".concat(e+r,",").concat(t+a-o*u[2]),u[2]>0&&(d+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+r-l*u[2],",").concat(t+a)),d+="L ".concat(e+l*u[3],",").concat(t+a),u[3]>0&&(d+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+a-o*u[3])),d+="Z"}else if(i>0&&n===+n&&n>0){var h=Math.min(i,n);d="M ".concat(e,",").concat(t+o*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,`
            L `).concat(e+r-l*h,",").concat(t,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r,",").concat(t+o*h,`
            L `).concat(e+r,",").concat(t+a-o*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r-l*h,",").concat(t+a,`
            L `).concat(e+l*h,",").concat(t+a,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+a-o*h," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return d},_Y={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},SA=e=>{var t=qs(e,_Y),r=v.useRef(null),[a,n]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var M=r.current.getTotalLength();M&&n(M)}catch{}},[]);var{x:i,y:o,width:l,height:c,radius:d,className:u}=t,{animationEasing:m,animationDuration:f,animationBegin:h,isAnimationActive:p,isUpdateAnimationActive:x}=t,g=v.useRef(l),b=v.useRef(c),j=v.useRef(i),y=v.useRef(o),w=v.useMemo(()=>({x:i,y:o,width:l,height:c,radius:d}),[i,o,l,c,d]),S=km(w,"rectangle-");if(i!==+i||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var N=Mt("recharts-rectangle",u);if(!x)return v.createElement("path",Cu({},ts(t,!0),{className:N,d:hw(i,o,l,c,d)}));var E=g.current,P=b.current,T=j.current,O=y.current,_="0px ".concat(a===-1?1:a,"px"),C="".concat(a,"px 0px"),R=bA(["strokeDasharray"],f,typeof m=="string"?m:void 0);return v.createElement(_m,{animationId:S,key:S,canBegin:a>0,duration:f,easing:m,isActive:x,begin:h},M=>{var U=ys(E,l,M),Z=ys(P,c,M),ee=ys(T,i,M),re=ys(O,o,M);r.current&&(g.current=U,b.current=Z,j.current=ee,y.current=re);var z;return p?M>0?z={transition:R,strokeDasharray:C}:z={strokeDasharray:_}:z={strokeDasharray:C},v.createElement("path",Cu({},ts(t,!0),{className:N,d:hw(ee,re,U,Z,d),ref:r,style:fw(fw({},z),t.style)}))})};function EA(e){var{cx:t,cy:r,radius:a,startAngle:n,endAngle:i}=e,o=qr(t,r,a,n),l=qr(t,r,a,i);return{points:[o,l],cx:t,cy:r,radius:a,startAngle:n,endAngle:i}}function mx(){return mx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},mx.apply(null,arguments)}var kY=(e,t)=>{var r=ds(t-e),a=Math.min(Math.abs(t-e),359.999);return r*a},_d=e=>{var{cx:t,cy:r,radius:a,angle:n,sign:i,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,d=l*(o?1:-1)+a,u=Math.asin(l/d)/Su,m=c?n:n+i*u,f=qr(t,r,d,m),h=qr(t,r,a,m),p=c?n-i*u:n,x=qr(t,r,d*Math.cos(u*Su),p);return{center:f,circleTangency:h,lineTangency:x,theta:u}},TA=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:n,startAngle:i,endAngle:o}=e,l=kY(i,o),c=i+l,d=qr(t,r,n,i),u=qr(t,r,n,c),m="M ".concat(d.x,",").concat(d.y,`
    A `).concat(n,",").concat(n,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(a>0){var f=qr(t,r,a,i),h=qr(t,r,a,c);m+="L ".concat(h.x,",").concat(h.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},DY=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:n,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d}=e,u=ds(d-c),{circleTangency:m,lineTangency:f,theta:h}=_d({cx:t,cy:r,radius:n,angle:c,sign:u,cornerRadius:i,cornerIsExternal:l}),{circleTangency:p,lineTangency:x,theta:g}=_d({cx:t,cy:r,radius:n,angle:d,sign:-u,cornerRadius:i,cornerIsExternal:l}),b=l?Math.abs(c-d):Math.abs(c-d)-h-g;if(b<0)return o?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):TA({cx:t,cy:r,innerRadius:a,outerRadius:n,startAngle:c,endAngle:d});var j="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(n,",").concat(n,",0,").concat(+(b>180),",").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(x.x,",").concat(x.y,`
  `);if(a>0){var{circleTangency:y,lineTangency:w,theta:S}=_d({cx:t,cy:r,radius:a,angle:c,sign:u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:N,lineTangency:E,theta:P}=_d({cx:t,cy:r,radius:a,angle:d,sign:-u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),T=l?Math.abs(c-d):Math.abs(c-d)-S-P;if(T<0&&i===0)return"".concat(j,"L").concat(t,",").concat(r,"Z");j+="L".concat(E.x,",").concat(E.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(T>180),",").concat(+(u>0),",").concat(y.x,",").concat(y.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(w.x,",").concat(w.y,"Z")}else j+="L".concat(t,",").concat(r,"Z");return j},IY={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},CA=e=>{var t=qs(e,IY),{cx:r,cy:a,innerRadius:n,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:m}=t;if(i<n||d===u)return null;var f=Mt("recharts-sector",m),h=i-n,p=Fs(o,h,0,!0),x;return p>0&&Math.abs(d-u)<360?x=DY({cx:r,cy:a,innerRadius:n,outerRadius:i,cornerRadius:Math.min(p,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):x=TA({cx:r,cy:a,innerRadius:n,outerRadius:i,startAngle:d,endAngle:u}),v.createElement("path",mx({},ts(t,!0),{className:f,d:x}))};function OY(e,t,r){var a,n,i,o;if(e==="horizontal")a=t.x,i=a,n=r.top,o=r.top+r.height;else if(e==="vertical")n=t.y,o=n,a=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:c,innerRadius:d,outerRadius:u,angle:m}=t,f=qr(l,c,d,m),h=qr(l,c,u,m);a=f.x,n=f.y,i=h.x,o=h.y}else return EA(t);return[{x:a,y:n},{x:i,y:o}]}var vh={},yh={},bh={},pw;function PY(){return pw||(pw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OC();function r(a){return t.isSymbol(a)?NaN:Number(a)}e.toNumber=r})(bh)),bh}var xw;function RY(){return xw||(xw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PY();function r(a){return a?(a=t.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=r})(yh)),yh}var gw;function FY(){return gw||(gw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PC(),r=RY();function a(n,i,o){o&&typeof o!="number"&&t.isIterateeCall(n,i,o)&&(i=o=void 0),n=r.toFinite(n),i===void 0?(i=n,n=0):i=r.toFinite(i),o=o===void 0?n<i?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((i-n)/(o||1)),0),c=new Array(l);for(let d=0;d<l;d++)c[d]=n,n+=o;return c}e.range=a})(vh)),vh}var jh,vw;function LY(){return vw||(vw=1,jh=FY().range),jh}var MY=LY();const AA=mi(MY);function si(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function BY(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function mv(e){let t,r,a;e.length!==2?(t=si,r=(l,c)=>si(e(l),c),a=(l,c)=>e(l)-c):(t=e===si||e===BY?e:zY,r=e,a=e);function n(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const m=d+u>>>1;r(l[m],c)<0?d=m+1:u=m}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const m=d+u>>>1;r(l[m],c)<=0?d=m+1:u=m}while(d<u)}return d}function o(l,c,d=0,u=l.length){const m=n(l,c,d,u-1);return m>d&&a(l[m-1],c)>-a(l[m],c)?m-1:m}return{left:n,center:o,right:i}}function zY(){return 0}function _A(e){return e===null?NaN:+e}function*$Y(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const UY=mv(si),Hc=UY.right;mv(_A).center;class yw extends Map{constructor(t,r=VY){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[a,n]of t)this.set(a,n)}get(t){return super.get(bw(this,t))}has(t){return super.has(bw(this,t))}set(t,r){return super.set(WY(this,t),r)}delete(t){return super.delete(HY(this,t))}}function bw({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):r}function WY({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}function HY({_intern:e,_key:t},r){const a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}function VY(e){return e!==null&&typeof e=="object"?e.valueOf():e}function GY(e=si){if(e===si)return kA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const a=e(t,r);return a||a===0?a:(e(r,r)===0)-(e(t,t)===0)}}function kA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const qY=Math.sqrt(50),KY=Math.sqrt(10),YY=Math.sqrt(2);function Au(e,t,r){const a=(t-e)/Math.max(0,r),n=Math.floor(Math.log10(a)),i=a/Math.pow(10,n),o=i>=qY?10:i>=KY?5:i>=YY?2:1;let l,c,d;return n<0?(d=Math.pow(10,-n)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,n)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?Au(e,t,r*2):[l,c,d]}function fx(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const a=t<e,[n,i,o]=a?Au(t,e,r):Au(e,t,r);if(!(i>=n))return[];const l=i-n+1,c=new Array(l);if(a)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(n+d)/-o;else for(let d=0;d<l;++d)c[d]=(n+d)*o;return c}function hx(e,t,r){return t=+t,e=+e,r=+r,Au(e,t,r)[2]}function px(e,t,r){t=+t,e=+e,r=+r;const a=t<e,n=a?hx(t,e,r):hx(e,t,r);return(a?-1:1)*(n<0?1/-n:n)}function jw(e,t){let r;for(const a of e)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);return r}function ww(e,t){let r;for(const a of e)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);return r}function DA(e,t,r=0,a=1/0,n){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(e.length-1,a)),!(r<=t&&t<=a))return e;for(n=n===void 0?kA:GY(n);a>r;){if(a-r>600){const c=a-r+1,d=t-r+1,u=Math.log(c),m=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*m*(c-m)/c)*(d-c/2<0?-1:1),h=Math.max(r,Math.floor(t-d*m/c+f)),p=Math.min(a,Math.floor(t+(c-d)*m/c+f));DA(e,t,h,p,n)}const i=e[t];let o=r,l=a;for(Cl(e,r,t),n(e[a],i)>0&&Cl(e,r,a);o<l;){for(Cl(e,o,l),++o,--l;n(e[o],i)<0;)++o;for(;n(e[l],i)>0;)--l}n(e[r],i)===0?Cl(e,r,l):(++l,Cl(e,l,a)),l<=t&&(r=l+1),t<=l&&(a=l-1)}return e}function Cl(e,t,r){const a=e[t];e[t]=e[r],e[r]=a}function XY(e,t,r){if(e=Float64Array.from($Y(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return ww(e);if(t>=1)return jw(e);var a,n=(a-1)*t,i=Math.floor(n),o=jw(DA(e,i).subarray(0,i+1)),l=ww(e.subarray(i+1));return o+(l-o)*(n-i)}}function JY(e,t,r=_A){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,n=(a-1)*t,i=Math.floor(n),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(n-i)}}function ZY(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var a=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(n);++a<n;)i[a]=e+a*r;return i}function Ua(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Un(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const xx=Symbol("implicit");function fv(){var e=new yw,t=[],r=[],a=xx;function n(i){let o=e.get(i);if(o===void 0){if(a!==xx)return a;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return n.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new yw;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return n},n.range=function(i){return arguments.length?(r=Array.from(i),n):r.slice()},n.unknown=function(i){return arguments.length?(a=i,n):a},n.copy=function(){return fv(t,r).unknown(a)},Ua.apply(n,arguments),n}function hv(){var e=fv().unknown(void 0),t=e.domain,r=e.range,a=0,n=1,i,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function m(){var f=t().length,h=n<a,p=h?n:a,x=h?a:n;i=(x-p)/Math.max(1,f-c+d*2),l&&(i=Math.floor(i)),p+=(x-p-i*(f-c))*u,o=i*(1-c),l&&(p=Math.round(p),o=Math.round(o));var g=ZY(f).map(function(b){return p+i*b});return r(h?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),m()):t()},e.range=function(f){return arguments.length?([a,n]=f,a=+a,n=+n,m()):[a,n]},e.rangeRound=function(f){return[a,n]=f,a=+a,n=+n,l=!0,m()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(l=!!f,m()):l},e.padding=function(f){return arguments.length?(c=Math.min(1,d=+f),m()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),m()):c},e.paddingOuter=function(f){return arguments.length?(d=+f,m()):d},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),m()):u},e.copy=function(){return hv(t(),[a,n]).round(l).paddingInner(c).paddingOuter(d).align(u)},Ua.apply(m(),arguments)}function IA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return IA(t())},e}function QY(){return IA(hv.apply(null,arguments).paddingInner(1))}function pv(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function OA(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function Vc(){}var vc=.7,_u=1/vc,Ro="\\s*([+-]?\\d+)\\s*",yc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eX=/^#([0-9a-f]{3,8})$/,tX=new RegExp(`^rgb\\(${Ro},${Ro},${Ro}\\)$`),rX=new RegExp(`^rgb\\(${dn},${dn},${dn}\\)$`),sX=new RegExp(`^rgba\\(${Ro},${Ro},${Ro},${yc}\\)$`),aX=new RegExp(`^rgba\\(${dn},${dn},${dn},${yc}\\)$`),nX=new RegExp(`^hsl\\(${yc},${dn},${dn}\\)$`),iX=new RegExp(`^hsla\\(${yc},${dn},${dn},${yc}\\)$`),Nw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pv(Vc,bc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Sw,formatHex:Sw,formatHex8:oX,formatHsl:lX,formatRgb:Ew,toString:Ew});function Sw(){return this.rgb().formatHex()}function oX(){return this.rgb().formatHex8()}function lX(){return PA(this).formatHsl()}function Ew(){return this.rgb().formatRgb()}function bc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=eX.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Tw(t):r===3?new Zs(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?kd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?kd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=tX.exec(e))?new Zs(t[1],t[2],t[3],1):(t=rX.exec(e))?new Zs(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=sX.exec(e))?kd(t[1],t[2],t[3],t[4]):(t=aX.exec(e))?kd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=nX.exec(e))?_w(t[1],t[2]/100,t[3]/100,1):(t=iX.exec(e))?_w(t[1],t[2]/100,t[3]/100,t[4]):Nw.hasOwnProperty(e)?Tw(Nw[e]):e==="transparent"?new Zs(NaN,NaN,NaN,0):null}function Tw(e){return new Zs(e>>16&255,e>>8&255,e&255,1)}function kd(e,t,r,a){return a<=0&&(e=t=r=NaN),new Zs(e,t,r,a)}function cX(e){return e instanceof Vc||(e=bc(e)),e?(e=e.rgb(),new Zs(e.r,e.g,e.b,e.opacity)):new Zs}function gx(e,t,r,a){return arguments.length===1?cX(e):new Zs(e,t,r,a??1)}function Zs(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}pv(Zs,gx,OA(Vc,{brighter(e){return e=e==null?_u:Math.pow(_u,e),new Zs(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?vc:Math.pow(vc,e),new Zs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Zs(Wi(this.r),Wi(this.g),Wi(this.b),ku(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Cw,formatHex:Cw,formatHex8:dX,formatRgb:Aw,toString:Aw}));function Cw(){return`#${Oi(this.r)}${Oi(this.g)}${Oi(this.b)}`}function dX(){return`#${Oi(this.r)}${Oi(this.g)}${Oi(this.b)}${Oi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Aw(){const e=ku(this.opacity);return`${e===1?"rgb(":"rgba("}${Wi(this.r)}, ${Wi(this.g)}, ${Wi(this.b)}${e===1?")":`, ${e})`}`}function ku(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Wi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Oi(e){return e=Wi(e),(e<16?"0":"")+e.toString(16)}function _w(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ga(e,t,r,a)}function PA(e){if(e instanceof Ga)return new Ga(e.h,e.s,e.l,e.opacity);if(e instanceof Vc||(e=bc(e)),!e)return new Ga;if(e instanceof Ga)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,n=Math.min(t,r,a),i=Math.max(t,r,a),o=NaN,l=i-n,c=(i+n)/2;return l?(t===i?o=(r-a)/l+(r<a)*6:r===i?o=(a-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+n:2-i-n,o*=60):l=c>0&&c<1?0:o,new Ga(o,l,c,e.opacity)}function uX(e,t,r,a){return arguments.length===1?PA(e):new Ga(e,t,r,a??1)}function Ga(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}pv(Ga,uX,OA(Vc,{brighter(e){return e=e==null?_u:Math.pow(_u,e),new Ga(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?vc:Math.pow(vc,e),new Ga(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,n=2*r-a;return new Zs(wh(e>=240?e-240:e+120,n,a),wh(e,n,a),wh(e<120?e+240:e-120,n,a),this.opacity)},clamp(){return new Ga(kw(this.h),Dd(this.s),Dd(this.l),ku(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ku(this.opacity);return`${e===1?"hsl(":"hsla("}${kw(this.h)}, ${Dd(this.s)*100}%, ${Dd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function kw(e){return e=(e||0)%360,e<0?e+360:e}function Dd(e){return Math.max(0,Math.min(1,e||0))}function wh(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const xv=e=>()=>e;function mX(e,t){return function(r){return e+r*t}}function fX(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function hX(e){return(e=+e)==1?RA:function(t,r){return r-t?fX(t,r,e):xv(isNaN(t)?r:t)}}function RA(e,t){var r=t-e;return r?mX(e,r):xv(isNaN(e)?t:e)}const Dw=(function e(t){var r=hX(t);function a(n,i){var o=r((n=gx(n)).r,(i=gx(i)).r),l=r(n.g,i.g),c=r(n.b,i.b),d=RA(n.opacity,i.opacity);return function(u){return n.r=o(u),n.g=l(u),n.b=c(u),n.opacity=d(u),n+""}}return a.gamma=e,a})(1);function pX(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,a=t.slice(),n;return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function xX(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function gX(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,n=new Array(a),i=new Array(r),o;for(o=0;o<a;++o)n[o]=ll(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<a;++o)i[o]=n[o](l);return i}}function vX(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function Du(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function yX(e,t){var r={},a={},n;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in e?r[n]=ll(e[n],t[n]):a[n]=t[n];return function(i){for(n in r)a[n]=r[n](i);return a}}var vx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Nh=new RegExp(vx.source,"g");function bX(e){return function(){return e}}function jX(e){return function(t){return e(t)+""}}function wX(e,t){var r=vx.lastIndex=Nh.lastIndex=0,a,n,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(a=vx.exec(e))&&(n=Nh.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(a=a[0])===(n=n[0])?l[o]?l[o]+=n:l[++o]=n:(l[++o]=null,c.push({i:o,x:Du(a,n)})),r=Nh.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?jX(c[0].x):bX(t):(t=c.length,function(d){for(var u=0,m;u<t;++u)l[(m=c[u]).i]=m.x(d);return l.join("")})}function ll(e,t){var r=typeof t,a;return t==null||r==="boolean"?xv(t):(r==="number"?Du:r==="string"?(a=bc(t))?(t=a,Dw):wX:t instanceof bc?Dw:t instanceof Date?vX:xX(t)?pX:Array.isArray(t)?gX:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?yX:Du)(e,t)}function gv(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function NX(e,t){t===void 0&&(t=e,e=ll);for(var r=0,a=t.length-1,n=t[0],i=new Array(a<0?0:a);r<a;)i[r]=e(n,n=t[++r]);return function(o){var l=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return i[l](o-l)}}function SX(e){return function(){return e}}function Iu(e){return+e}var Iw=[0,1];function Hs(e){return e}function yx(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:SX(isNaN(t)?NaN:.5)}function EX(e,t){var r;return e>t&&(r=e,e=t,t=r),function(a){return Math.max(e,Math.min(t,a))}}function TX(e,t,r){var a=e[0],n=e[1],i=t[0],o=t[1];return n<a?(a=yx(n,a),i=r(o,i)):(a=yx(a,n),i=r(i,o)),function(l){return i(a(l))}}function CX(e,t,r){var a=Math.min(e.length,t.length)-1,n=new Array(a),i=new Array(a),o=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<a;)n[o]=yx(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=Hc(e,l,1,a)-1;return i[c](n[c](l))}}function Gc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Dm(){var e=Iw,t=Iw,r=ll,a,n,i,o=Hs,l,c,d;function u(){var f=Math.min(e.length,t.length);return o!==Hs&&(o=EX(e[0],e[f-1])),l=f>2?CX:TX,c=d=null,m}function m(f){return f==null||isNaN(f=+f)?i:(c||(c=l(e.map(a),t,r)))(a(o(f)))}return m.invert=function(f){return o(n((d||(d=l(t,e.map(a),Du)))(f)))},m.domain=function(f){return arguments.length?(e=Array.from(f,Iu),u()):e.slice()},m.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},m.rangeRound=function(f){return t=Array.from(f),r=gv,u()},m.clamp=function(f){return arguments.length?(o=f?!0:Hs,u()):o!==Hs},m.interpolate=function(f){return arguments.length?(r=f,u()):r},m.unknown=function(f){return arguments.length?(i=f,m):i},function(f,h){return a=f,n=h,u()}}function vv(){return Dm()(Hs,Hs)}function AX(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ou(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function qo(e){return e=Ou(Math.abs(e)),e?e[1]:NaN}function _X(e,t){return function(r,a){for(var n=r.length,i=[],o=0,l=e[0],c=0;n>0&&l>0&&(c+l+1>a&&(l=Math.max(1,a-c)),i.push(r.substring(n-=l,n+l)),!((c+=l+1)>a));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function kX(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var DX=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jc(e){if(!(t=DX.exec(e)))throw new Error("invalid format: "+e);var t;return new yv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}jc.prototype=yv.prototype;function yv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}yv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function IX(e){e:for(var t=e.length,r=1,a=-1,n;r<t;++r)switch(e[r]){case".":a=n=r;break;case"0":a===0&&(a=r),n=r;break;default:if(!+e[r])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(n+1):e}var FA;function OX(e,t){var r=Ou(e,t);if(!r)return e+"";var a=r[0],n=r[1],i=n-(FA=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,o=a.length;return i===o?a:i>o?a+new Array(i-o+1).join("0"):i>0?a.slice(0,i)+"."+a.slice(i):"0."+new Array(1-i).join("0")+Ou(e,Math.max(0,t+i-1))[0]}function Ow(e,t){var r=Ou(e,t);if(!r)return e+"";var a=r[0],n=r[1];return n<0?"0."+new Array(-n).join("0")+a:a.length>n+1?a.slice(0,n+1)+"."+a.slice(n+1):a+new Array(n-a.length+2).join("0")}const Pw={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:AX,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Ow(e*100,t),r:Ow,s:OX,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Rw(e){return e}var Fw=Array.prototype.map,Lw=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function PX(e){var t=e.grouping===void 0||e.thousands===void 0?Rw:_X(Fw.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",n=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Rw:kX(Fw.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(m){m=jc(m);var f=m.fill,h=m.align,p=m.sign,x=m.symbol,g=m.zero,b=m.width,j=m.comma,y=m.precision,w=m.trim,S=m.type;S==="n"?(j=!0,S="g"):Pw[S]||(y===void 0&&(y=12),w=!0,S="g"),(g||f==="0"&&h==="=")&&(g=!0,f="0",h="=");var N=x==="$"?r:x==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",E=x==="$"?a:/[%p]/.test(S)?o:"",P=Pw[S],T=/[defgprs%]/.test(S);y=y===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function O(_){var C=N,R=E,M,U,Z;if(S==="c")R=P(_)+R,_="";else{_=+_;var ee=_<0||1/_<0;if(_=isNaN(_)?c:P(Math.abs(_),y),w&&(_=IX(_)),ee&&+_==0&&p!=="+"&&(ee=!1),C=(ee?p==="("?p:l:p==="-"||p==="("?"":p)+C,R=(S==="s"?Lw[8+FA/3]:"")+R+(ee&&p==="("?")":""),T){for(M=-1,U=_.length;++M<U;)if(Z=_.charCodeAt(M),48>Z||Z>57){R=(Z===46?n+_.slice(M+1):_.slice(M))+R,_=_.slice(0,M);break}}}j&&!g&&(_=t(_,1/0));var re=C.length+_.length+R.length,z=re<b?new Array(b-re+1).join(f):"";switch(j&&g&&(_=t(z+_,z.length?b-R.length:1/0),z=""),h){case"<":_=C+_+R+z;break;case"=":_=C+z+_+R;break;case"^":_=z.slice(0,re=z.length>>1)+C+_+R+z.slice(re);break;default:_=z+C+_+R;break}return i(_)}return O.toString=function(){return m+""},O}function u(m,f){var h=d((m=jc(m),m.type="f",m)),p=Math.max(-8,Math.min(8,Math.floor(qo(f)/3)))*3,x=Math.pow(10,-p),g=Lw[8+p/3];return function(b){return h(x*b)+g}}return{format:d,formatPrefix:u}}var Id,bv,LA;RX({thousands:",",grouping:[3],currency:["$",""]});function RX(e){return Id=PX(e),bv=Id.format,LA=Id.formatPrefix,Id}function FX(e){return Math.max(0,-qo(Math.abs(e)))}function LX(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qo(t)/3)))*3-qo(Math.abs(e)))}function MX(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,qo(t)-qo(e))+1}function MA(e,t,r,a){var n=px(e,t,r),i;switch(a=jc(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(i=LX(n,o))&&(a.precision=i),LA(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(i=MX(n,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=i-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(i=FX(n))&&(a.precision=i-(a.type==="%")*2);break}}return bv(a)}function vi(e){var t=e.domain;return e.ticks=function(r){var a=t();return fx(a[0],a[a.length-1],r??10)},e.tickFormat=function(r,a){var n=t();return MA(n[0],n[n.length-1],r??10,a)},e.nice=function(r){r==null&&(r=10);var a=t(),n=0,i=a.length-1,o=a[n],l=a[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=n,n=i,i=d);u-- >0;){if(d=hx(o,l,r),d===c)return a[n]=o,a[i]=l,t(a);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function BA(){var e=vv();return e.copy=function(){return Gc(e,BA())},Ua.apply(e,arguments),vi(e)}function zA(e){var t;function r(a){return a==null||isNaN(a=+a)?t:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,Iu),r):e.slice()},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return zA(e).unknown(t)},e=arguments.length?Array.from(e,Iu):[0,1],vi(r)}function $A(e,t){e=e.slice();var r=0,a=e.length-1,n=e[r],i=e[a],o;return i<n&&(o=r,r=a,a=o,o=n,n=i,i=o),e[r]=t.floor(n),e[a]=t.ceil(i),e}function Mw(e){return Math.log(e)}function Bw(e){return Math.exp(e)}function BX(e){return-Math.log(-e)}function zX(e){return-Math.exp(-e)}function $X(e){return isFinite(e)?+("1e"+e):e<0?0:e}function UX(e){return e===10?$X:e===Math.E?Math.exp:t=>Math.pow(e,t)}function WX(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function zw(e){return(t,r)=>-e(-t,r)}function jv(e){const t=e(Mw,Bw),r=t.domain;let a=10,n,i;function o(){return n=WX(a),i=UX(a),r()[0]<0?(n=zw(n),i=zw(i),e(BX,zX)):e(Mw,Bw),t}return t.base=function(l){return arguments.length?(a=+l,o()):a},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const m=u<d;m&&([d,u]=[u,d]);let f=n(d),h=n(u),p,x;const g=l==null?10:+l;let b=[];if(!(a%1)&&h-f<g){if(f=Math.floor(f),h=Math.ceil(h),d>0){for(;f<=h;++f)for(p=1;p<a;++p)if(x=f<0?p/i(-f):p*i(f),!(x<d)){if(x>u)break;b.push(x)}}else for(;f<=h;++f)for(p=a-1;p>=1;--p)if(x=f>0?p/i(-f):p*i(f),!(x<d)){if(x>u)break;b.push(x)}b.length*2<g&&(b=fx(d,u,g))}else b=fx(f,h,Math.min(h-f,g)).map(i);return m?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=a===10?"s":","),typeof c!="function"&&(!(a%1)&&(c=jc(c)).precision==null&&(c.trim=!0),c=bv(c)),l===1/0)return c;const d=Math.max(1,a*l/t.ticks().length);return u=>{let m=u/i(Math.round(n(u)));return m*a<a-.5&&(m*=a),m<=d?c(u):""}},t.nice=()=>r($A(r(),{floor:l=>i(Math.floor(n(l))),ceil:l=>i(Math.ceil(n(l)))})),t}function UA(){const e=jv(Dm()).domain([1,10]);return e.copy=()=>Gc(e,UA()).base(e.base()),Ua.apply(e,arguments),e}function $w(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Uw(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function wv(e){var t=1,r=e($w(t),Uw(t));return r.constant=function(a){return arguments.length?e($w(t=+a),Uw(t)):t},vi(r)}function WA(){var e=wv(Dm());return e.copy=function(){return Gc(e,WA()).constant(e.constant())},Ua.apply(e,arguments)}function Ww(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function HX(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function VX(e){return e<0?-e*e:e*e}function Nv(e){var t=e(Hs,Hs),r=1;function a(){return r===1?e(Hs,Hs):r===.5?e(HX,VX):e(Ww(r),Ww(1/r))}return t.exponent=function(n){return arguments.length?(r=+n,a()):r},vi(t)}function Sv(){var e=Nv(Dm());return e.copy=function(){return Gc(e,Sv()).exponent(e.exponent())},Ua.apply(e,arguments),e}function GX(){return Sv.apply(null,arguments).exponent(.5)}function Hw(e){return Math.sign(e)*e*e}function qX(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function HA(){var e=vv(),t=[0,1],r=!1,a;function n(i){var o=qX(e(i));return isNaN(o)?a:r?Math.round(o):o}return n.invert=function(i){return e.invert(Hw(i))},n.domain=function(i){return arguments.length?(e.domain(i),n):e.domain()},n.range=function(i){return arguments.length?(e.range((t=Array.from(i,Iu)).map(Hw)),n):t.slice()},n.rangeRound=function(i){return n.range(i).round(!0)},n.round=function(i){return arguments.length?(r=!!i,n):r},n.clamp=function(i){return arguments.length?(e.clamp(i),n):e.clamp()},n.unknown=function(i){return arguments.length?(a=i,n):a},n.copy=function(){return HA(e.domain(),t).round(r).clamp(e.clamp()).unknown(a)},Ua.apply(n,arguments),vi(n)}function VA(){var e=[],t=[],r=[],a;function n(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=JY(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?a:t[Hc(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(si),n()},i.range=function(o){return arguments.length?(t=Array.from(o),n()):t.slice()},i.unknown=function(o){return arguments.length?(a=o,i):a},i.quantiles=function(){return r.slice()},i.copy=function(){return VA().domain(e).range(t).unknown(a)},Ua.apply(i,arguments)}function GA(){var e=0,t=1,r=1,a=[.5],n=[0,1],i;function o(c){return c!=null&&c<=c?n[Hc(a,c,0,r)]:i}function l(){var c=-1;for(a=new Array(r);++c<r;)a[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(n=Array.from(c)).length-1,l()):n.slice()},o.invertExtent=function(c){var d=n.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,a[0]]:d>=r?[a[r-1],t]:[a[d-1],a[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return a.slice()},o.copy=function(){return GA().domain([e,t]).range(n).unknown(i)},Ua.apply(vi(o),arguments)}function qA(){var e=[.5],t=[0,1],r,a=1;function n(i){return i!=null&&i<=i?t[Hc(e,i,0,a)]:r}return n.domain=function(i){return arguments.length?(e=Array.from(i),a=Math.min(e.length,t.length-1),n):e.slice()},n.range=function(i){return arguments.length?(t=Array.from(i),a=Math.min(e.length,t.length-1),n):t.slice()},n.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return qA().domain(e).range(t).unknown(r)},Ua.apply(n,arguments)}const Sh=new Date,Eh=new Date;function as(e,t,r,a){function n(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return n.floor=i=>(e(i=new Date(+i)),i),n.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),n.round=i=>{const o=n(i),l=n.ceil(i);return i-o<l-i?o:l},n.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),n.range=(i,o,l)=>{const c=[];if(i=n.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},n.filter=i=>as(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(n.count=(i,o)=>(Sh.setTime(+i),Eh.setTime(+o),e(Sh),e(Eh),Math.floor(r(Sh,Eh))),n.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?n.filter(a?o=>a(o)%i===0:o=>n.count(0,o)%i===0):n)),n}const Pu=as(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Pu.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?as(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Pu);Pu.range;const wn=1e3,Pa=wn*60,Nn=Pa*60,On=Nn*24,Ev=On*7,Vw=On*30,Th=On*365,Pi=as(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*wn)},(e,t)=>(t-e)/wn,e=>e.getUTCSeconds());Pi.range;const Tv=as(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*wn)},(e,t)=>{e.setTime(+e+t*Pa)},(e,t)=>(t-e)/Pa,e=>e.getMinutes());Tv.range;const Cv=as(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Pa)},(e,t)=>(t-e)/Pa,e=>e.getUTCMinutes());Cv.range;const Av=as(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*wn-e.getMinutes()*Pa)},(e,t)=>{e.setTime(+e+t*Nn)},(e,t)=>(t-e)/Nn,e=>e.getHours());Av.range;const _v=as(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Nn)},(e,t)=>(t-e)/Nn,e=>e.getUTCHours());_v.range;const qc=as(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Pa)/On,e=>e.getDate()-1);qc.range;const Im=as(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/On,e=>e.getUTCDate()-1);Im.range;const KA=as(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/On,e=>Math.floor(e/On));KA.range;function go(e){return as(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Pa)/Ev)}const Om=go(0),Ru=go(1),KX=go(2),YX=go(3),Ko=go(4),XX=go(5),JX=go(6);Om.range;Ru.range;KX.range;YX.range;Ko.range;XX.range;JX.range;function vo(e){return as(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Ev)}const Pm=vo(0),Fu=vo(1),ZX=vo(2),QX=vo(3),Yo=vo(4),eJ=vo(5),tJ=vo(6);Pm.range;Fu.range;ZX.range;QX.range;Yo.range;eJ.range;tJ.range;const kv=as(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());kv.range;const Dv=as(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Dv.range;const Pn=as(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Pn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:as(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Pn.range;const Rn=as(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Rn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:as(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Rn.range;function YA(e,t,r,a,n,i){const o=[[Pi,1,wn],[Pi,5,5*wn],[Pi,15,15*wn],[Pi,30,30*wn],[i,1,Pa],[i,5,5*Pa],[i,15,15*Pa],[i,30,30*Pa],[n,1,Nn],[n,3,3*Nn],[n,6,6*Nn],[n,12,12*Nn],[a,1,On],[a,2,2*On],[r,1,Ev],[t,1,Vw],[t,3,3*Vw],[e,1,Th]];function l(d,u,m){const f=u<d;f&&([d,u]=[u,d]);const h=m&&typeof m.range=="function"?m:c(d,u,m),p=h?h.range(d,+u+1):[];return f?p.reverse():p}function c(d,u,m){const f=Math.abs(u-d)/m,h=mv(([,,g])=>g).right(o,f);if(h===o.length)return e.every(px(d/Th,u/Th,m));if(h===0)return Pu.every(Math.max(px(d,u,m),1));const[p,x]=o[f/o[h-1][2]<o[h][2]/f?h-1:h];return p.every(x)}return[l,c]}const[rJ,sJ]=YA(Rn,Dv,Pm,KA,_v,Cv),[aJ,nJ]=YA(Pn,kv,Om,qc,Av,Tv);function Ch(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ah(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Al(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function iJ(e){var t=e.dateTime,r=e.date,a=e.time,n=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=_l(n),u=kl(n),m=_l(i),f=kl(i),h=_l(o),p=kl(o),x=_l(l),g=kl(l),b=_l(c),j=kl(c),y={a:ee,A:re,b:z,B:me,c:null,d:Jw,e:Jw,f:_J,g:BJ,G:$J,H:TJ,I:CJ,j:AJ,L:XA,m:kJ,M:DJ,p:ne,q:A,Q:eN,s:tN,S:IJ,u:OJ,U:PJ,V:RJ,w:FJ,W:LJ,x:null,X:null,y:MJ,Y:zJ,Z:UJ,"%":Qw},w={a:D,A:I,b:V,B:ie,c:null,d:Zw,e:Zw,f:GJ,g:rZ,G:aZ,H:WJ,I:HJ,j:VJ,L:ZA,m:qJ,M:KJ,p:se,q:ae,Q:eN,s:tN,S:YJ,u:XJ,U:JJ,V:ZJ,w:QJ,W:eZ,x:null,X:null,y:tZ,Y:sZ,Z:nZ,"%":Qw},S={a:O,A:_,b:C,B:R,c:M,d:Yw,e:Yw,f:wJ,g:Kw,G:qw,H:Xw,I:Xw,j:vJ,L:jJ,m:gJ,M:yJ,p:T,q:xJ,Q:SJ,s:EJ,S:bJ,u:uJ,U:mJ,V:fJ,w:dJ,W:hJ,x:U,X:Z,y:Kw,Y:qw,Z:pJ,"%":NJ};y.x=N(r,y),y.X=N(a,y),y.c=N(t,y),w.x=N(r,w),w.X=N(a,w),w.c=N(t,w);function N(K,G){return function(ue){var L=[],Ne=-1,Oe=0,We=K.length,Qe,Pe,rt;for(ue instanceof Date||(ue=new Date(+ue));++Ne<We;)K.charCodeAt(Ne)===37&&(L.push(K.slice(Oe,Ne)),(Pe=Gw[Qe=K.charAt(++Ne)])!=null?Qe=K.charAt(++Ne):Pe=Qe==="e"?" ":"0",(rt=G[Qe])&&(Qe=rt(ue,Pe)),L.push(Qe),Oe=Ne+1);return L.push(K.slice(Oe,Ne)),L.join("")}}function E(K,G){return function(ue){var L=Al(1900,void 0,1),Ne=P(L,K,ue+="",0),Oe,We;if(Ne!=ue.length)return null;if("Q"in L)return new Date(L.Q);if("s"in L)return new Date(L.s*1e3+("L"in L?L.L:0));if(G&&!("Z"in L)&&(L.Z=0),"p"in L&&(L.H=L.H%12+L.p*12),L.m===void 0&&(L.m="q"in L?L.q:0),"V"in L){if(L.V<1||L.V>53)return null;"w"in L||(L.w=1),"Z"in L?(Oe=Ah(Al(L.y,0,1)),We=Oe.getUTCDay(),Oe=We>4||We===0?Fu.ceil(Oe):Fu(Oe),Oe=Im.offset(Oe,(L.V-1)*7),L.y=Oe.getUTCFullYear(),L.m=Oe.getUTCMonth(),L.d=Oe.getUTCDate()+(L.w+6)%7):(Oe=Ch(Al(L.y,0,1)),We=Oe.getDay(),Oe=We>4||We===0?Ru.ceil(Oe):Ru(Oe),Oe=qc.offset(Oe,(L.V-1)*7),L.y=Oe.getFullYear(),L.m=Oe.getMonth(),L.d=Oe.getDate()+(L.w+6)%7)}else("W"in L||"U"in L)&&("w"in L||(L.w="u"in L?L.u%7:"W"in L?1:0),We="Z"in L?Ah(Al(L.y,0,1)).getUTCDay():Ch(Al(L.y,0,1)).getDay(),L.m=0,L.d="W"in L?(L.w+6)%7+L.W*7-(We+5)%7:L.w+L.U*7-(We+6)%7);return"Z"in L?(L.H+=L.Z/100|0,L.M+=L.Z%100,Ah(L)):Ch(L)}}function P(K,G,ue,L){for(var Ne=0,Oe=G.length,We=ue.length,Qe,Pe;Ne<Oe;){if(L>=We)return-1;if(Qe=G.charCodeAt(Ne++),Qe===37){if(Qe=G.charAt(Ne++),Pe=S[Qe in Gw?G.charAt(Ne++):Qe],!Pe||(L=Pe(K,ue,L))<0)return-1}else if(Qe!=ue.charCodeAt(L++))return-1}return L}function T(K,G,ue){var L=d.exec(G.slice(ue));return L?(K.p=u.get(L[0].toLowerCase()),ue+L[0].length):-1}function O(K,G,ue){var L=h.exec(G.slice(ue));return L?(K.w=p.get(L[0].toLowerCase()),ue+L[0].length):-1}function _(K,G,ue){var L=m.exec(G.slice(ue));return L?(K.w=f.get(L[0].toLowerCase()),ue+L[0].length):-1}function C(K,G,ue){var L=b.exec(G.slice(ue));return L?(K.m=j.get(L[0].toLowerCase()),ue+L[0].length):-1}function R(K,G,ue){var L=x.exec(G.slice(ue));return L?(K.m=g.get(L[0].toLowerCase()),ue+L[0].length):-1}function M(K,G,ue){return P(K,t,G,ue)}function U(K,G,ue){return P(K,r,G,ue)}function Z(K,G,ue){return P(K,a,G,ue)}function ee(K){return o[K.getDay()]}function re(K){return i[K.getDay()]}function z(K){return c[K.getMonth()]}function me(K){return l[K.getMonth()]}function ne(K){return n[+(K.getHours()>=12)]}function A(K){return 1+~~(K.getMonth()/3)}function D(K){return o[K.getUTCDay()]}function I(K){return i[K.getUTCDay()]}function V(K){return c[K.getUTCMonth()]}function ie(K){return l[K.getUTCMonth()]}function se(K){return n[+(K.getUTCHours()>=12)]}function ae(K){return 1+~~(K.getUTCMonth()/3)}return{format:function(K){var G=N(K+="",y);return G.toString=function(){return K},G},parse:function(K){var G=E(K+="",!1);return G.toString=function(){return K},G},utcFormat:function(K){var G=N(K+="",w);return G.toString=function(){return K},G},utcParse:function(K){var G=E(K+="",!0);return G.toString=function(){return K},G}}}var Gw={"-":"",_:" ",0:"0"},fs=/^\s*\d+/,oJ=/^%/,lJ=/[\\^$*+?|[\]().{}]/g;function qt(e,t,r){var a=e<0?"-":"",n=(a?-e:e)+"",i=n.length;return a+(i<r?new Array(r-i+1).join(t)+n:n)}function cJ(e){return e.replace(lJ,"\\$&")}function _l(e){return new RegExp("^(?:"+e.map(cJ).join("|")+")","i")}function kl(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function dJ(e,t,r){var a=fs.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function uJ(e,t,r){var a=fs.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function mJ(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function fJ(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function hJ(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function qw(e,t,r){var a=fs.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function Kw(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function pJ(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function xJ(e,t,r){var a=fs.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function gJ(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function Yw(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function vJ(e,t,r){var a=fs.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function Xw(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function yJ(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function bJ(e,t,r){var a=fs.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function jJ(e,t,r){var a=fs.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function wJ(e,t,r){var a=fs.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function NJ(e,t,r){var a=oJ.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function SJ(e,t,r){var a=fs.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function EJ(e,t,r){var a=fs.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function Jw(e,t){return qt(e.getDate(),t,2)}function TJ(e,t){return qt(e.getHours(),t,2)}function CJ(e,t){return qt(e.getHours()%12||12,t,2)}function AJ(e,t){return qt(1+qc.count(Pn(e),e),t,3)}function XA(e,t){return qt(e.getMilliseconds(),t,3)}function _J(e,t){return XA(e,t)+"000"}function kJ(e,t){return qt(e.getMonth()+1,t,2)}function DJ(e,t){return qt(e.getMinutes(),t,2)}function IJ(e,t){return qt(e.getSeconds(),t,2)}function OJ(e){var t=e.getDay();return t===0?7:t}function PJ(e,t){return qt(Om.count(Pn(e)-1,e),t,2)}function JA(e){var t=e.getDay();return t>=4||t===0?Ko(e):Ko.ceil(e)}function RJ(e,t){return e=JA(e),qt(Ko.count(Pn(e),e)+(Pn(e).getDay()===4),t,2)}function FJ(e){return e.getDay()}function LJ(e,t){return qt(Ru.count(Pn(e)-1,e),t,2)}function MJ(e,t){return qt(e.getFullYear()%100,t,2)}function BJ(e,t){return e=JA(e),qt(e.getFullYear()%100,t,2)}function zJ(e,t){return qt(e.getFullYear()%1e4,t,4)}function $J(e,t){var r=e.getDay();return e=r>=4||r===0?Ko(e):Ko.ceil(e),qt(e.getFullYear()%1e4,t,4)}function UJ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+qt(t/60|0,"0",2)+qt(t%60,"0",2)}function Zw(e,t){return qt(e.getUTCDate(),t,2)}function WJ(e,t){return qt(e.getUTCHours(),t,2)}function HJ(e,t){return qt(e.getUTCHours()%12||12,t,2)}function VJ(e,t){return qt(1+Im.count(Rn(e),e),t,3)}function ZA(e,t){return qt(e.getUTCMilliseconds(),t,3)}function GJ(e,t){return ZA(e,t)+"000"}function qJ(e,t){return qt(e.getUTCMonth()+1,t,2)}function KJ(e,t){return qt(e.getUTCMinutes(),t,2)}function YJ(e,t){return qt(e.getUTCSeconds(),t,2)}function XJ(e){var t=e.getUTCDay();return t===0?7:t}function JJ(e,t){return qt(Pm.count(Rn(e)-1,e),t,2)}function QA(e){var t=e.getUTCDay();return t>=4||t===0?Yo(e):Yo.ceil(e)}function ZJ(e,t){return e=QA(e),qt(Yo.count(Rn(e),e)+(Rn(e).getUTCDay()===4),t,2)}function QJ(e){return e.getUTCDay()}function eZ(e,t){return qt(Fu.count(Rn(e)-1,e),t,2)}function tZ(e,t){return qt(e.getUTCFullYear()%100,t,2)}function rZ(e,t){return e=QA(e),qt(e.getUTCFullYear()%100,t,2)}function sZ(e,t){return qt(e.getUTCFullYear()%1e4,t,4)}function aZ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Yo(e):Yo.ceil(e),qt(e.getUTCFullYear()%1e4,t,4)}function nZ(){return"+0000"}function Qw(){return"%"}function eN(e){return+e}function tN(e){return Math.floor(+e/1e3)}var Eo,e_,t_;iZ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iZ(e){return Eo=iJ(e),e_=Eo.format,Eo.parse,t_=Eo.utcFormat,Eo.utcParse,Eo}function oZ(e){return new Date(e)}function lZ(e){return e instanceof Date?+e:+new Date(+e)}function Iv(e,t,r,a,n,i,o,l,c,d){var u=vv(),m=u.invert,f=u.domain,h=d(".%L"),p=d(":%S"),x=d("%I:%M"),g=d("%I %p"),b=d("%a %d"),j=d("%b %d"),y=d("%B"),w=d("%Y");function S(N){return(c(N)<N?h:l(N)<N?p:o(N)<N?x:i(N)<N?g:a(N)<N?n(N)<N?b:j:r(N)<N?y:w)(N)}return u.invert=function(N){return new Date(m(N))},u.domain=function(N){return arguments.length?f(Array.from(N,lZ)):f().map(oZ)},u.ticks=function(N){var E=f();return e(E[0],E[E.length-1],N??10)},u.tickFormat=function(N,E){return E==null?S:d(E)},u.nice=function(N){var E=f();return(!N||typeof N.range!="function")&&(N=t(E[0],E[E.length-1],N??10)),N?f($A(E,N)):u},u.copy=function(){return Gc(u,Iv(e,t,r,a,n,i,o,l,c,d))},u}function cZ(){return Ua.apply(Iv(aJ,nJ,Pn,kv,Om,qc,Av,Tv,Pi,e_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function dZ(){return Ua.apply(Iv(rJ,sJ,Rn,Dv,Pm,Im,_v,Cv,Pi,t_).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Rm(){var e=0,t=1,r,a,n,i,o=Hs,l=!1,c;function d(m){return m==null||isNaN(m=+m)?c:o(n===0?.5:(m=(i(m)-r)*n,l?Math.max(0,Math.min(1,m)):m))}d.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),a=i(t=+t),n=r===a?0:1/(a-r),d):[e,t]},d.clamp=function(m){return arguments.length?(l=!!m,d):l},d.interpolator=function(m){return arguments.length?(o=m,d):o};function u(m){return function(f){var h,p;return arguments.length?([h,p]=f,o=m(h,p),d):[o(0),o(1)]}}return d.range=u(ll),d.rangeRound=u(gv),d.unknown=function(m){return arguments.length?(c=m,d):c},function(m){return i=m,r=m(e),a=m(t),n=r===a?0:1/(a-r),d}}function yi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function r_(){var e=vi(Rm()(Hs));return e.copy=function(){return yi(e,r_())},Un.apply(e,arguments)}function s_(){var e=jv(Rm()).domain([1,10]);return e.copy=function(){return yi(e,s_()).base(e.base())},Un.apply(e,arguments)}function a_(){var e=wv(Rm());return e.copy=function(){return yi(e,a_()).constant(e.constant())},Un.apply(e,arguments)}function Ov(){var e=Nv(Rm());return e.copy=function(){return yi(e,Ov()).exponent(e.exponent())},Un.apply(e,arguments)}function uZ(){return Ov.apply(null,arguments).exponent(.5)}function n_(){var e=[],t=Hs;function r(a){if(a!=null&&!isNaN(a=+a))return t((Hc(e,a,1)-1)/(e.length-1))}return r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let n of a)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(si),r},r.interpolator=function(a){return arguments.length?(t=a,r):t},r.range=function(){return e.map((a,n)=>t(n/(e.length-1)))},r.quantiles=function(a){return Array.from({length:a+1},(n,i)=>XY(e,i/a))},r.copy=function(){return n_(t).domain(e)},Un.apply(r,arguments)}function Fm(){var e=0,t=.5,r=1,a=1,n,i,o,l,c,d=Hs,u,m=!1,f;function h(x){return isNaN(x=+x)?f:(x=.5+((x=+u(x))-i)*(a*x<a*i?l:c),d(m?Math.max(0,Math.min(1,x)):x))}h.domain=function(x){return arguments.length?([e,t,r]=x,n=u(e=+e),i=u(t=+t),o=u(r=+r),l=n===i?0:.5/(i-n),c=i===o?0:.5/(o-i),a=i<n?-1:1,h):[e,t,r]},h.clamp=function(x){return arguments.length?(m=!!x,h):m},h.interpolator=function(x){return arguments.length?(d=x,h):d};function p(x){return function(g){var b,j,y;return arguments.length?([b,j,y]=g,d=NX(x,[b,j,y]),h):[d(0),d(.5),d(1)]}}return h.range=p(ll),h.rangeRound=p(gv),h.unknown=function(x){return arguments.length?(f=x,h):f},function(x){return u=x,n=x(e),i=x(t),o=x(r),l=n===i?0:.5/(i-n),c=i===o?0:.5/(o-i),a=i<n?-1:1,h}}function i_(){var e=vi(Fm()(Hs));return e.copy=function(){return yi(e,i_())},Un.apply(e,arguments)}function o_(){var e=jv(Fm()).domain([.1,1,10]);return e.copy=function(){return yi(e,o_()).base(e.base())},Un.apply(e,arguments)}function l_(){var e=wv(Fm());return e.copy=function(){return yi(e,l_()).constant(e.constant())},Un.apply(e,arguments)}function Pv(){var e=Nv(Fm());return e.copy=function(){return yi(e,Pv()).exponent(e.exponent())},Un.apply(e,arguments)}function mZ(){return Pv.apply(null,arguments).exponent(.5)}const Ll=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:hv,scaleDiverging:i_,scaleDivergingLog:o_,scaleDivergingPow:Pv,scaleDivergingSqrt:mZ,scaleDivergingSymlog:l_,scaleIdentity:zA,scaleImplicit:xx,scaleLinear:BA,scaleLog:UA,scaleOrdinal:fv,scalePoint:QY,scalePow:Sv,scaleQuantile:VA,scaleQuantize:GA,scaleRadial:HA,scaleSequential:r_,scaleSequentialLog:s_,scaleSequentialPow:Ov,scaleSequentialQuantile:n_,scaleSequentialSqrt:uZ,scaleSequentialSymlog:a_,scaleSqrt:GX,scaleSymlog:WA,scaleThreshold:qA,scaleTime:cZ,scaleUtc:dZ,tickFormat:MA},Symbol.toStringTag,{value:"Module"}));var bi=e=>e.chartData,Rv=we([bi],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Fv=(e,t,r,a)=>a?Rv(e):bi(e);function Xo(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(va(t)&&va(r))return!0}return!1}function rN(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function fZ(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,a]=e,n,i;if(va(r))n=r;else if(typeof r=="function")return;if(va(a))i=a;else if(typeof a=="function")return;var o=[n,i];if(Xo(o))return o}}function hZ(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var a=e(t,r);if(Xo(a))return rN(a,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[n,i]=e,o,l;if(n==="auto")t!=null&&(o=Math.min(...t));else if(it(n))o=n;else if(typeof n=="function")try{t!=null&&(o=n(t?.[0]))}catch{}else if(typeof n=="string"&&Gj.test(n)){var c=Gj.exec(n);if(c==null||t==null)o=void 0;else{var d=+c[1];o=t[0]-d}}else o=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(it(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&qj.test(i)){var u=qj.exec(i);if(u==null||t==null)l=void 0;else{var m=+u[1];l=t[1]+m}}else l=t?.[1];var f=[o,l];if(Xo(f))return t==null?f:rN(f,t,r)}}}var cl=1e9,pZ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Mv,gr=!0,Ba="[DecimalError] ",Hi=Ba+"Invalid argument: ",Lv=Ba+"Exponent out of range: ",dl=Math.floor,Ci=Math.pow,xZ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ua,os=1e7,mr=7,c_=9007199254740991,Lu=dl(c_/mr),Ze={};Ze.absoluteValue=Ze.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Ze.comparedTo=Ze.cmp=function(e){var t,r,a,n,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(a=i.d.length,n=e.d.length,t=0,r=a<n?a:n;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return a===n?0:a>n^i.s<0?1:-1};Ze.decimalPlaces=Ze.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*mr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Ze.dividedBy=Ze.div=function(e){return An(this,new this.constructor(e))};Ze.dividedToIntegerBy=Ze.idiv=function(e){var t=this,r=t.constructor;return lr(An(t,new r(e),0,1),r.precision)};Ze.equals=Ze.eq=function(e){return!this.cmp(e)};Ze.exponent=function(){return Kr(this)};Ze.greaterThan=Ze.gt=function(e){return this.cmp(e)>0};Ze.greaterThanOrEqualTo=Ze.gte=function(e){return this.cmp(e)>=0};Ze.isInteger=Ze.isint=function(){return this.e>this.d.length-2};Ze.isNegative=Ze.isneg=function(){return this.s<0};Ze.isPositive=Ze.ispos=function(){return this.s>0};Ze.isZero=function(){return this.s===0};Ze.lessThan=Ze.lt=function(e){return this.cmp(e)<0};Ze.lessThanOrEqualTo=Ze.lte=function(e){return this.cmp(e)<1};Ze.logarithm=Ze.log=function(e){var t,r=this,a=r.constructor,n=a.precision,i=n+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(ua))throw Error(Ba+"NaN");if(r.s<1)throw Error(Ba+(r.s?"NaN":"-Infinity"));return r.eq(ua)?new a(0):(gr=!1,t=An(wc(r,i),wc(e,i),i),gr=!0,lr(t,n))};Ze.minus=Ze.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?m_(t,e):d_(t,(e.s=-e.s,e))};Ze.modulo=Ze.mod=function(e){var t,r=this,a=r.constructor,n=a.precision;if(e=new a(e),!e.s)throw Error(Ba+"NaN");return r.s?(gr=!1,t=An(r,e,0,1).times(e),gr=!0,r.minus(t)):lr(new a(r),n)};Ze.naturalExponential=Ze.exp=function(){return u_(this)};Ze.naturalLogarithm=Ze.ln=function(){return wc(this)};Ze.negated=Ze.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Ze.plus=Ze.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?d_(t,e):m_(t,(e.s=-e.s,e))};Ze.precision=Ze.sd=function(e){var t,r,a,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Hi+e);if(t=Kr(n)+1,a=n.d.length-1,r=a*mr+1,a=n.d[a],a){for(;a%10==0;a/=10)r--;for(a=n.d[0];a>=10;a/=10)r++}return e&&t>r?t:r};Ze.squareRoot=Ze.sqrt=function(){var e,t,r,a,n,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Ba+"NaN")}for(e=Kr(l),gr=!1,n=Math.sqrt(+l),n==0||n==1/0?(t=cn(l.d),(t.length+e)%2==0&&(t+="0"),n=Math.sqrt(t),e=dl((e+1)/2)-(e<0||e%2),n==1/0?t="5e"+e:(t=n.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new c(t)):a=new c(n.toString()),r=c.precision,n=o=r+3;;)if(i=a,a=i.plus(An(l,i,o+2)).times(.5),cn(i.d).slice(0,o)===(t=cn(a.d)).slice(0,o)){if(t=t.slice(o-3,o+1),n==o&&t=="4999"){if(lr(i,r+1,0),i.times(i).eq(l)){a=i;break}}else if(t!="9999")break;o+=4}return gr=!0,lr(a,r)};Ze.times=Ze.mul=function(e){var t,r,a,n,i,o,l,c,d,u=this,m=u.constructor,f=u.d,h=(e=new m(e)).d;if(!u.s||!e.s)return new m(0);for(e.s*=u.s,r=u.e+e.e,c=f.length,d=h.length,c<d&&(i=f,f=h,h=i,o=c,c=d,d=o),i=[],o=c+d,a=o;a--;)i.push(0);for(a=d;--a>=0;){for(t=0,n=c+a;n>a;)l=i[n]+h[a]*f[n-a-1]+t,i[n--]=l%os|0,t=l/os|0;i[n]=(i[n]+t)%os|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,gr?lr(e,m.precision):e};Ze.toDecimalPlaces=Ze.todp=function(e,t){var r=this,a=r.constructor;return r=new a(r),e===void 0?r:(hn(e,0,cl),t===void 0?t=a.rounding:hn(t,0,8),lr(r,e+Kr(r)+1,t))};Ze.toExponential=function(e,t){var r,a=this,n=a.constructor;return e===void 0?r=ao(a,!0):(hn(e,0,cl),t===void 0?t=n.rounding:hn(t,0,8),a=lr(new n(a),e+1,t),r=ao(a,!0,e+1)),r};Ze.toFixed=function(e,t){var r,a,n=this,i=n.constructor;return e===void 0?ao(n):(hn(e,0,cl),t===void 0?t=i.rounding:hn(t,0,8),a=lr(new i(n),e+Kr(n)+1,t),r=ao(a.abs(),!1,e+Kr(a)+1),n.isneg()&&!n.isZero()?"-"+r:r)};Ze.toInteger=Ze.toint=function(){var e=this,t=e.constructor;return lr(new t(e),Kr(e)+1,t.rounding)};Ze.toNumber=function(){return+this};Ze.toPower=Ze.pow=function(e){var t,r,a,n,i,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(ua);if(l=new c(l),!l.s){if(e.s<1)throw Error(Ba+"Infinity");return l}if(l.eq(ua))return l;if(a=c.precision,e.eq(ua))return lr(l,a);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=c_){for(n=new c(ua),t=Math.ceil(a/mr+4),gr=!1;r%2&&(n=n.times(l),aN(n.d,t)),r=dl(r/2),r!==0;)l=l.times(l),aN(l.d,t);return gr=!0,e.s<0?new c(ua).div(n):lr(n,a)}}else if(i<0)throw Error(Ba+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,gr=!1,n=e.times(wc(l,a+d)),gr=!0,n=u_(n),n.s=i,n};Ze.toPrecision=function(e,t){var r,a,n=this,i=n.constructor;return e===void 0?(r=Kr(n),a=ao(n,r<=i.toExpNeg||r>=i.toExpPos)):(hn(e,1,cl),t===void 0?t=i.rounding:hn(t,0,8),n=lr(new i(n),e,t),r=Kr(n),a=ao(n,e<=r||r<=i.toExpNeg,e)),a};Ze.toSignificantDigits=Ze.tosd=function(e,t){var r=this,a=r.constructor;return e===void 0?(e=a.precision,t=a.rounding):(hn(e,1,cl),t===void 0?t=a.rounding:hn(t,0,8)),lr(new a(r),e,t)};Ze.toString=Ze.valueOf=Ze.val=Ze.toJSON=Ze[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Kr(e),r=e.constructor;return ao(e,t<=r.toExpNeg||t>=r.toExpPos)};function d_(e,t){var r,a,n,i,o,l,c,d,u=e.constructor,m=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),gr?lr(t,m):t;if(c=e.d,d=t.d,o=e.e,n=t.e,c=c.slice(),i=o-n,i){for(i<0?(a=c,i=-i,l=d.length):(a=d,n=o,l=c.length),o=Math.ceil(m/mr),l=o>l?o+1:l+1,i>l&&(i=l,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,a=d,d=c,c=a),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/os|0,c[i]%=os;for(r&&(c.unshift(r),++n),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=n,gr?lr(t,m):t}function hn(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Hi+e)}function cn(e){var t,r,a,n=e.length-1,i="",o=e[0];if(n>0){for(i+=o,t=1;t<n;t++)a=e[t]+"",r=mr-a.length,r&&(i+=Jn(r)),i+=a;o=e[t],a=o+"",r=mr-a.length,r&&(i+=Jn(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var An=(function(){function e(a,n){var i,o=0,l=a.length;for(a=a.slice();l--;)i=a[l]*n+o,a[l]=i%os|0,o=i/os|0;return o&&a.unshift(o),a}function t(a,n,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(a[l]!=n[l]){c=a[l]>n[l]?1:-1;break}return c}function r(a,n,i){for(var o=0;i--;)a[i]-=o,o=a[i]<n[i]?1:0,a[i]=o*os+a[i]-n[i];for(;!a[0]&&a.length>1;)a.shift()}return function(a,n,i,o){var l,c,d,u,m,f,h,p,x,g,b,j,y,w,S,N,E,P,T=a.constructor,O=a.s==n.s?1:-1,_=a.d,C=n.d;if(!a.s)return new T(a);if(!n.s)throw Error(Ba+"Division by zero");for(c=a.e-n.e,E=C.length,S=_.length,h=new T(O),p=h.d=[],d=0;C[d]==(_[d]||0);)++d;if(C[d]>(_[d]||0)&&--c,i==null?j=i=T.precision:o?j=i+(Kr(a)-Kr(n))+1:j=i,j<0)return new T(0);if(j=j/mr+2|0,d=0,E==1)for(u=0,C=C[0],j++;(d<S||u)&&j--;d++)y=u*os+(_[d]||0),p[d]=y/C|0,u=y%C|0;else{for(u=os/(C[0]+1)|0,u>1&&(C=e(C,u),_=e(_,u),E=C.length,S=_.length),w=E,x=_.slice(0,E),g=x.length;g<E;)x[g++]=0;P=C.slice(),P.unshift(0),N=C[0],C[1]>=os/2&&++N;do u=0,l=t(C,x,E,g),l<0?(b=x[0],E!=g&&(b=b*os+(x[1]||0)),u=b/N|0,u>1?(u>=os&&(u=os-1),m=e(C,u),f=m.length,g=x.length,l=t(m,x,f,g),l==1&&(u--,r(m,E<f?P:C,f))):(u==0&&(l=u=1),m=C.slice()),f=m.length,f<g&&m.unshift(0),r(x,m,g),l==-1&&(g=x.length,l=t(C,x,E,g),l<1&&(u++,r(x,E<g?P:C,g))),g=x.length):l===0&&(u++,x=[0]),p[d++]=u,l&&x[0]?x[g++]=_[w]||0:(x=[_[w]],g=1);while((w++<S||x[0]!==void 0)&&j--)}return p[0]||p.shift(),h.e=c,lr(h,o?i+Kr(h)+1:i)}})();function u_(e,t){var r,a,n,i,o,l,c=0,d=0,u=e.constructor,m=u.precision;if(Kr(e)>16)throw Error(Lv+Kr(e));if(!e.s)return new u(ua);for(gr=!1,l=m,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(a=Math.log(Ci(2,d))/Math.LN10*2+5|0,l+=a,r=n=i=new u(ua),u.precision=l;;){if(n=lr(n.times(e),l),r=r.times(++c),o=i.plus(An(n,r,l)),cn(o.d).slice(0,l)===cn(i.d).slice(0,l)){for(;d--;)i=lr(i.times(i),l);return u.precision=m,t==null?(gr=!0,lr(i,m)):i}i=o}}function Kr(e){for(var t=e.e*mr,r=e.d[0];r>=10;r/=10)t++;return t}function _h(e,t,r){if(t>e.LN10.sd())throw gr=!0,r&&(e.precision=r),Error(Ba+"LN10 precision limit exceeded");return lr(new e(e.LN10),t)}function Jn(e){for(var t="";e--;)t+="0";return t}function wc(e,t){var r,a,n,i,o,l,c,d,u,m=1,f=10,h=e,p=h.d,x=h.constructor,g=x.precision;if(h.s<1)throw Error(Ba+(h.s?"NaN":"-Infinity"));if(h.eq(ua))return new x(0);if(t==null?(gr=!1,d=g):d=t,h.eq(10))return t==null&&(gr=!0),_h(x,d);if(d+=f,x.precision=d,r=cn(p),a=r.charAt(0),i=Kr(h),Math.abs(i)<15e14){for(;a<7&&a!=1||a==1&&r.charAt(1)>3;)h=h.times(e),r=cn(h.d),a=r.charAt(0),m++;i=Kr(h),a>1?(h=new x("0."+r),i++):h=new x(a+"."+r.slice(1))}else return c=_h(x,d+2,g).times(i+""),h=wc(new x(a+"."+r.slice(1)),d-f).plus(c),x.precision=g,t==null?(gr=!0,lr(h,g)):h;for(l=o=h=An(h.minus(ua),h.plus(ua),d),u=lr(h.times(h),d),n=3;;){if(o=lr(o.times(u),d),c=l.plus(An(o,new x(n),d)),cn(c.d).slice(0,d)===cn(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(_h(x,d+2,g).times(i+""))),l=An(l,new x(m),d),x.precision=g,t==null?(gr=!0,lr(l,g)):l;l=c,n+=2}}function sN(e,t){var r,a,n;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;t.charCodeAt(a)===48;)++a;for(n=t.length;t.charCodeAt(n-1)===48;)--n;if(t=t.slice(a,n),t){if(n-=a,r=r-a-1,e.e=dl(r/mr),e.d=[],a=(r+1)%mr,r<0&&(a+=mr),a<n){for(a&&e.d.push(+t.slice(0,a)),n-=mr;a<n;)e.d.push(+t.slice(a,a+=mr));t=t.slice(a),a=mr-t.length}else a-=n;for(;a--;)t+="0";if(e.d.push(+t),gr&&(e.e>Lu||e.e<-Lu))throw Error(Lv+r)}else e.s=0,e.e=0,e.d=[0];return e}function lr(e,t,r){var a,n,i,o,l,c,d,u,m=e.d;for(o=1,i=m[0];i>=10;i/=10)o++;if(a=t-o,a<0)a+=mr,n=t,d=m[u=0];else{if(u=Math.ceil((a+1)/mr),i=m.length,u>=i)return e;for(d=i=m[u],o=1;i>=10;i/=10)o++;a%=mr,n=a-mr+o}if(r!==void 0&&(i=Ci(10,o-n-1),l=d/i%10|0,c=t<0||m[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(a>0?n>0?d/Ci(10,o-n):0:m[u-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return c?(i=Kr(e),m.length=1,t=t-i-1,m[0]=Ci(10,(mr-t%mr)%mr),e.e=dl(-t/mr)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(a==0?(m.length=u,i=1,u--):(m.length=u+1,i=Ci(10,mr-a),m[u]=n>0?(d/Ci(10,o-n)%Ci(10,n)|0)*i:0),c)for(;;)if(u==0){(m[0]+=i)==os&&(m[0]=1,++e.e);break}else{if(m[u]+=i,m[u]!=os)break;m[u--]=0,i=1}for(a=m.length;m[--a]===0;)m.pop();if(gr&&(e.e>Lu||e.e<-Lu))throw Error(Lv+Kr(e));return e}function m_(e,t){var r,a,n,i,o,l,c,d,u,m,f=e.constructor,h=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),gr?lr(t,h):t;if(c=e.d,m=t.d,a=t.e,d=e.e,c=c.slice(),o=d-a,o){for(u=o<0,u?(r=c,o=-o,l=m.length):(r=m,a=d,l=c.length),n=Math.max(Math.ceil(h/mr),l)+2,o>n&&(o=n,r.length=1),r.reverse(),n=o;n--;)r.push(0);r.reverse()}else{for(n=c.length,l=m.length,u=n<l,u&&(l=n),n=0;n<l;n++)if(c[n]!=m[n]){u=c[n]<m[n];break}o=0}for(u&&(r=c,c=m,m=r,t.s=-t.s),l=c.length,n=m.length-l;n>0;--n)c[l++]=0;for(n=m.length;n>o;){if(c[--n]<m[n]){for(i=n;i&&c[--i]===0;)c[i]=os-1;--c[i],c[n]+=os}c[n]-=m[n]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--a;return c[0]?(t.d=c,t.e=a,gr?lr(t,h):t):new f(0)}function ao(e,t,r){var a,n=Kr(e),i=cn(e.d),o=i.length;return t?(r&&(a=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Jn(a):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(n<0?"e":"e+")+n):n<0?(i="0."+Jn(-n-1)+i,r&&(a=r-o)>0&&(i+=Jn(a))):n>=o?(i+=Jn(n+1-o),r&&(a=r-n-1)>0&&(i=i+"."+Jn(a))):((a=n+1)<o&&(i=i.slice(0,a)+"."+i.slice(a)),r&&(a=r-o)>0&&(n+1===o&&(i+="."),i+=Jn(a))),e.s<0?"-"+i:i}function aN(e,t){if(e.length>t)return e.length=t,!0}function f_(e){var t,r,a;function n(i){var o=this;if(!(o instanceof n))return new n(i);if(o.constructor=n,i instanceof n){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Hi+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return sN(o,i.toString())}else if(typeof i!="string")throw Error(Hi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,xZ.test(i))sN(o,i);else throw Error(Hi+i)}if(n.prototype=Ze,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.clone=f_,n.config=n.set=gZ,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(r=a[t++])||(e[r]=this[r]);return n.config(e),n}function gZ(e){if(!e||typeof e!="object")throw Error(Ba+"Object expected");var t,r,a,n=["precision",1,cl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<n.length;t+=3)if((a=e[r=n[t]])!==void 0)if(dl(a)===a&&a>=n[t+1]&&a<=n[t+2])this[r]=a;else throw Error(Hi+r+": "+a);if((a=e[r="LN10"])!==void 0)if(a==Math.LN10)this[r]=new this(a);else throw Error(Hi+r+": "+a);return this}var Mv=f_(pZ);ua=new Mv(1);const er=Mv;var vZ=e=>e,h_={},p_=e=>e===h_,nN=e=>function t(){return arguments.length===0||arguments.length===1&&p_(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},x_=(e,t)=>e===1?t:nN(function(){for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];var i=a.filter(o=>o!==h_).length;return i>=e?t(...a):x_(e-i,nN(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var d=a.map(u=>p_(u)?l.shift():u);return t(...d,...l)}))}),Lm=e=>x_(e.length,e),bx=(e,t)=>{for(var r=[],a=e;a<t;++a)r[a-e]=a;return r},yZ=Lm((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),bZ=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(!r.length)return vZ;var n=r.reverse(),i=n[0],o=n.slice(1);return function(){return o.reduce((l,c)=>c(l),i(...arguments))}},jx=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),g_=e=>{var t=null,r=null;return function(){for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return t&&n.every((o,l)=>{var c;return o===((c=t)===null||c===void 0?void 0:c[l])})||(t=n,r=e(...n)),r}};function v_(e){var t;return e===0?t=1:t=Math.floor(new er(e).abs().log(10).toNumber())+1,t}function y_(e,t,r){for(var a=new er(e),n=0,i=[];a.lt(t)&&n<1e5;)i.push(a.toNumber()),a=a.add(r),n++;return i}Lm((e,t,r)=>{var a=+e,n=+t;return a+r*(n-a)});Lm((e,t,r)=>{var a=t-+e;return a=a||1/0,(r-e)/a});Lm((e,t,r)=>{var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(r-e)/a))});var b_=e=>{var[t,r]=e,[a,n]=[t,r];return t>r&&([a,n]=[r,t]),[a,n]},j_=(e,t,r)=>{if(e.lte(0))return new er(0);var a=v_(e.toNumber()),n=new er(10).pow(a),i=e.div(n),o=a!==1?.05:.1,l=new er(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(n);return t?new er(c.toNumber()):new er(Math.ceil(c.toNumber()))},jZ=(e,t,r)=>{var a=new er(1),n=new er(e);if(!n.isint()&&r){var i=Math.abs(e);i<1?(a=new er(10).pow(v_(e)-1),n=new er(Math.floor(n.div(a).toNumber())).mul(a)):i>1&&(n=new er(Math.floor(e)))}else e===0?n=new er(Math.floor((t-1)/2)):r||(n=new er(Math.floor(e)));var o=Math.floor((t-1)/2),l=bZ(yZ(c=>n.add(new er(c-o).mul(a)).toNumber()),bx);return l(0,t)},w_=function(t,r,a,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(a-1)))return{step:new er(0),tickMin:new er(0),tickMax:new er(0)};var o=j_(new er(r).sub(t).div(a-1),n,i),l;t<=0&&r>=0?l=new er(0):(l=new er(t).add(r).div(2),l=l.sub(new er(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),d=Math.ceil(new er(r).sub(l).div(o).toNumber()),u=c+d+1;return u>a?w_(t,r,a,n,i+1):(u<a&&(d=r>0?d+(a-u):d,c=r>0?c:c+(a-u)),{step:o,tickMin:l.sub(new er(c).mul(o)),tickMax:l.add(new er(d).mul(o))})};function wZ(e){var[t,r]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),[o,l]=b_([t,r]);if(o===-1/0||l===1/0){var c=l===1/0?[o,...bx(0,a-1).map(()=>1/0)]:[...bx(0,a-1).map(()=>-1/0),l];return t>r?jx(c):c}if(o===l)return jZ(o,a,n);var{step:d,tickMin:u,tickMax:m}=w_(o,l,i,n,0),f=y_(u,m.add(new er(.1).mul(d)),d);return t>r?jx(f):f}function NZ(e,t){var[r,a]=e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=b_([r,a]);if(i===-1/0||o===1/0)return[r,a];if(i===o)return[i];var l=Math.max(t,2),c=j_(new er(o).sub(i).div(l-1),n,0),d=[...y_(new er(i),new er(o),c),o];return n===!1&&(d=d.map(u=>Math.round(u))),r>a?jx(d):d}var SZ=g_(wZ),EZ=g_(NZ),N_=e=>e.rootProps.maxBarSize,TZ=e=>e.rootProps.barGap,S_=e=>e.rootProps.barCategoryGap,CZ=e=>e.rootProps.barSize,Kc=e=>e.rootProps.stackOffset,Bv=e=>e.options.chartName,zv=e=>e.rootProps.syncId,E_=e=>e.rootProps.syncMethod,$v=e=>e.options.eventEmitter,yn={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ia={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Mm=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},AZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:yn.angleAxisId,includeHidden:!1,name:void 0,reversed:yn.reversed,scale:yn.scale,tick:yn.tick,tickCount:void 0,ticks:void 0,type:yn.type,unit:void 0},_Z={allowDataOverflow:ia.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ia.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ia.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ia.scale,tick:ia.tick,tickCount:ia.tickCount,ticks:void 0,type:ia.type,unit:void 0},kZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:yn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:yn.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:yn.scale,tick:yn.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},DZ={allowDataOverflow:ia.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ia.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ia.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ia.scale,tick:ia.tick,tickCount:ia.tickCount,ticks:void 0,type:"category",unit:void 0},Uv=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?kZ:AZ,Wv=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?DZ:_Z,Bm=e=>e.polarOptions,Hv=we([zn,$n,ss],oA),T_=we([Bm,Hv],(e,t)=>{if(e!=null)return Fs(e.innerRadius,t,0)}),C_=we([Bm,Hv],(e,t)=>{if(e!=null)return Fs(e.outerRadius,t,t*.8)}),IZ=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},A_=we([Bm],IZ);we([Uv,A_],Mm);var __=we([Hv,T_,C_],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});we([Wv,__],Mm);var k_=we([Kt,Bm,T_,C_,zn,$n],(e,t,r,a,n,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||a==null)){var{cx:o,cy:l,startAngle:c,endAngle:d}=t;return{cx:Fs(o,n,n/2),cy:Fs(l,i,i/2),innerRadius:r,outerRadius:a,startAngle:c,endAngle:d,clockWise:!1}}}),yr=(e,t)=>t,Yc=(e,t,r)=>r;function Vv(e){return e?.id}var ns=e=>{var t=Kt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},ul=e=>e.tooltip.settings.axisId,hs=e=>{var t=ns(e),r=ul(e);return Xc(e,t,r)},D_=we([hs],e=>e?.dataKey);function I_(e,t,r){var{chartData:a=[]}=t,{allowDuplicatedCategory:n,dataKey:i}=r,o=new Map;return e.forEach(l=>{var c,d=(c=l.data)!==null&&c!==void 0?c:a;if(!(d==null||d.length===0)){var u=Vv(l);d.forEach((m,f)=>{var h=i==null||n?f:String(Cr(m,i,null)),p=Cr(m,l.dataKey,0),x;o.has(h)?x=o.get(h):x={},Object.assign(x,{[u]:p}),o.set(h,x)})}}),Array.from(o.values())}function zm(e){return e.stackId!=null&&e.dataKey!=null}function iN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Mu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iN(Object(r),!0).forEach(function(a){OZ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function OZ(e,t,r){return(t=PZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PZ(e){var t=RZ(e,"string");return typeof t=="symbol"?t:t+""}function RZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wx=[0,"auto"],aa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},O_=(e,t)=>e.cartesianAxis.xAxis[t],Wn=(e,t)=>{var r=O_(e,t);return r??aa},na={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:wx,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Wc},P_=(e,t)=>e.cartesianAxis.yAxis[t],Hn=(e,t)=>{var r=P_(e,t);return r??na},FZ={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Gv=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??FZ},Ur=(e,t,r)=>{switch(t){case"xAxis":return Wn(e,r);case"yAxis":return Hn(e,r);case"zAxis":return Gv(e,r);case"angleAxis":return Uv(e,r);case"radiusAxis":return Wv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},LZ=(e,t,r)=>{switch(t){case"xAxis":return Wn(e,r);case"yAxis":return Hn(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Xc=(e,t,r)=>{switch(t){case"xAxis":return Wn(e,r);case"yAxis":return Hn(e,r);case"angleAxis":return Uv(e,r);case"radiusAxis":return Wv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},R_=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function qv(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Kv=e=>e.graphicalItems.cartesianItems,MZ=we([yr,Yc],qv),Yv=(e,t,r)=>e.filter(r).filter(a=>t?.includeHidden===!0?!0:!a.hide),Jc=we([Kv,Ur,MZ],Yv),F_=we([Jc],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(zm)),L_=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),M_=we([Jc],L_),Xv=e=>e.map(t=>t.data).filter(Boolean).flat(1),BZ=we([Jc],Xv),Jv=(e,t)=>{var{chartData:r=[],dataStartIndex:a,dataEndIndex:n}=t;return e.length>0?e:r.slice(a,n+1)},Zv=we([BZ,Fv],Jv),Qv=(e,t,r)=>t?.dataKey!=null?e.map(a=>({value:Cr(a,t.dataKey)})):r.length>0?r.map(a=>a.dataKey).flatMap(a=>e.map(n=>({value:Cr(n,a)}))):e.map(a=>({value:a})),$m=we([Zv,Ur,Jc],Qv);function B_(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function yo(e){return e.filter(t=>fn(t)||t instanceof Date).map(Number).filter(t=>xa(t)===!1)}function zZ(e,t,r){return!r||typeof t!="number"||xa(t)?[]:r.length?yo(r.flatMap(a=>{var n=Cr(e,a.dataKey),i,o;if(Array.isArray(n)?[i,o]=n:i=o=n,!(!va(i)||!va(o)))return[t-i,t+o]})):[]}var $Z=we([F_,Fv,hs],I_),z_=(e,t,r)=>{var a={},n=t.reduce((i,o)=>(o.stackId==null||(i[o.stackId]==null&&(i[o.stackId]=[]),i[o.stackId].push(o)),i),a);return Object.fromEntries(Object.entries(n).map(i=>{var[o,l]=i,c=l.map(Vv);return[o,{stackedData:Vq(e,c,r),graphicalItems:l}]}))},Nx=we([$Z,F_,Kc],z_),$_=(e,t,r)=>{var{dataStartIndex:a,dataEndIndex:n}=t;if(r!=="zAxis"){var i=Xq(e,a,n);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},UZ=we([Nx,bi,yr],$_),U_=(e,t,r,a,n)=>r.length>0?e.flatMap(i=>r.flatMap(o=>{var l,c,d=(l=a[o.id])===null||l===void 0?void 0:l.filter(m=>B_(n,m)),u=Cr(i,(c=t.dataKey)!==null&&c!==void 0?c:o.dataKey);return{value:u,errorDomain:zZ(i,u,d)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:Cr(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),Um=e=>e.errorBars,W_=(e,t,r)=>e.flatMap(a=>t[a.id]).filter(Boolean).filter(a=>B_(r,a));we([M_,Um,yr],W_);var WZ=we([Zv,Ur,M_,Um,yr],U_);function HZ(e){var{value:t}=e;if(fn(t)||t instanceof Date)return t}var oN=e=>{var t=e.flatMap(a=>[a.value,a.errorDomain]).flat(1),r=yo(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},VZ=(e,t,r)=>{var a=e.map(HZ).filter(n=>n!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&rC(a))?AA(0,e.length):t.allowDuplicatedCategory?a:Array.from(new Set(a))},e1=e=>{var t;if(e==null||!("domain"in e))return wx;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=yo(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:wx},Bu=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var n=r.filter(Boolean);if(n.length!==0){var i=n.flat(),o=Math.min(...i),l=Math.max(...i);return[o,l]}},H_=e=>e.referenceElements.dots,ml=(e,t,r)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>t==="xAxis"?a.xAxisId===r:a.yAxisId===r),GZ=we([H_,yr,Yc],ml),V_=e=>e.referenceElements.areas,qZ=we([V_,yr,Yc],ml),G_=e=>e.referenceElements.lines,KZ=we([G_,yr,Yc],ml),q_=(e,t)=>{var r=yo(e.map(a=>t==="xAxis"?a.x:a.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},YZ=we(GZ,yr,q_),K_=(e,t)=>{var r=yo(e.flatMap(a=>[t==="xAxis"?a.x1:a.y1,t==="xAxis"?a.x2:a.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},XZ=we([qZ,yr],K_),Y_=(e,t)=>{var r=yo(e.map(a=>t==="xAxis"?a.x:a.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},JZ=we(KZ,yr,Y_),ZZ=we(YZ,JZ,XZ,(e,t,r)=>Bu(e,r,t)),X_=we([Ur],e1),t1=(e,t,r,a,n,i,o)=>{var l=fZ(t,e.allowDataOverflow);if(l!=null)return l;var c=i==="vertical"&&o==="xAxis"||i==="horizontal"&&o==="yAxis",d=c?Bu(r,n,oN(a)):Bu(n,oN(a));return hZ(t,d,e.allowDataOverflow)},QZ=we([Ur,X_,UZ,WZ,ZZ,Kt,yr],t1),eQ=[0,1],r1=(e,t,r,a,n,i,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,d=po(t,i);return d&&l==null?AA(0,r.length):c==="category"?VZ(a,e,d):n==="expand"?eQ:o}},s1=we([Ur,Kt,Zv,$m,Kc,yr,QZ],r1),J_=(e,t,r,a,n)=>{if(e!=null){var{scale:i,type:o}=e;if(i==="auto")return t==="radial"&&n==="radiusAxis"?"band":t==="radial"&&n==="angleAxis"?"linear":o==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(Bc(i));return l in Ll?l:"point"}}},fl=we([Ur,Kt,R_,Bv,yr],J_);function tQ(e){if(e!=null){if(e in Ll)return Ll[e]();var t="scale".concat(Bc(e));if(t in Ll)return Ll[t]()}}function a1(e,t,r,a){if(!(r==null||a==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(a);var n=tQ(t);if(n!=null){var i=n.domain(r).range(a);return zq(i),i}}}var n1=(e,t,r)=>{var a=e1(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&Xo(e))return SZ(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Xo(e))return EZ(e,t.tickCount,t.allowDecimals)}},i1=we([s1,Xc,fl],n1),o1=(e,t,r,a)=>{if(a!=="angleAxis"&&e?.type==="number"&&Xo(t)&&Array.isArray(r)&&r.length>0){var n=t[0],i=r[0],o=t[1],l=r[r.length-1];return[Math.min(n,i),Math.max(o,l)]}return t},rQ=we([Ur,s1,i1,yr],o1),sQ=we($m,Ur,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,a=Array.from(yo(e.map(l=>l.value))).sort((l,c)=>l-c);if(a.length<2)return 1/0;var n=a[a.length-1]-a[0];if(n===0)return 1/0;for(var i=0;i<a.length-1;i++){var o=a[i+1]-a[i];r=Math.min(r,o)}return r/n}}),Z_=we(sQ,Kt,S_,ss,(e,t,r,a)=>a,(e,t,r,a,n)=>{if(!va(e))return 0;var i=t==="vertical"?a.height:a.width;if(n==="gap")return e*i/2;if(n==="no-gap"){var o=Fs(r,e*i),l=e*i/2;return l-o-(l-o)/i*o}return 0}),aQ=(e,t)=>{var r=Wn(e,t);return r==null||typeof r.padding!="string"?0:Z_(e,"xAxis",t,r.padding)},nQ=(e,t)=>{var r=Hn(e,t);return r==null||typeof r.padding!="string"?0:Z_(e,"yAxis",t,r.padding)},iQ=we(Wn,aQ,(e,t)=>{var r,a;if(e==null)return{left:0,right:0};var{padding:n}=e;return typeof n=="string"?{left:t,right:t}:{left:((r=n.left)!==null&&r!==void 0?r:0)+t,right:((a=n.right)!==null&&a!==void 0?a:0)+t}}),oQ=we(Hn,nQ,(e,t)=>{var r,a;if(e==null)return{top:0,bottom:0};var{padding:n}=e;return typeof n=="string"?{top:t,bottom:t}:{top:((r=n.top)!==null&&r!==void 0?r:0)+t,bottom:((a=n.bottom)!==null&&a!==void 0?a:0)+t}}),lQ=we([ss,iQ,Am,Cm,(e,t,r)=>r],(e,t,r,a,n)=>{var{padding:i}=a;return n?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),cQ=we([ss,Kt,oQ,Am,Cm,(e,t,r)=>r],(e,t,r,a,n,i)=>{var{padding:o}=n;return i?[a.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Zc=(e,t,r,a)=>{var n;switch(t){case"xAxis":return lQ(e,r,a);case"yAxis":return cQ(e,r,a);case"zAxis":return(n=Gv(e,r))===null||n===void 0?void 0:n.range;case"angleAxis":return A_(e);case"radiusAxis":return __(e,r);default:return}},Q_=we([Ur,Zc],Mm),hl=we([Ur,fl,rQ,Q_],a1);we([Jc,Um,yr],W_);function ek(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Wm=(e,t)=>t,Hm=(e,t,r)=>r,dQ=we(Em,Wm,Hm,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort(ek)),uQ=we(Tm,Wm,Hm,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort(ek)),tk=(e,t)=>({width:e.width,height:t.height}),mQ=(e,t)=>{var r=typeof t.width=="number"?t.width:Wc;return{width:r,height:e.height}},rk=we(ss,Wn,tk),fQ=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},hQ=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},pQ=we($n,ss,dQ,Wm,Hm,(e,t,r,a,n)=>{var i={},o;return r.forEach(l=>{var c=tk(t,l);o==null&&(o=fQ(t,a,e));var d=a==="top"&&!n||a==="bottom"&&n;i[l.id]=o-Number(d)*c.height,o+=(d?-1:1)*c.height}),i}),xQ=we(zn,ss,uQ,Wm,Hm,(e,t,r,a,n)=>{var i={},o;return r.forEach(l=>{var c=mQ(t,l);o==null&&(o=hQ(t,a,e));var d=a==="left"&&!n||a==="right"&&n;i[l.id]=o-Number(d)*c.width,o+=(d?-1:1)*c.width}),i}),gQ=(e,t)=>{var r=Wn(e,t);if(r!=null)return pQ(e,r.orientation,r.mirror)},vQ=we([ss,Wn,gQ,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var n=r?.[a];return n==null?{x:e.left,y:0}:{x:e.left,y:n}}}),yQ=(e,t)=>{var r=Hn(e,t);if(r!=null)return xQ(e,r.orientation,r.mirror)},bQ=we([ss,Hn,yQ,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var n=r?.[a];return n==null?{x:0,y:e.top}:{x:n,y:e.top}}}),sk=we(ss,Hn,(e,t)=>{var r=typeof t.width=="number"?t.width:Wc;return{width:r,height:e.height}}),lN=(e,t,r)=>{switch(t){case"xAxis":return rk(e,r).width;case"yAxis":return sk(e,r).height;default:return}},ak=(e,t,r,a)=>{if(r!=null){var{allowDuplicatedCategory:n,type:i,dataKey:o}=r,l=po(e,a),c=t.map(d=>d.value);if(o&&l&&i==="category"&&n&&rC(c))return c}},l1=we([Kt,$m,Ur,yr],ak),nk=(e,t,r,a)=>{if(!(r==null||r.dataKey==null)){var{type:n,scale:i}=r,o=po(e,a);if(o&&(n==="number"||i!=="auto"))return t.map(l=>l.value)}},c1=we([Kt,$m,Xc,yr],nk),cN=we([Kt,LZ,fl,hl,l1,c1,Zc,i1,yr],(e,t,r,a,n,i,o,l,c)=>{if(t==null)return null;var d=po(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:n,isCategorical:d,niceTicks:l,range:o,realScaleType:r,scale:a}}),jQ=(e,t,r,a,n,i,o,l,c)=>{if(!(t==null||a==null)){var d=po(e,c),{type:u,ticks:m,tickCount:f}=t,h=r==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,p=u==="category"&&a.bandwidth?a.bandwidth()/h:0;p=c==="angleAxis"&&i!=null&&i.length>=2?ds(i[0]-i[1])*2*p:p;var x=m||n;if(x){var g=x.map((b,j)=>{var y=o?o.indexOf(b):b;return{index:j,coordinate:a(y)+p,value:b,offset:p}});return g.filter(b=>!xa(b.coordinate))}return d&&l?l.map((b,j)=>({coordinate:a(b)+p,value:b,index:j,offset:p})):a.ticks?a.ticks(f).map(b=>({coordinate:a(b)+p,value:b,offset:p})):a.domain().map((b,j)=>({coordinate:a(b)+p,value:o?o[b]:b,index:j,offset:p}))}},ik=we([Kt,Xc,fl,hl,i1,Zc,l1,c1,yr],jQ),wQ=(e,t,r,a,n,i,o)=>{if(!(t==null||r==null||a==null||a[0]===a[1])){var l=po(e,o),{tickCount:c}=t,d=0;return d=o==="angleAxis"&&a?.length>=2?ds(a[0]-a[1])*2*d:d,l&&i?i.map((u,m)=>({coordinate:r(u)+d,value:u,index:m,offset:d})):r.ticks?r.ticks(c).map(u=>({coordinate:r(u)+d,value:u,offset:d})):r.domain().map((u,m)=>({coordinate:r(u)+d,value:n?n[u]:u,index:m,offset:d}))}},Jo=we([Kt,Xc,hl,Zc,l1,c1,yr],wQ),Zo=we(Ur,hl,(e,t)=>{if(!(e==null||t==null))return Mu(Mu({},e),{},{scale:t})}),NQ=we([Ur,fl,s1,Q_],a1);we((e,t,r)=>Gv(e,r),NQ,(e,t)=>{if(!(e==null||t==null))return Mu(Mu({},e),{},{scale:t})});var SQ=we([Kt,Em,Tm],(e,t,r)=>{switch(e){case"horizontal":return t.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),ok=e=>e.options.defaultTooltipEventType,lk=e=>e.options.validateTooltipEventTypes;function ck(e,t,r){if(e==null)return t;var a=e?"axis":"item";return r==null?t:r.includes(a)?a:t}function d1(e,t){var r=ok(e),a=lk(e);return ck(t,r,a)}function EQ(e){return at(t=>d1(t,e))}var dk=(e,t)=>{var r,a=Number(t);if(!(xa(a)||t==null))return a>=0?e==null||(r=e[a])===null||r===void 0?void 0:r.value:void 0},TQ=e=>e.tooltip.settings,ei={active:!1,index:null,dataKey:void 0,coordinate:void 0},CQ={itemInteraction:{click:ei,hover:ei},axisInteraction:{click:ei,hover:ei},keyboardInteraction:ei,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},uk=ba({name:"tooltip",initialState:CQ,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Cn(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:AQ,removeTooltipEntrySettings:_Q,setTooltipSettingsState:kQ,setActiveMouseOverItemIndex:mk,mouseLeaveItem:DQ,mouseLeaveChart:fk,setActiveClickItemIndex:IQ,setMouseOverAxisIndex:hk,setMouseClickAxisIndex:OQ,setSyncInteraction:Sx,setKeyboardInteraction:Ex}=uk.actions,PQ=uk.reducer;function dN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Od(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dN(Object(r),!0).forEach(function(a){RQ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function RQ(e,t,r){return(t=FQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FQ(e){var t=LQ(e,"string");return typeof t=="symbol"?t:t+""}function LQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MQ(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function BQ(e){return e.index!=null}var pk=(e,t,r,a)=>{if(t==null)return ei;var n=MQ(e,t,r);if(n==null)return ei;if(n.active)return n;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(BQ(n)){if(i)return Od(Od({},n),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return Od(Od({},ei),{},{coordinate:n.coordinate})},u1=(e,t)=>{var r=e?.index;if(r==null)return null;var a=Number(r);if(!va(a))return r;var n=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(n,Math.min(a,i)))},xk=(e,t,r,a,n,i,o,l)=>{if(!(i==null||l==null)){var c=o[0],d=c==null?void 0:l(c.positions,i);if(d!=null)return d;var u=n?.[Number(i)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(a.top+t)/2};default:return{x:(a.left+e)/2,y:u.coordinate}}}},gk=(e,t,r,a)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var n;return r==="hover"?n=e.itemInteraction.hover.dataKey:n=e.itemInteraction.click.dataKey,n==null&&a!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.dataKey)===n})},Qc=e=>e.options.tooltipPayloadSearcher,pl=e=>e.tooltip;function uN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function mN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uN(Object(r),!0).forEach(function(a){zQ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function zQ(e,t,r){return(t=$Q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Q(e){var t=UQ(e,"string");return typeof t=="symbol"?t:t+""}function UQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WQ(e,t){return e??t}var vk=(e,t,r,a,n,i,o)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:d,dataEndIndex:u}=r,m=[];return e.reduce((f,h)=>{var p,{dataDefinedOnItem:x,settings:g}=h,b=WQ(x,l),j=Array.isArray(b)?lA(b,d,u):b,y=(p=g?.dataKey)!==null&&p!==void 0?p:a,w=g?.nameKey,S;if(a&&Array.isArray(j)&&!Array.isArray(j[0])&&o==="axis"?S=_H(j,a,n):S=i(j,t,c,w),Array.isArray(S))S.forEach(E=>{var P=mN(mN({},g),{},{name:E.name,unit:E.unit,color:void 0,fill:void 0});f.push(Kj({tooltipEntrySettings:P,dataKey:E.dataKey,payload:E.payload,value:Cr(E.payload,E.dataKey),name:E.name}))});else{var N;f.push(Kj({tooltipEntrySettings:g,dataKey:y,payload:S,value:Cr(S,y),name:(N=Cr(S,w))!==null&&N!==void 0?N:g?.name}))}return f},m)}},m1=we([hs,Kt,R_,Bv,ns],J_),HQ=we([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),VQ=we([ns,ul],qv),ed=we([HQ,hs,VQ],Yv),GQ=we([ed],e=>e.filter(zm)),qQ=we([ed],Xv),xl=we([qQ,bi],Jv),KQ=we([GQ,bi,hs],I_),f1=we([xl,hs,ed],Qv),YQ=we([hs],e1),XQ=we([ed],e=>e.filter(zm)),JQ=we([KQ,XQ,Kc],z_),ZQ=we([JQ,bi,ns],$_),QQ=we([ed],L_),eee=we([xl,hs,QQ,Um,ns],U_),tee=we([H_,ns,ul],ml),ree=we([tee,ns],q_),see=we([V_,ns,ul],ml),aee=we([see,ns],K_),nee=we([G_,ns,ul],ml),iee=we([nee,ns],Y_),oee=we([ree,iee,aee],Bu),lee=we([hs,YQ,ZQ,eee,oee,Kt,ns],t1),yk=we([hs,Kt,xl,f1,Kc,ns,lee],r1),cee=we([yk,hs,m1],n1),dee=we([hs,yk,cee,ns],o1),bk=e=>{var t=ns(e),r=ul(e),a=!1;return Zc(e,t,r,a)},jk=we([hs,bk],Mm),wk=we([hs,m1,dee,jk],a1),uee=we([Kt,f1,hs,ns],ak),mee=we([Kt,f1,hs,ns],nk),fee=(e,t,r,a,n,i,o,l)=>{if(t){var{type:c}=t,d=po(e,l);if(a){var u=r==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,m=c==="category"&&a.bandwidth?a.bandwidth()/u:0;return m=l==="angleAxis"&&n!=null&&n?.length>=2?ds(n[0]-n[1])*2*m:m,d&&o?o.map((f,h)=>({coordinate:a(f)+m,value:f,index:h,offset:m})):a.domain().map((f,h)=>({coordinate:a(f)+m,value:i?i[f]:f,index:h,offset:m}))}}},Vn=we([Kt,hs,m1,wk,bk,uee,mee,ns],fee),h1=we([ok,lk,TQ],(e,t,r)=>ck(r.shared,e,t)),Nk=e=>e.tooltip.settings.trigger,p1=e=>e.tooltip.settings.defaultIndex,Vm=we([pl,h1,Nk,p1],pk),no=we([Vm,xl],u1),Sk=we([Vn,no],dk),Ek=we([Vm],e=>{if(e)return e.dataKey}),Tk=we([pl,h1,Nk,p1],gk),hee=we([zn,$n,Kt,ss,Vn,p1,Tk,Qc],xk),pee=we([Vm,hee],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),xee=we([Vm],e=>e.active),gee=we([Tk,no,bi,D_,Sk,Qc,h1],vk);we([gee],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function fN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function hN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fN(Object(r),!0).forEach(function(a){vee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function vee(e,t,r){return(t=yee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yee(e){var t=bee(e,"string");return typeof t=="symbol"?t:t+""}function bee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jee=()=>at(hs),wee=()=>{var e=jee(),t=at(Vn),r=at(wk);return nv(hN(hN({},e),{},{scale:r}),t)},Nee=()=>at(Bv),x1=(e,t)=>t,Ck=(e,t,r)=>r,g1=(e,t,r,a)=>a,See=we(Vn,e=>vm(e,t=>t.coordinate)),v1=we([pl,x1,Ck,g1],pk),Ak=we([v1,xl],u1),Eee=(e,t,r)=>{if(t!=null){var a=pl(e);return t==="axis"?r==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:r==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},_k=we([pl,x1,Ck,g1],gk),zu=we([zn,$n,Kt,ss,Vn,g1,_k,Qc],xk),Tee=we([v1,zu],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),kk=we(Vn,Ak,dk),Cee=we([_k,Ak,bi,D_,kk,Qc,x1],vk),Aee=we([v1],e=>({isActive:e.active,activeIndex:e.index})),_ee=(e,t,r,a,n,i,o,l)=>{if(!(!e||!t||!a||!n||!i)){var c=Jq(e.chartX,e.chartY,t,r,l);if(c){var d=Qq(c,t),u=Mq(d,o,i,a,n),m=Zq(t,i,u,c);return{activeIndex:String(u),activeCoordinate:m}}}};function Tx(){return Tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Tx.apply(null,arguments)}function pN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Pd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pN(Object(r),!0).forEach(function(a){kee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function kee(e,t,r){return(t=Dee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dee(e){var t=Iee(e,"string");return typeof t=="symbol"?t:t+""}function Iee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oee(e){var{coordinate:t,payload:r,index:a,offset:n,tooltipAxisBandSize:i,layout:o,cursor:l,tooltipEventType:c,chartName:d}=e,u=t,m=r,f=a;if(!l||!u||d!=="ScatterChart"&&c!=="axis")return null;var h,p;if(d==="ScatterChart")h=u,p=QK;else if(d==="BarChart")h=eY(o,u,n,i),p=SA;else if(o==="radial"){var{cx:x,cy:g,radius:b,startAngle:j,endAngle:y}=EA(u);h={cx:x,cy:g,startAngle:j,endAngle:y,innerRadius:b,outerRadius:b},p=CA}else h={points:OY(o,u,n)},p=yA;var w=typeof l=="object"&&"className"in l?l.className:void 0,S=Pd(Pd(Pd(Pd({stroke:"#ccc",pointerEvents:"none"},n),h),ts(l,!1)),{},{payload:m,payloadIndex:f,className:Mt("recharts-tooltip-cursor",w)});return v.isValidElement(l)?v.cloneElement(l,S):v.createElement(p,S)}function Pee(e){var t=wee(),r=hA(),a=dv(),n=Nee();return v.createElement(Oee,Tx({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:a,tooltipAxisBandSize:t,chartName:n}))}var Dk=v.createContext(null),Ree=()=>v.useContext(Dk),kh={exports:{}},xN;function Fee(){return xN||(xN=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1));function n(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,m,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new n(u,m||c,f),p=r?r+d:d;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new a:delete c._events[d]}function l(){this._events=new a,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,m;if(this._eventsCount===0)return d;for(m in u=this._events)t.call(u,m)&&d.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,m=this._events[u];if(!m)return[];if(m.fn)return[m.fn];for(var f=0,h=m.length,p=new Array(h);f<h;f++)p[f]=m[f].fn;return p},l.prototype.listenerCount=function(d){var u=r?r+d:d,m=this._events[u];return m?m.fn?1:m.length:0},l.prototype.emit=function(d,u,m,f,h,p){var x=r?r+d:d;if(!this._events[x])return!1;var g=this._events[x],b=arguments.length,j,y;if(g.fn){switch(g.once&&this.removeListener(d,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,m),!0;case 4:return g.fn.call(g.context,u,m,f),!0;case 5:return g.fn.call(g.context,u,m,f,h),!0;case 6:return g.fn.call(g.context,u,m,f,h,p),!0}for(y=1,j=new Array(b-1);y<b;y++)j[y-1]=arguments[y];g.fn.apply(g.context,j)}else{var w=g.length,S;for(y=0;y<w;y++)switch(g[y].once&&this.removeListener(d,g[y].fn,void 0,!0),b){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,u);break;case 3:g[y].fn.call(g[y].context,u,m);break;case 4:g[y].fn.call(g[y].context,u,m,f);break;default:if(!j)for(S=1,j=new Array(b-1);S<b;S++)j[S-1]=arguments[S];g[y].fn.apply(g[y].context,j)}}return!0},l.prototype.on=function(d,u,m){return i(this,d,u,m,!1)},l.prototype.once=function(d,u,m){return i(this,d,u,m,!0)},l.prototype.removeListener=function(d,u,m,f){var h=r?r+d:d;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!m||p.context===m)&&o(this,h);else{for(var x=0,g=[],b=p.length;x<b;x++)(p[x].fn!==u||f&&!p[x].once||m&&p[x].context!==m)&&g.push(p[x]);g.length?this._events[h]=g.length===1?g[0]:g:o(this,h)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(kh)),kh.exports}var Lee=Fee();const Mee=mi(Lee);var Nc=new Mee,Cx="recharts.syncEvent.tooltip",gN="recharts.syncEvent.brush";function Ik(e,t){if(t){var r=Number.parseInt(t,10);if(!xa(r))return e?.[r]}}var Bee={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Ok=ba({name:"options",initialState:Bee,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),zee=Ok.reducer,{createEventEmitter:$ee}=Ok.actions;function Uee(e){return e.tooltip.syncInteraction}var Wee={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Pk=ba({name:"chartData",initialState:Wee,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:a}=t.payload;r!=null&&(e.dataStartIndex=r),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:vN,setDataStartEndIndexes:Hee,setComputedData:lde}=Pk.actions,Vee=Pk.reducer,Gee=["x","y"];function yN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Si(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yN(Object(r),!0).forEach(function(a){qee(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function qee(e,t,r){return(t=Kee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kee(e){var t=Yee(e,"string");return typeof t=="symbol"?t:t+""}function Yee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xee(e,t){if(e==null)return{};var r,a,n=Jee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Jee(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Rk=()=>{};function Zee(){var e=at(zv),t=at($v),r=kr(),a=at(E_),n=at(Vn),i=dv(),o=ov(),l=at(c=>c.rootProps.className);v.useEffect(()=>{if(e==null)return Rk;var c=(d,u,m)=>{if(t!==m&&e===d){if(a==="index"){var f;if(o&&u!==null&&u!==void 0&&(f=u.payload)!==null&&f!==void 0&&f.coordinate){var h=u.payload.coordinate,{x:p,y:x}=h,g=Xee(h,Gee),b=Si(Si(Si({},g),typeof p=="number"&&{x:Math.max(o.x,Math.min(p,o.x+o.width))}),typeof x=="number"&&{y:Math.max(o.y,Math.min(x,o.y+o.height))}),j=Si(Si({},u),{},{payload:Si(Si({},u.payload),{},{coordinate:b})});r(j)}else r(u);return}if(n!=null){var y;if(typeof a=="function"){var w={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},S=a(n,w);y=n[S]}else a==="value"&&(y=n.find(R=>String(R.value)===u.payload.label));var{coordinate:N}=u.payload;if(y==null||u.payload.active===!1||N==null||o==null){r(Sx({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:E,y:P}=N,T=Math.min(E,o.x+o.width),O=Math.min(P,o.y+o.height),_={x:i==="horizontal"?y.coordinate:T,y:i==="horizontal"?O:y.coordinate},C=Sx({active:u.payload.active,coordinate:_,dataKey:u.payload.dataKey,index:String(y.index),label:u.payload.label});r(C)}}};return Nc.on(Cx,c),()=>{Nc.off(Cx,c)}},[l,r,t,e,a,n,i,o])}function Qee(){var e=at(zv),t=at($v),r=kr();v.useEffect(()=>{if(e==null)return Rk;var a=(n,i,o)=>{t!==o&&e===n&&r(Hee(i))};return Nc.on(gN,a),()=>{Nc.off(gN,a)}},[r,t,e])}function ete(){var e=kr();v.useEffect(()=>{e($ee())},[e]),Zee(),Qee()}function tte(e,t,r,a,n,i){var o=at(f=>Eee(f,e,t)),l=at($v),c=at(zv),d=at(E_),u=at(Uee),m=u?.active;v.useEffect(()=>{if(!m&&c!=null&&l!=null){var f=Sx({active:i,coordinate:r,dataKey:o,index:n,label:typeof a=="number"?String(a):a});Nc.emit(Cx,c,f,l)}},[m,r,o,n,a,l,c,d,i])}function bN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function jN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bN(Object(r),!0).forEach(function(a){rte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function rte(e,t,r){return(t=ste(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ste(e){var t=ate(e,"string");return typeof t=="symbol"?t:t+""}function ate(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nte(e){return e.dataKey}function ite(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement(DK,t)}var wN=[],ote={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!xo.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Rd(e){var t=qs(e,ote),{active:r,allowEscapeViewBox:a,animationDuration:n,animationEasing:i,content:o,filterNull:l,isAnimationActive:c,offset:d,payloadUniqBy:u,position:m,reverseDirection:f,useTranslate3d:h,wrapperStyle:p,cursor:x,shared:g,trigger:b,defaultIndex:j,portal:y,axisId:w}=t,S=kr(),N=typeof j=="number"?String(j):j;v.useEffect(()=>{S(kQ({shared:g,trigger:b,axisId:w,active:r,defaultIndex:N}))},[S,g,b,w,r,N]);var E=ov(),P=vA(),T=EQ(g),{activeIndex:O,isActive:_}=at(V=>Aee(V,T,b,N)),C=at(V=>Cee(V,T,b,N)),R=at(V=>kk(V,T,b,N)),M=at(V=>Tee(V,T,b,N)),U=C,Z=Ree(),ee=r??_,[re,z]=FC([U,ee]),me=T==="axis"?R:void 0;tte(T,b,M,me,O,ee);var ne=y??Z;if(ne==null)return null;var A=U??wN;ee||(A=wN),l&&A.length&&(A=DC(U.filter(V=>V.value!=null&&(V.hide!==!0||t.includeHidden)),u,nte));var D=A.length>0,I=v.createElement(MK,{allowEscapeViewBox:a,animationDuration:n,animationEasing:i,isAnimationActive:c,active:ee,coordinate:M,hasPayload:D,offset:d,position:m,reverseDirection:f,useTranslate3d:h,viewBox:E,wrapperStyle:p,lastBoundingBox:re,innerRef:z,hasPortalFromProps:!!y},ite(o,jN(jN({},t),{},{payload:A,label:me,active:ee,coordinate:M,accessibilityLayer:P})));return v.createElement(v.Fragment,null,Fx.createPortal(I,ne),ee&&v.createElement(Pee,{cursor:x,tooltipEventType:T,coordinate:M,payload:U,index:O}))}var Dh={},Ih={},Oh={},NN;function lte(){return NN||(NN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a,{signal:n,edges:i}={}){let o,l=null;const c=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),u=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},m=()=>{d&&u(),x()};let f=null;const h=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,m()},a)},p=()=>{f!==null&&(clearTimeout(f),f=null)},x=()=>{p(),o=void 0,l=null},g=()=>{u()},b=function(...j){if(n?.aborted)return;o=this,l=j;const y=f==null;h(),c&&y&&u()};return b.schedule=h,b.cancel=x,b.flush=g,n?.addEventListener("abort",x,{once:!0}),b}e.debounce=t})(Oh)),Oh}var SN;function cte(){return SN||(SN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lte();function r(a,n=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:l=!0,maxWait:c}=i,d=Array(2);o&&(d[0]="leading"),l&&(d[1]="trailing");let u,m=null;const f=t.debounce(function(...x){u=a.apply(this,x),m=null},n,{edges:d}),h=function(...x){return c!=null&&(m===null&&(m=Date.now()),Date.now()-m>=c)?(u=a.apply(this,x),m=Date.now(),f.cancel(),f.schedule(),u):(f.apply(this,x),u)},p=()=>(f.flush(),u);return h.cancel=f.cancel,h.flush=p,h}e.debounce=r})(Ih)),Ih}var EN;function dte(){return EN||(EN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cte();function r(a,n=0,i={}){const{leading:o=!0,trailing:l=!0}=i;return t.debounce(a,n,{leading:o,maxWait:n,trailing:l})}e.throttle=r})(Dh)),Dh}var Ph,TN;function ute(){return TN||(TN=1,Ph=dte().throttle),Ph}var mte=ute();const fte=mi(mte);var ql=function(t,r){for(var a=arguments.length,n=new Array(a>2?a-2:0),i=2;i<a;i++)n[i-2]=arguments[i]};function CN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Rh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CN(Object(r),!0).forEach(function(a){hte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function hte(e,t,r){return(t=pte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pte(e){var t=xte(e,"string");return typeof t=="symbol"?t:t+""}function xte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fd=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:a={width:-1,height:-1},width:n="100%",height:i="100%",minWidth:o=0,minHeight:l,maxHeight:c,children:d,debounce:u=0,id:m,className:f,onResize:h,style:p={}}=e,x=v.useRef(null),g=v.useRef();g.current=h,v.useImperativeHandle(t,()=>x.current);var[b,j]=v.useState({containerWidth:a.width,containerHeight:a.height}),y=v.useCallback((S,N)=>{j(E=>{var P=Math.round(S),T=Math.round(N);return E.containerWidth===P&&E.containerHeight===T?E:{containerWidth:P,containerHeight:T}})},[]);v.useEffect(()=>{var S=T=>{var O,{width:_,height:C}=T[0].contentRect;y(_,C),(O=g.current)===null||O===void 0||O.call(g,_,C)};u>0&&(S=fte(S,u,{trailing:!0,leading:!1}));var N=new ResizeObserver(S),{width:E,height:P}=x.current.getBoundingClientRect();return y(E,P),N.observe(x.current),()=>{N.disconnect()}},[y,u]);var w=v.useMemo(()=>{var{containerWidth:S,containerHeight:N}=b;if(S<0||N<0)return null;ql(Di(n)||Di(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,n,i),ql(!r||r>0,"The aspect(%s) must be greater than zero.",r);var E=Di(n)?S:n,P=Di(i)?N:i;return r&&r>0&&(E?P=E/r:P&&(E=P*r),c&&P>c&&(P=c)),ql(E>0||P>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,E,P,n,i,o,l,r),v.Children.map(d,T=>v.cloneElement(T,{width:E,height:P,style:Rh({width:E,height:P},T.props.style)}))},[r,d,i,c,l,o,b,n]);return v.createElement("div",{id:m?"".concat(m):void 0,className:Mt("recharts-responsive-container",f),style:Rh(Rh({},p),{},{width:n,height:i,minWidth:o,minHeight:l,maxHeight:c}),ref:x},v.createElement("div",{style:{width:0,height:0,overflow:"visible"}},w))}),td=e=>null;td.displayName="Cell";function gte(e,t,r){return(t=vte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vte(e){var t=yte(e,"string");return typeof t=="symbol"?t:t+""}function yte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class bte{constructor(t){gte(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function AN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function jte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AN(Object(r),!0).forEach(function(a){wte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function wte(e,t,r){return(t=Nte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nte(e){var t=Ste(e,"string");return typeof t=="symbol"?t:t+""}function Ste(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ete={cacheSize:2e3,enableCache:!0},Fk=jte({},Ete),_N=new bte(Fk.cacheSize),Tte={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},kN="recharts_measurement_span";function Cte(e,t){var r=t.fontSize||"",a=t.fontFamily||"",n=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(a,"|").concat(n,"|").concat(i,"|").concat(o,"|").concat(l)}var DN=(e,t)=>{try{var r=document.getElementById(kN);r||(r=document.createElement("span"),r.setAttribute("id",kN),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Tte,t),r.textContent="".concat(e);var a=r.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},Kl=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||xo.isSsr)return{width:0,height:0};if(!Fk.enableCache)return DN(t,r);var a=Cte(t,r),n=_N.get(a);if(n)return n;var i=DN(t,r);return _N.set(a,i),i},IN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ON=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Ate=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,_te=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Lk={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},kte=Object.keys(Lk),_o="NaN";function Dte(e,t){return e*Lk[t]}class Js{static parse(t){var r,[,a,n]=(r=_te.exec(t))!==null&&r!==void 0?r:[];return new Js(parseFloat(a),n??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,xa(t)&&(this.unit=""),r!==""&&!Ate.test(r)&&(this.num=NaN,this.unit=""),kte.includes(r)&&(this.num=Dte(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Js(NaN,""):new Js(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Js(NaN,""):new Js(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Js(NaN,""):new Js(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Js(NaN,""):new Js(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return xa(this.num)}}function Mk(e){if(e.includes(_o))return _o;for(var t=e;t.includes("*")||t.includes("/");){var r,[,a,n,i]=(r=IN.exec(t))!==null&&r!==void 0?r:[],o=Js.parse(a??""),l=Js.parse(i??""),c=n==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return _o;t=t.replace(IN,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,u,m,f]=(d=ON.exec(t))!==null&&d!==void 0?d:[],h=Js.parse(u??""),p=Js.parse(f??""),x=m==="+"?h.add(p):h.subtract(p);if(x.isNaN())return _o;t=t.replace(ON,x.toString())}return t}var PN=/\(([^()]*)\)/;function Ite(e){for(var t=e,r;(r=PN.exec(t))!=null;){var[,a]=r;t=t.replace(PN,Mk(a))}return t}function Ote(e){var t=e.replace(/\s+/g,"");return t=Ite(t),t=Mk(t),t}function Pte(e){try{return Ote(e)}catch{return _o}}function Fh(e){var t=Pte(e.slice(5,-1));return t===_o?"":t}var Rte=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Fte=["dx","dy","angle","className","breakAll"];function Ax(){return Ax=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ax.apply(null,arguments)}function RN(e,t){if(e==null)return{};var r,a,n=Lte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Lte(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Bk=/[ \f\n\r\t\v\u2028\u2029]+/,zk=e=>{var{children:t,breakAll:r,style:a}=e;try{var n=[];ms(t)||(r?n=t.toString().split(""):n=t.toString().split(Bk));var i=n.map(l=>({word:l,width:Kl(l,a).width})),o=r?0:Kl("",a).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}},Mte=(e,t,r,a,n)=>{var{maxLines:i,children:o,style:l,breakAll:c}=e,d=it(i),u=o,m=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return _.reduce((C,R)=>{var{word:M,width:U}=R,Z=C[C.length-1];if(Z&&(a==null||n||Z.width+U+r<Number(a)))Z.words.push(M),Z.width+=U+r;else{var ee={words:[M],width:U};C.push(ee)}return C},[])},f=m(t),h=O=>O.reduce((_,C)=>_.width>C.width?_:C);if(!d||n)return f;var p=f.length>i||h(f).width>Number(a);if(!p)return f;for(var x="",g=O=>{var _=u.slice(0,O),C=zk({breakAll:c,style:l,children:_+x}).wordsWithComputedWidth,R=m(C),M=R.length>i||h(R).width>Number(a);return[M,R]},b=0,j=u.length-1,y=0,w;b<=j&&y<=u.length-1;){var S=Math.floor((b+j)/2),N=S-1,[E,P]=g(N),[T]=g(S);if(!E&&!T&&(b=S+1),E&&T&&(j=S-1),!E&&T){w=P;break}y++}return w||f},FN=e=>{var t=ms(e)?[]:e.toString().split(Bk);return[{words:t}]},Bte=e=>{var{width:t,scaleToFit:r,children:a,style:n,breakAll:i,maxLines:o}=e;if((t||r)&&!xo.isSsr){var l,c,d=zk({breakAll:i,children:a,style:n});if(d){var{wordsWithComputedWidth:u,spaceWidth:m}=d;l=u,c=m}else return FN(a);return Mte({breakAll:i,children:a,maxLines:o,style:n},l,c,t,r)}return FN(a)},LN="#808080",Gm=v.forwardRef((e,t)=>{var{x:r=0,y:a=0,lineHeight:n="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:l="start",verticalAnchor:c="end",fill:d=LN}=e,u=RN(e,Rte),m=v.useMemo(()=>Bte({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:o,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,o,u.style,u.width]),{dx:f,dy:h,angle:p,className:x,breakAll:g}=u,b=RN(u,Fte);if(!fn(r)||!fn(a)||m.length===0)return null;var j=r+(it(f)?f:0),y=a+(it(h)?h:0),w;switch(c){case"start":w=Fh("calc(".concat(i,")"));break;case"middle":w=Fh("calc(".concat((m.length-1)/2," * -").concat(n," + (").concat(i," / 2))"));break;default:w=Fh("calc(".concat(m.length-1," * -").concat(n,")"));break}var S=[];if(o){var N=m[0].width,{width:E}=u;S.push("scale(".concat(it(E)?E/N:1,")"))}return p&&S.push("rotate(".concat(p,", ").concat(j,", ").concat(y,")")),S.length&&(b.transform=S.join(" ")),v.createElement("text",Ax({},ts(b,!0),{ref:t,x:j,y,className:Mt("recharts-text",x),textAnchor:l,fill:d.includes("url")?LN:d}),m.map((P,T)=>{var O=P.words.join(g?"":" ");return v.createElement("tspan",{x:j,dy:T===0?w:n,key:"".concat(O,"-").concat(T)},O)}))});Gm.displayName="Text";var zte=["labelRef"];function $te(e,t){if(e==null)return{};var r,a,n=Ute(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ute(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function MN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Lr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MN(Object(r),!0).forEach(function(a){Wte(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Wte(e,t,r){return(t=Hte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hte(e){var t=Vte(e,"string");return typeof t=="symbol"?t:t+""}function Vte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bn(){return bn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},bn.apply(null,arguments)}var $k=v.createContext(null),Gte=e=>{var{x:t,y:r,width:a,height:n,children:i}=e,o=v.useMemo(()=>({x:t,y:r,width:a,height:n}),[t,r,a,n]);return v.createElement($k.Provider,{value:o},i)},Uk=()=>{var e=v.useContext($k),t=ov();return e||t},qte=v.createContext(null),Kte=()=>{var e=v.useContext(qte),t=at(k_);return e||t},Yte=e=>{var{value:t,formatter:r}=e,a=ms(e.children)?t:e.children;return typeof r=="function"?r(a):a},y1=e=>e!=null&&typeof e=="function",Xte=(e,t)=>{var r=ds(t-e),a=Math.min(Math.abs(t-e),360);return r*a},Jte=(e,t,r,a,n)=>{var{offset:i,className:o}=e,{cx:l,cy:c,innerRadius:d,outerRadius:u,startAngle:m,endAngle:f,clockWise:h}=n,p=(d+u)/2,x=Xte(m,f),g=x>=0?1:-1,b,j;switch(t){case"insideStart":b=m+g*i,j=h;break;case"insideEnd":b=f-g*i,j=!h;break;case"end":b=f+g*i,j=h;break;default:throw new Error("Unsupported position ".concat(t))}j=x<=0?j:!j;var y=qr(l,c,p,b),w=qr(l,c,p,b+(j?1:-1)*359),S="M".concat(y.x,",").concat(y.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(j?0:1,`,
    `).concat(w.x,",").concat(w.y),N=ms(e.id)?hc("recharts-radial-line-"):e.id;return v.createElement("text",bn({},a,{dominantBaseline:"central",className:Mt("recharts-radial-bar-label",o)}),v.createElement("defs",null,v.createElement("path",{id:N,d:S})),v.createElement("textPath",{xlinkHref:"#".concat(N)},r))},Zte=(e,t,r)=>{var{cx:a,cy:n,innerRadius:i,outerRadius:o,startAngle:l,endAngle:c}=e,d=(l+c)/2;if(r==="outside"){var{x:u,y:m}=qr(a,n,o+t,d);return{x:u,y:m,textAnchor:u>=a?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:a,y:n,textAnchor:"middle",verticalAnchor:"end"};var f=(i+o)/2,{x:h,y:p}=qr(a,n,f,d);return{x:h,y:p,textAnchor:"middle",verticalAnchor:"middle"}},Wk=e=>"cx"in e&&it(e.cx),Qte=(e,t)=>{var{parentViewBox:r,offset:a,position:n}=e,i;r!=null&&!Wk(r)&&(i=r);var{x:o,y:l,width:c,height:d}=t,u=d>=0?1:-1,m=u*a,f=u>0?"end":"start",h=u>0?"start":"end",p=c>=0?1:-1,x=p*a,g=p>0?"end":"start",b=p>0?"start":"end";if(n==="top"){var j={x:o+c/2,y:l-u*a,textAnchor:"middle",verticalAnchor:f};return Lr(Lr({},j),i?{height:Math.max(l-i.y,0),width:c}:{})}if(n==="bottom"){var y={x:o+c/2,y:l+d+m,textAnchor:"middle",verticalAnchor:h};return Lr(Lr({},y),i?{height:Math.max(i.y+i.height-(l+d),0),width:c}:{})}if(n==="left"){var w={x:o-x,y:l+d/2,textAnchor:g,verticalAnchor:"middle"};return Lr(Lr({},w),i?{width:Math.max(w.x-i.x,0),height:d}:{})}if(n==="right"){var S={x:o+c+x,y:l+d/2,textAnchor:b,verticalAnchor:"middle"};return Lr(Lr({},S),i?{width:Math.max(i.x+i.width-S.x,0),height:d}:{})}var N=i?{width:c,height:d}:{};return n==="insideLeft"?Lr({x:o+x,y:l+d/2,textAnchor:b,verticalAnchor:"middle"},N):n==="insideRight"?Lr({x:o+c-x,y:l+d/2,textAnchor:g,verticalAnchor:"middle"},N):n==="insideTop"?Lr({x:o+c/2,y:l+m,textAnchor:"middle",verticalAnchor:h},N):n==="insideBottom"?Lr({x:o+c/2,y:l+d-m,textAnchor:"middle",verticalAnchor:f},N):n==="insideTopLeft"?Lr({x:o+x,y:l+m,textAnchor:b,verticalAnchor:h},N):n==="insideTopRight"?Lr({x:o+c-x,y:l+m,textAnchor:g,verticalAnchor:h},N):n==="insideBottomLeft"?Lr({x:o+x,y:l+d-m,textAnchor:b,verticalAnchor:f},N):n==="insideBottomRight"?Lr({x:o+c-x,y:l+d-m,textAnchor:g,verticalAnchor:f},N):n&&typeof n=="object"&&(it(n.x)||Di(n.x))&&(it(n.y)||Di(n.y))?Lr({x:o+Fs(n.x,c),y:l+Fs(n.y,d),textAnchor:"end",verticalAnchor:"end"},N):Lr({x:o+c/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},N)},ere={offset:5};function Zn(e){var t=qs(e,ere),{viewBox:r,position:a,value:n,children:i,content:o,className:l="",textBreakAll:c,labelRef:d}=t,u=Kte(),m=Uk(),f=a==="center"?m:u??m,h=r||f;if(!h||ms(n)&&ms(i)&&!v.isValidElement(o)&&typeof o!="function")return null;var p=Lr(Lr({},t),{},{viewBox:h});if(v.isValidElement(o)){var{labelRef:x}=p,g=$te(p,zte);return v.cloneElement(o,g)}var b;if(typeof o=="function"){if(b=v.createElement(o,p),v.isValidElement(b))return b}else b=Yte(t);var j=Wk(h),y=ts(t,!0);if(j&&(a==="insideStart"||a==="insideEnd"||a==="end"))return Jte(t,a,b,y,h);var w=j?Zte(h,t.offset,t.position):Qte(t,h);return v.createElement(Gm,bn({ref:d,className:Mt("recharts-label",l)},y,w,{breakAll:c}),b)}Zn.displayName="Label";var tre=(e,t,r)=>{if(!e)return null;var a={viewBox:t,labelRef:r};return e===!0?v.createElement(Zn,bn({key:"label-implicit"},a)):fn(e)?v.createElement(Zn,bn({key:"label-implicit",value:e},a)):v.isValidElement(e)?e.type===Zn?v.cloneElement(e,Lr({key:"label-implicit"},a)):v.createElement(Zn,bn({key:"label-implicit",content:e},a)):y1(e)?v.createElement(Zn,bn({key:"label-implicit",content:e},a)):e&&typeof e=="object"?v.createElement(Zn,bn({},e,{key:"label-implicit"},a)):null};function rre(e){var{label:t}=e,r=Uk();return tre(t,r)||null}var Lh={},Mh={},BN;function sre(){return BN||(BN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Mh)),Mh}var Bh={},zN;function are(){return zN||(zN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Bh)),Bh}var $N;function nre(){return $N||($N=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sre(),r=are(),a=Jg();function n(i){if(a.isArrayLike(i))return t.last(r.toArray(i))}e.last=n})(Lh)),Lh}var zh,UN;function ire(){return UN||(UN=1,zh=nre().last),zh}var ore=ire();const lre=mi(ore);var cre=["valueAccessor"],dre=["dataKey","clockWise","id","textBreakAll"];function $u(){return $u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},$u.apply(null,arguments)}function WN(e,t){if(e==null)return{};var r,a,n=ure(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ure(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var mre=e=>Array.isArray(e.value)?lre(e.value):e.value,Hk=v.createContext(void 0),fre=Hk.Provider,Vk=v.createContext(void 0),hre=Vk.Provider;function pre(){return v.useContext(Hk)}function xre(){return v.useContext(Vk)}function Vd(e){var{valueAccessor:t=mre}=e,r=WN(e,cre),{dataKey:a,clockWise:n,id:i,textBreakAll:o}=r,l=WN(r,dre),c=pre(),d=xre(),u=c||d;return!u||!u.length?null:v.createElement(sa,{className:"recharts-label-list"},u.map((m,f)=>{var h,p=ms(a)?t(m,f):Cr(m&&m.payload,a),x=ms(i)?{}:{id:"".concat(i,"-").concat(f)};return v.createElement(Zn,$u({},ts(m,!0),l,x,{fill:(h=r.fill)!==null&&h!==void 0?h:m.fill,parentViewBox:m.parentViewBox,value:p,textBreakAll:o,viewBox:m.viewBox,key:"label-".concat(f),index:f}))}))}Vd.displayName="LabelList";function Gk(e){var{label:t}=e;return t?t===!0?v.createElement(Vd,{key:"labelList-implicit"}):v.isValidElement(t)||y1(t)?v.createElement(Vd,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(Vd,$u({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var qk=e=>e.graphicalItems.polarItems,gre=we([yr,Yc],qv),b1=we([qk,Ur,gre],Yv),vre=we([b1],Xv),j1=we([vre,Rv],Jv),yre=we([j1,Ur,b1],Qv),bre=we([j1,Ur,b1],(e,t,r)=>r.length>0?e.flatMap(a=>r.flatMap(n=>{var i,o=Cr(a,(i=t.dataKey)!==null&&i!==void 0?i:n.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:Cr(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]}))),HN=()=>{},jre=we([Ur,X_,HN,bre,HN,Kt,yr],t1),Kk=we([Ur,Kt,j1,yre,Kc,yr,jre],r1),wre=we([Kk,Ur,fl],n1);we([Ur,Kk,wre,yr],o1);var Nre={radiusAxis:{},angleAxis:{}},Yk=ba({name:"polarAxis",initialState:Nre,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:cde,removeRadiusAxis:dde,addAngleAxis:ude,removeAngleAxis:mde}=Yk.actions,Sre=Yk.reducer;function VN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function GN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VN(Object(r),!0).forEach(function(a){Ere(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Ere(e,t,r){return(t=Tre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tre(e){var t=Cre(e,"string");return typeof t=="symbol"?t:t+""}function Cre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Are=(e,t)=>t,w1=we([qk,Are],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),_re=[],N1=(e,t,r)=>r?.length===0?_re:r,Xk=we([Rv,w1,N1],(e,t,r)=>{var{chartData:a}=e;if(t!=null){var n;if(t?.data!=null&&t.data.length>0?n=t.data:n=a,(!n||!n.length)&&r!=null&&(n=r.map(i=>GN(GN({},t.presentationProps),i.props))),n!=null)return n}}),kre=we([Xk,w1,N1],(e,t,r)=>{if(!(e==null||t==null))return e.map((a,n)=>{var i,o=Cr(a,t.nameKey,t.name),l;return r!=null&&(i=r[n])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[n].props.fill:typeof a=="object"&&a!=null&&"fill"in a?l=a.fill:l=t.fill,{value:Sm(o,t.dataKey),color:l,payload:a,type:t.legendType}})}),Dre=we([Xk,w1,N1,ss],(e,t,r,a)=>{if(!(t==null||e==null))return kse({offset:a,pieSettings:t,displayedData:e,cells:r})}),$h={},qN;function Ire(){return qN||(qN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${n}]`}let a=r;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(r)===a}e.isPlainObject=t})($h)),$h}var Uh,KN;function Ore(){return KN||(KN=1,Uh=Ire().isPlainObject),Uh}var Pre=Ore();const Rre=mi(Pre);function YN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function XN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YN(Object(r),!0).forEach(function(a){Fre(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Fre(e,t,r){return(t=Lre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lre(e){var t=Mre(e,"string");return typeof t=="symbol"?t:t+""}function Mre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Uu.apply(null,arguments)}var JN=(e,t,r,a,n)=>{var i=r-a,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-i/2,",").concat(t+n),o+="L ".concat(e+r-i/2-a,",").concat(t+n),o+="L ".concat(e,",").concat(t," Z"),o},Bre={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zre=e=>{var t=qs(e,Bre),{x:r,y:a,upperWidth:n,lowerWidth:i,height:o,className:l}=t,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:m}=t,f=v.useRef(),[h,p]=v.useState(-1),x=v.useRef(n),g=v.useRef(i),b=v.useRef(o),j=v.useRef(r),y=v.useRef(a),w=km(e,"trapezoid-");if(v.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var M=f.current.getTotalLength();M&&p(M)}catch{}},[]),r!==+r||a!==+a||n!==+n||i!==+i||o!==+o||n===0&&i===0||o===0)return null;var S=Mt("recharts-trapezoid",l);if(!m)return v.createElement("g",null,v.createElement("path",Uu({},ts(t,!0),{className:S,d:JN(r,a,n,i,o)})));var N=x.current,E=g.current,P=b.current,T=j.current,O=y.current,_="0px ".concat(h===-1?1:h,"px"),C="".concat(h,"px 0px"),R=bA(["strokeDasharray"],d,c);return v.createElement(_m,{animationId:w,key:w,canBegin:h>0,duration:d,easing:c,isActive:m,begin:u},M=>{var U=ys(N,n,M),Z=ys(E,i,M),ee=ys(P,o,M),re=ys(T,r,M),z=ys(O,a,M);f.current&&(x.current=U,g.current=Z,b.current=ee,j.current=re,y.current=z);var me=M>0?{transition:R,strokeDasharray:C}:{strokeDasharray:_};return v.createElement("path",Uu({},ts(t,!0),{className:S,d:JN(re,z,U,Z,ee),ref:f,style:XN(XN({},me),t.style)}))})},$re=["option","shapeType","propTransformer","activeClassName","isActive"];function Ure(e,t){if(e==null)return{};var r,a,n=Wre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Wre(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function ZN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Wu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZN(Object(r),!0).forEach(function(a){Hre(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZN(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Hre(e,t,r){return(t=Vre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vre(e){var t=Gre(e,"string");return typeof t=="symbol"?t:t+""}function Gre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qre(e,t){return Wu(Wu({},t),e)}function Kre(e,t){return e==="symbols"}function QN(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement(SA,r);case"trapezoid":return v.createElement(zre,r);case"sector":return v.createElement(CA,r);case"symbols":if(Kre(t))return v.createElement(Kg,r);break;default:return null}}function Yre(e){return v.isValidElement(e)?e.props:e}function Jk(e){var{option:t,shapeType:r,propTransformer:a=qre,activeClassName:n="recharts-active-shape",isActive:i}=e,o=Ure(e,$re),l;if(v.isValidElement(t))l=v.cloneElement(t,Wu(Wu({},o),Yre(t)));else if(typeof t=="function")l=t(o);else if(Rre(t)&&typeof t!="boolean"){var c=a(t,o);l=v.createElement(QN,{shapeType:r,elementProps:c})}else{var d=o;l=v.createElement(QN,{shapeType:r,elementProps:d})}return i?v.createElement(sa,{className:n},l):l}var S1=(e,t)=>{var r=kr();return(a,n)=>i=>{e?.(a,n,i),r(mk({activeIndex:String(n),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}},E1=e=>{var t=kr();return(r,a)=>n=>{e?.(r,a,n),t(DQ())}},T1=(e,t)=>{var r=kr();return(a,n)=>i=>{e?.(a,n,i),r(IQ({activeIndex:String(n),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}};function Zk(e){var{fn:t,args:r}=e,a=kr(),n=$a();return v.useEffect(()=>{if(!n){var i=t(r);return a(AQ(i)),()=>{a(_Q(i))}}},[t,r,a,n]),null}var Qk=()=>{};function Xre(e){var{legendPayload:t}=e,r=kr(),a=$a();return v.useEffect(()=>a?Qk:(r(xA(t)),()=>{r(gA(t))}),[r,a,t]),null}function Jre(e){var{legendPayload:t}=e,r=kr(),a=at(Kt);return v.useEffect(()=>a!=="centric"&&a!=="radial"?Qk:(r(xA(t)),()=>{r(gA(t))}),[r,a,t]),null}var Wh,Zre=()=>{var[e]=v.useState(()=>hc("uid-"));return e},Qre=(Wh=z5.useId)!==null&&Wh!==void 0?Wh:Zre;function ese(e,t){var r=Qre();return t||(e?"".concat(e,"-").concat(r):r)}var tse=v.createContext(void 0),e5=e=>{var{id:t,type:r,children:a}=e,n=ese("recharts-".concat(r),t);return v.createElement(tse.Provider,{value:n},a(n))},rse={cartesianItems:[],polarItems:[]},t5=ba({name:"graphicalItems",initialState:rse,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:a}=t.payload,n=Cn(e).cartesianItems.indexOf(r);n>-1&&(e.cartesianItems[n]=a)},removeCartesianGraphicalItem(e,t){var r=Cn(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Cn(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:sse,replaceCartesianGraphicalItem:ase,removeCartesianGraphicalItem:nse,addPolarGraphicalItem:ise,removePolarGraphicalItem:ose}=t5.actions,lse=t5.reducer;function cse(e){var t=kr(),r=v.useRef(null);return v.useEffect(()=>{r.current===null?t(sse(e)):r.current!==e&&t(ase({prev:r.current,next:e})),r.current=e},[t,e]),v.useEffect(()=>()=>{r.current&&(t(nse(r.current)),r.current=null)},[t]),null}function dse(e){var t=kr();return v.useEffect(()=>(t(ise(e)),()=>{t(ose(e))}),[t,e]),null}var use=["onMouseEnter","onClick","onMouseLeave"],mse=["id"],fse=["id"];function C1(e,t){if(e==null)return{};var r,a,n=hse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function hse(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function e2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function xr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e2(Object(r),!0).forEach(function(a){pse(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function pse(e,t,r){return(t=xse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xse(e){var t=gse(e,"string");return typeof t=="symbol"?t:t+""}function gse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function di(){return di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},di.apply(null,arguments)}function vse(e){var t=v.useMemo(()=>Wg(e.children,td),[e.children]),r=at(a=>kre(a,e.id,t));return r==null?null:v.createElement(Jre,{legendPayload:r})}function yse(e){var{dataKey:t,nameKey:r,sectors:a,stroke:n,strokeWidth:i,fill:o,name:l,hide:c,tooltipType:d}=e;return{dataDefinedOnItem:a.map(u=>u.tooltipPayload),positions:a.map(u=>u.tooltipPosition),settings:{stroke:n,strokeWidth:i,fill:o,dataKey:t,nameKey:r,name:Sm(l,t),hide:c,type:d,color:o,unit:""}}}var bse=(e,t)=>e>t?"start":e<t?"end":"middle",jse=(e,t,r)=>Fs(typeof t=="function"?t(e):t,r,r*.8),wse=(e,t,r)=>{var{top:a,left:n,width:i,height:o}=t,l=oA(i,o),c=n+Fs(e.cx,i,i/2),d=a+Fs(e.cy,o,o/2),u=Fs(e.innerRadius,l,0),m=jse(r,e.outerRadius,l),f=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:c,cy:d,innerRadius:u,outerRadius:m,maxRadius:f}},Nse=(e,t)=>{var r=ds(t-e),a=Math.min(Math.abs(t-e),360);return r*a};function Sse(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var Ese=(e,t)=>{if(v.isValidElement(e))return v.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Mt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return v.createElement(yA,di({},t,{type:"linear",className:r}))},Tse=(e,t,r)=>{if(v.isValidElement(e))return v.cloneElement(e,t);var a=r;if(typeof e=="function"&&(a=e(t),v.isValidElement(a)))return a;var n=Mt("recharts-pie-label-text",Sse(e));return v.createElement(Gm,di({},t,{alignmentBaseline:"middle",className:n}),a)};function Cse(e){var{sectors:t,props:r,showLabels:a}=e,{label:n,labelLine:i,dataKey:o}=r;if(!a||!n||!t)return null;var l=gi(r),c=ts(n,!1),d=ts(i,!1),u=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,m=t.map((f,h)=>{var p=(f.startAngle+f.endAngle)/2,x=qr(f.cx,f.cy,f.outerRadius+u,p),g=xr(xr(xr(xr({},l),f),{},{stroke:"none"},c),{},{index:h,textAnchor:bse(x.x,f.cx)},x),b=xr(xr(xr(xr({},l),f),{},{fill:"none",stroke:f.fill},d),{},{index:h,points:[qr(f.cx,f.cy,f.outerRadius,p),x],key:"line"});return v.createElement(sa,{key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(h)},i&&Ese(i,b),Tse(n,g,Cr(f,o)))});return v.createElement(sa,{className:"recharts-pie-labels"},m)}function Ase(e){var{sectors:t,props:r,showLabels:a}=e,{label:n}=r;return typeof n=="object"&&n!=null&&"position"in n?v.createElement(Gk,{label:n}):v.createElement(Cse,{sectors:t,props:r,showLabels:a})}function _se(e){var{sectors:t,activeShape:r,inactiveShape:a,allOtherPieProps:n}=e,i=at(no),{onMouseEnter:o,onClick:l,onMouseLeave:c}=n,d=C1(n,use),u=S1(o,n.dataKey),m=E1(c),f=T1(l,n.dataKey);return t==null||t.length===0?null:v.createElement(v.Fragment,null,t.map((h,p)=>{if(h?.startAngle===0&&h?.endAngle===0&&t.length!==1)return null;var x=r&&String(p)===i,g=i?a:null,b=x?r:g,j=xr(xr({},h),{},{stroke:h.stroke,tabIndex:-1,[mA]:p,[fA]:n.dataKey});return v.createElement(sa,di({tabIndex:-1,className:"recharts-pie-sector"},zc(d,h,p),{onMouseEnter:u(h,p),onMouseLeave:m(h,p),onClick:f(h,p),key:"sector-".concat(h?.startAngle,"-").concat(h?.endAngle,"-").concat(h.midAngle,"-").concat(p)}),v.createElement(Jk,di({option:b,isActive:x,shapeType:"sector"},j)))}))}function kse(e){var t,{pieSettings:r,displayedData:a,cells:n,offset:i}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:d,nameKey:u,tooltipType:m}=r,f=Math.abs(r.minAngle),h=Nse(l,c),p=Math.abs(h),x=a.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=a.filter(N=>Cr(N,d,0)!==0).length,b=(p>=360?g:g-1)*x,j=p-g*f-b,y=a.reduce((N,E)=>{var P=Cr(E,d,0);return N+(it(P)?P:0)},0),w;if(y>0){var S;w=a.map((N,E)=>{var P=Cr(N,d,0),T=Cr(N,u,E),O=wse(r,i,N),_=(it(P)?P:0)/y,C,R=xr(xr({},N),n&&n[E]&&n[E].props);E?C=S.endAngle+ds(h)*x*(P!==0?1:0):C=l;var M=C+ds(h)*((P!==0?f:0)+_*j),U=(C+M)/2,Z=(O.innerRadius+O.outerRadius)/2,ee=[{name:T,value:P,payload:R,dataKey:d,type:m}],re=qr(O.cx,O.cy,Z,U);return S=xr(xr(xr(xr({},r.presentationProps),{},{percent:_,cornerRadius:o,name:T,tooltipPayload:ee,midAngle:U,middleRadius:Z,tooltipPosition:re},R),O),{},{value:P,startAngle:C,endAngle:M,payload:R,paddingAngle:ds(h)*x}),S})}return w}function Dse(e){var{showLabels:t,sectors:r,children:a}=e,n=v.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return v.createElement(hre,{value:t?n:void 0},a)}function Ise(e){var{props:t,previousSectorsRef:r}=e,{sectors:a,isAnimationActive:n,animationBegin:i,animationDuration:o,animationEasing:l,activeShape:c,inactiveShape:d,onAnimationStart:u,onAnimationEnd:m}=t,f=km(t,"recharts-pie-"),h=r.current,[p,x]=v.useState(!1),g=v.useCallback(()=>{typeof m=="function"&&m(),x(!1)},[m]),b=v.useCallback(()=>{typeof u=="function"&&u(),x(!0)},[u]);return v.createElement(Dse,{showLabels:!p,sectors:a},v.createElement(_m,{animationId:f,begin:i,duration:o,isActive:n,easing:l,onAnimationStart:b,onAnimationEnd:g,key:f},j=>{var y=[],w=a&&a[0],S=w?.startAngle;return a?.forEach((N,E)=>{var P=h&&h[E],T=E>0?to(N,"paddingAngle",0):0;if(P){var O=ys(P.endAngle-P.startAngle,N.endAngle-N.startAngle,j),_=xr(xr({},N),{},{startAngle:S+T,endAngle:S+O+T});y.push(_),S=_.endAngle}else{var{endAngle:C,startAngle:R}=N,M=ys(0,C-R,j),U=xr(xr({},N),{},{startAngle:S+T,endAngle:S+M+T});y.push(U),S=U.endAngle}}),r.current=y,v.createElement(sa,null,v.createElement(_se,{sectors:y,activeShape:c,inactiveShape:d,allOtherPieProps:t}))}),v.createElement(Ase,{showLabels:!p,sectors:a,props:t}),t.children)}var Ose={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!xo.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function Pse(e){var{id:t}=e,r=C1(e,mse),{hide:a,className:n,rootTabIndex:i}=e,o=v.useMemo(()=>Wg(e.children,td),[e.children]),l=at(u=>Dre(u,t,o)),c=v.useRef(null),d=Mt("recharts-pie",n);return a||l==null?(c.current=null,v.createElement(sa,{tabIndex:i,className:d})):v.createElement(v.Fragment,null,v.createElement(Zk,{fn:yse,args:xr(xr({},e),{},{sectors:l})}),v.createElement(sa,{tabIndex:i,className:d},v.createElement(Ise,{props:xr(xr({},r),{},{sectors:l}),previousSectorsRef:c})))}function r5(e){var t=qs(e,Ose),{id:r}=t,a=C1(t,fse),n=gi(a);return v.createElement(e5,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(dse,{type:"pie",id:i,data:a.data,dataKey:a.dataKey,hide:a.hide,angleAxisId:0,radiusAxisId:0,name:a.name,nameKey:a.nameKey,tooltipType:a.tooltipType,legendType:a.legendType,fill:a.fill,cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,paddingAngle:a.paddingAngle,minAngle:a.minAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius,cornerRadius:a.cornerRadius,presentationProps:n,maxRadius:t.maxRadius}),v.createElement(vse,di({},a,{id:i})),v.createElement(Pse,di({},a,{id:i}))))}r5.displayName="Pie";function t2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function r2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t2(Object(r),!0).forEach(function(a){Rse(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Rse(e,t,r){return(t=Fse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fse(e){var t=Lse(e,"string");return typeof t=="symbol"?t:t+""}function Lse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mse={xAxis:{},yAxis:{},zAxis:{}},s5=ba({name:"cartesianAxis",initialState:Mse,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:a}=t.payload;e.yAxis[r]&&(e.yAxis[r]=r2(r2({},e.yAxis[r]),{},{width:a}))}}}),{addXAxis:Bse,removeXAxis:zse,addYAxis:$se,removeYAxis:Use,addZAxis:fde,removeZAxis:hde,updateYAxisWidth:Wse}=s5.actions,Hse=s5.reducer,Vse=we([ss],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),Gse=we([Vse,zn,$n],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),a5=()=>at(Gse),qse="Invariant failed";function Kse(e,t){throw new Error(qse)}var Yse=["x","y"];function _x(){return _x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},_x.apply(null,arguments)}function s2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Dl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s2(Object(r),!0).forEach(function(a){Xse(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Xse(e,t,r){return(t=Jse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jse(e){var t=Zse(e,"string");return typeof t=="symbol"?t:t+""}function Zse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qse(e,t){if(e==null)return{};var r,a,n=eae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function eae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function tae(e,t){var{x:r,y:a}=e,n=Qse(e,Yse),i="".concat(r),o=parseInt(i,10),l="".concat(a),c=parseInt(l,10),d="".concat(t.height||n.height),u=parseInt(d,10),m="".concat(t.width||n.width),f=parseInt(m,10);return Dl(Dl(Dl(Dl(Dl({},t),n),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function A1(e){return v.createElement(Jk,_x({shapeType:"rectangle",propTransformer:tae,activeClassName:"recharts-active-bar"},e))}var rae=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,n)=>{if(it(t))return t;var i=it(a)||ms(a);return i?t(a,n):(i||Kse(),r)}},sae={},n5=ba({name:"errorBars",initialState:sae,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]||(e[r]=[]),e[r].push(a)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:a,next:n}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===a.dataKey&&i.direction===a.direction?n:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]&&(e[r]=e[r].filter(n=>n.dataKey!==a.dataKey||n.direction!==a.direction))}}}),{addErrorBar:pde,replaceErrorBar:xde,removeErrorBar:gde}=n5.actions,aae=n5.reducer,nae=["children"];function iae(e,t){if(e==null)return{};var r,a,n=oae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var lae={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},cae=v.createContext(lae);function dae(e){var{children:t}=e,r=iae(e,nae);return v.createElement(cae.Provider,{value:r},t)}function i5(e,t){var r,a,n=at(d=>Wn(d,e)),i=at(d=>Hn(d,t)),o=(r=n?.allowDataOverflow)!==null&&r!==void 0?r:aa.allowDataOverflow,l=(a=i?.allowDataOverflow)!==null&&a!==void 0?a:na.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function uae(e){var{xAxisId:t,yAxisId:r,clipPathId:a}=e,n=a5(),{needClipX:i,needClipY:o,needClip:l}=i5(t,r);if(!l)return null;var{x:c,y:d,width:u,height:m}=n;return v.createElement("clipPath",{id:"clipPath-".concat(a)},v.createElement("rect",{x:i?c:c-u/2,y:o?d:d-m/2,width:i?u:u*2,height:o?m:m*2}))}var mae=["onMouseEnter","onMouseLeave","onClick"],fae=["value","background","tooltipPosition"],hae=["id"],pae=["onMouseEnter","onClick","onMouseLeave"];function ui(){return ui=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ui.apply(null,arguments)}function a2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Us(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a2(Object(r),!0).forEach(function(a){xae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function xae(e,t,r){return(t=gae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gae(e){var t=vae(e,"string");return typeof t=="symbol"?t:t+""}function vae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hu(e,t){if(e==null)return{};var r,a,n=yae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yae(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var bae=e=>{var{dataKey:t,name:r,fill:a,legendType:n,hide:i}=e;return[{inactive:i,dataKey:t,type:n,color:a,value:Sm(r,t),payload:e}]};function jae(e){var{dataKey:t,stroke:r,strokeWidth:a,fill:n,name:i,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:n,dataKey:t,nameKey:void 0,name:Sm(i,t),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function wae(e){var t=at(no),{data:r,dataKey:a,background:n,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=i,d=Hu(i,mae),u=S1(o,a),m=E1(l),f=T1(c,a);if(!n||r==null)return null;var h=ts(n,!1);return v.createElement(v.Fragment,null,r.map((p,x)=>{var{value:g,background:b,tooltipPosition:j}=p,y=Hu(p,fae);if(!b)return null;var w=u(p,x),S=m(p,x),N=f(p,x),E=Us(Us(Us(Us(Us({option:n,isActive:String(x)===t},y),{},{fill:"#eee"},b),h),zc(d,p,x)),{},{onMouseEnter:w,onMouseLeave:S,onClick:N,dataKey:a,index:x,className:"recharts-bar-background-rectangle"});return v.createElement(A1,ui({key:"background-bar-".concat(E.index)},E))}))}function Nae(e){var{showLabels:t,children:r,rects:a}=e,n=a?.map(i=>{var o={x:i.x,y:i.y,width:i.width,height:i.height};return Us(Us({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return v.createElement(fre,{value:t?n:void 0},r)}function Sae(e){var{shape:t,activeBar:r,baseProps:a,entry:n,index:i,dataKey:o}=e,l=at(no),c=at(Ek),d=r&&String(i)===l&&(c==null||o===c),u=d?r:t;return v.createElement(A1,ui({},a,n,{isActive:d,option:u,index:i,dataKey:o}))}function Eae(e){var{shape:t,baseProps:r,entry:a,index:n,dataKey:i}=e;return v.createElement(A1,ui({},r,a,{isActive:!1,option:t,index:n,dataKey:i}))}function Tae(e){var{data:t,props:r}=e,a=gi(r),{id:n}=a,i=Hu(a,hae),{shape:o,dataKey:l,activeBar:c}=r,{onMouseEnter:d,onClick:u,onMouseLeave:m}=r,f=Hu(r,pae),h=S1(d,l),p=E1(m),x=T1(u,l);return t?v.createElement(v.Fragment,null,t.map((g,b)=>v.createElement(sa,ui({className:"recharts-bar-rectangle"},zc(f,g,b),{onMouseEnter:h(g,b),onMouseLeave:p(g,b),onClick:x(g,b),key:"rectangle-".concat(g?.x,"-").concat(g?.y,"-").concat(g?.value,"-").concat(b)}),c?v.createElement(Sae,{shape:o,activeBar:c,baseProps:i,entry:g,index:b,dataKey:l}):v.createElement(Eae,{shape:o,baseProps:i,entry:g,index:b,dataKey:l})))):null}function Cae(e){var{props:t,previousRectanglesRef:r}=e,{data:a,layout:n,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,m=r.current,f=km(t,"recharts-bar-"),[h,p]=v.useState(!1),x=!h,g=v.useCallback(()=>{typeof d=="function"&&d(),p(!1)},[d]),b=v.useCallback(()=>{typeof u=="function"&&u(),p(!0)},[u]);return v.createElement(Nae,{showLabels:x,rects:a},v.createElement(_m,{animationId:f,begin:o,duration:l,isActive:i,easing:c,onAnimationEnd:g,onAnimationStart:b,key:f},j=>{var y=j===1?a:a?.map((w,S)=>{var N=m&&m[S];if(N)return Us(Us({},w),{},{x:ys(N.x,w.x,j),y:ys(N.y,w.y,j),width:ys(N.width,w.width,j),height:ys(N.height,w.height,j)});if(n==="horizontal"){var E=ys(0,w.height,j);return Us(Us({},w),{},{y:w.y+w.height-E,height:E})}var P=ys(0,w.width,j);return Us(Us({},w),{},{width:P})});return j>0&&(r.current=y??null),y==null?null:v.createElement(sa,null,v.createElement(Tae,{props:t,data:y}))}),v.createElement(Gk,{label:t.label}),t.children)}function Aae(e){var t=v.useRef(null);return v.createElement(Cae,{previousRectanglesRef:t,props:e})}var o5=0,_ae=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Cr(e,t)}};class kae extends v.PureComponent{render(){var{hide:t,data:r,dataKey:a,className:n,xAxisId:i,yAxisId:o,needClip:l,background:c,id:d}=this.props;if(t||r==null)return null;var u=Mt("recharts-bar",n),m=d;return v.createElement(sa,{className:u,id:d},l&&v.createElement("defs",null,v.createElement(uae,{clipPathId:m,xAxisId:i,yAxisId:o})),v.createElement(sa,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(m,")"):void 0},v.createElement(wae,{data:r,dataKey:a,background:c,allOtherBarProps:this.props}),v.createElement(Aae,this.props)))}}var Dae={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!xo.isSsr,legendType:"rect",minPointSize:o5,xAxisId:0,yAxisId:0};function Iae(e){var{xAxisId:t,yAxisId:r,hide:a,legendType:n,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u}=e,{needClip:m}=i5(t,r),f=dv(),h=$a(),p=Wg(e.children,td),x=at(j=>ine(j,t,r,h,e.id,p));if(f!=="vertical"&&f!=="horizontal")return null;var g,b=x?.[0];return b==null||b.height==null||b.width==null?g=0:g=f==="vertical"?b.height/2:b.width/2,v.createElement(dae,{xAxisId:t,yAxisId:r,data:x,dataPointFormatter:_ae,errorBarOffset:g},v.createElement(kae,ui({},e,{layout:f,needClip:m,data:x,xAxisId:t,yAxisId:r,hide:a,legendType:n,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u})))}function Oae(e){var{layout:t,barSettings:{dataKey:r,minPointSize:a},pos:n,bandSize:i,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:u,displayedData:m,offset:f,cells:h,parentViewBox:p}=e,x=t==="horizontal"?l:o,g=u?x.scale.domain():null,b=qq({numericAxis:x});return m.map((j,y)=>{var w,S,N,E,P,T;u?w=$q(u[y],g):(w=Cr(j,r),Array.isArray(w)||(w=[b,w]));var O=rae(a,o5)(w[1],y);if(t==="horizontal"){var _,[C,R]=[l.scale(w[0]),l.scale(w[1])];S=Vj({axis:o,ticks:c,bandSize:i,offset:n.offset,entry:j,index:y}),N=(_=R??C)!==null&&_!==void 0?_:void 0,E=n.size;var M=C-R;if(P=xa(M)?0:M,T={x:S,y:f.top,width:E,height:f.height},Math.abs(O)>0&&Math.abs(P)<Math.abs(O)){var U=ds(P||O)*(Math.abs(O)-Math.abs(P));N-=U,P+=U}}else{var[Z,ee]=[o.scale(w[0]),o.scale(w[1])];if(S=Z,N=Vj({axis:l,ticks:d,bandSize:i,offset:n.offset,entry:j,index:y}),E=ee-Z,P=n.size,T={x:f.left,y:N,width:f.width,height:P},Math.abs(O)>0&&Math.abs(E)<Math.abs(O)){var re=ds(E||O)*(Math.abs(O)-Math.abs(E));E+=re}}if(S==null||N==null||E==null||P==null)return null;var z=Us(Us({},j),{},{x:S,y:N,width:E,height:P,value:u?w:w[1],payload:j,background:T,tooltipPosition:{x:S+E/2,y:N+P/2},parentViewBox:p},h&&h[y]&&h[y].props);return z}).filter(Boolean)}function Pae(e){var t=qs(e,Dae),r=$a();return v.createElement(e5,{id:t.id,type:"bar"},a=>v.createElement(v.Fragment,null,v.createElement(Xre,{legendPayload:bae(t)}),v.createElement(Zk,{fn:jae,args:t}),v.createElement(cse,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:Gq(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),v.createElement(Iae,ui({},t,{id:a}))))}var Ml=v.memo(Pae);Ml.displayName="Bar";function n2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ld(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n2(Object(r),!0).forEach(function(a){Rae(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Rae(e,t,r){return(t=Fae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fae(e){var t=Lae(e,"string");return typeof t=="symbol"?t:t+""}function Lae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mae=(e,t)=>t,Bae=(e,t,r)=>r,zae=(e,t,r,a)=>a,$ae=(e,t,r,a,n)=>n,rd=we([Kv,$ae],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),Uae=we([rd],e=>e?.maxBarSize),Wae=(e,t,r,a,n,i)=>i,i2=(e,t,r)=>{var a=r??e;if(!ms(a))return Fs(a,t,0)},Hae=we([Kt,Kv,Mae,Bae,zae],(e,t,r,a,n)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===a).filter(i=>i.isPanorama===n).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),Vae=(e,t,r,a)=>{var n=Kt(e);return n==="horizontal"?Nx(e,"yAxis",r,a):Nx(e,"xAxis",t,a)},Gae=(e,t,r)=>{var a=Kt(e);return a==="horizontal"?lN(e,"xAxis",t):lN(e,"yAxis",r)},qae=(e,t,r)=>{var a={},n=e.filter(zm),i=e.filter(d=>d.stackId==null),o=n.reduce((d,u)=>(d[u.stackId]||(d[u.stackId]=[]),d[u.stackId].push(u),d),a),l=Object.entries(o).map(d=>{var[u,m]=d,f=m.map(p=>p.dataKey),h=i2(t,r,m[0].barSize);return{stackId:u,dataKeys:f,barSize:h}}),c=i.map(d=>{var u=[d.dataKey].filter(f=>f!=null),m=i2(t,r,d.barSize);return{stackId:void 0,dataKeys:u,barSize:m}});return[...l,...c]},Kae=we([Hae,CZ,Gae],qae),Yae=(e,t,r,a,n)=>{var i,o,l=rd(e,t,r,a,n);if(l!=null){var c=Kt(e),d=N_(e),{maxBarSize:u}=l,m=ms(u)?d:u,f,h;return c==="horizontal"?(f=Zo(e,"xAxis",t,a),h=Jo(e,"xAxis",t,a)):(f=Zo(e,"yAxis",r,a),h=Jo(e,"yAxis",r,a)),(i=(o=nv(f,h,!0))!==null&&o!==void 0?o:m)!==null&&i!==void 0?i:0}},l5=(e,t,r,a)=>{var n=Kt(e),i,o;return n==="horizontal"?(i=Zo(e,"xAxis",t,a),o=Jo(e,"xAxis",t,a)):(i=Zo(e,"yAxis",r,a),o=Jo(e,"yAxis",r,a)),nv(i,o)};function Xae(e,t,r,a,n){var i=a.length;if(!(i<1)){var o=Fs(e,r,0,!0),l,c=[];if(va(a[0].barSize)){var d=!1,u=r/i,m=a.reduce((b,j)=>b+(j.barSize||0),0);m+=(i-1)*o,m>=r&&(m-=(i-1)*o,o=0),m>=r&&u>0&&(d=!0,u*=.9,m=i*u);var f=(r-m)/2>>0,h={offset:f-o,size:0};l=a.reduce((b,j)=>{var y,w={stackId:j.stackId,dataKeys:j.dataKeys,position:{offset:h.offset+h.size+o,size:d?u:(y=j.barSize)!==null&&y!==void 0?y:0}},S=[...b,w];return h=S[S.length-1].position,S},c)}else{var p=Fs(t,r,0,!0);r-2*p-(i-1)*o<=0&&(o=0);var x=(r-2*p-(i-1)*o)/i;x>1&&(x>>=0);var g=va(n)?Math.min(x,n):x;l=a.reduce((b,j,y)=>[...b,{stackId:j.stackId,dataKeys:j.dataKeys,position:{offset:p+(x+o)*y+(x-g)/2,size:g}}],c)}return l}}var Jae=(e,t,r,a,n,i,o)=>{var l=ms(o)?t:o,c=Xae(r,a,n!==i?n:i,e,l);return n!==i&&c!=null&&(c=c.map(d=>Ld(Ld({},d),{},{position:Ld(Ld({},d.position),{},{offset:d.position.offset-n/2})}))),c},Zae=we([Kae,N_,TZ,S_,Yae,l5,Uae],Jae),Qae=(e,t,r,a)=>Zo(e,"xAxis",t,a),ene=(e,t,r,a)=>Zo(e,"yAxis",r,a),tne=(e,t,r,a)=>Jo(e,"xAxis",t,a),rne=(e,t,r,a)=>Jo(e,"yAxis",r,a),sne=we([Zae,rd],(e,t)=>{if(!(e==null||t==null)){var r=e.find(a=>a.stackId===t.stackId&&t.dataKey!=null&&a.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),ane=(e,t)=>{var r=Vv(t);if(!(!e||r==null||t==null)){var{stackId:a}=t;if(a!=null){var n=e[a];if(n){var{stackedData:i}=n;if(i)return i.find(o=>o.key===r)}}}},nne=we([Vae,rd],ane),ine=we([ss,iv,Qae,ene,tne,rne,sne,Kt,Fv,l5,nne,rd,Wae],(e,t,r,a,n,i,o,l,c,d,u,m,f)=>{var{chartData:h,dataStartIndex:p,dataEndIndex:x}=c;if(!(m==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||a==null||n==null||i==null||d==null)){var{data:g}=m,b;if(g!=null&&g.length>0?b=g:b=h?.slice(p,x+1),b!=null)return Oae({layout:l,barSettings:m,pos:o,parentViewBox:t,bandSize:d,xAxis:r,yAxis:a,xAxisTicks:n,yAxisTicks:i,stackedData:u,displayedData:b,offset:e,cells:f})}}),c5=e=>{var{chartData:t}=e,r=kr(),a=$a();return v.useEffect(()=>a?()=>{}:(r(vN(t)),()=>{r(vN(void 0))}),[t,r,a]),null},o2={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},d5=ba({name:"brush",initialState:o2,reducers:{setBrushSettings(e,t){return t.payload==null?o2:t.payload}}}),{setBrushSettings:vde}=d5.actions,one=d5.reducer;function lne(e,t,r){return(t=cne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cne(e){var t=dne(e,"string");return typeof t=="symbol"?t:t+""}function dne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class _1{static create(t){return new _1(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var n=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+n}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),a=r[0],n=r[r.length-1];return a<=n?t>=a&&t<=n:t>=n&&t<=a}}lne(_1,"EPS",1e-4);function une(e){return(e%180+180)%180}var mne=function(t){var{width:r,height:a}=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=une(n),o=i*Math.PI/180,l=Math.atan(a/r),c=o>l&&o<Math.PI-l?a/Math.sin(o):r/Math.cos(o);return Math.abs(c)},fne={dots:[],areas:[],lines:[]},u5=ba({name:"referenceElements",initialState:fne,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Cn(e).dots.findIndex(a=>a===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Cn(e).areas.findIndex(a=>a===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Cn(e).lines.findIndex(a=>a===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:yde,removeDot:bde,addArea:jde,removeArea:wde,addLine:Nde,removeLine:Sde}=u5.actions,hne=u5.reducer,pne=v.createContext(void 0),xne=e=>{var{children:t}=e,[r]=v.useState("".concat(hc("recharts"),"-clip")),a=a5();if(a==null)return null;var{x:n,y:i,width:o,height:l}=a;return v.createElement(pne.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:n,y:i,height:l,width:o}))),t)};function Qo(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function m5(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var a=[],n=0;n<e.length;n+=t)a.push(e[n]);return a}function gne(e,t,r){var a={width:e.width+t.width,height:e.height+t.height};return mne(a,r)}function vne(e,t,r){var a=r==="width",{x:n,y:i,width:o,height:l}=e;return t===1?{start:a?n:i,end:a?n+o:i+l}:{start:a?n+o:i+l,end:a?n:i}}function Vu(e,t,r,a,n){if(e*t<e*a||e*t>e*n)return!1;var i=r();return e*(t-e*i/2-a)>=0&&e*(t+e*i/2-n)<=0}function yne(e,t){return m5(e,t+1)}function bne(e,t,r,a,n){for(var i=(a||[]).slice(),{start:o,end:l}=t,c=0,d=1,u=o,m=function(){var p=a?.[c];if(p===void 0)return{v:m5(a,d)};var x=c,g,b=()=>(g===void 0&&(g=r(p,x)),g),j=p.coordinate,y=c===0||Vu(e,j,b,u,l);y||(c=0,u=o,d+=1),y&&(u=j+e*(b()/2+n),c+=d)},f;d<=i.length;)if(f=m(),f)return f.v;return[]}function l2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ts(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l2(Object(r),!0).forEach(function(a){jne(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function jne(e,t,r){return(t=wne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wne(e){var t=Nne(e,"string");return typeof t=="symbol"?t:t+""}function Nne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sne(e,t,r,a,n){for(var i=(a||[]).slice(),o=i.length,{start:l}=t,{end:c}=t,d=function(f){var h=i[f],p,x=()=>(p===void 0&&(p=r(h,f)),p);if(f===o-1){var g=e*(h.coordinate+e*x()/2-c);i[f]=h=Ts(Ts({},h),{},{tickCoord:g>0?h.coordinate-g*e:h.coordinate})}else i[f]=h=Ts(Ts({},h),{},{tickCoord:h.coordinate});var b=Vu(e,h.tickCoord,x,l,c);b&&(c=h.tickCoord-e*(x()/2+n),i[f]=Ts(Ts({},h),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return i}function Ene(e,t,r,a,n,i){var o=(a||[]).slice(),l=o.length,{start:c,end:d}=t;if(i){var u=a[l-1],m=r(u,l-1),f=e*(u.coordinate+e*m/2-d);o[l-1]=u=Ts(Ts({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var h=Vu(e,u.tickCoord,()=>m,c,d);h&&(d=u.tickCoord-e*(m/2+n),o[l-1]=Ts(Ts({},u),{},{isShow:!0}))}for(var p=i?l-1:l,x=function(j){var y=o[j],w,S=()=>(w===void 0&&(w=r(y,j)),w);if(j===0){var N=e*(y.coordinate-e*S()/2-c);o[j]=y=Ts(Ts({},y),{},{tickCoord:N<0?y.coordinate-N*e:y.coordinate})}else o[j]=y=Ts(Ts({},y),{},{tickCoord:y.coordinate});var E=Vu(e,y.tickCoord,S,c,d);E&&(c=y.tickCoord+e*(S()/2+n),o[j]=Ts(Ts({},y),{},{isShow:!0}))},g=0;g<p;g++)x(g);return o}function k1(e,t,r){var{tick:a,ticks:n,viewBox:i,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:m}=e;if(!n||!n.length||!a)return[];if(it(c)||xo.isSsr){var f;return(f=yne(n,it(c)?c:0))!==null&&f!==void 0?f:[]}var h=[],p=l==="top"||l==="bottom"?"width":"height",x=u&&p==="width"?Kl(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(y,w)=>{var S=typeof d=="function"?d(y.value,w):y.value;return p==="width"?gne(Kl(S,{fontSize:t,letterSpacing:r}),x,m):Kl(S,{fontSize:t,letterSpacing:r})[p]},b=n.length>=2?ds(n[1].coordinate-n[0].coordinate):1,j=vne(i,b,p);return c==="equidistantPreserveStart"?bne(b,j,g,n,o):(c==="preserveStart"||c==="preserveStartEnd"?h=Ene(b,j,g,n,o,c==="preserveStartEnd"):h=Sne(b,j,g,n,o),h.filter(y=>y.isShow))}var Tne=e=>{var{ticks:t,label:r,labelGapWithTick:a=5,tickSize:n=0,tickMargin:i=0}=e,o=0;if(t){t.forEach(u=>{if(u){var m=u.getBoundingClientRect();m.width>o&&(o=m.width)}});var l=r?r.getBoundingClientRect().width:0,c=n+i,d=o+c+l+(r?a:0);return Math.round(d)}return 0},Cne=["axisLine","width","height","className","hide","ticks"],Ane=["viewBox"],_ne=["viewBox"];function kx(e,t){if(e==null)return{};var r,a,n=kne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function kne(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},io.apply(null,arguments)}function c2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Xr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c2(Object(r),!0).forEach(function(a){Dne(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Dne(e,t,r){return(t=Ine(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ine(e){var t=One(e,"string");return typeof t=="symbol"?t:t+""}function One(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D1={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function Pne(e){var{x:t,y:r,width:a,height:n,orientation:i,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var d=Xr(Xr(Xr({},c),ts(l,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var u=+(i==="top"&&!o||i==="bottom"&&o);d=Xr(Xr({},d),{},{x1:t,y1:r+u*n,x2:t+a,y2:r+u*n})}else{var m=+(i==="left"&&!o||i==="right"&&o);d=Xr(Xr({},d),{},{x1:t+m*a,y1:r,x2:t+m*a,y2:r+n})}return v.createElement("line",io({},d,{className:Mt("recharts-cartesian-axis-line",to(l,"className"))}))}function Rne(e,t,r,a,n,i,o,l,c){var d,u,m,f,h,p,x=l?-1:1,g=e.tickSize||o,b=it(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":d=u=e.coordinate,f=r+ +!l*n,m=f-x*g,p=m-x*c,h=b;break;case"left":m=f=e.coordinate,u=t+ +!l*a,d=u-x*g,h=d-x*c,p=b;break;case"right":m=f=e.coordinate,u=t+ +l*a,d=u+x*g,h=d+x*c,p=b;break;default:d=u=e.coordinate,f=r+ +l*n,m=f+x*g,p=m+x*c,h=b;break}return{line:{x1:d,y1:m,x2:u,y2:f},tick:{x:h,y:p}}}function Fne(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function Lne(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function Mne(e){var{option:t,tickProps:r,value:a}=e,n,i=Mt(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))n=v.cloneElement(t,Xr(Xr({},r),{},{className:i}));else if(typeof t=="function")n=t(Xr(Xr({},r),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=Mt(o,t?.className)),n=v.createElement(Gm,io({},r,{className:o}),a)}return n}function Bne(e){var{ticks:t=[],tick:r,tickLine:a,stroke:n,tickFormatter:i,unit:o,padding:l,tickTextProps:c,orientation:d,mirror:u,x:m,y:f,width:h,height:p,tickSize:x,tickMargin:g,fontSize:b,letterSpacing:j,getTicksConfig:y,events:w}=e,S=k1(Xr(Xr({},y),{},{ticks:t}),b,j),N=Fne(d,u),E=Lne(d,u),P=gi(y),T=ts(r,!1),O=Xr(Xr({},P),{},{fill:"none"},ts(a,!1)),_=S.map((C,R)=>{var{line:M,tick:U}=Rne(C,m,f,h,p,d,x,u,g),Z=Xr(Xr(Xr(Xr({textAnchor:N,verticalAnchor:E},P),{},{stroke:"none",fill:n},T),U),{},{index:R,payload:C,visibleTicksCount:S.length,tickFormatter:i,padding:l},c);return v.createElement(sa,io({className:"recharts-cartesian-axis-tick",key:"tick-".concat(C.value,"-").concat(C.coordinate,"-").concat(C.tickCoord)},zc(w,C,R)),a&&v.createElement("line",io({},O,M,{className:Mt("recharts-cartesian-axis-tick-line",to(a,"className"))})),r&&v.createElement(Mne,{option:r,tickProps:Z,value:"".concat(typeof i=="function"?i(C.value,R):C.value).concat(o||"")}))});return _.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},_):null}var zne=v.forwardRef((e,t)=>{var{axisLine:r,width:a,height:n,className:i,hide:o,ticks:l}=e,c=kx(e,Cne),[d,u]=v.useState(""),[m,f]=v.useState(""),h=v.useRef([]);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var x;return Tne({ticks:h.current,label:(x=e.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var p=v.useCallback(x=>{if(x){var g=x.getElementsByClassName("recharts-cartesian-axis-tick-value");h.current=Array.from(g);var b=g[0];if(b){var j=window.getComputedStyle(b),y=j.fontSize,w=j.letterSpacing;(y!==d||w!==m)&&(u(y),f(w))}}},[d,m]);return o||a!=null&&a<=0||n!=null&&n<=0?null:v.createElement(sa,{className:Mt("recharts-cartesian-axis",i),ref:p},v.createElement(Pne,{x:e.x,y:e.y,width:a,height:n,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:gi(e)}),v.createElement(Bne,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:d,letterSpacing:m,getTicksConfig:e,events:c}),v.createElement(Gte,{x:e.x,y:e.y,width:e.width,height:e.height},v.createElement(rre,{label:e.label}),e.children))}),$ne=v.memo(zne,(e,t)=>{var{viewBox:r}=e,a=kx(e,Ane),{viewBox:n}=t,i=kx(t,_ne);return Qo(r,n)&&Qo(a,i)}),I1=v.forwardRef((e,t)=>{var r=qs(e,D1);return v.createElement($ne,io({},r,{ref:t}))});I1.displayName="CartesianAxis";var Une=["x1","y1","x2","y2","key"],Wne=["offset"],Hne=["xAxisId","yAxisId"],Vne=["xAxisId","yAxisId"];function d2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Is(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d2(Object(r),!0).forEach(function(a){Gne(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Gne(e,t,r){return(t=qne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qne(e){var t=Kne(e,"string");return typeof t=="symbol"?t:t+""}function Kne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ri(){return Ri=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ri.apply(null,arguments)}function Gu(e,t){if(e==null)return{};var r,a,n=Yne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Yne(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Xne=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:a,y:n,width:i,height:o,ry:l}=e;return v.createElement("rect",{x:a,y:n,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function f5(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:a,y1:n,x2:i,y2:o,key:l}=t,c=Gu(t,Une),d=gi(c),{offset:u}=d,m=Gu(d,Wne);r=v.createElement("line",Ri({},m,{x1:a,y1:n,x2:i,y2:o,fill:"none",key:l}))}return r}function Jne(e){var{x:t,width:r,horizontal:a=!0,horizontalPoints:n}=e;if(!a||!n||!n.length)return null;var{xAxisId:i,yAxisId:o}=e,l=Gu(e,Hne),c=n.map((d,u)=>{var m=Is(Is({},l),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(u),index:u});return f5(a,m)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function Zne(e){var{y:t,height:r,vertical:a=!0,verticalPoints:n}=e;if(!a||!n||!n.length)return null;var{xAxisId:i,yAxisId:o}=e,l=Gu(e,Vne),c=n.map((d,u)=>{var m=Is(Is({},l),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(u),index:u});return f5(a,m)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function Qne(e){var{horizontalFill:t,fillOpacity:r,x:a,y:n,width:i,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var d=l.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==d[0]&&d.unshift(0);var u=d.map((m,f)=>{var h=!d[f+1],p=h?n+o-m:d[f+1]-m;if(p<=0)return null;var x=f%t.length;return v.createElement("rect",{key:"react-".concat(f),y:m,x:a,height:p,width:i,stroke:"none",fill:t[x],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function eie(e){var{vertical:t=!0,verticalFill:r,fillOpacity:a,x:n,y:i,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var d=c.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==d[0]&&d.unshift(0);var u=d.map((m,f)=>{var h=!d[f+1],p=h?n+o-m:d[f+1]-m;if(p<=0)return null;var x=f%r.length;return v.createElement("rect",{key:"react-".concat(f),x:m,y:i,width:p,height:l,stroke:"none",fill:r[x],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var tie=(e,t)=>{var{xAxis:r,width:a,height:n,offset:i}=e;return cA(k1(Is(Is(Is({},D1),r),{},{ticks:dA(r),viewBox:{x:0,y:0,width:a,height:n}})),i.left,i.left+i.width,t)},rie=(e,t)=>{var{yAxis:r,width:a,height:n,offset:i}=e;return cA(k1(Is(Is(Is({},D1),r),{},{ticks:dA(r),viewBox:{x:0,y:0,width:a,height:n}})),i.top,i.top+i.height,t)},sie={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Gd(e){var t=lv(),r=cv(),a=hA(),n=Is(Is({},qs(e,sie)),{},{x:it(e.x)?e.x:a.left,y:it(e.y)?e.y:a.top,width:it(e.width)?e.width:a.width,height:it(e.height)?e.height:a.height}),{xAxisId:i,yAxisId:o,x:l,y:c,width:d,height:u,syncWithTicks:m,horizontalValues:f,verticalValues:h}=n,p=$a(),x=at(T=>cN(T,"xAxis",i,p)),g=at(T=>cN(T,"yAxis",o,p));if(!it(d)||d<=0||!it(u)||u<=0||!it(l)||l!==+l||!it(c)||c!==+c)return null;var b=n.verticalCoordinatesGenerator||tie,j=n.horizontalCoordinatesGenerator||rie,{horizontalPoints:y,verticalPoints:w}=n;if((!y||!y.length)&&typeof j=="function"){var S=f&&f.length,N=j({yAxis:g?Is(Is({},g),{},{ticks:S?f:g.ticks}):void 0,width:t,height:r,offset:a},S?!0:m);ql(Array.isArray(N),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof N,"]")),Array.isArray(N)&&(y=N)}if((!w||!w.length)&&typeof b=="function"){var E=h&&h.length,P=b({xAxis:x?Is(Is({},x),{},{ticks:E?h:x.ticks}):void 0,width:t,height:r,offset:a},E?!0:m);ql(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof P,"]")),Array.isArray(P)&&(w=P)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(Xne,{fill:n.fill,fillOpacity:n.fillOpacity,x:n.x,y:n.y,width:n.width,height:n.height,ry:n.ry}),v.createElement(Qne,Ri({},n,{horizontalPoints:y})),v.createElement(eie,Ri({},n,{verticalPoints:w})),v.createElement(Jne,Ri({},n,{offset:a,horizontalPoints:y,xAxis:x,yAxis:g})),v.createElement(Zne,Ri({},n,{offset:a,verticalPoints:w,xAxis:x,yAxis:g})))}Gd.displayName="CartesianGrid";var aie=["dangerouslySetInnerHTML","ticks"],nie=["id"],iie=["domain"],oie=["domain"];function Dx(){return Dx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Dx.apply(null,arguments)}function qu(e,t){if(e==null)return{};var r,a,n=lie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lie(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function cie(e){var t=kr();return v.useEffect(()=>(t(Bse(e)),()=>{t(zse(e))}),[e,t]),null}var die=e=>{var{xAxisId:t,className:r}=e,a=at(iv),n=$a(),i="xAxis",o=at(g=>hl(g,i,t,n)),l=at(g=>ik(g,i,t,n)),c=at(g=>rk(g,t)),d=at(g=>vQ(g,t)),u=at(g=>O_(g,t));if(c==null||d==null||u==null)return null;var{dangerouslySetInnerHTML:m,ticks:f}=e,h=qu(e,aie),{id:p}=u,x=qu(u,nie);return v.createElement(I1,Dx({},h,x,{scale:o,x:d.x,y:d.y,width:c.width,height:c.height,className:Mt("recharts-".concat(i," ").concat(i),r),viewBox:a,ticks:l}))},uie={allowDataOverflow:aa.allowDataOverflow,allowDecimals:aa.allowDecimals,allowDuplicatedCategory:aa.allowDuplicatedCategory,height:aa.height,hide:!1,mirror:aa.mirror,orientation:aa.orientation,padding:aa.padding,reversed:aa.reversed,scale:aa.scale,tickCount:aa.tickCount,type:aa.type,xAxisId:0},mie=e=>{var t,r,a,n,i,o=qs(e,uie);return v.createElement(v.Fragment,null,v.createElement(cie,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(n=o.minTickGap)!==null&&n!==void 0?n:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),v.createElement(die,o))},fie=(e,t)=>{var{domain:r}=e,a=qu(e,iie),{domain:n}=t,i=qu(t,oie);return Qo(a,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:Qo({domain:r},{domain:n}):!1},qd=v.memo(mie,fie);qd.displayName="XAxis";var hie=["dangerouslySetInnerHTML","ticks"],pie=["id"],xie=["domain"],gie=["domain"];function Ix(){return Ix=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ix.apply(null,arguments)}function Ku(e,t){if(e==null)return{};var r,a,n=vie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vie(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function yie(e){var t=kr();return v.useEffect(()=>(t($se(e)),()=>{t(Use(e))}),[e,t]),null}var bie=e=>{var{yAxisId:t,className:r,width:a,label:n}=e,i=v.useRef(null),o=v.useRef(null),l=at(iv),c=$a(),d=kr(),u="yAxis",m=at(S=>hl(S,u,t,c)),f=at(S=>sk(S,t)),h=at(S=>bQ(S,t)),p=at(S=>ik(S,u,t,c)),x=at(S=>P_(S,t));if(v.useLayoutEffect(()=>{if(!(a!=="auto"||!f||y1(n)||v.isValidElement(n)||x==null)){var S=i.current;if(S){var N=S.getCalculatedWidth();Math.round(f.width)!==Math.round(N)&&d(Wse({id:t,width:N}))}}},[p,f,d,n,t,a,x]),f==null||h==null||x==null)return null;var{dangerouslySetInnerHTML:g,ticks:b}=e,j=Ku(e,hie),{id:y}=x,w=Ku(x,pie);return v.createElement(I1,Ix({},j,w,{ref:i,labelRef:o,scale:m,x:h.x,y:h.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:f.width,height:f.height,className:Mt("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:p}))},jie={allowDataOverflow:na.allowDataOverflow,allowDecimals:na.allowDecimals,allowDuplicatedCategory:na.allowDuplicatedCategory,hide:!1,mirror:na.mirror,orientation:na.orientation,padding:na.padding,reversed:na.reversed,scale:na.scale,tickCount:na.tickCount,type:na.type,width:na.width,yAxisId:0},wie=e=>{var t,r,a,n,i,o=qs(e,jie);return v.createElement(v.Fragment,null,v.createElement(yie,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(n=o.minTickGap)!==null&&n!==void 0?n:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),v.createElement(bie,o))},Nie=(e,t)=>{var{domain:r}=e,a=Ku(e,xie),{domain:n}=t,i=Ku(t,gie);return Qo(a,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:Qo({domain:r},{domain:n}):!1},Kd=v.memo(wie,Nie);Kd.displayName="YAxis";var Hh={exports:{}},Vh={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2;function Sie(){if(u2)return Vh;u2=1;var e=Lx();function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,n=e.useRef,i=e.useEffect,o=e.useMemo,l=e.useDebugValue;return Vh.useSyncExternalStoreWithSelector=function(c,d,u,m,f){var h=n(null);if(h.current===null){var p={hasValue:!1,value:null};h.current=p}else p=h.current;h=o(function(){function g(S){if(!b){if(b=!0,j=S,S=m(S),f!==void 0&&p.hasValue){var N=p.value;if(f(N,S))return y=N}return y=S}if(N=y,r(j,S))return N;var E=m(S);return f!==void 0&&f(N,E)?(j=S,N):(j=S,y=E)}var b=!1,j,y,w=u===void 0?null:u;return[function(){return g(d())},w===null?void 0:function(){return g(w())}]},[d,u,m,f]);var x=a(c,h[0],h[1]);return i(function(){p.hasValue=!0,p.value=x},[x]),l(x),x},Vh}var m2;function Eie(){return m2||(m2=1,Hh.exports=Sie()),Hh.exports}Eie();function Tie(e){e()}function Cie(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Tie(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0;const n=t={callback:r,next:null,prev:t};return n.prev?n.prev.next=n:e=n,function(){!a||e===null||(a=!1,n.next?n.next.prev=n.prev:t=n.prev,n.prev?n.prev.next=n.next:e=n.next)}}}}var f2={notify(){},get:()=>[]};function Aie(e,t){let r,a=f2,n=0,i=!1;function o(x){u();const g=a.subscribe(x);let b=!1;return()=>{b||(b=!0,g(),m())}}function l(){a.notify()}function c(){p.onStateChange&&p.onStateChange()}function d(){return i}function u(){n++,r||(r=e.subscribe(c),a=Cie())}function m(){n--,r&&n===0&&(r(),r=void 0,a.clear(),a=f2)}function f(){i||(i=!0,u())}function h(){i&&(i=!1,m())}const p={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:f,tryUnsubscribe:h,getListeners:()=>a};return p}var _ie=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kie=_ie(),Die=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Iie=Die(),Oie=()=>kie||Iie?v.useLayoutEffect:v.useEffect,Pie=Oie(),Rie=Symbol.for("react-redux-context"),Fie=typeof globalThis<"u"?globalThis:{};function Lie(){if(!v.createContext)return{};const e=Fie[Rie]??=new Map;let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var Mie=Lie();function Bie(e){const{children:t,context:r,serverState:a,store:n}=e,i=v.useMemo(()=>{const c=Aie(n);return{store:n,subscription:c,getServerState:a?()=>a:void 0}},[n,a]),o=v.useMemo(()=>n.getState(),[n]);Pie(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==n.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=r||Mie;return v.createElement(l.Provider,{value:i},t)}var zie=Bie,$ie=(e,t)=>t,O1=we([$ie,Kt,k_,ns,jk,Vn,See,ss],_ee),P1=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/a)}},h5=Ma("mouseClick"),p5=Uc();p5.startListening({actionCreator:h5,effect:(e,t)=>{var r=e.payload,a=O1(t.getState(),P1(r));a?.activeIndex!=null&&t.dispatch(OQ({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var Ox=Ma("mouseMove"),x5=Uc();x5.startListening({actionCreator:Ox,effect:(e,t)=>{var r=e.payload,a=t.getState(),n=d1(a,a.tooltip.settings.shared),i=O1(a,P1(r));n==="axis"&&(i?.activeIndex!=null?t.dispatch(hk({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(fk()))}});var h2={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},g5=ba({name:"rootProps",initialState:h2,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:h2.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),Uie=g5.reducer,{updateOptions:Wie}=g5.actions,v5=ba({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:Hie}=v5.actions,Vie=v5.reducer,y5=Ma("keyDown"),b5=Ma("focus"),R1=Uc();R1.startListening({actionCreator:y5,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:n}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Number(u1(n,xl(r))),l=Vn(r);if(i==="Enter"){var c=zu(r,"axis","hover",String(n.index));t.dispatch(Ex({active:!n.active,activeIndex:n.index,activeDataKey:n.dataKey,activeCoordinate:c}));return}var d=SQ(r),u=d==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,f=o+m*u;if(!(l==null||f>=l.length||f<0)){var h=zu(r,"axis","hover",String(f));t.dispatch(Ex({active:!0,activeIndex:f.toString(),activeDataKey:void 0,activeCoordinate:h}))}}}}});R1.startListening({actionCreator:b5,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:n}=r.tooltip;if(!n.active&&n.index==null){var i="0",o=zu(r,"axis","hover",String(i));t.dispatch(Ex({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:o}))}}}});var Aa=Ma("externalEvent"),j5=Uc();j5.startListening({actionCreator:Aa,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),a={activeCoordinate:pee(r),activeDataKey:Ek(r),activeIndex:no(r),activeLabel:Sk(r),activeTooltipIndex:no(r),isTooltipActive:xee(r)};e.payload.handler(a,e.payload.reactEvent)}}});var Gie=we([pl],e=>e.tooltipItemPayloads),qie=we([Gie,Qc,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,a)=>{var n=e.find(l=>l.settings.dataKey===a);if(n!=null){var{positions:i}=n;if(i!=null){var o=t(i,r);return o}}}),w5=Ma("touchMove"),N5=Uc();N5.startListening({actionCreator:w5,effect:(e,t)=>{var r=e.payload,a=t.getState(),n=d1(a,a.tooltip.settings.shared);if(n==="axis"){var i=O1(a,P1({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(hk({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(n==="item"){var o,l=r.touches[0],c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var d=c.getAttribute(mA),u=(o=c.getAttribute(fA))!==null&&o!==void 0?o:void 0,m=qie(t.getState(),d,u);t.dispatch(mk({activeDataKey:u,activeIndex:d,activeCoordinate:m}))}}});var Kie=MC({brush:one,cartesianAxis:Hse,chartData:Vee,errorBars:aae,graphicalItems:lse,layout:Eq,legend:pK,options:zee,polarAxis:Sre,polarOptions:Vie,referenceElements:hne,rootProps:Uie,tooltip:PQ}),Yie=function(t){return XG({reducer:Kie,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([p5.middleware,x5.middleware,R1.middleware,j5.middleware,N5.middleware]),devTools:xo.devToolsEnabled})};function S5(e){var{preloadedState:t,children:r,reduxStoreName:a}=e,n=$a(),i=v.useRef(null);if(n)return r;i.current==null&&(i.current=Yie(t));var o=Qg;return v.createElement(zie,{context:o,store:i.current},r)}function E5(e){var{layout:t,width:r,height:a,margin:n}=e,i=kr(),o=$a();return v.useEffect(()=>{o||(i(wq(t)),i(Nq({width:r,height:a})),i(jq(n)))},[i,o,t,r,a,n]),null}function T5(e){var t=kr();return v.useEffect(()=>{t(Wie(e))},[t,e]),null}var Xie=["children"];function Jie(e,t){if(e==null)return{};var r,a,n=Zie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Zie(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Yu(){return Yu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Yu.apply(null,arguments)}var Qie={width:"100%",height:"100%"},eoe=v.forwardRef((e,t)=>{var r=lv(),a=cv(),n=vA();if(!Go(r)||!Go(a))return null;var{children:i,otherAttributes:o,title:l,desc:c}=e,d,u;return typeof o.tabIndex=="number"?d=o.tabIndex:d=n?0:void 0,typeof o.role=="string"?u=o.role:u=n?"application":void 0,v.createElement(Hg,Yu({},o,{title:l,desc:c,role:u,tabIndex:d,width:r,height:a,style:Qie,ref:t}),i)}),toe=e=>{var{children:t}=e,r=at(Am);if(!r)return null;var{width:a,height:n,y:i,x:o}=r;return v.createElement(Hg,{width:a,height:n,x:o,y:i},t)},p2=v.forwardRef((e,t)=>{var{children:r}=e,a=Jie(e,Xie),n=$a();return n?v.createElement(toe,null,r):v.createElement(eoe,Yu({ref:t},a),r)});function roe(){var e=kr(),[t,r]=v.useState(null),a=at(eK);return v.useEffect(()=>{if(t!=null){var n=t.getBoundingClientRect(),i=n.width/t.offsetWidth;va(i)&&i!==a&&e(Sq(i))}},[t,e,a]),r}function x2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function soe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x2(Object(r),!0).forEach(function(a){aoe(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x2(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function aoe(e,t,r){return(t=noe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function noe(e){var t=ioe(e,"string");return typeof t=="symbol"?t:t+""}function ioe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ooe=v.forwardRef((e,t)=>{var{children:r,className:a,height:n,onClick:i,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:m,onMouseUp:f,onTouchEnd:h,onTouchMove:p,onTouchStart:x,style:g,width:b}=e,j=kr(),[y,w]=v.useState(null),[S,N]=v.useState(null);ete();var E=roe(),P=v.useCallback(A=>{E(A),typeof t=="function"&&t(A),w(A),N(A)},[E,t,w,N]),T=v.useCallback(A=>{j(h5(A)),j(Aa({handler:i,reactEvent:A}))},[j,i]),O=v.useCallback(A=>{j(Ox(A)),j(Aa({handler:d,reactEvent:A}))},[j,d]),_=v.useCallback(A=>{j(fk()),j(Aa({handler:u,reactEvent:A}))},[j,u]),C=v.useCallback(A=>{j(Ox(A)),j(Aa({handler:m,reactEvent:A}))},[j,m]),R=v.useCallback(()=>{j(b5())},[j]),M=v.useCallback(A=>{j(y5(A.key))},[j]),U=v.useCallback(A=>{j(Aa({handler:o,reactEvent:A}))},[j,o]),Z=v.useCallback(A=>{j(Aa({handler:l,reactEvent:A}))},[j,l]),ee=v.useCallback(A=>{j(Aa({handler:c,reactEvent:A}))},[j,c]),re=v.useCallback(A=>{j(Aa({handler:f,reactEvent:A}))},[j,f]),z=v.useCallback(A=>{j(Aa({handler:x,reactEvent:A}))},[j,x]),me=v.useCallback(A=>{j(w5(A)),j(Aa({handler:p,reactEvent:A}))},[j,p]),ne=v.useCallback(A=>{j(Aa({handler:h,reactEvent:A}))},[j,h]);return v.createElement(Dk.Provider,{value:y},v.createElement(nC.Provider,{value:S},v.createElement("div",{className:Mt("recharts-wrapper",a),style:soe({position:"relative",cursor:"default",width:b,height:n},g),onClick:T,onContextMenu:U,onDoubleClick:Z,onFocus:R,onKeyDown:M,onMouseDown:ee,onMouseEnter:O,onMouseLeave:_,onMouseMove:C,onMouseUp:re,onTouchEnd:ne,onTouchMove:me,onTouchStart:z,ref:P},r)))}),loe=["children","className","width","height","style","compact","title","desc"];function coe(e,t){if(e==null)return{};var r,a,n=doe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function doe(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var C5=v.forwardRef((e,t)=>{var{children:r,className:a,width:n,height:i,style:o,compact:l,title:c,desc:d}=e,u=coe(e,loe),m=gi(u);return l?v.createElement(p2,{otherAttributes:m,title:c,desc:d},r):v.createElement(ooe,{className:a,style:o,width:n,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(p2,{otherAttributes:m,title:c,desc:d,ref:t},v.createElement(xne,null,r)))}),uoe=["width","height"];function Px(){return Px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Px.apply(null,arguments)}function moe(e,t){if(e==null)return{};var r,a,n=foe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function foe(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var hoe={top:5,right:5,bottom:5,left:5},poe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:hoe,reverseStackOrder:!1,syncMethod:"index"},xoe=v.forwardRef(function(t,r){var a,n=qs(t.categoricalChartProps,poe),{width:i,height:o}=n,l=moe(n,uoe);if(!Go(i)||!Go(o))return null;var{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:m,categoricalChartProps:f}=t,h={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:m,eventEmitter:void 0};return v.createElement(S5,{preloadedState:{options:h},reduxStoreName:(a=f.id)!==null&&a!==void 0?a:c},v.createElement(c5,{chartData:f.data}),v.createElement(E5,{width:i,height:o,layout:n.layout,margin:n.margin}),v.createElement(T5,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),v.createElement(C5,Px({},l,{width:i,height:o,ref:r})))}),goe=["axis","item"],Gh=v.forwardRef((e,t)=>v.createElement(xoe,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:goe,tooltipPayloadSearcher:Ik,categoricalChartProps:e,ref:t}));function voe(e){var t=kr();return v.useEffect(()=>{t(Hie(e))},[t,e]),null}var yoe=["width","height","layout"];function Rx(){return Rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Rx.apply(null,arguments)}function boe(e,t){if(e==null)return{};var r,a,n=joe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function joe(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var woe={top:5,right:5,bottom:5,left:5},Noe={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:woe,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},Soe=v.forwardRef(function(t,r){var a,n=qs(t.categoricalChartProps,Noe),{width:i,height:o,layout:l}=n,c=boe(n,yoe);if(!Go(i)||!Go(o))return null;var{chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:m,tooltipPayloadSearcher:f}=t,h={chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:m,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(S5,{preloadedState:{options:h},reduxStoreName:(a=n.id)!==null&&a!==void 0?a:d},v.createElement(c5,{chartData:n.data}),v.createElement(E5,{width:i,height:o,layout:l,margin:n.margin}),v.createElement(T5,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),v.createElement(voe,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),v.createElement(C5,Rx({width:i,height:o},c,{ref:r})))}),Eoe=["item"],Toe={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Coe=v.forwardRef((e,t)=>{var r=qs(e,Toe);return v.createElement(Soe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Eoe,tooltipPayloadSearcher:Ik,categoricalChartProps:r,ref:t})});const Aoe=()=>{const e=tt(),[t,r]=v.useState(!1),a=[{title:"Create New Assessment Event",description:"Create a new assessment event for trainees",icon:fa,action:()=>{e(je.ASSESSMENT_EVENTS)},color:"primary"},{title:"View All Departments",description:"View and manage all academic departments",icon:Vs,action:()=>{e("/academic/departments")},color:"primary"}],[n,i]=v.useState({ongoingCourses:[],ongoingEnrollments:[],assessmentStatuses:[],passFailRate:[]});v.useEffect(()=>{(async()=>{r(!0);try{await new Promise(d=>setTimeout(d,1e3)),i({ongoingCourses:[{department:"Operations",count:15},{department:"Maintenance",count:12},{department:"Safety",count:8},{department:"Quality",count:10},{department:"Training",count:6}],ongoingEnrollments:[{department:"Operations",count:245},{department:"Maintenance",count:180},{department:"Safety",count:120},{department:"Quality",count:150},{department:"Training",count:95}],assessmentStatuses:[{status:"NOT_STARTED",count:150},{status:"DRAFT",count:30},{status:"SUBMITTED",count:45},{status:"APPROVED",count:85},{status:"REJECTED",count:12},{status:"CANCELLED",count:8}],passFailRate:[{department:"Operations",pass:120,fail:15},{department:"Maintenance",pass:95,fail:8},{department:"Safety",pass:80,fail:5},{department:"Quality",pass:100,fail:10},{department:"Training",pass:60,fail:3}]})}catch(d){console.error("Error fetching analytics data:",d)}finally{r(!1)}})()},[]);const o=["#1b3c53","#456882","#6a9fb8","#8fb6ce","#b4d3e4","#d9e9f2"],l={NOT_STARTED:"#6c757d",DRAFT:"#ffc107",SUBMITTED:"#0d6efd",APPROVED:"#28a745",REJECTED:"#dc3545",CANCELLED:"#6c757d"};return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsxs(Ce,{className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{lg:12,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(W.Body,{children:s.jsx(de,{children:a.map((c,d)=>s.jsx(H,{md:4,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:c.action,children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(c.icon,{size:24,className:`text-${c.color} me-2`}),s.jsx("h6",{className:"mb-0",children:c.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:c.description}),s.jsx(un,{size:16,className:`text-${c.color} ms-auto`})]})},d))})})]})})}),t?s.jsx(de,{children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading analytics data..."})]})})}):s.jsxs(s.Fragment,{children:[s.jsxs(de,{className:"mb-4",children:[s.jsx(H,{lg:6,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Bd,{className:"me-2",size:20}),"Ongoing Courses"]})}),s.jsx(W.Body,{children:s.jsx(Fd,{width:"100%",height:300,children:s.jsxs(Gh,{data:n.ongoingCourses,children:[s.jsx(Gd,{strokeDasharray:"3 3"}),s.jsx(qd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),s.jsx(Kd,{}),s.jsx(Rd,{}),s.jsx(Ii,{}),s.jsx(Ml,{dataKey:"count",fill:"#1b3c53",name:"Number of Courses"})]})})})]})}),s.jsx(H,{lg:6,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Bd,{className:"me-2",size:20}),"Ongoing Trainees"]})}),s.jsx(W.Body,{children:s.jsx(Fd,{width:"100%",height:300,children:s.jsxs(Gh,{data:n.ongoingEnrollments,children:[s.jsx(Gd,{strokeDasharray:"3 3"}),s.jsx(qd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),s.jsx(Kd,{}),s.jsx(Rd,{}),s.jsx(Ii,{}),s.jsx(Ml,{dataKey:"count",fill:"#456882",name:"Number of Trainees"})]})})})]})})]}),s.jsxs(de,{className:"mb-4",children:[s.jsx(H,{lg:6,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(eS,{className:"me-2",size:20}),"Assessment Results"]})}),s.jsx(W.Body,{children:s.jsx(Fd,{width:"100%",height:300,children:s.jsxs(Coe,{children:[s.jsx(r5,{data:n.assessmentStatuses,cx:"50%",cy:"50%",labelLine:!1,label:({name:c,percent:d})=>`${c}: ${(d*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:n.assessmentStatuses.map((c,d)=>s.jsx(td,{fill:l[c.status]||o[d%o.length]},`cell-${d}`))}),s.jsx(Rd,{}),s.jsx(Ii,{})]})})})]})}),s.jsx(H,{lg:6,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary text-white border-0",children:s.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[s.jsx(Bd,{className:"me-2",size:20}),"Training Effectiveness (Pass/Fail Rate)"]})}),s.jsx(W.Body,{children:s.jsx(Fd,{width:"100%",height:300,children:s.jsxs(Gh,{data:n.passFailRate,children:[s.jsx(Gd,{strokeDasharray:"3 3"}),s.jsx(qd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),s.jsx(Kd,{}),s.jsx(Rd,{}),s.jsx(Ii,{}),s.jsx(Ml,{dataKey:"pass",stackId:"a",fill:"#28a745",name:"Pass"}),s.jsx(Ml,{dataKey:"fail",stackId:"a",fill:"#dc3545",name:"Fail"})]})})})]})})]})]})]})})},_oe=({courses:e,loading:t,actionsComponent:r,onView:a,onDisable:n})=>{const{sortedData:i,sortConfig:o,handleSort:l}=_r(e);if(t)return s.jsx(nr,{rows:4,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No courses found"}),s.jsx("p",{children:"This department doesn't have any courses yet."})]})});const c=({columnKey:d,children:u,className:m=""})=>{const f=o.key===d,h=f?o.direction:null;return s.jsxs("th",{className:`fw-semibold ${m}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>l(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:u}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:h,size:14,color:"white"})})]}),f&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"department-table-container course-table-responsive",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(c,{columnKey:"name",className:"show-mobile",children:"Course Name"}),s.jsx(c,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(c,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),s.jsx(c,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),s.jsx(c,{columnKey:"venue",className:"show-mobile",children:"Venue"}),s.jsx(c,{columnKey:"note",className:"show-mobile",children:"Note"}),s.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"})]})}),s.jsx("tbody",{children:i.map((d,u)=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary cursor-pointer",onClick:()=>a(d.id),style:{cursor:"pointer"},children:d.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx(ke,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.code})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:d.startDate||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:d.endDate||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lo,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:d.venue||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xt,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.note||"N/A"})]})}),s.jsx("td",{className:"show-mobile",children:s.jsx(ke,{bg:d.status==="ACTIVE"?"success":d.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:d.status||"N/A"})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(r,{course:d,onView:a,onDisable:n})})]},d.id))})]})})},koe=({course:e,onView:t,onDisable:r})=>{const a=()=>{t&&t(e.id)},n=()=>{r&&r(e.id)};return s.jsx(yt,{permissions:[Te.VIEW_COURSE_DETAILS,Te.ARCHIVE_COURSE,Te.UPDATE_COURSE],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:a,permission:Te.VIEW_COURSE_DETAILS},{type:"divider"},{label:"Archive Course",icon:s.jsx(Qr,{}),className:"text-danger",onClick:n,permission:Te.ARCHIVE_COURSE}]})})},Doe=({show:e,onClose:t,onSave:r,loading:a=!1})=>{const[n,i]=v.useState({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),[o,l]=v.useState({});v.useEffect(()=>{e&&(i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}))},[e]);const c=()=>{i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}),t()},d=f=>{const{name:h,value:p}=f.target;if(i(x=>({...x,[h]:p})),o[h]&&l(x=>({...x,[h]:""})),h==="startDate"&&p){const x=new Date;x.setHours(0,0,0,0),new Date(p+"T00:00:00")<x&&l(b=>({...b,startDate:"Start date cannot be in the past"}))}if(h==="endDate"&&p){const x=new Date;x.setHours(0,0,0,0),new Date(p+"T00:00:00")<x&&l(b=>({...b,endDate:"End date cannot be in the past"}))}},u=()=>{const f={};if(n.name.trim()||(f.name="Course name is required"),n.code.trim()||(f.code="Course code is required"),n.description.trim()||(f.description="Description is required"),(!n.maxNumTrainee||isNaN(n.maxNumTrainee)||parseInt(n.maxNumTrainee)<=0)&&(f.maxNumTrainee="Max trainees must be a positive number"),n.venue.trim()||(f.venue="Venue is required"),(!n.passScore||isNaN(n.passScore)||!Number.isInteger(parseFloat(n.passScore))||parseInt(n.passScore)<0||parseInt(n.passScore)>100)&&(f.passScore="Pass score must be an integer between 0 and 100"),!n.startDate)f.startDate="Start date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(n.startDate+"T00:00:00")<h&&(f.startDate="Start date cannot be in the past")}if(!n.endDate)f.endDate="End date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(n.endDate+"T00:00:00")<h&&(f.endDate="End date cannot be in the past")}return n.startDate&&n.endDate&&new Date(n.startDate+"T00:00:00")>=new Date(n.endDate+"T00:00:00")&&(f.endDate="End date must be after start date"),l(f),Object.keys(f).length===0},m=async f=>{if(f.preventDefault(),!!u())try{await r(n),c()}catch{}};return s.jsxs(ce,{show:e,onHide:c,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Gr,{className:"me-2",size:20}),"Add New Course"]}),s.jsx(te,{variant:"link",onClick:c,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(k,{onSubmit:m,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto",paddingTop:"1.5rem"},children:[s.jsxs(de,{className:"mb-5",children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Name *"}),s.jsx(k.Control,{type:"text",name:"name",value:n.name,onChange:d,isInvalid:!!o.name,disabled:a}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.name})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Code *"}),s.jsx(k.Control,{type:"text",name:"code",value:n.code,onChange:d,isInvalid:!!o.code,disabled:a}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.code})]})})]}),s.jsxs(de,{className:"mb-5",children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Max Trainees *"}),s.jsx(k.Control,{type:"number",name:"maxNumTrainee",value:n.maxNumTrainee,onChange:d,isInvalid:!!o.maxNumTrainee,disabled:a,min:"1"}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.maxNumTrainee})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Pass Score *"}),s.jsx(k.Control,{type:"number",name:"passScore",value:n.passScore,onChange:d,isInvalid:!!o.passScore,disabled:a,min:"0",max:"100",step:"1"}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.passScore})]})})]}),s.jsxs(de,{className:"mb-5",children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Level"}),s.jsxs(k.Select,{name:"level",value:n.level,onChange:d,disabled:a,children:[s.jsx("option",{value:"BEGINNER",children:"Beginner"}),s.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),s.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Venue *"}),s.jsx(k.Control,{type:"text",name:"venue",value:n.venue,onChange:d,isInvalid:!!o.venue,disabled:a}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.venue})]})})]}),s.jsxs(de,{className:"mb-5",children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Start Date *"}),s.jsx(k.Control,{type:"date",name:"startDate",value:n.startDate,onChange:d,isInvalid:!!o.startDate,disabled:a}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.startDate})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"End Date *"}),s.jsx(k.Control,{type:"date",name:"endDate",value:n.endDate,onChange:d,isInvalid:!!o.endDate,disabled:a}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.endDate})]})})]}),s.jsx(de,{className:"mb-5",children:s.jsx(H,{children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Description *"}),s.jsx(k.Control,{as:"textarea",rows:3,name:"description",value:n.description,onChange:d,isInvalid:!!o.description,disabled:a}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.description})]})})}),s.jsx(de,{className:"mb-5",children:s.jsx(H,{children:s.jsxs(k.Group,{className:"mb-0",children:[s.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Note"}),s.jsx(k.Control,{as:"textarea",rows:2,name:"note",value:n.note,onChange:d,disabled:a})]})})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:c,disabled:a,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"primary-custom",type:"submit",disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),"Create Course"]})})]})]})]})},Ioe=({show:e,onClose:t,onArchive:r,course:a,loading:n=!1})=>{const[i,o]=v.useState(""),[l,c]=v.useState(""),u=i==="ARCHIVE",m=()=>{o(""),c(""),t()},f=async()=>{if(!u){c('Please type "ARCHIVE" to confirm');return}try{await r(a?.id),m()}catch(p){c(p.message||"Failed to archive course. Please try again.")}},h=p=>{o(p.target.value),c("")};return s.jsxs(ce,{show:e,onHide:m,centered:!0,children:[s.jsxs(ce.Header,{className:"bg-warning text-dark border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Jt,{className:"me-2",size:20}),"Archive Course"]}),s.jsx(te,{variant:"link",onClick:m,className:"text-dark p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",children:[l&&s.jsx(De,{variant:"danger",className:"mb-3",children:l}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-2",children:"You are about to archive the following course:"}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx("strong",{children:"Course Code:"})," ",a?.code,s.jsx("br",{}),s.jsx("strong",{children:"Course Name:"})," ",a?.name,s.jsx("br",{}),a?.description&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Description:"})," ",a?.description,s.jsx("br",{})]}),a?.venue&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Venue:"})," ",a?.venue,s.jsx("br",{})]}),a?.startDate&&a?.endDate&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Duration:"})," ",a?.startDate," to ",a?.endDate]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-warning mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-warning mb-3",children:[s.jsx("li",{children:"Archive the course and make it unavailable for new enrollments"}),s.jsx("li",{children:"Remove the course from active course offerings"}),s.jsx("li",{children:"Affect any ongoing training sessions"}),s.jsx("li",{children:"Course data will be archived but can be restored if needed"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",s.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),s.jsx("input",{type:"text",className:`form-control ${i&&!u?"is-invalid":""}`,id:"confirmText",value:i,onChange:h,placeholder:"Type ARCHIVE here",disabled:n}),i&&!u&&s.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:m,disabled:n,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"warning",onClick:f,disabled:n||!u,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Jt,{className:"me-2",size:16}),"Archive Course"]})})]})]})},Ooe=({show:e,onClose:t,departmentHead:r,department:a})=>{if(!r)return null;const n=[r.firstName,r.middleName,r.lastName].filter(Boolean).join(" ");return s.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsxs(ce.Title,{children:[s.jsx(Pt,{className:"me-2"}),"Department Head Details"]})}),s.jsx(ce.Body,{children:s.jsxs(de,{className:"g-3",children:[s.jsx(H,{md:4,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3",style:{width:"80px",height:"80px"},children:s.jsx(Pt,{size:40,className:"text-white"})}),s.jsx("h5",{className:"mb-1",children:n}),s.jsx(ke,{bg:"primary",className:"mb-2",children:r.role?.name||"Department Head"}),s.jsx("p",{className:"text-muted small mb-0",children:a?.name})]})}),s.jsx(H,{md:8,children:s.jsx(de,{className:"g-4",children:s.jsx(H,{md:12,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vi,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Email"}),s.jsx("div",{className:"fw-semibold",children:r.email||"N/A"})]})]})})})})]})}),s.jsx(ce.Footer,{children:s.jsx(te,{variant:"secondary",onClick:t,children:"Close"})})]})},Poe=({courseId:e})=>{const t=tt(),[r,a]=v.useState(null),[n,i]=v.useState([]),[o,l]=v.useState(!0),[c,d]=v.useState(!1),[u,m]=v.useState("add"),[f,h]=v.useState(!1),[p,x]=v.useState(null),[g,b]=v.useState(null),[j,y]=v.useState(!1),[w,S]=v.useState(!1),N={1:{id:1,name:"Cabin Crew Training",code:"CCT",description:"Primarily responsible for training and developing flight attendants. The curriculum covers all skills required to work on board, including safety procedures, emergency response, first aid, and customer service.",duration:"6 months",status:"ACTIVE",totalSubjects:12,totalTrainers:8},2:{id:2,name:"Flight Crew Training",code:"FCTD",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"12 months",status:"ACTIVE",totalSubjects:18,totalTrainers:15},3:{id:3,name:"Ground Operations Training",code:"GOT",description:"A more specialized branch of Ground Training (GAT). It focuses on personnel working directly on the aircraft ramp/apron. Operations include marshalling aircraft into parking positions, operating passenger stairs and baggage vehicles, and carrying out cargo and baggage loading procedures.",duration:"4 months",status:"ACTIVE",totalSubjects:8,totalTrainers:6},4:{id:4,name:"Ground Affairs Training",code:"GAT",description:"Responsible for training staff in ground service departments. This area is broad and may include check-in agents, gate agents, baggage service staff, and more.",duration:"3 months",status:"ACTIVE",totalSubjects:6,totalTrainers:4},5:{id:5,name:"Technical & Aircraft Maintenance",code:"TAMT",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"18 months",status:"ACTIVE",totalSubjects:24,totalTrainers:20}},E=[{id:1,name:"Safety Procedures",code:"SAF001",startDate:"2024-01-15",endDate:"2024-01-29",venue:"Training Center A",note:"Basic safety protocols",status:"ACTIVE"},{id:2,name:"Emergency Response",code:"EMR001",startDate:"2024-02-01",endDate:"2024-02-22",venue:"Training Center B",note:"Emergency procedures training",status:"ACTIVE"},{id:3,name:"First Aid",code:"FAD001",startDate:"2024-01-20",endDate:"2024-01-27",venue:"Medical Center",note:"Basic first aid skills",status:"ACTIVE"},{id:4,name:"Customer Service",code:"CSV001",startDate:"2024-02-05",endDate:"2024-02-19",venue:"Training Center A",note:"Customer interaction skills",status:"ACTIVE"},{id:5,name:"Simulator Training",code:"SIM001",startDate:"2024-02-10",endDate:"2024-03-09",venue:"Simulator Complex",note:"Flight simulator training",status:"ACTIVE"},{id:6,name:"Type Rating",code:"TR001",startDate:"2024-03-01",endDate:"2024-04-12",venue:"Training Center C",note:"Aircraft type certification",status:"ACTIVE"},{id:7,name:"Recurrent Training",code:"RT001",startDate:"2024-01-25",endDate:"2024-02-08",venue:"Training Center A",note:"Refresher training",status:"ACTIVE"},{id:8,name:"Aircraft Marshalling",code:"AM001",startDate:"2024-02-15",endDate:"2024-02-22",venue:"Ramp Area",note:"Ground operations",status:"ACTIVE"},{id:9,name:"Baggage Handling",code:"BH001",startDate:"2024-02-20",endDate:"2024-02-27",venue:"Baggage Area",note:"Baggage operations",status:"ACTIVE"},{id:10,name:"Check-in Procedures",code:"CIP001",startDate:"2024-03-05",endDate:"2024-03-12",venue:"Terminal",note:"Passenger check-in",status:"ACTIVE"}];v.useEffect(()=>{e&&(async()=>{l(!0);try{const U=await Nr.getDepartmentById(e);if(!U)throw new Error(`Department with ID ${e} not found in API response`);const Z={id:U.id,name:U.name,code:U.code,description:U.description,duration:"N/A",status:U.isActive,totalSubjects:U.courseCount||0,totalTrainers:U.trainerCount||0};a(Z);const re=(U.courses||[]).filter(z=>z.status!=="ARCHIVED").map(z=>({id:z.id,name:z.name,code:z.code,startDate:z.startDate?new Date(z.startDate).toISOString().split("T")[0]:"N/A",endDate:z.endDate?new Date(z.endDate).toISOString().split("T")[0]:"N/A",venue:z.venue||"N/A",note:z.note||"N/A",status:z.status,description:z.description,maxNumTrainee:z.maxNumTrainee,passScore:z.passScore,level:z.level,subjectCount:z.subjectCount||0}))||[];i(re),U.headUser&&b(U.headUser),l(!1)}catch{l(!1);const M=N[e];M&&(a(M),i(E.filter(U=>U.status!=="ARCHIVED")))}})()},[e]);const P=()=>{m("add"),d(!0)},T=R=>{const M=n.find(U=>U.id===R);x(M),h(!0)},O=async R=>{try{await Nr.archiveCourse(R),J.success("Course archived successfully"),i(M=>M.filter(U=>U.id!==R)),h(!1),x(null)}catch(M){throw J.error("Failed to archive course. Please try again."),M}},_=R=>{t(je.ACADEMIC_COURSE_DETAIL(R),{state:{departmentId:r.id,departmentName:r?.name||"Department"}})},C=async R=>{try{S(!0);const M={departmentId:r.id,name:R.name,description:R.description,code:R.code,maxNumTrainee:Number(R.maxNumTrainee),venue:R.venue,note:R.note,passScore:Number(R.passScore),startDate:R.startDate?new Date(R.startDate).toISOString():null,endDate:R.endDate?new Date(R.endDate).toISOString():null,level:R.level},U=await Nr.createCourse(M);J.success("Course created successfully");const Z={id:U.id,name:U.name,code:U.code,startDate:U.startDate?new Date(U.startDate).toISOString().split("T")[0]:"N/A",endDate:U.endDate?new Date(U.endDate).toISOString().split("T")[0]:"N/A",venue:U.venue||"N/A",note:U.note||"N/A",status:U.status||"PLANNED",description:U.description,maxNumTrainee:U.maxNumTrainee,passScore:U.passScore,level:U.level,department:U.department};i(ee=>[Z,...ee])}catch(M){throw M.response?.status,J.error(M.response?.data?.message||"Failed to create course"),M}finally{S(!1)}};return o?s.jsx(Ce,{className:"py-4",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):r?s.jsxs(Ce,{className:"d-flex flex-column",style:{padding:"0.5rem 1rem",overflowX:"hidden"},children:[s.jsx(de,{className:"mb-1 flex-shrink-0",children:s.jsx(H,{children:s.jsx(W,{className:"border-0 shadow-sm",children:s.jsxs(W.Body,{className:"p-2",children:[s.jsx("div",{className:"d-flex justify-content-between align-items-start mb-1",children:s.jsxs("div",{children:[s.jsxs("h4",{className:"mb-1",children:[s.jsx(Dt,{className:"me-2 text-primary"}),r.name]}),s.jsxs("p",{className:"text-muted mb-0 small",children:["Department Code: ",r.code]})]})}),s.jsx("p",{className:"text-muted mb-1 small",children:r.description}),s.jsxs(de,{className:"g-2",children:[s.jsx(H,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xt,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Total Subjects"}),s.jsx("div",{className:"fw-semibold small",children:r.totalSubjects})]})]})}),s.jsx(H,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Mr,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Total Trainers"}),s.jsx("div",{className:"fw-semibold small",children:r.totalTrainers})]})]})}),s.jsx(H,{md:4,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{className:"me-2 text-primary",size:16}),s.jsxs("div",{children:[s.jsx("small",{className:"text-muted",children:"Department Head"}),s.jsx("div",{className:"fw-semibold small",children:g?s.jsx(te,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>y(!0),style:{fontSize:"inherit",fontWeight:"inherit",color:"#0d6efd"},children:[g.firstName,g.middleName,g.lastName].filter(Boolean).join(" ")}):"Not assigned"})]})]})})]})]})})})}),s.jsx(de,{className:"mt-3",children:s.jsx(H,{children:s.jsxs(W,{className:"border-0 shadow-sm",children:[s.jsx(W.Header,{className:"academic-course-section-header bg-primary text-white border-0 flex-shrink-0",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("h5",{className:"mb-0 text-white",children:[s.jsx(xt,{className:"me-2"}),"Courses (",n.length,")"]}),s.jsx(yt,{permission:Te.CREATE_COURSE,children:s.jsxs(te,{variant:"light",size:"sm",onClick:P,className:"academic-course-add-btn",children:[s.jsx(Gr,{size:16,className:"me-1"}),"Add New Course"]})})]})}),s.jsx("div",{className:"p-0",children:s.jsx(_oe,{courses:n,loading:!1,actionsComponent:koe,onView:_,onDisable:T})})]})})}),s.jsx(Doe,{show:c&&u==="add",onClose:()=>d(!1),onSave:C,loading:w}),s.jsx(Ioe,{show:f,onClose:()=>h(!1),onArchive:O,course:p}),s.jsx(Ooe,{show:j,onClose:()=>y(!1),departmentHead:g,department:r})]}):s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx(Dt,{size:48,className:"mb-3"}),s.jsx("h4",{children:"Department not found"}),s.jsx("p",{children:"The requested department could not be found."})]})})},Roe=()=>{const{courseId:e}=ur();return s.jsx(Poe,{courseId:e})},Foe=({trainer:e,onEdit:t,onDelete:r})=>s.jsx(yt,{permissions:[Te.UPDATE_SUBJECT,Te.REMOVE_TRAINERS],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"Edit Trainer",icon:s.jsx(Yr,{}),onClick:()=>t(e.id),permission:Te.UPDATE_SUBJECT},{type:"divider"},{label:"Remove Trainer",icon:s.jsx(Fa,{}),className:"text-danger",onClick:()=>r(e.id),permission:Te.REMOVE_TRAINERS}]})}),A5=({show:e,onClose:t,onDisable:r,subject:a,loading:n=!1})=>{const[i,o]=v.useState(""),[l,c]=v.useState(""),[d,u]=v.useState(0),[m,f]=v.useState(!1),p=i==="ARCHIVE";v.useEffect(()=>{e&&a?.id?x():(u(0),o(""),c(""))},[e,a?.id]);const x=async()=>{if(a?.id){f(!0);try{const y=await Jr.getSubjectById(a.id);y?.enrollmentCount!==void 0?u(y.enrollmentCount):y?.enrollments&&Array.isArray(y.enrollments)?u(y.enrollments.length):u(0)}catch{u(0)}finally{f(!1)}}},g=()=>{o(""),c(""),u(0),t()},b=async()=>{if(!p){c('Please type "ARCHIVE" to confirm');return}try{await r(a?.id),g()}catch(y){c(y.message||"Failed to disable subject. Please try again.")}},j=y=>{o(y.target.value),c("")};return s.jsxs(ce,{show:e,onHide:g,centered:!0,children:[s.jsx(ce.Header,{className:"bg-warning text-dark border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Jt,{className:"me-2",size:20}),"Archive Subject"]})}),s.jsxs(ce.Body,{className:"p-4",children:[l&&s.jsx(De,{variant:"danger",className:"mb-3",children:l}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-2",children:"You are about to archive the following subject:"}),s.jsxs("div",{className:"bg-light p-3 rounded",children:[s.jsx("strong",{children:"Subject Code:"})," ",a?.code,s.jsx("br",{}),s.jsx("strong",{children:"Subject Name:"})," ",a?.name,s.jsx("br",{}),a?.description&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Description:"})," ",a?.description]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-warning mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-warning mb-3",children:[s.jsx("li",{children:"Make the subject unavailable for new enrollments"}),s.jsx("li",{children:"Remove the subject from active course offerings"}),s.jsx("li",{children:"Affect any ongoing training sessions"}),d>0&&s.jsxs("li",{className:"fw-bold",children:[s.jsxs("strong",{children:["Cascade cancel all ",d," enrollment",d>1?"s":""]})," associated with this subject"]})]}),d>0&&s.jsxs("div",{className:"alert alert-warning mb-0",children:[s.jsx("strong",{children:"Total Enrollments:"})," ",s.jsx(ke,{bg:"warning",className:"text-dark ms-2",children:d}),d>0&&s.jsxs("p",{className:"mb-0 mt-2 small",children:["All ",d," enrollment",d>1?"s":""," will be automatically cancelled when this subject is archived."]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",s.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),s.jsx("input",{type:"text",className:`form-control ${i&&!p?"is-invalid":""}`,id:"confirmText",value:i,onChange:j,placeholder:"Type ARCHIVE here",disabled:n}),i&&!p&&s.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsx(te,{variant:"outline-secondary",onClick:g,disabled:n,children:"Cancel"}),s.jsx(te,{variant:"warning",onClick:b,disabled:n||!p||m,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Jt,{className:"me-2",size:16}),"Archive Subject"]})})]})]})},Loe=({show:e,onClose:t,onSave:r,subject:a,loading:n=!1})=>{const[i,o]=v.useState({name:"",code:"",description:"",level:"Beginner"}),[l,c]=v.useState([]);v.useEffect(()=>{a&&e&&(o({name:a.name||"",code:a.code||"",description:a.description||"",level:a.level||"Beginner"}),c([]))},[a,e]);const d=h=>{const{name:p,value:x}=h.target;o(g=>({...g,[p]:x}))},u=()=>{const h=[];return i.name.trim()||h.push("Subject name is required"),i.code.trim()||h.push("Subject code is required"),i.description.trim()||h.push("Description is required"),c(h),h.length===0},m=async h=>{if(h.preventDefault(),!!u())try{await r(i),f()}catch{}},f=()=>{o({name:"",code:"",description:"",level:"Beginner"}),c([]),t()};return s.jsxs(ce,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Yr,{className:"me-2",size:20}),"Edit Subject"]}),s.jsx(te,{variant:"link",onClick:f,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",children:[l.length>0&&s.jsx(De,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:l.map((h,p)=>s.jsx("li",{children:h},p))})}),s.jsxs(k,{onSubmit:m,children:[s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Subject Name *"}),s.jsx(k.Control,{type:"text",name:"name",value:i.name,onChange:d,placeholder:"Enter subject name",disabled:n})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Subject Code *"}),s.jsx(k.Control,{type:"text",name:"code",value:i.code,onChange:d,placeholder:"Enter subject code",disabled:n})]})})]}),s.jsx(de,{children:s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Level"}),s.jsxs(k.Select,{name:"level",value:i.level,onChange:d,disabled:n,children:[s.jsx("option",{value:"Beginner",children:"Beginner"}),s.jsx("option",{value:"Intermediate",children:"Intermediate"}),s.jsx("option",{value:"Advanced",children:"Advanced"})]})]})})}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Description *"}),s.jsx(k.Control,{as:"textarea",rows:4,name:"description",value:i.description,onChange:d,placeholder:"Enter subject description",disabled:n})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:f,disabled:n,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"primary",onClick:m,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Yr,{className:"me-2",size:16}),"Save Changes"]})})]})]})},Moe=({show:e,onClose:t,onSave:r,trainer:a,loading:n=!1})=>{const[i,o]=v.useState({roleInSubject:"EXAMINER"}),[l,c]=v.useState([]);v.useEffect(()=>{if(a&&e){const h=a.role==="EXAMINER"||a.role==="ASSESSMENT_REVIEWER"?a.role:"EXAMINER";o({roleInSubject:h}),c([])}},[a,e]);const d=h=>{const{name:p,value:x}=h.target;o(g=>({...g,[p]:x}))},u=()=>{const h=[];return i.roleInSubject||h.push("Role in assessment is required"),c(h),h.length===0},m=async h=>{if(h.preventDefault(),!!u())try{await r(i),f()}catch{}},f=()=>{o({roleInSubject:"EXAMINER"}),c([]),t()};return s.jsxs(ce,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Yr,{className:"me-2",size:20}),"Edit Trainer"]}),s.jsx(te,{variant:"link",onClick:f,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",children:[l.length>0&&s.jsx(De,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:l.map((h,p)=>s.jsx("li",{children:h},p))})}),s.jsxs(k,{onSubmit:m,children:[s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Trainer Name"}),s.jsx(k.Control,{type:"text",value:a?.name||"",disabled:!0,className:"bg-light"})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"EID"}),s.jsx(k.Control,{type:"text",value:a?.eid||"",disabled:!0,className:"bg-light"})]})})]}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Role in Assessment *"}),s.jsxs(k.Select,{name:"roleInSubject",value:i.roleInSubject,onChange:d,disabled:n,children:[s.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]}),s.jsx(k.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:f,disabled:n,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"primary",onClick:m,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Yr,{className:"me-2",size:16}),"Save Changes"]})})]})]})},_5=({show:e,onClose:t,onSave:r,loading:a=!1,courseId:n=null})=>{const[i,o]=v.useState({trainer_user_id:"",role_in_subject:"EXAMINER"}),[l,c]=v.useState([]),[d,u]=v.useState([]),[m,f]=v.useState(!1),h=v.useCallback(async()=>{f(!0);try{let b=[];if(n)try{const j=await Nr.getAvailableTrainersForCourse(n);j&&(j.data&&Array.isArray(j.data)?b=j.data:j.trainers&&Array.isArray(j.trainers)?b=j.trainers:j.data&&j.data.trainers&&Array.isArray(j.data.trainers)?b=j.data.trainers:Array.isArray(j)&&(b=j))}catch(j){console.error("Error loading available trainers for course:",j),b=[]}else console.warn("No courseId provided. Cannot load available trainers."),b=[];u(Array.isArray(b)?b:[])}catch(b){console.error("Error loading trainers:",b),u([])}finally{f(!1)}},[n]);v.useEffect(()=>{e&&(o({trainer_user_id:"",role_in_subject:"EXAMINER"}),c([]),h())},[e,n,h]);const p=()=>{const b=[];return i.trainer_user_id||b.push("Please select a trainer"),i.role_in_subject||b.push("Role in assessment is required"),c(b),b.length===0},x=async b=>{if(b.preventDefault(),!!p())try{const j={trainerUserId:i.trainer_user_id,roleInSubject:i.role_in_subject};await r(j),g()}catch(j){console.error("Error saving trainer:",j)}},g=()=>{o({trainer_user_id:"",role_in_subject:"EXAMINER"}),c([]),t()};return s.jsxs(ce,{show:e,onHide:g,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Gr,{className:"me-2",size:20}),"Add Trainer"]}),s.jsx(te,{variant:"link",onClick:g,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",children:[l.length>0&&s.jsx(De,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:l.map((b,j)=>s.jsx("li",{children:b},j))})}),s.jsx(k,{onSubmit:x,children:s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Select Trainer *"}),s.jsxs(St,{onSelect:b=>{o(j=>({...j,trainer_user_id:b||""}))},children:[s.jsx(St.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:a||m,style:{border:"1px solid #ced4da",backgroundColor:a||m?"#e9ecef":"#fff",minWidth:0},children:s.jsx("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:i.trainer_user_id?d.find(b=>b.id===i.trainer_user_id)?`${d.find(b=>b.id===i.trainer_user_id).firstName} ${d.find(b=>b.id===i.trainer_user_id).lastName} - ${d.find(b=>b.id===i.trainer_user_id).department?.name||"General"}`:"Choose a trainer...":m?"Loading trainers...":"Choose a trainer..."})}),s.jsx(St.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:m?s.jsxs(St.Item,{disabled:!0,children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),"Loading trainers..."]}):!Array.isArray(d)||d.length===0?s.jsx(St.Item,{disabled:!0,children:"No trainers available"}):d.map(b=>s.jsxs(St.Item,{eventKey:b.id,children:[b.firstName," ",b.lastName," - ",b.department?.name||"General"]},b.id))})]}),m&&s.jsxs("div",{className:"mt-2 text-center",children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),s.jsx("small",{className:"text-muted",children:"Loading trainers..."})]})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Role in Assessment *"}),s.jsxs(St,{onSelect:b=>{o(j=>({...j,role_in_subject:b||"EXAMINER"}))},children:[s.jsx(St.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:a,style:{border:"1px solid #ced4da",backgroundColor:a?"#e9ecef":"#fff",minWidth:0},children:s.jsxs("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:[i.role_in_subject==="EXAMINER"&&"Examiner - Conducts exams and assessments",i.role_in_subject==="ASSESSMENT_REVIEWER"&&"Assessment Reviewer - Reviews and grades assessments"]})}),s.jsxs(St.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:[s.jsx(St.Item,{eventKey:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),s.jsx(St.Item,{eventKey:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]})]}),s.jsx(k.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})]})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:g,disabled:a,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"primary",onClick:x,disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Adding..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Gr,{className:"me-2",size:16}),"Add Trainer"]})})]})]})},k5=({courseId:e,subjectId:t,onView:r})=>{const[a,n]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e&&!t){n([]),o(!1);return}try{o(!0),c(null);const x=((await Sr.getAssessmentEvents())?.data?.events||[]).filter(g=>t?g.subjectId===t:e?g.courseId===e:!1).map((g,b)=>{let j="",y="";return g.entityInfo&&(g.entityInfo.type==="subject"?j=g.entityInfo.name||"":g.entityInfo.type==="course"&&(y=g.entityInfo.name||"")),{id:g.id||`event-${b}`,name:g.name||"N/A",subject:j,course:y,occurrenceDate:g.occuranceDate||g.occurrenceDate,status:g.status||"N/A",totalTrainees:g.totalTrainees||0,templateInfo:g.templateInfo,originalEvent:g}});n(x)}catch(f){console.error("Error loading assessment events:",f),c(f.response?.data?.message||f.message||"Failed to load assessment events"),J.error("Failed to load assessment events"),n([])}finally{o(!1)}})()},[e,t]);const d=m=>{switch(String(m||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},u=m=>{if(!m)return"-";try{return new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}};return i?s.jsx("div",{children:s.jsx(nr,{rows:4,columns:6})}):l?s.jsx("div",{children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:l})]})}):a.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx(fa,{size:48,className:"mb-3",style:{opacity:.5}}),s.jsx("h5",{children:"No assessment events found"}),s.jsxs("p",{children:["There are no assessment events available for this ",t?"subject":"course","."]})]})}):s.jsx("div",{children:s.jsx("div",{className:"table-responsive",children:s.jsxs(ar,{hover:!0,striped:!0,bordered:!0,className:"mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Name"}),!t&&s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Subject"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Template"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Occurrence Date"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Total Trainees"}),s.jsx("th",{className:"fw-semibold text-start",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Status"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:a.map((m,f)=>s.jsxs("tr",{style:{transition:"all 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor=""},children:[s.jsx("td",{className:"align-middle",children:s.jsx("span",{className:"fw-medium",children:m.name||"-"})}),!t&&s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:m.subject||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:m.templateInfo?.name||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:u(m.occurrenceDate)})}),s.jsx("td",{className:"align-middle",children:s.jsx(ke,{bg:"info",className:"px-2 py-1",children:m.totalTrainees||0})}),s.jsx("td",{className:"align-middle",children:s.jsx(ke,{bg:d(m.status),className:"px-3 py-2",children:m.status||"-"})}),s.jsx("td",{className:"align-middle text-center",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>r&&r(m.originalEvent||m)}]})})]},m.id||f))})]})})})},F1=({show:e,onClose:t,event:r})=>{if(!r)return null;const a=u=>{if(!u)return"-";try{return new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return u}},n=u=>{switch(String(u||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},i=r.entityInfo?.type||"-",o=r.entityInfo?.name||"-",l=r.entityInfo?.code||"-";r.entityInfo?.id;const c=r.templateInfo?.name||"-";r.templateInfo?.id;const d=r.templateInfo?.isActive??!1;return s.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,dialogClassName:"assessment-event-detail-modal",children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[s.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(fa,{className:"me-2",size:20}),"Assessment Event Details"]}),s.jsx(te,{variant:"link",onClick:t,className:"text-white p-0 ms-auto",style:{border:"none",background:"none",opacity:.9},children:s.jsx(st,{size:24,color:"#ffffff"})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",backgroundColor:"var(--bs-light)",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[s.jsxs(W,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[s.jsxs(W.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[s.jsx(xt,{className:"me-2",size:18}),s.jsx("span",{className:"fw-semibold",children:"Basic Information"})]}),s.jsx(W.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:s.jsxs(de,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Event Name"}),s.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:r.name||"-"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"text-muted mb-1 d-flex align-items-center",style:{fontSize:"0.875rem",fontWeight:600},children:[s.jsx(or,{className:"me-2",size:16,style:{color:"var(--bs-primary)"}}),"Occurrence Date"]}),s.jsx("span",{style:{color:"var(--bs-dark)"},children:a(r.occuranceDate||r.occurrenceDate)})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Status"}),s.jsx(ke,{bg:n(r.status),className:"px-3 py-2",children:r.status||"-"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("h6",{className:"text-muted mb-1 d-flex align-items-center",style:{fontSize:"0.875rem",fontWeight:600},children:[s.jsx(Mr,{className:"me-2",size:16,style:{color:"var(--bs-primary)"}}),"Total Trainees"]}),s.jsx(ke,{bg:"info",className:"px-3 py-2",children:r.totalTrainees||0})]})]})]})})]}),s.jsxs(W,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[s.jsxs(W.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[s.jsx(Dt,{className:"me-2",size:18}),s.jsx("span",{className:"fw-semibold",children:i==="course"?"Course Information":i==="subject"?"Subject Information":"Entity Information"})]}),s.jsx(W.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:s.jsxs(de,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Name"}),s.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:o})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Code"}),s.jsx(ke,{bg:"secondary",className:"px-2 py-1",children:l})]})]}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Type"}),s.jsx(ke,{bg:i==="course"?"primary":i==="subject"?"info":"secondary",className:"px-2 py-1",children:i.toUpperCase()})]})})]})})]}),s.jsxs(W,{className:"shadow-sm",style:{borderColor:"var(--bs-neutral-200)",marginBottom:"0 !important"},children:[s.jsxs(W.Header,{className:"bg-primary-custom text-white d-flex align-items-center",style:{backgroundColor:"var(--bs-primary)",borderBottom:"none"},children:[s.jsx(xt,{className:"me-2",size:18}),s.jsx("span",{className:"fw-semibold",children:"Template Information"})]}),s.jsx(W.Body,{className:"p-3",style:{backgroundColor:"#ffffff"},children:s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Template Name"}),s.jsx("p",{className:"mb-0 fw-semibold",style:{color:"var(--bs-dark)"},children:c})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",style:{fontSize:"0.875rem",fontWeight:600},children:"Status"}),s.jsx(ke,{bg:d?"success":"danger",className:"px-2 py-1",children:d?"Active":"Inactive"})]})})]})})]})]}),s.jsx(ce.Footer,{className:"border-top",children:s.jsx(te,{variant:"secondary",onClick:t,children:"Close"})})]})},Boe=({subjectId:e,courseId:t})=>{const r=tt(),a=ya(),[n,i]=v.useState(null),[o,l]=v.useState([]),[c,d]=v.useState(!0),[u,m]=v.useState(!1),[f,h]=v.useState(!1),[p,x]=v.useState(!1),[g,b]=v.useState(!1),[j,y]=v.useState(null),[w,S]=v.useState(!1),[N,E]=v.useState(!1),[P,T]=v.useState(!1),[O,_]=v.useState(!1),[C,R]=v.useState(!1),[M,U]=v.useState(null),[Z,ee]=v.useState("subject-info"),{sortedData:re}=_r(o),z=se=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"primary"},EXAMINER:{text:"Examiner",variant:"warning"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"info"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"secondary"}})[se]||{text:se,variant:"light"},me=v.useCallback(se=>{if(se&&se.instructors){const ae=se.instructors.map(K=>({id:K.id,eid:K.eid,name:`${K.firstName} ${K.lastName}`,role:K.roleInSubject,assignedAt:K.assignedAt}));l(ae)}else l([])},[]);v.useEffect(()=>{e&&(async()=>{if(!e){i(null),d(!1);return}d(!0);try{const ae=await Jr.getSubjectById(e);ae?(i(ae),me(ae)):i(null)}catch(ae){let K=ae.response?.data?.message||ae.message||"Failed to load subject details";if(ae.response?.data?.errors&&Array.isArray(ae.response.data.errors)&&ae.response.data.errors.length>0){const G=ae.response.data.errors[0];K=`${K}: ${G.message||G.field}`}J.error(K),i(null)}finally{d(!1)}})()},[e,me]);const ne=async se=>{E(!0);try{await new Promise(ae=>setTimeout(ae,1e3)),i(ae=>({...ae,...se})),J.success("Subject updated successfully!"),h(!1)}catch{J.error("Failed to update subject")}finally{E(!1)}},A=async()=>{S(!0);try{await new Promise(se=>setTimeout(se,1e3)),m(!1)}catch{}finally{S(!1)}},D=async se=>{T(!0);try{await Jr.addTrainerToSubject(e,se);const ae=await Jr.getSubjectById(e);ae&&(i(ae),me(ae)),J.success("Trainer added successfully!"),x(!1)}catch(ae){const K=ae?.message||ae?.error||"Failed to add trainer";J.error(K)}finally{T(!1)}},I=async se=>{if(j){_(!0);try{await Jr.updateTrainerRole(e,j.id,se);const ae=await Jr.getSubjectById(e);ae&&(i(ae),me(ae)),J.success("Trainer role updated successfully!"),b(!1)}catch(ae){console.error("Error updating trainer role:",ae);const K=ae?.message||ae?.error||"Failed to update trainer role";J.error(K)}finally{_(!1)}}},V=async se=>{if(se)try{await Jr.removeTrainerFromSubject(e,se);const ae=await Jr.getSubjectById(e);ae&&(i(ae),me(ae)),J.success("Trainer removed successfully!")}catch(ae){console.error("Error removing trainer:",ae);const K=ae?.message||ae?.error||"Failed to remove trainer";J.error(K)}},ie=()=>{if(t)r(je.ACADEMIC_COURSE_DETAIL(t));else if(a.state?.courseId)r(je.ACADEMIC_COURSE_DETAIL(a.state.courseId));else if(document.referrer){const se=document.referrer.match(/\/course-detail\/([^/]+)/);r(se?je.ACADEMIC_COURSE_DETAIL(se[1]):-1)}else n?.courseId?r(je.ACADEMIC_COURSE_DETAIL(n.courseId)):r(-1)};return c?s.jsx(Ce,{className:"py-4",children:s.jsx(nr,{rows:4,columns:3})}):n?s.jsxs(Ce,{className:"py-4 subject-details",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(te,{variant:"outline-secondary",onClick:ie,className:"me-3",children:[s.jsx(At,{className:"me-2",size:16}),"Back to Course"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:n.name}),s.jsxs("p",{className:"text-muted mb-0",children:["Subject Code: ",n.code]})]})]}),s.jsxs("div",{className:"d-flex gap-2",children:[" ",s.jsx(yt,{permission:Te.UPDATE_SUBJECT,fallback:null,children:s.jsxs(te,{variant:"primary",onClick:()=>h(!0),className:"d-flex align-items-center",size:"sm",children:[s.jsx(Yr,{size:16,className:"me-1"}),"Edit Subject"]})}),s.jsx(yt,{permission:Te.ARCHIVE_SUBJECT,fallback:null,children:s.jsxs(te,{variant:"outline-danger",onClick:()=>m(!0),className:"d-flex align-items-center",size:"sm",children:[s.jsx(Fa,{size:16,className:"me-1"}),"Archive Subject"]})})]})]}),s.jsx(W,{className:"border-0 shadow-sm",children:s.jsxs($t.Container,{activeKey:Z,onSelect:ee,children:[s.jsxs(W.Header,{className:"border-bottom py-2 bg-primary d-flex justify-content-between align-items-center",children:[s.jsxs(Xe,{variant:"tabs",className:"border-0",children:[s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"subject-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:Z==="subject-info"?"600":"400",opacity:Z==="subject-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(q2,{className:"me-2",size:16}),"Subject Information"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"trainers",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:Z==="trainers"?"600":"400",opacity:Z==="trainers"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Z2,{className:"me-2",size:16}),"Trainers"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"assessment-events",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:Z==="assessment-events"?"600":"400",opacity:Z==="assessment-events"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(fa,{className:"me-2",size:16}),"All Related Assessment Events"]})})]}),Z==="trainers"&&s.jsx(yt,{permission:Te.ASSIGN_TRAINERS,fallback:null,children:s.jsxs(te,{variant:"light",size:"sm",onClick:()=>x(!0),className:"d-flex align-items-center",style:{backgroundColor:"#ffffff",borderColor:"#dee2e6",color:"#000000",fontWeight:500},onMouseEnter:se=>{se.currentTarget.style.backgroundColor="#f8f9fa",se.currentTarget.style.borderColor="#dee2e6"},onMouseLeave:se=>{se.currentTarget.style.backgroundColor="#ffffff",se.currentTarget.style.borderColor="#dee2e6"},children:[s.jsx(Gr,{size:14,className:"me-1"}),"Add Trainer"]})})]}),s.jsx(W.Body,{className:"p-0",children:s.jsxs($t.Content,{children:[s.jsx($t.Pane,{eventKey:"subject-info",children:s.jsxs("div",{className:"p-4",children:[s.jsxs(de,{children:[s.jsxs(H,{md:6,children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",n.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Code:"})," ",n.code]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Description:"})," ",n.description]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Method:"})," ",n.method]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Duration:"})," ",n.duration," days"]})]}),s.jsxs(H,{md:6,children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Type:"})," ",n.type]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Pass Score:"})," ",n.passScore]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Room:"})," ",n.roomName]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Time Slot:"})," ",n.timeSlot]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Start Date:"})," ",new Date(n.startDate).toLocaleDateString()]}),s.jsxs("p",{children:[s.jsx("strong",{children:"End Date:"})," ",new Date(n.endDate).toLocaleDateString()]})]})]}),n.remarkNote&&s.jsx(de,{children:s.jsx(H,{xs:12,children:s.jsxs("p",{children:[s.jsx("strong",{children:"Remark Note:"})," ",n.remarkNote]})})})]})}),s.jsx($t.Pane,{eventKey:"trainers",children:s.jsx("div",{className:"scrollable-table-container admin-table trainer-table-scroll",children:s.jsxs(ar,{hover:!0,className:"mb-0",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"EID"}),s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"Name"}),s.jsx("th",{className:"fw-semibold",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"Role"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",borderLeft:"none",borderRight:"none"},children:"Actions"})]})}),s.jsx("tbody",{children:re.map((se,ae)=>{const K=z(se.role);return s.jsxs("tr",{className:`${ae%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:G=>{G.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:G=>{G.currentTarget.style.backgroundColor=ae%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:s.jsx(ke,{bg:"secondary",className:"text-white",children:se.eid})}),s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:s.jsx("span",{className:"fw-medium text-dark",children:se.name})}),s.jsx("td",{className:"align-middle",style:{borderLeft:"none",borderRight:"none"},children:s.jsx(ke,{bg:K.variant,children:K.text})}),s.jsx("td",{className:"align-middle text-center",style:{borderLeft:"none",borderRight:"none"},children:s.jsx(Foe,{trainer:se,onEdit:()=>{y(se),b(!0)},onDelete:V})})]},se.id)})})]})})}),s.jsx($t.Pane,{eventKey:"assessment-events",style:{height:"100%"},children:s.jsx(k5,{subjectId:e,courseId:t,onView:se=>{U(se),R(!0)}})})]})})]})}),s.jsx(A5,{show:u,onClose:()=>m(!1),onConfirm:A,subject:n,loading:w}),s.jsx(Loe,{show:f,onClose:()=>h(!1),onSave:ne,subject:n,loading:N}),s.jsx(_5,{show:p,onClose:()=>x(!1),onSave:D,loading:P,courseId:t}),s.jsx(Moe,{show:g,onClose:()=>b(!1),onSave:I,trainer:j,loading:O}),s.jsx(F1,{show:C,onClose:()=>{R(!1),U(null)},event:M})]}):s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{children:"Subject not found"}),s.jsx("p",{children:"The requested subject could not be found."}),s.jsxs(te,{variant:"primary",onClick:ie,children:[s.jsx(At,{className:"me-2",size:16}),"Go Back"]})]})})},g2=()=>{const{subjectId:e,courseId:t}=ur();return s.jsx(Boe,{subjectId:e,courseId:t})},zoe=({subject:e,onView:t,onEdit:r,onDelete:a})=>{const n=()=>{t&&t(e.id)},i=()=>{a&&a(e.id)};return s.jsx(yt,{permissions:[Te.VIEW_SUBJECT_DETAIL,Te.ARCHIVE_SUBJECT],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:n,permission:Te.VIEW_SUBJECT_DETAIL},{type:"divider"},{label:"Archive Subject",icon:s.jsx(L2,{}),className:"text-warning",onClick:i,permission:Te.ARCHIVE_SUBJECT}]})})},$oe=e=>({id:e.id,name:e.name,code:e.code,method:e.method,duration:Woe(e.duration),startDate:v2(e.startDate||e.start_date),endDate:v2(e.endDate||e.end_date),roomName:e.roomName||e.room_name,trainees:e.enrollmentCount||e.enrollment_count||0,status:e.status||(e.deletedAt?"ARCHIVED":"PLANNED"),description:e.description,type:e.type,remarkNote:e.remarkNote||e.remark_note,timeSlot:e.timeSlot||e.time_slot,passScore:e.passScore||e.pass_score,isSIM:e.isSIM||e.is_sim,courseId:e.courseId||e.course_id,course:e.course,createdBy:e.createdBy||e.created_by,updatedBy:e.updatedBy||e.updated_by,instructorCount:e.instructorCount||e.instructor_count||0,source:"api_data"}),Uoe=e=>e.map($oe),Woe=e=>{if(!e&&e!==0)return"N/A";if(e<1){const t=Math.round(e*24);return t===0?"< 1 hour":t===1?"1 hour":`${t} hours`}return e===1?"1 day":e<7?`${e} days`:e===7?"1 week":e<14?`${Math.round(e/7)} weeks`:e===14?"2 weeks":`${Math.round(e/7)} weeks`},v2=e=>{if(!e)return"N/A";try{return new Date(e).toISOString().split("T")[0]}catch{return"Invalid Date"}},Hoe=e=>{switch(e?.toUpperCase()){case"ACTIVE":case"ON-GOING":case"ONGOING":return"success";case"PLANNED":return"info";case"COMPLETED":return"primary";case"ARCHIVED":case"INACTIVE":return"secondary";default:return"secondary"}},Voe=e=>{switch(e?.toUpperCase()){case"CLASSROOM":return"info";case"E_LEARNING":case"E-LEARNING":case"ELEARNING":return"primary";case"ERO":return"warning";case"PRACTICAL":return"warning";case"MIXED":return"primary";default:return"secondary"}},Goe=({subjects:e=[],loading:t=!1,onView:r,onEdit:a,onDelete:n})=>{const i=Uoe(e),{sortedData:o,sortConfig:l,handleSort:c}=_r(i);if(t)return s.jsx(nr,{rows:4,columns:5});if(i.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"This course doesn't have any subjects yet."})]})});const d=({columnKey:u,children:m,className:f=""})=>{const h=l.key===u,p=h?l.direction:null;return s.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),s.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:s.jsx(rs,{direction:p,size:14,color:"white"})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsx("div",{className:"department-table-container subject-table-scroll",style:{overflowX:"hidden"},children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(d,{columnKey:"name",className:"show-mobile",children:"Name"}),s.jsx(d,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(d,{columnKey:"method",className:"show-mobile",children:"Method"}),s.jsx(d,{columnKey:"duration",className:"show-mobile",children:"Duration"}),s.jsx(d,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),s.jsx(d,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),s.jsx(d,{columnKey:"roomName",className:"show-mobile",children:"Room Name"}),s.jsx(d,{columnKey:"trainees",className:"show-mobile",children:"Trainees"}),s.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px",textTransform:"uppercase",letterSpacing:"0.5px"},children:s.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),s.jsx("tbody",{children:o.map(u=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>r&&r(u.id),style:{cursor:"pointer"},children:u.name})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(ke,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:u.code,children:u.code})}),s.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:s.jsx(ke,{bg:Voe(u.method),className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:u.method,children:u.method})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:u.duration})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:u.startDate})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:u.endDate})}),s.jsx("td",{className:"show-mobile",children:s.jsx("span",{className:"text-dark",children:u.roomName})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Mr,{size:14,className:"me-1 text-muted"}),s.jsx("span",{className:"text-dark",children:u.trainees||0})]})}),s.jsx("td",{className:"show-mobile",children:s.jsxs(ke,{bg:Hoe(u.status),className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:u.status==="ACTIVE"||u.status==="ON-GOING"||u.status==="ONGOING"?"":""}),u.status||"N/A"]})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(zoe,{subject:u,onView:r,onEdit:a,onDelete:n})})]},u.id))})]})})},qoe=({trainee:e,onViewSubjects:t,onRemoveTrainee:r})=>s.jsx(yt,{permissions:[Te.VIEW_SUBJECT_DETAIL,Te.REMOVE_TRAINEE_FROM_ENROLLMENT],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Subject List",icon:s.jsx(Bt,{}),onClick:()=>t(e),permission:Te.VIEW_SUBJECT_DETAIL},{type:"divider"},{label:"Remove Trainee",icon:s.jsx(Fa,{}),className:"text-danger",onClick:()=>r(e.id),permission:Te.REMOVE_TRAINEE_FROM_ENROLLMENT}]})}),Koe=({show:e,onClose:t,onConfirm:r,trainee:a,subjectName:n=null,loading:i=!1})=>{const o=!n,l=o?"Remove Trainee from All Subjects":"Remove Trainee from Subject",c=o?"Remove from All Subjects":"Remove from Subject",d=()=>{r(),t()};return s.jsxs(ce,{show:e,onHide:t,centered:!0,children:[s.jsx(ce.Header,{className:"bg-danger text-white border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Jt,{className:"me-2",size:20}),l]})}),s.jsxs(ce.Body,{className:"p-4",children:[s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"mb-3",children:["Are you sure you want to remove ",s.jsxs("strong",{children:['"',a?.name,'"']}),o?" from ALL subjects":` from "${n}"`,"?"]}),s.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[s.jsx("strong",{children:"Trainee:"})," ",a?.name,s.jsx("br",{}),s.jsx("strong",{children:"EID:"})," ",a?.eid,!o&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("strong",{children:"Subject:"})," ",n]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-danger mb-2",children:[s.jsx("strong",{children:"Warning:"})," This action will:"]}),s.jsxs("ul",{className:"text-danger mb-3",children:[o?s.jsxs(s.Fragment,{children:[s.jsx("li",{children:"Remove the trainee from all enrolled subjects"}),s.jsx("li",{children:"Cancel all ongoing training sessions for this trainee"}),s.jsx("li",{children:"Remove the trainee from the course completely"})]}):s.jsxs(s.Fragment,{children:[s.jsx("li",{children:"Remove the trainee from this specific subject only"}),s.jsx("li",{children:"Cancel any ongoing training sessions for this subject"}),s.jsx("li",{children:"Keep the trainee enrolled in other subjects"})]}),s.jsx("li",{children:s.jsx("strong",{children:"Cannot be undone"})})]})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsx(te,{variant:"outline-secondary",onClick:t,disabled:i,children:"Cancel"}),s.jsx(te,{variant:"danger",onClick:d,disabled:i,children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Fa,{className:"me-2",size:16}),c]})})]})]})},Yoe=({courseId:e,loading:t=!1,title:r="Enrolled Trainees"})=>{const[a,n]=v.useState([]),i=v.useRef({}),[o,l]=v.useState(!0),[c,d]=v.useState(!1),[u,m]=v.useState(null),[f,h]=v.useState(!1),[p,x]=v.useState(null),[g,b]=v.useState(null),[j,y]=v.useState(!1),{sortedData:w,sortConfig:S,handleSort:N}=_r(a),E=v.useCallback(async()=>{if(!e){n([]),l(!1);return}l(!0);try{const M=await Nr.getCourseTrainees(e),U=M?.trainees||M?.data?.trainees||[];if(!Array.isArray(U)||U.length===0){n([]),l(!1);return}const Z=U.map(async z=>{try{if(i.current[z.id]){const A=i.current[z.id].filter(D=>D.enrollment?.status==="ENROLLED");return A.length>0?{id:z.id,eid:z.eid,name:`${z.firstName||""} ${z.lastName||""}`.trim()||z.name||"Unknown",subjects:A.map(D=>D.subject.id),userId:z.id,email:z.email||"",department:z.department||null}:null}const me=await Nr.getTraineeEnrollments(z.id);if(me?.enrollments&&(i.current[z.id]=me.enrollments),me&&me.enrollments&&me.enrollments.length>0){const ne=me.enrollments.filter(A=>A.enrollment?.status==="ENROLLED");if(ne.length>0){const A=ne.map(D=>D.subject.id);return{id:z.id,eid:z.eid,name:`${z.firstName||""} ${z.lastName||""}`.trim()||z.name||"Unknown",subjects:A,userId:z.id,email:z.email||"",department:z.department||null}}}return null}catch{return null}}),re=(await Promise.all(Z)).filter(z=>z!==null);n(re)}catch(M){console.error("Error loading enrolled trainees:",M),n([])}finally{l(!1)}},[e]);v.useEffect(()=>{e&&E()},[e,E]);const P=async M=>{try{let U=null;i.current[M.userId]?U={enrollments:i.current[M.userId]}:(U=await Nr.getTraineeEnrollments(M.userId),U?.enrollments&&(i.current[M.userId]=U.enrollments));const Z=U.enrollments?.filter(re=>re.enrollment?.status==="ENROLLED")||[],ee={...M,enrollmentDetails:U,subjects:Z.map(re=>({id:re.subject.id,name:re.subject.name,code:re.subject.code,status:re.subject.status,type:re.subject.type,method:re.subject.method,startDate:re.subject.startDate,endDate:re.subject.endDate,course:re.subject.course,enrollment:re.enrollment}))};m(ee),d(!0)}catch{m(M),d(!0)}},T=M=>{const U=a.find(Z=>Z.id===M);U&&(x(U),b(null),h(!0))},O=async()=>{if(p){y(!0);try{let M=null;if(i.current[p.userId]?M={enrollments:i.current[p.userId]}:(M=await Nr.getTraineeEnrollments(p.userId),M?.enrollments&&(i.current[p.userId]=M.enrollments)),M&&M.enrollments&&M.enrollments.length>0){const Z=M.enrollments.map(async ee=>{const re=ee.subject.id,z=ee.enrollment?.batchCode||"TEST0012025";return ee.enrollment?.status!=="ENROLLED"?null:Jr.removeTraineeFromSubject(re,p.userId,z)}).filter(ee=>ee!==null);Z.length>0&&await Promise.all(Z),delete i.current[p.userId],await E(),J.success(`Successfully removed ${p.name} from all subjects`,{autoClose:3e3,position:"top-right",icon:!1}),h(!1)}else J.warning(`No enrollments found for ${p.name}`,{autoClose:3e3,position:"top-right",icon:!1}),h(!1)}catch(M){const U=M?.response?.data?.message||M?.message||"Failed to remove trainee from subjects";J.error(`Error: ${U}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{y(!1)}}},_=(M,U)=>{const Z=a.find(z=>z.id===M);if(!Z)return;const ee=u?.subjects?.find(z=>z.id===U),re=ee?ee.name:"Unknown Subject";x(Z),b(re),h(!0)},C=async()=>{if(!p||!g)return;const M=u?.subjects?.find(U=>U.name===g);if(!M){J.error("Subject not found",{autoClose:3e3,position:"top-right",icon:!1});return}y(!0);try{const U=M.enrollment?.batchCode||"TEST0012025";if(M.enrollment?.status!=="ENROLLED"){J.warning(`Cannot remove trainee from ${g}. Enrollment status is not ENROLLED.`,{autoClose:4e3,position:"top-right",icon:!1}),y(!1);return}await Jr.removeTraineeFromSubject(M.id,p.userId,U),delete i.current[p.userId],await E(),J.success(`Successfully removed ${p.name} from ${g}`,{autoClose:3e3,position:"top-right",icon:!1}),h(!1),d(!1)}catch(U){const Z=U?.response?.data?.message||U?.message||"Failed to remove trainee from subject";J.error(`Error: ${Z}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{y(!1)}};if(t||o)return s.jsx("div",{children:s.jsx(nr,{rows:4,columns:4})});if(a.length===0)return s.jsx("div",{children:s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No enrolled trainees"}),s.jsx("p",{children:"No trainees have been enrolled in any subjects yet."})]})})});const R=({columnKey:M,children:U,className:Z=""})=>{const ee=S.key===M,re=ee?S.direction:null;return s.jsxs("th",{className:`fw-semibold ${Z}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>N(M),onMouseEnter:z=>{z.target.style.backgroundColor="#214760",z.target.style.transform="translateY(-1px)",z.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:z=>{z.target.style.backgroundColor="var(--bs-primary)",z.target.style.transform="translateY(0)",z.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:ee?"700":"600",color:"white"},children:U}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:re,size:14,color:"white"})})]}),ee&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"d-flex flex-column",style:{height:"400px",width:"100%"},children:s.jsx("div",{className:"p-0",style:{flex:1,minHeight:0,overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",overflowY:"auto"},children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",children:[s.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:s.jsxs("tr",{children:[s.jsx(R,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(R,{columnKey:"eid",className:"show-mobile",children:"EID"}),s.jsx(R,{columnKey:"subjects",className:"show-mobile",children:"Total Subject"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:w.map(M=>s.jsxs("tr",{children:[s.jsx("td",{className:"show-mobile",children:s.jsx("div",{className:"fw-semibold text-primary-custom",children:M.name})}),s.jsx("td",{className:"show-mobile",children:s.jsx(ke,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:M.eid})}),s.jsx("td",{className:"show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Mr,{size:14,className:"me-1 text-muted"}),s.jsxs(ke,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[M.subjects.length," subjects"]})]})}),s.jsx("td",{className:"text-center show-mobile",children:s.jsx(qoe,{trainee:M,onViewSubjects:P,onRemoveTrainee:T})})]},M.id))})]})})})}),s.jsxs(ce,{show:c,onHide:()=>d(!1),size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-gradient-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center text-white",children:[s.jsx(Mr,{className:"me-2",size:20}),u?.name," - Enrolled Subjects"]}),s.jsx(te,{variant:"link",onClick:()=>d(!1),className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsx(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:u&&s.jsxs("div",{children:[s.jsx("div",{className:"mb-4 p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:s.jsxs("div",{className:"row align-items-center",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:"Trainee Information"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ke,{bg:"primary-custom",className:"me-2 text-white",children:"EID"}),s.jsx("span",{className:"fw-semibold text-primary-custom",children:u.eid})]})]}),s.jsx("div",{className:"col-md-6 text-md-end",children:s.jsx("div",{className:"text-primary-custom small",children:s.jsxs("div",{children:["Total Subjects: ",s.jsx(ke,{bg:"primary-custom",className:"text-white",children:u.subjects.length})]})})})]})}),s.jsx("div",{className:"row g-3",children:u.subjects.map(M=>s.jsx("div",{className:"col-12",children:s.jsx(W,{className:"border-0 shadow-sm",children:s.jsx(W.Body,{className:"p-3",children:s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-8",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:M.name}),s.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[s.jsx(ke,{bg:"primary-custom",className:"text-white",children:M.code}),s.jsx(ke,{bg:M.status==="ACTIVE"?"success":"primary-custom",className:M.status==="ACTIVE"?"":"text-white",children:M.status})]})]}),s.jsx(yt,{permission:Te.REMOVE_TRAINEE_FROM_ENROLLMENT,fallback:null,children:s.jsx(te,{size:"sm",variant:"outline-danger",className:"ms-2",onClick:()=>{_(u.id,M.id)},children:s.jsx(st,{size:14})})}),"                            "]}),s.jsxs("div",{className:"row g-2 mb-3",children:[s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Type:"}),s.jsx(ke,{bg:"primary-custom",className:"text-white",children:M.type})]})}),s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Method:"}),s.jsx(ke,{bg:"primary-custom",className:"text-white",children:M.method})]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Course:"}),s.jsx("span",{className:"fw-medium text-primary-custom",children:M.course?.name})]})]}),M.enrollment&&s.jsx("div",{className:"col-md-4",children:s.jsxs("div",{className:"p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:[s.jsx("h6",{className:"text-primary-custom mb-2 fw-bold",children:"Enrollment Details"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Status:"}),s.jsx(ke,{bg:"primary-custom",className:"text-white",children:M.enrollment.status})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Batch:"}),s.jsx("span",{className:"fw-medium small text-primary-custom",children:M.enrollment.batchCode})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Enrolled:"}),s.jsx("span",{className:"fw-medium small text-primary-custom",children:new Date(M.enrollment.enrollmentDate).toLocaleDateString()})]})]})]})})]})})})},M.id))})]})}),s.jsx(ce.Footer,{className:"border-top",children:s.jsx(te,{variant:"primary-custom",className:"text-white",onClick:()=>d(!1),children:"Close"})})]}),s.jsx(Koe,{show:f,onClose:()=>{h(!1),x(null),b(null),y(!1)},onConfirm:g?C:O,trainee:p,subjectName:g,loading:j})]})},Xoe=({show:e,onClose:t,onSave:r,loading:a=!1,courseId:n})=>{const[i,o]=v.useState({name:"",code:"",description:"",method:"CLASSROOM",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[l,c]=v.useState([]),[d,u]=v.useState(!1);v.useEffect(()=>{e&&n&&(o({name:"",code:"",description:"",method:"CLASSROOM",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]))},[e,n]);const m=x=>{const{name:g,value:b,type:j,checked:y}=x.target;o(w=>({...w,[g]:j==="checkbox"?y:b}))},f=()=>{const x=[];return n||x.push("Course ID is required"),i.name.trim()||x.push("Subject name is required"),i.code.trim()||x.push("Subject code is required"),i.passScore.trim()&&(isNaN(i.passScore)||parseFloat(i.passScore)<0||parseFloat(i.passScore)>100)&&x.push("Pass score must be between 0 and 100"),i.startDate.trim()||x.push("Start date is required"),i.endDate.trim()||x.push("End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&x.push("End date must be after start date"),c(x),x.length===0},h=async x=>{if(x.preventDefault(),!!f()){u(!0);try{const g={courseId:n,name:i.name.trim(),code:i.code.trim(),description:i.description.trim()||null,method:i.method,type:i.type,roomName:i.roomName.trim()||null,remarkNote:i.remarkNote.trim()||null,timeSlot:i.timeSlot.trim()||null,isSIM:i.isSIM,passScore:i.passScore.trim()?parseFloat(i.passScore):null,startDate:i.startDate,endDate:i.endDate},b=await be.post("/subjects",g);J.success("Subject created successfully!"),r&&await r(b.data||g),p()}catch(g){const b=g.response?.data?.message||g.message||"Failed to create subject";J.error(`Error: ${b}`),c([b])}finally{u(!1)}}},p=()=>{o({name:"",code:"",description:"",method:"CLASSROOM",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]),u(!1),t()};return s.jsxs(ce,{show:e,onHide:p,size:"lg",centered:!0,style:{maxHeight:"90vh"},children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Gr,{className:"me-2",size:20}),"Add New Subject"]}),s.jsx(te,{variant:"link",onClick:p,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[l.length>0&&s.jsx(De,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:l.map((x,g)=>s.jsx("li",{children:x},g))})}),s.jsxs(k,{onSubmit:h,children:[s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Subject Name *"}),s.jsx(k.Control,{type:"text",name:"name",value:i.name,onChange:m,placeholder:"Enter subject name",required:!0})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Subject Code *"}),s.jsx(k.Control,{type:"text",name:"code",value:i.code,onChange:m,placeholder:"Enter subject code",required:!0})]})})]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Description"}),s.jsx(k.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,placeholder:"Enter subject description"})]}),s.jsx(de,{children:s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Method *"}),s.jsxs(k.Select,{name:"method",value:i.method,onChange:m,required:!0,children:[s.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),s.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),s.jsx("option",{value:"ERO",children:"ERO"})]})]})})}),s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Type *"}),s.jsxs(k.Select,{name:"type",value:i.type,onChange:m,required:!0,children:[s.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),s.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Room Name"}),s.jsx(k.Control,{type:"text",name:"roomName",value:i.roomName,onChange:m,placeholder:"Enter room name"})]})})]}),s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Time Slot"}),s.jsx(k.Control,{type:"text",name:"timeSlot",value:i.timeSlot,onChange:m,placeholder:"e.g., 09:00-11:00"})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Pass Score"}),s.jsx(k.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,placeholder:"Enter pass score (0-100)",min:"0",max:"100",step:"0.01"})]})})]}),s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Start Date *"}),s.jsx(k.Control,{type:"date",name:"startDate",value:i.startDate,onChange:m,required:!0})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"End Date *"}),s.jsx(k.Control,{type:"date",name:"endDate",value:i.endDate,onChange:m,required:!0})]})})]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Remark Note"}),s.jsx(k.Control,{as:"textarea",rows:2,name:"remarkNote",value:i.remarkNote,onChange:m,placeholder:"Enter remark note"})]}),s.jsx(k.Group,{className:"mb-3",children:s.jsx(k.Check,{type:"checkbox",name:"isSIM",checked:i.isSIM,onChange:m,label:"Is Simulator"})})]})]}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsx(te,{variant:"secondary",onClick:p,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:h,disabled:d,children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):"Create Subject"})]})]})},Joe=({show:e,onClose:t,onImport:r,loading:a=!1,courseId:n})=>{const[i,o]=v.useState(!1),[l,c]=v.useState(null),[d,u]=v.useState([]),[m,f]=v.useState([]),[h,p]=v.useState([]),x=v.useRef(null),g=["code","name","course_id"],b=["code","name","course_id","description","method","duration","type","room_name","remark_note","time_slot","pass_score","start_date","end_date","is_sim"],j=_=>{_.preventDefault(),_.stopPropagation(),_.type==="dragenter"||_.type==="dragover"?o(!0):_.type==="dragleave"&&o(!1)},y=_=>{_.preventDefault(),_.stopPropagation(),o(!1),_.dataTransfer.files&&_.dataTransfer.files[0]&&S(_.dataTransfer.files[0])},w=_=>{_.target.files&&_.target.files[0]&&S(_.target.files[0])},S=_=>{if(!_.name.match(/\.(xlsx|xls)$/)){f(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(_.size>100*1024*1024){f(["File size must be less than 100MB"]);return}c(_),f([]),N(_)},N=_=>{const C=new FileReader;C.onload=R=>{try{const M=new Uint8Array(R.target.result),U=mc(M,{type:"array"}),Z=U.SheetNames[0],ee=U.Sheets[Z],re=Oa.sheet_to_json(ee,{header:1});if(re.length<2){f(["Excel file must contain at least a header row and one data row"]);return}const z=re[0].map(I=>I?.toString().toLowerCase().trim()),me=re.slice(1),A=(n?g.filter(I=>I!=="course_id"):g).filter(I=>!z.includes(I));if(A.length>0){f([`Missing required columns: ${A.join(", ")}`]);return}const D=me.map((I,V)=>{const ie=z.includes("course_id")?I[z.indexOf("course_id")]?.toString().trim()||"":n||"",se={id:`temp_${V}`,rowNumber:V+2,code:I[z.indexOf("code")]?.toString().trim()||"",name:I[z.indexOf("name")]?.toString().trim()||"",course_id:ie,description:I[z.indexOf("description")]?.toString().trim()||"",method:I[z.indexOf("method")]?.toString().trim()||"THEORY",duration:I[z.indexOf("duration")]?.toString().trim()||"",type:I[z.indexOf("type")]?.toString().trim()||"MANDATORY",room_name:I[z.indexOf("room_name")]?.toString().trim()||"",remark_note:I[z.indexOf("remark_note")]?.toString().trim()||"",time_slot:I[z.indexOf("time_slot")]?.toString().trim()||"",pass_score:I[z.indexOf("pass_score")]?.toString().trim()||"",start_date:(()=>{const ae=I[z.indexOf("start_date")];return ae?ae instanceof Date?ae.toISOString().split("T")[0]:typeof ae=="number"?ae:String(ae).trim():""})(),end_date:(()=>{const ae=I[z.indexOf("end_date")];return ae?ae instanceof Date?ae.toISOString().split("T")[0]:typeof ae=="number"?ae:String(ae).trim():""})(),is_sim:z.includes("is_sim")||z.includes("issim")?I[z.indexOf(z.includes("is_sim")?"is_sim":"issim")]:void 0,hasError:!1,errors:[]};if(se.code||(se.hasError=!0,se.errors.push("Subject code is required")),se.name||(se.hasError=!0,se.errors.push("Subject name is required")),!se.course_id&&!n?(se.hasError=!0,se.errors.push("Course ID is required (either in file or must be importing from course detail page)")):se.course_id&&(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(se.course_id)||(se.hasError=!0,se.errors.push("Course ID must be a valid UUID format"))),se.duration&&(isNaN(se.duration)||parseInt(se.duration)<=0)&&(se.hasError=!0,se.errors.push("Duration must be a positive number")),se.pass_score&&(isNaN(se.pass_score)||parseFloat(se.pass_score)<0||parseFloat(se.pass_score)>100)&&(se.hasError=!0,se.errors.push("Pass score must be between 0 and 100")),se.method){let ae=se.method.toUpperCase().trim();ae==="E-LEARNING"||ae==="E LEARNING"||ae==="ELEARNING"?ae="E_LEARNING":ae==="CLASSROOM"||ae==="CLASS ROOM"||ae==="CLASS-ROOM"?ae="CLASSROOM":ae==="ERO"&&(ae="ERO"),se.method=ae,["E_LEARNING","CLASSROOM","ERO"].includes(ae)||(se.hasError=!0,se.errors.push("Method must be E_LEARNING, CLASSROOM, or ERO"))}if(se.type&&!["UNLIMIT","RECURRENT"].includes(se.type.toUpperCase())&&(se.hasError=!0,se.errors.push("Type must be UNLIMIT or RECURRENT")),se.start_date)try{let ae;if(typeof se.start_date=="number"&&se.start_date>1e4){const K=parseFloat(se.start_date);ae=new Date((K-25569)*86400*1e3)}else{const K=String(se.start_date).trim();ae=new Date(K)}isNaN(ae.getTime())&&(se.hasError=!0,se.errors.push("Start date must be a valid date"))}catch{se.hasError=!0,se.errors.push("Start date must be a valid date")}if(se.end_date)try{let ae;if(typeof se.end_date=="number"&&se.end_date>1e4){const K=parseFloat(se.end_date);ae=new Date((K-25569)*86400*1e3)}else{const K=String(se.end_date).trim();ae=new Date(K)}isNaN(ae.getTime())&&(se.hasError=!0,se.errors.push("End date must be a valid date"))}catch{se.hasError=!0,se.errors.push("End date must be a valid date")}return se}).filter(I=>I.code||I.name);u(D),p([])}catch{f(["Failed to parse Excel file. Please check the file format."])}},C.readAsArrayBuffer(_)},E=async()=>{const _=d.filter(R=>!R.hasError);if(_.length===0){f(["No valid subjects to import"]);return}if(!n&&_.filter(M=>!M.course_id).length>0){f(["Course ID is required. Please ensure courseId is provided when importing from Course Detail page, or include course_id column in your Excel file."]);return}const C=_.map(R=>{let M=!1;const U=R.is_sim!==void 0?R.is_sim:void 0;if(U!=null&&U!=="")if(typeof U=="string"){const me=U.toLowerCase().trim();M=["true","1","yes","y"].includes(me)}else typeof U=="boolean"?M=U:typeof U=="number"&&(M=U!==0);const Z=me=>{if(!me||me===""||me==="N/A")return null;try{let ne;if(typeof me=="string"){const D=me.trim();if(/^\d+$/.test(D)){const I=parseInt(D);if(I>=1&&I<=1e5){const se=(I-25569)*86400*1e3;ne=new Date(se);const ae=ne.getFullYear();(ae<1900||ae>2100)&&(ne=new Date(D))}else ne=new Date(I<1e12?I*1e3:I)}else{if(D.includes("T")&&D.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/))return D;D.match(/^\d{4}-\d{2}-\d{2}$/)?ne=new Date(D+"T00:00:00.000Z"):ne=new Date(D)}}else typeof me=="number"?me>=1&&me<=1e5?ne=new Date((me-25569)*86400*1e3):me>1e5&&me<1e12?ne=new Date(me*1e3):ne=new Date(me):ne=new Date(me);if(isNaN(ne.getTime()))return null;const A=ne.getFullYear();return A<1900||A>2100?null:ne.toISOString()}catch{return null}},ee=Z(R.start_date),re=Z(R.end_date),z={code:R.code,name:R.name,courseId:String(n||R.course_id),description:R.description||"",method:R.method?R.method.toUpperCase():"CLASSROOM",duration:R.duration?parseInt(R.duration):1,type:R.type?R.type.toUpperCase():"UNLIMIT",roomName:R.room_name||"",remarkNote:R.remark_note||"",timeSlot:R.time_slot||"",passScore:R.pass_score?parseFloat(R.pass_score):70,isSIM:M};return ee&&(z.startDate=ee),re&&(z.endDate=re),z});try{const R=await r(C);let M=R;R&&R.data&&typeof R.data=="object"&&(M=R.data);const U=M?.summary?.created??M?.createdSubjects?.length??M?.summary?.createdCount??M?.subjects?.length??0,Z=M?.summary?.failed??M?.failedSubjects?.length??M?.summary?.failedCount??0,ee=M?.summary?.skipped??M?.skippedSubjects?.length??M?.summary?.skippedCount??0,re=M?.summary?.total??C.length;if(!(M?.summary||M?.createdSubjects!==void 0||M?.failedSubjects!==void 0)&&R!==null&&R!==void 0&&!R?.error&&!R?.message?.toLowerCase().includes("fail")){J.success(`Imported ${re}/${re} subjects successfully.`,{icon:!1}),P();return}const ne=(!M||U===0&&Z===0&&ee===0&&re===0)&&!R?.error&&M?.message?.toLowerCase().includes("exist");M?.failedSubjects&&Array.isArray(M.failedSubjects)&&M.failedSubjects.length>0&&M.failedSubjects.forEach(A=>{const D=A.subject?.name||"Unknown Subject",I=A.subject?.code||"N/A",V=A.error||"Unknown error";J.error(`${D} (${I}): ${V}`,{autoClose:6e3,position:"top-right",icon:!1})}),ne||ee>0?ee>0?J.info(`${ee} subject(s) already exist and were skipped. ${U>0?`${U} new subject(s) were imported.`:""}`,{icon:!1}):J.info("All subjects already exist. No new subjects were imported.",{icon:!1}):U>0&&Z===0?J.success(`Imported ${U}/${re} subjects successfully.`,{icon:!1}):U>0&&Z>0?J.warn(`Imported ${U}/${re}. ${Z} failed.`,{icon:!1}):U===0&&Z>0?J.error(`All ${Z}/${re} subjects failed to import.`,{icon:!1}):J.success(`Imported ${re}/${re} subjects successfully.`,{icon:!1}),P()}catch(R){R?.response?.status===304?(J.info("All subjects already exist. No new subjects were imported.",{icon:!1}),P()):(J.error(R?.response?.data?.message||R.message||"Failed to import subjects.",{icon:!1}),f([R?.response?.data?.message||R.message||"Failed to import subjects. Please try again."]))}},P=()=>{c(null),u([]),f([]),p([]),o(!1),t()},T=_=>_==="valid"?s.jsx(Je,{className:"text-success",size:16}):s.jsx(Qr,{className:"text-danger",size:16}),O=()=>{const _=[b,["MATH101","Mathematics",n||"550e8400-e29b-41d4-a716-446655440000","Basic mathematics course covering algebra and geometry","CLASSROOM","14","UNLIMIT","Room A101","This is a required course for all students","09:00-17:00","70.0","2025-01-15 09:00:00","2025-01-29 17:00:00"],["PHYS101","Physics",n||"550e8400-e29b-41d4-a716-446655440000","Introduction to physics concepts and principles","E_LEARNING","7","RECURRENT","Lab B201","Hands-on experiments and demonstrations","14:00-18:00","75.0","2025-02-01 14:00:00","2025-02-08 18:00:00"],["SAFETY301","Safety Procedures",n||"550e8400-e29b-41d4-a716-446655440000","Emergency response and safety protocols training","ERO","5","UNLIMIT","Training Hall B","Hands-on practical training required","08:00-16:00","80.0","2025-03-01 08:00:00","2025-03-06 16:00:00"]],C=Oa.aoa_to_sheet(_),R=Oa.book_new();Oa.book_append_sheet(R,C,"Subjects"),Rg(R,"Subject_Upload_Template.xlsx")};return s.jsxs(ce,{show:e,onHide:P,size:"xl",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-2",size:20}),"Bulk Import Subjects"]}),s.jsx(te,{variant:"link",onClick:P,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[m.length>0&&s.jsx(De,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:m.map((_,C)=>s.jsx("li",{children:_},C))})}),s.jsx(W,{className:"mb-4",children:s.jsxs(W.Body,{children:[s.jsxs("div",{className:`upload-area ${i?"drag-active":""}`,onDragEnter:j,onDragLeave:j,onDragOver:j,onDrop:y,onClick:()=>x.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:i?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Fo,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:x,type:"file",accept:".xlsx,.xls",onChange:w,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Required columns:"})," Code, Name",!n&&s.jsx("span",{children:", Course ID (UUID format)"})]}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Optional columns:"})," Description, Method (E_LEARNING|CLASSROOM|ERO), Duration, Type (UNLIMIT|RECURRENT), Room Name, Remark Note, Time Slot, Pass Score, Start Date, End Date"]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:O,className:"d-flex align-items-center",children:[s.jsx(fi,{className:"me-1",size:14}),"Download Template"]}),l&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Fo,{className:"text-success me-2",size:16}),s.jsx("span",{className:"text-success fw-semibold",children:l.name})]})]})]})]})}),d.length>0&&s.jsxs(W,{children:[s.jsx(W.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",d.length," records)"]})}),s.jsx(W.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(ar,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"120px"},children:"CODE"}),s.jsx("th",{style:{minWidth:"200px"},children:"NAME"}),s.jsx("th",{style:{minWidth:"200px"},children:"COURSE ID"}),s.jsx("th",{style:{minWidth:"150px"},children:"METHOD"}),s.jsx("th",{style:{minWidth:"100px"},children:"DURATION"}),s.jsx("th",{style:{minWidth:"120px"},children:"TYPE"}),s.jsx("th",{style:{minWidth:"100px"},children:"PASS SCORE"}),s.jsx("th",{style:{minWidth:"150px"},children:"DESCRIPTION"}),s.jsx("th",{style:{minWidth:"150px"},children:"ROOM NAME"}),s.jsx("th",{style:{minWidth:"150px"},children:"TIME SLOT"}),s.jsx("th",{style:{minWidth:"150px"},children:"START DATE"}),s.jsx("th",{style:{minWidth:"150px"},children:"END DATE"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),s.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),s.jsx("tbody",{children:d.map((_,C)=>s.jsxs("tr",{className:_.hasError?"table-danger":"",children:[s.jsx("td",{children:_.rowNumber||C+1}),s.jsx("td",{children:_.code||"-"}),s.jsx("td",{children:_.name||"-"}),s.jsx("td",{children:_.course_id||"-"}),s.jsx("td",{children:_.method||"-"}),s.jsx("td",{children:_.duration||"-"}),s.jsx("td",{children:_.type||"-"}),s.jsx("td",{children:_.pass_score||"-"}),s.jsx("td",{children:_.description||"-"}),s.jsx("td",{children:_.room_name||"-"}),s.jsx("td",{children:_.time_slot||"-"}),s.jsx("td",{children:_.start_date||"-"}),s.jsx("td",{children:_.end_date||"-"}),s.jsx("td",{className:"text-center",children:T(_.hasError?"invalid":"valid")}),s.jsx("td",{children:_.errors.length>0&&s.jsx("small",{className:"text-danger",children:_.errors.length>1?`${_.errors[0]} (+${_.errors.length-1} more)`:_.errors[0]})}),s.jsx("td",{children:s.jsx(te,{variant:"outline-danger",size:"sm",onClick:()=>{u(R=>R.filter(M=>M.id!==_.id))},children:s.jsx(Fa,{size:14})})})]},_.id))})]})})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:P,disabled:a,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),d.length>0&&s.jsx(O2,{placement:"top",overlay:s.jsxs(P2,{id:"import-tooltip",children:["Only ",d.filter(_=>!_.hasError).length,"/",d.length," subjects will be imported into DSFMS"]}),children:s.jsx(te,{variant:"primary",onClick:E,disabled:a||d.filter(_=>!_.hasError).length===0,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:16}),"Import All (",d.filter(_=>!_.hasError).length," subjects)"]})})})]})]})},Zoe=({show:e,onClose:t,onSave:r,course:a,loading:n=!1})=>{const[i,o]=v.useState({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),[l,c]=v.useState({}),d=p=>{if(!p)return"";if(typeof p=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(p))return p;try{const x=new Date(p);return isNaN(x.getTime())?"":x.toISOString().split("T")[0]}catch{return""}};v.useEffect(()=>{e&&a?o({name:a.name||"",code:a.code||"",description:a.description||"",maxTrainees:a.maxNumTrainee||a.maxTrainees||"",venue:a.venue||"",note:a.note||"",passScore:a.passScore||"",startDate:d(a.startDate),endDate:d(a.endDate),level:a.level||"BEGINNER",status:a.status||"ACTIVE"}):e||(o({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),c({}))},[e,a]);const u=()=>{c({}),t()},m=p=>{const{name:x,value:g}=p.target;o(b=>({...b,[x]:g})),l[x]&&c(b=>({...b,[x]:""}))},f=()=>{const p={};if(i.name.trim()||(p.name="Course name is required"),i.code.trim()||(p.code="Course code is required"),i.description.trim()||(p.description="Description is required"),(!i.maxTrainees||isNaN(i.maxTrainees)||parseInt(i.maxTrainees)<=0)&&(p.maxTrainees="Max trainees must be a positive number"),i.venue.trim()||(p.venue="Venue is required"),(!i.passScore||isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&(p.passScore="Pass score must be between 0 and 100"),!i.startDate)p.startDate="Start date is required";else{const x=new Date;x.setHours(0,0,0,0),new Date(i.startDate)<x&&(p.startDate="Start date cannot be in the past")}return i.endDate||(p.endDate="End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&(p.endDate="End date must be after start date"),c(p),Object.keys(p).length===0},h=async p=>{if(p.preventDefault(),!!f())try{const x={name:i.name.trim(),description:i.description.trim(),code:i.code.trim(),maxNumTrainee:parseInt(i.maxTrainees),venue:i.venue.trim(),note:i.note.trim(),passScore:parseInt(i.passScore),startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString(),level:i.level},g=await be.put(`/courses/${a.id}`,x);J.success("Course updated successfully!"),r&&await r(g.data||x),u()}catch(x){const g=x.response?.data?.message||x.message||"Failed to update course";J.error(`Error: ${g}`)}};return s.jsxs(ce,{show:e,onHide:u,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Yr,{className:"me-2",size:20}),"Edit Course"]}),s.jsx(te,{variant:"link",onClick:u,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(k,{onSubmit:h,children:[s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(de,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Course Name *"}),s.jsx(k.Control,{type:"text",name:"name",value:i.name,onChange:m,isInvalid:!!l.name,disabled:n}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.name})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Course Code *"}),s.jsx(k.Control,{type:"text",name:"code",value:i.code,onChange:m,isInvalid:!!l.code,disabled:n}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.code})]})})]}),s.jsxs(de,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Max Trainees *"}),s.jsx(k.Control,{type:"number",name:"maxTrainees",value:i.maxTrainees,onChange:m,isInvalid:!!l.maxTrainees,disabled:n,min:"1"}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.maxTrainees})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Pass Score *"}),s.jsx(k.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,isInvalid:!!l.passScore,disabled:n,min:"0",max:"100"}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.passScore})]})})]}),s.jsx(de,{className:"mb-3",children:s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Level"}),s.jsxs(k.Select,{name:"level",value:i.level,onChange:m,disabled:n,children:[s.jsx("option",{value:"BEGINNER",children:"Beginner"}),s.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),s.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})})}),s.jsxs(de,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Start Date *"}),s.jsx(k.Control,{type:"date",name:"startDate",value:i.startDate,onChange:m,isInvalid:!!l.startDate,disabled:n}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.startDate})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"End Date *"}),s.jsx(k.Control,{type:"date",name:"endDate",value:i.endDate,onChange:m,isInvalid:!!l.endDate,disabled:n}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.endDate})]})})]}),s.jsx(de,{className:"mb-3",children:s.jsx(H,{children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Venue *"}),s.jsx(k.Control,{type:"text",name:"venue",value:i.venue,onChange:m,isInvalid:!!l.venue,disabled:n}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.venue})]})})}),s.jsx(de,{className:"mb-3",children:s.jsx(H,{children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Description *"}),s.jsx(k.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,isInvalid:!!l.description,disabled:n}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.description})]})})}),s.jsx(de,{className:"mb-3",children:s.jsx(H,{children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Note"}),s.jsx(k.Control,{as:"textarea",rows:2,name:"note",value:i.note,onChange:m,disabled:n})]})})})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:u,disabled:n,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"primary",type:"submit",disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),"Save Changes"]})})]})]})]})},Qoe=({show:e,onClose:t,courseId:r,onSuccess:a})=>{const[n,i]=v.useState([]),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[u,m]=v.useState(null),[f,h]=v.useState(null);v.useEffect(()=>{e&&r?p():(i([]),m(null),h(null))},[e,r]);const p=async()=>{l(!0),h(null);try{const b=await Nr.getCourseEnrollmentBatches(r),j=b?.batches||b?.data?.batches||[];i(j)}catch(b){const j=b?.response?.data?.message||b?.message||"Failed to load batches";h(j),J.error(j)}finally{l(!1)}},x=async()=>{if(!u){J.error("Please select a batch to delete");return}if(!n.find(j=>j.batchCode===u)){J.error("Selected batch not found");return}d(!0);try{await Nr.deleteBatchEnrollments(r,u),J.success(`Successfully deleted all enrollments for batch "${u}"`),a&&a(),t()}catch(j){const y=j?.response?.data?.message||j?.message||"Failed to delete batch enrollments";J.error(y)}finally{d(!1)}},g=b=>{if(Object.values(b).reduce((w,S)=>w+S,0)===0)return s.jsx(ke,{bg:"secondary",children:"No enrollments"});const y=b.ENROLLED+b.ON_GOING;return y>0?s.jsxs(ke,{bg:"success",children:[y," Active"]}):s.jsx(ke,{bg:"secondary",children:"All Cancelled"})};return s.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,children:[s.jsx(ce.Header,{className:"bg-danger text-white border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Fa,{className:"me-2",size:20}),"Delete All Subject Enrollments by Batch Code"]})}),s.jsx(ce.Body,{className:"p-4",style:{minHeight:"400px",maxHeight:"500px",display:"flex",flexDirection:"column"},children:o?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading batches..."})]}):f?s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:f}),s.jsx(te,{variant:"outline-danger",size:"sm",onClick:p,children:"Try Again"})]}):n.length===0?s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-muted",children:"No batches found for this course."})}):s.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[s.jsxs(De,{variant:"warning",className:"mb-3",style:{flexShrink:0},children:[s.jsx("strong",{children:"Warning:"})," This action will permanently delete all subject enrollments for the selected batch. This cannot be undone."]}),s.jsxs("div",{className:"mb-3",style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[s.jsx("h6",{className:"mb-3",style:{flexShrink:0},children:"Select a batch to delete:"}),s.jsx("div",{style:{flex:1,minHeight:0,overflowY:"auto"},children:s.jsxs(ar,{hover:!0,responsive:!0,children:[s.jsx("thead",{className:"table-light",style:{position:"sticky",top:0,zIndex:10},children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"40px"}}),s.jsx("th",{children:"Batch Code"}),s.jsx("th",{children:"Trainees"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Subjects"}),s.jsx("th",{children:"Status"})]})}),s.jsx("tbody",{children:n.map(b=>s.jsxs("tr",{onClick:()=>m(b.batchCode),style:{cursor:"pointer",backgroundColor:u===b.batchCode?"#e7f3ff":"transparent"},children:[s.jsx("td",{children:s.jsx("input",{type:"radio",name:"batchSelection",checked:u===b.batchCode,onChange:()=>m(b.batchCode),onClick:j=>j.stopPropagation()})}),s.jsx("td",{children:s.jsx("strong",{children:b.batchCode})}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Mr,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:b.totalTrainees})]})}),s.jsx("td",{children:s.jsx(ke,{bg:"success",children:b.activeTrainees})}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:b.subjects?.length||0})]})}),s.jsx("td",{children:g(b.statusCounts)})]},b.batchCode))})]})})]}),s.jsx("div",{className:"mt-3 p-3 bg-light rounded",style:{minHeight:"120px",maxHeight:"180px",overflowY:"auto",flexShrink:0},children:u?s.jsxs(s.Fragment,{children:[s.jsx("h6",{className:"mb-2",children:"Selected Batch Details:"}),(()=>{const b=n.find(j=>j.batchCode===u);return b?s.jsxs("div",{children:[s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Batch Code:"})," ",b.batchCode]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Total Trainees:"})," ",b.totalTrainees," ","(",s.jsxs(ke,{bg:"success",className:"ms-1",children:[b.activeTrainees," Active"]}),")"]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Subjects:"})," ",b.subjects?.length||0]}),b.subjects&&b.subjects.length>0&&s.jsxs("div",{className:"mt-2",children:[s.jsx("strong",{children:"Subject Details:"}),s.jsx("ul",{className:"mt-2 mb-0",children:b.subjects.map(j=>s.jsxs("li",{children:[j.subjectCode," - ",j.subjectName," ","(",j.activeTrainees,"/",j.totalTrainees," active)"]},j.subjectId))})]})]}):null})()]}):s.jsx("div",{className:"text-muted",style:{minHeight:"60px",display:"flex",alignItems:"center"},children:s.jsx("span",{children:"No batch selected"})})})]})}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:t,disabled:c,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"danger",onClick:x,disabled:!u||c||o||n.length===0,children:c?s.jsxs(s.Fragment,{children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),"Deleting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Fa,{className:"me-2",size:16}),"Delete Enrollments"]})})]})]})},ele=({show:e,onClose:t,onConfirm:r,trainer:a,loading:n=!1})=>{const i=async()=>{await r(a?.id)};return s.jsxs(ce,{show:e,onHide:t,centered:!0,children:[s.jsx(ce.Header,{className:"bg-danger text-white border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Jt,{className:"me-2",size:20}),"Remove Trainer from Course"]})}),s.jsx(ce.Body,{className:"p-4",children:s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"mb-3",children:"You are about to remove the following trainer from the course:"}),s.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Name:"})," ",a?.firstName," ",a?.middleName," ",a?.lastName]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"EID:"})," ",a?.eid]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("strong",{children:"Email:"})," ",a?.email]}),a?.roleInCourse&&a.roleInCourse.length>0&&s.jsxs("div",{children:[s.jsx("strong",{children:"Role:"})," ",a.roleInCourse.join(", ")]})]}),s.jsxs("div",{className:"alert alert-warning mb-0",role:"alert",children:[s.jsx("strong",{children:"Warning:"})," This action cannot be undone. The trainer will no longer have access to this course."]})]})}),s.jsxs(ce.Footer,{className:"border-top p-3",children:[s.jsx(te,{variant:"outline-secondary",onClick:t,disabled:n,children:"Cancel"}),s.jsx(te,{variant:"danger",onClick:i,disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Fa,{className:"me-2",size:16}),"Remove Trainer"]})})]})]})},D5=({course:e,department:t}={})=>{const r=tt(),{courseId:a,traineeId:n}=ur(),i=ya(),{user:o}=zr(),{hasPermission:l}=Fn(),c=n!==void 0,d=kR(o),[u,m]=v.useState(!1),[f,h]=v.useState(!1),[p,x]=v.useState(!1),[g,b]=v.useState(!1),[j,y]=v.useState(null),[w,S]=v.useState(!1),[N,E]=v.useState(!1),[P,T]=v.useState(null),[O,_]=v.useState(!1),[C,R]=v.useState(!1),[M,U]=v.useState(!1),[Z,ee]=v.useState(null),[re,z]=v.useState(!1),[me,ne]=v.useState(null),[A,D]=v.useState([]),[I,V]=v.useState(!0),ie=Ue=>Array.isArray(Ue)?Ue.filter(he=>he?.status?.toUpperCase()!=="ARCHIVED"&&!he?.deletedAt):[],[se,ae]=v.useState(()=>i.state?.activeTab?i.state.activeTab:"course-info");v.useEffect(()=>{i.state?.activeTab&&(ae(i.state.activeTab),window.history.replaceState({},document.title))},[i.state]),v.useEffect(()=>{a&&(async()=>{if(a){V(!0);try{const he=await Nr.getCourseById(a);if(!he)throw new Error("Invalid API response");const Me={id:he.id||a,name:he.name,code:he.code,description:he.description,maxTrainees:he.maxNumTrainee,maxNumTrainee:he.maxNumTrainee,venue:he.venue,note:he.note,passScore:he.passScore,startDate:he.startDate?new Date(he.startDate).toISOString().split("T")[0]:"",endDate:he.endDate?new Date(he.endDate).toISOString().split("T")[0]:"",level:he.level,status:he.status,department:he.department,subjectCount:he.subjectCount||0,traineeCount:he.traineeCount||0,trainerCount:he.trainerCount||0,instructors:he.instructors||[]};ne(Me),he.subjects&&Array.isArray(he.subjects)?D(ie(he.subjects)):he.subjectCount>0&&!he.subjects?D([]):D([]),V(!1)}catch{if(e&&e.id&&e.name){const he={id:e.id,name:e.name,code:e.code||"N/A",description:e.description||"Course information not available.",maxTrainees:e.maxNumTrainee||e.maxTrainees||50,maxNumTrainee:e.maxNumTrainee||e.maxTrainees||50,venue:e.venue||"N/A",note:e.note||"",passScore:e.passScore||80,startDate:e.startDate?typeof e.startDate=="string"?e.startDate.split("T")[0]:new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?typeof e.endDate=="string"?e.endDate.split("T")[0]:new Date(e.endDate).toISOString().split("T")[0]:"",level:e.level||"N/A",status:e.status||"ACTIVE",department:e.department||t,subjectCount:e.subjectCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,instructors:e.instructors||[]};ne(he),D([])}else ne(null),D([]);V(!1)}}})()},[a]);const K=()=>{c?r(je.COURSES_ENROLLED):t?.id?r(`/academic/course/${t.id}`):r("/academic/departments")};if(I)return s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!me)return s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h5",{className:"text-muted",children:"Course not found"}),s.jsx("p",{className:"text-muted",children:"The requested course could not be loaded."}),s.jsxs(te,{variant:"primary",onClick:K,children:[s.jsx(At,{className:"me-2"}),c?"Back to Enrolled Courses":"Back to Department"]})]})});const G=Ue=>{r(`/academic/course/${a}/subject/${Ue}`)},ue=()=>{},L=Ue=>{const he=A.find(Me=>Me.id===Ue);he&&(y(he),b(!0))},Ne=async()=>{if(j){S(!0);try{await Jr.archiveSubject(j.id),J.success(`Successfully archived subject "${j.name}"`,{autoClose:3e3,position:"top-right",icon:!1}),D(Ue=>Ue.filter(he=>he.id!==j.id)),b(!1),y(null)}catch(Ue){const he=Ue?.response?.data?.message||Ue?.message||"Failed to archive subject";J.error(`Error: ${he}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{S(!1)}}},Oe=()=>{r(`/academic/course/${me?.id}/enroll-trainees`)},We=async()=>{try{const Ue=await Nr.getCourseById(a);Ue.subjects&&Array.isArray(Ue.subjects)&&D(ie(Ue.subjects))}catch(Ue){const he=Ue?.response?.data?.message||Ue?.message||"Failed to refresh subjects after creation";J.error(`Error: ${he}`,{autoClose:4e3,position:"top-right",icon:!1})}},Qe=async Ue=>{const he=await Jr.bulkImportSubjects(Ue),Me=await Nr.getCourseById(a);return Me.subjects&&Array.isArray(Me.subjects)&&D(ie(Me.subjects)),h(!1),he},Pe=async Ue=>{try{await Nr.updateCourse(a,Ue),ne(he=>({...he,...Ue,id:he.id,subjectCount:he.subjectCount,traineeCount:he.traineeCount,trainerCount:he.trainerCount,subjects:he.subjects})),x(!1)}catch(he){console.error("Error updating course:",he)}},rt=async Ue=>{try{z(!0),await Nr.assignTrainerToCourse(a,Ue),J.success("Trainer assigned successfully!",{autoClose:3e3,position:"top-right"}),R(!1);const he=await Nr.getCourseById(a);he&&ne(Me=>({...Me,instructors:he.instructors||[]}))}catch(he){const Me=he?.response?.data?.message||he?.message||"Failed to assign trainer";J.error(`Error: ${Me}`,{autoClose:4e3,position:"top-right",icon:!1}),console.error("Error assigning trainer:",he)}finally{z(!1)}},Ht=async Ue=>{if(!Ue)return;const he=me?.instructors?.find(Me=>Me.id===Ue);ee(he),U(!0)},gt=async Ue=>{try{z(!0),await Nr.removeTrainerFromCourse(a,Ue),J.success("Trainer removed successfully!",{autoClose:3e3,position:"top-right"}),ne(he=>({...he,instructors:(he.instructors||[]).filter(Me=>Me.id!==Ue),trainerCount:Math.max(0,(he.trainerCount||0)-1)})),U(!1),ee(null)}catch(he){const Me=he?.response?.data?.message||he?.message||"Failed to remove trainer";J.error(`Error: ${Me}`,{autoClose:4e3,position:"top-right",icon:!1}),console.error("Error removing trainer:",he)}finally{z(!1)}};return s.jsxs(Ce,{fluid:!0,className:"py-2 course-detail",children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:K,className:"me-3",children:[s.jsx(At,{size:16,className:"me-1"}),"Back"]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"mb-0 text-primary",children:[s.jsx("strong",{children:me?.name||"Loading..."}),"  ",me?.code||""]}),s.jsx("small",{className:"text-muted",children:"Course Details"})]})]}),s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("div",{className:"d-flex",children:s.jsx(yt,{permission:Te.ENROLL_SINGLE_TRAINEE,fallback:null,children:s.jsxs(te,{size:"sm",variant:"primary",onClick:Oe,children:[s.jsx(Mr,{size:14,className:"me-1"})," Enroll Trainees"]})})}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(yt,{permission:Te.UPDATE_COURSE,fallback:null,children:s.jsxs(te,{size:"sm",variant:"outline-secondary",onClick:()=>x(!0),children:[s.jsx(Yr,{size:14,className:"me-1"})," Edit Course"]})}),s.jsx("div",{className:"vr",style:{height:"24px",margin:"0 8px"}}),s.jsx(yt,{permission:Te.CREATE_SUBJECT,fallback:null,children:s.jsxs(te,{size:"sm",variant:"primary",onClick:()=>m(!0),children:[s.jsx(Gr,{size:14,className:"me-1"})," Add Subject"]})}),s.jsx(yt,{permission:Te.CREATE_BULK_SUBJECTS,fallback:null,children:s.jsxs(te,{size:"sm",variant:"outline-primary",onClick:()=>h(!0),children:[s.jsx(js,{size:14,className:"me-1"})," Import Bulk Subjects"]})}),s.jsx(yt,{permission:Te.REMOVE_TRAINEE_FROM_ENROLLMENT,fallback:null,children:s.jsxs(te,{size:"sm",variant:"outline-danger",onClick:()=>_(!0),children:[s.jsx(Fa,{size:14,className:"me-1"})," Delete All Subject Enrollments In Course by BatchCode"]})})]})]}),s.jsx(W,{className:"border-0 shadow-sm mb-2",children:s.jsxs($t.Container,{activeKey:se,onSelect:ae,children:[s.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Xe,{variant:"tabs",className:"border-0",children:[s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"course-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:se==="course-info"?"600":"400",opacity:se==="course-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Dt,{className:"me-2",size:16}),"Course Information"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:se==="subjects"?"600":"400",opacity:se==="subjects"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(xt,{className:"me-2",size:16}),"Subjects"]})}),l(Te.ENROLL_SINGLE_TRAINEE)&&s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:se==="trainees"?"600":"400",opacity:se==="trainees"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Mr,{className:"me-2",size:16}),"Trainees Roster"]})}),l(Te.ASSIGN_TRAINERS)&&s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"assign-trainer",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:se==="assign-trainer"?"600":"400",opacity:se==="assign-trainer"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(_n,{className:"me-2",size:16}),"Assign Trainer"]})}),!c&&!d&&s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"assessment-events",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:se==="assessment-events"?"600":"400",opacity:se==="assessment-events"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(fa,{className:"me-2",size:16}),"All Related Assessment Events"]})})]})}),s.jsx(W.Body,{className:"p-0",children:s.jsxs($t.Content,{children:[s.jsx($t.Pane,{eventKey:"course-info",children:s.jsxs("div",{className:"p-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-3",style:{color:"#1b3c53",fontWeight:"800",fontSize:"1.3rem",letterSpacing:"0.5px",textTransform:"uppercase",borderBottom:"2px solid #d2c1b6",paddingBottom:"0.5rem"},children:"Description"}),s.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.95rem"},children:me.description})]})})}),s.jsxs(de,{className:"g-4",children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Name"}),s.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:me.name})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Code"}),s.jsx(ke,{bg:"secondary",className:"px-2 py-1",children:me.code})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Level"}),s.jsx(ke,{bg:"info",className:"px-2 py-1",children:me.level})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Start Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:me.startDate||"N/A"})]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Max Number of Trainees"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(_n,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:me.maxTrainees})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Venue"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lo,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:me.venue})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Pass Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(B2,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:me.passScore})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Status"}),s.jsx(ke,{bg:me.status==="ACTIVE"?"success":me.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",children:me.status})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"End Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-primary"}),s.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:me.endDate||"N/A"})]})]})]})]})]})}),s.jsx($t.Pane,{eventKey:"subjects",children:s.jsx(Goe,{subjects:A,loading:!1,onView:G,onEdit:ue,onDelete:L})}),l(Te.ENROLL_SINGLE_TRAINEE)&&s.jsx($t.Pane,{eventKey:"trainees",style:{height:"100%"},children:s.jsx(Yoe,{courseId:a,loading:!1,title:"Trainees Roster"})}),l(Te.ASSIGN_TRAINERS)&&s.jsx($t.Pane,{eventKey:"assign-trainer",style:{height:"100%"},children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[s.jsx("h6",{style:{color:"#1b3c53",fontWeight:"800",fontSize:"1.3rem",letterSpacing:"0.5px",textTransform:"uppercase",borderBottom:"2px solid #d2c1b6",paddingBottom:"0.5rem",margin:0},children:"Assign Trainer to Course"}),s.jsxs(te,{variant:"primary",size:"sm",onClick:()=>R(!0),children:[s.jsx(Gr,{size:16,className:"me-2"}),"Add Trainer"]})]}),me?.instructors&&me.instructors.length>0?s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover table-sm",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"5%"},children:"#"}),s.jsx("th",{style:{width:"15%"},children:"EID"}),s.jsx("th",{style:{width:"20%"},children:"Name"}),s.jsx("th",{style:{width:"25%"},children:"Email"}),s.jsx("th",{style:{width:"15%"},children:"Phone"}),s.jsx("th",{style:{width:"15%"},children:"Role"}),s.jsx("th",{style:{width:"5%",textAlign:"center"},children:"Action"})]})}),s.jsx("tbody",{children:me.instructors.map((Ue,he)=>s.jsxs("tr",{children:[s.jsx("td",{children:he+1}),s.jsx("td",{children:s.jsx(ke,{bg:"info",children:Ue.eid})}),s.jsx("td",{children:s.jsxs("strong",{children:[Ue.firstName," ",Ue.middleName," ",Ue.lastName]})}),s.jsx("td",{children:Ue.email}),s.jsx("td",{children:Ue.phoneNumber}),s.jsx("td",{children:Ue.roleInCourse&&Ue.roleInCourse.length>0?Ue.roleInCourse.map(Me=>s.jsx(ke,{bg:"success",className:"me-1",children:Me},Me)):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{style:{textAlign:"center"},children:s.jsx(te,{variant:"danger",size:"sm",onClick:()=>Ht(Ue.id),disabled:re,title:"Remove trainer from course",children:s.jsx(Fa,{size:14})})})]},Ue.id))})]})}):s.jsx("div",{className:"alert alert-info",children:'No trainers assigned yet. Click "Add Trainer" button to assign a trainer to this course.'})]})}),!c&&!d&&s.jsx($t.Pane,{eventKey:"assessment-events",style:{height:"100%"},children:s.jsx(k5,{courseId:a,onView:Ue=>{T(Ue),E(!0)}})})]})})]})}),s.jsx(Xoe,{show:u,onClose:()=>m(!1),onSave:We,courseId:a}),s.jsx(Joe,{show:f,onClose:()=>h(!1),onImport:Qe,courseId:a}),s.jsx(Zoe,{show:p,onClose:()=>x(!1),onSave:Pe,course:me||e}),s.jsx(_5,{show:C,onClose:()=>R(!1),onSave:rt,loading:re,courseId:a}),s.jsx(ele,{show:M,onClose:()=>{U(!1),ee(null)},onConfirm:gt,trainer:Z,loading:re}),s.jsx(A5,{show:g,onClose:()=>{b(!1),y(null)},onDisable:Ne,subject:j,loading:w}),s.jsx(F1,{show:N,onClose:()=>{E(!1),T(null)},event:P}),s.jsx(Qoe,{show:O,onClose:()=>_(!1),courseId:a,onSuccess:()=>{}})]})},tle=()=>{const{courseId:e}=ur(),t=ya(),[r,a]=v.useState(null),[n,i]=v.useState(null),[o,l]=v.useState(!0);return v.useEffect(()=>{e&&(async()=>{try{l(!0);try{const d=await Nr.getCourseById(e);a(d),d.department&&i(d.department)}catch{const u={id:e,name:"Course Details",code:"COURSE-001",description:"Course information will be loaded from department data",status:"ACTIVE",startDate:"2026-01-12",endDate:"2026-01-26",venue:"Training Room",maxNumTrainee:16,passScore:80,level:"INTERMEDIATE"},m={id:t.state?.departmentId||null,name:t.state?.departmentName||"Default Department"};a(u),i(m)}l(!1)}catch{l(!1)}})()},[e]),o?s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):r?s.jsx(Ce,{className:"py-3",children:s.jsx(D5,{course:r,department:n})}):s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Course not found"}),s.jsx("p",{children:"The requested course could not be found."})]})})},rle=({selectedSubjects:e,onSelectionChange:t,subjects:r=null})=>{const[a,n]=v.useState(""),[i,o]=v.useState([]),[l,c]=v.useState(!r),[d,u]=v.useState(null),m=g=>Array.isArray(g)?g.filter(b=>b?.status?.toUpperCase()!=="ARCHIVED"&&!b?.deletedAt):[];v.useEffect(()=>{if(r&&Array.isArray(r)){const j=m(r).map(y=>({id:y.id,name:y.name,code:y.code}));o(j),c(!1);return}(async()=>{try{c(!0),u(null);const b=await Jr.getSubjects();if(b&&b.subjects){const y=m(b.subjects).map(w=>({id:w.id,name:w.name,code:w.code}));o(y)}else o([])}catch{u("Failed to load subjects"),o([])}finally{c(!1)}})()},[r]);const f=i.filter(g=>g.name.toLowerCase().includes(a.toLowerCase())||g.code.toLowerCase().includes(a.toLowerCase())),h=()=>{e.length===f.length?t([]):t(f.map(g=>g.id))},p=g=>{e.includes(g)?t(e.filter(b=>b!==g)):t([...e,g])},x=f.length>0&&e.length===f.length;return s.jsxs(W,{className:"d-flex flex-column h-100 subject-selection-panel-card",style:{border:"1px solid #e9ecef",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",overflow:"visible",marginBottom:"2rem"},children:[s.jsx(W.Header,{className:"bg-gradient-primary-custom text-white border-0",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("h6",{className:"mb-0 text-white",children:"Select Subjects"}),s.jsx(te,{variant:"outline-light",size:"sm",onClick:h,children:x?"Deselect All":"Select All"})]})}),s.jsxs(W.Body,{className:"p-0 d-flex flex-column subject-selection-panel-body",style:{height:"500px",minHeight:0,display:"flex",flexDirection:"column"},children:[s.jsx("div",{className:"p-2 border-bottom flex-shrink-0",children:s.jsx(k.Control,{type:"text",placeholder:"Search subjects...",value:a,onChange:g=>n(g.target.value),size:"sm"})}),s.jsx("div",{className:"subject-list-scroll-container",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,maxHeight:"100%"},children:l?s.jsxs("div",{className:"p-3 text-center",children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"text-muted",children:"Loading subjects..."})]}):d?s.jsx("div",{className:"p-3 text-center text-danger",children:s.jsx("p",{className:"mb-0",children:d})}):f.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No subjects found"})}):f.map(g=>s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>p(g.id),children:[s.jsx("div",{className:"me-3 flex-shrink-0",children:e.includes(g.id)?s.jsx(W2,{size:20,className:"text-primary"}):s.jsx(nS,{size:20,className:"text-muted"})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:g.name,children:g.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:g.code,children:g.code})]})]},g.id))}),s.jsx("div",{className:"p-2 bg-light border-top flex-shrink-0",children:s.jsxs("small",{className:"text-muted",children:[e.length," of ",f.length," subjects selected"]})})]})]})},sle=({selectedTrainees:e,onSelectionChange:t})=>{const[r,a]=v.useState(""),[n,i]=v.useState(!1),[o,l]=v.useState([]),[c,d]=v.useState(!1),[u,m]=v.useState(null),[f,h]=v.useState(null),p=v.useRef(null);v.useEffect(()=>{x()},[]),v.useEffect(()=>{const y=w=>{p.current&&!p.current.contains(w.target)&&i(!1)};return n&&document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[n]);const x=async()=>{d(!0),m(null);try{const y=await Zd.getTraineesForEnrollment();let w=[];y&&y.trainees&&Array.isArray(y.trainees)?w=y.trainees:Array.isArray(y)&&(w=y);const S=w.map(N=>{const E=[N.firstName,N.middleName,N.lastName].filter(Boolean),P=E.length>0?E.join(" ").trim():N.eid;return{id:N.id,eid:N.eid,name:P,firstName:N.firstName||"",lastName:N.lastName||"",email:N.email,status:N.status||"ACTIVE",departmentId:N.departmentId,departmentName:N.department?.name||""}});l(S)}catch(y){console.error("Error loading trainees:",y),m("Failed to load trainees"),l([])}finally{d(!1)}},g=o.filter(y=>y.name.toLowerCase().includes(r.toLowerCase())||y.eid.toLowerCase().includes(r.toLowerCase()));v.useEffect(()=>{r.trim().length>0&&i(!0)},[r]);const b=y=>{e.find(w=>w.id===y.id)||(t([...e,y]),h(y.id),setTimeout(()=>{h(null)},2e3))},j=y=>{t(e.filter(w=>w.id!==y))};return s.jsxs(W,{className:"trainee-selection-card",children:[s.jsx(W.Header,{className:"bg-gradient-primary-custom text-white border-0 trainee-card-header",children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsx("h6",{className:"mb-0 text-white",children:"Add Trainees"})})}),s.jsxs(W.Body,{className:"trainee-card-body p-0",children:[s.jsxs("div",{className:"trainee-available-section",ref:p,children:[s.jsx("div",{className:"p-2 border-bottom",children:s.jsx(k.Control,{type:"text",placeholder:"Search by EID or name...",value:r,onChange:y=>a(y.target.value),size:"sm"})}),s.jsx("div",{className:"p-2",children:s.jsxs(te,{variant:"outline-primary",className:"w-100 d-flex align-items-center justify-content-between",size:"sm",onClick:()=>i(!n),disabled:c,children:[s.jsxs("span",{children:[s.jsx(Mr,{className:"me-2",size:16}),c?"Loading...":r.trim().length>0?`Available Trainees (${g.length})`:`Show All Available Trainees (${o.length})`]}),s.jsx(ai,{size:16})]})}),n&&s.jsx("div",{className:"border bg-white",style:{position:"absolute",top:"calc(100% + 8px)",left:0,right:0,zIndex:1050,maxHeight:"350px",overflowY:"auto",borderRadius:"8px",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.15), 0 4px 8px rgba(0, 0, 0, 0.1)"},children:c?s.jsxs("div",{className:"p-3 text-center",children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"text-muted",children:"Loading trainees..."})]}):u?s.jsxs("div",{className:"p-3 text-center text-danger",children:[s.jsx("p",{className:"mb-0",children:u}),s.jsx(te,{size:"sm",variant:"outline-danger",onClick:x,className:"mt-2",children:"Retry"})]}):g.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No trainees found"})}):g.map(y=>{const w=e.find(S=>S.id===y.id);return s.jsxs("div",{className:`p-2 border-bottom d-flex align-items-center justify-content-between ${w?"bg-success bg-opacity-10":"hover-bg-light"}`,style:{cursor:w?"not-allowed":"pointer",minWidth:0,transition:"all 0.3s ease",opacity:w?.6:1},onClick:()=>{w||b(y)},children:[s.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:y.name,children:y.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:y.eid,children:y.eid})]}),w?s.jsx(Je,{size:16,className:"text-success flex-shrink-0"}):s.jsx(Gr,{size:14,className:"text-primary flex-shrink-0"})]},y.id)})})]}),s.jsxs("div",{className:"trainee-selected-section",children:[s.jsx("div",{className:"trainee-selected-header",children:s.jsxs("small",{className:"text-white fw-semibold",children:["Selected Trainees (",e.length,")"]})}),s.jsx("div",{className:"trainee-selected-list",children:e.length===0?s.jsx("div",{className:"p-3 text-center text-muted",children:s.jsx("p",{className:"mb-0",children:"No trainees selected"})}):s.jsx("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:e.map(y=>{const w=f===y.id;return s.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between",style:{minWidth:0,backgroundColor:w?"rgba(40, 167, 69, 0.1)":"transparent",animation:w?"slideInRight 0.5s ease-out, highlightPulse 0.5s ease-out":"none",transition:"background-color 0.3s ease",flexShrink:0},children:[s.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[s.jsx("div",{className:"fw-semibold text-truncate",title:y.name,children:y.name}),s.jsx("small",{className:"text-muted text-truncate d-block",title:y.eid,children:y.eid})]}),s.jsx(te,{size:"sm",variant:"outline-danger",className:"flex-shrink-0",onClick:()=>j(y.id),children:s.jsx(st,{size:14})})]},y.id)})})})]})]})]})},ale=({show:e,onClose:t,onImport:r,loading:a=!1})=>{const[n,i]=v.useState(!1),[o,l]=v.useState(null),[c,d]=v.useState([]),[u,m]=v.useState(null),[f,h]=v.useState([]),[p,x]=v.useState([]),[g,b]=v.useState([]),[j,y]=v.useState(!1),w=v.useRef(null),S=["eid","email"],N=Z=>{Z.preventDefault(),Z.stopPropagation(),Z.type==="dragenter"||Z.type==="dragover"?i(!0):Z.type==="dragleave"&&i(!1)},E=Z=>{Z.preventDefault(),Z.stopPropagation(),i(!1),Z.dataTransfer.files&&Z.dataTransfer.files[0]&&T(Z.dataTransfer.files[0])},P=Z=>{Z.target.files&&Z.target.files[0]&&T(Z.target.files[0])},T=Z=>{if(!Z.name.match(/\.(xlsx|xls)$/)){x(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(Z.size>100*1024*1024){x(["File size must be less than 100MB"]);return}l(Z),x([]),O(Z)},O=Z=>{const ee=new FileReader;ee.onload=re=>{try{const z=new Uint8Array(re.target.result),me=mc(z,{type:"array"}),ne=me.SheetNames[0],A=me.Sheets[ne],D=Oa.sheet_to_json(A,{header:1});if(D.length<2){x(["Excel file must contain at least a header row and one data row"]);return}const I=D[0].map(K=>K?.toString().toLowerCase().trim()),V=D.slice(1),ie=S.filter(K=>!I.includes(K));if(ie.length>0){x([`Missing required columns: ${ie.join(", ")}`]);return}const ae=V.map((K,G)=>{const ue=K[I.indexOf("eid")]?.toString().trim()||"",L=K[I.indexOf("email")]?.toString().trim()||"";return{id:`temp_${G}`,rowNumber:G+2,eid:ue,email:L,hasError:!1,errors:[]}}).filter(K=>K.eid||K.email).map(K=>(K.eid||(K.hasError=!0,K.errors.push("EID is required")),K.email?/\S+@\S+\.\S+/.test(K.email)||(K.hasError=!0,K.errors.push("Email format is invalid")):(K.hasError=!0,K.errors.push("Email is required")),K));d(ae),b([]),_(ae)}catch{x(["Failed to parse Excel file. Please check the file format."])}},ee.readAsArrayBuffer(Z)},_=async Z=>{const ee=Z.filter(re=>!re.hasError);if(ee.length!==0){y(!0),x([]);try{const re=ee.map(I=>({eid:I.eid,email:I.email})),z=await Zd.lookupTrainees(re),me={};(z.foundUsers||[]).forEach(I=>{me[`${I.eid}:${I.email}`]=I});const ne=Z.map(I=>{const V=`${I.eid}:${I.email}`,ie=me[V];return I.hasError?I:ie?{...I,matchedUser:ie,isMatched:!0,errors:[]}:{...I,isMatched:!1,errors:["Trainee not found in system"]}});d(ne);const A=ne.filter(I=>I.matchedUser).map(I=>I.matchedUser);h(A);const D=ne.filter(I=>!I.isMatched&&!I.hasError).length;m({foundUsers:A,notFoundIdentifiers:ne.filter(I=>!I.isMatched&&!I.hasError).map(I=>({eid:I.eid,email:I.email})),uploadedIdentifiers:re,hasErrors:D>0})}catch(re){console.error("Lookup error:",re),x([re.response?.data?.message||re.message||"Failed to lookup trainees. Please try again."])}finally{y(!1)}}},C=async()=>{if(f.length===0){x(["Please select at least one trainee to import"]);return}try{r&&await r(f),R()}catch(Z){x([Z.message||"Failed to import selected trainees. Please try again."])}},R=()=>{l(null),d([]),m(null),h([]),x([]),b([]),i(!1),y(!1),t()},M=Z=>Z==="valid"?s.jsx(Je,{className:"text-success",size:16}):s.jsx(Qr,{className:"text-danger",size:16}),U=()=>{const Z=[["eid","email"],["TE000001","john.doe@example.com"],["TE000002","trollergamehuydk+7@gmail.com"],["TE000003","bob.johnson@example.com"],["TE000004","alice.brown@example.com"],["TE000005","charlie.wilson@example.com"]],ee=Oa.book_new(),re=Oa.aoa_to_sheet(Z);re["!cols"]=[{wch:15},{wch:30}],Oa.book_append_sheet(ee,re,"Trainees Lookup Template"),Rg(ee,"Trainees_Lookup_Template.xlsx")};return s.jsxs(ce,{show:e,onHide:R,size:"xl",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-2",size:20}),"Bulk Import Trainees"]}),s.jsx(te,{variant:"link",onClick:R,className:"text-white p-0",children:s.jsx(st,{size:24})})]}),s.jsxs(ce.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[p.length>0&&s.jsx(De,{variant:"danger",className:"mb-3",children:s.jsx("ul",{className:"mb-0",children:p.map((Z,ee)=>s.jsx("li",{children:Z},ee))})}),s.jsx(W,{className:"mb-4",children:s.jsxs(W.Body,{children:[s.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:E,onClick:()=>w.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[s.jsx(Fo,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),s.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),s.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",onChange:P,style:{display:"none"}})]}),s.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("small",{className:"text-muted",children:[s.jsx("strong",{children:"Required columns:"})," eid, email"]}),s.jsx("div",{className:"mt-1",children:s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:U,className:"d-flex align-items-center",children:[s.jsx(fi,{className:"me-1",size:14}),"Download Template"]})})]}),o&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Fo,{className:"text-success me-2",size:16}),s.jsx("span",{className:"text-success fw-semibold",children:o.name})]})]})]})}),c.length>0&&s.jsxs(W,{className:"mb-4",children:[s.jsx(W.Header,{children:s.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),s.jsx(W.Body,{className:"p-0",children:s.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:s.jsxs(ar,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"800px"},children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{style:{minWidth:"50px"},children:"NO."}),s.jsx("th",{style:{minWidth:"150px"},children:"EID"}),s.jsx("th",{style:{minWidth:"250px"},children:"EMAIL"}),s.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),s.jsx("th",{style:{minWidth:"300px"},children:"ERROR ENCOUNTERED"})]})}),s.jsx("tbody",{children:c.map(Z=>s.jsxs("tr",{className:Z.hasError?"table-danger":"",children:[s.jsx("td",{children:Z.rowNumber||Z.id}),s.jsx("td",{children:Z.eid||"-"}),s.jsx("td",{children:Z.email||"-"}),s.jsx("td",{className:"text-center",children:M(Z.hasError?"invalid":"valid")}),s.jsx("td",{children:Z.errors.length>0&&s.jsx("small",{className:"text-danger",children:Z.errors.length>1?`${Z.errors[0]} (+${Z.errors.length-1} more)`:Z.errors[0]})})]},Z.id))})]})})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-4",children:[s.jsxs(te,{variant:"outline-secondary",onClick:R,disabled:a,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),u&&u.foundUsers?.length>0&&f.length>0&&s.jsx(yt,{permission:Te.BULK_ENROLL_TRAINEES,fallback:null,children:s.jsx(te,{variant:"primary",onClick:C,disabled:a,children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:16}),"Import Selected (",f.length," matched trainees)"]})})})]})]})},nle=({show:e,onClose:t,onConfirm:r,loading:a=!1})=>{const[n,i]=v.useState(""),[o,l]=v.useState("");v.useEffect(()=>{e&&(i(""),l(""))},[e]);const c=f=>!f||f.trim()===""?"Batch code is required":f.length<3?"Batch code must be at least 3 characters long":f.length>20?"Batch code must be no more than 20 characters long":/[^a-zA-Z0-9_]/.test(f)?"Batch code can only contain letters, numbers, and underscores":null,d=f=>{const h=f.target.value;i(h),o&&l("")},u=()=>{const f=c(n);if(f){l(f);return}r(n.trim())},m=f=>{f.key==="Enter"&&(f.preventDefault(),u())};return s.jsxs(ce,{show:e,onHide:t,centered:!0,backdrop:"static",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsxs(ce.Title,{children:[s.jsx(Jt,{className:"me-2 text-warning",size:20}),"Enter Batch Code"]})}),s.jsxs(ce.Body,{children:[s.jsx(k,{children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{children:["Batch Code ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"Enter batch code (e.g., SAF0012025, CCT_BATCH_01)",value:n,onChange:d,onKeyPress:m,isInvalid:!!o,disabled:a,autoFocus:!0}),s.jsx(k.Text,{className:"text-muted",children:"Only letters, numbers, and underscores are allowed. 3-20 characters."}),o&&s.jsx(k.Control.Feedback,{type:"invalid",children:o})]})}),s.jsx(De,{variant:"info",className:"mb-0",children:s.jsxs("small",{children:[s.jsx("strong",{children:"Note:"})," This batch code will be used to identify the enrollment group. Make sure it's unique and descriptive for your course."]})})]}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"secondary",onClick:t,disabled:a,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:u,disabled:a||!n.trim(),children:a?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Enrolling..."]}):"Confirm & Enroll"})]})]})},y2=()=>{const e=tt(),{courseId:t}=ur(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState([]),[c,d]=v.useState([]),[u,m]=v.useState([]),[f,h]=v.useState(!1),[p,x]=v.useState(!1),[g,b]=v.useState(!1),[j,y]=v.useState(!1),[w,S]=v.useState({});if(v.useEffect(()=>{t&&(async()=>{try{i(!0);const C=await Nr.getCourseById(t);if(a(C),C.subjects&&Array.isArray(C.subjects)){const R=C.subjects.filter(U=>U?.status?.toUpperCase()!=="ARCHIVED"&&!U?.deletedAt);l(R);const M={};R.forEach(U=>{M[U.id]={name:U.name,code:U.code}}),S(M)}}catch(C){console.error("Error loading course data:",C),J.error("Failed to load course data",{autoClose:3e3,position:"top-right"})}finally{i(!1)}})()},[t]),v.useEffect(()=>{Object.keys(w).length===0&&!n&&(async()=>{try{const C=await Jr.getSubjects();if(C&&C.subjects){const R={};C.subjects.forEach(M=>{R[M.id]={name:M.name,code:M.code}}),S(R)}}catch{}})()},[n]),n)return s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!r)return s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Course not found"}),s.jsx("p",{children:"The requested course could not be found."}),s.jsxs(te,{variant:"primary",onClick:()=>e("/academic/departments"),children:[s.jsx(At,{className:"me-2"}),"Back to Departments"]})]})});const N=()=>{e(je.ACADEMIC_COURSE_DETAIL(t))},E=()=>{h(!0)},P=async _=>{if(!g){b(!0);try{const C=_.map(R=>({id:R.id,eid:R.eid,name:`${R.firstName} ${R.lastName}`.trim(),firstName:R.firstName,lastName:R.lastName,email:R.email,phoneNumber:R.phoneNumber,status:R.status,subjects:[]}));m(R=>{const M=new Set(R.map(Z=>Z.id)),U=C.filter(Z=>!M.has(Z.id));return U.length===0&&C.length>0?setTimeout(()=>{J.error("All selected trainees are already in the list!",{autoClose:3e3,position:"top-right",toastId:"duplicate-trainees",closeButton:!1})},100):U.length<C.length&&U.length>0?setTimeout(()=>{J.warning(`Added ${U.length} new trainees. ${C.length-U.length} were already selected.`,{autoClose:4e3,position:"top-right",toastId:"partial-duplicates",closeButton:!1})},100):U.length===C.length&&U.length>0&&setTimeout(()=>{J.success(`Successfully added ${U.length} trainee${U.length>1?"s":""} to the selection!`,{autoClose:3e3,position:"top-right",toastId:"bulk-import-success",closeButton:!1})},100),[...R,...U]}),await new Promise(R=>setTimeout(R,1e3))}catch(C){throw C}finally{b(!1)}}},T=()=>{if(c.length===0||u.length===0){J.warning("Please select both subjects and trainees to enroll");return}x(!0)},O=async _=>{y(!0),x(!1);try{const C=u.map(re=>{if(!re.id)throw new Error(`Trainee ${re.eid} (${re.firstName} ${re.lastName}) is missing UUID`);return re.id}),R={batchCode:String(_).trim(),traineeUserIds:C},M=c.map(async re=>{if(!re){const z=w[re]||{name:"Unknown",code:"N/A"};throw new Error(`Invalid subject ID: ${re} (${z.name})`)}try{const z=await Jr.assignTrainees(re,R);return{subjectId:re,response:z,status:"success",subjectName:w[re]?.name||"Unknown Subject",subjectCode:w[re]?.code||"N/A"}}catch(z){const me=w[re]||{name:"Unknown Subject",code:"N/A"};return{subjectId:re,status:"error",error:z,subjectName:me.name,subjectCode:me.code,errorMessage:z.response?.data?.message||z.message||"Unknown error",errorDetails:z.response?.data}}}),U=await Promise.allSettled(M),Z=[],ee=[];if(U.forEach((re,z)=>{if(re.status==="fulfilled"){const me=re.value;me.status==="success"?Z.push(me):ee.push(me)}else{const me=c[z],ne=w[me]||{name:"Unknown Subject",code:"N/A"};ee.push({subjectId:me,status:"error",subjectName:ne.name,subjectCode:ne.code,errorMessage:re.reason?.message||"Unknown error",errorDetails:re.reason})}}),ee.length>0&&ee.forEach(re=>{const z=re.errorMessage||"Unknown error",me=`${re.subjectName} (${re.subjectCode})`;let ne=z;re.errorDetails?.message?ne=re.errorDetails.message:re.errorDetails?.errors&&Array.isArray(re.errorDetails.errors)&&(ne=re.errorDetails.errors.map(A=>A.message||A).join(", ")),J.error(`${me}: ${ne}`,{autoClose:5e3,position:"top-right",icon:!1})}),Z.length>0){const re=u.length;if(J.success(`Successfully enrolled ${re} trainee(s) to ${Z.length} subject(s): ${Z.map(z=>z.subjectName).join(", ")}`,{autoClose:4e3,position:"top-right",icon:!1}),ee.length===0)m([]),d([]);else{const z=new Set(Z.map(me=>me.subjectId));d(me=>me.filter(ne=>!z.has(ne)))}setTimeout(()=>{e(je.ACADEMIC_COURSE_DETAIL(t),{state:{activeTab:"trainees"}})},1e3)}}catch(C){let R="Failed to enroll trainees. Please try again.";C.response?.data?.message?R=C.response.data.message:C.message&&(R=C.message),J.error(R)}finally{y(!1)}};return s.jsxs(Ce,{fluid:!0,className:"py-4 px-4 enroll-page",style:{minHeight:"100%",display:"flex",flexDirection:"column"},children:[s.jsxs("div",{className:"mb-4 flex-shrink-0",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:N,className:"me-3",children:[s.jsx(At,{size:16,className:"me-1"}),"Back"]}),s.jsx("div",{children:s.jsxs("h5",{className:"mb-0 text-primary",children:["Enroll Trainees - ",s.jsx("strong",{children:r.name})," (",r.code,")"]})})]}),s.jsx(W,{className:"mb-4",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:s.jsx(W.Body,{className:"py-4 px-4",children:s.jsxs(de,{children:[s.jsx(H,{md:8,children:s.jsx("p",{className:"mb-0 text-muted",children:r.description})}),s.jsxs(H,{md:4,className:"text-end d-flex justify-content-end align-items-center gap-2",children:[s.jsx(yt,{permission:Te.BULK_ENROLL_TRAINEES,fallback:null,children:s.jsx(te,{size:"sm",variant:"primary",onClick:T,disabled:c.length===0||u.length===0||j,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:j?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true",style:{width:"0.5rem",height:"0.5rem"}}),"Enrolling..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Gr,{size:12,className:"me-1"})," Enroll"]})})}),s.jsx(yt,{permission:Te.BULK_ENROLL_TRAINEES,fallback:null,children:s.jsxs(te,{size:"sm",variant:"outline-primary",onClick:E,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[s.jsx(js,{size:12,className:"me-1"})," Bulk Import Trainees"]})}),"                "]})]})})})]}),s.jsx("div",{className:"mb-4 flex-shrink-0 main-content-section",style:{position:"relative",zIndex:1,marginBottom:"3rem"},children:s.jsxs(de,{className:"g-4",children:[s.jsx(H,{lg:6,children:s.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"visible",marginBottom:"2rem"},children:s.jsx(rle,{selectedSubjects:c,onSelectionChange:d,subjects:o})})}),s.jsx(H,{lg:6,children:s.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"hidden",marginBottom:"2rem"},children:s.jsx(sle,{selectedTrainees:u,onSelectionChange:m})})})]})}),s.jsx(ale,{show:f,onClose:()=>h(!1),onImport:P,loading:g}),s.jsx(nle,{show:p,onClose:()=>x(!1),onConfirm:O,loading:j})]})},ile=({assessmentEvents:e=[],loading:t=!1,onView:r,onUpdate:a})=>{const{sortedData:n,sortConfig:i,handleSort:o}=_r(e);if(t)return s.jsx(nr,{rows:4,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No assessment events found"}),s.jsx("p",{children:"There are no assessment events available."})]})});const l=({columnKey:u,children:m,className:f=""})=>{const h=i.key===u,p=h?i.direction:null;return s.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:p,size:14,color:"white"})})]}),h&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})},c=u=>{switch(String(u||"").toUpperCase()){case"ACTIVE":case"SCHEDULED":case"UPCOMING":case"NOT_STARTED":return"success";case"COMPLETED":case"FINISHED":return"info";case"CANCELLED":case"CANCELED":return"danger";case"ONGOING":case"IN_PROGRESS":return"warning";default:return"secondary"}},d=u=>{if(!u)return"-";try{return new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}};return s.jsx("div",{className:"table-responsive",children:s.jsxs(ar,{hover:!0,striped:!0,bordered:!0,className:"mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx(l,{columnKey:"name",children:"Name"}),s.jsx(l,{columnKey:"subject",children:"Subject"}),s.jsx(l,{columnKey:"course",children:"Course"}),s.jsx(l,{columnKey:"occurrenceDate",children:"Occurrence Date"}),s.jsx(l,{columnKey:"status",children:"Status"}),s.jsx("th",{className:"fw-semibold text-center",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:n.map((u,m)=>s.jsxs("tr",{style:{transition:"all 0.2s ease"},onMouseEnter:f=>{f.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:f=>{f.currentTarget.style.backgroundColor=""},children:[s.jsx("td",{className:"align-middle",children:s.jsx("span",{className:"fw-medium",children:u.name||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:u.subject||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:u.course||"-"})}),s.jsx("td",{className:"align-middle",children:s.jsx("span",{children:d(u.occurrenceDate)})}),s.jsx("td",{className:"align-middle",children:s.jsx(ke,{bg:c(u.status),className:"px-3 py-2",children:u.status||"-"})}),s.jsx("td",{className:"align-middle text-center",children:s.jsx(yt,{permissions:[Te.VIEW_ASSESSMENT_DETAILS,Te.UPDATE_ASSESSMENT_EVENT],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>r&&r(u.originalEvent||u),permission:Te.VIEW_ASSESSMENT_DETAILS},{label:"Update",icon:s.jsx(Yr,{}),onClick:()=>a&&a(u.originalEvent||u),permission:Te.UPDATE_ASSESSMENT_EVENT}]})})})]},u.id||m))})]})})},ole=({show:e,onClose:t,onSave:r,event:a,loading:n=!1})=>{const[i,o]=v.useState({name:"",occuranceDate:""}),[l,c]=v.useState({}),[d,u]=v.useState(!1),m=g=>{if(!g)return"";if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g))return g;try{const b=new Date(g);return isNaN(b.getTime())?"":b.toISOString().split("T")[0]}catch{return""}};v.useEffect(()=>{e&&a?o({name:a.name||"",occuranceDate:m(a.occuranceDate||a.occurrenceDate)}):e||(o({name:"",occuranceDate:""}),c({}))},[e,a]);const f=()=>{c({}),u(!1),t()},h=g=>{const{name:b,value:j}=g.target;o(y=>({...y,[b]:j})),l[b]&&c(y=>({...y,[b]:""}))},p=()=>{const g={};if((!i.name||i.name.trim()==="")&&(g.name="Event name is required"),!i.occuranceDate)g.occuranceDate="Occurrence date is required";else{const b=new Date(i.occuranceDate),j=new Date;j.setHours(0,0,0,0),b<j&&(g.occuranceDate="Occurrence date cannot be in the past")}return c(g),Object.keys(g).length===0},x=async g=>{if(g.preventDefault(),!!p()){if(!a){J.error("Event data is missing");return}u(!0);try{const[b,j,y]=i.occuranceDate.split("-").map(Number),S=new Date(Date.UTC(b,j-1,y,0,0,0,0)).toISOString(),N=a.occuranceDate||a.occurrenceDate,E=m(N),P={name:a.name,occuranceDate:E,templateId:a.templateInfo?.id||""};a.subjectId===null&&a.courseId?P.courseId=a.courseId:a.subjectId&&(P.subjectId=a.subjectId);const T={name:i.name,occuranceDate:S};console.log("Update Assessment Event - Request:",{params:P,body:T,isoDateString:S}),await Sr.updateAssessmentEvent(P,T),J.success("Assessment event updated successfully"),r&&r(),f()}catch(b){console.error("Error updating assessment event:",b);const j=b.response?.data?.message||b.message||"Failed to update assessment event";J.error(j)}finally{u(!1)}}};return a?s.jsxs(ce,{show:e,onHide:f,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"},children:[s.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(Yr,{className:"me-2",size:20}),"Update Assessment Event"]}),s.jsx(te,{variant:"link",onClick:f,className:"text-white p-0 ms-auto",style:{border:"none",background:"none",opacity:.9},disabled:d,children:s.jsx(st,{size:24,color:"#ffffff"})})]}),s.jsxs(k,{onSubmit:x,children:[s.jsxs(ce.Body,{className:"p-4",children:[s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-semibold",children:["Event Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",name:"name",value:i.name,onChange:h,isInvalid:!!l.name,placeholder:"Enter event name",disabled:d||n}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.name})]})})}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-semibold",children:["Occurrence Date ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"date",name:"occuranceDate",value:i.occuranceDate,onChange:h,isInvalid:!!l.occuranceDate,disabled:d||n}),s.jsx(k.Control.Feedback,{type:"invalid",children:l.occuranceDate})]})})}),s.jsxs(de,{className:"mt-4",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"p-3 bg-light rounded",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Course/Subject"}),s.jsx("strong",{children:a.entityInfo?.name||"-"})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"p-3 bg-light rounded",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Template"}),s.jsx("strong",{children:a.templateInfo?.name||"-"})]})})]})]}),s.jsxs(ce.Footer,{className:"border-top",children:[s.jsx(te,{variant:"secondary",onClick:f,disabled:d||n,children:"Cancel"}),s.jsx(te,{variant:"primary",type:"submit",disabled:d||n,className:"d-flex align-items-center",children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),"Update Event"]})})]})]})]}):null},lle=({onSuccess:e})=>{const[t,r]=v.useState({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),[a,n]=v.useState({}),[i,o]=v.useState(!1),[l,c]=v.useState([]),[d,u]=v.useState([]),[m,f]=v.useState([]),[h,p]=v.useState([]),[x,g]=v.useState([]),[b,j]=v.useState(!1),[y,w]=v.useState(null),[S,N]=v.useState(!1),[E,P]=v.useState(!0),[T,O]=v.useState(!1),[_,C]=v.useState(!0),[R,M]=v.useState(!0),[U,Z]=v.useState(!1),[ee,re]=v.useState(!1),[z,me]=v.useState(null);v.useEffect(()=>{(async()=>{try{P(!0);const L=(await Vt.getPublicDepartments()).filter(Ne=>Ne.isActive===!0);c(L)}catch(ue){console.error("Error loading departments:",ue),J.error("Failed to load departments"),c([])}finally{P(!1)}})()},[]),v.useEffect(()=>{(async()=>{if(!t.departmentId){u([]),r(ue=>({...ue,templateId:""}));return}try{O(!0);const ue=await tr.getTemplatesByDepartment(t.departmentId),L=ue?.data?.templates||ue?.templates||ue?.data||ue||[];u(L),r(Ne=>({...Ne,templateId:""}))}catch(ue){console.error("Error loading templates:",ue),J.error("Failed to load templates"),u([])}finally{O(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.departmentId){f([]),p([]),C(!1),M(!1),r(ue=>({...ue,courseId:"",subjectId:"",excludeTraineeIds:[]}));return}try{C(!0),M(!0);const ue=await Vt.getDepartmentById(t.departmentId);let L=[];ue?.courses&&Array.isArray(ue.courses)?L=ue.courses:ue?.data?.courses&&Array.isArray(ue.data.courses)&&(L=ue.data.courses);const Ne=L.filter(Pe=>Pe.status==="PLANNED"||Pe.status==="ON_GOING"||Pe.status==="FINISHED");f(Ne);let Oe=[];Ne.forEach(Pe=>{Pe.subjects&&Array.isArray(Pe.subjects)&&(Oe=Oe.concat(Pe.subjects))}),ue?.subjects&&Array.isArray(ue.subjects)?Oe=Oe.concat(ue.subjects):ue?.data?.subjects&&Array.isArray(ue.data.subjects)&&(Oe=Oe.concat(ue.data.subjects));const Qe=Oe.filter((Pe,rt,Ht)=>rt===Ht.findIndex(gt=>gt.id===Pe.id)).filter(Pe=>Pe.status==="PLANNED"||Pe.status==="ON_GOING"||Pe.status==="FINISHED");p(Qe)}catch(ue){console.error("Error loading courses and subjects:",ue),J.error("Failed to load courses and subjects"),f([]),p([])}finally{C(!1),M(!1)}})()},[t.departmentId]),v.useEffect(()=>{(async()=>{if(!t.courseId&&!t.subjectId){g([]),r(ue=>({...ue,excludeTraineeIds:[]}));return}try{Z(!0);let ue=[];if(t.courseId&&!t.subjectId){const L=await Nr.getCourseTrainees(t.courseId);ue=L?.trainees||L?.data?.trainees||[]}else if(t.subjectId){const L=await Jr.getSubjectById(t.subjectId),Ne=[];L?.enrollmentsByBatch&&L.enrollmentsByBatch.forEach(Oe=>{Oe.trainees&&Array.isArray(Oe.trainees)&&Oe.trainees.forEach(We=>{Ne.push({id:We.id,eid:We.eid,firstName:We.firstName,lastName:We.lastName,email:We.email})})}),ue=Ne}g(ue)}catch(ue){console.error("Error loading trainees:",ue),J.error("Failed to load trainees"),g([])}finally{Z(!1)}})()},[t.courseId,t.subjectId]);const ne=G=>{const ue=G.firstName||"",L=G.lastName||"",Ne=G.middleName||"";return`${ue} ${Ne} ${L}`.trim()||G.eid||"Unknown"},A=G=>{const{name:ue,value:L}=G.target;r(ue==="courseId"?Ne=>({...Ne,courseId:L,excludeTraineeIds:[]}):ue==="subjectId"?Ne=>({...Ne,subjectId:L,excludeTraineeIds:[]}):Ne=>({...Ne,[ue]:L})),a[ue]&&n(Ne=>({...Ne,[ue]:""}))},D=G=>{r(ue=>{const L=ue.excludeTraineeIds||[],Ne=L.includes(G)?L.filter(Oe=>Oe!==G):[...L,G];return{...ue,excludeTraineeIds:Ne}}),a.excludeTraineeIds&&n(ue=>({...ue,excludeTraineeIds:""}))},I=G=>{r(ue=>({...ue,templateId:G}))},V=async G=>{if(!G||!G.id){J.error("Template not found");return}try{N(!0),j(!0);const ue=await tr.getTemplatePDF(G.id),L=URL.createObjectURL(ue);w(L)}catch(ue){console.error("Error loading PDF:",ue),J.error("Failed to load PDF preview"),j(!1)}finally{N(!1)}},ie=()=>{j(!1),y&&(URL.revokeObjectURL(y),w(null))},se=()=>{const G={};if(t.departmentId||(G.departmentId="Department is required"),t.templateId||(G.templateId="Template is required"),t.courseId||(G.courseSubject="Course is required"),!t.occuranceDate)G.occuranceDate="Occurrence date is required";else{const ue=new Date(t.occuranceDate);if(t.subjectId){const L=h.find(Ne=>Ne.id===t.subjectId);if(L){const Ne=new Date(L.startDate),Oe=new Date(L.endDate);ue<Ne?G.occuranceDate=`Occurrence date must be on or after subject start date (${Ne.toLocaleDateString()})`:ue>Oe&&(G.occuranceDate=`Occurrence date must be on or before subject end date (${Oe.toLocaleDateString()})`)}}else if(t.courseId){const L=m.find(Ne=>Ne.id===t.courseId);if(L){const Ne=new Date(L.startDate),Oe=new Date(L.endDate);ue<Ne?G.occuranceDate=`Occurrence date must be on or after course start date (${Ne.toLocaleDateString()})`:ue>Oe&&(G.occuranceDate=`Occurrence date must be on or before course end date (${Oe.toLocaleDateString()})`)}}}return(!t.name||t.name.trim()==="")&&(G.name="Event name is required"),n(G),Object.keys(G).length===0},ae=async G=>{if(G.preventDefault(),!se())return;const ue={templateId:t.templateId,occuranceDate:t.occuranceDate,name:t.name,excludeTraineeIds:t.excludeTraineeIds||[]};t.subjectId?ue.subjectId=t.subjectId:t.courseId&&(ue.courseId=t.courseId);const L=x.length-(t.excludeTraineeIds?.length||0);let Ne="";t.subjectId?Ne=h.find(We=>We.id===t.subjectId)?.name||"Subject":t.courseId&&(Ne=m.find(We=>We.id===t.courseId)?.name||"Course"),me({requestData:ue,numTraineesToCreate:L,entityName:Ne}),re(!0)},K=async()=>{if(z){o(!0),re(!1);try{await Sr.createBulkAssessmentEvent(z.requestData),J.success("Bulk assessment event created successfully"),r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),n({}),g([]),me(null),e&&e()}catch(G){console.error("Error creating bulk assessment event:",G);const ue=G.response?.data?.message||G.message||"Failed to create bulk assessment event";J.error(ue)}finally{o(!1)}}};return s.jsxs(k,{onSubmit:ae,className:"create-assessment-event-form",children:[s.jsx(de,{children:s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-semibold",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(ld,{name:"departmentId",value:t.departmentId,onChange:A,isInvalid:!!a.departmentId,disabled:i||E,placeholder:"Select a department",options:l.map(G=>({value:G.id,label:G.name}))}),s.jsx(k.Control.Feedback,{type:"invalid",children:a.departmentId})]})})}),s.jsx(de,{children:s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-semibold",children:["Template ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(ld,{name:"templateId",value:t.templateId,onChange:G=>I(G.target.value),isInvalid:!!a.templateId,disabled:i||T||!t.departmentId,placeholder:t.departmentId?"Select a template":"Select a department first",options:d.map(G=>({value:G.id,label:G.name}))}),t.templateId&&s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:()=>{const G=d.find(ue=>ue.id===t.templateId);G&&V(G)},disabled:i,className:"d-flex align-items-center",children:[s.jsx(Bt,{size:16,className:"me-1"}),"Preview"]})]}),s.jsx(k.Control.Feedback,{type:"invalid",children:a.templateId}),!t.departmentId&&s.jsx(k.Text,{className:"text-muted",children:"Please select a department first to load templates."})]})})}),s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3 course-select-group",children:[s.jsxs(k.Label,{className:"fw-semibold",children:["Course ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(ld,{name:"courseId",value:t.courseId,onChange:A,isInvalid:!!a.courseSubject,disabled:i||_,placeholder:"Select a course",options:m.map(G=>({value:G.id,label:`${G.name} (${G.code})`}))}),s.jsx(k.Control.Feedback,{type:"invalid",children:a.courseSubject})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3 subject-select-group",children:[s.jsx(k.Label,{className:"fw-semibold",children:"Subject (Optional)"}),s.jsx(ld,{name:"subjectId",value:t.subjectId,onChange:A,disabled:i||R||!t.courseId,placeholder:t.courseId?"Select a subject (optional)":"Select a course first",options:t.courseId?h.filter(G=>G.courseId===t.courseId).map(G=>({value:G.id,label:`${G.name} (${G.code})`})):[]}),!t.courseId&&s.jsx(k.Text,{className:"text-muted",children:"Please select a course first to load subjects."})]})})]}),a.courseSubject&&s.jsx(De,{variant:"danger",className:"mb-3",children:a.courseSubject}),s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-semibold",children:["Event Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",name:"name",value:t.name,onChange:A,isInvalid:!!a.name,placeholder:"Enter event name",disabled:i}),s.jsx(k.Control.Feedback,{type:"invalid",children:a.name})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-semibold",children:["Occurrence Date ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"date",name:"occuranceDate",value:t.occuranceDate,onChange:A,isInvalid:!!a.occuranceDate,disabled:i}),s.jsx(k.Control.Feedback,{type:"invalid",children:a.occuranceDate})]})})]}),s.jsx(de,{children:s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"fw-semibold",children:"Exclude Trainees (Optional)"}),!t.courseId&&!t.subjectId?s.jsx(De,{variant:"info",className:"mb-0",children:"Please select a Course or Subject first to load trainees."}):U?s.jsxs("div",{className:"text-center py-3",children:[s.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading trainees..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading trainees..."})]}):x.length===0?s.jsxs(De,{variant:"warning",className:"mb-0",children:["No trainees found for the selected ",t.courseId?"course":"subject","."]}):s.jsx("div",{style:{maxHeight:"clamp(200px, 40vh, 400px)",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",border:"1px solid #dee2e6",borderRadius:"0.375rem",backgroundColor:"#fff"},children:s.jsx("div",{style:{padding:"0.75rem"},children:s.jsx("div",{className:"d-flex flex-column gap-2",children:x.map(G=>{const ue=t.excludeTraineeIds?.includes(G.id);return s.jsx("div",{className:`border rounded cursor-pointer ${ue?"bg-primary":"bg-light"}`,onClick:()=>D(G.id),style:{padding:"0.5rem",cursor:"pointer",transition:"all 0.2s ease",backgroundColor:ue?"var(--bs-primary)":"var(--bs-light)",color:ue?"#ffffff":"var(--bs-dark)",minHeight:"48px",display:"flex",alignItems:"center",userSelect:"none"},onMouseEnter:L=>{ue||(L.currentTarget.style.backgroundColor="#e9ecef")},onMouseLeave:L=>{ue||(L.currentTarget.style.backgroundColor="var(--bs-light)")},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between w-100 gap-2",style:{flexWrap:"wrap"},children:[s.jsxs("div",{style:{flex:"1 1 auto",minWidth:"0px"},children:[s.jsx("strong",{style:{color:ue?"#ffffff":"inherit",wordBreak:"break-word",fontSize:"0.95rem"},children:ne(G)}),G.eid&&s.jsx(ke,{bg:ue?"light":"secondary",style:{marginLeft:"0.5rem",color:ue?"var(--bs-primary)":"#ffffff",fontSize:"0.7rem",padding:"0.35rem 0.6rem"},children:G.eid})]}),ue&&s.jsx(ke,{bg:"light",style:{color:"var(--bs-primary)",fontSize:"0.7rem",whiteSpace:"nowrap",flex:"0 0 auto",padding:"0.35rem 0.6rem"},children:"Excluded"})]})},G.id)})})})}),t.excludeTraineeIds&&t.excludeTraineeIds.length>0&&s.jsxs(k.Text,{className:"text-muted",children:[t.excludeTraineeIds.length," trainee(s) excluded"]})]})})}),s.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[s.jsx(te,{variant:"secondary",onClick:()=>{r({departmentId:"",templateId:"",subjectId:"",courseId:"",occuranceDate:"",name:"",excludeTraineeIds:[]}),n({}),g([]),u([])},disabled:i,children:"Reset"}),s.jsx(te,{variant:"primary",type:"submit",disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),"Create Bulk Assessment Event"]})})]}),s.jsxs(ce,{show:ee,onHide:()=>{re(!1),me(null)},centered:!0,size:"lg",children:[s.jsx(ce.Header,{closeButton:!0,className:"bg-primary text-white",style:{borderBottom:"none"},children:s.jsx(ce.Title,{className:"fw-bold",children:"Confirm Bulk Assessment Event Creation"})}),s.jsx(ce.Body,{style:{padding:"2rem"},children:s.jsxs("div",{style:{lineHeight:"1.8"},children:[s.jsxs("p",{style:{fontSize:"1rem",color:"var(--bs-dark)",marginBottom:"1.5rem"},children:["Assessment Forms will be generated for"," ",s.jsx("strong",{style:{fontSize:"1.15rem",color:"var(--bs-primary)"},children:z?.numTraineesToCreate||0})," ","Trainees of"," ",s.jsx("strong",{style:{fontSize:"1.15rem",color:"var(--bs-secondary)"},children:t.subjectId?"Subject":"Course"})," ",s.jsx("strong",{style:{fontSize:"1.15rem",color:"var(--bs-primary)"},children:z?.entityName||"N/A"}),"."]}),s.jsxs("div",{style:{backgroundColor:"var(--bs-light)",border:"1px solid var(--bs-neutral)",borderRadius:"0.375rem",padding:"1rem",marginBottom:"1.5rem"},children:[s.jsx("p",{style:{marginBottom:"0.5rem",fontSize:"0.9rem",color:"var(--bs-dark)"},children:s.jsx("strong",{children:"Summary:"})}),s.jsxs("ul",{style:{marginBottom:"0",paddingLeft:"1.5rem",color:"var(--bs-dark)",fontSize:"0.95rem"},children:[s.jsxs("li",{children:["Type: ",s.jsx("strong",{children:t.subjectId?"Subject":"Course"})]}),s.jsxs("li",{children:["Name: ",s.jsx("strong",{children:z?.entityName||"N/A"})]}),s.jsxs("li",{children:["Total Trainees: ",s.jsx("strong",{children:x.length})]}),s.jsxs("li",{children:["Excluded Trainees: ",s.jsx("strong",{children:t.excludeTraineeIds?.length||0})]}),s.jsxs("li",{children:["Trainees to Include: ",s.jsx("strong",{style:{color:"var(--bs-primary)"},children:z?.numTraineesToCreate||0})]})]})]}),s.jsx("p",{style:{fontSize:"0.95rem",color:"var(--bs-dark)",marginBottom:"0"},children:"Please review the information above before confirming."})]})}),s.jsxs(ce.Footer,{style:{borderTop:"1px solid var(--bs-neutral)",padding:"1.5rem"},children:[s.jsx(te,{variant:"light",onClick:()=>{re(!1),me(null)},disabled:i,style:{color:"var(--bs-dark)",borderColor:"var(--bs-neutral)",transition:"all 0.2s ease"},children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:K,disabled:i,className:"d-flex align-items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),"Confirm & Create"]})})]})]}),s.jsxs(ce,{show:b,onHide:ie,size:"lg",centered:!0,fullscreen:"lg-down",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Template Preview"})}),s.jsx(ce.Body,{style:{padding:0,height:"70vh",minHeight:"500px"},children:S?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2",children:"Loading PDF..."})]})}):y?s.jsx("iframe",{src:`${y}#toolbar=0`,style:{width:"100%",height:"100%",border:"none"},title:"Template PDF Preview"}):s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:s.jsx("p",{className:"text-muted",children:"No preview available"})})})]})]})},b2=()=>{const[e,t]=el(),r=e.get("tab"),[a,n]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(!1),[d,u]=v.useState(!1),[m,f]=v.useState(null),[h,p]=v.useState(r||"list"),x=async()=>{try{o(!0);const T=((await Sr.getAssessmentEvents())?.data?.events||[]).map((O,_)=>{let C="",R="";return O.subjectId===null?O.entityInfo&&O.entityInfo.type==="course"&&(R=O.entityInfo.name||"",C=""):(O.entityInfo&&O.entityInfo.type==="subject"&&(C=O.entityInfo.name||""),R=""),{id:O.id||`event-${_}`,name:O.name||"N/A",subject:C,course:R,occurrenceDate:O.occuranceDate||O.occurrenceDate,status:O.status||"N/A",createdAt:O.createdAt,originalEvent:O}});T.sort((O,_)=>{const C=new Date(O.createdAt||0);return new Date(_.createdAt||0)-C}),n(T)}catch(E){console.error("Error loading assessment events:",E),n([])}finally{o(!1)}};v.useEffect(()=>{x()},[]),v.useEffect(()=>{const E=e.get("tab");E&&["list","create-bulk"].includes(E)&&p(E)},[e]);const g=E=>{p(E),t(E==="list"?{}:{tab:E})},b=E=>{const P=E.originalEvent||E;f(P),c(!0)},j=()=>{c(!1),f(null)},y=E=>{const P=E.originalEvent||E;f(P),u(!0)},w=()=>{u(!1),f(null)},S=()=>{x()},N=()=>{x(),p("list"),t({})};return s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{children:s.jsx(H,{children:s.jsx(W,{className:"shadow-sm",children:s.jsx($t.Container,{activeKey:h,onSelect:g,children:s.jsxs(W.Body,{className:"p-0",style:{overflow:"visible",minHeight:"800px"},children:[s.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Xe,{variant:"tabs",className:"border-0",children:[s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"list",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:h==="list"?"600":"400",opacity:h==="list"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(J2,{className:"me-2",size:16}),"Assessment Events"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"create-bulk",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:h==="create-bulk"?"600":"400",opacity:h==="create-bulk"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx($x,{className:"me-2",size:16}),"Create Assessment Events"]})})]})}),s.jsxs($t.Content,{children:[s.jsx($t.Pane,{eventKey:"list",className:"p-4",children:s.jsx(ile,{assessmentEvents:a,loading:i,onView:b,onUpdate:y})}),s.jsx($t.Pane,{eventKey:"create-bulk",className:"p-4",style:{overflow:"visible",minHeight:"800px"},children:s.jsx(lle,{onSuccess:N})})]})]})})})})}),s.jsx(F1,{show:l,onClose:j,event:m}),s.jsx(ole,{show:d,onClose:w,onSave:S,event:m,loading:i})]})},cle=({traineeId:e,courseId:t})=>{const r=tt(),[a,n]=v.useState([]),[i,o]=v.useState(!0);v.useEffect(()=>{e&&l()},[e,t]);const l=async()=>{try{o(!0),n([{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}])}catch(m){console.error("Error loading upcoming assessments:",m),J.error("Failed to load upcoming assessments")}finally{o(!1)}},c=m=>{const h={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[m]||{variant:"secondary",text:m};return s.jsx(ke,{bg:h.variant,children:h.text})},d=m=>{const h={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"}}[m?.toUpperCase()]||{variant:"secondary",text:m};return s.jsx(ke,{bg:h.variant,children:h.text})},u=async m=>{try{r(`/trainee/${e}/assessment/${m}?action=start`)}catch(f){console.error("Error starting assessment:",f),J.error("Failed to start assessment")}};return i?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(ct,{animation:"border",variant:"primary",size:"sm"}),s.jsx("p",{className:"mt-2 text-muted small",children:"Loading upcoming assessments..."})]}):a.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(or,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No upcoming assessments"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Assessment"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Type"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Priority"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Due Date"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:a.map((m,f)=>s.jsxs("tr",{className:`${f%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor=f%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:m.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:m.subject})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:d(m.type)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(m.priority)}),s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{className:"text-muted me-1",size:14}),s.jsx("span",{className:"text-dark",children:new Date(m.dueDate).toLocaleDateString()})]}),s.jsx("small",{className:"text-muted",children:new Date(m.dueDate).toLocaleTimeString()})]}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsxs(te,{variant:"primary",size:"sm",onClick:()=>u(m.id),children:[s.jsx(rr,{className:"me-1",size:14}),"Start"]})})]},m.id))})]})})},ks=({title:e,sortKey:t,sortConfig:r,onSort:a})=>{const n=()=>{a(t)},i=()=>r.key===t?r.direction==="asc"?s.jsx(H2,{size:12,className:"ms-1"}):s.jsx(ai,{size:12,className:"ms-1"}):s.jsx(rs,{size:12,className:"ms-1"});return s.jsxs("div",{className:"d-flex align-items-center cursor-pointer user-select-none",onClick:n,style:{cursor:"pointer",whiteSpace:"nowrap"},children:[s.jsx("span",{className:"me-1",children:e}),i()]})},dle=`
  .completed-assessments-table-no-borders .table,
  .completed-assessments-table-no-borders .table td,
  .completed-assessments-table-no-borders .table th,
  .completed-assessments-table-no-borders .table tbody tr,
  .completed-assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .completed-assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .completed-assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=dle,document.head.appendChild(e)}const ule=({traineeId:e,courseId:t,subjectId:r})=>{const a=tt(),[n,i]=v.useState([]),[o,l]=v.useState(!0),{sortedData:c,sortConfig:d,handleSort:u}=_r(n);v.useEffect(()=>{m()},[e,t,r]);const m=async()=>{try{l(!0);let g=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}];t&&(g=g.filter(b=>b.course?.code==="SAF001")),r&&(g=g.filter(b=>b.subject?.code==="BSP")),await new Promise(b=>setTimeout(b,300)),i(g)}catch(x){console.error("Error loading completed assessments:",x),J.error("Failed to load completed assessments")}finally{l(!1)}},f=x=>{const b={COMPLETED:{variant:"success",text:"Completed",icon:Je},PASSED:{variant:"success",text:"Passed",icon:Je},FAILED:{variant:"danger",text:"Failed",icon:Jt}}[x]||{variant:"secondary",text:x,icon:Je},j=b.icon;return s.jsxs(ke,{bg:b.variant,className:"d-flex align-items-center",children:[s.jsx(j,{size:12,className:"me-1"}),b.text]})},h=(x,g)=>{const b=x/g*100;let j="success";return b<60?j="danger":b<80&&(j="warning"),s.jsxs(ke,{bg:j,children:[x,"/",g," (",b.toFixed(0),"%)"]})},p=x=>{a(`/trainee/${e}/assessment/${x.id}`)};return o?s.jsx("div",{className:"text-center py-4",children:s.jsx(nr,{count:5})}):n.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Je,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No completed assessments"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(ks,{title:"Assessment",sortKey:"name",sortConfig:d,onSort:u})}),!r&&s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(ks,{title:"Subject",sortKey:"subject",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(ks,{title:"Type",sortKey:"type",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(ks,{title:"Score",sortKey:"score",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(ks,{title:"Completed Date",sortKey:"completedDate",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:s.jsx(ks,{title:"Status",sortKey:"status",sortConfig:d,onSort:u})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:c.map((x,g)=>s.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:x.name}),s.jsx("small",{className:"text-muted",children:x.description})]}),!r&&s.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[s.jsx("div",{className:"fw-medium text-dark",children:x.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:x.subject?.code||""})]}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(ke,{bg:"primary",className:"fw-normal",children:x.type||"Assessment"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:h(x.score,x.maxScore)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:x.completedDate?new Date(x.completedDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:f(x.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Results",icon:s.jsx(Je,{}),onClick:()=>p(x)}]})})]},x.id))})]})})},mle=({traineeId:e,courseId:t,subjectId:r})=>{const a=tt(),[n,i]=v.useState(null),[o,l]=v.useState(null),[c,d]=v.useState(!0),[u,m]=v.useState("");v.useEffect(()=>{e&&t&&r&&f()},[e,t,r]);const f=async()=>{try{d(!0),m("");const g={id:r,name:"Emergency Procedures",code:"EP101",description:"Comprehensive training on emergency procedures and safety protocols for flight operations.",level:"INTERMEDIATE",status:"ACTIVE",duration:40,method:"Simulator",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",roomName:"Simulator Room A",progress:75,trainer:{name:"Captain John Smith",email:"john.smith@instructor.com"},assessments:[{id:"1",name:"Emergency Evacuation Drill",type:"Practical",dueDate:"2024-02-10T14:00:00.000Z",status:"COMPLETED",score:85},{id:"2",name:"Safety Protocol Test",type:"Written",dueDate:"2024-02-12T10:00:00.000Z",status:"PENDING",score:null}]},b={id:e,firstName:"John",lastName:"Doe",eid:"TR001"};i(g),l(b)}catch(g){console.error("Error loading subject details:",g),m("Failed to load subject details"),J.error("Failed to load subject details")}finally{d(!1)}},h=()=>{a(`/trainee/${e}/course/${t}`)},p=g=>{const j={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[g]||{variant:"secondary",text:g};return s.jsx(ke,{bg:j.variant,className:"fs-6",children:j.text})},x=g=>{const j={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[g]||{variant:"secondary",text:g};return s.jsx(ke,{bg:j.variant,children:j.text})};return c?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading subject details..."})]})}):u||!n?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:u||"Subject not found"}),s.jsxs(te,{variant:"outline-danger",onClick:h,children:[s.jsx(At,{className:"me-2",size:16}),"Back to Course"]})]})}):s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(te,{variant:"outline-secondary",onClick:h,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(Dt,{className:"me-2",size:28}),n.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",o?.firstName," ",o?.lastName]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[p(n.status),x(n.level)]})]})})}),s.jsxs(de,{children:[s.jsxs(H,{lg:8,className:"mb-4",children:[s.jsx(de,{children:s.jsx(H,{className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(rr,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),s.jsx(W.Body,{className:"p-0",children:s.jsx(cle,{traineeId:e,courseId:t,subjectId:r})})]})})}),s.jsx(de,{children:s.jsx(H,{children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Je,{className:"me-2",size:20}),"Completed Assessments"]})}),s.jsx(W.Body,{className:"p-0",children:s.jsx(ule,{traineeId:e,courseId:t,subjectId:r})})]})})})]}),s.jsx(H,{lg:4,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Dt,{className:"me-2",size:20}),"Enrolled Subject Details"]})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Start Date"}),s.jsx("div",{className:"text-muted",children:new Date(n.startDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"End Date"}),s.jsx("div",{className:"text-muted",children:new Date(n.endDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Duration"}),s.jsxs("div",{className:"text-muted",children:[n.duration," hours"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Lo,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Room"}),s.jsx("div",{className:"text-muted",children:n.roomName})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Trainer"}),s.jsx("div",{className:"text-muted",children:n.trainer?.name})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("span",{className:"fw-semibold",children:"Progress"}),s.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),s.jsx("div",{className:"progress",children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${n.progress}%`}})})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("h6",{children:"Description"}),s.jsx("p",{className:"text-muted",children:n.description})]})]})]})})]})]})},fle=()=>{const{traineeId:e,courseId:t,subjectId:r}=ur();return s.jsx(Ce,{className:"py-3",children:s.jsx(mle,{traineeId:e,courseId:t,subjectId:r})})},hle=({traineeId:e})=>{const t=tt(),[r,a]=v.useState(null),[n,i]=v.useState([]),[o,l]=v.useState([]),[c,d]=v.useState([]),[u,m]=v.useState(!0),[f,h]=v.useState("");v.useEffect(()=>{e&&p()},[e]);const p=async()=>{try{m(!0),h("");const N=await Zd.getTraineeById(e);a(N);const E=await Zd.getTraineeAssessments(e);i(E.assessments||E.data||[]);const P=[{id:"1",name:"Safety Protocol Agreement",course:"Emergency Procedures",subject:"Safety Protocols",dueDate:"2024-02-15T17:00:00.000Z",status:"PENDING"},{id:"2",name:"Training Completion Certificate",course:"Advanced Flight Training",subject:"Flight Operations",dueDate:"2024-02-20T17:00:00.000Z",status:"PENDING"}],T=[{id:"1",name:"Emergency Evacuation Procedures",course:"Emergency Procedures",subject:"Safety Protocols",section:"Practical Assessment",dueDate:"2024-02-12T14:00:00.000Z",status:"IN_PROGRESS",progress:60},{id:"2",name:"Flight Navigation Systems",course:"Advanced Flight Training",subject:"Navigation",section:"Written Test",dueDate:"2024-02-18T10:00:00.000Z",status:"PENDING",progress:0}];l(P),d(T)}catch(N){console.error("Error loading assessment data:",N),h("Failed to load assessment data"),J.error("Failed to load assessment data")}finally{m(!1)}},x=()=>{t(je.ASSESSMENTS_MY_ASSESSMENTS)},g=N=>{const P={PENDING:{variant:"warning",text:"Pending",icon:Ke},IN_PROGRESS:{variant:"info",text:"In Progress",icon:rr},COMPLETED:{variant:"success",text:"Completed",icon:Je},OVERDUE:{variant:"danger",text:"Overdue",icon:Jt}}[N]||{variant:"secondary",text:N,icon:rr},T=P.icon;return s.jsxs(ke,{bg:P.variant,className:"d-flex align-items-center",children:[s.jsx(T,{size:12,className:"me-1"}),P.text]})},b=N=>{const P={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[N]||{variant:"secondary",text:N};return s.jsx(ke,{bg:P.variant,children:P.text})},j=N=>{t(`/trainee/${e}/assessment/${N}`)},y=N=>{t(`/trainee/${e}/assessment/${N}`)},w=N=>{t(`/trainee/${e}/signature-pad/${N}`)},S=N=>{t(`/trainee/${e}/assessment-section/${N}`)};return u?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment data..."})]})}):f||!r?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:f||"Trainee not found"}),s.jsxs(te,{variant:"outline-danger",onClick:x,children:[s.jsx(At,{className:"me-2",size:16}),"Back to Trainee"]})]})}):s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(te,{variant:"outline-secondary",onClick:x,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(rr,{className:"me-2",size:28}),"Assessment Management"]}),s.jsxs("p",{className:"text-muted mb-0",children:[r.firstName," ",r.lastName,"  ",r.eid]})]})]})})})}),s.jsx(de,{children:s.jsx(H,{children:s.jsx(W,{className:"border-0 shadow-sm",children:s.jsx(W.Body,{className:"p-0",children:s.jsxs(R2,{defaultActiveKey:"pending",className:"border-bottom",children:[s.jsx($t,{eventKey:"pending",title:"Pending Assessments",children:s.jsx("div",{className:"p-4",children:n.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(rr,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No pending assessments"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Assessment"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Type"}),s.jsx("th",{className:"text-start",children:"Priority"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:n.map(N=>s.jsxs("tr",{children:[s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:N.name}),s.jsx("small",{className:"text-muted",children:N.description})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:N.course?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:N.course?.code||""})]}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:N.subject?.name||"N/A"}),s.jsx("small",{className:"text-muted",children:N.subject?.code||""})]}),s.jsx("td",{children:s.jsx(ke,{bg:"info",className:"fw-normal",children:N.type||"Assessment"})}),s.jsx("td",{children:b(N.priority)}),s.jsx("td",{children:N.dueDate?new Date(N.dueDate).toLocaleDateString():"N/A"}),s.jsx("td",{children:g(N.status)}),s.jsx("td",{children:s.jsx("div",{className:"d-flex gap-1",children:N.status==="PENDING"||N.status==="IN_PROGRESS"?s.jsx(te,{variant:"primary",size:"sm",onClick:()=>j(N.id),children:"Start"}):s.jsx(te,{variant:"outline-primary",size:"sm",onClick:()=>y(N.id),children:"View"})})})]},N.id))})]})})})}),s.jsx($t,{eventKey:"signature",title:"Signature Required",children:s.jsx("div",{className:"p-4",children:o.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Gi,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Document"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:o.map(N=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:N.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:N.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:N.subject})}),s.jsx("td",{children:new Date(N.dueDate).toLocaleDateString()}),s.jsx("td",{children:g(N.status)}),s.jsx("td",{children:s.jsxs(te,{variant:"primary",size:"sm",onClick:()=>w(N.id),children:[s.jsx(Gi,{className:"me-1",size:14}),"Sign"]})})]},N.id))})]})})})}),s.jsx($t,{eventKey:"completion",title:"Section Completion",children:s.jsx("div",{className:"p-4",children:c.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Je,{size:32,className:"text-muted mb-2"}),s.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):s.jsx("div",{className:"trainee-assessments-table",children:s.jsxs("table",{className:"table table-hover mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-start",children:"Section"}),s.jsx("th",{className:"text-start",children:"Course"}),s.jsx("th",{className:"text-start",children:"Subject"}),s.jsx("th",{className:"text-start",children:"Type"}),s.jsx("th",{className:"text-start",children:"Due Date"}),s.jsx("th",{className:"text-start",children:"Progress"}),s.jsx("th",{className:"text-start",children:"Status"}),s.jsx("th",{className:"text-start",children:"Actions"})]})}),s.jsx("tbody",{children:c.map(N=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:N.name})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:N.course})}),s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:N.subject})}),s.jsx("td",{children:s.jsx(ke,{bg:"info",className:"fw-normal",children:N.section})}),s.jsx("td",{children:new Date(N.dueDate).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${N.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),s.jsx("td",{children:g(N.status)}),s.jsx("td",{children:s.jsx(te,{variant:"primary",size:"sm",onClick:()=>S(N.id),children:N.status==="COMPLETED"?"View":"Complete"})})]},N.id))})]})})})})]})})})})})]})},ple=()=>{const{traineeId:e}=ur();return s.jsx(Ce,{className:"py-3",children:s.jsx(hle,{traineeId:e})})},xle=()=>{const{traineeId:e,assessmentId:t}=ur(),r=tt(),[a,n]=el(),[i,o]=v.useState(null),[l,c]=v.useState(!0),[d,u]=v.useState("");v.useEffect(()=>{t&&m()},[t]),v.useEffect(()=>{if(i&&a.get("action")==="start"){n({});const w=i.sections?.find(S=>S.status!=="COMPLETED");w&&r(je.TRAINEE_ASSESSMENT_SECTION(w.id))}},[i,a,r,e,n]);const m=async()=>{try{c(!0),u(""),o({id:t,name:"Emergency Procedures Assessment",description:"Comprehensive assessment covering emergency evacuation procedures, safety protocols, and equipment handling.",course:{id:"course-1",name:"Emergency Procedures Training",code:"EPT2024"},subject:{id:"subject-1",name:"Safety Protocols",code:"SP101"},type:"PRACTICAL",status:"IN_PROGRESS",priority:"HIGH",dueDate:"2024-02-15T17:00:00.000Z",startDate:"2024-02-10T08:00:00.000Z",timeLimit:120,progress:60,score:null,maxScore:100,completedDate:null,sections:[{id:"section-1",name:"Emergency Evacuation Procedures",status:"COMPLETED",progress:100},{id:"section-2",name:"Safety Protocol Review",status:"IN_PROGRESS",progress:60},{id:"section-3",name:"Equipment Handling",status:"PENDING",progress:0}],requiresSignature:!0,signatureStatus:"PENDING",instructions:["Read each question carefully before answering","You have 120 minutes to complete this assessment","Save your progress regularly","Ensure all required sections are completed","Signature will be required upon completion"]})}catch(w){console.error("Error loading assessment details:",w),u("Failed to load assessment details"),J.error("Failed to load assessment details")}finally{c(!1)}},f=()=>{r(-1)},h=()=>{const w=i.sections.find(S=>S.status!=="COMPLETED");w?r(`/trainee/${e}/assessment-section/${w.id}`):J.info("Starting assessment...")},p=()=>{const w=i.sections.find(S=>S.status==="IN_PROGRESS");w?r(`/trainee/${e}/assessment-section/${w.id}`):h()},x=w=>{r(`/trainee/${e}/assessment-section/${w}`)},g=()=>{r(je.TRAINEE_SIGNATURE_PAD(t))},b=()=>{r(je.REPORTS_CREATE,{state:{assessmentId:t,assessmentName:i.name}})},j=w=>{const N={PENDING:{variant:"warning",text:"Pending",icon:Ke},IN_PROGRESS:{variant:"info",text:"In Progress",icon:rr},COMPLETED:{variant:"success",text:"Completed",icon:Je},OVERDUE:{variant:"danger",text:"Overdue",icon:Jt}}[w]||{variant:"secondary",text:w,icon:rr},E=N.icon;return s.jsxs(ke,{bg:N.variant,className:"d-flex align-items-center",children:[s.jsx(E,{size:12,className:"me-1"}),N.text]})},y=w=>{const N={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[w]||{variant:"secondary",text:w};return s.jsx(ke,{bg:N.variant,children:N.text})};return l?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment details..."})]})}):d||!i?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:d||"Assessment not found"}),s.jsxs(te,{variant:"outline-danger",onClick:f,children:[s.jsx(At,{className:"me-2",size:16}),"Back"]})]})}):s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(te,{variant:"outline-secondary",onClick:f,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(rr,{className:"me-2",size:28}),i.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[i.course?.name||"Course","  ",i.subject?.name||"Subject"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[j(i.status),y(i.priority)]})]})})}),s.jsxs(de,{children:[s.jsx(H,{lg:8,className:"mb-4",children:s.jsx(W,{className:"h-100 border-0 shadow-sm",children:s.jsx(W.Body,{className:"p-0",children:s.jsxs(R2,{defaultActiveKey:i.status==="COMPLETED"?"results":"overview",className:"border-bottom",children:[s.jsx($t,{eventKey:"overview",title:"Overview",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Description"}),s.jsx("p",{className:"text-muted",children:i.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Instructions"}),s.jsx("ul",{className:"list-unstyled",children:i.instructions.map((w,S)=>s.jsxs("li",{className:"mb-2",children:[s.jsx("span",{className:"text-primary me-2",children:""}),w]},S))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Assessment Sections"}),s.jsx("div",{className:"row",children:i.sections.map((w,S)=>s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx(W,{className:`${w.status==="COMPLETED"?"bg-light":""}`,children:s.jsxs(W.Body,{children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",S+1]}),j(w.status)]}),s.jsx("h6",{className:"mb-2",children:w.name}),s.jsx("div",{className:"progress mb-2",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${w.progress}%`}})}),s.jsx(te,{variant:w.status==="COMPLETED"?"outline-success":"primary",size:"sm",onClick:()=>x(w.id),children:w.status==="COMPLETED"?"View":w.status==="IN_PROGRESS"?"Continue":"Start"})]})})},w.id))})]}),s.jsxs("div",{className:"d-flex gap-2",children:[i.status==="PENDING"?s.jsxs(te,{variant:"primary",size:"lg",onClick:h,children:[s.jsx(rr,{className:"me-2",size:20}),"Start Assessment"]}):i.status==="IN_PROGRESS"?s.jsxs(te,{variant:"primary",size:"lg",onClick:p,children:[s.jsx(rr,{className:"me-2",size:20}),"Continue Assessment"]}):null,i.requiresSignature&&i.signatureStatus==="PENDING"&&s.jsxs(te,{variant:"outline-primary",size:"lg",onClick:g,children:[s.jsx(Gi,{className:"me-2",size:20}),"Sign Document"]})]})]})}),s.jsx($t,{eventKey:"progress",title:"Progress",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Overall Progress"}),s.jsx("div",{className:"progress mb-2",style:{height:"20px"},children:s.jsxs("div",{className:"progress-bar bg-primary",style:{width:`${i.progress}%`},children:[i.progress,"%"]})}),s.jsxs("small",{className:"text-muted",children:[i.sections.filter(w=>w.status==="COMPLETED").length," of ",i.sections.length," sections completed"]})]}),s.jsx("h5",{children:"Section Progress"}),i.sections.map((w,S)=>s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",S+1,": ",w.name]}),s.jsxs("span",{className:"text-muted",children:[w.progress,"%"]})]}),s.jsx("div",{className:"progress",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:`${w.progress}%`}})})]},w.id))]})}),i.status==="COMPLETED"&&s.jsx($t,{eventKey:"results",title:"Results",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Assessment Score"}),i.score!==null?s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs("div",{className:"display-4 fw-bold text-primary me-3",children:[i.score," / ",i.maxScore]}),s.jsx("div",{children:s.jsxs(ke,{bg:i.score>=i.maxScore*.8?"success":i.score>=i.maxScore*.6?"warning":"danger",className:"fs-6",children:[Math.round(i.score/i.maxScore*100),"%"]})})]}):s.jsx("p",{className:"text-muted",children:"Score pending review"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{children:"Section Results"}),i.sections?.map((w,S)=>s.jsx(W,{className:"mb-2",children:s.jsx(W.Body,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("span",{className:"fw-semibold",children:["Section ",S+1,": ",w.name]}),s.jsx(ke,{bg:"success",className:"ms-2",children:"Completed"})]}),w.score!==void 0&&s.jsxs("div",{className:"text-end",children:[s.jsxs("div",{className:"fw-bold",children:[w.score," / ",w.maxScore||100]}),s.jsxs("small",{className:"text-muted",children:[Math.round(w.score/(w.maxScore||100)*100),"%"]})]})]})})},w.id))]})]})})]})})})}),s.jsx(H,{lg:4,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(xt,{className:"me-2",size:20}),"Assessment Information"]})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Course"}),s.jsx("div",{className:"text-muted",children:i.course?.name||"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Subject"}),s.jsx("div",{className:"text-muted",children:i.subject?.name||"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Due Date"}),s.jsx("div",{className:"text-muted",children:i.dueDate?new Date(i.dueDate).toLocaleDateString():"N/A"})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Time Limit"}),s.jsxs("div",{className:"text-muted",children:[i.timeLimit," minutes"]})]})]}),i.score!==null&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Je,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Score"}),s.jsxs("div",{className:"text-muted",children:[i.score," / ",i.maxScore]})]})]}),i.completedDate&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Completed Date"}),s.jsx("div",{className:"text-muted",children:new Date(i.completedDate).toLocaleDateString()})]})]})]})]}),i.requiresSignature&&s.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Signature Required"}),s.jsx("p",{className:"small text-muted mb-2",children:"This assessment requires a digital signature upon completion."}),i.signatureStatus==="PENDING"&&s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:g,children:[s.jsx(Gi,{className:"me-2",size:14}),"Sign Now"]}),i.signatureStatus==="COMPLETED"&&s.jsx(ke,{bg:"success",children:"Signed"})]}),s.jsx("div",{className:"mt-4",children:s.jsxs(te,{variant:"outline-secondary",className:"w-100",onClick:b,children:[s.jsx(Jt,{className:"me-2",size:16}),"Report Issue / Feedback"]})})]})]})})]})]})},L1=({onSignatureChange:e,width:t=250,height:r=150})=>{const a=v.useRef(null),[n,i]=v.useState(!1),[o,l]=v.useState(!1),[c,d]=v.useState(null);v.useEffect(()=>{const x=a.current;if(!x)return;const g=x.getContext("2d"),b=window.devicePixelRatio||1;x.width=t*b,x.height=r*b,x.style.width=`${t}px`,x.style.height=`${r}px`,g.scale(b,b),g.strokeStyle="#000000",g.lineWidth=2,g.lineCap="round",g.lineJoin="round",g.fillStyle="#ffffff",g.fillRect(0,0,t,r)},[t,r]);const u=x=>{const g=a.current;if(!g)return null;const b=g.getBoundingClientRect();let j,y;x.touches&&x.touches.length>0?(j=x.touches[0].clientX,y=x.touches[0].clientY):(j=x.clientX,y=x.clientY);const w=j-b.left,S=y-b.top;return{x:w,y:S}},m=x=>{x.preventDefault();const g=u(x);if(!g)return;const j=a.current.getContext("2d");i(!0),d(g),j.beginPath(),j.moveTo(g.x,g.y)},f=x=>{if(!n)return;x.preventDefault();const g=u(x);if(!g)return;const b=a.current,j=b.getContext("2d");if(c&&(j.beginPath(),j.moveTo(c.x,c.y),j.lineTo(g.x,g.y),j.stroke()),d(g),l(!0),e){const y=b.toDataURL("image/png");e(y)}},h=x=>{x.preventDefault(),i(!1),d(null)},p=()=>{const x=a.current;if(!x)return;const g=x.getContext("2d"),b=window.devicePixelRatio||1;g.fillStyle="#ffffff",g.fillRect(0,0,x.width/b,x.height/b),l(!1),e&&e(null)};return s.jsxs("div",{className:"signature-pad-container",children:[s.jsx("div",{className:"border rounded p-2 bg-white",style:{display:"inline-block",touchAction:"none"},children:s.jsx("canvas",{ref:a,className:"signature-canvas",style:{cursor:"crosshair",display:"block",touchAction:"none",userSelect:"none"},onMouseDown:m,onMouseMove:f,onMouseUp:h,onMouseLeave:h,onTouchStart:m,onTouchMove:f,onTouchEnd:h,onTouchCancel:h})}),s.jsx("div",{className:"mt-2 d-flex justify-content-between align-items-center",children:s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:p,children:[s.jsx(M2,{className:"me-1",size:14}),"Clear"]})})]})},gle=()=>{const{traineeId:e,documentId:t}=ur(),r=tt(),[a,n]=v.useState(null),[i,o]=v.useState(!1),l=u=>{n(u)},c=async()=>{if(!a){J.error("Please provide your signature");return}try{o(!0),console.log("Signature saved:",{documentId:t,traineeId:e,signature:a,timestamp:new Date().toISOString()}),J.success("Signature saved successfully"),r(je.ASSESSMENTS_DETAIL(t),{replace:!0})}catch(u){console.error("Error saving signature:",u),J.error("Failed to save signature")}finally{o(!1)}},d=()=>{r(`/trainee/${e}/assessment/${t}`,{replace:!0})};return s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx("div",{className:"mb-4",children:s.jsxs(te,{variant:"outline-secondary",onClick:d,className:"mb-3",children:[s.jsx(At,{size:16,className:"me-2"}),"Back"]})}),s.jsxs(W,{children:[s.jsx(W.Header,{className:"bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0",children:"Digital Signature"})}),s.jsxs(W.Body,{className:"p-4",children:[s.jsx(De,{variant:"info",className:"mb-4",children:s.jsx("p",{className:"mb-0",children:"Please sign in the box below using your mouse or touch device"})}),s.jsx("div",{className:"mb-4",children:s.jsx(L1,{onSignatureChange:l,width:250,height:150})}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsxs(te,{variant:"outline-secondary",onClick:d,disabled:i,children:[s.jsx(st,{className:"me-2",size:16}),"Cancel"]}),s.jsx(te,{variant:"primary",onClick:c,disabled:i||!a,children:i?"Saving...":"Save Signature"})]})]})]})]})},vle=({traineeId:e,sectionId:t})=>{const r=tt(),[a,n]=v.useState(null),[i,o]=v.useState(!0),[l,c]=v.useState("");v.useEffect(()=>{t&&d()},[t]);const d=async()=>{try{o(!0),c(""),n({id:t,name:"Emergency Evacuation Procedures",description:"Complete the emergency evacuation procedures assessment including both theoretical knowledge and practical demonstration.",course:"Emergency Procedures",subject:"Safety Protocols",type:"Practical Assessment",status:"IN_PROGRESS",progress:60,dueDate:"2024-02-12T14:00:00.000Z",timeLimit:120,questions:[{id:"1",type:"multiple_choice",question:"What is the first step in an emergency evacuation?",options:["Sound the alarm","Assess the situation","Call emergency services","Evacuate immediately"],correctAnswer:1,userAnswer:1,isAnswered:!0},{id:"2",type:"multiple_choice",question:"How many emergency exits should be available in a training facility?",options:["At least 1","At least 2","At least 3","At least 4"],correctAnswer:1,userAnswer:null,isAnswered:!1},{id:"3",type:"practical",question:"Demonstrate the proper use of emergency equipment",description:"Show how to properly use fire extinguisher and emergency lighting",isCompleted:!1,score:null}],instructions:["Read each question carefully before answering","For practical assessments, ensure you have the required equipment","You have 120 minutes to complete this assessment","Save your progress regularly","Contact your instructor if you encounter any technical issues"]})}catch(p){console.error("Error loading section details:",p),c("Failed to load assessment section details"),J.error("Failed to load assessment section details")}finally{o(!1)}},u=()=>{r(je.ASSESSMENTS_MY_ASSESSMENTS)},m=p=>{const g={PENDING:{variant:"warning",text:"Pending",icon:Ke},IN_PROGRESS:{variant:"info",text:"In Progress",icon:rr},COMPLETED:{variant:"success",text:"Completed",icon:Je},OVERDUE:{variant:"danger",text:"Overdue",icon:Jt}}[p]||{variant:"secondary",text:p,icon:rr},b=g.icon;return s.jsxs(ke,{bg:g.variant,className:"d-flex align-items-center",children:[s.jsx(b,{size:12,className:"me-1"}),g.text]})},f=()=>{J.info("Starting assessment section...")},h=()=>{J.info("Continuing assessment section...")};return i?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment section..."})]})}):l||!a?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:l||"Assessment section not found"}),s.jsxs(te,{variant:"outline-danger",onClick:u,children:[s.jsx(At,{className:"me-2",size:16}),"Back to Assessments"]})]})}):s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(te,{variant:"outline-secondary",onClick:u,className:"me-3",children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[s.jsx(rr,{className:"me-2",size:28}),a.name]}),s.jsxs("p",{className:"text-muted mb-0",children:[a.course,"  ",a.subject]})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[m(a.status),s.jsx(ke,{bg:"info",className:"fw-normal",children:a.type})]})]})})}),s.jsxs(de,{children:[s.jsx(H,{lg:8,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(rr,{className:"me-2",size:20}),"Assessment Section Details"]})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Description"}),s.jsx("p",{className:"text-muted",children:a.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Instructions"}),s.jsx("ul",{className:"list-unstyled",children:a.instructions.map((p,x)=>s.jsxs("li",{className:"mb-2",children:[s.jsx("span",{className:"text-primary me-2",children:""}),p]},x))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{children:"Questions Overview"}),s.jsx("div",{className:"row",children:a.questions.map((p,x)=>s.jsx("div",{className:"col-md-6 mb-3",children:s.jsxs("div",{className:`p-3 border rounded ${p.isAnswered||p.isCompleted?"bg-light":""}`,children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("span",{className:"fw-semibold",children:["Question ",x+1]}),p.isAnswered||p.isCompleted?s.jsx(ke,{bg:"success",className:"small",children:"Completed"}):s.jsx(ke,{bg:"warning",className:"small",children:"Pending"})]}),s.jsx("p",{className:"mb-0 small text-muted",children:p.type==="practical"?"Practical Assessment":"Multiple Choice"})]})},p.id))})]}),s.jsx("div",{className:"d-flex justify-content-center",children:a.status==="PENDING"?s.jsxs(te,{variant:"primary",size:"lg",onClick:f,children:[s.jsx(zx,{className:"me-2",size:20}),"Start Assessment"]}):s.jsxs(te,{variant:"primary",size:"lg",onClick:h,children:[s.jsx(rr,{className:"me-2",size:20}),"Continue Assessment"]})})]})]})}),s.jsx(H,{lg:4,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-white border-bottom",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Ke,{className:"me-2",size:20}),"Assessment Information"]})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Time Limit"}),s.jsxs("div",{className:"text-muted",children:[a.timeLimit," minutes"]})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Due Date"}),s.jsx("div",{className:"text-muted",children:new Date(a.dueDate).toLocaleDateString()})]})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(rr,{className:"text-muted me-3",size:18}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:"Total Questions"}),s.jsx("div",{className:"text-muted",children:a.questions.length})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("span",{className:"fw-semibold",children:"Progress"}),s.jsxs("span",{className:"text-muted",children:[a.progress,"%"]})]}),s.jsx(Xh,{now:a.progress,variant:"primary",className:"mb-3"}),s.jsx("div",{className:"text-center",children:s.jsxs("small",{className:"text-muted",children:[a.questions.filter(p=>p.isAnswered||p.isCompleted).length," of ",a.questions.length," questions completed"]})})]}),s.jsxs("div",{className:"mt-4 p-3 bg-light rounded",children:[s.jsx("h6",{className:"mb-2",children:"Assessment Tips:"}),s.jsxs("ul",{className:"mb-0 small text-muted",children:[s.jsx("li",{children:"Read questions carefully"}),s.jsx("li",{children:"Manage your time wisely"}),s.jsx("li",{children:"Save progress regularly"}),s.jsx("li",{children:"Review answers before submitting"})]})]})]})]})})]})]})},yle=()=>{const{traineeId:e,sectionId:t}=ur();return s.jsx(Ce,{className:"py-3",children:s.jsx(vle,{traineeId:e,sectionId:t})})},ble=`
  .training-progress-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .training-progress-card .card-header h5 {
    color: #ffffff !important;
  }
  .assessments-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .assessments-card .card-header h5 {
    color: #ffffff !important;
  }
  .quick-actions-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .quick-actions-card .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=ble,document.head.appendChild(e)}const j2=()=>{const e=tt(),t=[{title:"Academic Details",description:"Track your learning progress and achievements",icon:Pt,path:je.TRAINEE_ACADEMIC_DETAILS,color:"primary"},{title:"Your Courses",description:"Check your enrolled courses and progress",icon:Dt,path:je.COURSES_ENROLLED,color:"success"},{title:"All Assessments",description:"View pending assessments and tasks",icon:rr,path:je.ASSESSMENTS_MY_ASSESSMENTS,color:"warning"},{title:"Create Issue Report",description:"Report issues or provide feedback",icon:Jt,path:je.REPORTS_CREATE,color:"danger"}];return s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(W,{className:"border-0 shadow-sm quick-actions-card",children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Quick Actions"})}),s.jsx(W.Body,{children:s.jsx(de,{children:t.map((r,a)=>{const n=r.icon;return s.jsx(H,{lg:6,xl:3,className:"mb-3",children:s.jsx(W,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(W.Body,{className:"p-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:`bg-${r.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:s.jsx(n,{size:24})}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("h5",{className:"mb-1",children:r.title})}),s.jsx(un,{size:20,className:"text-muted"})]}),s.jsx("p",{className:"text-muted mb-0",children:r.description})]})})},a)})})})]})})}),s.jsxs(de,{className:"mt-4",children:[s.jsx(H,{lg:6,className:"d-flex",children:s.jsxs(W,{className:"border-0 shadow-sm w-100 training-progress-card",children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Training Progress"})}),s.jsx(W.Body,{className:"d-flex flex-column justify-content-center",children:s.jsxs("div",{className:"text-center py-4",children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"display-4 text-primary fw-bold",children:"0%"}),s.jsx("p",{className:"text-muted mb-0",children:"Overall Progress"})]}),s.jsx("div",{className:"progress mb-3",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar bg-primary",style:{width:"0%"}})}),s.jsx("p",{className:"text-muted small mb-0",children:"Complete your enrolled courses to see progress."})]})})]})}),s.jsx(H,{lg:6,className:"d-flex",children:s.jsxs(W,{className:"border-0 shadow-sm w-100 assessments-card",children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Assessments Required Confirmations"})}),s.jsx(W.Body,{className:"d-flex flex-column justify-content-center",children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(rr,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No assessments pending"}),s.jsx("p",{className:"text-muted small mb-3",children:"View and complete signature required assessments."}),s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:()=>e(je.ASSESSMENTS_SIGNATURE_REQUIRED),className:"d-flex align-items-center justify-content-center mx-auto",children:[s.jsx(rr,{size:16,className:"me-2"}),"Go to Assessments",s.jsx(un,{size:16,className:"ms-2"})]})]})})]})})]})]})},jle=()=>{const e=tt(),{user:t}=zr(),[r,a]=v.useState(!0),[n,i]=v.useState(null);v.useEffect(()=>{o()},[]);const o=async()=>{try{a(!0);const d={totalCourses:8,completedCourses:3,inProgressCourses:2,pendingCourses:3,totalAssessments:15,completedAssessments:8,pendingAssessments:7,overallProgress:65,courses:[{id:1,name:"Safety Procedures Training",code:"SAF001",progress:100,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations",code:"FLT002",progress:75,status:"in-progress",startDate:"2024-01-20"},{id:3,name:"Emergency Response",code:"EMG003",progress:45,status:"in-progress",startDate:"2024-02-01"},{id:4,name:"Technical Systems",code:"TECH004",progress:0,status:"pending",startDate:"2024-02-15"}],recentAssessments:[{id:1,name:"Safety Training Assessment",course:"Safety Procedures Training",score:95,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations Quiz",course:"Flight Operations",score:88,status:"completed",completedDate:"2024-01-25"},{id:3,name:"Emergency Response Test",course:"Emergency Response",score:null,status:"pending",dueDate:"2024-02-10"}]};await new Promise(u=>setTimeout(u,500)),i(d)}catch(d){console.error("Error loading academic data:",d)}finally{a(!1)}},l=d=>{switch(d){case"completed":return"success";case"in-progress":return"warning";case"pending":return"secondary";default:return"secondary"}},c=d=>{switch(d){case"completed":return s.jsx(Je,{className:"text-success"});case"in-progress":return s.jsx(Ke,{className:"text-warning"});case"pending":return s.jsx(Ke,{className:"text-muted"});default:return s.jsx(Ke,{className:"text-muted"})}};return r?s.jsx(Ce,{className:"py-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading academic details..."})]})}):n?s.jsxs(Ce,{className:"py-4 academic-details",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(te,{variant:"outline-secondary",size:"sm",className:"me-3",onClick:()=>e(-1),children:s.jsx(At,{size:16})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Academic Details"}),s.jsx("p",{className:"text-muted mb-0",children:"Track your learning progress and achievements"})]})]})})}),s.jsxs(de,{className:"mb-4",children:[s.jsx(H,{lg:3,md:6,className:"mb-3",children:s.jsx(W,{className:"border-0 shadow-sm h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(Dt,{size:32,className:"text-primary mb-2"}),s.jsx("h4",{className:"mb-1",children:n.totalCourses}),s.jsx("p",{className:"text-muted mb-0",children:"Total Courses"})]})})}),s.jsx(H,{lg:3,md:6,className:"mb-3",children:s.jsx(W,{className:"border-0 shadow-sm h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(oS,{size:32,className:"text-success mb-2"}),s.jsx("h4",{className:"mb-1",children:n.completedCourses}),s.jsx("p",{className:"text-muted mb-0",children:"Completed"})]})})}),s.jsx(H,{lg:3,md:6,className:"mb-3",children:s.jsx(W,{className:"border-0 shadow-sm h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(Ke,{size:32,className:"text-warning mb-2"}),s.jsx("h4",{className:"mb-1",children:n.inProgressCourses}),s.jsx("p",{className:"text-muted mb-0",children:"In Progress"})]})})}),s.jsx(H,{lg:3,md:6,className:"mb-3",children:s.jsx(W,{className:"border-0 shadow-sm h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(rr,{size:32,className:"text-info mb-2"}),s.jsx("h4",{className:"mb-1",children:n.completedAssessments}),s.jsx("p",{className:"text-muted mb-0",children:"Assessments Done"})]})})})]}),s.jsx(de,{className:"mb-5",children:s.jsx(H,{children:s.jsxs(W,{className:"border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsx("h5",{className:"mb-0",children:"Overall Learning Progress"})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"text-center mb-3",children:[s.jsxs("h2",{className:"text-primary mb-1",children:[n.overallProgress,"%"]}),s.jsx("p",{className:"text-muted mb-0",children:"Complete your courses to improve progress"})]}),s.jsx(Xh,{now:n.overallProgress,variant:"primary",style:{height:"12px"},className:"mb-3"}),s.jsx(de,{className:"text-center",children:s.jsx(H,{children:s.jsxs("small",{className:"text-muted",children:[n.completedCourses," of ",n.totalCourses," courses completed"]})})})]})]})})}),s.jsxs(de,{className:"mt-4",children:[s.jsx(H,{lg:8,className:"mb-4 pe-3",children:s.jsxs(W,{className:"border-0 shadow-sm h-100",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(Dt,{className:"me-2"}),"Course Progress"]})}),s.jsx(W.Body,{children:n.courses.map(d=>s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:d.name}),s.jsx("small",{className:"text-muted",children:d.code})]}),s.jsx("div",{className:"d-flex align-items-center",children:s.jsx(ke,{variant:l(d.status),children:d.status.replace("-"," ")})})]}),s.jsx(Xh,{now:d.progress,variant:d.progress===100?"success":"primary",style:{height:"8px"}}),s.jsxs("div",{className:"d-flex justify-content-between mt-1",children:[s.jsxs("small",{className:"text-muted",children:[d.progress,"% complete"]}),d.status==="completed"&&s.jsxs("small",{className:"text-success",children:["Completed: ",new Date(d.completedDate).toLocaleDateString()]})]})]},d.id))})]})}),s.jsx(H,{lg:4,className:"mb-4 ps-3",children:s.jsxs(W,{className:"border-0 shadow-sm h-100",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(rr,{className:"me-2"}),"Recent Assessments"]})}),s.jsx(W.Body,{children:n.recentAssessments.map(d=>s.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[s.jsx("h6",{className:"mb-1",children:d.name}),c(d.status)]}),s.jsx("small",{className:"text-muted d-block mb-1",children:d.course}),d.status==="completed"?s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsxs(ke,{variant:"success",children:["Score: ",d.score]}),s.jsx("small",{className:"text-muted",children:new Date(d.completedDate).toLocaleDateString()})]}):s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsx(ke,{variant:"warning",children:"Pending"}),s.jsxs("small",{className:"text-muted",children:["Due: ",new Date(d.dueDate).toLocaleDateString()]})]})]},d.id))})]})})]})]}):s.jsx(Ce,{className:"py-4",children:s.jsx(De,{variant:"danger",children:"Failed to load academic details. Please try again later."})})},wle=()=>{const{user:e}=zr();return e?s.jsx(Ce,{className:"py-3",children:s.jsx(jle,{})}):s.jsx(Ce,{className:"py-3",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{children:"Please log in to view your academic details."})})})},w2=({uniqueLevels:e,uniqueStatuses:t,selectedLevels:r,selectedStatuses:a,onLevelToggle:n,onStatusToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||a.length>0;return s.jsxs(St,{className:`filter-panel-dropdown course-filter-dropdown ${l}`,children:[s.jsx(St.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(oo,{size:14,className:"me-2"}),"Filters",c&&s.jsx("span",{className:"badge bg-primary ms-2",children:r.length+a.length})]})}),s.jsxs(St.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Levels"}),r.length>0&&s.jsx(te,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:s.jsx(st,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>s.jsx(k.Check,{type:"checkbox",id:`level-${d}`,label:d,checked:r.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Statuses"}),a.length>0&&s.jsx(te,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:s.jsx(st,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>s.jsx(k.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:a.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(te,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[s.jsx(st,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},I5=document.createElement("style");I5.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(I5);const Nle=`
  .course-list-table-no-borders .table,
  .course-list-table-no-borders .table td,
  .course-list-table-no-borders .table th,
  .course-list-table-no-borders .table tbody tr,
  .course-list-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .course-list-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .course-list-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
  .course-list-table-no-borders .table th {
    background-color: var(--bs-primary) !important;
    color: white !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Nle,document.head.appendChild(e)}const Sle=({traineeId:e})=>{const t=tt(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(""),[c,d]=v.useState([]),[u,m]=v.useState([]),[f,h]=v.useState("upcoming"),p=[...new Set(r.map(M=>M.level).filter(Boolean))],x=[...new Set(r.map(M=>M.status).filter(Boolean))],g=M=>r.filter(U=>{switch(M){case"upcoming":return U.status==="PLANNED"||U.status==="PLAN";case"ongoing":return U.status==="ON-GOING"||U.status==="ONGOING"||U.status==="ON_GOING";case"completed":return U.status==="COMPLETED"||U.status==="COMPLETE";default:return!0}}),b=g(f),j=v.useMemo(()=>b.filter(M=>{const U=!o||M.name.toLowerCase().includes(o.toLowerCase())||M.code.toLowerCase().includes(o.toLowerCase())||M.description.toLowerCase().includes(o.toLowerCase()),Z=c.length===0||c.includes(M.level),ee=u.length===0||u.includes(M.status);return U&&Z&&ee}),[b,o,c,u]),{sortedData:y,sortConfig:w,handleSort:S}=_r(j);v.useEffect(()=>{e&&N()},[e]);const N=async()=>{try{i(!0);const U=(await Jr.getTraineeCourseSubjects(e))?.courses||[];if(!Array.isArray(U)||U.length===0){a([]),i(!1);return}const Z=U.map(ee=>{const re=ee.course,z=ee.subjects||[];if(!re||!re.id)return null;const me=z.length,ne=z.filter(ae=>ae.status==="COMPLETED"||ae.status==="COMPLETE").length,A=me>0?Math.round(ne/me*100):0;let D=re.status||"PLANNED";const I=z.some(ae=>ae.status==="ON-GOING"||ae.status==="ONGOING"||ae.status==="ON_GOING");z.every(ae=>ae.status==="COMPLETED"||ae.status==="COMPLETE")&&me>0?D="COMPLETED":I&&(D="ON-GOING");let ie=null,se=null;return z.forEach(ae=>{if(ae.startDate){const K=new Date(ae.startDate);(!ie||K<new Date(ie))&&(ie=ae.startDate)}if(ae.endDate){const K=new Date(ae.endDate);(!se||K>new Date(se))&&(se=ae.endDate)}}),{id:re.id,code:re.code||`COURSE-${re.id.substring(0,8).toUpperCase()}`,name:re.name||"Unnamed Course",description:re.description||"",level:re.level||"BEGINNER",status:D,startDate:ie,endDate:se,progress:A,department:null}}).filter(ee=>ee!==null);a(Z)}catch(M){console.error("Error loading trainee courses:",M),J.error(M.response?.data?.message||"Failed to load enrolled courses"),a([])}finally{i(!1)}},E=M=>{const Z={"ON-GOING":{variant:"success",text:"On-going"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[M]||{variant:"secondary",text:M};return s.jsx(ke,{bg:Z.variant,children:Z.text})},P=M=>{const Z={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[M]||{variant:"secondary",text:M};return s.jsx(ke,{bg:Z.variant,children:Z.text})},T=M=>{t(`/trainee/${e}/course/${M.id}`)},O=M=>{d(M==="clear"?[]:U=>U.includes(M)?U.filter(Z=>Z!==M):[...U,M])},_=M=>{m(M==="clear"?[]:U=>U.includes(M)?U.filter(Z=>Z!==M):[...U,M])},C=()=>{d([]),m([]),l("")},R=({columnKey:M,children:U,className:Z=""})=>{const ee=w.key===M,re=ee?w.direction:null;return s.jsxs("th",{className:`fw-semibold ${Z}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(M),onMouseEnter:z=>{z.target.style.backgroundColor="#214760",z.target.style.transform="translateY(-1px)",z.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:z=>{z.target.style.backgroundColor="var(--bs-primary)",z.target.style.transform="translateY(0)",z.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:ee?"600":"500",color:"white"},children:U}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:re,size:14,color:"white"})})]}),ee&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return n?s.jsx(nr,{rows:5,columns:8}):r.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No enrolled courses"}),s.jsx("p",{children:"You are not enrolled in any courses yet."})]})}):j.length===0&&(o||c.length>0||u.length>0)?s.jsx("div",{children:s.jsx(W,{className:"border-0 shadow-sm mb-2",children:s.jsxs($t.Container,{activeKey:f,onSelect:h,children:[s.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Xe,{variant:"tabs",className:"border-0",children:[s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"upcoming",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="upcoming"?"600":"400",opacity:f==="upcoming"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Ke,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"ongoing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="ongoing"?"600":"400",opacity:f==="ongoing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(ap,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="completed"?"600":"400",opacity:f==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Je,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]})}),s.jsx(W.Body,{className:"p-0",children:s.jsx($t.Content,{children:s.jsxs($t.Pane,{eventKey:f,children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(w2,{uniqueLevels:p,uniqueStatuses:x,selectedLevels:c,selectedStatuses:u,onLevelToggle:O,onStatusToggle:_,onClearFilters:C,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[j.length," course",j.length!==1?"s":""]})})})]}),s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No courses found"}),s.jsx("p",{children:"Try adjusting your search criteria or filters."}),s.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:C,children:"Clear Filters"})]})})]})})})]})})}):s.jsx("div",{children:s.jsx(W,{className:"border-0 shadow-sm mb-2",children:s.jsxs($t.Container,{activeKey:f,onSelect:h,children:[s.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Xe,{variant:"tabs",className:"border-0",children:[s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"upcoming",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="upcoming"?"600":"400",opacity:f==="upcoming"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Ke,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"ongoing",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="ongoing"?"600":"400",opacity:f==="ongoing"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(ap,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"completed",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:f==="completed"?"600":"400",opacity:f==="completed"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Je,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]})}),s.jsx(W.Body,{className:"p-0",children:s.jsx($t.Content,{children:s.jsxs($t.Pane,{eventKey:f,children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(w2,{uniqueLevels:p,uniqueStatuses:x,selectedLevels:c,selectedStatuses:u,onLevelToggle:O,onStatusToggle:_,onClearFilters:C,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[j.length," course",j.length!==1?"s":""]})})})]}),s.jsx("div",{className:"scrollable-table-container admin-table course-list-table-no-borders",style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(R,{columnKey:"code",className:"show-mobile",children:"Course Code"}),s.jsx(R,{columnKey:"name",className:"show-mobile",children:"Course Name"}),s.jsx(R,{columnKey:"level",className:"show-mobile",children:"Level"}),s.jsx(R,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(R,{columnKey:"startDate",className:"hide-mobile",children:"Start Date"}),s.jsx(R,{columnKey:"endDate",className:"hide-mobile",children:"End Date"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:y.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"8",className:"text-center py-5",style:{border:"none"},children:s.jsxs("div",{className:"text-muted",children:[s.jsx(Dt,{size:48,className:"mb-3",style:{opacity:.5}}),s.jsx("h5",{className:"mb-2",children:"No courses found"}),s.jsx("p",{className:"mb-0",children:o||c.length>0||u.length>0?"Try adjusting your search criteria or filters.":f==="upcoming"?"You have no upcoming courses.":f==="ongoing"?"You have no on-going courses.":"You have no completed courses."}),(o||c.length>0||u.length>0)&&s.jsx("button",{className:"btn btn-outline-primary btn-sm mt-3",onClick:C,children:"Clear Filters"})]})})}):y.map((M,U)=>s.jsxs("tr",{className:`${U%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:Z=>{Z.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:Z=>{Z.currentTarget.style.backgroundColor=U%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx(ke,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:M.code})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:s.jsx("div",{className:"fw-medium text-dark",children:M.name})}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:P(M.level)}),s.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:E(M.status)}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:M.startDate?new Date(M.startDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-dark",children:M.endDate?new Date(M.endDate).toLocaleDateString():"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Course Details",icon:s.jsx(Bt,{}),onClick:()=>T(M)}]})})]},M.id))})]})})]})})})]})})})},Ele=()=>{const{user:e}=zr();return e?s.jsxs(Ce,{className:"py-3",children:[s.jsx("div",{className:"mb-4",children:s.jsx("h3",{className:"text-primary fw-bold",children:"Enrolled Courses"})}),s.jsx(Sle,{traineeId:e.id})]}):s.jsx(Ce,{className:"py-3",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{children:"Please log in to view your enrolled courses."})})})},Tle=()=>{const{hasPermission:e}=Fn(),t=v.useMemo(()=>e(Te.VIEW_ALL_TEMPLATE),[e]),r=v.useMemo(()=>e(Te.APPROVE_DENY_TEMPLATE),[e]),a=v.useMemo(()=>t&&r,[t,r]),n=v.useMemo(()=>t&&!r,[t,r]);return{isSQAMode:a,isAdminMode:n,hasViewAll:t,hasApproveReject:r}};function Cle(e){const t=String(e||"").toUpperCase();return t==="SIGNATURE_IMAGE"?"SIGNATURE_IMG":(["TEXT","IMAGE","TOGGLE","PART","SECTION_CONTROL_TOGGLE","SIGNATURE_DRAW","SIGNATURE_IMG","FINAL_SCORE_TEXT","FINAL_SCORE_NUM","VALUE_LIST"].includes(t),e)}function Qn(){try{const r=localStorage.getItem("templateInfo");if(r){const a=JSON.parse(r);return{id:a.id||null,currentTemplateId:a.currentTemplateId||null,originalTemplateId:a.originalTemplateId||null,name:a.name||"",description:a.description||"",departmentId:a.departmentId||"",templateContent:a.templateContent||"",templateConfig:a.templateConfig||null,templateContentMediaId:a.templateContentMediaId||null,editorDocumentUrl:a.editorDocumentUrl||""}}}catch{}const e=localStorage.getItem("currentTemplateId"),t=localStorage.getItem("originalTemplateId");return{id:null,currentTemplateId:e||null,originalTemplateId:t||null,name:localStorage.getItem("templateName")||"",description:localStorage.getItem("templateDesc")||"",departmentId:localStorage.getItem("departmentId")||"",templateContent:localStorage.getItem("templateContent")||"",templateConfig:null,templateContentMediaId:null,editorDocumentUrl:""}}function N2(e,t,r=null){const a={};if(r&&Array.isArray(r)){console.log(` Existing fields count: ${r.length}`),r.forEach(o=>{if(o.fieldType==="PART"&&o.id&&o.fieldName){const l=`${o.fieldName}-parent`;a[l]=o.id,console.log(` Mapped PART field: tempId="${l}"  id="${o.id}"`)}});const i=r.filter(o=>o.parentId);console.log(" Child fields with parentId:",i.map(o=>({fieldName:o.fieldName,fieldType:o.fieldType,parentId:o.parentId,id:o.id})))}const n=(t||[]).map((i,o)=>{const l=i.fields||[],c={};for(const p of l)if(String(p.fieldType||"").toUpperCase()==="PART"){const x=p.fieldName||p.name||"",g=p.tempId||(x?`${x}-parent`:void 0);g&&(c[x]=g)}const u=l.map(p=>{const x=p.parentTempId;return x&&c[x]?{...p,parentTempId:c[x]}:p}).map((p,x)=>({...p,__idx:x})),m=u.filter(p=>!p.parentTempId).sort((p,x)=>p.__idx-x.__idx),f=[];for(const p of m){f.push(p);const x=String(p.fieldType||"").toUpperCase()==="PART"?p.tempId||c[p.fieldName||p.name||""]||(p.fieldName||p.name?`${p.fieldName||p.name}-parent`:void 0):null;if(x){const g=u.filter(b=>b.parentTempId===x).sort((b,j)=>b.__idx-j.__idx);f.push(...g)}}if(f.length!==u.length){const p=new Set(f.map(x=>x.__idx));u.filter(x=>!p.has(x.__idx)).sort((x,g)=>x.__idx-g.__idx).forEach(x=>f.push(x))}const h=f.map((p,x)=>{const g=String(p.fieldType||"").toUpperCase().startsWith("SIGNATURE"),b=String(p.fieldType||"").toUpperCase(),j=Cle(p.fieldType),y=p.fieldName||p.name||"";y||console.warn(" Field missing fieldName/name:",p);const w={label:p.label,fieldName:y,fieldType:j,displayOrder:x+1};if(r)if(w.parentTempId=p.parentTempId?p.parentTempId:null,p.parentTempId&&a[p.parentTempId]){let S=r.find(N=>N.fieldName===y&&N.fieldType===j&&N.id);S&&S.id?(w.id=S.id,console.log(` Added id="${w.id}" for child field "${y}" (parentTempId="${p.parentTempId}") (for update)`)):console.warn(` Could not find existing child field: fieldName="${y}", fieldType="${j}"`)}else{const S=r.find(N=>N.fieldName===y&&N.fieldType===j&&!N.parentId&&N.id);S&&S.id&&(w.id=S.id,console.log(` Added id="${w.id}" for top-level field "${y}" (for update)`))}else w.parentTempId=p.parentTempId?p.parentTempId:null;if(g&&(w.roleRequired=p.roleRequired||"TRAINER"),b==="PART"){const S=y||"";if(w.tempId=p.tempId||(S?`${S}-parent`:void 0),r){const N=r.find(E=>E.fieldType==="PART"&&(E.fieldName===y||E.fieldName===p.name)&&E.id);N&&N.id&&(w.id=N.id,console.log(` Added id="${w.id}" for PART field "${y}" (for update)`))}}if(b==="VALUE_LIST")if(console.log(" VALUE_LIST field found:",{fieldName:y,label:p.label,hasOption:!!p.option,option:p.option,optionType:typeof p.option}),p.option)try{const S=JSON.parse(p.option);S.items&&Array.isArray(S.items)?(w.options={items:S.items},console.log(" VALUE_LIST options parsed successfully:",w.options)):console.warn(" VALUE_LIST option missing items array:",S)}catch(S){console.warn(" Failed to parse VALUE_LIST option:",S,"Raw option:",p.option)}else console.warn(" VALUE_LIST field missing option field:",{fieldName:y,label:p.label,field:p});return w});return{label:i.label,displayOrder:o+1,editBy:i.editBy||"TRAINER",roleInSubject:i.roleInSubject?i.roleInSubject:null,isSubmittable:!!i.isSubmittable,isToggleDependent:!!i.isToggleDependent,fields:h}});return{name:e.name,description:e.description,departmentId:e.departmentId,templateContent:e.templateContent,templateConfig:e.templateConfig||null,sections:n}}function M1(e){return Array.isArray(e)?e.map(t=>{const r=(t.fields||[]).filter(i=>i.fieldType==="PART"),a={};r.forEach(i=>{const o=`${i.fieldName}-parent`;a[i.id]=o});const n=(t.fields||[]).map(i=>{let o=i.fieldType||"TEXT";o==="SIGNATURE_IMG"&&(o="SIGNATURE_IMAGE");const l={label:i.label||"",fieldName:i.fieldName||"",fieldType:o,roleRequired:i.roleRequired||null,parentTempId:null,option:null};if(i.parentId){const c=t.fields.find(d=>d.id===i.parentId);c&&c.fieldType==="PART"&&(l.parentTempId=`${c.fieldName}-parent`)}if(i.fieldType==="PART"&&(l.tempId=`${i.fieldName}-parent`),i.fieldType==="VALUE_LIST"&&i.options)try{l.option=JSON.stringify(i.options)}catch(c){console.warn("Failed to stringify VALUE_LIST options:",c)}return l});return{name:t.label||t.name||"",label:t.label||t.name||"",displayOrder:t.displayOrder||1,editBy:t.editBy||"TRAINER",roleInSubject:t.roleInSubject||"",isSubmittable:!!t.isSubmittable,isToggleDependent:!!t.isToggleDependent,fields:n}}):[]}function Ale(e){let t=[],r=[];if(e?.sections&&Array.isArray(e.sections)?r=e.sections:e?.fields&&Array.isArray(e.fields)?t=e.fields:Array.isArray(e)?t=e:e?.data?.fields&&Array.isArray(e.data.fields)?t=e.data.fields:e?.data?.sections&&Array.isArray(e.data.sections)&&(r=e.data.sections),r.length>0)return M1(r);if(t.length>0){const a=t.map(d=>{let u=d.fieldType||"TEXT";u==="SIGNATURE_IMG"&&(u="SIGNATURE_IMAGE");const m={label:d.label||d.fieldName||"",fieldName:d.fieldName||d.name||"",fieldType:u,roleRequired:d.roleRequired||null,parentTempId:d.parentTempId||null,tempId:d.tempId||null,option:null};if(u==="PART"&&(m.tempId=d.tempId||(m.fieldName?`${m.fieldName}-parent`:null)),u==="VALUE_LIST"&&d.options)try{m.option=JSON.stringify(d.options)}catch(f){console.warn("Failed to stringify VALUE_LIST options:",f)}return m}),n=a.filter(d=>d.fieldType==="PART"),i=a.filter(d=>d.parentTempId),o=a.filter(d=>!d.parentTempId&&d.fieldType!=="PART"),l=[];return n.forEach(d=>{l.push(d);const u=i.filter(m=>m.parentTempId===d.tempId);l.push(...u)}),l.push(...o),[{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:l.length>0?l:a}]}return[]}const _le=({show:e,onHide:t,onImportSuccess:r,onImportError:a})=>{const n=tt(),[i,o]=v.useState("with-fields"),[l,c]=v.useState(null),[d,u]=v.useState(!1),[m,f]=v.useState({name:"",description:"",departmentId:""}),[h,p]=v.useState([]),[x,g]=v.useState(!1),b=v.useRef(null);v.useEffect(()=>{e&&j()},[e]);const j=async()=>{try{g(!0);const N=await Vt.getPublicDepartments();p(N)}catch(N){console.error("Error loading departments:",N),J.error("Failed to load departments"),p([])}finally{g(!1)}},y=N=>{const E=N.target.files[0];if(E){const P=[".docx"],T=E.name.toLowerCase().substring(E.name.lastIndexOf("."));if(!P.includes(T)){J.error("Please select a valid Word document file (.docx)");return}if(E.size>10*1024*1024){J.error("File size must be less than 10MB");return}c(E)}},w=async()=>{if(!l){J.error("Please select a file to import");return}u(!0);try{const N=mn.getDocsType(l.name),E=await mn.uploadDocument(l,N);let P;if(E.data&&E.data.length>0&&E.data[0].url)P=E.data[0].url,console.log(` Form Template Upload Success! Document URL: ${P}`);else throw new Error("Invalid response format from upload API");if(i==="with-fields"){console.log(" Extracting fields from file (File with Fields flow)...");try{const T=await tr.extractFields(P);console.log(" Extract fields response:",T);const O=Ale(T);console.log(" Converted to frontend sections:",O);const _={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:"",fileName:l.name.replace(".docx",""),importType:"File with fields",createdAt:new Date().toISOString(),editorDocumentUrl:P};localStorage.setItem("templateInfo",JSON.stringify(_)),console.log(" Template info saved to localStorage:",_),n(je.TEMPLATES_EDITOR,{state:{documentUrl:P,fileName:_.fileName,importType:"File with fields",templateInfo:_,initialSections:O}}),S(),r("File with fields",l.name)}catch(T){console.error(" Failed to extract fields:",T);const O=T?.response?.data?.message||T?.message||"Failed to extract fields from file. You can still add fields manually.";J.warning(O);const _={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:"",fileName:l.name.replace(".docx",""),importType:"File with fields",createdAt:new Date().toISOString(),editorDocumentUrl:P};localStorage.setItem("templateInfo",JSON.stringify(_)),console.log(" Template info saved to localStorage (without extracted fields):",_),n("/templates/editor",{state:{documentUrl:P,fileName:_.fileName,importType:"File with fields",templateInfo:_,initialSections:[]}}),S(),r("File with fields",l.name)}}else{console.log(" Checking if file contains fields (File without Fields flow)...");try{const T=await tr.extractFields(P);if(T?.fields&&Array.isArray(T.fields)&&T.fields.length>0||T?.totalFields&&T.totalFields>0){J.error('Your template already have field. Please use "File with Fields" import type instead.'),u(!1);return}console.log(" File does not contain fields, proceeding with import...");const _={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:P,fileName:l.name.replace(".docx",""),importType:"File without fields",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(_)),console.log(" Template info saved to localStorage:",_),n("/templates/editor",{state:{documentUrl:P,fileName:_.fileName,importType:"File without fields",templateInfo:_}}),S(),r("File without fields",l.name)}catch(T){console.error(" Failed to extract fields:",T);const O=T?.response?.data?.message||T?.message||"Failed to validate file. Please try again.";J.error(O),u(!1);return}}}catch(N){a(N.message||"Import failed")}finally{u(!1)}},S=()=>{c(null),o("with-fields"),f({name:"",description:"",departmentId:""}),b.current&&(b.current.value=""),t()};return s.jsxs(ce,{show:e,onHide:S,size:"lg",centered:!0,className:"import-file-modal",dialogClassName:"import-file-modal-dialog",children:[s.jsx(ce.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(js,{className:"me-2",size:20}),"Import Form File"]})}),s.jsxs(ce.Body,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Select Import Type"}),s.jsxs(de,{className:"g-3 import-type-row",children:[s.jsx(H,{xs:12,sm:12,md:6,className:"import-type-col",children:s.jsx(W,{className:`import-type-card ${i==="with-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("with-fields"),style:{cursor:"pointer"},children:s.jsx(W.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:s.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[s.jsx(Ju,{size:48,className:"text-primary mb-3"}),s.jsx("h6",{className:"text-primary mb-2",children:"Upload Pre-configured File"})]})})})}),s.jsx(H,{xs:12,sm:12,md:6,className:"import-type-col",children:s.jsx(W,{className:`import-type-card ${i==="without-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("without-fields"),style:{cursor:"pointer"},children:s.jsx(W.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:s.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[s.jsx(ni,{size:48,className:"text-success mb-3"}),s.jsx("h6",{className:"text-success mb-2",children:"Start From Blank"})]})})})})]})]}),!i&&s.jsxs(De,{variant:"info",className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-2",children:"Please select an import type"}),s.jsx("p",{className:"mb-0 small",children:'Choose between "Upload Pre-configured File" or "Start From Blank" above to continue with the import process.'})]}),(i==="without-fields"||i==="with-fields")&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Fill in Basic Template Information"}),s.jsx(k,{children:s.jsxs(de,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Template Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:m.name,onChange:N=>f(E=>({...E,name:N.target.value})),required:!0})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Description ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:m.description,onChange:N=>f(E=>({...E,description:N.target.value})),required:!0})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(k.Select,{value:m.departmentId,onChange:N=>f(E=>({...E,departmentId:N.target.value})),required:!0,disabled:x,children:[s.jsx("option",{value:"",children:"Select Department"}),h.map(N=>s.jsx("option",{value:N.id,children:N.name},N.id))]}),x&&s.jsx(k.Text,{className:"text-muted",children:"Loading departments..."}),m.templateContent&&s.jsxs(k.Text,{className:"text-muted",children:["Template Content: ",m.templateContent]})]})})]})})]}),i&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h6",{className:"text-primary-custom mb-3",children:"Select File"}),s.jsxs(k.Group,{children:[s.jsx(k.Control,{ref:b,type:"file",accept:".docx",onChange:y,className:"mb-2"}),s.jsx(k.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]})]}),l&&s.jsx(De,{variant:"info",className:"mb-4",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ni,{className:"me-2",size:20}),s.jsxs("div",{children:[s.jsx("strong",{children:"Selected File:"})," ",l.name,s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Size: ",(l.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),s.jsxs(ce.Footer,{className:"border-0 p-3 p-md-3 d-flex flex-column flex-md-row gap-2 gap-md-2 justify-content-end",children:[s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:S,disabled:d,className:"w-100 w-md-auto order-2 order-md-1",children:[s.jsx(st,{className:"me-2",size:14}),"Cancel"]}),i==="with-fields"&&s.jsx(te,{variant:"primary-custom",size:"sm",onClick:w,disabled:!l||!m.name||!m.description||!m.departmentId||d,className:"w-100 w-md-auto order-1 order-md-2",children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:14}),"Import File"]})}),i==="without-fields"&&s.jsx(te,{variant:"primary-custom",size:"sm",onClick:w,disabled:!l||!m.name||!m.description||!m.departmentId||d,className:"w-100 w-md-auto order-1 order-md-2",children:d?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Importing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:14}),"Import File"]})})]})]})},O5=({show:e,onHide:t,template:r,onCreateVersion:a})=>{const n=tt(),[i,o]=v.useState("details"),[l,c]=v.useState(null),[d,u]=v.useState(!1),[m,f]=v.useState(null),[h,p]=v.useState(!1),[x,g]=v.useState(null),[b,j]=v.useState(!1),[y,w]=v.useState(null),[S,N]=v.useState(!1),[E,P]=v.useState({}),[T,O]=v.useState(!1);if(v.useEffect(()=>{(async()=>{if(r?.reviewedByUserId&&e)try{u(!0);const A=await Ys.getUserById(r.reviewedByUserId),D=A.data||A;c(D)}catch(A){console.error("Error fetching reviewed by user:",A),c(null)}finally{u(!1)}else c(null)})()},[r?.reviewedByUserId,e]),v.useEffect(()=>{(async()=>{if(r?.id&&e&&!r.sections)try{p(!0);const A=await tr.getTemplateById(r.id),D=A.data||A;f(D)}catch(A){console.error("Error fetching full template data:",A),f(null)}finally{p(!1)}else r?.sections?f(r):f(null)})()},[r?.id,e,r?.sections]),v.useEffect(()=>((async()=>{if(r?.id&&e&&!x)try{j(!0);const A=await tr.getTemplatePDF(r.id),D=URL.createObjectURL(A);g(D)}catch(A){console.error("Error loading PDF:",A),g(null)}finally{j(!1)}})(),()=>{e||g(A=>(A&&URL.revokeObjectURL(A),null))}),[r?.id,e,x]),v.useEffect(()=>((async()=>{if(r?.id&&e&&!y)try{N(!0);const A=await tr.getTemplatePdfConfig(r.id),D=URL.createObjectURL(A);w(D)}catch(A){console.error("Error loading PDF config:",A),w(null)}finally{N(!1)}})(),()=>{e||w(A=>(A&&URL.revokeObjectURL(A),null))}),[r?.id,e,y]),!r)return null;const _=ne=>{if(!ne)return"N/A";try{return new Date(ne).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return ne}},C=ne=>{const A={PENDING:{variant:"warning",icon:Ke,text:"PENDING"},PUBLISHED:{variant:"success",icon:Je,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:xt,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:xt,text:"ARCHIVED"}},D=A[ne]||A.DRAFT,I=D.icon;return s.jsxs(ke,{bg:D.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(I,{size:12}),D.text]})},R=()=>{a?a(r):(console.log("Create new version for template:",r.id),t())},M=()=>{const ne=m||r;n(je.TEMPLATES_EDITOR,{state:{isUpdateRejected:!0,templateId:ne.id,templateInfo:ne,fileName:ne.name||"Untitled Document",importType:"Update Rejected Template",documentUrl:ne.templateContent?.startsWith("http")?ne.templateContent:null,content:ne.templateContent?.startsWith("http")?null:ne.templateContent,initialSections:ne.sections||[]}}),t()},U=async()=>{try{O(!0),await tr.disableTemplate(r.id),J.success("Template disabled successfully"),t()}catch(ne){console.error("Error disabling template:",ne),J.error(ne?.response?.data?.message||"Failed to disable template")}finally{O(!1)}},Z=r?.status==="REJECTED"||r?.status==="DENIED",ee=()=>s.jsx("div",{className:"template-details",style:{flex:1,display:"flex",flexDirection:"column"},children:s.jsxs("div",{className:"list-group list-group-flush",style:{flex:1},children:[s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Template Name"}),s.jsx("span",{className:"text-dark",children:r?.name||"N/A"})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Vs,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Department"}),s.jsx("span",{className:"text-dark",children:r.department?.name||"N/A"}),r.department?.code&&s.jsx("small",{className:"text-muted d-block",children:r.department.code})]})]})}),r.description&&s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Description"}),s.jsx("span",{className:"text-dark",children:r.description})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Je,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Status"}),s.jsx("div",{children:C(r.status)})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Version"}),s.jsxs("span",{className:"text-dark",children:["Version ",r.version]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Sections"}),s.jsxs("span",{className:"text-dark",children:[r._count?.sections||0," ",r._count?.sections===1?"section":"sections"]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created By"}),s.jsxs("span",{className:"text-dark",children:[r.createdByUser?.firstName||""," ",r.createdByUser?.lastName||""]}),s.jsxs("small",{className:"text-muted d-block",children:[s.jsx(or,{className:"me-1",size:12}),_(r.createdAt)]})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Last Updated"}),s.jsx("span",{className:"text-dark",children:_(r.updatedAt)})]})]})}),s.jsx("div",{className:"list-group-item border-0 px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Je,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Reviewed By"}),r.reviewedByUserId?s.jsx(s.Fragment,{children:d?s.jsx("span",{className:"text-muted",children:"Loading..."}):l?s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"text-dark",children:[l.firstName||""," ",l.lastName||""]}),r.reviewedAt&&s.jsxs("small",{className:"text-muted d-block",children:[s.jsx(or,{className:"me-1",size:12}),_(r.reviewedAt)]})]}):s.jsxs("span",{className:"text-muted",children:["User ID: ",r.reviewedByUserId]})}):s.jsx("span",{className:"text-muted",children:"Not reviewed"})]})]})})]})}),re=()=>{const A=(m?.sections||r?.sections||[]).map((I,V)=>({type:"section",id:I.id||`section-${V}`,name:I.label||I.name,fieldCount:I.fields?.length||0,data:I,fields:I.fields||[]})),D=I=>{P(V=>({...V,[I]:!V[I]}))};return s.jsxs(de,{style:{height:"100%",margin:0,gap:0},children:[s.jsxs(H,{xs:12,lg:6,style:{display:"flex",flexDirection:"column",padding:"0 8px",height:"100%",minHeight:0},children:[s.jsx("h6",{className:"mb-2",style:{color:"#333",fontWeight:500,flexShrink:0},children:"Template Preview"}),s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,border:"1px solid #dee2e6",borderRadius:"4px",overflow:"hidden",backgroundColor:"#f8f9fa"},children:S?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(ct,{animation:"border",variant:"primary"})}):y?s.jsx("iframe",{src:y,style:{flex:1,border:"none",width:"100%",minHeight:0},title:"Template PDF Preview"}):s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:s.jsxs(De,{variant:"warning",className:"mb-0",children:[s.jsx("strong",{children:"No PDF Preview"}),s.jsx("p",{className:"mb-0 text-muted",children:"PDF preview not available"})]})})})]}),s.jsxs(H,{xs:12,lg:6,style:{display:"flex",flexDirection:"column",padding:"0 8px",height:"100%",minHeight:0},children:[s.jsx("h6",{className:"mb-2",style:{color:"#333",fontWeight:500,flexShrink:0},children:"Template fields & sections"}),s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,overflow:"hidden"},children:h?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(ct,{animation:"border",variant:"primary"})}):A.length===0?s.jsx(De,{variant:"info",className:"mb-0",children:s.jsxs("div",{children:[s.jsx("strong",{children:"No template config found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no sections or fields yet."})]})}):s.jsx("div",{className:"list-group",style:{border:"1px solid #dee2e6",borderRadius:"4px",flex:1,overflowY:"auto",minHeight:0,maxHeight:"100%"},children:A.map(I=>{const V=E[I.id];return s.jsxs("div",{children:[s.jsx("div",{className:"list-group-item",style:{border:"none",borderBottom:"1px solid #e9ecef",padding:"12px 16px",backgroundColor:"#f8f9fa",cursor:"pointer",userSelect:"none",flexShrink:0,transition:"background-color 0.2s ease"},onMouseEnter:ie=>ie.currentTarget.style.backgroundColor="#e9ecef",onMouseLeave:ie=>ie.currentTarget.style.backgroundColor="#f8f9fa",onClick:()=>D(I.id),children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{className:"d-flex align-items-center",style:{flex:1,minWidth:0,gap:"8px"},children:[s.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",transition:"transform 0.3s ease",transform:V?"rotate(-90deg)":"rotate(0deg)",flexShrink:0},children:s.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M6 5L11 10L6 15",stroke:"#666",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),s.jsx("span",{style:{fontSize:"14px",color:"#333",fontWeight:600,wordBreak:"break-word",overflowWrap:"break-word"},children:I.name}),I.fieldCount>0&&s.jsx(ke,{bg:"info",style:{fontSize:"11px",padding:"2px 8px",borderRadius:"12px",backgroundColor:"#0dcaf0",color:"#000",flexShrink:0},children:I.fieldCount})]}),s.jsx(ke,{bg:"warning",style:{fontSize:"11px",padding:"4px 10px",borderRadius:"4px",backgroundColor:"#ffc107",color:"#000",fontWeight:500,marginLeft:"12px",flexShrink:0},children:"SECTION"})]})}),!V&&I.fields.map((ie,se)=>s.jsx("div",{className:"list-group-item",style:{border:"none",borderBottom:"1px solid #e9ecef",padding:"12px 16px",paddingLeft:"48px",backgroundColor:"white",flexShrink:0,animation:"slideDown 0.2s ease",transition:"background-color 0.2s ease"},onMouseEnter:ae=>ae.currentTarget.style.backgroundColor="#f8f9fa",onMouseLeave:ae=>ae.currentTarget.style.backgroundColor="white",children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsx("div",{className:"d-flex align-items-center",style:{flex:1,minWidth:0},children:s.jsx("span",{style:{fontSize:"14px",color:"#555",fontWeight:400,wordBreak:"break-word",overflowWrap:"break-word"},children:ie.label||ie.fieldName})}),s.jsx(ke,{bg:"secondary",style:{fontSize:"11px",padding:"4px 10px",borderRadius:"4px",backgroundColor:"var(--bs-secondary)",color:"#fff",fontWeight:500,marginLeft:"12px",flexShrink:0},children:ie.fieldType||ie.type||"FIELD"})]})},ie.id||ie.fieldName||`field-${se}`))]},I.id)})})}),s.jsx("style",{children:`
            @keyframes slideDown {
              from {
                opacity: 0;
                transform: translateY(-5px);
              }
              to {
                opacity: 1;
                transform: translateY(0);
              }
            }
          `})]})]})},z=()=>{const ne=[];return h?s.jsx("div",{className:"text-center",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs("div",{children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading version history..."})]})}):ne.length===0?s.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsx(De,{variant:"info",className:"mb-0",style:{maxWidth:"600px",width:"100%"},children:s.jsxs("div",{children:[s.jsx("strong",{children:"No version history found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no previous versions."})]})})}):s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[s.jsx("div",{className:"mb-3",children:s.jsx("h6",{className:"mb-0",children:"Version History"})}),s.jsx("div",{className:"list-group",style:{flex:1,overflowY:"auto"},children:ne.map((A,D)=>s.jsx("div",{className:"list-group-item",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsxs("h6",{className:"mb-1",children:["Version ",A.version]}),s.jsxs("small",{className:"text-muted",children:[_(A.createdAt||A.updatedAt),A.createdByUser&&s.jsxs(s.Fragment,{children:["  ",A.createdByUser.firstName," ",A.createdByUser.lastName]})]})]}),s.jsx(ke,{bg:A.status==="PUBLISHED"?"success":"warning",children:A.status})]})},A.id||D))})]})},me=()=>b?s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",variant:"primary",className:"mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"Loading PDF preview..."})]})}):x?s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minHeight:0},children:s.jsx("iframe",{src:x,style:{width:"100%",height:"100%",border:"1px solid #dee2e6",borderRadius:"0.375rem",display:"block",flex:1,minHeight:0},title:"Template PDF Preview"})}):s.jsx("div",{className:"content-preview",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:0},children:s.jsxs(De,{variant:"warning",className:"mb-0",style:{maxWidth:"600px",width:"100%"},children:[s.jsx(tl,{className:"me-2"}),"PDF preview is not available. Please try again or contact support."]})});return s.jsxs(ce,{show:e,onHide:t,size:"lg",centered:!0,className:"template-detail-modal",dialogClassName:"template-detail-modal-dialog",contentClassName:"template-detail-modal-content",children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0 template-detail-header d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[s.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0 template-detail-title flex-grow-1",style:{minWidth:0},children:[s.jsx(xt,{className:"me-2 flex-shrink-0",size:20}),s.jsxs("span",{className:"template-detail-title-text text-truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:`Template Detail: ${r?.name||"Template"}`,children:[s.jsx("span",{className:"d-none d-md-inline",children:"Template Detail: "}),r?.name||"Template"]})]}),s.jsx(te,{variant:"link",onClick:t,className:"text-white p-0 flex-shrink-0",style:{border:"none",background:"none",opacity:.9,color:"#ffffff !important",marginLeft:"1rem"},children:s.jsx(st,{size:24,color:"#ffffff"})})]}),s.jsxs(ce.Body,{className:"p-0 template-detail-body",style:{height:"70vh",maxHeight:"70vh",overflowY:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:[s.jsx("div",{className:"bg-primary-custom text-white template-detail-tabs-container",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex border-bottom border-white border-opacity-25 template-detail-tabs",style:{overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:[s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${i==="details"?"border-bottom border-white border-3":""}`,onClick:()=>o("details"),style:{fontWeight:i==="details"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(xt,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Details"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${i==="overview"?"border-bottom border-white border-3":""}`,onClick:()=>o("overview"),style:{fontWeight:i==="overview"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(X2,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Template Config Overview"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Overview"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${i==="history"?"border-bottom border-white border-3":""}`,onClick:()=>o("history"),style:{fontWeight:i==="history"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(V2,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-lg-inline",children:"List History Version"}),s.jsx("span",{className:"d-inline d-lg-none d-sm-inline",children:"History"})]}),s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${i==="content"?"border-bottom border-white border-3":""}`,onClick:()=>o("content"),style:{fontWeight:i==="content"?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(Bt,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Content Preview"})]})]})}),s.jsx("div",{className:"p-3 p-md-4 template-detail-content",style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,overflow:"auto",height:"100%"},children:s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:[i==="details"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:ee()}),i==="overview"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:re()}),i==="history"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:z()}),i==="content"&&s.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:me()})]})})]}),s.jsxs(ce.Footer,{className:"bg-light border-0 template-detail-footer d-flex flex-wrap gap-2",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)",justifyContent:"flex-end"},children:[s.jsx(te,{variant:"secondary",onClick:t,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#ffffff",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:ne=>{ne.currentTarget.style.backgroundColor="#3a5a6f",ne.currentTarget.style.borderColor="#3a5a6f",ne.currentTarget.style.color="#ffffff"},onMouseLeave:ne=>{ne.currentTarget.style.backgroundColor="var(--bs-secondary)",ne.currentTarget.style.borderColor="var(--bs-secondary)",ne.currentTarget.style.color="#ffffff"},children:"Close"}),Z&&s.jsxs(te,{variant:"warning",onClick:M,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"#ffc107",borderColor:"#ffc107",color:"#000",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:ne=>{ne.currentTarget.style.backgroundColor="#ffb300",ne.currentTarget.style.borderColor="#ffb300",ne.currentTarget.style.transform="translateY(-1px)",ne.currentTarget.style.boxShadow="0 4px 8px rgba(255, 193, 7, 0.3)"},onMouseLeave:ne=>{ne.currentTarget.style.backgroundColor="#ffc107",ne.currentTarget.style.borderColor="#ffc107",ne.currentTarget.style.transform="translateY(0)",ne.currentTarget.style.boxShadow="none"},children:[s.jsx(Bx,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Update Rejected Template"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Update"})]}),r?.status!=="PENDING"&&s.jsx(te,{variant:"danger",onClick:U,disabled:T,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease",opacity:T?.6:1},onMouseEnter:ne=>{T||(ne.currentTarget.style.backgroundColor="#c82333",ne.currentTarget.style.borderColor="#c82333",ne.currentTarget.style.transform="translateY(-1px)",ne.currentTarget.style.boxShadow="0 4px 8px rgba(220, 53, 69, 0.3)")},onMouseLeave:ne=>{T||(ne.currentTarget.style.backgroundColor="#dc3545",ne.currentTarget.style.borderColor="#dc3545",ne.currentTarget.style.transform="translateY(0)",ne.currentTarget.style.boxShadow="none")},children:T?s.jsxs(s.Fragment,{children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:"Disabling..."}),s.jsx("span",{className:"d-inline d-sm-none",children:"Disabling..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(z2,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Disable Template"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Disable"})]})}),a&&s.jsxs(te,{variant:"primary",onClick:R,className:"d-flex align-items-center justify-content-center",style:{backgroundColor:"var(--bs-primary)",borderColor:"var(--bs-primary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:ne=>{ne.currentTarget.style.backgroundColor="#153a4a",ne.currentTarget.style.borderColor="#153a4a",ne.currentTarget.style.transform="translateY(-1px)",ne.currentTarget.style.boxShadow="0 4px 8px rgba(27, 60, 83, 0.3)"},onMouseLeave:ne=>{ne.currentTarget.style.backgroundColor="var(--bs-primary)",ne.currentTarget.style.borderColor="var(--bs-primary)",ne.currentTarget.style.transform="translateY(0)",ne.currentTarget.style.boxShadow="none"},children:[s.jsx(G2,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Create New Version"}),s.jsx("span",{className:"d-inline d-sm-none",children:"New Version"})]})]})]})},kle=({show:e,onHide:t})=>{const r=tt(),[a,n]=v.useState([]),[i,o]=v.useState(!1),[l,c]=v.useState(null),[d,u]=v.useState(!1);v.useEffect(()=>{e&&m()},[e]);const m=async()=>{try{o(!0);const x=await tr.getTemplates({status:"PUBLISHED"});let g=[];x.success&&x.data?g=x.data:Array.isArray(x)?g=x:x.data&&Array.isArray(x.data)&&(g=x.data),n(g)}catch(x){console.error("Error loading published templates:",x),J.error("Failed to load published templates"),n([])}finally{o(!1)}},f=x=>{c(x),u(!0)},h=async x=>{try{const g=await tr.getTemplateById(x.id);if(!g||!g.data){J.error("Failed to load template details");return}const b=g.data,j=b.templateForm||b,y=b.sections||[],w=M1(y),S={name:j.name||x.name,description:j.description||x.description,departmentId:j.departmentId||x.departmentId,templateContent:j.templateContent||"",templateConfig:j.templateConfig||"",originalTemplateId:x.id,importType:"Create Version",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(S)),console.log(" Template info saved for version creation:",S),console.log(" Frontend sections:",w),r(je.TEMPLATES_EDITOR,{state:{documentUrl:j.templateConfig||j.templateContent||"",fileName:j.name||"Untitled Document",importType:"Create Version",templateInfo:S,initialSections:w}}),t(),J.success("Template loaded. You can now create a new version.")}catch(g){console.error("Error creating version:",g),J.error("Failed to load template for version creation")}},p=x=>{if(!x)return"N/A";try{return new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return x}};return s.jsxs(s.Fragment,{children:[s.jsxs(ce,{show:e,onHide:t,size:"xl",centered:!0,className:"published-templates-modal",fullscreen:"md-down",children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(xt,{className:"me-2",size:20}),"Create New Template's Version"]}),s.jsx(te,{variant:"link",onClick:t,className:"text-white p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1},children:s.jsx(st,{size:24})})]}),s.jsx(ce.Body,{style:{maxHeight:"70vh",overflowY:"auto",overflowX:"hidden"},className:"published-templates-modal-body",children:i?s.jsx(nr,{}):a.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No published templates found"}),s.jsx("p",{className:"text-muted",children:"There are no published templates available to create a new version."})]}):s.jsx(de,{className:"g-3",children:a.map(x=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,children:s.jsx(W,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease",cursor:"pointer"},onMouseEnter:g=>{g.currentTarget.style.transform="translateY(-5px)",g.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:g=>{g.currentTarget.style.transform="translateY(0)",g.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(W.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(xt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:x.name,children:x.name}),s.jsxs("small",{className:"text-muted",children:["v",x.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4"},title:x.description||"No description",children:x.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Vs,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:x.department?.code||"N/A",children:x.department?.code||"N/A"})]}),s.jsxs(ke,{bg:"success",className:"d-flex align-items-center gap-1",children:[s.jsx(Je,{size:12}),"PUBLISHED"]})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Pt,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:`${x.createdByUser?.firstName||""} ${x.createdByUser?.lastName||""}`.trim(),children:[x.createdByUser?.firstName," ",x.createdByUser?.lastName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:p(x.createdAt)})]}),s.jsxs("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center",children:[s.jsx(xt,{size:12,className:"me-1"}),x._count?.sections||0," sections"]}),s.jsxs(te,{variant:"link",size:"sm",className:"p-0 text-primary-custom",onClick:g=>{g.stopPropagation(),f(x)},style:{whiteSpace:"nowrap"},children:[s.jsx(Bt,{size:14,className:"me-1"}),"View Detail"]})]}),s.jsxs(te,{variant:"primary-custom",size:"sm",className:"w-100 d-flex align-items-center justify-content-center",onClick:g=>{g.stopPropagation(),h(x)},children:[s.jsx(un,{size:14,className:"me-2"}),"Create New Version"]})]})]})})},x.id))})}),s.jsx(ce.Footer,{className:"border-0",children:s.jsx(te,{variant:"outline-secondary",onClick:t,children:"Close"})})]}),s.jsx(O5,{show:d,onHide:()=>{u(!1),c(null)},template:l,onCreateVersion:x=>{u(!1),h(x)}})]})},Dle=({activeTab:e,onTabChange:t,counts:r={}})=>{const a=[{id:"pending",label:"Pending",icon:Ke,status:"PENDING"},{id:"approved",label:"Approved (Published)",icon:Je,status:"PUBLISHED"},{id:"denied",label:"Rejected",icon:Qr,status:"DENIED"}];return s.jsx("div",{className:"bg-primary-custom text-white template-detail-tabs-container",children:s.jsx("div",{className:"d-flex border-bottom border-white border-opacity-25 template-detail-tabs",style:{overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:a.map(n=>{const i=n.icon,o=e===n.id,l=r[n.id]||0;return s.jsxs("button",{className:`flex-fill py-3 px-2 px-md-4 border-0 bg-transparent text-white d-flex align-items-center justify-content-center template-detail-tab ${o?"border-bottom border-white border-3":""}`,onClick:()=>t(n.id),style:{fontWeight:o?600:400,transition:"all 0.3s ease",minWidth:"fit-content",whiteSpace:"nowrap"},children:[s.jsx(i,{size:16,className:"me-1 me-md-2"}),s.jsx("span",{className:"d-none d-sm-inline",children:n.label}),s.jsx("span",{className:"d-inline d-sm-none",children:n.label.split(" ")[0]}),l>0&&s.jsx(ke,{bg:"light",text:"dark",className:"ms-2",style:{fontSize:"0.7rem",padding:"2px 6px",borderRadius:"10px",backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white"},children:l})]},n.id)})})})},Ile=({templates:e,onViewDetail:t})=>{const r=n=>{const i={PENDING:{variant:"warning",icon:Ke,text:"PENDING"},PUBLISHED:{variant:"success",icon:Je,text:"PUBLISHED"},DENIED:{variant:"danger",icon:Qr,text:"REJECTED"},REJECTED:{variant:"danger",icon:Qr,text:"REJECTED"},DRAFT:{variant:"secondary",icon:Ke,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:xt,text:"ARCHIVED"}},o=i[n]||i.DRAFT,l=o.icon;return s.jsxs(ke,{bg:o.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(l,{size:12}),o.text]})},a=n=>{if(!n)return"N/A";try{return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return n}};return e.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(xt,{size:48,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No templates found"}),s.jsx("p",{className:"text-muted",children:"No templates match your current filters."})]}):s.jsx(de,{className:"g-3 g-md-4",children:e.map(n=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(W,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease",cursor:"pointer"},onClick:()=>t(n.id),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(W.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(xt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:n.name,children:n.name}),s.jsxs("small",{className:"text-muted",children:["v",n.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:n.description||"No description",children:n.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Vs,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:n.department?.code||"N/A",children:n.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:r(n.status)})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Pt,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:n.createdByUser?.firstName&&n.createdByUser?.lastName?`${n.createdByUser.firstName} ${n.createdByUser.lastName}`:n.createdBy||"N/A",children:n.createdByUser?.firstName&&n.createdByUser?.lastName?`${n.createdByUser.firstName} ${n.createdByUser.lastName}`:n.createdBy||"N/A"})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:a(n.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center flex-shrink-0",children:[s.jsx(xt,{size:12,className:"me-1"}),n._count?.sections||n.sections||0," sections"]}),s.jsx(yt,{permissions:[Te.VIEW_TEMPLATE_DETAILS],fallback:null,children:s.jsxs(te,{variant:"link",size:"sm",className:"p-0 text-primary-custom flex-shrink-0 ms-2",onClick:i=>{i.stopPropagation(),t(n.id)},style:{whiteSpace:"nowrap"},children:[s.jsx(Bt,{size:14,className:"me-1"}),"View Detail"]})})]})})]})})},n.id))})},Ole=({templates:e,searchTerm:t,onSearchChange:r,onViewDetail:a})=>s.jsxs(s.Fragment,{children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search templates by name, description, or creator...",value:t,onChange:r,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:6,md:7,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[e.length," template",e.length!==1?"s":""]})})})]}),s.jsx("div",{className:"template-card-scroll-container",children:s.jsx(Ile,{templates:e,onViewDetail:a})})]}),Ple=()=>{const e=tt(),[t]=el(),{isSQAMode:r,isAdminMode:a}=Tle(),[n,i]=v.useState(!1),[o,l]=v.useState(null),[c,d]=v.useState(!1),[u,m]=v.useState(!1),[f,h]=v.useState(""),[p,x]=v.useState(""),[g,b]=v.useState("pending"),[j,y]=v.useState(""),[w,S]=v.useState([]),[N,E]=v.useState(!0),P=v.useCallback(async()=>{try{if(E(!0),r){const A=await tr.getTemplates();let D=[];A.success&&A.data?D=A.data:Array.isArray(A)?D=A:A.data&&Array.isArray(A.data)&&(D=A.data),S(D)}else if(a){const A=await tr.getMyTemplates();let D=[];A.success&&A.data?D=A.data:Array.isArray(A)?D=A:A.data&&Array.isArray(A.data)&&(D=A.data),S(D)}else S([])}catch(A){console.error("Error loading templates:",A),J.error("Failed to load templates"),S([])}finally{E(!1)}},[r,a]);v.useEffect(()=>{P()},[P]),v.useEffect(()=>{if(a&&t.get("action")==="create"){i(!0);const D=new URLSearchParams(t);D.delete("action");const I=D.toString();e({search:I?`?${I}`:""},{replace:!0})}},[a]);const T=A=>{switch(A){case"pending":return"PENDING";case"approved":return"PUBLISHED";case"denied":return["DENIED","REJECTED"];default:return null}},O=v.useMemo(()=>{if(!r)return[];const A=T(g);return A?Array.isArray(A)?w.filter(D=>A.includes(D.status)):w.filter(D=>D.status===A):[]},[w,g,r]),_=v.useMemo(()=>r?O.filter(A=>{const D=A.name?.toLowerCase()||"",I=A.description?.toLowerCase()||"",V=A.createdBy?.toLowerCase()||(A.createdByUser?.firstName&&A.createdByUser?.lastName?`${A.createdByUser.firstName} ${A.createdByUser.lastName}`.toLowerCase():"");return D.includes(j.toLowerCase())||I.includes(j.toLowerCase())||V.includes(j.toLowerCase())}):[],[O,j,r]),C=v.useMemo(()=>r?{pending:w.filter(A=>A.status==="PENDING").length,approved:w.filter(A=>A.status==="PUBLISHED").length,denied:w.filter(A=>A.status==="DENIED"||A.status==="REJECTED").length}:{pending:0,approved:0,denied:0},[w,r]),R=()=>{i(!0)},M=()=>{i(!1),P()},U=A=>{J.error(`Import failed: ${A}`,{icon:!1})},Z=A=>{l(A),d(!0)},ee=A=>{console.log("View detail for template:",A),e(je.TEMPLATES_DETAIL(A))},re=A=>{const D={PENDING:{variant:"warning",icon:Ke,text:"PENDING"},PUBLISHED:{variant:"success",icon:Je,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:xt,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:xt,text:"ARCHIVED"},DENIED:{variant:"danger",icon:Ke,text:"REJECTED"},REJECTED:{variant:"danger",icon:Ke,text:"REJECTED"}},I=D[A]||D.DRAFT,V=I.icon;return s.jsxs(ke,{bg:I.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(V,{size:12}),I.text]})},z=A=>{if(!A)return"N/A";try{return new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return A}},me=v.useMemo(()=>a?w.filter(A=>{const D=!f||(()=>{const V=A.name?.toLowerCase()||"",ie=A.description?.toLowerCase()||"",se=A.createdByUser?.firstName&&A.createdByUser?.lastName?`${A.createdByUser.firstName} ${A.createdByUser.lastName}`.toLowerCase():"",ae=f.toLowerCase();return V.includes(ae)||ie.includes(ae)||se.includes(ae)})(),I=!p||A.status===p;return D&&I}):[],[w,f,p,a]),ne=[{value:"DRAFT",label:"Draft"},{value:"PENDING",label:"Pending"},{value:"PUBLISHED",label:"Published"},{value:"REJECTED",label:"Rejected"}];return N?s.jsx(Ce,{fluid:!0,className:"p-4",children:s.jsx(nr,{})}):r?s.jsx(Ce,{fluid:!0,className:"py-4 template-list-page",children:s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"bg-light-custom border-neutral-200"}),s.jsx(Dle,{activeTab:g,onTabChange:b,counts:C}),s.jsx(W.Body,{className:"template-list-body",children:s.jsx(Ole,{templates:_,searchTerm:j,onSearchChange:y,onViewDetail:ee})})]})}):a?s.jsx(Ce,{fluid:!0,className:"py-4 forms-page form-component",children:s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53"},children:s.jsxs(de,{className:"align-items-center",children:[s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(xt,{className:"me-2 text-white",size:24}),s.jsx("h4",{className:"mb-0 text-white",children:"Template List"})]})}),s.jsx(H,{xs:"auto",children:s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx(yt,{permission:Te.EDIT_DRAFT_TEMPLATE,fallback:null,children:s.jsxs(te,{variant:"outline-light",onClick:()=>e(je.TEMPLATES_DRAFTS),className:"d-flex align-items-center",size:"sm",children:[s.jsx(xt,{className:"me-2",size:16}),"Your Drafts"]})}),s.jsx(yt,{permission:Te.UPDATE_TEMPLATE_VERSION,fallback:null,children:s.jsxs(te,{variant:"outline-light",onClick:()=>m(!0),className:"d-flex align-items-center",size:"sm",children:[s.jsx(xt,{className:"me-2",size:16}),"Create New Template's Version"]})}),s.jsx(yt,{permission:Te.CREATE_TEMPLATE,fallback:null,children:s.jsxs(te,{variant:"primary-custom",onClick:R,className:"d-flex align-items-center",size:"sm",children:[s.jsx(js,{className:"me-2",size:16}),"Create New Template"]})}),"                "]})})]})}),s.jsxs(W.Body,{className:"template-list-body",style:{display:"flex",flexDirection:"column",maxHeight:"calc(100vh - 220px)",overflow:"hidden",paddingBottom:0},children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",style:{flexShrink:0},children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search templates by name, description, or creator...",value:f,onChange:h,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:s.jsx(FR,{title:"Status",options:ne,selectedValue:p,onSelect:x,variant:"outline-secondary"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[me.length," template",me.length!==1?"s":""]})})})]}),s.jsx("div",{className:"template-list-scroll",style:{flex:"1 1 auto",overflowY:"auto",overflowX:"hidden",minHeight:0,maxHeight:"100%",paddingRight:"0.75rem",marginRight:"-0.25rem"},children:me.length===0?s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ni,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:w.length===0?"No form templates found":"No templates match your search or filter criteria"}),s.jsx("p",{className:"text-muted mb-4",children:"Get started by creating a new form or importing an existing file."})]})})}):s.jsx(de,{className:"g-3 g-md-4",children:me.map(A=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(W,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease"},onMouseEnter:D=>{D.currentTarget.style.transform="translateY(-5px)",D.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:D=>{D.currentTarget.style.transform="translateY(0)",D.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(W.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(xt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:A.name,children:A.name}),s.jsxs("small",{className:"text-muted",children:["v",A.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:A.description||"No description",children:A.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Vs,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:A.department?.code||"N/A",children:A.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:re(A.status)})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Pt,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},title:`${A.createdByUser?.firstName||""} ${A.createdByUser?.lastName||""}`.trim(),children:[A.createdByUser?.firstName," ",A.createdByUser?.lastName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:z(A.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap",children:[s.jsxs("small",{className:"text-muted d-flex align-items-center flex-shrink-0",children:[s.jsx(xt,{size:12,className:"me-1"}),A._count?.sections||0," sections"]}),s.jsx(yt,{permission:Te.VIEW_TEMPLATE_DETAILS,fallback:null,children:s.jsxs(te,{variant:"link",size:"sm",className:"p-0 text-primary-custom flex-shrink-0 ms-2",onClick:D=>{D.stopPropagation(),Z(A)},style:{whiteSpace:"nowrap"},children:[s.jsx(Bt,{size:14,className:"me-1"}),"Preview"]})})]})})]})})},A.id))})}),s.jsx(_le,{show:n,onHide:()=>i(!1),onImportSuccess:M,onImportError:U}),s.jsx(O5,{show:c,onHide:()=>{d(!1),setTimeout(()=>l(null),300)},template:o}),s.jsx(kle,{show:u,onHide:()=>m(!1)})]})]})}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(W,{children:s.jsx(W.Body,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ni,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"Access Denied"}),s.jsx("p",{className:"text-muted",children:"You don't have permission to view templates."})]})})})})};function Md(e){const t=(e.fieldName||"").trim(),r=e.parentTempId||null;return`${t}|${r||"null"}`}function Rle(e){return Array.isArray(e)?e.flatMap(t=>(t.fields||[]).map(a=>{const n=(a.fieldName||a.name||"").trim(),i=(a.fieldType||"").trim(),o=a.parentTempId||null;return{fieldName:n,fieldType:i,parentTempId:o}})):[]}function Fle(e){let t=[];return Array.isArray(e)?t=e:e?.fields&&Array.isArray(e.fields)?t=e.fields:e?.data?.fields&&Array.isArray(e.data.fields)?t=e.data.fields:e?.data&&Array.isArray(e.data)&&(t=e.data),t.map(r=>({fieldName:(r.fieldName||"").trim(),fieldType:(r.fieldType||"").trim(),parentTempId:r.parentTempId||null}))}function Lle(e,t){const r=Fle(e),a=Rle(t);console.log(" [Field Validator] Debug Info:"),console.log("   Normalized Extract Fields:",r),console.log("   Flattened Payload Fields:",a);const n=new Set(a.map(Md)),i=new Set(r.map(Md));console.log("   Payload Keys:",Array.from(n)),console.log("   Extract Keys:",Array.from(i));const o=r.filter(h=>{const p=Md(h),x=n.has(p);return x||console.log(`   Missing in Schema: ${p} (fieldName: ${h.fieldName}, fieldType: ${h.fieldType}, parentTempId: ${h.parentTempId})`),!x}),l=a.filter(h=>{const p=Md(h),x=i.has(p);return x||console.log(`   Missing in Document: ${p} (fieldName: ${h.fieldName}, fieldType: ${h.fieldType}, parentTempId: ${h.parentTempId})`),!x}),c=[...new Set(o.map(h=>h.fieldName))],d=[...new Set(l.map(h=>h.fieldName))],u=o.length===0&&l.length===0;let m="",f="";return o.length>0&&(c.length===1?m=`Field "${c[0]}" is not in the Available Custom Fields. Please remove it from the editor or add it through the side panel.`:m=`The following fields are not in the Available Custom Fields: ${c.join(", ")}. Please remove them from the editor or add them through the side panel.`),l.length>0&&(d.length===1?f=`Field "${d[0]}" is in the Available Custom Fields but not found in the editor. Please insert it into the editor using the "Insert Field" button.`:f=`The following fields are in the Available Custom Fields but not found in the editor: ${d.join(", ")}. Please insert them into the editor using the "Insert Field" button.`),{isValid:u,missingInSchema:c,missingInDocument:d,errorMessage:m,warningMessage:f,totalExtractFields:r.length,totalPayloadFields:a.length}}const Mle=({customFields:e=[],onAddField:t,onRemoveField:r,onInsertField:a,exportEditedDoc:n,exportAndUploadEditedDoc:i,forceSaveAndPoll:o,getDocumentKey:l,addSystemFieldToSectionRef:c,initialSections:d=null,readOnly:u=!1,className:m="",onSubmittingChange:f})=>{const h=tt(),[p,x]=v.useState([]);v.useEffect(()=>{d&&Array.isArray(d)&&d.length>0&&p.length===0&&(console.log(" Restoring sections from draft:",d),x(d))},[d]);const[g,b]=v.useState({}),[j,y]=v.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null}),[w,S]=v.useState({fromIndex:null,overIndex:null,position:"above"}),N=v.useRef(new Set),[E,P]=v.useState(!1),[T,O]=v.useState(null),[_,C]=v.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[R,M]=v.useState(["TRAINER","TRAINEE"]),[U,Z]=v.useState(!1),[ee,re]=v.useState(!1),[z,me]=v.useState(null),[ne,A]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"TRAINER",parentTempId:null,option:null}),[D,I]=v.useState([]),[V,ie]=v.useState("");v.useEffect(()=>{e&&e.length>0&&p.length===0&&x([{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[...e]}])},[]),v.useEffect(()=>(c&&(c.current={getSections:()=>p,addSystemField:(ye,pe)=>{if(ye===null||ye<0||ye>=p.length)return J.error("Invalid section index"),!1;const _e=p[ye],et=_e.fields||[];if(et.some(bt=>bt.fieldName===pe.fieldName))return J.warning(`Field "${pe.fieldName}" already exists in this section`),!1;const He={...pe,roleRequired:pe.roleRequired||_e.editBy||"TRAINER"},Ve=[...p];if(Ve[ye]={..._e,fields:[...et,He]},x(Ve),t){const bt=Ve.flatMap(cr=>cr.fields||[]);setTimeout(()=>{t(bt)},0)}return!0},buildAndSubmitDraftTemplate:async ye=>{try{console.log(" Building and submitting draft template..."),console.log(" Draft URL (OnlyOffice):",ye);let pe=null;const _e=Qn();try{console.log(" Uploading from OnlyOffice URL to S3...");const q=`${(_e.name||"template").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase().substring(0,50)}_draft.docx`;if(console.log(" File name for upload:",q),pe=await mn.uploadFromUrl(ye,q),pe)console.log(" Upload from URL success! S3 URL:",pe);else throw console.warn(" No S3 URL received from upload-from-url"),new Error("Failed to upload to S3")}catch(B){throw console.error(" Upload from URL failed:",B),J.error("Could not upload draft document to S3"),B}const et=Qn(),He=et.originalTemplateId,Ve=et.currentTemplateId||et.id||localStorage.getItem("currentTemplateId");let bt=null;if(Ve&&!He)try{console.log(" Loading existing draft fields for parentId conversion...");const B=await tr.getTemplateById(Ve);bt=(B?.data?.sections||B?.data?.data?.sections||[]).flatMap(q=>q.fields||[]),console.log(` Loaded ${bt.length} existing fields for conversion`)}catch(B){console.warn(" Failed to load existing draft fields, will use parentTempId:",B)}const cr={..._e,templateContent:_e.templateContent,templateConfig:pe},nt=N2(cr,p,bt),jt={name:nt.name,description:nt.description,departmentId:nt.departmentId,templateContent:nt.templateContent,templateConfig:nt.templateConfig||null,status:"DRAFT",sections:nt.sections};if(console.log(" Draft template payload built:"),console.log("   templateContent (file import):",jt.templateContent),console.log("   templateConfig (file  chnh sa):",jt.templateConfig||"null"),console.log("   Status:",jt.status),console.log("   Using existingFields for conversion:",bt?"Yes":"No"),console.log(` Full payload:
`,JSON.stringify(jt,null,2)),console.log(" Checking flow type:"),console.log("   freshMeta.originalTemplateId:",He),console.log("   freshMeta.currentTemplateId:",et.currentTemplateId),console.log("   freshMeta.id:",et.id),console.log('   localStorage.getItem("currentTemplateId"):',localStorage.getItem("currentTemplateId")),console.log("   Final originalTemplateId:",He),console.log("   Final currentTemplateId:",Ve),He){console.log(" Creating new draft for version (with originalTemplateId):",He);const B={originalTemplateId:He,...jt};try{const X=await tr.createVersion(B),Y=(X?.data?.templateForm||X?.data?.data?.templateForm||X?.data?.data?.template||X?.data?.template)?.id||X?.data?.id||X?.data?.data?.id||X?.data?.data?.templateForm?.id||X?.data?.data?.template?.id||X?.data?.template?.id||(X?.data?.data?.template?X.data.data.template.id:null);if(Y){const le={...Qn(),currentTemplateId:Y};localStorage.setItem("templateInfo",JSON.stringify(le)),localStorage.setItem("currentTemplateId",Y),console.log(" Saved currentTemplateId:",Y)}return J.success("Draft template saved successfully!"),console.log(" Draft version created successfully:",X?.data??X),X?.data??X}catch(X){const q=X?.response?.data?.message||X?.message||"";if((X?.response?.statusCode||X?.response?.status)===400&&(q.includes("already exists")||q.includes("Template name")||q.toLowerCase().includes("duplicate"))){console.log(" Template name already exists, retrying without name..."),J.warning("Template name already exists. System will auto-generate a new name...");const le={originalTemplateId:He,description:jt.description,departmentId:jt.departmentId,templateContent:jt.templateContent,templateConfig:jt.templateConfig||null,status:"DRAFT",sections:jt.sections};try{const xe=await tr.createVersion(le),fe=(xe?.data?.templateForm||xe?.data?.data?.templateForm||xe?.data?.data?.template||xe?.data?.template)?.id||xe?.data?.id||xe?.data?.data?.id||xe?.data?.data?.templateForm?.id||xe?.data?.data?.template?.id||xe?.data?.template?.id||(xe?.data?.data?.template?xe.data.data.template.id:null);if(fe){const ve={...Qn(),currentTemplateId:fe};localStorage.setItem("templateInfo",JSON.stringify(ve)),localStorage.setItem("currentTemplateId",fe),console.log(" Saved currentTemplateId (retry):",fe)}return J.success("Draft template saved successfully with auto-generated name!"),console.log(" Draft version created successfully (retry):",xe?.data??xe),xe?.data??xe}catch(xe){throw console.error(" Retry failed:",xe),xe}}else throw X}}else if(Ve){console.log(" Updating existing draft:",Ve);const B=await be.put(`/templates/update-draft/${Ve}`,{...jt,id:Ve,status:"DRAFT"});return J.success("Draft template saved successfully!"),console.log(" Draft updated successfully:",B?.data??B),B?.data??B}else{console.log(" Creating new draft");const B=await be.post("/templates",jt);console.log(" Response structure check:"),console.log("   Full res?.data:",JSON.stringify(B?.data,null,2)),console.log("   res?.data?.id:",B?.data?.id),console.log("   res?.data?.data:",B?.data?.data),console.log("   res?.data?.data?.id:",B?.data?.data?.id),console.log("   res?.data?.data?.templateForm?.id:",B?.data?.data?.templateForm?.id),console.log("   res?.data?.data?.template?.id:",B?.data?.data?.template?.id),console.log("   res?.data?.template?.id:",B?.data?.template?.id);const X=B?.data?.id||B?.data?.data?.id||B?.data?.data?.templateForm?.id||B?.data?.data?.template?.id||B?.data?.template?.id||(B?.data?.data?.template?B.data.data.template.id:null);if(console.log("   Extracted newTemplateId:",X),X){const Y={...Qn(),currentTemplateId:X};localStorage.setItem("templateInfo",JSON.stringify(Y)),localStorage.setItem("currentTemplateId",X),console.log(" Saved currentTemplateId:",X),console.log(" Updated templateInfo:",Y)}else console.warn(" No template ID found in response! Response structure:",B?.data);return J.success("Draft template saved successfully!"),console.log(" Draft created successfully:",B?.data??B),B?.data??B}}catch(pe){console.error(" Error building/submitting draft template:",pe);const _e=pe.response?.data?.message||pe.message||"Unknown error";throw J.error(_e),pe}}}),()=>{c&&(c.current=null)}),[p,c,t]);const se=()=>{O(null),C({name:"",label:"",displayOrder:p.length+1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),P(!0)},ae=ye=>{if(u)return;const pe=p[ye];pe&&(O(ye),C({name:pe.name||pe.label||"",label:pe.label||"",displayOrder:pe.displayOrder||ye+1,editBy:pe.editBy||"TRAINER",roleInSubject:pe.roleInSubject||"",isSubmittable:pe.isSubmittable!==void 0?pe.isSubmittable:!0,isToggleDependent:pe.isToggleDependent!==void 0?pe.isToggleDependent:!1,fields:pe.fields||[]}),P(!0))},K=ye=>{b(pe=>({...pe,[ye]:!pe[ye]}))},G=(ye,pe,_e)=>{pe===null||_e===null||pe===_e||x(et=>{const He=[...et],Ve=[...He[ye]?.fields||[]],[bt]=Ve.splice(pe,1);if(Ve.splice(_e,0,bt),He[ye]={...He[ye],fields:Ve},t){const cr=He.flatMap(nt=>nt.fields||[]);setTimeout(()=>{t(cr,{silent:!0})},0)}return He})},ue=(ye,pe)=>{ye===null||pe===null||ye===pe||x(_e=>{const et=[..._e],[He]=et.splice(ye,1);return et.splice(pe,0,He),et})},L=(ye,pe,_e,et)=>{if(u||ye===null||pe===null||_e===null)return;if(ye===_e){G(ye,pe,et);return}const He=`${ye}-${pe}-${_e}`,Ve=N.current.size;N.current.add(He);const bt=N.current.size;if(Ve===bt){console.warn(" Move operation already in progress, skipping...",He);return}x(cr=>{const nt=[...cr],jt=nt[ye],B=nt[_e];if(!jt||!B)return setTimeout(()=>{N.current.delete(He)},0),cr;const X=[...jt.fields||[]],q=[...B.fields||[]];if(pe<0||pe>=X.length)return console.warn(" Invalid fromFieldIndex:",pe,"Fields length:",X.length),setTimeout(()=>{N.current.delete(He)},0),cr;const Y=X[pe];if(!Y)return console.warn(" Field not found at index:",pe),setTimeout(()=>{N.current.delete(He)},0),cr;console.log(" moveFieldBetweenSections:",{fromFieldIndex:pe,fieldToMove:Y.label||Y.fieldName,fieldType:Y.fieldType,parentTempId:Y.parentTempId,allFields:X.map((ve,Ie)=>({idx:Ie,label:ve.label||ve.fieldName,type:ve.fieldType,parent:ve.parentTempId}))});const oe=String(Y.fieldType||"").toUpperCase()==="PART",le=oe?Y.tempId||`${Y.fieldName}-parent`:null,xe=[Y],Se=new Set([pe]);oe&&le&&X.forEach((ve,Ie)=>{ve.parentTempId===le&&Ie!==pe&&(console.log("   Adding child:",{idx:Ie,label:ve.label||ve.fieldName,parentTempId:ve.parentTempId}),xe.push(ve),Se.add(Ie))}),console.log("   Fields to move:",xe.map(ve=>ve.label||ve.fieldName)),console.log("   Indices to remove:",Array.from(Se));const fe=X.filter((ve,Ie)=>{const $e=Se.has(Ie);return $e&&console.log(`   Removing field at index ${Ie}:`,ve.label||ve.fieldName),!$e});console.log("   Remaining fields:",fe.map((ve,Ie)=>({idx:Ie,label:ve.label||ve.fieldName})));const ge=et!==null?Math.max(0,Math.min(et,q.length)):q.length;if(q.splice(ge,0,...xe),nt[ye]={...jt,fields:fe},nt[_e]={...B,fields:q},t){const ve=nt.flatMap(Ie=>Ie.fields||[]);setTimeout(()=>{t(ve,{silent:!0})},0)}return setTimeout(()=>{N.current.delete(He)},0),nt})},Ne=ye=>{if(!(u||!p[ye])&&(x(_e=>_e.filter((et,He)=>He!==ye)),t)){const et=p.filter((He,Ve)=>Ve!==ye).flatMap(He=>He.fields||[]);setTimeout(()=>{t(et,{silent:!0})},0)}},Oe=()=>{if(!_.label){J.warning("Please fill in section label");return}const ye=_.label.trim();if(p.some((et,He)=>T!==null&&He===T?!1:et.label&&et.label.trim().toLowerCase()===ye.toLowerCase())){J.warning(`Section with label "${ye}" already exists. Please use a different label.`);return}const _e={..._,name:ye,label:ye,roleInSubject:_.editBy==="TRAINEE"?null:_.roleInSubject||null,fields:[..._.fields||[]]};if(T!==null)x(et=>{const He=[...et],Ve=He[T],bt=Ve.fields||[];let cr=[...bt];const nt=bt.some(B=>B.fieldType==="SECTION_CONTROL_TOGGLE"),jt=_e.isToggleDependent;if(jt&&!nt){const B=`${_e.name.toLowerCase().replace(/\s+/g,"_")}_toggle`;cr=[{label:`${_e.label} Toggle`,fieldName:B,fieldType:"SECTION_CONTROL_TOGGLE",roleRequired:_e.editBy||"TRAINER",parentTempId:null},...cr]}else!jt&&nt&&(cr=cr.filter(B=>B.fieldType!=="SECTION_CONTROL_TOGGLE"));return He[T]={...Ve,label:_e.label,name:_e.name,editBy:_e.editBy,roleInSubject:_e.roleInSubject,isSubmittable:_e.isSubmittable,isToggleDependent:_e.isToggleDependent,displayOrder:_e.displayOrder,fields:cr},He}),J.success("Section updated successfully");else{if(_e.isToggleDependent){const et=`${_e.name.toLowerCase().replace(/\s+/g,"_")}_toggle`,He={label:`${_e.label} Toggle`,fieldName:et,fieldType:"SECTION_CONTROL_TOGGLE",roleRequired:_e.editBy||"TRAINER",parentTempId:null};_e.fields=[He]}x(et=>[...et,_e]),J.success("Section added successfully")}P(!1),O(null)},We=()=>{if(T===null)return;const ye=p[T];ye&&window.confirm(`Are you sure you want to remove section "${ye.label}"? This action cannot be undone.`)&&(Ne(T),P(!1),O(null),J.success("Section removed successfully"))};v.useEffect(()=>{E&&(async()=>{try{const pe=await Cs.getPublicRoles(),et=(Array.isArray(pe)?pe:[]).map(Ve=>typeof Ve=="string"?Ve:Ve.name||Ve.code||Ve.roleName||"").filter(Ve=>typeof Ve=="string").map(Ve=>Ve.toUpperCase()).filter(Ve=>Ve.includes("TRAINER")||Ve.includes("TRAINEE")).map(Ve=>Ve.includes("TRAINER")?"TRAINER":"TRAINEE"),He=Array.from(new Set(et));He.length>0&&M(He)}catch{}})()},[E]);const Qe=ye=>{const _e=p[ye]?.editBy||"TRAINER";A({label:"",fieldName:"",fieldType:"TEXT",roleRequired:_e,displayOrder:1,parentTempId:null,option:null}),I([]),ie(""),O(ye),Z(!0)},Pe=(ye,pe)=>{if(!ye)return{valid:!1,message:"Field name is required"};const _e=String(pe||"").toUpperCase();return _e==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(ye)?ye.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:_e==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(ye)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(ye)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},rt=()=>{if(!ne.label||!ne.fieldName){J.warning("Please fill in all required fields");return}let ye={...ne};if(ne.fieldType==="VALUE_LIST"){if(!D||D.length===0){J.warning("Please add at least one option for VALUE_LIST field");return}const Ve=JSON.stringify({items:D});ye.option=Ve,A(bt=>({...bt,option:Ve}))}const pe=Pe(ye.fieldName,ye.fieldType);if(!pe.valid){J.warning(pe.message);return}if(T===null||T<0||T>=p.length){J.warning("Please choose a section");return}const _e=p[T].fields||[];if((z!==null?_e.filter((Ve,bt)=>bt!==z):_e).some(Ve=>Ve.fieldName===ye.fieldName)){J.warning("Field name must be unique");return}const He=[...p];if(z!==null?He[T].fields=[..._e.slice(0,z),ye,..._e.slice(z+1)]:He[T].fields=[..._e,ye],x(He),t){const Ve=He.flatMap(bt=>bt.fields||[]);setTimeout(()=>{t(Ve)},0)}Z(!1),re(!1),O(null),me(null),I([]),ie("")},Ht=(ye,pe)=>{const _e=p[ye]?.fields?.[pe];if(_e){if(A({..._e}),_e.fieldType==="VALUE_LIST"&&_e.option)try{const et=JSON.parse(_e.option);et.items&&Array.isArray(et.items)?I(et.items):I([])}catch{I([])}else I([]);ie(""),O(ye),me(pe),re(!0)}},gt=()=>{Z(!1),re(!1),P(!1),O(null),me(null),I([]),ie("")},[Ue,he]=v.useState(!1);v.useEffect(()=>{f&&f(Ue)},[Ue,f]);const Me=async()=>{try{he(!0);const ye=Qn(),pe=l?l():null;console.log(" DocumentKey:",pe);let _e=null;const et=ye.templateContent;if(o)try{console.log(" Triggering callback flow...");const fe=await o();if(fe){console.log(" Callback flow success! OnlyOffice URL:",fe);try{console.log(" Uploading from OnlyOffice URL to S3...");const Ie=`${(ye.name||"template").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase().substring(0,50)}.docx`;console.log(" File name for upload:",Ie),_e=await mn.uploadFromUrl(fe,Ie),_e?console.log(" Upload from URL success! S3 URL:",_e):(console.warn(" No S3 URL received from upload-from-url"),_e=null)}catch(ge){console.error(" Upload from URL failed:",ge),J.warning("Could not upload document to S3"),_e=null}}else console.warn(" No OnlyOffice URL received"),_e=null}catch(fe){console.error(" Callback flow failed:",fe),J.warning("Could not get edited document from backend"),_e=null}else console.warn(" forceSaveAndPoll function not available"),_e=null;console.log(" Submitting template to backend...");const He=p.flatMap(fe=>fe.fields||[]),Ve=He.filter(fe=>fe.fieldType==="FINAL_SCORE_TEXT"),bt=He.filter(fe=>fe.fieldType==="FINAL_SCORE_NUM");if(Ve.length===0&&bt.length===0){J.error("Template must have at least 1 FINAL_SCORE_TEXT or FINAL_SCORE_NUM field (or both)"),he(!1);return}if(Ve.length>1){J.error(`Template must have at most 1 FINAL_SCORE_TEXT field. Found: ${Ve.length}`),he(!1);return}if(bt.length>1){J.error(`Template must have at most 1 FINAL_SCORE_NUM field. Found: ${bt.length}`),he(!1);return}if(He.filter(fe=>(fe.fieldType==="SIGNATURE_IMAGE"||fe.fieldType==="SIGNATURE_DRAW")&&fe.roleRequired==="TRAINER").length===0){J.error("Template must have at least one signature field (IMAGE or DRAW) for the TRAINER role."),he(!1);return}if(He.filter(fe=>fe.fieldType==="SIGNATURE_DRAW"&&fe.roleRequired==="TRAINEE").length!==1){J.error("Template must have exactly one SIGNATURE_DRAW field for the TRAINEE role."),he(!1);return}const jt=He.filter(fe=>fe.fieldType==="FINAL_SCORE_TEST"),B=bt.length>0,X=Ve.length>0,q=ye.originalTemplateId,Y=ye.currentTemplateId||localStorage.getItem("currentTemplateId");let oe=null;if(Y&&!q)try{console.log(" Loading existing draft fields for parentId conversion (Submit)...");const fe=await tr.getTemplateById(Y);oe=(fe?.data?.sections||fe?.data?.data?.sections||[]).flatMap(ve=>ve.fields||[]),console.log(` Loaded ${oe.length} existing fields for conversion (Submit)`)}catch(fe){console.warn(" Failed to load existing draft fields, will use parentTempId:",fe)}const le={...ye,templateContent:et,templateConfig:_e},xe=N2(le,p,oe),Se={name:xe.name,description:xe.description,departmentId:xe.departmentId,templateContent:xe.templateContent,templateConfig:xe.templateConfig||null,status:"PENDING",sections:xe.sections};if(console.log(" Template payload built:"),console.log("   templateContent (file import):",Se.templateContent),console.log("   templateConfig (file  chnh sa):",Se.templateConfig||"null"),console.log("   Status:",Se.status),console.log("   documentKey:",pe),console.log("   Using existingFields for conversion:",oe?"Yes":"No"),console.log(` Full payload:
`,JSON.stringify(Se,null,2)),_e)try{console.log(" Validating fields from editor against Available Custom Fields..."),console.log("   Document URL:",_e);const fe=await tr.extractFields(_e);console.log(" Extract fields response:",fe);const ge=Lle(fe,Se.sections);if(console.log(" Validation result:",{isValid:ge.isValid,missingInSchema:ge.missingInSchema,missingInDocument:ge.missingInDocument,totalExtractFields:ge.totalExtractFields,totalPayloadFields:ge.totalPayloadFields}),!ge.isValid){if(ge.missingInSchema.length>0){console.error(" Field validation failed - fields in editor but not in Available Custom Fields:",ge.missingInSchema),J.error(ge.errorMessage),he(!1);return}if(ge.missingInDocument.length>0){console.error(" Field validation failed - fields in Available Custom Fields but not in editor:",ge.missingInDocument),J.error(ge.warningMessage),he(!1);return}}ge.isValid&&console.log(" Field validation passed - all fields match between editor and Available Custom Fields")}catch(fe){console.warn(" Failed to validate fields (extract-fields API error):",fe),console.warn(" Continuing with submit without field validation")}else console.warn(" No templateConfigUrl available - skipping field validation");if(q){console.log(" Creating new version from published template:",q);const fe={originalTemplateId:q,...Se};try{const ge=await tr.createVersion(fe);J.success("Template version created successfully"),console.log(" Template version created:",ge?.data??ge);const ve={...ye,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(ve)),console.log(" Cleared originalTemplateId after version creation"),setTimeout(()=>{h(je.TEMPLATES)},1500)}catch(ge){const ve=ge?.response?.data?.message||ge?.message||"";if((ge?.response?.statusCode||ge?.response?.status)===400&&(ve.includes("already exists")||ve.includes("Template name")||ve.toLowerCase().includes("duplicate"))){console.log(" Template name already exists, retrying without name..."),J.warning("Template name already exists. System will auto-generate a new name...");const qe={originalTemplateId:q,description:Se.description,departmentId:Se.departmentId,templateContent:Se.templateContent,templateConfig:Se.templateConfig||null,status:Se.status,sections:Se.sections};try{const Le=await tr.createVersion(qe);J.success("Template version created successfully with auto-generated name"),console.log(" Template version created (retry):",Le?.data??Le);const Ge={...ye,originalTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(Ge)),console.log(" Cleared originalTemplateId after version creation (retry)"),setTimeout(()=>{h("/templates")},1500)}catch(Le){throw console.error(" Retry failed:",Le),Le}}else throw ge}}else if(Y){console.log(" Updating existing rejected template:",Y);const{status:fe,...ge}=Se,ve=await be.put(`/templates/update-rejected/${Y}`,{...ge,id:Y});J.success("Template submitted successfully"),console.log(" Rejected template updated and submitted:",ve?.data??ve);const Ie={...ye,currentTemplateId:null};localStorage.setItem("templateInfo",JSON.stringify(Ie)),localStorage.removeItem("currentTemplateId"),console.log(" Cleared currentTemplateId after submit"),setTimeout(()=>{h(je.TEMPLATES)},1500)}else{console.log(" Creating new template");const fe=await be.post("/templates",Se);J.success("Template submitted successfully"),console.log(" Backend response:",fe?.data??fe),setTimeout(()=>{h(je.TEMPLATES)},1500)}}catch(ye){console.error(" Submit template failed:",ye);const pe=ye.response?.data?.message||ye.message||"Unknown error";J.error(pe)}finally{he(!1)}},Fe=ye=>{const pe=ye.fieldName;if(!pe)return"";switch((ye.fieldType||"TEXT").toUpperCase()){case"TOGGLE":return`{#${pe}}{/`+pe+`} {^${pe}}{/`+pe+"}";case"PART":return`{#${pe}} {test_field} {/${pe}}`;case"IMAGE":case"SIGNATURE_DRAW":case"SIGNATURE_IMAGE":case"FINAL_SCORE_TEXT":case"FINAL_SCORE_NUM":case"VALUE_LIST":case"TEXT":default:return`{${pe}}`}},[Ye,Rt]=v.useState(!1),[Ot,vt]=v.useState(null),[ft,ht]=v.useState(null),[Nt,Dr]=v.useState(""),[ot,dt]=v.useState("TEXT"),[Yt,Qa]=v.useState(""),[ji,gn]=v.useState("TRAINER"),Gn=(ye,pe,_e)=>{ht(ye),vt(_e),Dr(""),dt("TEXT"),Qa(""),gn("TRAINER"),Rt(!0)},wi=()=>{if(!Yt||!Nt||!/^[a-z][a-z0-9_]*$/.test(Nt)){J.warning("Please enter label and snake_case field name, e.g., focus_item");return}if(!Ot?.fieldName){J.error("Invalid PART field");return}if(ft===null||ft<0||ft>=p.length){J.error("Invalid section");return}const _e=p[ft].fields||[];if(_e.some(nt=>nt.fieldName===Nt)){J.warning("Field name must be unique within section");return}const et={label:Yt,fieldName:Nt,fieldType:ot,roleRequired:ji,parentTempId:Ot?.tempId||Ot?.fieldName||null},He=[...p];if(He[ft].fields=[..._e,et],x(He),t){const nt=He.flatMap(jt=>jt.fields||[]);setTimeout(()=>{t(nt)},0)}let Ve=`{${Nt}}`;const bt=String(ot).toUpperCase();bt==="TOGGLE"?Ve=`{#${Nt}}{/${Nt}} {^${Nt}}{/${Nt}}`:bt==="IMAGE"&&(Ve=`{${Nt}}`);const cr=` ${Ve}`;setTimeout(()=>a(cr),0),Rt(!1),vt(null),ht(null),Dr(""),dt("TEXT"),Qa(""),gn("TRAINER")},Bs=(T!==null&&T<p.length?p[T]:null)?.editBy==="TRAINEE",Ns=[{value:"TEXT",label:"TEXT"},{value:"TOGGLE",label:"TOGGLE"},{value:"IMAGE",label:"IMAGE"},{value:"PART",label:"PART"},{value:"SIGNATURE_DRAW",label:"SIGNATURE_DRAW"},{value:"SIGNATURE_IMAGE",label:"SIGNATURE_IMAGE"},{value:"FINAL_SCORE_TEXT",label:"FINAL_SCORE_TEXT"},{value:"FINAL_SCORE_NUM",label:"FINAL_SCORE_NUM"},{value:"VALUE_LIST",label:"VALUE_LIST"}],qn=["SIGNATURE_IMAGE","FINAL_SCORE_NUM","FINAL_SCORE_TEXT"],en=Bs?Ns.filter(ye=>!qn.includes(ye.value)):Ns;return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
          .insert-field-btn {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
          }
          .insert-field-btn:hover:not(:disabled) {
            background-color: #007bff !important;
            border-color: #007bff !important;
            color: white !important;
          }
          .insert-field-btn:focus {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
          }
          /* Visual grouping for PART and its children */
          .bg-part { background-color: rgba(var(--bs-primary-rgb), .06); border-color: rgba(var(--bs-primary-rgb), .35) !important; }
          .part-badge { font-size: 0.65rem; background: var(--bs-primary); }
          .part-children { border-left: 3px dashed rgba(var(--bs-primary-rgb), .35); margin-left: .5rem; padding-left: .75rem; }
          .child-row { background: #ffffff; }
          .field-title { display: flex; align-items: center; gap: .5rem; }
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: .5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-neutral-200); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-toggle { color: var(--bs-primary); border-color: var(--bs-primary); background: rgba(var(--bs-primary-rgb), .08); }
          .section-toggle:hover { background: rgba(var(--bs-primary-rgb), .15); }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display:flex; align-items:center; gap:.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight:600; border:1px solid rgba(var(--bs-primary-rgb), .25); }
          .draggable-item { transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease; }
          .draggable-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background:#fff; }
          .drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
          .section-card { transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease; }
          .section-card.section-dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.15); transform: scale(.98); opacity: 0.7; }
          .section-card.section-drop-target-above { border-top: 4px solid var(--bs-primary) !important; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }
          .section-card.section-drop-target-below { border-bottom: 4px solid var(--bs-primary) !important; border-bottom-left-radius: 0.5rem; border-bottom-right-radius: 0.5rem; }
          .section-body.section-drop-target { 
            background-color: rgba(0, 123, 255, 0.05) !important; 
            border: 2px dashed var(--bs-primary) !important; 
            border-radius: 0.375rem;
          }
          .section-header.section-header-drop-target {
            background-color: rgba(0, 123, 255, 0.1) !important;
            border: 2px dashed var(--bs-primary) !important;
            border-radius: 0.375rem;
          }
        `}),s.jsxs("div",{className:`p-2 p-md-3 bg-light custom-fields-panel ${m}`,style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 mb-md-3 flex-wrap gap-2 flex-shrink-0",children:[s.jsx("h6",{className:"mb-0 text-muted custom-fields-title",style:{fontSize:"0.95rem"},children:"Available Custom Fields"}),s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:se,disabled:u,className:"custom-fields-add-section-btn",style:{whiteSpace:"nowrap",flexShrink:0},children:[s.jsx(Gr,{className:"me-1",size:14}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Section"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Section"})]})]}),s.jsx("div",{className:"flex-grow-1 custom-fields-content",style:{overflowY:"auto",overflowX:"hidden",minHeight:"0",flex:"1 1 auto"},children:s.jsx("div",{className:"d-grid gap-2 custom-fields-grid",children:p.length>0?p.map((ye,pe)=>s.jsxs(W,{className:`border section-card ${w.fromIndex===pe?"section-dragging":""} ${w.overIndex===pe?w.position==="above"?"section-drop-target-above":"section-drop-target-below":""}`,draggable:!u,onDragStart:_e=>{if(u){_e.preventDefault();return}S({fromIndex:pe,overIndex:pe,position:"above"}),_e.dataTransfer.effectAllowed="move"},onDragOver:_e=>{if(u||w.fromIndex===null||j.sectionIndex!==null)return;_e.preventDefault();const et=_e.currentTarget.getBoundingClientRect(),He=et.top+et.height/2,Ve=_e.clientY<He?"above":"below";let bt=pe;Ve==="below"&&w.fromIndex<pe?bt=pe+1:Ve==="above"&&w.fromIndex>pe?bt=pe:Ve==="below"&&w.fromIndex>pe?bt=pe+1:Ve==="above"&&w.fromIndex<pe&&(bt=pe),(w.overIndex!==bt||w.position!==Ve)&&S(cr=>({...cr,overIndex:bt,position:Ve}))},onDrop:_e=>{if(u||w.fromIndex===null||j.sectionIndex!==null)return;_e.preventDefault();const et=Math.max(0,Math.min(w.overIndex,p.length));ue(w.fromIndex,et),S({fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>{S({fromIndex:null,overIndex:null,position:"above"})},style:{cursor:u?"default":"grab"},children:[s.jsxs(W.Header,{className:`d-flex justify-content-between align-items-center section-header ${g[pe]&&j.sectionIndex!==null&&j.sectionIndex!==pe&&j.targetSectionIndex===pe?"section-header-drop-target":""}`,onClick:()=>K(pe),"aria-expanded":!g[pe],onDragStart:_e=>_e.stopPropagation(),onDragOver:_e=>{if(u||j.sectionIndex===null||j.sectionIndex===pe||!g[pe])return;const et=p[j.sectionIndex],He=p[pe];et.editBy===He.editBy&&(_e.preventDefault(),_e.stopPropagation(),j.targetSectionIndex!==pe&&y(Ve=>({...Ve,targetSectionIndex:pe,overIndex:ye.fields?.length||0,position:"below"})))},onDrop:_e=>{if(u||j.sectionIndex===null||j.fromIndex===null||j.sectionIndex===pe||!g[pe])return;const et=p[j.sectionIndex],He=p[pe];if(et.editBy!==He.editBy){J.warning('Cannot move fields between sections with different "Edit By" roles.'),y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null});return}_e.preventDefault(),_e.stopPropagation(),b(bt=>({...bt,[pe]:!1}));const Ve=ye.fields?.length||0;L(j.sectionIndex,j.fromIndex,pe,Ve),y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})},style:{padding:"0.75rem"},children:[s.jsxs("div",{className:"d-flex flex-column flex-grow-1",style:{minWidth:0,marginRight:"0.5rem"},children:[s.jsxs("div",{className:"section-title fw-bold d-flex align-items-center",style:{fontSize:"0.9rem"},children:[g[pe]?s.jsx(Xu,{size:16,className:"flex-shrink-0"}):s.jsx(ai,{size:16,className:"flex-shrink-0"}),s.jsx("span",{className:"text-truncate ms-1",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:ye.label,children:ye.label}),s.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge flex-shrink-0",children:ye.fields?.length||0})]}),s.jsxs("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:["Edit by: ",ye.editBy]})]}),s.jsxs("div",{onClick:_e=>_e.stopPropagation(),className:"flex-shrink-0 d-flex gap-1",children:[s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:()=>Qe(pe),disabled:u,className:"custom-fields-add-field-btn",style:{whiteSpace:"nowrap",fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[s.jsx(Gr,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Field"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Field"})]}),s.jsx(te,{variant:"outline-primary",size:"sm",onClick:()=>ae(pe),disabled:u,title:"Edit Section",className:"text-primary border-primary",style:{padding:"0.25rem 0.4rem"},children:s.jsx(Yr,{size:12})})]})]}),!g[pe]&&s.jsx(W.Body,{className:`section-body ${j.sectionIndex!==null&&j.sectionIndex!==pe&&j.targetSectionIndex===pe?"section-drop-target":""}`,onDragOver:_e=>{if(u||j.sectionIndex===null||j.sectionIndex===pe)return;const et=p[j.sectionIndex],He=p[pe];et.editBy===He.editBy&&(_e.preventDefault(),_e.stopPropagation(),j.targetSectionIndex!==pe&&y(Ve=>({...Ve,targetSectionIndex:pe,overIndex:ye.fields?.length||0,position:"below"})))},onDrop:_e=>{if(u||j.sectionIndex===null||j.fromIndex===null||j.sectionIndex===pe)return;const et=p[j.sectionIndex],He=p[pe];if(et.editBy!==He.editBy){J.warning('Cannot move fields between sections with different "Edit By" roles.'),y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null});return}_e.preventDefault(),_e.stopPropagation();const Ve=ye.fields?.length||0;L(j.sectionIndex,j.fromIndex,pe,Ve),y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})},style:{minHeight:j.sectionIndex!==null&&j.sectionIndex!==pe&&j.targetSectionIndex===pe?"60px":"auto",transition:"all 0.2s ease"},children:ye.fields&&ye.fields.length>0?(()=>{const _e=new Map;ye.fields.forEach((nt,jt)=>{_e.set(nt,jt)});const et=[...ye.fields].sort((nt,jt)=>nt.displayOrder-jt.displayOrder),He=nt=>nt?.tempId||nt?.fieldName||null,Ve=nt=>!!nt.parentTempId,bt=et.filter(nt=>!Ve(nt)),cr=(nt,jt)=>{const B=String(nt.fieldType).toUpperCase()==="PART";return s.jsxs("div",{className:`p-2 p-md-2 rounded border mb-2 mb-md-2 draggable-item custom-field-item ${B?"bg-part part-card":"bg-white child-row"} ${j.sectionIndex!==null&&j.targetSectionIndex===pe&&j.overIndex===jt?"border-primary":""} ${j.sectionIndex!==null&&j.targetSectionIndex===pe&&j.overIndex===jt&&j.position==="above"?"drop-target-above":""} ${j.sectionIndex!==null&&j.targetSectionIndex===pe&&j.overIndex===jt&&j.position==="below"?"drop-target-below":""} ${j.sectionIndex===pe&&j.fromIndex===jt?"dragging":""}`,draggable:!0,style:{display:"block",visibility:"visible",opacity:1,cursor:"grab"},onDragStart:X=>{y({sectionIndex:pe,fromIndex:jt,overIndex:jt,position:"above",targetSectionIndex:pe}),X.dataTransfer.effectAllowed="move"},onDragOver:X=>{X.preventDefault();const q=X.currentTarget.getBoundingClientRect(),Y=q.top+q.height/2,oe=X.clientY<Y?"above":"below";let le=jt;oe==="below"&&(le=jt+1),j.sectionIndex!==null&&(j.sectionIndex===pe?j.overIndex!==le||j.position!==oe:j.targetSectionIndex!==pe||j.overIndex!==le||j.position!==oe)&&y(fe=>({...fe,overIndex:le,position:oe,targetSectionIndex:pe}))},onDrop:X=>{if(X.preventDefault(),!(j.sectionIndex===null||j.fromIndex===null)){if(j.sectionIndex===pe){const q=Math.max(0,Math.min(j.overIndex,p[pe]?.fields?.length||0));G(pe,j.fromIndex,q)}else{const q=Math.max(0,Math.min(j.overIndex,p[pe]?.fields?.length||0));L(j.sectionIndex,j.fromIndex,pe,q)}y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null})}},onDragEnd:()=>y({sectionIndex:null,fromIndex:null,overIndex:null,position:"above",targetSectionIndex:null}),children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2 gap-2",children:[s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsxs("div",{className:"fw-bold field-title d-flex align-items-center flex-wrap gap-1",style:{fontSize:"0.85rem",wordBreak:"break-word"},children:[s.jsx("span",{className:"text-truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},title:nt.label,children:nt.label}),B&&s.jsx("span",{className:"badge part-badge flex-shrink-0",children:"PART"})]}),s.jsxs("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis"},title:`${nt.fieldName} (${nt.fieldType})${nt.roleRequired?` - ${nt.roleRequired}`:""}`,children:[nt.fieldName," (",nt.fieldType,")",nt.roleRequired?` - ${nt.roleRequired}`:""]})]}),s.jsxs("div",{className:"d-flex gap-1 flex-shrink-0",children:[s.jsx(te,{variant:"outline-primary",size:"sm",onClick:()=>Ht(pe,jt),disabled:u,title:"Edit Field",className:"text-primary border-primary",style:{padding:"0.25rem 0.4rem"},children:s.jsx(Yr,{size:12})}),s.jsx(te,{variant:"outline-danger",size:"sm",onClick:()=>{const X=[...p];if(X[pe].fields=X[pe].fields.filter((q,Y)=>Y!==jt),x(X),r){const q=X.flatMap(Y=>Y.fields||[]);r(q)}},disabled:u,title:"Remove Field",className:"text-danger border-danger",style:{padding:"0.25rem 0.4rem"},children:s.jsx(st,{size:12})})]})]}),s.jsxs("div",{className:"d-grid gap-1",children:[s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:()=>a(Fe(nt)),disabled:u,className:"d-flex align-items-center justify-content-center text-primary border-primary insert-field-btn",style:{transition:"all 0.2s ease-in-out",fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[s.jsx(t0,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Insert Field"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Insert"})]}),String(nt.fieldType).toUpperCase()==="PART"&&s.jsxs(te,{variant:"outline-primary",size:"sm",className:"mt-0 text-primary border-primary",onClick:()=>Gn(pe,jt,nt),disabled:u,style:{fontSize:"0.75rem",padding:"0.375rem 0.5rem"},children:[s.jsx(t0,{className:"me-1",size:12}),s.jsx("span",{className:"d-none d-sm-inline",children:"Add Field to PART"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Add to PART"})]})]}),String(nt.fieldType).toUpperCase()==="PART"&&(()=>{const X=He(nt),q=et.filter(Y=>Y.parentTempId===X);return q.length?s.jsx("div",{className:"mt-2 part-children",children:q.map(Y=>{const oe=_e.get(Y)??ye.fields.indexOf(Y);return cr(Y,oe)})}):null})()]},`${pe}-${jt}`)};return s.jsx(s.Fragment,{children:bt.map(nt=>{const jt=_e.get(nt)??ye.fields.indexOf(nt);return cr(nt,jt)})})})():s.jsx(De,{variant:"light",className:"mb-0",children:s.jsx("small",{children:'No fields in this section. Click "Add Field".'})})})]},pe)):s.jsx(De,{variant:"light",className:"mb-0",children:s.jsx("small",{children:'No sections yet. Click "Add Section" to start.'})})})}),s.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mt-2 mt-md-3 gap-2 flex-shrink-0",style:{borderTop:"1px solid #dee2e6",paddingTop:"0.75rem"},children:[s.jsxs(De,{variant:"info",className:"mb-0 custom-fields-tip",style:{fontSize:"0.75rem",padding:"0.5rem",flex:"1 1 auto",marginRight:"0.5rem"},children:[s.jsx("strong",{children:"Tip:"})," ",s.jsx("span",{className:"d-none d-sm-inline",children:"Create sections first, then add fields inside each section."}),s.jsx("span",{className:"d-inline d-sm-none",children:"Create sections, then add fields."})]}),s.jsx(te,{variant:"primary",size:"sm",onClick:Me,disabled:Ue,className:"custom-fields-submit-btn flex-shrink-0",style:{whiteSpace:"nowrap",fontSize:"0.8rem",padding:"0.375rem 0.75rem"},children:Ue?s.jsxs(s.Fragment,{children:[s.jsx(ct,{animation:"border",size:"sm",variant:"light",style:{width:"14px",height:"14px"}}),s.jsx("span",{children:"Submitting..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"d-none d-sm-inline",children:"Submit Template"}),s.jsx("span",{className:"d-inline d-sm-none",children:"Submit"})]})})]}),s.jsxs(ce,{show:E,onHide:gt,centered:!0,size:"lg",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:T!==null?"Edit Section":"Add New Section"})}),s.jsx(ce.Body,{children:s.jsx(k,{children:s.jsxs(de,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"Display label",value:_.label,onChange:ye=>C(pe=>({...pe,label:ye.target.value})),required:!0})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{className:"text-primary-custom",children:"Edit By"}),s.jsx(k.Select,{value:_.editBy,onChange:ye=>{const pe=ye.target.value;C(_e=>({..._e,editBy:pe,roleInSubject:pe==="TRAINEE"?"":_e.roleInSubject}))},children:R.map(ye=>s.jsx("option",{value:ye,children:ye},ye))})]})}),_.editBy==="TRAINER"&&s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{className:"text-primary-custom",children:"Role In Subject"}),s.jsxs(k.Select,{value:_.roleInSubject||"ASSESSMENT_REVIEWER",onChange:ye=>C(pe=>({...pe,roleInSubject:ye.target.value})),style:{minWidth:"200px"},children:[s.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT_REVIEWER"}),s.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),_.editBy==="TRAINER"&&s.jsx(H,{md:12,children:s.jsxs(k.Group,{className:"d-flex flex-row align-items-center gap-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(k.Check,{type:"checkbox",checked:_.isSubmittable,onChange:ye=>C(pe=>({...pe,isSubmittable:ye.target.checked})),id:"section-submittable"}),s.jsx(k.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(k.Check,{type:"checkbox",checked:_.isToggleDependent,onChange:ye=>C(pe=>({...pe,isToggleDependent:ye.target.checked})),id:"section-toggle-dependent"}),s.jsx(k.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),s.jsxs(ce.Footer,{children:[T!==null&&s.jsx(te,{variant:"outline-danger",onClick:We,className:"me-auto",children:"Remove Section"}),s.jsx(te,{variant:"outline-secondary",onClick:gt,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:Oe,children:T!==null?"Update Section":"Save Section"})]})]}),s.jsxs(ce,{show:U,onHide:gt,size:"lg",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Add New Field"})}),s.jsx(ce.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsx(k,{children:s.jsxs(de,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(De,{variant:"light",className:"py-2",children:["Adding field to section: ",s.jsx("strong",{children:T!==null?p[T]?.label:"N/A"})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"e.g., Crew Communication",value:ne.label,onChange:ye=>A(pe=>({...pe,label:ye.target.value})),required:!0}),s.jsx(k.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"e.g., crew_communication",value:ne.fieldName,onChange:ye=>A(pe=>({...pe,fieldName:ye.target.value})),required:!0}),s.jsxs(k.Text,{className:"text-muted",children:["The variable name used in the docxtemplate (e.g., ","{crew_communication}","). Must be unique within a template."]})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Select,{value:ne.fieldType,onChange:ye=>{const pe=ye.target.value;A(_e=>({..._e,fieldType:pe,option:pe==="VALUE_LIST"?_e.option:null})),pe!=="VALUE_LIST"&&(I([]),ie(""))},required:!0,children:en.map(ye=>s.jsx("option",{value:ye.value,children:ye.label},ye.value))})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Role Required ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",value:T!==null&&p[T]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),s.jsx(k.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),ne.fieldType==="VALUE_LIST"&&s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Options ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2 mb-2",children:[s.jsx(k.Control,{type:"text",placeholder:"Enter option value (e.g., Pass, Fail)",value:V,onChange:ye=>ie(ye.target.value),onKeyPress:ye=>{if(ye.key==="Enter"){ye.preventDefault();const pe=V.trim();if(pe){if(D.includes(pe)){J.warning("This option already exists. Please enter a different value.");return}I(_e=>[..._e,pe]),ie("")}}}}),s.jsx(te,{variant:"outline-primary",size:"sm",onClick:()=>{const ye=V.trim();if(ye){if(D.includes(ye)){J.warning("This option already exists. Please enter a different value.");return}I(pe=>[...pe,ye]),ie("")}},disabled:!V.trim(),children:s.jsx(Gr,{size:14})})]}),D.length>0&&s.jsx("div",{className:"d-flex flex-column gap-2 mb-2",style:{maxHeight:"200px",overflowY:"auto"},children:D.map((ye,pe)=>s.jsxs("div",{className:"d-flex align-items-center gap-2 p-2 border rounded",children:[s.jsx("span",{className:"flex-grow-1",children:ye}),s.jsx(te,{variant:"outline-danger",size:"sm",onClick:()=>{I(_e=>_e.filter((et,He)=>He!==pe))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(st,{size:12})})]},pe))}),s.jsx(k.Text,{className:"text-muted",children:"Add options one by one."})]})})]})})}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"outline-secondary",onClick:gt,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:rt,children:"Save Field"})]})]}),s.jsxs(ce,{show:ee,onHide:gt,size:"lg",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Edit Field"})}),s.jsx(ce.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsx(k,{children:s.jsxs(de,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"e.g., Crew Communication",value:ne.label,onChange:ye=>A(pe=>({...pe,label:ye.target.value})),required:!0}),s.jsx(k.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Select,{value:ne.fieldType,onChange:ye=>{const pe=ye.target.value;A(_e=>({..._e,fieldType:pe,option:pe==="VALUE_LIST"?_e.option:null})),pe!=="VALUE_LIST"&&(I([]),ie(""))},required:!0,children:en.map(ye=>s.jsx("option",{value:ye.value,children:ye.label},ye.value))})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Role Required ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",value:T!==null&&p[T]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),s.jsx(k.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:ne.fieldType==="PART"?"e.g., Assessment_Items":ne.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:ne.fieldName,onChange:ye=>A(pe=>({...pe,fieldName:ye.target.value})),required:!0}),s.jsx(k.Text,{className:"text-muted",children:ne.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':ne.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),ne.fieldType==="VALUE_LIST"&&s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Options ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs("div",{className:"d-flex gap-2 mb-2",children:[s.jsx(k.Control,{type:"text",placeholder:"Enter option value (e.g., Pass, Fail)",value:V,onChange:ye=>ie(ye.target.value),onKeyPress:ye=>{if(ye.key==="Enter"){ye.preventDefault();const pe=V.trim();if(pe){if(D.includes(pe)){J.warning("This option already exists. Please enter a different value.");return}I(_e=>[..._e,pe]),ie("")}}}}),s.jsx(te,{variant:"outline-primary",size:"sm",onClick:()=>{const ye=V.trim();if(ye){if(D.includes(ye)){J.warning("This option already exists. Please enter a different value.");return}I(pe=>[...pe,ye]),ie("")}},disabled:!V.trim(),children:s.jsx(Gr,{size:14})})]}),D.length>0&&s.jsx("div",{className:"d-flex flex-column gap-2 mb-2",style:{maxHeight:"200px",overflowY:"auto"},children:D.map((ye,pe)=>s.jsxs("div",{className:"d-flex align-items-center gap-2 p-2 border rounded",children:[s.jsx("span",{className:"flex-grow-1",children:ye}),s.jsx(te,{variant:"outline-danger",size:"sm",onClick:()=>{I(_e=>_e.filter((et,He)=>He!==pe))},style:{padding:"0.25rem 0.4rem"},children:s.jsx(st,{size:12})})]},pe))}),s.jsx(k.Text,{className:"text-muted",children:"Add options one by one."})]})})]})})}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"outline-secondary",onClick:gt,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:rt,children:"Update Field"})]})]}),s.jsxs(ce,{show:Ye,onHide:()=>Rt(!1),children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Insert Part Field"})}),s.jsx(ce.Body,{children:s.jsx(k,{children:s.jsxs(de,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(De,{variant:"light",className:"py-2",children:["Insert field into PART: ",s.jsxs("strong",{children:[Ot?.label," (",Ot?.fieldName,")"]})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"e.g., Focus Item",value:Yt,onChange:ye=>Qa(ye.target.value)})]})}),s.jsx(H,{md:8,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"e.g., focus_item",value:Nt,onChange:ye=>Dr(ye.target.value)}),s.jsx(k.Text,{className:"text-muted",children:"snake_case only"})]})}),s.jsx(H,{md:4,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{className:"text-primary-custom",children:"Type"}),s.jsxs(k.Select,{value:ot,onChange:ye=>dt(ye.target.value),children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"IMAGE",children:"IMAGE"})]})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{className:"text-primary-custom",children:"Role Required"}),s.jsx(k.Select,{value:ji,onChange:ye=>gn(ye.target.value),children:R.map(ye=>s.jsx("option",{value:ye,children:ye},ye))})]})}),s.jsx(H,{md:12,children:s.jsx(k.Text,{className:"text-muted",children:"Display order is assigned automatically by creation order."})})]})})}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"outline-secondary",onClick:()=>Rt(!1),children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:wi,children:"Insert"})]})]})]})]})},qh=`${Bo.BASE_URL}/media/docs/onlyoffice/callback`,Ble=v.forwardRef(({initialContent:e="",fileName:t="Untitled Document",readOnly:r=!1,showMergeFields:a=!0,importType:n="",className:i="",initialSections:o=null,onHasUnsavedChangesChange:l,onDraftSaved:c},d)=>{const[u,m]=v.useState(!0),[f,h]=v.useState(null),[p,x]=v.useState(!1),[g,b]=v.useState([]),[j]=v.useState(!0),[y,w]=v.useState(!1),[S,N]=v.useState(!1),E=v.useRef(!1),P=v.useRef(!1),T=v.useRef(null),O=v.useRef(null),_=v.useRef(null);v.useImperativeHandle(d,()=>({downloadAs:(he="docx")=>{if(T.current&&typeof T.current.downloadAs=="function")T.current.downloadAs(he);else throw new Error("Editor is not ready or downloadAs method is not available")},save:()=>{if(T.current&&typeof T.current.save=="function")T.current.save();else throw new Error("Editor is not ready or save method is not available")},saveAndDownload:async(he="docx")=>{if(!T.current)throw new Error("Editor is not ready");if(typeof T.current.save=="function"&&(console.log(" Step 1: Calling save() to save all changes..."),T.current.save(),await new Promise(Me=>setTimeout(Me,1e3)),console.log(" save() completed")),typeof T.current.downloadAs=="function")console.log(" Step 2: Calling downloadAs() to get document URL..."),T.current.downloadAs(he);else throw new Error("downloadAs method is not available")},buildAndSubmitDraftTemplate:async he=>{if(D.current&&typeof D.current.buildAndSubmitDraftTemplate=="function")return await D.current.buildAndSubmitDraftTemplate(he);throw new Error("buildAndSubmitDraftTemplate function is not available")}}),[]);const C=v.useRef(l),R=v.useRef(c);v.useEffect(()=>{C.current=l},[l]),v.useEffect(()=>{R.current=c},[c]),v.useEffect(()=>{E.current=y},[y]);const M=v.useRef(!1),U=v.useRef(null),Z=v.useRef(new Map);v.useEffect(()=>{const he=setTimeout(()=>{C.current&&C.current(y)},0);return()=>clearTimeout(he)},[y]);const[ee,re]=v.useState(!1),[z,me]=v.useState(null),[ne,A]=v.useState([]),D=v.useRef(null),[I,V]=v.useState([]),[ie,se]=v.useState(!1),ae=[{label:"Trainee's Full Name",variable:"{trainee_name}",fieldType:"TEXT"},{label:"Trainee's Eid",variable:"{trainee_eid}",fieldType:"TEXT"},{label:"Trainee's Nation",variable:"{trainee_nationality}",fieldType:"TEXT"},{label:"Trainee's Batch Name",variable:"{training_batch}",fieldType:"TEXT"},{label:"Course's Name",variable:"{course_name}",fieldType:"TEXT"},{label:"Course's Code",variable:"{course_code}",fieldType:"TEXT"},{label:"Subject's Name",variable:"{subject_name}",fieldType:"TEXT"},{label:"Subject's Code",variable:"{subject_code}",fieldType:"TEXT"},{label:"Assessing date",variable:"{assessment_date}",fieldType:"TEXT"},{label:"Assessment Location",variable:"{assessment_venue}",fieldType:"TEXT"},{label:"Instructor's Full Name",variable:"{trainer_name}",fieldType:"TEXT"},{label:"Trainer's Eid",variable:"{trainer_eid}",fieldType:"TEXT"},{label:"Template Name",variable:"{template_name}",fieldType:"TEXT"}];v.useEffect(()=>{let he=!0;return(async()=>{try{se(!0);const Fe=await Jl.getGlobalFields(),Ye=Fe?.data||Fe||[];he&&V(Ye)}catch(Fe){console.error("Error loading global mapped fields:",Fe),J.error("Failed to load global mapped fields")}finally{he&&se(!1)}})(),()=>{he=!1}},[]);const K=v.useCallback(()=>{if(P.current=!1,T.current)try{typeof T.current.destroy=="function"&&T.current.destroy()}catch(he){console.warn("Error destroying editor:",he)}},[]);v.useEffect(()=>{console.log(" initialContent changed:",e)},[e]);const G="bd9aaaaddaf94061b51e976a8fd335ce",ue=async he=>{try{const Fe=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Ye=btoa(JSON.stringify(he)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Rt=`${Fe}.${Ye}`,Ot=new TextEncoder,vt=await crypto.subtle.importKey("raw",Ot.encode(G),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),ft=await crypto.subtle.sign("HMAC",vt,Ot.encode(Rt)),ht=btoa(String.fromCharCode(...new Uint8Array(ft))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Nt=`${Fe}.${Ye}.${ht}`;return console.log(" Generated JWT Token (Hardcoded):",Nt),Nt}catch(Me){return console.error("Error generating JWT token:",Me),null}};v.useEffect(()=>{if(!e||e.trim()===""){console.log(" No content provided, setting loading to false"),m(!1);return}if(P.current){console.log(" Editor already initialized, skipping...");return}return P.current=!0,(async()=>{try{let Me=0;const Fe=10;await new Promise((ot,dt)=>{const Yt=()=>{typeof window.DocsAPI<"u"?ot():Me<Fe?(Me++,console.log(` Waiting for OnlyOffice API... (${Me}/${Fe})`),setTimeout(Yt,500)):dt(new Error("OnlyOffice API failed to load after 5 seconds"))};Yt()}),console.log(" OnlyOffice API loaded successfully"),console.log(" DocsAPI structure:",{DocsAPI:typeof window.DocsAPI,DocEditor:typeof window.DocsAPI?.DocEditor,hasEvents:typeof window.DocsAPI?.DocEditor?.prototype?.events});const Rt=`doc-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;_.current=Rt,console.log(" Generated documentKey for callback:",Rt);const vt=await ue({document:{key:Rt,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1},url:e},editorConfig:{mode:"edit",user:{id:"test-user",name:"Test User"},callbackUrl:qh}}),ft=!0;ft&&console.log(" Adding callbackUrl:",qh);const ht={document:{fileType:"docx",key:Rt,title:t,url:e,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1}},documentType:"word",editorConfig:{user:{id:"test-user",name:"Test User"},customization:{autosave:!1,forcesave:!0,comments:!1,help:!1,hideRightMenu:!1},callbackUrl:ft?qh:void 0,mode:"edit"},token:vt,events:{onAppReady:()=>{console.log(" OnlyOffice Document Editor is ready"),x(!0)},onDocumentReady:()=>{console.log(" Document is loaded"),w(!0),console.log(" Set hasUnsavedChanges = true (document ready, user can edit)")},onError:ot=>{console.error(" OnlyOffice Error:",ot),console.error(" Error details:",{errorCode:ot.data?.errorCode,errorDescription:ot.data?.errorDescription,error:ot.data?.error,fullEvent:ot}),J.error("Error loading document: "+(ot.data?.errorDescription||ot.data?.error||"Unknown error"))},onDocumentStateChange:ot=>{if(console.log(" Document state changed:",ot),console.log(" Event data:",ot.data),ot.data!==void 0&&ot.data!==null){const dt=ot.data;console.log(" Document state value:",dt),dt===1?(console.log(" Marking document as having unsaved changes"),w(!0)):(dt===0||dt===3)&&console.log(" Document state: ready/saved (state:",dt,")")}},onInfo:ot=>{console.log(" OnlyOffice opened in mode:",ot.data?.mode)},onDownloadAs:async ot=>{try{const dt=ot?.data||{};console.log(""),console.log(" OnlyOffice Event: onDownloadAs"),console.log(""),console.log(" Event data received:",JSON.stringify(dt,null,2));const Yt=dt.url||dt.downloadUrl||dt.fileUrl||(Array.isArray(dt.files)?dt.files[0]?.url:void 0)||dt.file&&dt.file.url;if(Yt){if(U.current){console.log(" This is a Submit flow - resolving Promise with URL");const Ks=_.current,Bs=Yt.match(/doc-([^_/]+)/),Ns=Bs?Bs[1]:null;if(Ks&&Ns){const en=Ks,ye=`doc-${Ns}`;en!==ye&&(console.log(" Warning: URL documentKey does not match current, but resolving anyway (resolver exists)"),console.log(`   Current: ${en}, URL: ${ye}`),console.log("   This can happen during hot reload - resolving anyway because resolver exists"))}const qn=U.current;U.current=null,qn.resolve(Yt),w(!1);return}if(M.current){console.log(" onDownloadAs event during Submit but no resolver - ignoring (likely from old instance)");return}try{const Ks=sessionStorage.getItem("onlyoffice_submitting")==="true",Bs=sessionStorage.getItem("onlyoffice_submit_docKey");if(Ks&&Bs){let Ns=null;const qn=Yt.match(/[?&]shardkey=([^&]+)/);if(qn)Ns=qn[1];else{const en=Yt.match(/doc-([^_/]+)/);en&&(Ns=`doc-${en[1]}`)}if(Ns&&Bs===Ns){console.log(" onDownloadAs: Ignoring Draft save - Submit in progress (sessionStorage check)"),console.log(`   Submit docKey: ${Bs}, URL docKey: ${Ns}`);return}}}catch(Ks){console.warn(" Error checking sessionStorage in onDownloadAs:",Ks)}const Qa=_.current,ji=Yt.match(/doc-([^_/]+)/),gn=ji?ji[1]:null;if(Qa&&gn){const Ks=Qa,Bs=`doc-${gn}`;if(Ks!==Bs){console.log(" onDownloadAs event ignored - URL from old documentKey instance (Draft flow)"),console.log(`   Current: ${Ks}, URL: ${Bs}`);return}}const Gn=Date.now(),wi=Z.current.get(Yt);if(wi&&Gn-wi<2e3){console.log(" Duplicate onDownloadAs event ignored (debounced):",Yt.substring(0,50)+"...");return}Z.current.set(Yt,Gn);for(const[Ks,Bs]of Z.current.entries())Gn-Bs>5e3&&Z.current.delete(Ks);console.log(" Download URL received:",Yt),console.log(" This is a Draft save - calling onDraftSaved callback"),R.current&&typeof R.current=="function"&&R.current(Yt),w(!1)}else if(console.warn(" onDownloadAs received but no URL found in payload"),M.current&&U.current){const Qa=U.current;U.current=null,Qa.reject(new Error("No URL found in onDownloadAs event"))}else M.current||J.warning("Draft saved but URL not found")}catch(dt){console.error(" Error in onDownloadAs handler:",dt),J.error("Error processing draft save")}},onRequestSaveAs:async ot=>{try{const dt=ot?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSaveAs"),console.log(""),console.log(" Event data received:",JSON.stringify(dt,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server"),w(!1);const Yt=dt.url||dt.downloadUrl||dt.fileUrl||(Array.isArray(dt.files)?dt.files[0]?.url:void 0)||dt.file&&dt.file.url;console.log(" Extracted temporary DOCX URL:",Yt),Yt||(console.warn(" onRequestSaveAs received but no URL found in payload"),console.warn(" Full event data:",JSON.stringify(dt,null,2))),O.current&&(Yt?O.current.resolve(Yt):O.current.reject(new Error("onRequestSaveAs event received but no URL found")),O.current=null),console.log("")}catch(dt){console.error(" Error in onRequestSaveAs handler:",dt),O.current&&(O.current.reject(dt),O.current=null)}},onRequestSave:ot=>{try{const dt=ot?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSave"),console.log(""),console.log(" Event data received:",JSON.stringify(dt,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server");const Yt=dt.url||dt.downloadUrl||dt.fileUrl;Yt&&O.current&&(console.log(" Using URL from onRequestSave:",Yt),O.current.resolve(Yt),O.current=null),console.log("")}catch(dt){console.error(" Error in onRequestSave handler:",dt)}}}},Nt=new window.DocsAPI.DocEditor("onlyoffice-editor",ht);h(Nt),T.current=Nt,m(!1);const Dr=ot=>{ot.data&&ot.data.type==="insertText"&&console.log(" Received insert text message:",ot.data)};return window.addEventListener("message",Dr,{passive:!0}),()=>{window.removeEventListener("message",Dr)}}catch(Me){console.error("Error initializing OnlyOffice editor:",Me),J.error("Failed to initialize editor"),m(!1)}})(),K},[e,t,K]);const L=he=>{if(f&&p)try{if(typeof f.createConnector=="function")try{const Me=f.createConnector();if(typeof f.asc_enableKeyEvents=="function")try{f.asc_enableKeyEvents(!0)}catch{}if(Me&&Me.isConnected)try{Asc.scope.__templateText=typeof he=="string"&&he.includes("{")?he:`{${he}}`,Me.callCommand(function(){try{const Fe=Api.GetDocument();let Ye=null;try{const Ot=Fe.GetCurrentSentence(),vt=Ot&&typeof Ot=="string"?Ot.trim():"";if(vt&&vt.length>0)try{const ft=Fe.Search(vt);if(ft&&ft.length>0&&ft.length<10){const ht=ft[0];try{const Nt=ht.GetParagraph(0);try{Ye=ht.GetTextPr()}catch{try{const Dr=Nt.GetElementsCount();if(Dr>0){const ot=Nt.GetElement(Dr-1);ot&&ot.GetTextPr&&(Ye=ot.GetTextPr())}}catch{}}}catch{}}}catch{}}catch{}const Rt=Api.CreateParagraph();if(Ye){const Ot=Api.CreateRun();Ot.AddText(Asc.scope.__templateText),Ot.SetTextPr(Ye),Rt.AddElement(Ot)}else{const Ot=Api.CreateTextPr();Ot.SetBold(!1);const vt=Api.CreateRun();vt.AddText(Asc.scope.__templateText),vt.SetTextPr(Ot),Rt.AddElement(vt)}Fe.InsertContent([Rt],!0)}catch{const Fe=Api.GetDocument(),Ye=Api.CreateParagraph();Ye.AddText(Asc.scope.__templateText),Fe.InsertContent([Ye],!0)}},function(){},function(Fe){console.error(" Insert field error:",Fe),J.error("Failed to insert field: "+(Fe?.message||"Unknown error"))});return}catch{J.error("Failed to insert field using OnlyOffice Automation API")}}catch{}}catch(Me){console.error("Error inserting field:",Me),J.error("Failed to insert field: "+Me.message)}else f?p||J.warning("Editor is still loading, please wait..."):J.warning("Editor not initialized yet")},Ne=v.useCallback(()=>_.current,[]),Oe=he=>{if(!he||!he.variable)return;const Me={...he,fieldType:he.fieldType||"TEXT",roleRequired:he.roleRequired||"TRAINER",options:he.options||null};if(me(Me),D.current&&typeof D.current.getSections=="function"){const Fe=D.current.getSections();Fe&&Fe.length>0?(A(Fe),re(!0)):J.warning("Please create a section first before adding system fields")}else J.warning("Custom Fields Panel is not ready. Please wait...")},We=he=>{if(!he)return;const Me=he.fieldName||he.name;if(!Me){J.warning("Global field is missing a field name");return}const Fe=Me.startsWith("{")&&Me.endsWith("}")?Me:`{${Me}}`,Ye={label:he.label||Me,variable:Fe,fieldType:he.fieldType||"TEXT",roleRequired:he.roleRequired||"TRAINER",options:he.options||null};Oe(Ye)},Qe=he=>{if(!(!z||he===null||he<0))if(D.current&&typeof D.current.addSystemField=="function"){const Me={label:z.label,fieldName:z.variable.replace(/[{}]/g,""),fieldType:z.fieldType||"TEXT",roleRequired:z.roleRequired||"TRAINER",displayOrder:1,...z.options?{options:z.options}:{}};D.current.addSystemField(he,Me)&&(re(!1),me(null))}else J.error("Failed to add field to section")},Pe=v.useCallback(async()=>{try{if(!T.current||!p)throw new Error("Editor not ready");const he=_.current;if(!he)throw new Error("Document key not found");M.current=!0;try{sessionStorage.setItem("onlyoffice_submitting","true"),sessionStorage.setItem("onlyoffice_submit_docKey",he),console.log(" Submit state saved to sessionStorage")}catch(Fe){console.warn(" Failed to set sessionStorage:",Fe)}if(console.log(" Starting callback flow (Submit)..."),console.log(` DocumentKey: ${he}`),console.log(` Callback URL: ${Bo.BASE_URL}/media/docs/onlyoffice/callback`),console.log(" Step 1: Saving all changes first (auto Ctrl+S)..."),typeof T.current.save=="function")try{T.current.save(),await new Promise(Fe=>setTimeout(Fe,2e3)),console.log(" All changes saved successfully")}catch(Fe){console.warn(" save() failed:",Fe)}console.log(" Step 2: Triggering downloadAs() and waiting for URL from event..."),U.current=null;const Me=new Promise((Fe,Ye)=>{U.current={resolve:Fe,reject:Ye},setTimeout(()=>{U.current&&(U.current.reject(new Error("Timeout waiting for download URL")),U.current=null)},15e3)});if(typeof T.current.downloadAs=="function")try{T.current.downloadAs("docx"),console.log(" downloadAs() triggered - waiting for URL from onDownloadAs event...")}catch(Fe){console.warn(" downloadAs() failed:",Fe),U.current&&(U.current.reject(new Error("Failed to trigger downloadAs()")),U.current=null),M.current=!1;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(Ye){console.warn(" Failed to clear sessionStorage:",Ye)}throw new Error("Failed to trigger downloadAs()")}else{U.current&&(U.current.reject(new Error("downloadAs method is not available")),U.current=null),M.current=!1;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(Fe){console.warn(" Failed to clear sessionStorage:",Fe)}throw new Error("downloadAs method is not available")}console.log(" Waiting for URL from onDownloadAs event...");try{const Fe=await Me;if(Fe){console.log(" URL received from onDownloadAs event:",Fe),w(!1),M.current=!1,U.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage")}catch(Ye){console.warn(" Failed to clear sessionStorage:",Ye)}return Fe}else{console.warn(" No URL received from onDownloadAs event"),J.warning("Could not get document URL"),M.current=!1,U.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey")}catch(Ye){console.warn(" Failed to clear sessionStorage:",Ye)}return null}}catch(Fe){console.error(" Error waiting for URL from onDownloadAs:",Fe),J.error(`Failed to get document URL: ${Fe.message}`),M.current=!1,U.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage (error)")}catch(Ye){console.warn(" Failed to clear sessionStorage:",Ye)}throw Fe}}catch(he){console.error(" Force save and poll failed:",he),J.error(`Failed: ${he.message}`),M.current=!1,U.current=null;try{sessionStorage.removeItem("onlyoffice_submitting"),sessionStorage.removeItem("onlyoffice_submit_docKey"),console.log(" Submit state cleared from sessionStorage (outer catch)")}catch(Me){console.warn(" Failed to clear sessionStorage:",Me)}throw he}},[p]),rt=v.useCallback(()=>new Promise((he,Me)=>{try{if(!T.current){Me(new Error("Editor not initialized"));return}if(O.current={resolve:he,reject:Me},typeof T.current.downloadDocument=="function"){console.log(" Attempting export via downloadDocument()...");try{T.current.downloadDocument()}catch(Fe){console.warn("downloadDocument() failed, trying downloadAs()...",Fe)}}if(typeof T.current.downloadAs=="function"){console.log(' Attempting export via downloadAs("docx")...');try{T.current.downloadAs("docx")}catch(Fe){console.warn("downloadAs() failed:",Fe)}}if(typeof T.current.save=="function"){console.log(" Attempting export via save()...");try{T.current.save()}catch(Fe){console.warn("save() failed:",Fe)}}setTimeout(()=>{if(O.current){const Fe=new Error("Export timeout: onRequestSaveAs not received after 20s. OnlyOffice Cloud may not support this method without callbackUrl.");O.current.reject(Fe),O.current=null}},2e4)}catch(Fe){O.current?(O.current.reject(Fe),O.current=null):Me(Fe)}}),[]),Ht=v.useCallback(async()=>{try{if(!T.current||!p)throw new Error("Editor not ready");const he=await rt();if(!he)throw new Error("No temporary URL received from OnlyOffice");console.log(" Got temp URL:",he);const Me=await fetch(he);if(!Me.ok)throw new Error(`Failed to fetch file: ${Me.statusText}`);const Fe=await Me.blob();console.log(" Downloaded blob:",Fe.size,"bytes");const Ye=t.endsWith(".docx")?t:`${t}.docx`,Rt=new File([Fe],Ye,{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),Ot=mn.getDocsType(Ye)||"tem",vt=await mn.uploadDocument(Rt,Ot);console.log(" Upload API response:",vt);let ft=null;if(vt?.data?.[0]?.url?(ft=vt.data[0].url,console.log(" Found S3 URL in uploadResult.data[0].url:",ft)):vt?.data?.url?(ft=vt.data.url,console.log(" Found S3 URL in uploadResult.data.url:",ft)):vt?.url?(ft=vt.url,console.log(" Found S3 URL in uploadResult.url:",ft)):vt?.fileUrl?(ft=vt.fileUrl,console.log(" Found S3 URL in uploadResult.fileUrl:",ft)):vt?.path&&(ft=vt.path,console.log(" Found S3 URL in uploadResult.path:",ft)),!ft)throw console.error(" Upload response structure:",JSON.stringify(vt,null,2)),new Error("No S3 URL returned from upload API");return console.log(" Final S3 URL to be used in templateContent:",ft),console.log(" Full S3 URL:",ft),ft}catch(he){throw console.error(" Export and upload failed:",he),J.error(`Failed: ${he.message}`),he}},[rt,t,p]);if(u)return s.jsx(W,{className:`border-neutral-200 shadow-sm ${i}`,children:s.jsx(W.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading OnlyOffice Editor..."}),s.jsx("small",{className:"text-muted",children:"Loading document from S3..."}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Content:"," ",e?"Available":"Not available"]})]})})});if(!e)return s.jsx(W,{className:`border-neutral-200 shadow-sm ${i}`,children:s.jsx(W.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:s.jsx("div",{className:"text-center",children:s.jsxs(De,{variant:"warning",children:[s.jsx("strong",{children:"No Document URL"}),s.jsx("br",{}),"Please upload a document first to use the editor."]})})})});const gt=he=>{Array.isArray(he)?b(he):b(Me=>[...Me,he])},Ue=he=>{b(Me=>Me.filter((Fe,Ye)=>Ye!==he))};return s.jsxs(s.Fragment,{children:[S&&s.jsx("div",{className:"loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(6px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,transition:"opacity 0.3s ease-in-out"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",variant:"primary",style:{width:"3rem",height:"3rem"}}),s.jsx("p",{className:"mt-3 mb-0 text-primary fw-semibold",style:{fontSize:"1.1rem"},children:"Submitting template..."})]})}),s.jsxs("div",{className:`onlyoffice-form-editor ${i}`,style:{position:"relative"},children:[s.jsx("div",{className:"p-0",children:s.jsxs(de,{className:"g-0",style:{minHeight:"90vh"},children:[s.jsx(H,{xs:12,md:a&&j?9:12,className:"editor-col",style:{order:1},children:s.jsxs("div",{className:"p-3 editor-wrapper",style:{height:"90vh",position:"relative"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-2 flex-wrap mb-2",children:[s.jsxs(St,{children:[s.jsx(St.Toggle,{variant:"outline-primary",size:"sm",id:"global-mapped-field-dropdown",disabled:ie,children:ie?"Loading Global Fields...":"Global Mapped Field"}),s.jsx(St.Menu,{style:{maxHeight:"400px",overflowY:"auto"},children:ie?s.jsx(St.ItemText,{className:"text-muted",children:"Loading..."}):I.length===0?s.jsx(St.ItemText,{className:"text-muted",children:"No global fields available"}):I.map(he=>s.jsx(St.Item,{onClick:()=>We(he),children:he.label||he.fieldName},he.id||he.fieldName))})]}),s.jsxs(St,{children:[s.jsx(St.Toggle,{variant:"outline-primary",size:"sm",id:"system-mapped-field-dropdown",children:"System Mapped Field"}),s.jsx(St.Menu,{style:{maxHeight:"400px",overflowY:"auto"},children:ae.map((he,Me)=>s.jsx(St.Item,{onClick:()=>Oe(he),children:he.label},`system-field-${Me}`))})]})]}),s.jsx("div",{id:"onlyoffice-editor",style:{width:"100%",height:"100%",border:"1px solid #ddd",borderRadius:"4px"}})]})}),a&&j&&s.jsx(H,{xs:12,md:3,className:"border-start border-md-start custom-fields-col",style:{order:2},children:s.jsx("div",{className:"custom-fields-wrapper",style:{height:"90vh",overflowY:"auto",overflowX:"hidden"},children:s.jsx(Mle,{customFields:g,onAddField:gt,onRemoveField:Ue,onInsertField:L,initialSections:o,exportEditedDoc:rt,exportAndUploadEditedDoc:Ht,forceSaveAndPoll:Pe,getDocumentKey:Ne,addSystemFieldToSectionRef:D,readOnly:r,className:"h-100",onSubmittingChange:N})})})]})}),s.jsxs(ce,{show:ee,onShow:()=>{if(D.current&&typeof D.current.getSections=="function"){const he=D.current.getSections();A(he||[])}},onHide:()=>{re(!1),me(null)},centered:!0,className:"system-field-modal",children:[s.jsx(ce.Header,{closeButton:!0,className:"bg-primary-custom text-white border-0",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:s.jsx(ce.Title,{className:"text-white mb-0",style:{fontSize:"1.25rem",fontWeight:600},children:"Select Section"})}),s.jsxs(ce.Body,{style:{padding:"1.5rem"},children:[z&&s.jsxs("div",{className:"mb-4 p-3 rounded",style:{backgroundColor:"var(--bs-light)",border:"1px solid var(--bs-neutral-200)"},children:[s.jsx("p",{className:"mb-1 text-primary-custom",style:{fontSize:"0.875rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Field to add:"}),s.jsx("p",{className:"mb-0",style:{fontSize:"1rem",fontWeight:500,color:"var(--bs-dark)"},children:z.label}),s.jsx("code",{className:"d-inline-block mt-1 px-2 py-1 rounded",style:{fontSize:"0.875rem",backgroundColor:"var(--bs-neutral-100)",color:"var(--bs-primary)",border:"1px solid var(--bs-neutral-300)"},children:z.variable})]}),s.jsx("p",{className:"mb-3",style:{fontSize:"0.95rem",color:"var(--bs-dark)",fontWeight:500},children:"Choose a section to add this field:"}),ne.length>0?s.jsx("div",{className:"d-grid gap-2",style:{maxHeight:"400px",overflowY:"auto"},children:ne.map((he,Me)=>s.jsx("button",{type:"button",className:"section-select-btn",onClick:()=>Qe(Me),style:{padding:"1rem 1.25rem",border:"2px solid var(--bs-neutral-200)",borderRadius:"0.5rem",backgroundColor:"var(--bs-light)",textAlign:"left",transition:"all 0.3s ease",cursor:"pointer",width:"100%"},onMouseEnter:Fe=>{Fe.currentTarget.style.borderColor="var(--bs-primary)",Fe.currentTarget.style.backgroundColor="rgba(27, 60, 83, 0.05)",Fe.currentTarget.style.transform="translateY(-2px)",Fe.currentTarget.style.boxShadow="0 4px 12px rgba(27, 60, 83, 0.15)"},onMouseLeave:Fe=>{Fe.currentTarget.style.borderColor="var(--bs-neutral-200)",Fe.currentTarget.style.backgroundColor="var(--bs-light)",Fe.currentTarget.style.transform="translateY(0)",Fe.currentTarget.style.boxShadow="none"},children:s.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{className:"mb-1",style:{fontSize:"1rem",fontWeight:600,color:"var(--bs-primary)"},children:he.label||he.name}),s.jsx("div",{className:"d-flex align-items-center gap-2 mt-2",style:{fontSize:"0.875rem"},children:s.jsx("span",{className:"badge rounded-pill px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",color:"white",fontSize:"0.75rem",fontWeight:500},children:he.editBy||"TRAINER"})})]}),s.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{minWidth:"60px",height:"60px",borderRadius:"0.375rem",backgroundColor:"var(--bs-primary)",color:"white",fontSize:"1.25rem",fontWeight:700},children:he.fields?.length||0})]})},Me))}):s.jsxs(De,{variant:"warning",className:"mb-0",style:{backgroundColor:"#fff3cd",borderColor:"#ffc107",color:"#856404",borderRadius:"0.5rem",padding:"1rem"},children:[s.jsx("strong",{children:"No sections available."})," Please create a section first."]})]}),s.jsx(ce.Footer,{className:"border-0",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)"},children:s.jsx(te,{variant:"secondary",onClick:()=>{re(!1),me(null)},style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},onMouseEnter:he=>{he.currentTarget.style.backgroundColor="#3a5a6f",he.currentTarget.style.borderColor="#3a5a6f",he.currentTarget.style.transform="translateY(-1px)",he.currentTarget.style.boxShadow="0 4px 8px rgba(69, 104, 130, 0.3)"},onMouseLeave:he=>{he.currentTarget.style.backgroundColor="var(--bs-secondary)",he.currentTarget.style.borderColor="var(--bs-secondary)",he.currentTarget.style.transform="translateY(0)",he.currentTarget.style.boxShadow="none"},children:"Cancel"})})]})]})]})}),zle=({onSuccess:e,className:t=""})=>{const[r,a]=v.useState(!1),[n,i]=v.useState(null),[o,l]=v.useState(!1),[c,d]=v.useState(!1),u=v.useRef(null),m=()=>{a(!0),i(null),u.current&&(u.current.value="")},f=()=>{a(!1),i(null),u.current&&(u.current.value="")},h=y=>{const w=y.target.files[0];if(w){const S=[".docx"],N=w.name.toLowerCase().substring(w.name.lastIndexOf("."));if(!S.includes(N)){J.error("Please select a valid Word document file (.docx)");return}if(w.size>10*1024*1024){J.error("File size must be less than 10MB");return}i(w)}},p=async y=>{try{d(!0),console.log(" Validating file has no fields:",y);const{data:w}=await be.post("/templates/extract-fields-from-url",{url:y}),S=w?.fields||w||[],N=Array.isArray(S)&&S.length>0;return console.log(" Validation result:",{hasFields:N,fieldCount:S.length}),!N}catch(w){return console.error(" Error validating file:",w),!1}finally{d(!1)}},x=async y=>{if(!y){console.log(" No mediaId provided, skipping delete");return}try{console.log(" Deleting old file with mediaId:",y),console.log(" Calling DELETE /media/objects with body:",{key:y});const w=await be.delete("/media/objects",{data:{key:y}});return console.log(" Old file deleted successfully!",w.data),!0}catch(w){return console.error(" Error deleting old file:",w),console.error(" Error response:",w.response?.data),!1}},g=async()=>{if(!n){J.error("Please select a file");return}l(!0);let y=null,w=null;try{const S=Qn(),N=S.templateContentMediaId;if(N){console.log(" Replacing existing template content, deleting old file...");const _=await x(N);console.log(_?" Old file deleted successfully before upload":" Failed to delete old file, but continuing with upload")}else console.log(" Adding new template content (no old file to delete)");console.log(" Uploading file to S3 for validation...");const E=mn.getDocsType(n.name),P=await mn.uploadDocument(n,E);if(P.data&&P.data.length>0)y=P.data[0].url,w=P.data[0].id||P.data[0].mediaId||null,console.log(" File uploaded successfully! URL:",y),w?console.log(" MediaId from response:",w):console.log(" No mediaId in response, will try to extract from URL if needed");else throw new Error("Invalid response format from upload API");if(console.log(" Validating file has no fields..."),!await p(y)){if(console.log(" File contains fields, deleting uploaded file..."),w){const _=await x(w);console.log(_?" Invalid file deleted successfully":" Failed to delete invalid file")}else console.log(" No mediaId to delete invalid file");J.error("File contains fields. Please upload a file without fields."),l(!1);return}console.log(" File validation passed! Saving to localStorage...");const O={...S,templateContent:y,templateContentMediaId:w};localStorage.setItem("templateInfo",JSON.stringify(O)),console.log(" templateContent saved:",y),w&&console.log(" templateContentMediaId saved:",w),J.success("Template content uploaded and validated successfully!"),e&&e(y),f()}catch(S){if(console.error(" Error uploading/validating file:",S),w){console.log(" Attempting to clean up uploaded file due to error...");try{await x(w),console.log(" Cleaned up uploaded file")}catch(N){console.error(" Failed to clean up uploaded file:",N)}}J.error("Failed to upload file: "+(S.message||"Unknown error"))}finally{l(!1)}},j=!!Qn().templateContent;return s.jsxs(s.Fragment,{children:[s.jsxs(te,{variant:"outline-light",size:"sm",onClick:m,className:`d-flex align-items-center gap-2 ${t}`,style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",whiteSpace:"nowrap"},onMouseEnter:y=>{y.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",y.currentTarget.style.borderColor="#fff"},onMouseLeave:y=>{y.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",y.currentTarget.style.borderColor="#fff"},title:j?"Original template already uploaded. Click to replace.":"Upload original template (file without fields)",children:[s.jsx(js,{size:16}),j?"Replace Original Template":"Original Template"]}),s.jsxs(ce,{show:r,onHide:f,centered:!0,size:"lg",children:[s.jsx(ce.Header,{className:"bg-primary-custom text-white border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(ni,{className:"me-2",size:20}),j?"Replace Original Template":"Original Template"]})}),s.jsxs(ce.Body,{className:"p-4",children:[s.jsxs(De,{variant:"info",className:"mb-4",children:[s.jsx("strong",{children:"Important:"})," Please upload a Word document (.docx) that does ",s.jsx("strong",{children:"not"})," contain any form fields. The system will automatically validate this before saving."]}),s.jsxs(k,{children:[s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Select File ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{ref:u,type:"file",accept:".docx",onChange:h,className:"mb-2"}),s.jsx(k.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]}),n&&s.jsx(De,{variant:"info",className:"mt-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ni,{className:"me-2",size:20}),s.jsxs("div",{children:[s.jsx("strong",{children:"Selected File:"})," ",n.name,s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["Size: ",(n.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsx(te,{variant:"outline-secondary",onClick:f,disabled:o||c,children:"Cancel"}),s.jsx(te,{variant:"primary-custom",onClick:g,disabled:!n||o||c,children:o||c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),c?"Validating...":"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(js,{className:"me-2",size:14}),j?"Replace":"Upload"]})})]})]})]})},$le=()=>{const e=tt(),t=ya(),[r,a]=v.useState(""),[n,i]=v.useState("Untitled Document"),[o,l]=v.useState(""),[c,d]=v.useState(null),[u,m]=v.useState(!1),[f,h]=v.useState({name:"",description:"",departmentId:""}),[p,x]=v.useState([]),[g,b]=v.useState(!1),[j,y]=v.useState(!1),[w,S]=v.useState(!1),[N,E]=v.useState(!1),[P,T]=v.useState(!1),O=v.useRef(null);v.useEffect(()=>{console.log(" hasUnsavedChanges changed:",j)},[j]);const[_,C]=v.useState(null),[R,M]=v.useState(!1);v.useEffect(()=>{(async()=>{if(t.state){const{content:I,documentUrl:V,fileName:ie,importType:se,templateInfo:ae,initialSections:K,isUpdateRejected:G,templateId:ue}=t.state;if(G&&ue){M(!0);try{console.log(` Update Rejected Template flow - Fetching data for templateId: ${ue}`);const L=await tr.getTemplateById(ue),Ne=L?.data?.template||L?.data?.data?.template||L?.data;if(!Ne){J.error("Failed to load rejected template data."),e(je.TEMPLATES);return}const Oe=Ne.templateConfig||Ne.templateContent||"",We={currentTemplateId:Ne.id,originalTemplateId:null,name:Ne.name,description:Ne.description,departmentId:Ne.departmentId,templateContent:Ne.templateContent,templateConfig:Ne.templateConfig,editorDocumentUrl:Oe};localStorage.setItem("templateInfo",JSON.stringify(We)),localStorage.setItem("currentTemplateId",Ne.id),console.log(" Fresh metadata for rejected template saved to localStorage:",We),a(Oe),i(We.name),l("Update Rejected Template"),d(We),h({name:We.name,description:We.description,departmentId:We.departmentId}),Ne.sections&&Array.isArray(Ne.sections)&&C(Ne.sections)}catch(L){console.error("Error handling update rejected flow:",L),J.error("An error occurred while loading the rejected template."),e(je.TEMPLATES)}}else{let L=V||I||"";ae?.editorDocumentUrl&&(L=ae.editorDocumentUrl),se==="Create Version"&&!L&&(L=ae?.templateConfig||ae?.templateContent||""),M(!1),a(L),i(ie||"Untitled Document"),l(se||""),d(ae||null),K&&Array.isArray(K)&&C(K),ae&&h({name:ae.name||"",description:ae.description||"",departmentId:ae.departmentId||""})}console.log(" FormEditorPage received:",{documentUrl:V,content:I,fileName:ie,templateInfo:ae,initialSections:K,isUpdateRejected:G,templateId:ue})}})()},[t.state,e]),v.useEffect(()=>{u&&U()},[u]);const U=async()=>{try{b(!0);const D=await Vt.getPublicDepartments();x(D)}catch(D){console.error("Error loading departments:",D),J.error("Failed to load departments"),x([])}finally{b(!1)}},Z=()=>{c&&h({name:c.name||"",description:c.description||"",departmentId:c.departmentId||""}),m(!0)},ee=()=>{m(!1)},re=()=>{if(!f.name||!f.description||!f.departmentId){J.error("Please fill in all required fields");return}const D={...c,name:f.name,description:f.description,departmentId:f.departmentId};d(D);try{const I=localStorage.getItem("templateInfo");if(I){const ie={...JSON.parse(I),name:f.name,description:f.description,departmentId:f.departmentId};localStorage.setItem("templateInfo",JSON.stringify(ie))}}catch(I){console.error("Error updating localStorage:",I)}J.success("Template information updated successfully"),m(!1)},z=()=>{console.log(" Back button clicked, hasUnsavedChanges:",j),j?(console.log(" Showing discard modal"),S(!0)):(console.log(" No unsaved changes, navigating back"),e(je.TEMPLATES))},me=()=>{S(!1),y(!1),e(je.TEMPLATES)},ne=()=>{S(!1)},A=async()=>{if(!O.current){J.warning("Editor is not ready yet. Please wait...");return}E(!0);try{typeof O.current.saveAndDownload=="function"?await O.current.saveAndDownload("docx"):(typeof O.current.save=="function"&&(console.log(" Step 1: Calling save() to save all changes..."),O.current.save(),await new Promise(D=>setTimeout(D,1e3))),typeof O.current.downloadAs=="function"&&(console.log(" Step 2: Calling downloadAs() to get document URL..."),O.current.downloadAs("docx")))}catch(D){console.error(" Error saving draft:",D),J.error("Failed to save draft: "+(D.message||"Unknown error")),E(!1)}};return s.jsx(yt,{permission:Te.CREATE_TEMPLATE,fallback:s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("h4",{children:"Access Denied"}),s.jsx("p",{children:"You don't have permission to edit form templates."})]})}),children:s.jsxs(Ce,{fluid:!0,className:"py-4 form-editor-page form-component",style:{position:"relative"},children:[N&&s.jsx("div",{className:"loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(6px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,transition:"opacity 0.3s ease-in-out"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",variant:"primary",style:{width:"3rem",height:"3rem"}}),s.jsx("p",{className:"mt-3 mb-0 text-primary fw-semibold",style:{fontSize:"1.1rem"},children:"Saving draft..."})]})}),s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"border-neutral-200 form-editor-header bg-primary",children:s.jsxs(de,{className:"align-items-center",children:[s.jsx(H,{xs:12,md:8,children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(te,{variant:"outline-light",onClick:z,className:"me-3",size:"sm",style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)"},onMouseEnter:D=>{D.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",D.currentTarget.style.borderColor="#fff"},onMouseLeave:D=>{D.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",D.currentTarget.style.borderColor="#fff"},children:s.jsx(At,{size:16})}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"mb-0 text-white",children:c?.name||n}),o&&s.jsxs("small",{className:"text-white",style:{opacity:.9},children:["Import Type: ",o]})]}),c&&s.jsx(te,{variant:"outline-light",size:"sm",onClick:Z,className:"ms-2",title:"Edit Template Information",children:s.jsx(Yr,{size:14})})]})]})}),s.jsxs(H,{xs:12,md:4,className:"d-flex justify-content-end align-items-center gap-2 mt-2 mt-md-0",children:[o==="File with fields"&&s.jsx(zle,{onSuccess:D=>{console.log(" Template content uploaded:",D)}}),!R&&s.jsx(te,{variant:"outline-light",size:"sm",onClick:A,disabled:N,className:"d-flex align-items-center gap-2",style:{borderWidth:"2px",fontWeight:"500",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",whiteSpace:"nowrap"},onMouseEnter:D=>{N||(D.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",D.currentTarget.style.borderColor="#fff")},onMouseLeave:D=>{N||(D.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",D.currentTarget.style.borderColor="#fff")},children:N?s.jsxs(s.Fragment,{children:[s.jsx(ct,{animation:"border",size:"sm",variant:"light",style:{width:"14px",height:"14px"}}),s.jsx("span",{children:"Saving..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{size:16}),s.jsx("span",{children:"Save Draft"})]})}),s.jsx(te,{variant:"outline-light",size:"sm",onClick:()=>T(!0),className:"d-flex align-items-center justify-content-center text-white",style:{borderWidth:"2px",fontWeight:"700",fontSize:"18px",backgroundColor:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px)",width:"36px",height:"36px",padding:0,color:"#ffffff !important",lineHeight:"1"},onMouseEnter:D=>{D.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",D.currentTarget.style.borderColor="#fff",D.currentTarget.style.color="#ffffff"},onMouseLeave:D=>{D.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",D.currentTarget.style.borderColor="#fff",D.currentTarget.style.color="#ffffff"},title:"System Syntax Guidance",children:"?"})]})]})}),s.jsx(W.Body,{className:"p-0",style:{position:"relative"},children:s.jsx(Ble,{ref:O,initialContent:r,fileName:n,showImportInfo:!!o,importType:o,initialSections:_,onHasUnsavedChangesChange:y,onDraftSaved:async D=>{try{console.log(" onDraftSaved called - checking sessionStorage...");const I=sessionStorage.getItem("onlyoffice_submitting")==="true",V=sessionStorage.getItem("onlyoffice_submit_docKey");if(console.log(" SessionStorage check:",{isSubmitting:I,submitDocKey:V,draftUrl:D.substring(0,100)+"..."}),I&&V){let ie=null;const se=D.match(/[?&]shardkey=([^&]+)/);if(se)ie=se[1],console.log(" Extracted docKey from shardkey:",ie);else{const ae=D.match(/doc-([^_/]+)/);ae&&(ie=`doc-${ae[1]}`,console.log(" Extracted docKey from path:",ie))}if(console.log(" Comparing:",{submitDocKey:V,urlDocKey:ie,match:ie&&V===ie}),ie&&V===ie){console.log(" Draft save ignored - Submit in progress"),console.log(`   Submit docKey: ${V}, URL docKey: ${ie}`),E(!1);return}else console.log(" Submit in progress but documentKey mismatch - treating as Draft anyway"),console.log(`   Submit docKey: ${V}, URL docKey: ${ie}`)}try{console.log(" Processing draft save - uploading to S3 and building template..."),O.current&&typeof O.current.buildAndSubmitDraftTemplate=="function"?(await O.current.buildAndSubmitDraftTemplate(D),console.log(" Draft template saved successfully!")):(console.warn(" buildAndSubmitDraftTemplate function not available"),J.warning("Draft URL saved but template not created"))}catch(ie){console.error(" Error building/submitting draft template:",ie),J.error("Failed to save draft template: "+(ie.message||"Unknown error"))}finally{E(!1)}}catch(I){console.error(" Error in onDraftSaved callback:",I),E(!1),J.error("Error processing draft save")}}})})]}),s.jsxs(ce,{show:w,onHide:ne,centered:!0,children:[s.jsx(ce.Header,{className:"bg-warning text-dark border-0",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:s.jsx(ce.Title,{className:"text-dark mb-0",style:{fontSize:"1.25rem",fontWeight:600},children:"Discard Changes?"})}),s.jsxs(ce.Body,{style:{padding:"1.5rem"},children:[s.jsx("p",{className:"mb-0",style:{fontSize:"1rem",color:"var(--bs-dark)"},children:"You have unsaved changes in the document. Are you sure you want to leave without saving?"}),s.jsx("p",{className:"mt-2 mb-0 text-muted",style:{fontSize:"0.875rem"},children:"All unsaved changes will be lost."})]}),s.jsxs(ce.Footer,{className:"border-0",style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--bs-neutral-200)"},children:[s.jsx(te,{variant:"secondary",onClick:ne,style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"white",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},children:"Cancel"}),s.jsx(te,{variant:"warning",onClick:me,style:{backgroundColor:"#ffc107",borderColor:"#ffc107",color:"#212529",fontWeight:500,padding:"0.5rem 1.5rem",borderRadius:"0.375rem",transition:"all 0.3s ease"},children:"Discard Changes"})]})]}),s.jsxs(ce,{show:u,onHide:ee,size:"lg",centered:!0,children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Yr,{className:"me-2",size:20}),"Edit Template Information"]}),s.jsx(te,{variant:"link",onClick:ee,className:"text-white text-decoration-none",style:{fontSize:"1.5rem",lineHeight:1},children:""})]}),s.jsx(ce.Body,{className:"p-4",children:s.jsx(k,{children:s.jsxs(de,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Template Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:f.name,onChange:D=>h(I=>({...I,name:D.target.value})),required:!0})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Description ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:f.description,onChange:D=>h(I=>({...I,description:D.target.value})),required:!0})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Department ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(k.Select,{value:f.departmentId,onChange:D=>h(I=>({...I,departmentId:D.target.value})),required:!0,disabled:g,children:[s.jsx("option",{value:"",children:"Select Department"}),p.map(D=>s.jsx("option",{value:D.id,children:D.name},D.id))]}),g&&s.jsx(k.Text,{className:"text-muted",children:"Loading departments..."})]})})]})})}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsx(te,{variant:"outline-secondary",onClick:ee,children:"Cancel"}),s.jsx(te,{variant:"primary-custom",onClick:re,disabled:!f.name||!f.description||!f.departmentId,children:"Save Changes"})]})]}),s.jsxs(ce,{show:P,onHide:()=>T(!1),size:"lg",centered:!0,className:"syntax-guide-modal",children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0",children:[s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(tS,{className:"me-2",size:20}),"System Syntax Guidance"]}),s.jsx(te,{variant:"link",onClick:()=>T(!1),className:"text-white text-decoration-none",style:{fontSize:"1.5rem",lineHeight:1},children:s.jsx(st,{size:24})})]}),s.jsx(ce.Body,{style:{padding:"1.5rem",maxHeight:"70vh",overflowY:"auto"},children:s.jsxs("div",{className:"syntax-guide-content",children:[s.jsxs("div",{className:"syntax-list mb-4",children:[s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Field:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{variable_name}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TEXT, VALUE_LIST, FINAL_SCORE_TEXT, FINAL_SCORE_NUM, SIGNATURE_DRAW, SIGNATURE_IMG"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Part:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{#Part_Name} {field1} {field2} {/PartName}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: PART"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Conditions:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{#isCondition} {true} {/isCondition}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TOGGLE, SECTION_CONTROL_TOGGLE"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Inverted Conditions:"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("code",{className:"syntax-pill",children:"{^isCondition} {false} {/isCondition}"}),s.jsx("div",{className:"data-type-info mt-1",children:"Data Types: TOGGLE, SECTION_CONTROL_TOGGLE"})]})]})}),s.jsx("div",{className:"syntax-item mb-3",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("strong",{className:"me-3",style:{minWidth:"120px",fontWeight:600,color:"#172B4D"},children:"Advanced Syntax:"}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("code",{className:"syntax-pill",children:"Operators: + - * % /"})})]})})]}),s.jsx("hr",{className:"my-4",style:{borderColor:"#dfe1e6"}}),s.jsx("h5",{className:"mb-3",style:{fontSize:"1.25rem",fontWeight:600,color:"#172B4D"},children:"Sections-Fields Rule"}),s.jsxs("ul",{className:"rule-list mb-4",style:{paddingLeft:"1.5rem",lineHeight:1.8},children:[s.jsx("li",{children:"Create a Section first, then you can create Fields belonging to that Section."}),s.jsx("li",{children:"You can drag the Section card to change the position of Sections."}),s.jsx("li",{children:"You can drag the Field card to change the position of Fields within the same or between Sections."})]}),s.jsx("h5",{className:"mb-3",style:{fontSize:"1.25rem",fontWeight:600,color:"#172B4D"},children:"Template Rule"}),s.jsxs("ul",{className:"rule-list",style:{paddingLeft:"1.5rem",lineHeight:1.8},children:[s.jsx("li",{children:"Placeholders in the Template must match the Available Fields (e.g., no Field in the Template that is not in Available Fields when submitting, and vice versa)."}),s.jsx("li",{children:'For the "Submittable" field of a Section for a TRAINER, it means only the person Assessing that Section later will be allowed to Submit the Assessment Form.'}),s.jsxs("li",{children:['For the "Toggle Dependent" field of a Section for a TRAINER:',s.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[s.jsx("li",{children:"It means the person Assessing this Section is allowed to skip Fields without filling them in."}),s.jsx("li",{children:"There must be exactly one Field with the Field Type SECTION_CONTROL_TOGGLE."})]})]}),s.jsx("li",{children:"A Field with the type FINAL_SCORE_TEXT or FINAL_SCORE_NUM must exist (serving the purpose of Assessing TRAINEE), and no more than two Fields with this same Field Type can exist."})]})]})}),s.jsx(ce.Footer,{className:"border-0",children:s.jsx(te,{variant:"primary-custom",onClick:()=>T(!1),style:{fontWeight:500,padding:"0.5rem 1.5rem"},children:"Got it"})})]})]})})},Ule=()=>{const e=tt(),{user:t}=zr(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null);v.useEffect(()=>{t?.id&&c()},[t?.id]);const c=async()=>{try{i(!0);const f=t?.id;if(!f){J.error("User ID not found"),a([]);return}const h=await tr.getTemplates({status:"DRAFT",createdByUserId:f});h.success&&h.data?a(h.data):Array.isArray(h)?a(h):h.data&&Array.isArray(h.data)?a(h.data):a([])}catch(f){console.error("Error loading drafts:",f),J.error("Failed to load drafts"),a([])}finally{i(!1)}},d=async f=>{try{console.log(" Opening draft:",f);const h=await tr.getTemplateById(f),p=h.data?.templateForm||h.data,x=h.data?.sections||[];if(!p){J.error("Template not found");return}console.log(" Template loaded:",p),console.log(" Sections loaded:",x);const g=M1(x);console.log(" Converted sections:",g);const b=p.templateConfig||p.templateContent;if(!b){J.error("Document URL not found");return}localStorage.setItem("templateInfo",JSON.stringify({id:p.id,currentTemplateId:p.id,name:p.name,description:p.description,departmentId:p.departmentId,templateContent:p.templateContent,templateConfig:p.templateConfig})),localStorage.setItem("currentTemplateId",p.id),console.log(" Restored templateInfo with currentTemplateId:",p.id),e(je.TEMPLATES_EDITOR,{state:{documentUrl:b,fileName:p.name,importType:"File without fields",templateInfo:{id:p.id,name:p.name,description:p.description,departmentId:p.departmentId,status:p.status},initialSections:g}}),J.success("Draft loaded successfully")}catch(h){console.error("Error opening draft:",h),J.error("Failed to load draft: "+(h.message||"Unknown error"))}},u=async(f,h)=>{try{l(f);const x=(await tr.deleteDraft(f))?.message||`Draft "${h}" deleted successfully`;J.success(x),a(g=>g.filter(b=>b.id!==f))}catch(p){const x=p?.response?.data?.message||p.message||"Failed to delete draft";J.error(x),console.error("Error deleting draft:",p)}finally{l(null)}},m=f=>{if(!f)return"N/A";try{return new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return f}};return s.jsx(Ce,{fluid:!0,className:"py-4 forms-page form-component",children:s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53",padding:"12px 16px"},children:s.jsx(de,{className:"align-items-center g-0",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center",style:{gap:"8px"},children:[s.jsx(te,{variant:"link",className:"text-white p-0",onClick:()=>e(je.TEMPLATES),style:{textDecoration:"none",margin:0,padding:"4px",minWidth:"auto"},children:s.jsx(At,{size:20})}),s.jsx(xt,{className:"text-white",size:24,style:{marginLeft:"4px"}}),s.jsx("h4",{className:"mb-0 text-white",style:{marginLeft:"8px"},children:"Your Drafts"})]})})})}),s.jsx(W.Body,{children:n?s.jsx(nr,{}):r.length===0?s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ni,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No drafts found"}),s.jsx("p",{className:"text-muted mb-4",children:"You haven't saved any drafts yet. Start creating a template to save drafts."}),s.jsx(te,{variant:"primary-custom",onClick:()=>e(je.TEMPLATES),children:"Go to Templates"})]})})}):s.jsx(de,{className:"g-3 g-md-4",children:r.map(f=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(W,{className:"h-100 border-0 shadow-sm template-card",style:{transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-5px)",h.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(W.Body,{className:"p-3 d-flex flex-column",style:{height:"100%"},children:[s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(xt,{size:20})}),s.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:f.name,children:f.name}),s.jsxs("small",{className:"text-muted",children:["v",f.version]})]})]}),s.jsx("div",{className:"mb-2",style:{height:"40px",overflow:"hidden"},children:s.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.4",height:"100%",margin:0},title:f.description||"No description",children:f.description||"No description"})}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Vs,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsx("small",{className:"text-muted text-truncate",style:{maxWidth:"100px"},title:f.department?.code||"N/A",children:f.department?.code||"N/A"})]}),s.jsx("div",{className:"flex-shrink-0 ms-2",children:s.jsxs(ke,{bg:"secondary",className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[s.jsx(Ke,{size:12}),"DRAFT"]})})]}),s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2 flex-wrap",style:{flexShrink:0,height:"24px"},children:[s.jsxs("div",{className:"d-flex align-items-center",style:{minWidth:0,flex:"1 1 auto"},children:[s.jsx(Pt,{size:12,className:"text-muted me-1 flex-shrink-0"}),s.jsxs("small",{className:"text-muted text-truncate",style:{maxWidth:"120px"},children:[f.createdByUser?.firstName," ",f.createdByUser?.lastName]})]}),s.jsx("small",{className:"text-muted flex-shrink-0 ms-2",children:m(f.createdAt)})]}),s.jsx("div",{className:"mt-auto pt-2 border-top",style:{flexShrink:0},children:s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(te,{variant:"primary",size:"sm",className:"flex-grow-1 d-flex align-items-center justify-content-center",onClick:()=>d(f.id),style:{backgroundColor:"#1b3c53",borderColor:"#1b3c53",color:"#fff",fontWeight:500},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="#153a4a",h.currentTarget.style.borderColor="#153a4a"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor="#1b3c53",h.currentTarget.style.borderColor="#1b3c53"},children:[s.jsx(Yr,{size:14,className:"me-2"}),"Edit"]}),s.jsx(te,{variant:"secondary",size:"sm",className:"d-flex align-items-center justify-content-center",onClick:()=>u(f.id,f.name),disabled:o===f.id,style:{minWidth:"44px",padding:"0.375rem 0.75rem",backgroundColor:"transparent",borderColor:"#6c757d",color:"#6c757d",border:"1px solid #6c757d !important",fontWeight:500,cursor:o===f.id?"not-allowed":"pointer",opacity:o===f.id?.6:1,transition:"all 0.25s ease"},onMouseEnter:h=>{o!==f.id&&(h.currentTarget.style.backgroundColor="#6c757d",h.currentTarget.style.color="#fff",h.currentTarget.style.borderColor="#6c757d",h.currentTarget.style.boxShadow="0 2px 8px rgba(108, 117, 125, 0.3)",h.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:h=>{h.currentTarget.style.backgroundColor="transparent",h.currentTarget.style.color="#6c757d",h.currentTarget.style.borderColor="#6c757d",h.currentTarget.style.boxShadow="none",h.currentTarget.style.transform="translateY(0)"},title:"Delete this draft",children:o===f.id?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm",style:{width:"14px",height:"14px",marginRight:"4px"}}),"Deleting"]}):" Delete"})]})})]})})},f.id))})})]})})},Wle=()=>{const e=tt(),t=[{id:"add-template",title:"Add New Template",description:"Create a new form template",icon:$x,path:`${je.TEMPLATES}?action=create`,permission:Te.CREATE_TEMPLATE,color:"primary",action:()=>{e(`${je.TEMPLATES}?action=create`)}},{id:"add-department",title:"Add New Department",description:"Create a new department",icon:Vs,path:je.DEPARTMENTS,permission:Te.CREATE_DEPARTMENT,color:"primary",action:()=>{e(je.DEPARTMENTS)}},{id:"bulk-import-user",title:"Bulk Import User",description:"Import multiple users from Excel file",icon:js,path:`${je.USERS}?action=bulk-import`,permission:Te.BULK_CREATE_USERS,color:"primary",action:()=>{e(`${je.USERS}?action=bulk-import`)}}];return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsx(Ce,{className:"py-4",children:s.jsx(de,{className:"mb-4",children:s.jsx(H,{lg:12,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(W.Body,{children:s.jsx(de,{children:t.map((r,a)=>{const n=r.icon;return s.jsx(yt,{permission:r.permission,fallback:null,children:s.jsx(H,{md:4,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:r.action,children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(n,{size:24,className:`text-${r.color} me-2`}),s.jsx("h6",{className:"mb-0",children:r.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),s.jsx(un,{size:16,className:`text-${r.color} ms-auto`})]})},a)},r.id)})})})]})})})})})},Hle=({field:e,onViewDetail:t,onEdit:r})=>{const{hasPermission:a}=Fn(),n=[{label:"View Detail",icon:s.jsx(xt,{size:16}),onClick:()=>t(e),permission:Te.VIEW_GLOBAL_FIELD_IN_DETAIL},{label:"Edit Global Field",icon:s.jsx(Yr,{size:16}),onClick:()=>r(e),permission:Te.UPDATE_GLOBAL_FIELD}].filter(i=>!i.permission||a(i.permission));return s.jsx(W,{className:"h-100 border-0 shadow-sm",style:{transition:"all 0.3s ease"},onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(W.Body,{className:"p-3 d-flex flex-column position-relative",children:[s.jsx("div",{className:"position-absolute",style:{top:"0.5rem",right:"0.5rem",zIndex:10},children:s.jsx(yt,{permissions:[Te.VIEW_GLOBAL_FIELD_IN_DETAIL,Te.UPDATE_GLOBAL_FIELD],fallback:null,children:s.jsx(Rr,{align:"end",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:n})})}),s.jsxs("div",{className:"d-flex align-items-start mb-2",style:{height:"60px",flexShrink:0,paddingRight:"2rem"},children:[s.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2 flex-shrink-0",style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(xt,{size:20})}),s.jsx("div",{className:"flex-grow-1",style:{minWidth:0},children:s.jsx("h6",{className:"mb-1 fw-bold",style:{fontSize:"0.95rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:"1.3"},title:e.label,children:e.label})})]}),s.jsxs("div",{className:"mb-2",style:{flexShrink:0},children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Field Name:"}),s.jsx("code",{className:"text-dark d-block",style:{fontSize:"0.85rem",wordBreak:"break-word",backgroundColor:"var(--bs-neutral-200)",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},children:e.fieldName})]}),e.roleRequired&&s.jsxs("div",{className:"mt-auto",style:{flexShrink:0},children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Role Required:"}),s.jsx("span",{className:"badge bg-secondary",children:e.roleRequired})]})]})})},Vle=({show:e,onHide:t,field:r})=>{if(!r)return null;const a=i=>{if(!i)return"N/A";try{return new Date(i).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return i}},n=i=>{const l={TEXT:{variant:"primary",text:"TEXT"},NUMBER:{variant:"info",text:"NUMBER"},DATE:{variant:"success",text:"DATE"},SELECT:{variant:"warning",text:"SELECT"},CHECKBOX:{variant:"secondary",text:"CHECKBOX"}}[i]||{variant:"secondary",text:i||"N/A"};return s.jsx(ke,{bg:l.variant,className:"px-2 py-1",children:l.text})};return s.jsxs(ce,{show:e,onHide:t,size:"md",centered:!0,fullscreen:"md-down",children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0 d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[s.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(xt,{className:"me-2",size:20}),s.jsx("span",{children:"Global Field Detail"})]}),s.jsx("button",{onClick:t,className:"btn btn-link text-white p-0",style:{border:"none",background:"none",opacity:.9},children:s.jsx(st,{size:24})})]}),s.jsx(ce.Body,{style:{padding:"1.5rem",maxHeight:"60vh",overflowY:"auto"},children:s.jsxs(_a,{variant:"flush",children:[s.jsx(_a.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Label"}),s.jsx("span",{className:"text-dark fw-medium",children:r.label||"N/A"})]})]})}),s.jsx(_a.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Field Name"}),s.jsx("code",{className:"text-dark",style:{fontSize:"0.9rem",backgroundColor:"var(--bs-neutral-200)",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},children:r.fieldName||"N/A"})]})]})}),s.jsx(_a.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Field Type"}),s.jsx("div",{children:n(r.fieldType)})]})]})}),r.roleRequired&&s.jsx(_a.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Role Required"}),s.jsx(ke,{bg:"secondary",children:r.roleRequired})]})]})}),r.options&&s.jsx(_a.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(xt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Options"}),s.jsx("span",{className:"text-dark",children:JSON.stringify(r.options)})]})]})}),r.createdBy&&s.jsx(_a.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(Pt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created By"}),s.jsxs("span",{className:"text-dark",children:[r.createdBy.firstName," ",r.createdBy.lastName]})]})]})}),r.createdAt&&s.jsx(_a.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(or,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Created At"}),s.jsx("span",{className:"text-dark",children:a(r.createdAt)})]})]})}),r.updatedBy&&s.jsx(_a.Item,{className:"px-0 py-3 border-bottom",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(Pt,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Updated By"}),s.jsxs("span",{className:"text-dark",children:[r.updatedBy.firstName," ",r.updatedBy.lastName]})]})]})}),r.updatedAt&&s.jsx(_a.Item,{className:"px-0 py-3",children:s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(Ke,{className:"text-primary-custom me-3",size:20}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"text-muted small d-block mb-1",children:"Updated At"}),s.jsx("span",{className:"text-dark",children:a(r.updatedAt)})]})]})})]})}),s.jsx(ce.Footer,{className:"bg-light border-0",children:s.jsx("button",{onClick:t,className:"btn btn-secondary",style:{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#ffffff"},children:"Close"})})]})},Gle=({show:e,onHide:t,field:r,onSuccess:a})=>{const[n,i]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),[o,l]=v.useState({}),[c,d]=v.useState(!1);v.useEffect(()=>{r&&e&&(i({label:r.label||"",fieldName:r.fieldName||"",fieldType:r.fieldType||"TEXT",roleRequired:r.roleRequired||"",options:r.options||null}),l({}))},[r,e]);const u=p=>{const{name:x,value:g}=p.target;i(b=>({...b,[x]:g})),o[x]&&l(b=>({...b,[x]:""}))},m=()=>{const p={};return n.label.trim()||(p.label="Label is required"),n.fieldName.trim()||(p.fieldName="Field Name is required"),n.fieldType||(p.fieldType="Field Type is required"),l(p),Object.keys(p).length===0},f=async p=>{if(p.preventDefault(),!!m())try{d(!0);const x={label:n.label.trim(),fieldName:n.fieldName.trim(),fieldType:n.fieldType,roleRequired:n.roleRequired||null,options:n.options||null};await Jl.updateGlobalField(r.id,x),J.success("Global field updated successfully"),a&&a(),t()}catch(x){console.error("Error updating global field:",x);const g=x.response?.data?.message||x.message||"Failed to update global field";J.error(g)}finally{d(!1)}},h=()=>{i({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),l({}),t()};return s.jsxs(ce,{show:e,onHide:h,size:"lg",centered:!0,fullscreen:"md-down",children:[s.jsxs(ce.Header,{className:"bg-primary-custom text-white border-0 d-flex align-items-center justify-content-between",style:{borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",padding:"1.25rem 1.5rem"},children:[s.jsxs(ce.Title,{className:"d-flex align-items-center text-white mb-0",children:[s.jsx(us,{className:"me-2",size:20}),s.jsx("span",{children:"Edit Global Field"})]}),s.jsx("button",{onClick:h,className:"btn btn-link text-white p-0",style:{border:"none",background:"none",opacity:.9},children:s.jsx(st,{size:24})})]}),s.jsxs(k,{onSubmit:f,children:[s.jsxs(ce.Body,{style:{padding:"1.5rem"},children:[s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-medium",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",name:"label",value:n.label,onChange:u,isInvalid:!!o.label,placeholder:"Enter field label"}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.label})]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-medium",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",name:"fieldName",value:n.fieldName,onChange:u,isInvalid:!!o.fieldName,placeholder:"Enter field name (e.g., template_name)"}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.fieldName})]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{className:"fw-medium",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(k.Select,{name:"fieldType",value:n.fieldType,onChange:u,isInvalid:!!o.fieldType,children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"PART",children:"PART"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),s.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]}),s.jsx(k.Control.Feedback,{type:"invalid",children:o.fieldType})]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{className:"fw-medium",children:"Role Required"}),s.jsxs(k.Select,{name:"roleRequired",value:n.roleRequired||"",onChange:u,children:[s.jsx("option",{value:"",children:"None"}),s.jsx("option",{value:"TRAINER",children:"TRAINER"}),s.jsx("option",{value:"TRAINEE",children:"TRAINEE"})]})]})]}),s.jsxs(ce.Footer,{className:"bg-light border-0 d-flex flex-wrap gap-2",style:{justifyContent:"flex-end"},children:[s.jsx(te,{variant:"secondary",onClick:h,disabled:c,children:"Cancel"}),s.jsx(te,{variant:"primary",type:"submit",disabled:c,className:"d-flex align-items-center",children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{className:"me-2",size:16}),"Update Global Field"]})})]})]})]})},qle=({show:e,onHide:t,onSuccess:r})=>{const[a,n]=v.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),[i,o]=v.useState(!1),l=(u,m)=>{if(!u)return{valid:!1,message:"Field name is required"};const f=String(m||"").toUpperCase();return f==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(u)?u.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:f==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(u)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(u)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},c=async()=>{if(!a.label||!a.fieldName||!a.roleRequired){J.warning("Please fill in all required fields");return}const u=l(a.fieldName,a.fieldType);if(!u.valid){J.warning(u.message);return}try{o(!0);const m={label:a.label.trim(),fieldName:a.fieldName.trim(),fieldType:a.fieldType,roleRequired:a.roleRequired||null,options:a.options||null};await Jl.createGlobalField(m),J.success("Global field created successfully"),r&&r(),d()}catch(m){console.error("Error creating global field:",m);const f=m.response?.data?.message||m.message||"Failed to create global field";J.error(f)}finally{o(!1)}},d=()=>{n({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"",options:null}),t()};return s.jsxs(ce,{show:e,onHide:d,size:"lg",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Create Global Field"})}),s.jsx(ce.Body,{children:s.jsx(k,{children:s.jsxs(de,{className:"g-3",children:[s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:"e.g., Crew Communication",value:a.label,onChange:u=>n(m=>({...m,label:u.target.value})),required:!0}),s.jsx(k.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),s.jsx(H,{md:12,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Field Name ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{type:"text",placeholder:a.fieldType==="PART"?"e.g., Assessment_Items":a.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:a.fieldName,onChange:u=>n(m=>({...m,fieldName:u.target.value})),required:!0}),s.jsx(k.Text,{className:"text-muted",children:a.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':a.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Field Type ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(k.Select,{value:a.fieldType,onChange:u=>n(m=>({...m,fieldType:u.target.value})),required:!0,children:[s.jsx("option",{value:"TEXT",children:"TEXT"}),s.jsx("option",{value:"PART",children:"PART"}),s.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),s.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),s.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{children:[s.jsxs(k.Label,{className:"text-primary-custom",children:["Role Required ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsxs(k.Select,{value:a.roleRequired,onChange:u=>n(m=>({...m,roleRequired:u.target.value})),required:!0,children:[s.jsx("option",{value:"",children:"Select role"}),s.jsx("option",{value:"TRAINER",children:"TRAINER"}),s.jsx("option",{value:"TRAINEE",children:"TRAINEE"})]})]})})]})})}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"outline-secondary",onClick:d,disabled:i,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:c,disabled:i,children:"Save Field"})]})]})},Kle=()=>{const[e,t]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(null),[o,l]=v.useState(!1),[c,d]=v.useState(!1),[u,m]=v.useState(!1),[f,h]=v.useState(null),[p,x]=v.useState(null),g=v.useCallback(async()=>{try{a(!0),i(null);const T=await Jl.getGlobalFields(),O=T?.data||T||[];t(O)}catch(T){console.error("Error loading global fields:",T),i(T.response?.data?.message||T.message||"Failed to load global fields"),J.error("Failed to load global fields"),t([])}finally{a(!1)}},[]);v.useEffect(()=>{g()},[g]);const b=async T=>{try{h(T);const O=await Jl.getGlobalFieldDetail(T.id),_=O?.data||O||T;x(_),l(!0)}catch(O){console.error("Error loading field detail:",O),J.error("Failed to load field details"),x(T),l(!0)}},j=T=>{h(T),d(!0)},y=()=>{l(!1),x(null),h(null)},w=()=>{d(!1),h(null)},S=()=>{g()},N=()=>{g()},E=()=>{m(!0)},P=()=>{m(!1)};return r?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary-custom text-white",children:s.jsx("h4",{className:"mb-0",children:"Global Field List"})}),s.jsx(W.Body,{children:s.jsx(nr,{})})]})}):n?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary-custom text-white",children:s.jsx("h4",{className:"mb-0",children:"Global Field List"})}),s.jsx(W.Body,{children:s.jsxs("div",{className:"alert alert-danger",children:[s.jsx("strong",{children:"Error:"})," ",n]})})]})}):s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary-custom text-white",style:{backgroundColor:"#1b3c53",borderBottom:"none"},children:s.jsxs(de,{className:"align-items-center",children:[s.jsx(H,{children:s.jsx("h4",{className:"mb-0 text-white",children:"Global Field List"})}),s.jsx(H,{xs:"auto",className:"ms-auto",children:s.jsx(yt,{permission:Te.CREATE_GLOBAL_FIELD,fallback:null,children:s.jsxs(te,{variant:"light",onClick:E,className:"d-flex align-items-center",size:"sm",style:{backgroundColor:"#ffffff",borderColor:"#dee2e6",color:"#000000",fontWeight:500},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#f8f9fa",T.currentTarget.style.borderColor="#dee2e6"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="#ffffff",T.currentTarget.style.borderColor="#dee2e6"},children:[s.jsx(Gr,{className:"me-2",size:16}),s.jsx("span",{className:"d-none d-sm-inline",children:"Create Global Field"}),s.jsx("span",{className:"d-sm-none",children:"Create"})]})})})]})}),s.jsx(W.Body,{children:e.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsx("p",{className:"text-muted",children:"No global fields found"})}):s.jsx(de,{className:"g-3 g-md-4",children:e.map(T=>s.jsx(H,{xs:12,sm:6,md:6,lg:4,xl:3,children:s.jsx(Hle,{field:T,onViewDetail:b,onEdit:j})},T.id))})})]}),s.jsx(Vle,{show:o,onHide:y,field:p}),s.jsx(Gle,{show:c,onHide:w,field:f,onSuccess:S}),s.jsx(qle,{show:u,onHide:P,onSuccess:N})]})},Yle=({traineeId:e})=>{const{user:t}=zr(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState("course"),[u,m]=v.useState(null),[f,h]=v.useState(!1),[p,x]=v.useState(null),[g,b]=v.useState(!1),{sortedData:j,sortConfig:y,handleSort:w}=_r(r),S=v.useCallback(async()=>{try{i(!0),l(null);const C={};try{const ee=await Nr.getCourses();(ee?.courses||ee?.data||[]).forEach(z=>{z.id&&(C[z.id]=z.name||z.code||"Unknown Course")})}catch(ee){console.error("Error loading courses map:",ee)}const M=(await Jr.getTraineeCourseSubjects(t?.id||e))?.courses||[];if(!Array.isArray(M)||M.length===0){a([]),i(!1);return}const U=[],Z=["SIGNATURE_PENDING","READY_TO_SUBMIT"];if(c==="course")for(const ee of M){const re=ee.course;if(re?.id)try{((await Sr.getCourseAssessments(re.id))?.assessments||[]).filter(ne=>Z.includes(ne.status)).forEach(ne=>{U.push({...ne,courseId:re.id,courseName:C[re.id]||re.name||re.code||"Unknown Course"})})}catch(z){console.error(`Error loading assessments for course ${re.id}:`,z)}}else for(const ee of M){const re=ee.subjects||[];for(const z of re)if(z?.id)try{((await Sr.getSubjectAssessments(z.id))?.assessments||[]).filter(A=>Z.includes(A.status)).forEach(A=>{const D=A.courseId||ee.course?.id;U.push({...A,courseId:D,courseName:C[D]||ee.course?.name||ee.course?.code||"Unknown Course"})})}catch(me){console.error(`Error loading assessments for subject ${z.id}:`,me)}}a(U)}catch(C){console.error("Error loading assessments:",C),l(C.message||"Failed to load assessments"),J.error("Failed to load signature required assessments"),a([])}finally{i(!1)}},[t?.id,e,c]);v.useEffect(()=>{(t?.id||e)&&S()},[t?.id,e,c,S]);const N=C=>{d(C)},E=C=>{m(C),h(!0),x(null)},P=C=>{x(C)},T=C=>new Promise(R=>{const M=new Image;M.onload=()=>{const U=document.createElement("canvas");U.width=87,U.height=60,U.getContext("2d").drawImage(M,0,0,87,60),R(U.toDataURL("image/png"))},M.src=C}),O=async()=>{if(!p||!u){J.error("Please draw your signature first");return}b(!0);try{const C=await T(p),M=await(await fetch(C)).blob(),U=new File([M],`signature-${Date.now()}.png`,{type:"image/png"}),Z=await mn.uploadImage(U,"signature");let ee="";if(typeof Z=="string"?ee=Z:Z?.url?ee=Z.url:Z?.data?.[0]?.url&&(ee=Z.data[0].url),!ee)throw new Error("Failed to get signature URL from upload response");console.log(" Signature uploaded to S3:",ee);const z=(await Sr.confirmParticipation(u,{traineeSignatureUrl:ee}))?.message||"Signature submitted successfully";J.success(z),h(!1),m(null),x(null),setTimeout(()=>{S()},500)}catch(C){console.error("Error submitting signature:",C);const R=C.response?.data?.message||C.message||"Failed to submit signature";J.error(R)}finally{b(!1)}},_=()=>{h(!1),m(null),x(null)};return n?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(W,{className:"shadow-sm",children:s.jsxs(W.Body,{className:"text-center py-4",children:[s.jsx(ct,{animation:"border",variant:"primary",size:"sm"}),s.jsx("p",{className:"text-muted mt-2 mb-0",children:"Loading signature required assessments..."})]})})}):o?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(W,{className:"shadow-sm border-danger",children:s.jsx(W.Body,{children:s.jsxs(De,{variant:"danger",className:"mb-0",children:[s.jsx(Jt,{size:16,className:"me-2"}),o]})})})}):s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(W,{className:"border-0 shadow-sm",children:s.jsxs($t.Container,{activeKey:c,onSelect:N,children:[s.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Xe,{variant:"tabs",className:"border-0",children:[s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"course",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:c==="course"?"600":"400",opacity:c==="course"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Dt,{className:"me-2",size:16}),"Course"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"subject",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:c==="subject"?"600":"400",opacity:c==="subject"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(xt,{className:"me-2",size:16}),"Subject"]})})]})}),s.jsx(W.Body,{className:"p-4",children:r.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(Gi,{size:48,className:"text-muted mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"No signature required assessments"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Assessment Name",sortKey:"name",sortConfig:y,onSort:w})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Course Name",sortKey:"courseName",sortConfig:y,onSort:w})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Date",sortKey:"occuranceDate",sortConfig:y,onSort:w})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"Sign"})]})}),s.jsx("tbody",{children:j.map((C,R)=>s.jsxs("tr",{className:`${R%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor=R%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{className:"fw-medium text-dark",children:C.name})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{className:"fw-medium text-dark",children:C.courseName})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{className:"text-dark",children:C.occuranceDate?new Date(C.occuranceDate).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(k.Check,{type:"checkbox",checked:C.status==="READY_TO_SUBMIT"||u===C.id,disabled:C.status==="READY_TO_SUBMIT"||u===C.id,onChange:()=>{C.status==="SIGNATURE_PENDING"&&E(C.id)},style:{cursor:C.status==="SIGNATURE_PENDING"?"pointer":"not-allowed"}})})]},C.id))})]})})})]})}),s.jsxs(ce,{show:f,onHide:_,size:"lg",centered:!0,children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Draw Your Signature"})}),s.jsxs(ce.Body,{className:"text-center py-4",children:[s.jsx("p",{className:"text-muted mb-3",children:"Please draw your signature in the box below using your mouse or touch device."}),s.jsx("div",{className:"d-flex justify-content-center mb-3",children:s.jsx(L1,{onSignatureChange:P,width:400,height:200})})]}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"outline-secondary",onClick:_,disabled:g,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:O,disabled:!p||g,children:g?s.jsxs(s.Fragment,{children:[s.jsx(ct,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{size:16,className:"me-2"}),"Submit Signature"]})})]})]})]})},Xle=()=>{const{user:e}=zr();return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(Yle,{traineeId:e?.id})})},Jle=()=>{const{user:e}=zr(),t=tt(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState("course"),[u,m]=v.useState(!1),[f,h]=v.useState(null),{sortedData:p,sortConfig:x,handleSort:g}=_r(r),b=v.useCallback(async()=>{try{i(!0),l(null);const P=(await Jr.getTraineeCourseSubjects(e.id))?.courses||[];if(!Array.isArray(P)||P.length===0){a([]),i(!1);return}const T=[];if(c==="course")for(const O of P){const _=O.course;if(_?.id)try{const C=await Sr.getCourseAssessments(_.id);(C?.assessments||[]).forEach(M=>{["APPROVED","ON_GOING","DRAFT","SIGNATURE_PENDING"].includes(M.status)&&T.push({...M,courseInfo:C?.courseInfo||_})})}catch(C){console.error(`Error loading assessments for course ${_.id}:`,C)}}else for(const O of P){const _=O.subjects||[];for(const C of _)if(C?.id)try{const R=await Sr.getSubjectAssessments(C.id);(R?.assessments||[]).forEach(U=>{["APPROVED","ON_GOING","DRAFT","SIGNATURE_PENDING"].includes(U.status)&&T.push({...U,subjectInfo:R?.subjectInfo||C,courseInfo:O.course})})}catch(R){console.error(`Error loading assessments for subject ${C.id}:`,R)}}a(T)}catch(E){console.error("Error loading assessments:",E),l(E.message||"Failed to load assessments"),J.error("Failed to load assessments"),a([])}finally{i(!1)}},[e?.id,c]);v.useEffect(()=>{e?.id&&b()},[e?.id,c,b]);const j=E=>{d(E)},y=E=>{const T={ON_GOING:{variant:"info",text:"On Going",icon:Ke},PENDING:{variant:"warning",text:"Pending",icon:Ke},NOT_STARTED:{variant:"warning",text:"Not Started",icon:Ke},APPROVED:{variant:"success",text:"Approved",icon:Je},COMPLETED:{variant:"success",text:"Completed",icon:Je},REJECTED:{variant:"danger",text:"Rejected",icon:Jt},CANCELLED:{variant:"secondary",text:"Cancelled",icon:Jt},DRAFT:{variant:"primary",text:"Draft",icon:Ke},SIGNATURE_PENDING:{variant:"warning",text:"Signature Pending",icon:Ke}}[E]||{variant:"secondary",text:E,icon:Jt},O=T.icon;return s.jsxs(ke,{bg:T.variant,className:"d-flex align-items-center",children:[s.jsx(O,{size:12,className:"me-1"}),T.text]})},w=E=>E?E==="NOT_APPLICABLE"?s.jsx(ke,{bg:"secondary",children:"N/A"}):E==="PASS"?s.jsx(ke,{bg:"success",children:"PASS"}):E==="FAIL"?s.jsx(ke,{bg:"danger",children:"FAIL"}):s.jsx(ke,{bg:"secondary",children:E}):s.jsx("span",{className:"text-muted",children:"-"}),S=E=>{t(je.ASSESSMENTS_SECTIONS(E.id))},N=E=>{E&&(h(E),m(!0))};return n?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(W,{className:"shadow-sm",children:s.jsxs(W.Body,{className:"text-center py-4",children:[s.jsx(ct,{animation:"border",variant:"primary",size:"sm"}),s.jsx("p",{className:"text-muted mt-2 mb-0",children:"Loading your assessments..."})]})})}):o?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(W,{className:"shadow-sm border-danger",children:s.jsx(W.Body,{children:s.jsxs(De,{variant:"danger",className:"mb-0",children:[s.jsx(Jt,{size:16,className:"me-2"}),o]})})})}):s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(W,{className:"border-0 shadow-sm",children:s.jsxs($t.Container,{activeKey:c,onSelect:j,children:[s.jsx(W.Header,{className:"border-bottom py-2 bg-primary",children:s.jsxs(Xe,{variant:"tabs",className:"border-0",children:[s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"course",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:c==="course"?"600":"400",opacity:c==="course"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Dt,{className:"me-2",size:16}),"Assessments By Course"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"subject",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:c==="subject"?"600":"400",opacity:c==="subject"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(xt,{className:"me-2",size:16}),"Assessments By Subject"]})})]})}),s.jsx(W.Body,{className:"p-4",children:r.length===0?s.jsxs("div",{className:"text-center py-5",children:[s.jsx(Je,{size:48,className:"text-muted mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"No assessments available"})]}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Assessment Name",sortKey:"name",sortConfig:x,onSort:g})}),c==="course"&&s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Course",sortKey:"courseInfo",sortConfig:x,onSort:g})}),c==="subject"&&s.jsxs(s.Fragment,{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Subject",sortKey:"subjectInfo",sortConfig:x,onSort:g})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Course",sortKey:"courseInfo",sortConfig:x,onSort:g})})]}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Trainee",sortKey:"trainee",sortConfig:x,onSort:g})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Date",sortKey:"occuranceDate",sortConfig:x,onSort:g})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:s.jsx(ks,{title:"Status",sortKey:"status",sortConfig:x,onSort:g})}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Result"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"PDF"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"Actions"})]})}),s.jsx("tbody",{children:p.map((E,P)=>s.jsxs("tr",{className:`${P%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor=P%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsxs("td",{className:"border-neutral-200 align-middle",children:[s.jsx("div",{className:"fw-medium text-dark",children:E.name}),E.comment&&s.jsx("small",{className:"text-muted d-block mt-1",children:E.comment})]}),c==="course"&&s.jsx("td",{className:"border-neutral-200 align-middle",children:E.courseInfo?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fw-medium text-dark",children:E.courseInfo.name}),s.jsx("small",{className:"text-muted",children:E.courseInfo.code})]}):s.jsx("span",{className:"text-muted",children:"-"})}),c==="subject"&&s.jsxs(s.Fragment,{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:E.subjectInfo?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fw-medium text-dark",children:E.subjectInfo.name}),s.jsx("small",{className:"text-muted",children:E.subjectInfo.code})]}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:E.courseInfo?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fw-medium text-dark",children:E.courseInfo.name}),s.jsx("small",{className:"text-muted",children:E.courseInfo.code})]}):s.jsx("span",{className:"text-muted",children:"-"})})]}),s.jsx("td",{className:"border-neutral-200 align-middle",children:E.trainee?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fw-medium text-dark",children:E.trainee.fullName}),s.jsx("small",{className:"text-muted",children:E.trainee.eid})]}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("span",{className:"text-dark",children:E.occuranceDate?new Date(E.occuranceDate).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:y(E.status)}),s.jsx("td",{className:"border-neutral-200 align-middle",children:E.resultScore?s.jsx(ke,{bg:E.resultText==="FAIL"?"danger":"success",children:E.resultScore}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:w(E.resultText)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:E.pdfUrl?s.jsx(te,{variant:"link",className:"p-0 text-primary-custom",onClick:()=>N(E.pdfUrl),style:{border:"none",background:"transparent"},children:s.jsx(tl,{size:18})}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsxs("td",{className:"border-neutral-200 align-middle text-center",children:[(E.status==="ON_GOING"||E.status==="DRAFT")&&E.isTraineeLocked===!1&&s.jsxs(te,{size:"sm",variant:"primary",onClick:()=>S(E),className:"d-flex align-items-center gap-1",children:[s.jsx(zx,{size:14}),"Participate"]}),!((E.status==="ON_GOING"||E.status==="DRAFT")&&E.isTraineeLocked===!1)&&s.jsx("span",{className:"text-muted",children:""})]})]},E.id))})]})})})]})}),s.jsx(LR,{show:u,onHide:()=>{m(!1),h(null)},pdfUrl:f,title:"Assessment PDF"})]})},S2=()=>s.jsx(Jle,{}),ma={getReportsByType:async(e,t={})=>{try{return(await be.get("/reports",{params:{requestType:e,...t}})).data}catch(r){throw console.error("Error fetching reports:",r),r}},getMyReports:async(e,t={})=>{try{return(await be.get("/reports/my-reports",{params:{requestType:e,...t}})).data}catch(r){throw console.error("Error fetching my reports:",r),r}},getIncidents:async(e={})=>ma.getReportsByType("INCIDENT",e),getFeedback:async(e={})=>ma.getReportsByType("FEEDBACK",e),getMyIncidents:async(e={})=>ma.getMyReports("INCIDENT",e),getMyFeedback:async(e={})=>ma.getMyReports("FEEDBACK",e),getAllReports:async(e={})=>{try{return(await be.get("/reports",{params:e})).data}catch(t){throw console.error("Error fetching all reports:",t),t}},getReportById:async e=>{try{return(await be.get(`/reports/${e}`)).data}catch(t){throw console.error("Error fetching report:",t),t}},acknowledgeReport:async e=>{try{return(await be.put(`/reports/${e}/acknowledge`)).data}catch(t){throw console.error("Error acknowledging report:",t),t}},resolveReport:async(e,t)=>{try{return(await be.put(`/reports/${e}/resolve`,{response:t})).data}catch(r){throw console.error("Error resolving report:",r),r}},submitResponse:async(e,t)=>{try{return(await be.put(`/reports/${e}/respond`,{response:t})).data}catch(r){throw console.error("Error submitting response:",r),r}},respondToReport:async(e,t)=>{try{return(await be.put(`/reports/${e}/respond`,{response:t})).data}catch(r){throw console.error("Error responding to report:",r),r}},cancelReport:async e=>{try{return(await be.put(`/reports/${e}/cancel`)).data}catch(t){throw console.error("Error cancelling report:",t),t}},createReport:async e=>{try{return(await be.post("/reports",e)).data}catch(t){throw console.error("Error creating report:",t),t}}},Zle=[{id:"incidents",label:"Incidents",icon:Jt},{id:"feedback",label:"Feedback",icon:$2}],Qle=[{id:"pending",label:"Pending"},{id:"acknowledge",label:"Acknowledge"},{id:"resolved",label:"Resolved"},{id:"cancel",label:"Cancel"}],ece=[{id:"pending",label:"Pending"},{id:"acknowledge",label:"Acknowledge"},{id:"resolved",label:"Resolved"}],E2=[{value:"all",label:"All Status"},{value:"SUBMITTED",label:"Submitted"},{value:"ACKNOWLEDGED",label:"Acknowledged"},{value:"RESOLVED",label:"Resolved"},{value:"CANCELLED",label:"Cancelled"}],T2=[{value:"all",label:"All Status"},{value:"SUBMITTED",label:"Submitted"},{value:"ACKNOWLEDGED",label:"Acknowledged"},{value:"RESOLVED",label:"Resolved"},{value:"CANCELLED",label:"Cancelled"}],Yd=({defaultTab:e,source:t="/reports",onShowForm:r})=>{const a=tt(),n=ya(),i=v.useMemo(()=>n.pathname.includes("/feedback")?"feedback":(n.pathname.includes("/issues"),"incidents"),[n.pathname]),o=e||i,[l,c]=v.useState(o),[d,u]=v.useState("pending"),[m,f]=v.useState(""),[h,p]=v.useState("all"),[x,g]=v.useState([]),[b,j]=v.useState([]),[y,w]=v.useState(!0);v.useEffect(()=>{c(o),p("all"),f(""),u("pending")},[o]),v.useEffect(()=>{(async()=>{try{w(!0);const M=t==="/reports/create",[U,Z]=await Promise.all([M?ma.getMyIncidents():ma.getIncidents(),M?ma.getMyFeedback():ma.getFeedback()]);g(U.reports||[]),j(Z.reports||[])}catch(M){console.error("Error fetching reports:",M),J.error("Failed to load reports. Please try again."),g([]),j([])}finally{w(!1)}})()},[t]);const S=R=>R?new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",N=R=>{const M={SUBMITTED:{variant:"warning",icon:Ke,display:"Pending"},ACKNOWLEDGED:{variant:"info",icon:Je,display:"Acknowledged"},RESOLVED:{variant:"success",icon:Je,display:"Resolved"},CANCELLED:{variant:"secondary",icon:Qr,display:"Cancelled"},open:{variant:"danger",icon:Jt,display:"Open"},in_progress:{variant:"warning",icon:Ke,display:"In Progress"},resolved:{variant:"success",icon:Je,display:"Resolved"},closed:{variant:"secondary",icon:Qr,display:"Closed"}},U=M[R]||M.in_progress,Z=U.icon;return s.jsxs(ke,{bg:U.variant,className:"d-flex align-items-center",children:[s.jsx(Z,{size:12,className:"me-1"}),U.display]})},E=R=>({pending:"SUBMITTED",acknowledge:"ACKNOWLEDGED",resolved:"RESOLVED",cancel:"CANCELLED"})[R]||"all",T=l==="feedback"?{data:b,statusOptions:T2,columns:[{key:"title",title:"FEEDBACK TITLE",className:"show-mobile",sortable:!0},{key:"createdBy",title:"SUBMITTER",className:"hide-mobile",sortable:!0},{key:"status",title:"STATUS",className:"show-mobile",sortable:!0},{key:"createdAt",title:"SUBMITTED DATE",className:"hide-mobile",sortable:!0},{title:"ACTIONS",className:"text-center show-mobile",sortable:!1}]}:{data:x,statusOptions:E2,columns:[{key:"title",title:"INCIDENT TITLE",className:"show-mobile",sortable:!0},{key:"createdBy",title:"REPORTER",className:"hide-mobile",sortable:!0},{key:"status",title:"STATUS",className:"show-mobile",sortable:!0},{key:"severity",title:"SEVERITY",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"CREATED DATE",className:"hide-mobile",sortable:!0},{title:"ACTIONS",className:"text-center show-mobile",sortable:!1}]},O=v.useMemo(()=>T.data.filter(M=>{const Z=[M.title,M.description,M.createdBy?.firstName,M.createdBy?.lastName,M.createdBy?.email].filter(Boolean).some(me=>me.toLowerCase().includes(m.toLowerCase())),ee=E(d),re=ee==="all"||M.status===ee,z=h==="all"||M.status===h;return Z&&re&&z}),[T,m,h,d]),_=R=>{a(je.REPORTS_DETAIL(R),{state:{from:t}})},C=R=>{console.log("Acknowledging feedback:",R),J.success("Feedback acknowledged successfully")};return y?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(nr,{})}):s.jsx(Ce,{fluid:!0,className:"py-4 reports-page",children:s.jsxs(W,{className:"border-0 shadow-sm",children:[s.jsxs(W.Header,{className:"border-bottom py-2 bg-primary",children:[s.jsx(de,{className:"align-items-center mb-3",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsx("div",{className:"d-flex align-items-center gap-2",children:s.jsx("div",{children:s.jsx("h4",{className:"mb-0 text-white",children:"Issue List"})})}),t==="/reports/create"&&r&&s.jsx(yt,{permission:Te.SUBMIT_INCIDENT_FEEDBACK_REPORT,fallback:null,children:s.jsxs(te,{variant:"light",size:"sm",onClick:r,className:"d-flex align-items-center",children:[s.jsx(Gr,{className:"me-2",size:16}),"Create Report"]})})]})})}),s.jsx(Xe,{variant:"tabs",className:"border-0",children:Zle.map(R=>{const M=R.icon;return s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{as:"button",onClick:()=>{c(R.id),u("pending")},active:l===R.id,className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:l===R.id?"600":"400",opacity:l===R.id?"1":"0.7",borderRadius:"4px 4px 0 0",cursor:"pointer"},children:[s.jsx(M,{className:"me-2",size:16}),R.label,s.jsx(ke,{bg:"light",text:"dark",className:"ms-2",children:R.id==="feedback"?b.length:x.length})]})},R.id)})}),s.jsx(Xe,{className:"border-0 mt-3 sub-tabs-nav",style:{display:"flex",gap:"0"},children:(t==="/reports/create"?Qle:ece).map(R=>s.jsx(Xe.Item,{style:{marginBottom:"0"},children:s.jsx(Xe.Link,{as:"button",onClick:()=>u(R.id),className:`d-flex align-items-center sub-tab-link ${d===R.id?"active-sub-tab":""}`,style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:d===R.id?"600":"400",opacity:d===R.id?"1":"0.7",cursor:"pointer",borderBottom:d===R.id?"3px solid #ffffff":"none",padding:"12px",paddingBottom:"9px",margin:"0",transition:"all 0.2s ease"},children:R.label})},R.id))})]}),s.jsxs(W.Body,{className:"p-4",children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:l==="feedback"?"Search feedback by title, description, or submitter...":"Search incidents by title, description, or reporter...",value:m,onChange:f,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx("select",{className:"form-select filter-panel-mobile",value:h,onChange:R=>p(R.target.value),children:(l==="feedback"?T2:E2).map(R=>s.jsx("option",{value:R.value,children:R.label},R.value))})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[O.length," ",l==="feedback"?`feedback item${O.length!==1?"s":""}`:`incident${O.length!==1?"s":""}`]})})})]}),O.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("p",{className:"text-muted mb-0",children:["No ",l==="feedback"?"feedback":"incidents"," found"]})}):s.jsx(VS,{data:O,loading:y,columns:T.columns,renderRow:(R,M)=>s.jsxs("tr",{className:`${M%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:U=>{U.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:U=>{U.currentTarget.style.backgroundColor=M%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:R.title}),s.jsx("small",{className:"text-muted",children:R.description})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{children:[s.jsxs("div",{className:"fw-medium",children:[R.createdBy?.firstName," ",R.createdBy?.lastName]}),s.jsx("small",{className:"text-muted",children:R.createdBy?.email})]})}),s.jsx("td",{className:"align-middle show-mobile",children:N(R.status)}),l==="incidents"&&s.jsx("td",{className:"align-middle hide-mobile",children:R.severity?s.jsx(ke,{bg:R.severity==="CRITICAL"?"danger":R.severity==="HIGH"||R.severity==="MEDIUM"?"warning":"info",children:R.severity}):"N/A"}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:S(R.createdAt)})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(yt,{permission:Te.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Detail",icon:s.jsx(Bt,{}),onClick:()=>_(R.id)},...l==="feedback"&&R.status!=="acknowledged"&&R.status!=="reviewed"?[{label:"Acknowledge",icon:s.jsx(Je,{}),onClick:()=>C(R.id)}]:[]]})})})]},R.id)})]})]})})},tce=`
  .create-issue-form .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-form .card-header h5 {
    color: #ffffff !important;
  }
  .create-issue-form .card-header svg {
    color: #ffffff !important;
  }
  .create-issue-guidelines .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-guidelines .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=tce,document.head.appendChild(e)}const rce=()=>{const[e,t]=el(),r=e.get("form")==="true",[a,n]=v.useState({requestType:"",severity:"MEDIUM",title:"",description:"",actionsTaken:"",isAnonymous:!1}),[i,o]=v.useState(!1),l=m=>{const{name:f,value:h,type:p,checked:x}=m.target;n(g=>({...g,[f]:p==="checkbox"?x:h}))},c=async m=>{if(m.preventDefault(),!a.requestType||!a.title||!a.description){J.error("Please fill in all required fields");return}o(!0);try{const f={requestType:a.requestType,title:a.title,description:a.description,actionsTaken:a.actionsTaken||"",severity:a.severity,isAnonymous:a.isAnonymous};await ma.createReport(f),J.success("Report submitted successfully!"),n({requestType:"",severity:"MEDIUM",title:"",description:"",actionsTaken:"",isAnonymous:!1}),t({})}catch(f){console.error("Error submitting report:",f);const h=f.response?.data?.message||"Failed to submit report. Please try again.";J.error(h)}finally{o(!1)}},d=()=>{t({form:"true"})},u=()=>{t({})};return r?s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsx("div",{className:"d-flex align-items-center justify-content-start",children:s.jsx(te,{variant:"outline-secondary",onClick:u,className:"me-3",children:"Back to List"})})})}),s.jsxs(de,{className:"mt-4",children:[s.jsx(H,{lg:8,children:s.jsxs(W,{className:"border-0 shadow-sm create-issue-form",children:[s.jsx(W.Header,{children:s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(xt,{className:"me-2",size:20}),"Incident/Feedback Report Form"]})}),s.jsx(W.Body,{children:s.jsxs(k,{onSubmit:c,children:[s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Title"}),s.jsx(k.Control,{type:"text",name:"title",value:a.title,onChange:l,placeholder:"Brief description of the incident or feedback"})]})}),s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Request Type *"}),s.jsxs(k.Select,{name:"requestType",value:a.requestType,onChange:l,required:!0,children:[s.jsx("option",{value:"",children:"Select request type"}),s.jsx("option",{value:"SAFETY_REPORT",children:"Safety Report"}),s.jsx("option",{value:"INSTRUCTOR_REPORT",children:"Instructor Report"}),s.jsx("option",{value:"FATIGUE_REPORT",children:"Fatigue Report"}),s.jsx("option",{value:"TRAINING_PROGRAM_REPORT",children:"Training Program Report"}),s.jsx("option",{value:"FACILITIES_REPORT",children:"Facilities Report"}),s.jsx("option",{value:"COURSE_ORGANIZATION_REPORT",children:"Course Organization Report"}),s.jsx("option",{value:"ASSESSMENT_APPROVAL_REQUEST",children:"Assessment Approval Request"}),s.jsx("option",{value:"FEEDBACK",children:"Feedback"}),s.jsx("option",{value:"OTHER",children:"Other"})]})]})})]}),s.jsx(de,{children:s.jsx(H,{md:6,children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Severity"}),s.jsxs(k.Select,{name:"severity",value:a.severity,onChange:l,children:[s.jsx("option",{value:"LOW",children:"Low"}),s.jsx("option",{value:"MEDIUM",children:"Medium"}),s.jsx("option",{value:"HIGH",children:"High"}),s.jsx("option",{value:"CRITICAL",children:"Critical"})]})]})})}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Description"}),s.jsx(k.Control,{as:"textarea",rows:4,name:"description",value:a.description,onChange:l,placeholder:"Please provide detailed information about the incident or feedback..."})]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Actions Taken"}),s.jsx(k.Control,{as:"textarea",rows:3,name:"actionsTaken",value:a.actionsTaken,onChange:l,placeholder:"Describe any actions you have already taken regarding this incident..."})]}),s.jsx(k.Group,{className:"mb-4",children:s.jsx(k.Check,{type:"checkbox",name:"isAnonymous",checked:a.isAnonymous,onChange:l,label:"Submit anonymously (your identity will be kept confidential)"})}),s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx(te,{type:"submit",variant:"primary",disabled:i,children:i?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(sS,{className:"me-2",size:16}),"Submit Incident/Feedback Report"]})})})]})})]})}),s.jsx(H,{lg:4,children:s.jsxs(W,{className:"border-0 shadow-sm create-issue-guidelines",children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Guidelines"})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Before submitting:"}),s.jsxs("ul",{className:"small text-muted mb-0",children:[s.jsx("li",{children:"Check if the incident has already been reported"}),s.jsx("li",{children:"Provide clear and specific details"}),s.jsx("li",{children:"Include steps to reproduce the incident"}),s.jsx("li",{children:"Attach screenshots if applicable"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{children:"Response time:"}),s.jsxs("ul",{className:"small text-muted mb-0",children:[s.jsx("li",{children:"High priority: Within 24 hours"}),s.jsx("li",{children:"Medium priority: Within 2-3 days"}),s.jsx("li",{children:"Low priority: Within 1 week"})]})]}),s.jsxs(De,{variant:"info",className:"small",children:[s.jsx("strong",{children:"Note:"})," All incident/feedback reports are reviewed by our support team. You will receive a response via email."]})]})]})})]})]}):s.jsx(Yd,{source:"/reports/create",onShowForm:d})},sce=()=>{const{reportId:e}=ur(),t=tt(),a=ya().state?.from||"/reports",n=a==="/reports/create",[i,o]=v.useState(null),[l,c]=v.useState(!0),[d,u]=v.useState(!1),[m,f]=v.useState(""),[h,p]=v.useState(!1),[x,g]=v.useState(!1);v.useEffect(()=>{(async()=>{try{c(!0);const O=await ma.getReportById(e);o(O)}catch(O){console.error("Error fetching report:",O),J.error("Failed to load report details")}finally{c(!1)}})()},[e]);const b=async()=>{try{g(!0),await ma.cancelReport(e),J.success("Report cancelled successfully"),t(a)}catch(T){console.error("Error cancelling report:",T),J.error("Failed to cancel report")}finally{g(!1)}},j=async()=>{try{g(!0),await ma.acknowledgeReport(e),J.success("Report acknowledged successfully"),o(T=>({...T,status:"ACKNOWLEDGED"}))}catch(T){console.error("Error acknowledging report:",T),J.error("Failed to acknowledge report")}finally{g(!1)}},y=async()=>{if(!m.trim()){J.error("Please enter resolution notes");return}try{p(!0),await ma.respondToReport(e,m),J.success("Report resolved successfully"),u(!1),f(""),o(T=>({...T,status:"RESOLVED",response:m}))}catch(T){console.error("Error resolving report:",T),J.error("Failed to resolve report")}finally{p(!1)}},w=T=>T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",S=()=>{t(n?"/reports/create":"/reports")},N=()=>n?i?.status!=="SUBMITTED"?null:s.jsx(te,{variant:"danger",size:"sm",onClick:b,disabled:x,children:"Cancel"}):s.jsxs(s.Fragment,{children:[i?.status==="SUBMITTED"&&s.jsx(te,{variant:"success",size:"sm",onClick:j,disabled:x,children:"Acknowledge"}),i?.status==="ACKNOWLEDGED"&&s.jsx(te,{variant:"primary",size:"sm",onClick:()=>u(!0),disabled:x,children:"Resolve"})]}),E=T=>{const O={SUBMITTED:{variant:"warning",icon:Ke,label:"Pending"},ACKNOWLEDGED:{variant:"info",icon:Je,label:"Acknowledged"},RESOLVED:{variant:"success",icon:Je,label:"Resolved"},CANCELLED:{variant:"secondary",icon:Qr,label:"Cancelled"},open:{variant:"danger",icon:Jt,label:"Open"},in_progress:{variant:"warning",icon:Ke,label:"In Progress"},pending:{variant:"warning",icon:Ke,label:"Pending"},acknowledged:{variant:"success",icon:Je,label:"Acknowledged"},reviewed:{variant:"info",icon:Je,label:"Reviewed"}},_=O[T]||O.open,C=_.icon;return s.jsxs(ke,{bg:_.variant,className:"d-flex align-items-center",children:[s.jsx(C,{size:12,className:"me-1"}),_.label]})},P=T=>{const O={LOW:"info",MEDIUM:"warning",HIGH:"danger",CRITICAL:"dark"};return s.jsx(ke,{bg:O[T]||"secondary",children:T})};return l?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading report details..."})]})}):i?s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:S,children:[s.jsx(At,{size:16,className:"me-2"}),n?"Back to Issue List":"Back to Reports"]}),s.jsx("div",{className:"d-flex gap-2",children:N()})]})})}),s.jsxs(de,{children:[s.jsx(H,{lg:8,children:s.jsxs(W,{className:"border-0 shadow-sm mb-4",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[s.jsx(xt,{className:"me-2",size:20}),"Report Details"]}),E(i.status)]})}),s.jsxs(W.Body,{children:[s.jsxs(de,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Title"}),s.jsx("h6",{className:"mb-0",children:i.title})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Request Type"}),s.jsx(ke,{bg:"primary",children:i.requestType?.replace(/_/g," ")})]})})]}),s.jsxs(de,{className:"mb-3",children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Severity"}),P(i.severity)]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Report ID"}),s.jsx("code",{children:i.id})]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-2",children:"Description"}),s.jsx("p",{className:"mb-0",children:i.description})]}),i.actionsTaken&&s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-2",children:"Actions Taken"}),s.jsx("p",{className:"mb-0",children:i.actionsTaken})]}),i.response&&s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-2",children:"Resolution Notes"}),s.jsx(De,{variant:"success",children:s.jsx("p",{className:"mb-0",children:i.response})})]}),s.jsx("hr",{}),s.jsxs(de,{children:[s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-2",children:[s.jsxs("small",{className:"text-muted d-block mb-1",children:[s.jsx(Pt,{size:12,className:"me-1"}),"Created By"]}),s.jsx("div",{children:i?.isAnonymous?s.jsx("span",{className:"text-muted",children:"Anonymous"}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"fw-medium",children:[i?.createdBy?.firstName," ",i?.createdBy?.lastName]}),s.jsx("small",{className:"text-muted",children:i?.createdBy?.email})]})})]})}),s.jsx(H,{md:6,children:s.jsxs("div",{className:"mb-2",children:[s.jsxs("small",{className:"text-muted d-block mb-1",children:[s.jsx(or,{size:12,className:"me-1"}),"Created Date"]}),s.jsx("div",{children:w(i.createdAt)})]})})]})]})]})}),s.jsx(H,{lg:4,children:s.jsxs(W,{className:"border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Report Information"})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Created By"}),s.jsxs("div",{children:[i?.createdBy?.firstName," ",i?.createdBy?.lastName,s.jsx("br",{}),s.jsx("small",{className:"text-muted",children:i?.createdBy?.email})]})]}),i?.managedBy&&s.jsxs("div",{className:"mb-3",children:[s.jsx("small",{className:"text-muted d-block mb-1",children:"Managed By"}),s.jsxs("div",{children:[i?.managedBy?.firstName," ",i?.managedBy?.lastName,s.jsx("br",{}),s.jsx("small",{className:"text-muted",children:i?.managedBy?.email})]})]}),i?.isAnonymous&&s.jsx(De,{variant:"info",className:"small mb-0",children:"This report was submitted anonymously."})]})]})})]}),s.jsxs(ce,{show:d,onHide:()=>{u(!1),f("")},children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Resolve Report - Add Resolution Notes"})}),s.jsx(ce.Body,{children:s.jsx(k,{children:s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Resolution Notes *"}),s.jsx(k.Control,{as:"textarea",rows:6,value:m,onChange:T=>f(T.target.value),placeholder:"Enter details about how this issue was resolved...",required:!0}),s.jsx(k.Text,{className:"text-muted",children:"Please provide detailed information about the resolution of this issue."})]})})}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"secondary",onClick:()=>{u(!1),f("")},disabled:h,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:y,disabled:!m.trim()||h,children:h?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resolving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Je,{className:"me-2",size:16}),"Resolve"]})})]})]})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"warning",children:[s.jsx(De.Heading,{children:"Report Not Found"}),s.jsx("p",{children:"The requested report could not be found."}),s.jsx(te,{variant:"outline-primary",onClick:()=>t(je.REPORTS),children:"Back to Reports"})]})})},ace=({template:e})=>{const r=(n=>{switch(n){case"ACTIVE":return{variant:"success",icon:Je,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:Ke,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:Ke,text:"INACTIVE"};case"PENDING":return{variant:"warning",icon:Ke,text:"PENDING"};case"PUBLISHED":return{variant:"success",icon:Je,text:"PUBLISHED"};case"REJECTED":case"DENIED":return{variant:"danger",icon:Ke,text:"REJECTED"};default:return{variant:"secondary",icon:Ke,text:n}}})(e?.status),a=r.icon;return s.jsx("div",{className:"p-4",children:s.jsxs(de,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Version"}),s.jsx("div",{children:s.jsx(ke,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:e?.version})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Status"}),s.jsx("div",{children:s.jsxs(ke,{bg:r.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx(a,{className:"me-1",size:12}),r.text]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Sections"}),s.jsxs("div",{className:"fw-medium",children:[e?.totalSections||0," sections"]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{className:"me-2",size:16}),s.jsx("span",{children:e?.createdBy||"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"me-2",size:16}),s.jsx("span",{children:e?.createdAt?new Date(e.createdAt).toLocaleDateString():"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{className:"me-2",size:16}),s.jsx("span",{children:e?.lastModified?new Date(e.lastModified).toLocaleDateString():"N/A"})]})]})]})]})})},nce=({sections:e=[]})=>{if(e.length===0)return s.jsx(De,{variant:"info",className:"mb-0",children:s.jsxs("div",{children:[s.jsx("strong",{children:"No template config found"}),s.jsx("p",{className:"mb-0 text-muted",children:"This template has no sections or fields yet."})]})});const t=[];return e.forEach((r,a)=>{t.push({type:"section",id:r.id||`section-${a}`,name:r.label||r.name,fieldCount:r.fields?.length||0,data:r}),r.fields&&r.fields.length>0&&r.fields.forEach((n,i)=>{t.push({type:"field",id:n.id||n.fieldName||`field-${a}-${i}`,name:n.label||n.fieldName,parentSectionId:r.id||`section-${a}`,data:n})})}),s.jsx("div",{children:s.jsx("div",{className:"list-group",style:{border:"none"},children:t.map(r=>{const a=r.type==="section",n=r.type==="field";return s.jsx("div",{className:"list-group-item",style:{border:"none",borderBottom:"1px solid #e9ecef",padding:"12px 16px",backgroundColor:"white",paddingLeft:n?"40px":"16px"},children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("div",{className:"d-flex align-items-center",style:{flex:1,minWidth:0},children:[s.jsx("span",{style:{fontSize:"14px",color:"#333",fontWeight:a?500:400,wordBreak:"break-word",overflowWrap:"break-word"},children:r.name}),a&&r.fieldCount>0&&s.jsx(ke,{bg:"info",className:"ms-2",style:{fontSize:"11px",padding:"2px 8px",borderRadius:"12px",backgroundColor:"#0dcaf0",color:"#000"},children:r.fieldCount})]}),s.jsx(ke,{bg:a?"warning":"secondary",style:{fontSize:"11px",padding:"4px 10px",borderRadius:"4px",backgroundColor:a?"#ffc107":"var(--bs-secondary)",color:a?"#000":"#fff",fontWeight:500,marginLeft:"12px"},children:a?"SECTION":r.data?.fieldType||r.data?.type||"FIELD"})]})},r.id)})})})},ice=({template:e,pdfUrl:t,loadingPDF:r,onViewTemplateConfig:a})=>s.jsxs("div",{className:"p-4",children:[s.jsx(de,{children:s.jsx(H,{xs:12,className:"mb-3",children:s.jsx("div",{className:"d-flex justify-content-end gap-2 mb-3",children:s.jsx(yt,{permission:Te.VIEW_TEMPLATE_DETAILS,fallback:null,children:s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:a,className:"d-flex align-items-center",disabled:!e?.templateConfig,children:[s.jsx(fi,{className:"me-2",size:16}),"View Template Config"]})})})})}),s.jsxs(de,{children:[s.jsxs(H,{xs:12,lg:7,className:"mb-4",children:[s.jsx("div",{className:"mb-2",children:s.jsx("h6",{className:"mb-0",style:{color:"#333",fontWeight:500},children:"PDF Preview"})}),r?s.jsx("div",{className:"border rounded p-4 bg-light text-center",style:{minHeight:"500px",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{children:[s.jsx(ct,{animation:"border",variant:"primary",className:"mb-3"}),s.jsx("p",{className:"text-muted mb-0",children:"Loading PDF preview..."})]})}):t?s.jsx("div",{style:{height:"60vh",overflow:"hidden"},children:s.jsx("iframe",{src:t,style:{width:"100%",height:"100%",border:"1px solid #dee2e6",borderRadius:"0.375rem",display:"block"},title:"Template PDF Preview"})}):s.jsxs(De,{variant:"warning",className:"mb-0",children:[s.jsx(tl,{className:"me-2"}),"PDF preview is not available. Please try again or contact support."]})]}),s.jsxs(H,{xs:12,lg:5,children:[s.jsx("div",{className:"mb-2",children:s.jsx("h6",{className:"mb-0",style:{color:"#333",fontWeight:500},children:"Template fields & sections"})}),s.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:s.jsx(nce,{sections:e?.sections||[]})})]})]})]}),oce=({template:e})=>{const[t,r]=v.useState(null),[a,n]=v.useState(!1),[i,o]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e?.referFirstVersionId){o("No previous version found");return}try{n(!0),o(null);const h=await tr.getTemplateById(e.referFirstVersionId),p=h?.data?.templateForm||h?.data||h,x=h?.data?.sections||p?.sections||[];if(!p){o("Old version template not found");return}const g=p.createdByUser||p.createdBy,b=p.updatedByUser||p.updatedBy,j=w=>w?.firstName&&w?.lastName?`${w.firstName} ${w.lastName}`:w?.fullName||w?.name||"N/A",y={id:p.id,name:p.name||"N/A",description:p.description||"",version:p.version||"v1.0",totalSections:x.length||0,totalFields:x.reduce((w,S)=>w+(S.fields?.length||0),0)||0,status:p.status||"DRAFT",createdBy:j(g),createdAt:p.createdAt||p.createdDate,lastModified:p.updatedAt||p.updatedDate||p.createdAt,lastModifiedBy:j(b),sections:x,templateContent:p.templateContent||null,templateConfig:p.templateConfig||null,formId:p.formId||p.id};r(y)}catch(h){console.error("Error loading old version:",h),o(h.response?.data?.message||h.message||"Failed to load old version details")}finally{n(!1)}})()},[e?.referFirstVersionId]);const l=f=>{switch(f){case"ACTIVE":return{variant:"success",icon:Je,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:Ke,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:Ke,text:"INACTIVE"};case"PENDING":return{variant:"warning",icon:Ke,text:"PENDING"};case"PUBLISHED":return{variant:"success",icon:Je,text:"PUBLISHED"};case"REJECTED":case"DENIED":return{variant:"danger",icon:Ke,text:"REJECTED"};default:return{variant:"secondary",icon:Ke,text:f}}},c=()=>{t?.templateConfig?window.open(t.templateConfig,"_blank","noopener,noreferrer"):J.warning("Template config is not available")},d=async()=>{if(!t?.formId&&!t?.id){J.warning("Template ID is not available");return}try{const f=t.formId||t.id,h=await tr.getTemplatePDF(f),p=URL.createObjectURL(h),x=document.createElement("a");x.href=p,x.download=`${t.name||"template"}.pdf`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(p)}catch(f){console.error("Error downloading PDF:",f),J.error(f.response?.data?.message||"Failed to download template PDF")}};if(a)return s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading old version details..."})]})});if(i||!t)return s.jsx("div",{className:"p-4",children:s.jsxs(De,{variant:"info",children:[s.jsx(De.Heading,{children:"No Previous Version"}),s.jsx("p",{className:"mb-0",children:i||"This template does not have a previous version."})]})});const u=l(t.status),m=u.icon;return s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"d-flex justify-content-end gap-2 mb-4",children:[s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:c,className:"d-flex align-items-center",disabled:!t?.templateConfig,children:[s.jsx(fi,{className:"me-2",size:16}),"View Template Config"]}),s.jsxs(te,{variant:"primary",size:"sm",onClick:d,className:"d-flex align-items-center",children:[s.jsx(tl,{className:"me-2",size:16}),"Export PDF"]})]}),s.jsxs(W,{className:"mb-4",children:[s.jsx(W.Header,{className:"bg-light",children:s.jsx("h6",{className:"mb-0",children:"Template Information"})}),s.jsx(W.Body,{children:s.jsxs(de,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Template Name"}),s.jsx("div",{className:"fw-medium",children:t.name})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Description"}),s.jsx("div",{children:t.description||"N/A"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Version"}),s.jsx("div",{children:s.jsx(ke,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:t.version})})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Status"}),s.jsx("div",{children:s.jsxs(ke,{bg:u.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[s.jsx(m,{className:"me-1",size:12}),u.text]})})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Sections"}),s.jsxs("div",{className:"fw-medium",children:[t.totalSections," sections"]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Total Fields"}),s.jsxs("div",{className:"fw-medium",children:[t.totalFields," fields"]})]})]})]})})]}),s.jsxs(W,{children:[s.jsx(W.Header,{className:"bg-light",children:s.jsx("h6",{className:"mb-0",children:"Metadata"})}),s.jsx(W.Body,{children:s.jsxs(de,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{className:"me-2",size:16}),s.jsx("span",{children:t.createdBy})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Created Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{className:"me-2",size:16}),s.jsx("span",{children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified By"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{className:"me-2",size:16}),s.jsx("span",{children:t.lastModifiedBy||"N/A"})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-muted small",children:"Last Modified"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{className:"me-2",size:16}),s.jsx("span",{children:t.lastModified?new Date(t.lastModified).toLocaleDateString():"N/A"})]})]})]})]})})]})]})},lce=({show:e,onHide:t,template:r,onApprove:a,reviewing:n})=>s.jsxs(ce,{show:e,onHide:t,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(ce.Header,{className:"bg-primary-custom text-white border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Je,{className:"me-2",size:20}),"Approve Template"]})}),s.jsxs(ce.Body,{className:"p-4",children:[s.jsxs("p",{className:"mb-0",children:["Are you sure you want to approve the template ",s.jsxs("strong",{children:['"',r?.name,'"']}),"?"]}),s.jsx("p",{className:"text-muted mt-2 mb-0",children:"Once approved, the template will be published and available for use."})]}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsx(te,{variant:"outline-secondary",onClick:t,disabled:n,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:a,disabled:n,className:"d-flex align-items-center",children:n?s.jsxs(s.Fragment,{children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),"Approving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Je,{className:"me-2",size:16}),"Approve"]})})]})]}),cce=({show:e,onHide:t,template:r,rejectComment:a,onRejectCommentChange:n,onReject:i,reviewing:o})=>s.jsxs(ce,{show:e,onHide:t,centered:!0,backdrop:"static",keyboard:!1,children:[s.jsx(ce.Header,{className:"bg-secondary text-white border-0",children:s.jsxs(ce.Title,{className:"d-flex align-items-center",children:[s.jsx(Qr,{className:"me-2",size:20}),"Reject Template"]})}),s.jsxs(ce.Body,{className:"p-4",children:[s.jsxs("p",{className:"mb-3",children:["Are you sure you want to reject the template ",s.jsxs("strong",{children:['"',r?.name,'"']}),"?"]}),s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:s.jsxs("strong",{children:["Reason for Rejection ",s.jsx("span",{className:"text-danger",children:"*"})]})}),s.jsx(k.Control,{as:"textarea",rows:4,value:a,onChange:l=>n(l.target.value),placeholder:"Please provide a reason for rejecting this template...",disabled:o}),s.jsx(k.Text,{className:"text-muted",children:"This comment will be visible to the template creator."})]})]}),s.jsxs(ce.Footer,{className:"border-0",children:[s.jsx(te,{variant:"outline-secondary",onClick:t,disabled:o,children:"Cancel"}),s.jsx(te,{variant:"secondary",onClick:i,disabled:o||!a.trim(),className:"d-flex align-items-center",children:o?s.jsxs(s.Fragment,{children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),"Rejecting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Qr,{className:"me-2",size:16}),"Reject"]})})]})]}),C2=()=>{const{templateId:e}=ur(),t=tt(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState("basic-info"),[u,m]=v.useState(null),[f,h]=v.useState(!1),[p,x]=v.useState(!1),[g,b]=v.useState(!1),[j,y]=v.useState(""),[w,S]=v.useState(!1),N=v.useCallback(async()=>{if(!e){l("Template ID is required"),i(!1);return}try{i(!0),l(null);const Z=await tr.getTemplateById(e),ee=Z?.data?.templateForm||Z?.data||Z,re=Z?.data?.sections||ee?.sections||[];if(!ee){l("Template not found");return}const z=ee.createdByUser||ee.createdBy,me=ee.updatedByUser||ee.updatedBy,ne=D=>D?.firstName&&D?.lastName?`${D.firstName} ${D.lastName}`:D?.fullName||D?.name||"N/A",A={id:ee.id,name:ee.name||"N/A",description:ee.description||"",version:ee.version||"v1.0",category:ee.category||"",totalSections:re.length||0,totalFields:re.reduce((D,I)=>D+(I.fields?.length||0),0)||0,status:ee.status||"DRAFT",createdBy:ne(z),createdAt:ee.createdAt||ee.createdDate,lastModified:ee.updatedAt||ee.updatedDate||ee.createdAt,lastModifiedBy:ne(me),sections:re,history:ee.history||ee.versions||[],templateContent:ee.templateContent||null,templateConfig:ee.templateConfig||null,formId:ee.formId||ee.id,referFirstVersionId:ee.referFirstVersionId||null};a(A)}catch(Z){console.error("Error loading template detail:",Z),l(Z.response?.data?.message||Z.message||"Failed to load template details")}finally{i(!1)}},[e]);v.useEffect(()=>{N()},[N]),v.useEffect(()=>{c==="preview"&&r?.id&&!u&&(async()=>{if(!r?.id){J.warning("Template ID is not available");return}try{h(!0);const ee=r.id;console.log("Loading PDF config with ID:",ee);const re=await tr.getTemplatePdfConfig(ee);console.log("PDF Blob received:",re),console.log("PDF Blob type:",re.type),console.log("PDF Blob size:",re.size);const z=URL.createObjectURL(re);console.log("Created object URL:",z),m(z)}catch(ee){console.error("Error loading PDF preview:",ee),J.error("Failed to load PDF preview")}finally{h(!1)}})()},[c,r?.id,u]),v.useEffect(()=>()=>{u&&URL.revokeObjectURL(u)},[u]);const E=async()=>{if(!r?.templateConfig){J.warning("Template config is not available");return}window.open(r.templateConfig,"_blank","noopener,noreferrer")},P=()=>{t(je.TEMPLATES)},T=()=>{r?.templateConfig?window.open(r.templateConfig,"_blank","noopener,noreferrer"):J.warning("Template config is not available")},O=async()=>{if(r?.id)try{S(!0),await tr.reviewTemplate(r.id,{action:"PUBLISHED"}),J.success("Template approved successfully"),x(!1),t(je.TEMPLATES)}catch(Z){console.error("Error approving template:",Z),J.error(Z.response?.data?.message||"Failed to approve template")}finally{S(!1)}},_=async()=>{if(r?.id){if(!j.trim()){J.warning("Please provide a reason for rejection");return}try{S(!0),await tr.reviewTemplate(r.id,{action:"REJECTED",comment:j.trim()}),J.success("Template rejected successfully"),b(!1),y(""),t(je.TEMPLATES)}catch(Z){console.error("Error rejecting template:",Z),J.error(Z.response?.data?.message||"Failed to reject template")}finally{S(!1)}}},C=()=>{x(!0)},R=()=>{x(!1)},M=()=>{b(!0)},U=()=>{b(!1),y("")};return n?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading template details..."})]})}):o?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:o}),s.jsxs(te,{variant:"outline-danger",onClick:P,children:[s.jsx(At,{className:"me-2"}),"Back to Template List"]})]})}):r?s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{xs:12,children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:P,className:"me-3",children:[s.jsx(At,{className:"me-1",size:16}),"Back to List"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1 text-dark",children:r.name}),s.jsx("p",{className:"text-muted mb-0",children:r.description})]})]}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsx(yt,{permission:Te.APPROVE_DENY_TEMPLATE,fallback:null,children:s.jsxs(te,{variant:"success",size:"sm",onClick:C,className:"d-flex align-items-center",disabled:r?.status!=="PENDING"||w,children:[s.jsx(Je,{className:"me-2",size:16}),"Approve"]})}),s.jsx(yt,{permission:Te.APPROVE_DENY_TEMPLATE,fallback:null,children:s.jsxs(te,{variant:"danger",size:"sm",onClick:M,className:"d-flex align-items-center",disabled:r?.status!=="PENDING"||w,children:[s.jsx(Qr,{className:"me-2",size:16}),"Reject"]})}),s.jsx(yt,{permission:Te.DOWNLOAD_TEMPLATE_AS_PDF,fallback:null,children:s.jsxs(te,{variant:"primary",size:"sm",onClick:E,className:"d-flex align-items-center",disabled:!r?.templateConfig,children:[s.jsx(tl,{className:"me-1",size:16}),"Download PDF"]})})]})]})})}),s.jsx(de,{children:s.jsx(H,{xs:12,children:s.jsxs(W,{className:"border-neutral-200 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary-custom border-neutral-200 p-0",children:s.jsxs("div",{className:"custom-tabs",children:[s.jsx("button",{className:`custom-tab ${c==="basic-info"?"active":""}`,onClick:()=>d("basic-info"),children:"Basic Info"}),s.jsx("button",{className:`custom-tab ${c==="preview"?"active":""}`,onClick:()=>d("preview"),children:"Preview"}),s.jsx("button",{className:`custom-tab ${c==="old-version"?"active":""}`,onClick:()=>d("old-version"),children:"Old Template Version Details"})]})}),s.jsxs(W.Body,{className:"p-0",children:[c==="basic-info"&&s.jsx(ace,{template:r}),c==="preview"&&s.jsx(ice,{template:r,pdfUrl:u,loadingPDF:f,onViewTemplateConfig:T}),c==="old-version"&&s.jsx(oce,{template:r})]})]})})}),s.jsx(lce,{show:p,onHide:R,template:r,onApprove:O,reviewing:w}),s.jsx(cce,{show:g,onHide:U,template:r,rejectComment:j,onRejectCommentChange:y,onReject:_,reviewing:w})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"warning",children:[s.jsx(De.Heading,{children:"Template Not Found"}),s.jsx("p",{children:"The requested template could not be found."}),s.jsxs(te,{variant:"outline-warning",onClick:P,children:[s.jsx(At,{className:"me-2"}),"Back to Template List"]})]})})},dce=()=>{const e=tt(),[t,r]=v.useState("upcoming-assessments"),a=[{id:"upcoming-assessments",title:"List Upcoming Assessment",icon:fa,description:"View and manage upcoming assessments",color:"primary"},{id:"assessment-results",title:"List Assessment Result",icon:Je,description:"Review completed assessment results",color:"success"},{id:"instructed-courses",title:"List Instructed Course",icon:Dt,description:"Manage your instructed courses",color:"info"}],n=[{title:"Configure Signature",description:"Set up your digital signature for assessments",icon:_n,path:je.TRAINER_CONFIGURE_SIGNATURE,color:"warning"},{title:"Section Required Completion",description:"Review sections that require completion",icon:rr,path:"/trainer/section-completion",color:"danger"},{title:"Assessment Result Details",description:"View detailed assessment results",icon:Ju,path:je.ASSESSMENTS_RESULTS,color:"secondary"},{title:"Result Approval Note",description:"Manage result approval notes",icon:Je,path:"/trainer/approval-notes",color:"success"}],i=()=>{switch(t){case"upcoming-assessments":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Upcoming Assessments"}),s.jsxs(de,{children:[s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(W,{className:"h-100",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Assessment Schedule"})}),s.jsx(W.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(fa,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No upcoming assessments"}),s.jsx("p",{className:"text-muted small",children:"You don't have any upcoming assessments scheduled."})]})})]})}),s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(W,{className:"h-100",children:[s.jsx(W.Header,{className:"bg-success text-white",children:s.jsx("h6",{className:"mb-0",children:"Quick Actions"})}),s.jsx(W.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(te,{variant:"outline-primary",size:"sm",children:[s.jsx(fa,{size:16,className:"me-2"}),"Schedule Assessment"]}),s.jsxs(te,{variant:"outline-success",size:"sm",children:[s.jsx(rr,{size:16,className:"me-2"}),"View All Assessments"]})]})})]})})]})]});case"assessment-results":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Assessment Results"}),s.jsxs(de,{children:[s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(W,{className:"h-100",children:[s.jsx(W.Header,{className:"bg-success text-white",children:s.jsx("h6",{className:"mb-0",children:"Recent Results"})}),s.jsx(W.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Je,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No recent results"}),s.jsx("p",{className:"text-muted small",children:"Assessment results will appear here once completed."})]})})]})}),s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(W,{className:"h-100",children:[s.jsx(W.Header,{className:"bg-info text-white",children:s.jsx("h6",{className:"mb-0",children:"Statistics"})}),s.jsx(W.Body,{children:s.jsx("div",{className:"text-center",children:s.jsxs("div",{className:"row text-center",children:[s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-primary",children:"0"}),s.jsx("small",{className:"text-muted",children:"Completed"})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-warning",children:"0"}),s.jsx("small",{className:"text-muted",children:"Pending"})]}),s.jsxs("div",{className:"col-4",children:[s.jsx("div",{className:"h4 text-success",children:"0"}),s.jsx("small",{className:"text-muted",children:"Approved"})]})]})})})]})})]})]});case"instructed-courses":return s.jsxs("div",{children:[s.jsx("h4",{className:"mb-4",children:"Instructed Courses"}),s.jsxs(de,{children:[s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(W,{className:"h-100",children:[s.jsx(W.Header,{className:"bg-info text-white",children:s.jsx("h6",{className:"mb-0",children:"My Courses"})}),s.jsx(W.Body,{children:s.jsxs("div",{className:"text-center py-4",children:[s.jsx(Dt,{size:48,className:"text-muted mb-3"}),s.jsx("h6",{className:"text-muted",children:"No courses assigned"}),s.jsx("p",{className:"text-muted small",children:"You haven't been assigned to instruct any courses yet."})]})})]})}),s.jsx(H,{md:6,className:"mb-3",children:s.jsxs(W,{className:"h-100",children:[s.jsx(W.Header,{className:"bg-warning text-white",children:s.jsx("h6",{className:"mb-0",children:"Course Management"})}),s.jsx(W.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(te,{variant:"outline-primary",size:"sm",children:[s.jsx(Dt,{size:16,className:"me-2"}),"View All Courses"]}),s.jsxs(te,{variant:"outline-info",size:"sm",children:[s.jsx(Ke,{size:16,className:"me-2"}),"Course Schedule"]})]})})]})})]})]});default:return null}};return s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsxs(H,{children:[s.jsx("h2",{className:"mb-2",children:"Trainer Dashboard"}),s.jsx("p",{className:"text-muted",children:"Manage your assessments, courses, and training activities"})]})}),s.jsxs(de,{children:[s.jsx(H,{lg:3,className:"mb-4",children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsx("h5",{className:"mb-0",children:"Navigation"})}),s.jsx(W.Body,{className:"p-0",children:s.jsx("div",{className:"list-group list-group-flush",children:a.map(o=>{const l=o.icon;return s.jsx("button",{className:`list-group-item list-group-item-action border-0 ${t===o.id?"active":""}`,onClick:()=>r(o.id),style:{backgroundColor:t===o.id?"#0d6efd":"transparent",color:t===o.id?"white":"inherit",border:"none",borderRadius:0},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(l,{size:20,className:"me-3",style:{color:t===o.id?"white":`var(--bs-${o.color})`}}),s.jsxs("div",{className:"flex-grow-1 text-start",children:[s.jsx("h6",{className:"mb-1",children:o.title}),s.jsx("small",{className:"text-muted",children:o.description})]}),s.jsx(un,{size:16})]})},o.id)})})})]})}),s.jsx(H,{lg:9,children:s.jsx(W,{className:"border-0 shadow-sm",children:s.jsx(W.Body,{className:"p-4",children:i()})})})]}),s.jsx(de,{className:"mt-4",children:s.jsx(H,{children:s.jsx("h4",{className:"mb-3",children:"Quick Actions"})})}),s.jsx(de,{children:n.map((o,l)=>{const c=o.icon;return s.jsx(H,{lg:6,xl:3,className:"mb-4",children:s.jsx(W,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(o.path),onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-5px)",d.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:s.jsxs(W.Body,{className:"p-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:`bg-${o.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:s.jsx(c,{size:24})}),s.jsx("div",{className:"flex-grow-1",children:s.jsx("h5",{className:"mb-1",children:o.title})}),s.jsx(un,{size:20,className:"text-muted"})]}),s.jsx("p",{className:"text-muted mb-0",children:o.description})]})})},l)})})]})},bo=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:a,className:n=""})=>{const i=t.length>0;return s.jsxs(St,{className:`filter-panel-dropdown ${n}`,children:[s.jsx(St.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(oo,{size:14,className:"me-2"}),"Filters",i&&s.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),s.jsxs(St.Menu,{className:"course-filter-menu",style:{width:"100%",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"-1px",top:"100%",left:0,transform:"none",position:"absolute",borderTopLeftRadius:0,borderTopRightRadius:0},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[s.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&s.jsx(te,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:s.jsx(st,{size:12})})]}),s.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(o=>s.jsx(k.Check,{type:"checkbox",id:`status-${o}`,label:o,checked:t.includes(o),onChange:()=>r(o),className:"mb-1"},o))})]}),i&&s.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:s.jsxs(te,{variant:"outline-danger",size:"sm",className:"w-100",onClick:a,children:[s.jsx(st,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},uce=()=>{const e=tt(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,o]=v.useState(null),[l,c]=v.useState(""),[d,u]=v.useState([]),[m,f]=v.useState("course");v.useEffect(()=>{(async()=>{try{n(!0),o(null);const O=await Sr.getUserEvents();if(O?.success&&O?.data?.events){const _=O.data.events.map(C=>{const R=new Date(C.occuranceDate),M=R.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),U=R.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),Z=C.entityInfo?.type||(C.subjectId?"subject":"course");return{id:C.id||`${C.courseId}-${C.subjectId}-${C.occuranceDate}`,title:C.name,entityInfo:C.entityInfo,entityType:Z,entityId:Z==="course"?C.entityInfo?.id||C.courseId:C.entityInfo?.id||C.subjectId,entityName:C.entityInfo?.name||"N/A",entityCode:C.entityInfo?.code||"",courseName:Z==="course"?C.entityInfo?.name:null,courseCode:Z==="course"?C.entityInfo?.code:null,subjectName:Z==="subject"?C.entityInfo?.name:null,subjectCode:Z==="subject"?C.entityInfo?.code:null,traineeCount:C.totalTrainees||0,scheduledDate:M,scheduledTime:U,occurrenceDate:C.occuranceDate,status:C.status||"NOT_STARTED",templateInfo:C.templateInfo,resultScore:C.resultScore||null,resultText:C.resultText||null}});r(_)}else r([])}catch(O){console.error("Error fetching assessments:",O),o("Failed to load upcoming assessments"),J.error("Failed to load upcoming assessments")}finally{n(!1)}})()},[]);const h={NOT_STARTED:{variant:"secondary",text:"Not Started"},ON_GOING:{variant:"info",text:"On Going"},APPROVED:{variant:"success",text:"Approved"},COMPLETED:{variant:"success",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},DRAFT:{variant:"primary",text:"Draft"},SUBMITTED:{variant:"dark",text:"Submitted"},CANCELLED:{variant:"danger",text:"Cancelled"}},p=T=>{const O=h[T]||{variant:"secondary",text:T||"Unknown"};return s.jsx(ke,{bg:O.variant,children:O.text})},x=async T=>{try{n(!0);const O=new Date(T.occurrenceDate).toISOString().split("T")[0];let _;const C={courseId:m==="course"?T.entityId:void 0,subjectId:m==="subject"?T.entityId:void 0,templateId:T.templateInfo?.id,occuranceDate:O};Object.keys(C).forEach(R=>C[R]===void 0&&delete C[R]),m==="course"?_=await Sr.getCourseEvents(C):_=await Sr.getSubjectEvents(C),_?.assessments&&_?.eventInfo?e(je.ASSESSMENTS_ASSIGN(m,T.entityId),{state:{name:_.eventInfo?.name||T.entityName,code:_.eventInfo?.entityInfo?.code||T.entityCode,template:_.eventInfo?.name||T.templateInfo?.name,assessments:_.assessments,eventInfo:_.eventInfo}}):J.error("Failed to access assessment")}catch(O){console.error("Error accessing assessment:",O),J.error("Error accessing assessment")}finally{n(!1)}},g=[...new Set(t.map(T=>T.status))],b=t.filter(T=>{const O=d.length===0||d.includes(T.status),_=T.entityType===m,C=T.title.toLowerCase().includes(l.toLowerCase())||T.entityName.toLowerCase().includes(l.toLowerCase())||T.entityCode&&T.entityCode.toLowerCase().includes(l.toLowerCase());return O&&_&&C}),j=T=>{u(T==="clear"?[]:O=>O.includes(T)?O.filter(_=>_!==T):[...O,T])},y=()=>{u([]),c("")},{sortedData:w,sortConfig:S,handleSort:N}=_r(b);if(a)return s.jsx(nr,{rows:5,columns:7});if(i)return s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(Button,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});const E=({columnKey:T,children:O,className:_=""})=>{const C=S.key===T,R=C?S.direction:null;return s.jsxs("th",{className:`fw-semibold ${_}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>N(T),onMouseEnter:M=>{M.target.style.backgroundColor="#214760",M.target.style.transform="translateY(-1px)",M.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:M=>{M.target.style.backgroundColor="var(--bs-primary)",M.target.style.transform="translateY(0)",M.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:C?"600":"500",color:"white"},children:O}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:R,size:14,color:"white"})})]}),C&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})},P=new Set(["NOT_STARTED","SUBMITTED","APPROVED","CANCELLED"]);return s.jsxs("div",{children:[s.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:5,md:4,className:"mb-2 mb-lg-0 ps-2 ps-lg-3",children:s.jsx(ws,{placeholder:"Search assessments, courses, or trainees...",value:l,onChange:c,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:s.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[s.jsx("label",{className:"text-muted small mb-0 me-2",children:"View:"}),s.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[s.jsx("input",{type:"radio",className:"btn-check",name:"entityFilter",id:"filter-course",checked:m==="course",onChange:()=>f("course")}),s.jsxs("label",{className:`btn btn-sm ${m==="course"?"btn-primary-custom text-white":"btn-outline-primary"}`,htmlFor:"filter-course",style:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.35rem 0.9rem"},children:[s.jsx(Dt,{size:14}),"Course"]}),s.jsx("input",{type:"radio",className:"btn-check",name:"entityFilter",id:"filter-subject",checked:m==="subject",onChange:()=>f("subject")}),s.jsxs("label",{className:`btn btn-sm ${m==="subject"?"btn-secondary-custom text-white":"btn-outline-secondary"}`,htmlFor:"filter-subject",style:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.35rem 0.9rem"},children:[s.jsx(zd,{size:14}),"Subject"]})]})]})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(bo,{uniqueStatuses:g,selectedStatuses:d,onStatusToggle:j,onClearFilters:y,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(E,{columnKey:"title",className:"show-mobile",children:"Assessment"}),s.jsx(E,{columnKey:m==="course"?"courseName":"subjectName",className:"show-mobile",children:m==="course"?"Course":"Subject"}),s.jsx(E,{columnKey:"traineeCount",className:"show-mobile",children:"Trainees"}),s.jsx(E,{columnKey:"scheduledDate",className:"show-mobile",children:"Date & Time"}),s.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:w.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"text-center py-4 text-muted",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:"No upcoming assessments found"}),s.jsx("small",{children:"Try adjusting your search criteria or schedule a new assessment."})]})})}):w.map(T=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:T.title}),T.templateInfo&&s.jsxs("small",{className:"text-muted",children:[s.jsx(zd,{size:12,className:"me-1"}),T.templateInfo.name]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:m==="course"?T.courseName?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{size:16,className:"me-2 text-primary"}),s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("span",{className:"fw-medium",children:T.courseName}),T.courseCode&&s.jsx("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:T.courseCode})]})]}):s.jsx("span",{className:"text-muted",children:"-"}):T.subjectName?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(zd,{size:16,className:"me-2 text-success"}),s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx("span",{className:"fw-medium",children:T.subjectName}),T.subjectCode&&s.jsx("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:T.subjectCode})]})]}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted"}),s.jsxs("span",{children:[T.traineeCount," ",T.traineeCount===1?"trainee":"trainees"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{className:"fw-medium",children:T.scheduledDate})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:p(T.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:!P.has(T.status)&&s.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>x(T),disabled:a,children:a?"Processing...":"Access"})})]},T.id))})]})})]})},mce=()=>{const t=[{id:"upcoming-assessments",title:"Upcoming Assessments",icon:fa,component:s.jsx(uce,{})}][0];return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(W,{className:"border-0",children:[s.jsx(W.Header,{className:"bg-primary text-white p-3",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(fa,{size:20,className:"me-2"}),s.jsx("h5",{className:"mb-0",children:"Upcoming Assessments"})]})}),s.jsx(W.Body,{className:"p-0",children:t&&t.component})]})})})})},fce=()=>{const e=tt(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,o]=v.useState(null),[l,c]=v.useState("all"),[d,u]=v.useState(""),[m,f]=v.useState([]),{sortedData:h,sortConfig:p,handleSort:x}=_r(t);v.useEffect(()=>{(async()=>{try{n(!0),await new Promise(C=>setTimeout(C,1e3)),r([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",completedDate:"2024-01-10",score:85,maxScore:100,status:"completed",grade:"B+",duration:"115 minutes",attempts:1},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",completedDate:"2024-01-09",score:92,maxScore:100,status:"completed",grade:"A-",duration:"88 minutes",attempts:1},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",completedDate:"2024-01-08",score:78,maxScore:100,status:"completed",grade:"C+",duration:"142 minutes",attempts:2},{id:4,title:"Regulatory Assessment - Part 121",course:"Aviation Regulations",trainee:"Sarah Wilson",completedDate:"2024-01-07",score:95,maxScore:100,status:"completed",grade:"A",duration:"95 minutes",attempts:1},{id:5,title:"Emergency Procedures Assessment",course:"Crisis Management",trainee:"David Brown",completedDate:"2024-01-06",score:65,maxScore:100,status:"failed",grade:"D",duration:"120 minutes",attempts:1}])}catch{o("Failed to load assessment results")}finally{n(!1)}})()},[]);const g=O=>{const C={completed:{variant:"success",text:"Completed",icon:Je},failed:{variant:"danger",text:"Failed",icon:Qr},inProgress:{variant:"warning",text:"In Progress",icon:Ke},pending:{variant:"info",text:"Pending Review",icon:Ke}}[O]||{variant:"secondary",text:O,icon:Ke},R=C.icon;return s.jsxs(ke,{bg:C.variant,className:"d-flex align-items-center",children:[s.jsx(R,{size:12,className:"me-1"}),C.text]})},b=O=>O.startsWith("A")?"success":O.startsWith("B")?"primary":O.startsWith("C")?"warning":O.startsWith("D")?"danger":"secondary",j=(O,_)=>{const C=O/_*100;return C>=90?"success":C>=80?"primary":C>=70?"warning":"danger"},y=[...new Set(t.map(O=>O.status))],w=t.filter(O=>{const _=m.length===0||m.includes(O.status),C=O.title.toLowerCase().includes(d.toLowerCase())||O.trainee.toLowerCase().includes(d.toLowerCase())||O.course.toLowerCase().includes(d.toLowerCase());return _&&C}),S=O=>{f(O==="clear"?[]:_=>_.includes(O)?_.filter(C=>C!==O):[..._,O])},N=()=>{f([]),u("")},E=O=>{e(`/trainer/assessment-details/${O}`)},P=O=>{console.log("Downloading result:",O)};if(a)return s.jsx(nr,{rows:5,columns:7});if(i)return s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(te,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No assessment results found"}),s.jsx("p",{children:"Try adjusting your search criteria or check back later."})]})});const T=({columnKey:O,children:_,className:C=""})=>{const R=p.key===O,M=R?p.direction:null;return s.jsxs("th",{className:`fw-semibold ${C}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>x(O),onMouseEnter:U=>{U.target.style.backgroundColor="#214760",U.target.style.transform="translateY(-1px)",U.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:U=>{U.target.style.backgroundColor="var(--bs-primary)",U.target.style.transform="translateY(0)",U.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:R?"600":"500",color:"white"},children:_}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:M,size:14,color:"white"})})]}),R&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search assessments, trainees, or courses...",value:d,onChange:u,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(bo,{uniqueStatuses:y,selectedStatuses:m,onStatusToggle:S,onClearFilters:N,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," result",w.length!==1?"s":""]})})})]}),w.length===0?s.jsx(W,{className:"text-center py-5",children:s.jsxs(W.Body,{children:[s.jsx(Je,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No Results Found"}),s.jsx("p",{className:"text-muted",children:d||l!=="all"?"No assessment results match your current filters.":"No assessment results available yet."}),(d||l!=="all")&&s.jsx(te,{variant:"outline-primary",onClick:()=>{u(""),c("all")},children:"Clear Filters"})]})}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(T,{columnKey:"title",className:"show-mobile",children:"Assessment"}),s.jsx(T,{columnKey:"course",className:"show-mobile",children:"Course"}),s.jsx(T,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),s.jsx(T,{columnKey:"score",className:"show-mobile",children:"Score"}),s.jsx(T,{columnKey:"grade",className:"hide-mobile",children:"Grade"}),s.jsx(T,{columnKey:"completedDate",className:"show-mobile",children:"Completed"}),s.jsx(T,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:h.map(O=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:O.title}),s.jsxs("small",{className:"text-muted",children:["Attempt ",O.attempts,"  ",O.duration]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:O.course})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:O.trainee})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`fw-bold text-${j(O.score,O.maxScore)}`,children:[O.score,"/",O.maxScore]}),s.jsxs("small",{className:"text-muted ms-2",children:["(",Math.round(O.score/O.maxScore*100),"%)"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx(ke,{bg:b(O.grade),className:"fs-6",children:O.grade})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("div",{children:s.jsx("div",{className:"fw-medium",children:O.completedDate})})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:g(O.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>E(O.id)},{label:"Download Report",icon:s.jsx(fi,{}),onClick:()=>P(O.id)}]})})]},O.id))})]})})]})},hce=()=>s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(fce,{})}),pce=()=>{const e=tt(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,o]=v.useState(null),[l,c]=v.useState("all"),[d,u]=v.useState(""),[m,f]=v.useState([]),{sortedData:h,sortConfig:p,handleSort:x}=_r(t);v.useEffect(()=>{(async()=>{try{n(!0),await new Promise(_=>setTimeout(_,1e3)),r([{id:1,title:"Aviation Safety Management",code:"ASM-101",department:"Safety & Security",status:"active",startDate:"2024-01-15",endDate:"2024-03-15",enrolledTrainees:25,maxTrainees:30,totalSubjects:8,completedSubjects:3,instructor:"Dr. John Smith",location:"Training Center A",schedule:"Mon, Wed, Fri 9:00-12:00"},{id:2,title:"Aircraft Maintenance Fundamentals",code:"AMF-201",department:"Maintenance",status:"active",startDate:"2024-01-20",endDate:"2024-04-20",enrolledTrainees:18,maxTrainees:20,totalSubjects:12,completedSubjects:5,instructor:"Jane Doe",location:"Lab B",schedule:"Tue, Thu 14:00-17:00"},{id:3,title:"Flight Operations Management",code:"FOM-301",department:"Operations",status:"scheduled",startDate:"2024-02-01",endDate:"2024-05-01",enrolledTrainees:0,maxTrainees:15,totalSubjects:10,completedSubjects:0,instructor:"Mike Johnson",location:"Simulator Room",schedule:"Mon-Fri 8:00-16:00"},{id:4,title:"Aviation Regulations & Compliance",code:"ARC-401",department:"Compliance",status:"completed",startDate:"2023-10-01",endDate:"2023-12-15",enrolledTrainees:22,maxTrainees:25,totalSubjects:6,completedSubjects:6,instructor:"Sarah Wilson",location:"Conference Room C",schedule:"Sat 9:00-17:00"},{id:5,title:"Emergency Response Procedures",code:"ERP-501",department:"Safety & Security",status:"paused",startDate:"2024-01-10",endDate:"2024-02-28",enrolledTrainees:12,maxTrainees:20,totalSubjects:4,completedSubjects:1,instructor:"David Brown",location:"Training Center B",schedule:"Wed, Fri 10:00-14:00"}])}catch{o("Failed to load instructed courses")}finally{n(!1)}})()},[]);const g=T=>{const _={active:{variant:"success",text:"Active"},scheduled:{variant:"primary",text:"Scheduled"},completed:{variant:"secondary",text:"Completed"},paused:{variant:"warning",text:"Paused"},cancelled:{variant:"danger",text:"Cancelled"}}[T]||{variant:"secondary",text:T};return s.jsx(ke,{bg:_.variant,children:_.text})},b=(T,O)=>O>0?Math.round(T/O*100):0,j=(T,O)=>O>0?Math.round(T/O*100):0,y=[...new Set(t.map(T=>T.status))],w=t.filter(T=>{const O=m.length===0||m.includes(T.status),_=T.title.toLowerCase().includes(d.toLowerCase())||T.code.toLowerCase().includes(d.toLowerCase())||T.department.toLowerCase().includes(d.toLowerCase());return O&&_}),S=T=>{f(T==="clear"?[]:O=>O.includes(T)?O.filter(_=>_!==T):[...O,T])},N=()=>{f([]),u("")},E=T=>{e(je.COURSES_DETAIL(T))};if(a)return s.jsx(nr,{rows:5,columns:7});if(i)return s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:i}),s.jsx(te,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No instructed courses found"}),s.jsx("p",{children:"Try adjusting your search criteria or create a new course."})]})});const P=({columnKey:T,children:O,className:_=""})=>{const C=p.key===T,R=C?p.direction:null;return s.jsxs("th",{className:`fw-semibold ${_}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>x(T),onMouseEnter:M=>{M.target.style.backgroundColor="#214760",M.target.style.transform="translateY(-1px)",M.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:M=>{M.target.style.backgroundColor="var(--bs-primary)",M.target.style.transform="translateY(0)",M.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:C?"600":"500",color:"white"},children:O}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:R,size:14,color:"white"})})]}),C&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search courses, codes, or departments...",value:d,onChange:u,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(bo,{uniqueStatuses:y,selectedStatuses:m,onStatusToggle:S,onClearFilters:N,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),w.length===0?s.jsx(W,{className:"text-center py-5",children:s.jsxs(W.Body,{children:[s.jsx(Dt,{size:64,className:"text-muted mb-3"}),s.jsx("h5",{className:"text-muted",children:"No Courses Found"}),s.jsx("p",{className:"text-muted",children:d||l!=="all"?"No courses match your current filters.":"You haven't been assigned to instruct any courses yet."}),d||m.length>0?s.jsx(te,{variant:"outline-primary",onClick:N,children:"Clear Filters"}):null]})}):s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(P,{columnKey:"title",className:"show-mobile",children:"Course"}),s.jsx(P,{columnKey:"department",className:"show-mobile",children:"Department"}),s.jsx(P,{columnKey:"schedule",className:"hide-mobile",children:"Schedule"}),s.jsx(P,{columnKey:"enrollment",className:"show-mobile",children:"Enrollment"}),s.jsx(P,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),s.jsx(P,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:h.map(T=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:T.title}),s.jsxs("small",{className:"text-muted",children:[T.code,"  ",T.location]}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:[s.jsx(or,{size:12,className:"me-1"}),T.startDate," - ",T.endDate]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsx("span",{className:"text-muted",children:T.department})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:T.schedule}),s.jsx("small",{className:"text-muted",children:T.instructor})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Mr,{size:16,className:"me-2 text-muted"}),s.jsxs("span",{className:"fw-medium",children:[T.enrolledTrainees,"/",T.maxTrainees]})]}),s.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:s.jsx("div",{className:"progress-bar bg-info",style:{width:`${j(T.enrolledTrainees,T.maxTrainees)}%`}})}),s.jsxs("small",{className:"text-muted",children:[j(T.enrolledTrainees,T.maxTrainees),"% full"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{size:16,className:"me-2 text-muted"}),s.jsxs("span",{className:"fw-medium",children:[T.completedSubjects,"/",T.totalSubjects]})]}),s.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:s.jsx("div",{className:"progress-bar bg-success",style:{width:`${b(T.completedSubjects,T.totalSubjects)}%`}})}),s.jsxs("small",{className:"text-muted",children:[b(T.completedSubjects,T.totalSubjects),"% complete"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:g(T.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Course Detail",icon:s.jsx(Bt,{}),onClick:()=>E(T.id)}]})})]},T.id))})]})})]})},xce=()=>s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(pce,{})}),gce=({courseId:e})=>{const t=tt(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState(""),[u,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(P=>setTimeout(P,1e3)),a([{id:1,title:"Safety Procedures - Module 1",code:"SP-101",duration:"2 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-20",progress:100,description:"Introduction to aviation safety procedures and protocols"},{id:2,title:"Risk Assessment Fundamentals",code:"RAF-102",duration:"3 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-25",progress:100,description:"Understanding risk assessment methodologies in aviation"},{id:3,title:"Emergency Response Protocols",code:"ERP-103",duration:"2.5 hours",status:"in_progress",instructor:"Dr. Smith",completionDate:null,progress:65,description:"Emergency response procedures and communication protocols"},{id:4,title:"Regulatory Compliance",code:"RC-104",duration:"4 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Understanding aviation regulations and compliance requirements"},{id:5,title:"Safety Management Systems",code:"SMS-105",duration:"3.5 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Implementation and management of safety management systems"}])}catch(E){l("Failed to load subjects"),console.error("Error fetching subjects:",E)}finally{i(!1)}})()},[e]);const f=N=>{const P={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[N]||{variant:"secondary",text:"Unknown"};return s.jsx(ke,{bg:P.variant,children:P.text})},h=N=>{t(je.SUBJECTS_DETAIL(N))},p=[...new Set(r.map(N=>N.status))],x=r.filter(N=>{const E=u.length===0||u.includes(N.status),P=N.title.toLowerCase().includes(c.toLowerCase())||N.code.toLowerCase().includes(c.toLowerCase())||N.description.toLowerCase().includes(c.toLowerCase());return E&&P}),g=N=>{m(N==="clear"?[]:E=>E.includes(N)?E.filter(P=>P!==N):[...E,N])},b=()=>{m([]),d("")},{sortedData:j,sortConfig:y,handleSort:w}=_r(x);if(n)return s.jsx(nr,{rows:5,columns:6});if(o)return s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:o}),s.jsx(te,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(x.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})});const S=({columnKey:N,children:E,className:P=""})=>{const T=y.key===N,O=T?y.direction:null;return s.jsxs("th",{className:`fw-semibold ${P}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>w(N),onMouseEnter:_=>{_.target.style.backgroundColor="#214760",_.target.style.transform="translateY(-1px)",_.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:_=>{_.target.style.backgroundColor="var(--bs-primary)",_.target.style.transform="translateY(0)",_.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:T?"600":"500",color:"white"},children:E}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:O,size:14,color:"white"})})]}),T&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search subjects...",value:c,onChange:d,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(bo,{uniqueStatuses:p,selectedStatuses:u,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(S,{columnKey:"title",className:"show-mobile",children:"Subject"}),s.jsx(S,{columnKey:"code",className:"show-mobile",children:"Code"}),s.jsx(S,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),s.jsx(S,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(S,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:j.map(N=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:N.title}),s.jsx("small",{className:"text-muted",children:N.description})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:N.code})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:N.duration})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:f(N.status)}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${N.progress}%`},"aria-valuenow":N.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),s.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>h(N.id)}]})})]},N.id))})]})})]})},vce=({courseId:e})=>{const t=tt(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState(""),[u,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(P=>setTimeout(P,1e3)),a([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"active",progress:75,lastActivity:"2024-01-20",completedSubjects:6,totalSubjects:8},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"active",progress:60,lastActivity:"2024-01-19",completedSubjects:5,totalSubjects:8},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"completed",progress:100,lastActivity:"2024-01-25",completedSubjects:8,totalSubjects:8},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"inactive",progress:25,lastActivity:"2024-01-22",completedSubjects:2,totalSubjects:8},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"active",progress:40,lastActivity:"2024-01-23",completedSubjects:3,totalSubjects:8}])}catch(E){l("Failed to load trainees"),console.error("Error fetching trainees:",E)}finally{i(!1)}})()},[e]);const f=N=>{const P={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[N]||{variant:"secondary",text:"Unknown"};return s.jsx(ke,{bg:P.variant,children:P.text})},h=N=>{t(je.USERS_DETAIL(N))},p=[...new Set(r.map(N=>N.status))],x=r.filter(N=>{const E=u.length===0||u.includes(N.status),P=N.name.toLowerCase().includes(c.toLowerCase())||N.email.toLowerCase().includes(c.toLowerCase())||N.employeeId.toLowerCase().includes(c.toLowerCase())||N.department.toLowerCase().includes(c.toLowerCase());return E&&P}),g=N=>{m(N==="clear"?[]:E=>E.includes(N)?E.filter(P=>P!==N):[...E,N])},b=()=>{m([]),d("")},{sortedData:j,sortConfig:y,handleSort:w}=_r(x);if(n)return s.jsx(nr,{rows:5,columns:7});if(o)return s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:o}),s.jsx(te,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(x.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})});const S=({columnKey:N,children:E,className:P=""})=>{const T=y.key===N,O=T?y.direction:null;return s.jsxs("th",{className:`fw-semibold ${P}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>w(N),onMouseEnter:_=>{_.target.style.backgroundColor="#214760",_.target.style.transform="translateY(-1px)",_.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:_=>{_.target.style.backgroundColor="var(--bs-primary)",_.target.style.transform="translateY(0)",_.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:T?"600":"500",color:"white"},children:E}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:O,size:14,color:"white"})})]}),T&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search trainees...",value:c,onChange:d,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(bo,{uniqueStatuses:p,selectedStatuses:u,onStatusToggle:g,onClearFilters:b,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(S,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(S,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),s.jsx(S,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(S,{columnKey:"enrollmentDate",className:"show-mobile",children:"Enrollment Date"}),s.jsx(S,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(S,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:j.map(N=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:N.name}),s.jsx("small",{className:"text-muted",children:N.email})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:N.employeeId})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-muted",children:N.department})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:N.enrollmentDate}),s.jsxs("small",{className:"text-muted",children:["Last activity: ",N.lastActivity]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:f(N.status)}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${N.progress}%`},"aria-valuenow":N.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),s.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Profile",icon:s.jsx(Bt,{}),onClick:()=>h(N.id)}]})})]},N.id))})]})})]})},A2=()=>{const{courseId:e}=ur(),t=tt(),[r,a]=v.useState("subjects"),[n,i]=v.useState(null),[o,l]=v.useState(!0),[c,d]=v.useState(null);v.useEffect(()=>{(async()=>{try{l(!0),await new Promise(p=>setTimeout(p,1e3)),i({id:e,title:"Aviation Safety Management",code:"ASM-101",department:"Aviation Department",instructor:"Dr. Smith",startDate:"2024-01-15",endDate:"2024-03-15",status:"active",location:"Training Room A",schedule:"Mon, Wed, Fri 09:00-12:00",description:"Comprehensive course covering aviation safety management systems, risk assessment, and regulatory compliance.",maxEnrollment:30,currentEnrollment:25,completedSubjects:8,totalSubjects:12})}catch(h){d("Failed to load course details"),console.error("Error fetching course:",h)}finally{l(!1)}})()},[e]);const u=[{id:"subjects",title:"Subject List",icon:Dt,component:s.jsx(gce,{courseId:e})},{id:"trainees",title:"Trainee List",icon:Mr,component:s.jsx(vce,{courseId:e})}],m=u.find(f=>f.id===r);return o?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):c?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:c})]})}):n?s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(je.COURSES_INSTRUCTED),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:n.title}),s.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.department]})]})]})})}),s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(W,{className:"border-0",children:[s.jsx(W.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:u.map(f=>{const h=f.icon,p=r===f.id;return s.jsxs("button",{className:`custom-tab ${p?"active":""}`,onClick:()=>a(f.id),children:[s.jsx(h,{size:16,className:"me-2"}),f.title]},f.id)})})}),s.jsx(W.Body,{className:"p-0",children:m&&m.component})]})})})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"warning",children:[s.jsx(De.Heading,{children:"Course Not Found"}),s.jsx("p",{children:"The requested course could not be found."})]})})},yce=()=>{const{traineeId:e}=ur(),t=tt(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(m=>setTimeout(m,1e3)),a({id:e,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",position:"Operations Manager",phone:"+1-555-0123",enrollmentDate:"2024-01-15",status:"active",lastActivity:"2024-01-20",completedCourses:3,totalCourses:5,completedSubjects:12,totalSubjects:20,averageScore:85,certifications:[{name:"Aviation Safety Management",date:"2024-01-20",status:"completed"},{name:"Risk Assessment",date:"2024-01-25",status:"completed"},{name:"Emergency Response",date:"2024-02-01",status:"in_progress"}],currentCourses:[{id:1,name:"Aviation Safety Management",progress:75,instructor:"Dr. Smith"},{id:2,name:"Aircraft Maintenance",progress:45,instructor:"Jane Doe"}]})}catch(u){l("Failed to load trainee details"),console.error("Error fetching trainee:",u)}finally{i(!1)}})()},[e]);const c=d=>{const m={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[d]||{variant:"secondary",text:"Unknown"};return s.jsx(ke,{bg:m.variant,children:m.text})};return n?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):o?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:o})]})}):r?s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:r.name}),s.jsxs("p",{className:"text-muted mb-0",children:[r.employeeId,"  ",r.department]})]})]})})}),s.jsxs(de,{className:"mb-4",children:[s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(Pt,{size:24,className:"text-primary mb-2"}),s.jsx("h6",{className:"mb-1",children:"Status"}),c(r.status)]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(Dt,{size:24,className:"text-success mb-2"}),s.jsx("h6",{className:"mb-1",children:"Courses"}),s.jsxs("h4",{className:"mb-0 text-success",children:[r.completedCourses,"/",r.totalCourses]}),s.jsx("small",{className:"text-muted",children:"Completed"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx("div",{className:"text-info mb-2",children:s.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),s.jsx("h6",{className:"mb-1",children:"Average Score"}),s.jsxs("h4",{className:"mb-0 text-info",children:[r.averageScore,"%"]}),s.jsx("small",{className:"text-muted",children:"Performance"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(or,{size:24,className:"text-warning mb-2"}),s.jsx("h6",{className:"mb-1",children:"Enrolled"}),s.jsx("h4",{className:"mb-0 text-warning",children:r.enrollmentDate}),s.jsx("small",{className:"text-muted",children:"Start Date"})]})})})]}),s.jsxs(de,{className:"mb-4",children:[s.jsx(H,{md:6,children:s.jsxs(W,{children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Contact Information"})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx(Vi,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Email:"})," ",r.email]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Position:"})," ",r.position]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(or,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Last Activity:"})," ",r.lastActivity]})]})]})}),s.jsx(H,{md:6,children:s.jsxs(W,{children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Current Courses"})}),s.jsx(W.Body,{children:r.currentCourses.map(d=>s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[s.jsx("h6",{className:"mb-0",children:d.name}),s.jsxs("small",{className:"text-muted",children:[d.progress,"%"]})]}),s.jsx("div",{className:"progress mb-1",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${d.progress}%`}})}),s.jsxs("small",{className:"text-muted",children:["Instructor: ",d.instructor]})]},d.id))})]})})]}),s.jsx(de,{children:s.jsx(H,{children:s.jsxs(W,{children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Certifications"})}),s.jsx(W.Body,{children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Certification"}),s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Status"})]})}),s.jsx("tbody",{children:r.certifications.map((d,u)=>s.jsxs("tr",{children:[s.jsx("td",{children:d.name}),s.jsx("td",{children:d.date}),s.jsx("td",{children:c(d.status)})]},u))})]})})})]})})})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"warning",children:[s.jsx(De.Heading,{children:"Trainee Not Found"}),s.jsx("p",{children:"The requested trainee could not be found."})]})})},bce=({subjectId:e})=>{const t=tt(),[r,a]=v.useState([]),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState(""),[u,m]=v.useState([]);v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(T=>setTimeout(T,1e3)),a([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(P){l("Failed to load trainees in subject"),console.error("Error fetching trainees:",P)}finally{i(!1)}})()},[e]);const f=E=>{const T={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[E]||{variant:"secondary",text:"Unknown"};return s.jsx(ke,{bg:T.variant,children:T.text})},h=E=>{t(je.USERS_DETAIL(E))},p=E=>{console.log("Send message to trainee:",E)},x=[...new Set(r.map(E=>E.status))],g=r.filter(E=>{const P=u.length===0||u.includes(E.status),T=E.name.toLowerCase().includes(c.toLowerCase())||E.email.toLowerCase().includes(c.toLowerCase())||E.employeeId.toLowerCase().includes(c.toLowerCase())||E.department.toLowerCase().includes(c.toLowerCase());return P&&T}),b=E=>{m(E==="clear"?[]:P=>P.includes(E)?P.filter(T=>T!==E):[...P,E])},j=()=>{m([]),d("")},{sortedData:y,sortConfig:w,handleSort:S}=_r(g);if(n)return s.jsx(nr,{rows:5,columns:7});if(o)return s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:o}),s.jsx(te,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(g.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})});const N=({columnKey:E,children:P,className:T=""})=>{const O=w.key===E,_=O?w.direction:null;return s.jsxs("th",{className:`fw-semibold ${T}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(E),onMouseEnter:C=>{C.target.style.backgroundColor="#214760",C.target.style.transform="translateY(-1px)",C.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:C=>{C.target.style.backgroundColor="var(--bs-primary)",C.target.style.transform="translateY(0)",C.target.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[s.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:O?"600":"500",color:"white"},children:P}),s.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:s.jsx(rs,{direction:_,size:14,color:"white"})})]}),O&&s.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return s.jsxs("div",{children:[s.jsxs(de,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search trainees in this subject...",value:c,onChange:d,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(bo,{uniqueStatuses:x,selectedStatuses:u,onStatusToggle:b,onClearFilters:j,className:"filter-panel-mobile"})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(N,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(N,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),s.jsx(N,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(N,{columnKey:"progress",className:"show-mobile",children:"Progress"}),s.jsx(N,{columnKey:"score",className:"hide-mobile",children:"Score"}),s.jsx(N,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:y.map(E=>s.jsxs("tr",{children:[s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:E.name}),s.jsxs("small",{className:"text-muted",children:[s.jsx(Vi,{size:12,className:"me-1"}),E.email]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:E.employeeId})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:s.jsx("span",{className:"text-muted",children:E.department})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:s.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${E.progress}%`},"aria-valuenow":E.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),s.jsxs("small",{className:"text-muted",children:[E.progress,"%"]})]})}),s.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:E.score?s.jsxs(ke,{bg:E.score>=80?"success":E.score>=60?"warning":"danger",children:[E.score,"%"]}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"border-neutral-200 align-middle",children:f(E.status)}),s.jsx("td",{className:"border-neutral-200 align-middle text-center",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Trainee Details",icon:s.jsx(Bt,{}),onClick:()=>h(E.id)},{label:"Send Message",icon:s.jsx(Vi,{}),onClick:()=>p(E.id)}]})})]},E.id))})]})})]})},jce=()=>{const{subjectId:e}=ur(),t=tt(),[r,a]=v.useState("trainees"),[n,i]=v.useState(null),[o,l]=v.useState(!0),[c,d]=v.useState(null);v.useEffect(()=>{(async()=>{try{l(!0),await new Promise(x=>setTimeout(x,1e3)),i({id:e,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols",duration:"2 hours",status:"completed",instructor:"Dr. Smith",course:"Aviation Safety Management",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(p){d("Failed to load subject details"),console.error("Error fetching subject:",p)}finally{l(!1)}})()},[e]);const u=h=>{const x={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[h]||{variant:"secondary",text:"Unknown"};return s.jsx(ke,{bg:x.variant,children:x.text})},m=[{id:"trainees",title:"Trainee List",icon:Pt,component:s.jsx(bce,{subjectId:e})}],f=m.find(h=>h.id===r);return o?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):c?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:c})]})}):n?s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:n.title}),s.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.course]})]})]})})}),s.jsxs(de,{className:"mb-4",children:[s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(Ke,{size:24,className:"text-primary mb-2"}),s.jsx("h6",{className:"mb-1",children:"Duration"}),s.jsx("h4",{className:"mb-0 text-primary",children:n.duration}),s.jsx("small",{className:"text-muted",children:"Estimated Time"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(Pt,{size:24,className:"text-success mb-2"}),s.jsx("h6",{className:"mb-1",children:"Trainees"}),s.jsxs("h4",{className:"mb-0 text-success",children:[n.completedTrainees,"/",n.totalTrainees]}),s.jsx("small",{className:"text-muted",children:"Completed"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx("div",{className:"text-info mb-2",children:s.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),s.jsx("h6",{className:"mb-1",children:"Average Score"}),s.jsxs("h4",{className:"mb-0 text-info",children:[n.averageScore,"%"]}),s.jsx("small",{className:"text-muted",children:"Performance"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx(Je,{size:24,className:"text-warning mb-2"}),s.jsx("h6",{className:"mb-1",children:"Status"}),u(n.status)]})})})]}),s.jsxs(de,{className:"mb-4",children:[s.jsx(H,{md:6,children:s.jsxs(W,{children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Subject Information"})}),s.jsxs(W.Body,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx(Dt,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Description:"})," ",n.description]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Instructor:"})," ",n.instructor]}),s.jsxs("div",{className:"mb-3",children:[s.jsx(Ke,{size:16,className:"me-2 text-muted"}),s.jsx("strong",{children:"Completion Date:"})," ",n.completionDate]})]})]})}),s.jsx(H,{md:6,children:s.jsxs(W,{children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Materials"})}),s.jsx(W.Body,{children:n.materials.map((h,p)=>s.jsxs("div",{className:"mb-2 d-flex justify-content-between align-items-center",children:[s.jsxs("div",{children:[s.jsx("span",{className:"fw-medium",children:h.name}),s.jsx("small",{className:"text-muted d-block",children:h.type})]}),s.jsx("small",{className:"text-muted",children:h.size})]},p))})]})})]}),s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(W,{children:[s.jsx(W.Header,{children:s.jsx("h5",{className:"mb-0",children:"Assessments"})}),s.jsx(W.Body,{children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Assessment"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Max Score"}),s.jsx("th",{children:"Average Score"})]})}),s.jsx("tbody",{children:n.assessments.map((h,p)=>s.jsxs("tr",{children:[s.jsx("td",{children:h.name}),s.jsx("td",{children:h.type}),s.jsx("td",{children:h.maxScore}),s.jsx("td",{children:h.averageScore})]},p))})]})})})]})})}),s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(W,{className:"border-0",children:[s.jsx(W.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:m.map(h=>{const p=h.icon,x=r===h.id;return s.jsxs("button",{className:`custom-tab ${x?"active":""}`,onClick:()=>a(h.id),children:[s.jsx(p,{size:16,className:"me-2"}),h.title]},h.id)})})}),s.jsx(W.Body,{className:"p-0",children:f&&f.component})]})})})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"warning",children:[s.jsx(De.Heading,{children:"Subject Not Found"}),s.jsx("p",{children:"The requested subject could not be found."})]})})},wce=`
  .signature-card .card-body {
    height: 400px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
  }

  @media (max-width: 991px) {
    .signature-card .card-body {
      height: 380px !important;
    }
  }

  @media (max-width: 767px) {
    .signature-card .card-body {
      height: 360px !important;
    }
  }

  @media (max-width: 575px) {
    .signature-card .card-body {
      height: 340px !important;
    }
  }

  .signature-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
  }

  .signature-buttons {
    width: 100%;
    margin-top: auto;
    padding-top: 1rem;
  }
`,Nce=()=>{const e=tt(),[t,r]=v.useState(null),[a,n]=v.useState(null),[i,o]=v.useState(!0),[l,c]=v.useState(!1);v.useEffect(()=>{(async()=>{try{o(!0);const p=await on.getProfile();p?.signatureImageUrl&&n(p.signatureImageUrl)}catch(p){console.error("Failed to fetch profile:",p)}finally{o(!1)}})()},[]);const d=h=>{r(h)},u=h=>new Promise(p=>{const x=new Image;x.onload=()=>{const g=document.createElement("canvas");g.width=87,g.height=60,g.getContext("2d").drawImage(x,0,0,87,60),p(g.toDataURL("image/png"))},x.src=h}),m=async()=>{if(!t){J.warning("Please draw your signature first.");return}c(!0);try{const h=await u(t),x=await(await fetch(h)).blob(),g=new File([x],`signature-${Date.now()}.png`,{type:"image/png"}),b=await mn.uploadImage(g,"signature");let j="";if(typeof b=="string"?j=b:b?.url?j=b.url:b?.data?.[0]?.url&&(j=b.data[0].url),!j)throw new Error("Failed to get signature URL from upload response");console.log(" Signature uploaded to S3:",j),await on.updateSignature(j);const y=await on.getProfile();y?.signatureImageUrl&&n(y.signatureImageUrl),J.success("Signature saved successfully!"),r(null)}catch(h){console.error("Error saving signature:",h);const p=h.response?.data?.message||h.message||"Failed to save signature. Please try again.";J.error(p)}finally{c(!1)}},f=()=>{e(je.PROFILE)};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:wce}),s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsx("div",{className:"d-flex align-items-center mb-3",children:s.jsxs(te,{variant:"outline-secondary",onClick:f,className:"me-3",children:[s.jsx(At,{size:16,className:"me-2"}),"Back to Profile"]})})})}),s.jsxs(de,{children:[s.jsx(H,{lg:6,md:12,sm:12,xs:12,className:"mb-4",children:s.jsxs(W,{className:"signature-card",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(_n,{size:20,className:"me-2"}),"Your Signature"]})}),s.jsx(W.Body,{className:"p-4",children:s.jsx("div",{className:"signature-content",children:i?s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{animation:"border",role:"status",className:"mb-3",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"text-muted",children:"Loading your current signature..."})]}):a?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:a,alt:"Current Signature",style:{maxWidth:"90%",maxHeight:"350px",border:"1px solid #ddd",borderRadius:"4px",padding:"8px",backgroundColor:"#f8f9fa"}}),s.jsx("p",{className:"text-muted mt-3 text-center",children:s.jsx("small",{children:"Your current digital signature"})})]}):s.jsxs("div",{className:"text-center text-muted",children:[s.jsx("p",{children:"No signature configured yet"}),s.jsx("p",{className:"small",children:"Draw your signature on the right to get started"})]})})})]})}),s.jsx(H,{lg:6,md:12,sm:12,xs:12,className:"mb-4",children:s.jsxs(W,{className:"signature-card",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(_n,{size:20,className:"me-2"}),"Config Signature"]})}),s.jsxs(W.Body,{className:"p-4",children:[s.jsxs("div",{className:"signature-content",children:[s.jsx("p",{className:"text-muted mb-4 w-100 text-center",children:"Draw your signature in the box below using your mouse or touch device."}),s.jsx("div",{children:s.jsx(L1,{onSignatureChange:d,width:350,height:200})})]}),s.jsxs("div",{className:"signature-buttons d-flex justify-content-end gap-2",children:[s.jsx(te,{variant:"outline-secondary",onClick:f,disabled:l,children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:m,disabled:!t||l,children:l?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{size:16,className:"me-2"}),"Save Signature"]})})]})]})]})})]})]})]})},Sce=()=>{const{resultId:e}=ur(),t=tt(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState("overview");v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(y=>setTimeout(y,1e3)),a({id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",duration:"45 minutes",attempts:1,sections:[{id:1,name:"React Fundamentals",score:20,maxScore:25,status:"completed",timeSpent:"15 minutes"},{id:2,name:"Component Lifecycle",score:18,maxScore:20,status:"completed",timeSpent:"12 minutes"},{id:3,name:"State Management",score:22,maxScore:25,status:"completed",timeSpent:"10 minutes"},{id:4,name:"Advanced Patterns",score:25,maxScore:30,status:"completed",timeSpent:"8 minutes"}],approvalStatus:"pending",approvalNotes:"Waiting for final review from lead trainer."})}catch(j){l("Failed to fetch assessment details."),console.error(j)}finally{i(!1)}})()},[e]);const u=(b,j)=>{const y=b/j*100;return y>=80?"success":y>=60?"warning":"danger"},m=b=>b.includes("A")?"success":b.includes("B")?"info":b.includes("C")?"warning":"danger",f=b=>{const j={completed:{bg:"success",text:"Completed"},in_progress:{bg:"warning",text:"In Progress"},pending:{bg:"secondary",text:"Pending"},failed:{bg:"danger",text:"Failed"}},y=j[b]||j.pending;return s.jsx(ke,{bg:y.bg,children:y.text})},h=()=>{console.log("Downloading report for result:",e)},p=()=>{t(je.TRAINER_APPROVAL_NOTES(e))};if(n)return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(de,{children:s.jsx(H,{children:s.jsx(nr,{height:400})})})});if(o)return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(de,{children:s.jsx(H,{children:s.jsx(De,{variant:"danger",children:o})})})});if(!r)return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(de,{children:s.jsx(H,{children:s.jsx(De,{variant:"info",children:"Assessment result not found"})})})});const x=[{id:"overview",title:"Assessment Overview",icon:xt,component:s.jsx("div",{className:"p-4",children:s.jsxs(de,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),s.jsx("h5",{className:"mb-0",children:r.title})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Course"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.course})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.trainee})]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`h4 mb-0 text-${u(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),s.jsx(ke,{bg:m(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Status"}),f(r.status)]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.completedDate})]})]})]})]})})},{id:"sections",title:"Section Breakdown",icon:iS,component:s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Section"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Time Spent"})]})}),s.jsx("tbody",{children:r.sections.map(b=>s.jsxs("tr",{children:[s.jsx("td",{className:"fw-bold",children:b.name}),s.jsx("td",{children:s.jsxs("span",{className:`fw-bold text-${u(b.score,b.maxScore)}`,children:[b.score,"/",b.maxScore]})}),s.jsx("td",{children:f(b.status)}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ke,{size:14,className:"me-1 text-muted"}),s.jsx("span",{children:b.timeSpent})]})})]},b.id))})]})})}],g=x.find(b=>b.id===c);return s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:()=>t(je.ASSESSMENTS_RESULTS),children:[s.jsx(At,{size:16,className:"me-2"}),"Back to Results"]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs(te,{variant:"outline-primary",onClick:h,children:[s.jsx(fi,{size:16,className:"me-2"}),"Download Report"]}),s.jsxs(te,{variant:"outline-secondary",onClick:p,children:[s.jsx(Bt,{size:16,className:"me-2"}),"View Approval Notes"]})]})]})})}),s.jsx(de,{children:s.jsx(H,{children:s.jsxs(W,{className:"border-0",children:[s.jsx(W.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:x.map(b=>{const j=b.icon,y=c===b.id;return s.jsxs("button",{className:`custom-tab ${y?"active":""}`,onClick:()=>d(b.id),children:[s.jsx(j,{size:16,className:"me-2"}),b.title]},b.id)})})}),s.jsx(W.Body,{className:"p-0",children:g&&g.component})]})})})]})},Ece={NOT_STARTED:{variant:"secondary",text:"Not Started"},ON_GOING:{variant:"info",text:"On Going"},APPROVED:{variant:"success",text:"Approved"},COMPLETED:{variant:"success",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},DRAFT:{variant:"primary",text:"Draft"},SUBMITTED:{variant:"dark",text:"Submitted"},CANCELLED:{variant:"danger",text:"Cancelled"}},Tce=e=>{const t=Ece[e]||{variant:"secondary",text:e||"Unknown"};return s.jsx("span",{className:`badge bg-${t.variant}`,children:t.text})},Cce=e=>{if(!e)return{date:"",time:""};const t=new Date(e);return{date:t.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),time:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}},Kh=()=>{const{entityType:e,entityId:t}=ur(),r=ya(),a=tt(),[n,i]=v.useState({loading:!0,error:null,info:r.state||null,assessments:[]}),o=e==="course"||e==="subject";if(v.useEffect(()=>{(async()=>{if(!t||!o){i(d=>({...d,loading:!1,error:"Invalid assessment context"}));return}if(r.state?.assessments&&r.state?.eventInfo){i({loading:!1,error:null,assessments:r.state.assessments||[],info:{name:r.state.eventInfo?.entityInfo?.name||r.state.name,code:r.state.eventInfo?.entityInfo?.code||r.state.code}});return}try{i(u=>({...u,loading:!0,error:null}));const d=e==="course"?await Sr.getCourseAssessments(t):await Sr.getSubjectAssessments(t);i({loading:!1,error:null,assessments:d?.assessments||[],info:d?.courseInfo||d?.subjectInfo||r.state||null})}catch(d){console.error("Error loading assessments:",d),J.error("Failed to load assessments"),i(u=>({...u,loading:!1,error:d.response?.data?.message||d.message||"Failed to load assessments"}))}})()},[e,t,o,r.state]),!o)return s.jsx(Ce,{className:"py-4",children:s.jsx(De,{variant:"danger",children:"Invalid assessment type."})});const l=c=>{["NOT_STARTED","SUBMITTED","APPROVED","CANCELLED"].includes(c.status)||a(je.ASSESSMENTS_SECTIONS(c.id))};return s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3 flex-wrap gap-3",children:[s.jsxs(te,{variant:"outline-secondary",className:"d-flex align-items-center justify-content-center",onClick:()=>a(-1),children:[s.jsx(At,{size:16,className:"me-2"}),"Back"]}),s.jsxs("div",{children:[s.jsx("h4",{className:"mb-1",children:e==="course"?"Course Assessments":"Subject Assessments"}),n.info&&s.jsxs("p",{className:"text-muted mb-0",children:[n.info.name,n.info.code?`  ${n.info.code}`:""]})]})]}),s.jsx(W,{className:"shadow-sm",children:s.jsx(W.Body,{children:n.loading?s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(ct,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):n.error?s.jsx(De,{variant:"danger",className:"mb-0",children:n.error}):n.assessments.length===0?s.jsx("div",{className:"text-center py-4 text-muted",children:"No assessments found."}):s.jsx("div",{className:"scrollable-table-container",style:{maxHeight:"70vh"},children:s.jsxs(ar,{hover:!0,responsive:!0,className:"mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Assessment"}),s.jsx("th",{children:"Trainee"}),s.jsx("th",{children:"Date & Time"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Score"}),s.jsx("th",{children:"Result"}),s.jsx("th",{children:"PDF"}),s.jsx("th",{className:"text-center",children:"Action"})]})}),s.jsx("tbody",{children:n.assessments.map(c=>{const d=Cce(c.occuranceDate);return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:"fw-semibold",children:c.name})}),s.jsxs("td",{children:[s.jsx("div",{className:"fw-semibold",children:c.trainee?.fullName||""}),s.jsx("small",{className:"text-muted",children:c.trainee?.eid||c.trainee?.email||""})]}),s.jsxs("td",{children:[s.jsx("div",{children:d.date}),s.jsx("small",{className:"text-muted",children:d.time})]}),s.jsx("td",{children:Tce(c.status)}),s.jsx("td",{children:c.resultScore!==null&&c.resultScore!==void 0?c.resultScore:""}),s.jsx("td",{children:c.resultText||""}),s.jsx("td",{children:c.pdfUrl?s.jsx("a",{href:c.pdfUrl,target:"_blank",rel:"noreferrer",children:"View"}):s.jsx("span",{className:"text-muted",children:""})}),s.jsx("td",{className:"text-center",children:!["NOT_STARTED","SUBMITTED","APPROVED","CANCELLED"].includes(c.status)?s.jsx(te,{size:"sm",variant:"primary",onClick:()=>l(c),children:"Assess"}):s.jsx("span",{className:"text-muted",children:""})})]},c.id)})})]})})})})]})},P5=({assessmentInfo:e,roleInSubject:t,formatDate:r})=>{if(!e)return null;const a=[{label:"Trainee",value:`${e.trainee?.firstName||""} ${e.trainee?.lastName||""}`.trim()||"",subValue:e.trainee?.eid||""},{label:"Assessment Date",value:r(e.occuranceDate),subValue:""},{label:"Status",value:e.status||"",subValue:""},{label:"Role In Subject",value:t||"",subValue:""}];return s.jsxs("div",{className:"assessment-info-banner",children:[s.jsxs("div",{className:"title-block",children:[s.jsx("h2",{className:"assessment-title",children:e.name||"Assessment"}),s.jsxs("p",{className:"text-muted mb-0 assessment-course-subtitle",children:[e.course?.name||e.subject?.name||"",e.course?.code?`  ${e.course.code}`:""]})]}),s.jsx("div",{className:"assessment-summary-inline",children:a.map(n=>s.jsxs("div",{className:"summary-item",children:[s.jsxs("span",{className:"summary-label",children:[n.label,":"]}),s.jsx("span",{className:"summary-value",children:n.value}),n.subValue&&s.jsx("span",{className:"summary-sub-value",children:n.subValue})]},n.label))})]})};P5.propTypes={assessmentInfo:F.object,roleInSubject:F.string,formatDate:F.func.isRequired};const R5=({section:e})=>{const t=tt(),{user:r}=zr();if(!e)return null;const a=m=>m?s.jsx("span",{className:"text-success d-inline-flex align-items-center",children:s.jsx(U2,{size:16})}):s.jsx("span",{className:"text-danger d-inline-flex align-items-center",children:s.jsx(lS,{size:16})}),n=e.canAssessed,i=!e.canAssessed&&e.assessedBy?.id===r?.id,o=!e.canAssessed&&e.assessedBy?.id!==r?.id,l=()=>n?s.jsx(ke,{bg:"primary",children:"ASSESSMENT REQUIRED"}):s.jsx(ke,{bg:"secondary",children:"COMPLETED"}),c=()=>n?"Fill Assessments":i?"Update Assessments":"View Assessments",d=!e.canAssessed,u=()=>{e.id&&t(je.ASSESSMENTS_SECTION_FIELDS(e.id))};return s.jsxs("div",{className:"assessment-section-wrapper",style:{position:"relative"},children:[s.jsx(W,{className:`assessment-section-card ${d?"disabled":""}`,children:s.jsx(W.Body,{children:s.jsxs("div",{className:`section-card-header ${d?"section-disabled-content":""}`,children:[s.jsxs("div",{className:"section-header-grid",children:[s.jsx("div",{className:"section-heading",children:s.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"section-order-pill",children:["#",e.templateSection?.displayOrder??"-"]}),s.jsx("h5",{className:"mb-0",children:e.templateSection?.label||"Unnamed Section"})]})}),s.jsxs("div",{className:"section-inline-flags",children:[s.jsxs("div",{className:"flag-item",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Edit By"}),s.jsx("span",{className:"fw-semibold",children:e.templateSection?.editBy||""})]}),e.templateSection?.editBy!=="TRAINEE"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flag-item",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Submittable"}),a(e.templateSection?.isSubmittable)]}),s.jsxs("div",{className:"flag-item",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Toggle Dependent"}),a(e.templateSection?.isToggleDependent)]})]})]}),s.jsx("div",{className:"section-actions-placeholder"})]}),s.jsx("div",{className:"section-subtext",children:e.assessedBy&&s.jsxs("span",{className:"text-muted",children:[s.jsx("small",{className:"text-uppercase text-muted",children:"Assessed By"})," ",s.jsx("span",{className:"fw-semibold",children:e.assessedBy?.fullName||(e.assessedBy?.firstName&&e.assessedBy?.lastName?`${e.assessedBy.firstName} ${e.assessedBy.lastName}`:e.assessedBy?.id||"")})]})})]})})}),s.jsxs("div",{className:"section-actions-absolute",children:[l(),s.jsxs(te,{variant:o?"secondary":"primary",size:"sm",onClick:u,className:"d-flex align-items-center",style:{gap:"0.5rem"},children:[o?s.jsx(Bt,{size:14}):s.jsx(rr,{size:14}),c()]})]})]})};R5.propTypes={section:F.object.isRequired};const _2=()=>{const{assessmentId:e}=ur(),t=tt(),{user:r,userRole:a}=zr(),n=r?.role==="TRAINEE",i=a?.name==="TRAINER"||r?.role==="TRAINER",o=a?.name==="DEPARTMENT_HEAD"||a?.name==="DEPARTMENT HEAD",[l,c]=v.useState({loading:!0,error:null,assessmentInfo:null,sections:[],userRole:null,isTraineeLocked:!1}),[d,u]=v.useState(!1),[m,f]=v.useState(""),[h,p]=v.useState(""),[x,g]=v.useState(!1);v.useEffect(()=>{e&&b()},[e]);const b=async()=>{try{c(R=>({...R,loading:!0,error:null}));const C=await Sr.getAssessmentSections(e);c({loading:!1,error:null,assessmentInfo:C?.assessmentInfo||null,sections:C?.sections||[],userRole:C?.userRole||null,isTraineeLocked:C?.isTraineeLocked??!1})}catch(C){console.error("Error loading assessment sections:",C),J.error("Failed to load assessment sections"),c(R=>({...R,loading:!1,error:C.response?.data?.message||C.message||"Failed to load assessment sections"}))}},j=v.useMemo(()=>[...l.sections].sort((C,R)=>{const M=C.templateSection?.displayOrder??0,U=R.templateSection?.displayOrder??0;return M-U}),[l.sections]),y=j[0]?.templateSection?.roleInSubject||l.userRole,w=C=>C?new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"",S=()=>t(-1),N=async()=>{if(!e){J.error("Assessment ID is missing");return}try{g(!0);const C=await Sr.approveRejectAssessment(e,"APPROVED"),R=C?.data?.message||C?.message||"Assessment approved successfully";J.success(R),setTimeout(()=>{g(!1),t(je.ASSESSMENT_REVIEW_REQUESTS)},1500)}catch(C){console.error("Error approving assessment:",C);const R=C.response?.data?.message||C.message||"Failed to approve assessment. Please try again.";J.error(R),g(!1)}},E=()=>{u(!0),f(""),p("")},P=async()=>{if(!e){J.error("Assessment ID is missing");return}if(!m.trim()){p("Comment is required for rejection");return}if(m.length>1e3){p("Comment must be less than 1000 characters");return}try{g(!0),p("");const C=await Sr.approveRejectAssessment(e,"REJECTED",m),R=C?.data?.message||C?.message||"Assessment rejected successfully";J.success(R),u(!1),f(""),setTimeout(()=>{g(!1),t(je.ASSESSMENT_REVIEW_REQUESTS)},1500)}catch(C){console.error("Error rejecting assessment:",C);const R=C.response?.data?.message||C.message||"Failed to reject assessment. Please try again.";p(R),g(!1)}},T=async()=>{if(!e){J.error("Assessment ID is missing");return}const R=!l.isTraineeLocked;try{await Sr.updateTraineeLock(e,R),J.success(R?"Trainee locked":"Assessment opened for trainee"),b()}catch(M){console.error("Error updating trainee lock:",M),J.error(M.response?.data?.message||"Failed to update trainee lock status")}},O=async()=>{if(!e){J.error("Assessment ID is missing");return}try{const C=await Sr.submitAssessment(e),R=C?.data?.message||C?.message||"Assessment submitted successfully";J.success(R),setTimeout(()=>{b()},1e3)}catch(C){console.error("Error submitting assessment:",C);const R=C.response?.data?.message||C.message||"Failed to submit assessment";J.error(R)}},_=()=>l.assessmentInfo?.status!=="READY_TO_SUBMIT"?!1:l.sections.some(R=>R.templateSection?.isSubmittable===!0&&R.assessedBy?.id===r?.id);return s.jsx("div",{className:"assessment-sections-shell",children:s.jsxs(Ce,{fluid:!0,className:"py-4 assessment-sections-page",children:[s.jsx("div",{className:"assessment-header d-flex flex-wrap align-items-center justify-content-between gap-3 mb-4",children:s.jsxs(te,{variant:"outline-secondary",onClick:S,className:"assess-back-btn",children:[s.jsx(At,{size:16,className:"me-2"}),"Back"]})}),s.jsx(W,{className:"assessment-details-card shadow-sm",children:s.jsx(W.Body,{children:l.loading?s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(ct,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):l.error?s.jsx(De,{variant:"danger",className:"mb-0",children:l.error}):s.jsxs(s.Fragment,{children:[s.jsx(P5,{assessmentInfo:l.assessmentInfo,roleInSubject:y,formatDate:w}),j.length===0?s.jsx("div",{className:"text-center text-muted py-4",children:"No sections available."}):s.jsx("div",{className:"assessment-section-column",children:j.map(C=>s.jsx(R5,{section:C},C.id))})]})})}),!n&&s.jsxs("div",{className:"assessment-footer-actions mt-4",children:[i&&s.jsx(te,{variant:l.isTraineeLocked?"outline-primary":"outline-danger",className:"footer-btn",onClick:T,children:l.isTraineeLocked?"Open For Trainee":"Lock Trainee"}),o&&l.assessmentInfo?.status==="SUBMITTED"&&s.jsxs(s.Fragment,{children:[s.jsx(yt,{permissions:[Te.APPROVE_OR_REJECT_ASSESSMENT],fallback:null,children:s.jsx(te,{variant:"success",className:"footer-btn",onClick:N,disabled:x,children:x?s.jsxs(s.Fragment,{children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),"Approving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Je,{className:"me-2",size:16}),"Approve"]})})}),s.jsx(yt,{permissions:[Te.APPROVE_OR_REJECT_ASSESSMENT],fallback:null,children:s.jsx(te,{variant:"danger",className:"footer-btn",onClick:E,disabled:x,children:x?s.jsxs(s.Fragment,{children:[s.jsx(ct,{animation:"border",size:"sm",className:"me-2"}),"Rejecting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Qr,{className:"me-2",size:16}),"Reject"]})})})]}),_()&&s.jsx(te,{variant:"primary",className:"footer-btn submit-btn",onClick:O,children:"Submit Assessment"})]}),s.jsxs(ce,{show:d,onHide:()=>{u(!1),f(""),p("")},centered:!0,children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Reject Assessment"})}),s.jsxs(ce.Body,{children:[s.jsxs(De,{variant:"info",className:"mb-3",children:[s.jsx("strong",{children:"Note:"})," Leave a comment to let the Trainers know what is wrong with the Assessment! An Email will be sent to them shortly after rejection."]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsxs(k.Label,{children:["Comment ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx(k.Control,{as:"textarea",rows:4,value:m,onChange:C=>{f(C.target.value),p("")},placeholder:"Enter your comment here...",maxLength:1e3,isInvalid:!!h}),s.jsxs(k.Text,{className:"text-muted",children:[m.length,"/1000 characters"]}),h&&s.jsx(k.Control.Feedback,{type:"invalid",children:h})]})]}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"secondary",onClick:()=>{u(!1),f(""),p("")},disabled:x,children:"Cancel"}),s.jsx(te,{variant:"danger",onClick:P,disabled:x,children:x?s.jsxs(s.Fragment,{children:[s.jsx(ct,{size:"sm",className:"me-2"}),"Rejecting..."]}):"Reject Assessment"})]})]})]})})},k2=()=>{const{sectionId:e}=ur(),t=tt(),[r,a]=v.useState({loading:!0,error:null,sectionInfo:null,fields:[],fieldValues:{},sectionControlToggleValue:!1,isSectionDisabled:!1,canUpdate:!1,canSave:!1}),[n,i]=v.useState({}),[o,l]=v.useState(!1),[c,d]=v.useState(null),[u,m]=v.useState("X"),[f,h]=v.useState(!1),p=v.useCallback(async()=>{if(e)try{a(A=>({...A,loading:!0,error:null}));const ne=await Sr.getAssessmentSectionFields(e);if(console.log(" API Response:",ne),console.log(" Fields from API:",ne?.fields),console.log(" Total fields count:",ne?.fields?.length),ne?.success){const A=ne.fields||[],D={};let I=!0;console.log(" Processing",A.length,"fields"),A.forEach(ae=>{const K=ae.templateField?.id;if(K){const G=ae.templateField?.fieldType,ue=ae.assessmentValue?.answerValue;G==="SECTION_CONTROL_TOGGLE"?I=ue!=null?ue==="true"||ue===!0||ue==="TRUE":!0:D[K]=ue??null,G==="CHECK_BOX"&&(n[K]||i(L=>({...L,[K]:"X"})))}});const V=ne.assessmentSectionInfo||null,ie=V?.canUpdated||!1,se=V?.canSave||!1;console.log(" Section Info:",V),console.log(" canUpdate:",ie,"canSave:",se),a({loading:!1,error:null,sectionInfo:V,fields:A,fieldValues:D,sectionControlToggleValue:I,isSectionDisabled:!I||!ie&&!se,canUpdate:ie,canSave:se})}else a(A=>({...A,loading:!1,error:"Failed to load section fields"}))}catch(ne){console.error("Error loading section fields:",ne),J.error("Failed to load section fields"),a(A=>({...A,loading:!1,error:ne.response?.data?.message||ne.message||"Failed to load section fields"}))}},[e,n]);v.useEffect(()=>{p()},[p]);const x=(ne,A)=>{a(D=>({...D,fieldValues:{...D.fieldValues,[ne]:A}}))},g=ne=>{a(A=>({...A,sectionControlToggleValue:ne,isSectionDisabled:!ne||!A.canUpdate&&!A.canSave}))},b=(ne,A,D)=>{const I=n[D]||"X";x(ne,A?I:null)},j=ne=>{const A=ne.templateField?.id,D=n[A]||"X";d(ne),m(D),l(!0)},y=()=>{if(c){const ne=c.templateField?.id;i(A=>({...A,[ne]:u})),l(!1),J.success("Checkbox default value updated")}},w=()=>{const ne=[],A={};let D=null;return r.fields.forEach(I=>{const V=I.templateField;if(V){if(V.fieldType==="SECTION_CONTROL_TOGGLE"){D=I;return}V.parentId?(A[V.parentId]||(A[V.parentId]=[]),A[V.parentId].push(I)):ne.push(I)}}),ne.sort((I,V)=>(I.templateField?.displayOrder||0)-(V.templateField?.displayOrder||0)),Object.keys(A).forEach(I=>{A[I].sort((V,ie)=>(V.templateField?.displayOrder||0)-(ie.templateField?.displayOrder||0))}),console.log(" organizeFields() result:"),console.log("   Total fields in state.fields:",r.fields.length),console.log("   Parent fields (no parentId):",ne.length),console.log("   Children by parent:",Object.keys(A).map(I=>`${I}: ${A[I].length} children`)),console.log("   SectionControlToggle:",D?"YES":"NO"),{parentFields:ne,childrenMap:A,sectionControlToggleField:D}},S=ne=>{const A=ne.templateField;if(!A)return null;const D=A.id,I=A.fieldType,V=A.label||A.fieldName||"Unnamed Field",ie=r.fieldValues[D]??"",se=A.options?.items||null,ae=r.isSectionDisabled||!r.canUpdate&&!r.canSave;return se&&Array.isArray(se)&&se.length>0?s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(k.Label,{className:"field-label",children:V}),s.jsxs(k.Select,{value:ie,onChange:K=>x(D,K.target.value),disabled:ae,className:"field-input",children:[s.jsxs("option",{value:"",children:["Select ",V.toLowerCase()]}),se.map((K,G)=>s.jsx("option",{value:K,children:K},G))]})]},D):I==="FINAL_SCORE_NUM"?s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(k.Label,{className:"field-label",children:V}),s.jsx(k.Control,{type:"number",value:ie,onChange:K=>{const G=K.target.value;(G===""||/^-?\d*\.?\d*$/.test(G))&&x(D,G)},placeholder:`Enter ${V.toLowerCase()}`,disabled:ae,className:"field-input"})]},D):I==="TOGGLE"?s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(k.Label,{className:"field-label",children:V}),s.jsx(k.Check,{type:"switch",checked:ie==="true"||ie===!0||ie==="TRUE",onChange:K=>x(D,K.target.checked?"true":"false"),disabled:ae,className:"field-toggle"})]},D):s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(k.Label,{className:"field-label",children:V}),s.jsx(k.Control,{type:"text",value:ie,onChange:K=>x(D,K.target.value),placeholder:`Enter ${V.toLowerCase()}`,disabled:ae,className:"field-input"})]},D)},N=ne=>{const A=ne.templateField;if(!A||A.fieldType!=="CHECK_BOX")return null;const D=A.id,I=A.label||A.fieldName||"Unnamed Group",{childrenMap:V}=w(),ie=V[D]||[],se=ie.length;return s.jsxs("div",{className:"field-group",children:[s.jsxs("div",{className:"field-group-header",children:[s.jsx("h6",{className:"field-group-title",children:I}),se>0&&s.jsxs("span",{className:"field-item-count",children:[se," ITEMS"]}),s.jsx(te,{variant:"link",size:"sm",className:"p-0 ms-2",onClick:()=>j(ne),style:{color:"#6c757d"},title:"Configure checkbox value",children:s.jsx(Mx,{size:14})})]}),s.jsx("div",{className:"field-group-content",children:ie.length>0&&s.jsx(de,{className:"g-3",children:ie.map((ae,K)=>{if(K%2===0){const G=ae,ue=ie[K+1];return s.jsxs(Q.Fragment,{children:[s.jsx(H,{md:6,children:E(G)}),ue&&s.jsx(H,{md:6,children:E(ue)})]},`row-${K}`)}return null})})})]},D)},E=ne=>{const A=ne.templateField;if(!A)return null;const D=A.id,I=A.label||A.fieldName||"Unnamed Field",V=r.fieldValues[D],ie=V!=null&&V!=="",se=r.isSectionDisabled||!r.canUpdate&&!r.canSave;return s.jsxs("div",{className:"field-input-wrapper",children:[s.jsx(k.Label,{className:"field-label",children:I}),s.jsx(k.Check,{type:"checkbox",checked:ie,onChange:ae=>b(D,ae.target.checked,A.parentId),disabled:se,className:"field-checkbox"})]},D)},P=ne=>{const A=ne.templateField;if(!A||A.fieldType!=="PART")return null;const D=A.id,I=A.label||A.fieldName||"Unnamed Group",{childrenMap:V}=w(),ie=V[D]||[],se=ie.length;return console.log(` renderFieldGroup: "${I}" has ${ie.length} children`),s.jsxs("div",{className:"field-group",children:[s.jsxs("div",{className:"field-group-header",children:[s.jsx("h6",{className:"field-group-title",children:I}),se>0&&s.jsxs("span",{className:"field-item-count",children:[se," ITEMS"]})]}),s.jsx("div",{className:"field-group-content",children:ie.length>0&&s.jsx(de,{className:"g-3",children:ie.map((ae,K)=>{if(K%2===0){const G=ae,ue=ie[K+1];return s.jsxs(Q.Fragment,{children:[s.jsx(H,{md:6,children:S(G)}),ue&&s.jsx(H,{md:6,children:S(ue)})]},`row-${K}`)}return null})})})]},D)},T=()=>{t(-1)},O=()=>{const{sectionControlToggleField:ne}=w(),A=[...r.fields],D=[],I=new Set;if(A.forEach(V=>{const ie=V.templateField;if(!ie)return;const se=ie.id,ae=ie.fieldType,K=V.assessmentValue?.id;if(ae==="SECTION_CONTROL_TOGGLE"||!K||I.has(K))return;I.add(K);let G=r.fieldValues[se];(G==null||typeof G=="string"&&G.trim()==="")&&(G=null),ae==="FINAL_SCORE_NUM"&&G!==null&&(G=String(G)),ae==="TOGGLE"?r.sectionControlToggleValue?G=G||"false":G="false":r.sectionControlToggleValue||(G=null),D.push({assessmentValueId:K,answerValue:G})}),ne){const V=ne.assessmentValue?.id;V&&D.push({assessmentValueId:V,answerValue:r.sectionControlToggleValue?"true":"false"})}return{assessmentSectionId:e,values:D}},_=async()=>{if(!(!e||!r.canSave))try{h(!0);const ne=O();await Sr.saveSectionValues(ne),J.success("Section saved successfully"),setTimeout(()=>{t(-1)},1e3)}catch(ne){console.error("Error saving section:",ne),J.error(ne.response?.data?.message||"Failed to save section")}finally{h(!1)}},C=async()=>{if(!(!e||!r.canUpdate))try{h(!0);const ne=O();await Sr.updateSectionValues(ne),J.success("Section updated successfully"),setTimeout(()=>{t(-1)},1e3)}catch(ne){console.error("Error updating section:",ne),J.error(ne.response?.data?.message||"Failed to update section")}finally{h(!1)}};if(r.loading)return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:s.jsx(ct,{animation:"border",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(r.error)return s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(De,{variant:"danger",className:"mb-0",children:r.error})});const{parentFields:R,sectionControlToggleField:M}=w(),U=r.sectionInfo?.templateSection?.label||"Section",Z=r.sectionInfo?.templateSection?`${r.sectionInfo.templateSection.editBy}  ${r.sectionInfo.templateSection.roleInSubject}`:"",{childrenMap:ee}=w();let re=0;const z=[];let me=0;return R.forEach(ne=>{const A=ne.templateField;if(A?.fieldType==="PART"){const D=(ee[A.id]||[]).length;re+=D,z.push(`${A.label}(${D})`),me++}else A?.fieldType,re+=1}),console.log(" SUMMARY:"),console.log("   API returned:",r.fields.length,"fields"),console.log("   Parent fields:",R.length),console.log("   PART groups found:",me,"",z.join(" | ")),console.log("   ChildrenMap keys:",Object.keys(ee).length,"groups"),console.log("   Total rendering:",re,"fields"),s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(te,{variant:"outline-secondary",className:"me-3 d-flex align-items-center justify-content-center",onClick:T,style:{borderRadius:"999px",padding:"0.45rem 1.5rem"},children:[s.jsx(At,{size:16,className:"me-2"}),"Back"]}),s.jsxs("div",{children:[s.jsx("h4",{className:"mb-1",children:U}),Z&&s.jsx("p",{className:"text-muted mb-0",children:Z})]})]}),M&&s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(k.Label,{className:"me-2 mb-0",children:M.templateField?.label||"Section Control"}),s.jsx(k.Check,{type:"switch",checked:r.sectionControlToggleValue,onChange:ne=>g(ne.target.checked),disabled:!r.canUpdate&&!r.canSave})]})]}),s.jsx(W,{className:"shadow-sm",children:s.jsx(W.Body,{children:s.jsx("div",{className:"assessment-section-fields",children:s.jsx("div",{className:"fields-container",children:s.jsx(de,{className:"g-3",children:(()=>{const ne=[];return R.forEach(A=>{const D=A.templateField;if(D){if(D.fieldType==="PART"){ne.push(s.jsx(H,{xs:12,children:P(A)},D.id));return}if(D.fieldType==="CHECK_BOX"){ne.push(s.jsx(H,{xs:12,children:N(A)},D.id));return}ne.push(s.jsx(H,{xs:12,children:S(A)},D.id))}}),console.log(" Rendered fields:",ne.length),ne})()})})})})}),s.jsxs("div",{className:"d-flex justify-content-end gap-3 mt-4",children:[r.canUpdate&&s.jsx(te,{variant:"warning",onClick:C,disabled:f,children:f?"Updating...":"Update"}),r.canSave&&s.jsx(te,{variant:"outline-primary",onClick:_,disabled:f,children:f?"Saving...":"Save"})]}),s.jsxs(ce,{show:o,onHide:()=>l(!1),children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:"Configure Checkbox Value"})}),s.jsx(ce.Body,{children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Default Value (when checked)"}),s.jsx(k.Control,{type:"text",value:u,onChange:ne=>m(ne.target.value),placeholder:"Enter default value (e.g., X, Y, PASS)"}),s.jsx(k.Text,{className:"text-muted",children:'This value will be sent to backend when checkbox is checked. Default: "X"'})]})}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),s.jsx(te,{variant:"primary",onClick:y,children:"Save"})]})]})]})},Ace=()=>{const{resultId:e}=ur(),t=tt(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null),[c,d]=v.useState(!1),[u,m]=v.useState(!1),[f,h]=v.useState({status:"pending",notes:"",approvedBy:"",approvedDate:""});v.useEffect(()=>{(async()=>{try{i(!0),await new Promise(E=>setTimeout(E,1e3));const N={id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",approvalStatus:"pending",approvalNotes:"",trainerNotes:"Student shows solid foundation but should focus more on advanced state management techniques.",previousApprovals:[{id:1,status:"approved",notes:"Good performance overall",approvedBy:"Dr. Smith",approvedDate:"2024-01-10",type:"initial"}]};a(N),h({status:N.approvalStatus,notes:N.approvalNotes,approvedBy:"",approvedDate:""})}catch(N){l("Failed to load assessment result data"),console.error("Error fetching result data:",N)}finally{i(!1)}})()},[e]);const p=(S,N)=>{const E=S/N*100;return E>=80?"success":E>=60?"warning":"danger"},x=S=>S.includes("A")?"success":S.includes("B")?"info":S.includes("C")?"warning":"danger",g=S=>{const N={approved:{bg:"success",text:"Approved"},pending:{bg:"warning",text:"Pending Approval"},rejected:{bg:"danger",text:"Rejected"}},E=N[S]||N.pending;return s.jsx(ke,{bg:E.bg,children:E.text})},b=(S,N)=>{h(E=>({...E,[S]:N}))},j=async()=>{try{d(!0),await new Promise(S=>setTimeout(S,1500)),a(S=>({...S,approvalStatus:f.status,approvalNotes:f.notes})),m(!1),console.log("Approval saved successfully")}catch(S){console.error("Error saving approval:",S)}finally{d(!1)}},y=()=>{h(S=>({...S,status:"approved",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)},w=()=>{h(S=>({...S,status:"rejected",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)};return n?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(de,{children:s.jsx(H,{children:s.jsx(nr,{height:400})})})}):o?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(de,{children:s.jsx(H,{children:s.jsx(De,{variant:"danger",children:o})})})}):r?s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsxs(te,{variant:"outline-secondary",size:"sm",onClick:()=>t(`/trainer/assessment-details/${e}`),className:"me-3",children:[s.jsx(At,{size:16,className:"me-2"}),"Back to Details"]}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Result Approval Note"}),s.jsx("p",{className:"text-muted mb-0",children:"Review and approve assessment results"})]})]})})}),s.jsxs(de,{children:[s.jsxs(H,{lg:8,children:[s.jsxs(W,{className:"mb-4",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(xt,{size:20,className:"me-2"}),"Assessment Summary"]})}),s.jsx(W.Body,{children:s.jsxs(de,{children:[s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),s.jsx("h5",{className:"mb-0",children:r.title})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Course"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Dt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.course})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.trainee})]})]})]}),s.jsxs(H,{md:6,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Score"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs("span",{className:`h4 mb-0 text-${p(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),s.jsx(ke,{bg:x(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Current Status"}),g(r.approvalStatus)]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(or,{size:16,className:"me-2 text-muted"}),s.jsx("span",{children:r.completedDate})]})]})]})]})})]}),s.jsxs(W,{className:"mb-4",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(Bx,{size:20,className:"me-2"}),"Trainer Notes"]})}),s.jsx(W.Body,{children:s.jsx("p",{className:"mb-0",children:r.trainerNotes})})]}),r.previousApprovals&&r.previousApprovals.length>0&&s.jsxs(W,{className:"mb-4",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(Ke,{size:20,className:"me-2"}),"Approval History"]})}),s.jsx(W.Body,{children:r.previousApprovals.map(S=>s.jsxs("div",{className:"border-bottom pb-3 mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[s.jsxs("div",{children:[s.jsxs("h6",{className:"mb-1",children:[S.type.charAt(0).toUpperCase()+S.type.slice(1)," Approval"]}),s.jsxs("small",{className:"text-muted",children:["Approved by ",S.approvedBy," on ",S.approvedDate]})]}),g(S.status)]}),S.notes&&s.jsx("p",{className:"mb-0 text-muted",children:S.notes})]},S.id))})]})]}),s.jsxs(H,{lg:4,children:[s.jsxs(W,{className:"mb-4",children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Current Status"})}),s.jsx(W.Body,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mb-3",children:g(r.approvalStatus)}),r.approvalNotes&&s.jsxs("div",{children:[s.jsx("h6",{className:"text-muted mb-2",children:"Current Notes"}),s.jsx("p",{className:"small text-muted",children:r.approvalNotes})]})]})})]}),s.jsxs(W,{children:[s.jsx(W.Header,{className:"bg-primary text-white",children:s.jsx("h6",{className:"mb-0",children:"Approval Actions"})}),s.jsx(W.Body,{children:s.jsxs("div",{className:"d-grid gap-2",children:[s.jsxs(te,{variant:"success",onClick:y,className:"d-flex align-items-center justify-content-center",children:[s.jsx(Je,{size:16,className:"me-2"}),"Approve Result"]}),s.jsxs(te,{variant:"danger",onClick:w,className:"d-flex align-items-center justify-content-center",children:[s.jsx(Qr,{size:16,className:"me-2"}),"Reject Result"]})]})})]})]})]}),s.jsxs(ce,{show:u,onHide:()=>m(!1),size:"lg",children:[s.jsx(ce.Header,{closeButton:!0,children:s.jsx(ce.Title,{children:f.status==="approved"?"Approve Assessment Result":"Reject Assessment Result"})}),s.jsx(ce.Body,{children:s.jsxs(k,{children:[s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Approval Notes"}),s.jsx(k.Control,{as:"textarea",rows:4,value:f.notes,onChange:S=>b("notes",S.target.value),placeholder:"Enter your approval notes..."})]}),s.jsxs(k.Group,{className:"mb-3",children:[s.jsx(k.Label,{children:"Approved By"}),s.jsx(k.Control,{type:"text",value:f.approvedBy,onChange:S=>b("approvedBy",S.target.value),placeholder:"Enter your name"})]}),s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:"Approval Date"}),s.jsx(k.Control,{type:"date",value:f.approvedDate,onChange:S=>b("approvedDate",S.target.value)})]})]})}),s.jsxs(ce.Footer,{children:[s.jsx(te,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),s.jsx(te,{variant:f.status==="approved"?"success":"danger",onClick:j,disabled:c,children:c?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(us,{size:16,className:"me-2"}),f.status==="approved"?"Approve":"Reject"]})})]})]})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsx(de,{children:s.jsx(H,{children:s.jsx(De,{variant:"info",children:"Assessment result not found"})})})})},_ce=()=>{const e=tt(),t=[{title:"View Course Details",description:"Access detailed course information and management",icon:Dt,path:je.DEPARTMENT_MY_DETAILS,color:"primary"},{title:"Review Assessment Requests",description:"Process pending assessment review requests",icon:rr,path:je.DEPARTMENT_REVIEW_REQUESTS,color:"warning"},{title:"Department Statistics",description:"View department performance metrics",icon:Mr,path:"/department-head/statistics",color:"info"},{title:"Trainee Management",description:"Manage trainee enrollments and progress",icon:Mr,path:"/department-head/trainee-management",color:"success"}];return s.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:s.jsxs(Ce,{className:"py-4",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{lg:12,children:s.jsxs(W,{className:"border-0 shadow-sm",children:[s.jsx(W.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Department Dashboard"})}),s.jsx(W.Body,{children:s.jsxs(de,{children:[s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100 border-0 shadow-sm",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Dt,{size:24,className:"text-primary"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"12"}),s.jsx("p",{className:"text-muted mb-0",children:"Active Courses"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100 border-0 shadow-sm",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(Mr,{size:24,className:"text-success"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"156"}),s.jsx("p",{className:"text-muted mb-0",children:"Enrolled Trainees"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100 border-0 shadow-sm",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(rr,{size:24,className:"text-warning"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"8"}),s.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),s.jsx(H,{md:3,className:"mb-3",children:s.jsx(W,{className:"h-100 border-0 shadow-sm",children:s.jsxs(W.Body,{className:"text-center",children:[s.jsx("div",{className:"bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:s.jsx(fa,{size:24,className:"text-info"})}),s.jsx("h3",{className:"mb-1 fw-bold",children:"24"}),s.jsx("p",{className:"text-muted mb-0",children:"Upcoming Assessments"})]})})})]})})]})})}),s.jsx(de,{className:"mb-4",children:s.jsx(H,{lg:12,children:s.jsxs(W,{className:"h-100 border-0 shadow-sm",children:[s.jsx(W.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),s.jsx(W.Body,{children:s.jsx(de,{children:t.map((r,a)=>{const n=r.icon;return s.jsx(H,{md:6,lg:3,className:"mb-3",children:s.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="none"},children:[s.jsxs("div",{className:"d-flex align-items-center mb-2",children:[s.jsx(n,{size:24,className:`text-${r.color} me-2`}),s.jsx("h6",{className:"mb-0",children:r.title})]}),s.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),s.jsx(un,{size:16,className:`text-${r.color} ms-auto`})]})},a)})})})]})})})]})})},kce=({course:e,index:t,onView:r})=>{const a=i=>{const o={PLANNED:{variant:"info",icon:Ke},ONGOING:{variant:"primary",icon:Je},COMPLETED:{variant:"success",icon:Je},CANCELLED:{variant:"secondary",icon:Ke},active:{variant:"success",icon:Je},inactive:{variant:"secondary",icon:Ke},pending:{variant:"warning",icon:Ke}},l=o[i]||o.pending,c=l.icon;return s.jsxs(ke,{bg:l.variant,className:"d-flex align-items-center",children:[s.jsx(c,{size:12,className:"me-1"}),i.toUpperCase()]})},n=i=>[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>r(i),permission:Te.VIEW_COURSE_IN_DETAIL}];return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:e.title}),s.jsx("small",{className:"text-muted",children:e.description})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:e.code})}),s.jsx("td",{className:"align-middle show-mobile",children:a(e.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Mr,{size:16,className:"me-1 text-muted"}),s.jsx("span",{children:e.enrolledCount})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:new Date(e.startDate).toLocaleDateString()})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(yt,{permissions:[Te.VIEW_COURSE_IN_DETAIL],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:n(e)})})})]})},Dce=()=>{const e=tt(),{courseId:t}=ur(),{user:r}=zr(),[a,n]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(null),[d,u]=v.useState(""),[m,f]=v.useState("all"),[h,p]=v.useState(null),[x,g]=v.useState("subjects");v.useEffect(()=>{(async()=>{if(!r||!r.id){o(!1);return}try{o(!0),c(null);const S=await Vt.getPublicDepartments(),E=(Array.isArray(S)?S:S.departments||[]).find(C=>C.headUserId===r.id);if(!E){n([]),o(!1);return}const _=((await Vt.getDepartmentById(E.id)).courses||[]).filter(C=>C.status!=="ARCHIVED").map(C=>({id:C.id,title:C.name,code:C.code,description:C.description||"",status:C.status||"PLANNED",enrolledCount:C.maxNumTrainee||0,startDate:C.startDate,endDate:C.endDate,level:C.level,venue:C.venue,passScore:C.passScore,subjectCount:C.subjectCount||0}));n(_)}catch(S){console.error("Error fetching courses:",S),c("Failed to load courses. Please try again later.")}finally{o(!1)}})()},[r]);const b=a.filter(w=>{const S=w.title.toLowerCase().includes(d.toLowerCase())||w.code.toLowerCase().includes(d.toLowerCase())||w.description&&w.description.toLowerCase().includes(d.toLowerCase()),N=m==="all"||w.status===m;return S&&N}),j=w=>{p(w),e(`${je.DEPARTMENT_MY_DETAILS}/${w.id}`)};return[{id:"subjects",title:"Subject List",icon:Dt,component:s.jsx("div",{children:"Subject List Component"})},{id:"trainees",title:"Trainee List",icon:Mr,component:s.jsx("div",{children:"Trainee List Component"})}].find(w=>w.id===x),i?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading courses..."})]})}):l?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:l})]})}):s.jsx(Ce,{fluid:!0,className:"py-4 my-department-details-page",children:s.jsxs(W,{className:"border-0 shadow-sm mb-0",children:[s.jsx(W.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("div",{className:"d-flex justify-content-between align-items-center",children:s.jsxs("h4",{className:"mb-0 text-white",children:[s.jsx(Dt,{className:"me-2"}),"Courses (",b.length,")"]})})}),s.jsxs(W.Body,{children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search courses by title, code, or description...",value:d,onChange:u,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsxs("select",{className:"form-select filter-panel-mobile",value:m,onChange:w=>f(w.target.value),children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"PLANNED",children:"Planned"}),s.jsx("option",{value:"ONGOING",children:"Ongoing"}),s.jsx("option",{value:"COMPLETED",children:"Completed"}),s.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[b.length," course",b.length!==1?"s":""]})})})]}),s.jsx(VS,{data:b,loading:i,columns:[{key:"title",title:"Course Title",className:"show-mobile",sortable:!0},{key:"code",title:"Course Code",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"enrolledCount",title:"Enrolled",className:"hide-mobile",sortable:!0},{key:"startDate",title:"Start Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(w,S)=>s.jsx(kce,{course:w,index:S,onView:j},w.id),emptyMessage:"No courses found",emptyDescription:"Try adjusting your search criteria."})]})]})})},Ice=({assessment:e,index:t,onView:r})=>{const a=o=>{const l={SUBMITTED:{variant:"warning",icon:Ke,label:"SUBMITTED"},APPROVED:{variant:"success",icon:Je,label:"APPROVED"},REJECTED:{variant:"danger",icon:Qr,label:"REJECTED"},CANCELLED:{variant:"secondary",icon:st,label:"CANCELLED"}},c=l[o]||l.SUBMITTED,d=c.icon;return s.jsxs(ke,{bg:c.variant,className:"d-flex align-items-center",children:[s.jsx(d,{size:12,className:"me-1"}),c.label]})},n=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",i=o=>o?o.replace(/_/g," ").replace(/\b\w/g,l=>l.toUpperCase()):"N/A";return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:e.name}),s.jsx("small",{className:"text-muted",children:e.template?.name||"N/A"})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-medium",children:e.trainee?.fullName||"N/A"}),s.jsx("small",{className:"text-muted",children:e.trainee?.email||"N/A"})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("div",{className:"text-muted small",children:n(e.submittedAt||e.createdAt)})}),s.jsx("td",{className:"align-middle show-mobile",children:a(e.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"fw-medium",children:e.resultScore!==null&&e.resultScore!==void 0?`${e.resultScore}%`:"N/A"})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:i(e.resultText)})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsxs(te,{variant:"outline-primary",size:"sm",onClick:()=>r(e),className:"d-flex align-items-center",children:[s.jsx(Bt,{className:"me-1",size:14}),"View Detail"]})})]})},Yh=()=>{const e=tt(),[t,r]=v.useState([]),[a,n]=v.useState(!0),[i,o]=v.useState(""),[l,c]=v.useState("SUBMITTED");v.useEffect(()=>{d()},[]);const d=async()=>{try{n(!0);const w=await Sr.getDepartmentAssessments();r(w.assessments||[])}catch(w){console.error("Error fetching assessments:",w),r([])}finally{n(!1)}},u=w=>t.filter(S=>S.status===w),f=(()=>{let w=u(l);if(i){const S=i.toLowerCase();w=w.filter(N=>N.name?.toLowerCase().includes(S)||N.trainee?.fullName?.toLowerCase().includes(S)||N.trainee?.email?.toLowerCase().includes(S)||N.course?.name?.toLowerCase().includes(S)||N.course?.code?.toLowerCase().includes(S)||N.template?.name?.toLowerCase().includes(S))}return w})(),{sortedData:h,sortConfig:p,handleSort:x}=_r(f),g=w=>{e(je.ASSESSMENTS_SECTIONS(w.id))},j={SUBMITTED:u("SUBMITTED").length,APPROVED:u("APPROVED").length,REJECTED:u("REJECTED").length,CANCELLED:u("CANCELLED").length},y=({columnKey:w,children:S,className:N="",nestedKey:E=null})=>{const P=E?`${w}.${E}`:w,O=p.key===P?p.direction:null;return s.jsx("th",{className:`fw-semibold ${N}`,onClick:()=>x(P),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{style:{color:"white"},children:S}),O&&s.jsx("span",{className:"ms-1",style:{color:"white"},children:O==="asc"?"":""})]})})};return a?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading assessment review requests..."})]})}):s.jsxs(Ce,{fluid:!0,className:"py-4 assessment-review-requests-page",style:{backgroundColor:"transparent",height:"100vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[s.jsx(de,{className:"align-items-center mb-3",children:s.jsx(H,{xs:12,children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e(je.DASHBOARD),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:"Assessment Review Requests"}),s.jsx("p",{className:"text-muted mb-0",children:"Review and approve/deny assessment requests from your department"})]})]})})}),s.jsxs($t.Container,{activeKey:l,onSelect:c,children:[s.jsx("div",{className:"bg-primary rounded-top",children:s.jsx("div",{className:"border-bottom py-2 px-3",children:s.jsxs(Xe,{variant:"tabs",className:"border-0",children:[s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"SUBMITTED",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:l==="SUBMITTED"?"600":"400",opacity:l==="SUBMITTED"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Ke,{className:"me-2",size:16}),"Submitted (",j.SUBMITTED,")"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"APPROVED",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:l==="APPROVED"?"600":"400",opacity:l==="APPROVED"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Je,{className:"me-2",size:16}),"Approved (",j.APPROVED,")"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"REJECTED",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:l==="REJECTED"?"600":"400",opacity:l==="REJECTED"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(Qr,{className:"me-2",size:16}),"Rejected (",j.REJECTED,")"]})}),s.jsx(Xe.Item,{children:s.jsxs(Xe.Link,{eventKey:"CANCELLED",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:l==="CANCELLED"?"600":"400",opacity:l==="CANCELLED"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[s.jsx(st,{className:"me-2",size:16}),"Cancelled (",j.CANCELLED,")"]})})]})})}),s.jsx("div",{children:s.jsx($t.Content,{children:s.jsxs($t.Pane,{eventKey:l,children:[s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section p-3",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search by assessment name, trainee name, course, or email...",value:i,onChange:o,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:6,md:7,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[f.length," assessment",f.length!==1?"s":""]})})})]}),a?s.jsx("div",{className:"p-3",children:s.jsx(nr,{rows:5,columns:8})}):f.length===0?s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No assessments found"}),s.jsxs("p",{children:['No assessments with status "',l,'" found.']})]})}):s.jsx("div",{className:"scrollable-table-container admin-table",style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(y,{columnKey:"name",className:"show-mobile",children:"Assessment"}),s.jsx(y,{columnKey:"trainee",nestedKey:"fullName",className:"show-mobile",children:"Trainee"}),s.jsx(y,{columnKey:"submittedAt",className:"show-mobile",children:"Date & Time"}),s.jsx(y,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(y,{columnKey:"resultScore",className:"hide-mobile",children:"Score"}),s.jsx(y,{columnKey:"resultText",className:"hide-mobile",children:"Result"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Action"})]})}),s.jsx("tbody",{children:h.map((w,S)=>s.jsx(Ice,{assessment:w,index:S,onView:g},w.id))})]})})]})})})]})]})},Oce=({subjects:e,loading:t,onView:r})=>{const{sortedData:a,sortConfig:n,handleSort:i}=_r(e);if(t)return s.jsx(nr,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No subjects found"}),s.jsx("p",{children:"No subjects are available in this course."})]})});const o=({columnKey:l,children:c,className:d=""})=>{const m=n.key===l?n.direction:null;return s.jsx("th",{className:`fw-semibold ${d}`,onClick:()=>i(l),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{style:{color:"white"},children:c}),s.jsx(rs,{direction:m,className:"ms-1",color:"white"})]})})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(o,{columnKey:"title",className:"show-mobile",children:"Subject Title"}),s.jsx(o,{columnKey:"code",className:"show-mobile",children:"Subject Code"}),s.jsx(o,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx(o,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),s.jsx(o,{columnKey:"method",className:"hide-mobile",children:"Method"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:a.map((l,c)=>s.jsx(Pce,{subject:l,index:c,onView:r},l.id))})]})})},Pce=({subject:e,index:t,onView:r})=>{const a=i=>{const o={ON_GOING:{variant:"primary",icon:Je},PLANNED:{variant:"info",icon:Ke},COMPLETED:{variant:"success",icon:Je},CANCELLED:{variant:"secondary",icon:Ke},active:{variant:"success",icon:Je},inactive:{variant:"secondary",icon:Ke},pending:{variant:"warning",icon:Ke}},l=o[i]||o.pending,c=l.icon;return s.jsxs(ke,{bg:l.variant,className:"d-flex align-items-center",children:[s.jsx(c,{size:12,className:"me-1"}),i.replace(/_/g," ").toUpperCase()]})},n=i=>[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>r(i),permission:Te.VIEW_SUBJECT_DETAIL}];return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:e.name}),s.jsx("small",{className:"text-muted",children:e.description||""})]})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:e.code})}),s.jsx("td",{className:"align-middle show-mobile",children:a(e.status)}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsxs("div",{className:"text-muted small",children:[e.duration||0," hours"]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:e.method||"N/A"})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(yt,{permissions:[Te.VIEW_SUBJECT_DETAIL],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:n(e)})})})]})},Rce=({trainees:e,loading:t,onView:r})=>{const{sortedData:a,sortConfig:n,handleSort:i}=_r(e);if(t)return s.jsx(nr,{rows:5,columns:6});if(e.length===0)return s.jsx("div",{className:"text-center py-5",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"No trainees are enrolled in this course."})]})});const o=({columnKey:l,children:c,className:d=""})=>{const m=n.key===l?n.direction:null;return s.jsx("th",{className:`fw-semibold ${d}`,onClick:()=>i(l),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{style:{color:"white"},children:c}),s.jsx(rs,{direction:m,className:"ms-1",color:"white"})]})})};return s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(o,{columnKey:"name",className:"show-mobile",children:"Trainee Name"}),s.jsx(o,{columnKey:"eid",className:"hide-mobile",children:"Employee ID"}),s.jsx(o,{columnKey:"email",className:"show-mobile",children:"Email"}),s.jsx(o,{columnKey:"enrollmentCount",className:"hide-mobile",children:"Enrollments"}),s.jsx(o,{columnKey:"batches",className:"hide-mobile",children:"Batches"}),s.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),s.jsx("tbody",{children:a.map((l,c)=>s.jsx(Fce,{trainee:l,index:c,onView:r},l.id))})]})})},Fce=({trainee:e,index:t,onView:r})=>{const a=n=>[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>r(n),permission:Te.VIEW_USER_IN_DETAIL}];return s.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:n=>{n.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:n=>{n.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1 fw-medium",children:e.name}),s.jsx("small",{className:"text-muted",children:e.email})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:e.eid||"N/A"})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsx("span",{className:"text-dark",children:e.email})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:e.enrollmentCount||0})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("div",{className:"text-muted small",children:e.batches&&e.batches.length>0?e.batches.join(", "):"N/A"})}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(yt,{permissions:[Te.VIEW_USER_IN_DETAIL],fallback:null,children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:a(e)})})})]})},D2=()=>{const e=tt(),{courseId:t}=ur(),[r,a]=v.useState(null),[n,i]=v.useState([]),[o,l]=v.useState([]),[c,d]=v.useState(!0),[u,m]=v.useState(null),[f,h]=v.useState("subjects");v.useEffect(()=>{(async()=>{if(!t){d(!1);return}try{d(!0),m(null);const y=await Nr.getCourseById(t),w={id:y.id,title:y.name,code:y.code,description:y.description||"",status:y.status||"PLANNED",enrolledCount:y.traineeCount||0,startDate:y.startDate,endDate:y.endDate,department:y.department?.name||"N/A",departmentCode:y.department?.code||""},S=(y.subjects||[]).map(N=>({id:N.id,name:N.name,code:N.code,description:N.description||"",status:N.status||"PLANNED",duration:N.duration||0,method:N.method||"N/A",roomName:N.roomName,timeSlot:N.timeSlot,startDate:N.startDate,endDate:N.endDate,passScore:N.passScore}));a(w),i(S);try{const P=((await Nr.getCourseTrainees(t)).trainees||[]).map(T=>({id:T.id,eid:T.eid,firstName:T.firstName||"",lastName:T.lastName||"",name:`${T.firstName||""} ${T.lastName||""}`.trim(),email:T.email||"",enrollmentCount:T.enrollmentCount||0,batches:T.batches||[]}));l(P)}catch(N){console.error("Error fetching trainees:",N),l([])}}catch(y){console.error("Error fetching course details:",y),m("Failed to load course details. Please try again later.")}finally{d(!1)}})()},[t]);const p=j=>{e(je.SUBJECTS_IN_COURSE(t,j.id))},x=j=>{e(je.USERS_DETAIL(j.id))},g=[{id:"subjects",title:"Subject List",icon:Dt,component:s.jsx(Oce,{subjects:n,loading:c,onView:p})},{id:"trainees",title:"Trainee List",icon:Mr,component:s.jsx(Rce,{trainees:o,loading:c,onView:x})}],b=g.find(j=>j.id===f);return c?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):u?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:u})]})}):r?s.jsxs(Ce,{fluid:!0,className:"py-4 course-details-page",children:[s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e(je.DEPARTMENT_MY_DETAILS),children:s.jsx(At,{size:20})}),s.jsxs("div",{children:[s.jsx("h2",{className:"mb-1",children:r.title}),s.jsxs("p",{className:"text-muted mb-0",children:[r.code,"  ",r.department," (",r.departmentCode,")"]})]})]})})}),s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(W,{className:"border-0",children:[s.jsx(W.Header,{className:"department-head-section-header bg-primary text-white border-0 p-0",children:s.jsx("div",{className:"custom-tabs-container",children:g.map(j=>{const y=j.icon,w=f===j.id;return s.jsxs("button",{className:`custom-tab ${w?"active":""}`,onClick:()=>h(j.id),children:[s.jsx(y,{size:16,className:"me-2"}),j.title]},j.id)})})}),s.jsx(W.Body,{className:"p-0",children:b&&b.component})]})})})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"warning",children:[s.jsx(De.Heading,{children:"Course Not Found"}),s.jsx("p",{children:"The requested course could not be found."})]})})},Lce=({subjectId:e,courseId:t})=>{const r=tt(),{courseId:a}=ur(),n=t||a,[i,o]=v.useState([]),[l,c]=v.useState(!0),[d,u]=v.useState(null),[m,f]=v.useState(""),[h,p]=v.useState([]);v.useEffect(()=>{(async()=>{try{c(!0),await new Promise(_=>setTimeout(_,1e3)),o([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"TE001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"TE002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"TE003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"TE004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"TE005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(O){u("Failed to load trainees in subject"),console.error("Error fetching trainees:",O)}finally{c(!1)}})()},[e]);const x=T=>{const _={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[T]||{variant:"secondary",text:"Unknown"};return s.jsx(ke,{bg:_.variant,children:_.text})},g=T=>{r(je.USERS_DETAIL(T))},b=[...new Set(i.map(T=>T.status))],j=i.filter(T=>{const O=h.length===0||h.includes(T.status),_=T.name.toLowerCase().includes(m.toLowerCase())||T.email.toLowerCase().includes(m.toLowerCase())||T.employeeId.toLowerCase().includes(m.toLowerCase())||T.department.toLowerCase().includes(m.toLowerCase());return O&&_}),y=T=>{p(T==="clear"?[]:O=>O.includes(T)?O.filter(_=>_!==T):[...O,T])},w=()=>{p([]),f("")},{sortedData:S,sortConfig:N,handleSort:E}=_r(j),P=({columnKey:T,children:O,className:_=""})=>{const R=N.key===T?N.direction:null;return s.jsx("th",{className:`fw-semibold ${_}`,onClick:()=>E(T),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("span",{style:{color:"white"},children:O}),s.jsx(rs,{direction:R,className:"ms-1",color:"white"})]})})};return l?s.jsx(nr,{rows:5,columns:7}):d?s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:d})]}):j.length===0?s.jsx("div",{className:"text-center py-5 p-4",children:s.jsxs("div",{className:"text-muted",children:[s.jsx("h5",{children:"No trainees found"}),s.jsx("p",{children:"Try adjusting your search criteria."})]})}):s.jsxs("div",{className:"p-4",children:[s.jsx(de,{className:"mb-3",children:s.jsx(H,{children:s.jsxs("button",{className:"btn btn-link p-0 text-decoration-none",onClick:()=>r(`${je.DEPARTMENT_MY_DETAILS}/${n}`),style:{color:"var(--bs-primary)"},children:[s.jsx(At,{size:20,className:"me-2"}),"Back to Course Details"]})})}),s.jsxs(de,{className:"mb-3 form-mobile-stack search-filter-section",children:[s.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:s.jsx(ws,{placeholder:"Search trainees in this subject...",value:m,onChange:f,className:"search-bar-mobile"})}),s.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:s.jsx(bo,{uniqueStatuses:b,selectedStatuses:h,onStatusToggle:y,onClearFilters:w,className:"filter-panel-mobile"})}),s.jsx(H,{xs:12,lg:3,md:3,children:s.jsx("div",{className:"text-end text-mobile-center",children:s.jsxs("small",{className:"text-muted",children:[j.length," trainee",j.length!==1?"s":""]})})})]}),s.jsx("div",{className:"scrollable-table-container admin-table",children:s.jsxs(ar,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[s.jsx("thead",{className:"sticky-header",children:s.jsxs("tr",{children:[s.jsx(P,{columnKey:"name",className:"show-mobile",children:"Trainee"}),s.jsx(P,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),s.jsx(P,{columnKey:"department",className:"hide-mobile",children:"Department"}),s.jsx(P,{columnKey:"progress",className:"show-mobile",children:"Progress"}),s.jsx(P,{columnKey:"score",className:"hide-mobile",children:"Score"}),s.jsx(P,{columnKey:"status",className:"show-mobile",children:"Status"}),s.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),s.jsx("tbody",{children:S.map((T,O)=>s.jsxs("tr",{className:`${O%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:_=>{_.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:_=>{_.currentTarget.style.backgroundColor=O%2===0?"white":"var(--bs-neutral-50)"},children:[s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Pt,{size:18,className:"me-2 text-primary"}),s.jsxs("div",{children:[s.jsx("h6",{className:"mb-0 fw-medium",children:T.name}),s.jsx("small",{className:"text-muted",children:T.email})]})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("span",{className:"text-dark fw-medium",children:T.employeeId})}),s.jsx("td",{className:"align-middle hide-mobile",children:s.jsx("span",{children:T.department})}),s.jsx("td",{className:"align-middle show-mobile",children:s.jsxs("div",{children:[s.jsx("div",{className:"d-flex justify-content-between mb-1",children:s.jsxs("span",{className:"fw-medium",children:[T.progress,"%"]})}),s.jsx("div",{className:"progress",style:{height:"6px"},children:s.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${T.progress}%`}})})]})}),s.jsx("td",{className:"align-middle hide-mobile",children:T.score?s.jsx("span",{className:"fw-bold text-success",children:T.score}):s.jsx("span",{className:"text-muted",children:"-"})}),s.jsx("td",{className:"align-middle show-mobile",children:x(T.status)}),s.jsx("td",{className:"align-middle text-center show-mobile",children:s.jsx(Rr,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:s.jsx(Ar,{size:16})},items:[{label:"View Details",icon:s.jsx(Bt,{}),onClick:()=>g(T.id)}]})})]},T.id))})]})})]})},I2=()=>{const{courseId:e,subjectId:t}=ur(),r=tt(),[a,n]=v.useState("trainees"),[i,o]=v.useState(null),[l,c]=v.useState(!0),[d,u]=v.useState(null);v.useEffect(()=>{(async()=>{try{c(!0),await new Promise(x=>setTimeout(x,1e3)),o({id:t,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols. This module covers essential safety protocols, emergency procedures, and compliance requirements for aviation operations.",duration:2,status:"active",instructor:"Dr. Smith",course:"Aviation Safety Management",courseCode:"ASM-101",startDate:"2024-01-15",endDate:"2024-03-15",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,inProgressTrainees:3,pendingTrainees:2,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(p){u("Failed to load subject details"),console.error("Error fetching subject:",p)}finally{c(!1)}})()},[t]);const m=[{id:"trainees",title:"Trainee List",icon:Pt,component:s.jsx(Lce,{subjectId:t,courseId:e})}],f=m.find(h=>h.id===a);return l?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):d?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:d})]})}):i?s.jsxs(Ce,{fluid:!0,className:"py-4",children:[s.jsx(de,{className:"mb-3",children:s.jsx(H,{children:s.jsxs("button",{className:"btn btn-link p-0 text-decoration-none",onClick:()=>r(`${je.DEPARTMENT_MY_DETAILS}/${e}`),style:{color:"var(--bs-primary)"},children:[s.jsx(At,{size:20,className:"me-2"}),"Back to Course Details"]})})}),s.jsx(de,{className:"mb-4",children:s.jsx(H,{children:s.jsxs(W,{className:"border-0 shadow-sm",children:[s.jsx(W.Header,{className:"bg-primary text-white p-0",children:s.jsx("div",{className:"custom-tabs-container",children:m.map(h=>{const p=h.icon,x=a===h.id;return s.jsxs("button",{className:`custom-tab ${x?"active":""}`,onClick:()=>n(h.id),children:[s.jsx(p,{size:16,className:"me-2"}),h.title]},h.id)})})}),s.jsx(W.Body,{className:"p-0",children:f&&f.component})]})})})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"warning",children:[s.jsx(De.Heading,{children:"Subject Not Found"}),s.jsx("p",{children:"The requested subject could not be found."})]})})},Mce=()=>{const{traineeId:e}=ur(),t=tt(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(null);v.useEffect(()=>{(async()=>{if(!e){i(!1);return}try{i(!0),l(null);const m=await Ys.getUserById(e),f=m.data||m,h={id:f.id,eid:f.eid,firstName:f.firstName||"",lastName:f.lastName||"",middleName:f.middleName||"",name:`${f.firstName||""} ${f.middleName||""} ${f.lastName||""}`.trim().replace(/\s+/g," "),email:f.email||"",phoneNumber:f.phoneNumber||"N/A",status:f.status||"ACTIVE",gender:f.gender||"N/A",address:f.address||"N/A",avatarUrl:f.avatarUrl,role:f.role?.name||"N/A",department:f.department?.name||"N/A",departmentId:f.department?.id,dob:f.traineeProfile?.dob,enrollmentDate:f.traineeProfile?.enrollmentDate,trainingBatch:f.traineeProfile?.trainingBatch||"N/A",passportNo:f.traineeProfile?.passportNo||"N/A",nation:f.traineeProfile?.nation||"N/A",createdAt:f.createdAt,updatedAt:f.updatedAt};a(h)}catch(m){console.error("Error fetching trainee details:",m),l("Failed to load trainee details. Please try again later.")}finally{i(!1)}})()},[e]);const c=u=>{const f={ACTIVE:{variant:"success",text:"Active"},INACTIVE:{variant:"secondary",text:"Inactive"},SUSPENDED:{variant:"danger",text:"Suspended"},active:{variant:"success",text:"Active"},inactive:{variant:"secondary",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[u]||{variant:"secondary",text:u||"Unknown"};return s.jsx(ke,{bg:f.variant,children:f.text})},d=u=>{if(!u)return"N/A";try{return new Date(u).toLocaleDateString()}catch{return u}};return n?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx(ct,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):o?s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"danger",children:[s.jsx(De.Heading,{children:"Error"}),s.jsx("p",{children:o})]})}):r?s.jsxs(Ce,{fluid:!0,className:"py-3 py-md-4 px-3 px-md-4",children:[s.jsx(de,{className:"mb-3 mb-md-4",children:s.jsx(H,{children:s.jsxs("div",{className:"d-flex align-items-center flex-wrap",children:[s.jsxs("button",{className:"btn btn-link p-0 me-2 me-md-3 mb-2 mb-md-0",onClick:()=>t(-1),"aria-label":"Go back",children:[s.jsx(At,{size:18,className:"d-md-none"}),s.jsx(At,{size:20,className:"d-none d-md-block"})]}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h2",{className:"mb-1 h4 h-md-2",children:r.name}),s.jsxs("p",{className:"text-muted mb-0 small",children:[r.eid,"  ",r.department]})]})]})})}),s.jsx("div",{style:{marginBottom:"4rem"},children:s.jsxs(de,{className:"g-2 g-md-3",children:[s.jsx(H,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(W,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(W.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Pt,{size:20,className:"text-primary d-md-none"}),s.jsx(Pt,{size:24,className:"text-primary d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Status"}),s.jsx("div",{className:"mt-auto d-flex justify-content-center",children:c(r.status)})]})})}),s.jsx(H,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(W,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(W.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Vs,{size:20,className:"text-info d-md-none"}),s.jsx(Vs,{size:24,className:"text-info d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Department"}),s.jsx("h6",{className:"mb-0 text-info small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:r.department}),s.jsx("h6",{className:"mb-0 text-info d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.department})]})})}),s.jsx(H,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(W,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(W.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(or,{size:20,className:"text-success d-md-none"}),s.jsx(or,{size:24,className:"text-success d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Enrollment Date"}),s.jsx("h6",{className:"mb-0 text-success small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:d(r.enrollmentDate)}),s.jsx("h6",{className:"mb-0 text-success d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:d(r.enrollmentDate)})]})})}),s.jsx(H,{xs:6,sm:6,md:3,lg:3,className:"d-flex mb-2 mb-md-0",children:s.jsx(W,{className:"h-100 border-0 shadow-sm w-100",children:s.jsxs(W.Body,{className:"text-center d-flex flex-column justify-content-center p-3 p-md-4",style:{minHeight:"120px"},children:[s.jsxs("div",{className:"d-flex justify-content-center mb-2",children:[s.jsx(Il,{size:20,className:"text-warning d-md-none"}),s.jsx(Il,{size:24,className:"text-warning d-none d-md-block"})]}),s.jsx("h6",{className:"mb-2 text-muted small fw-normal",children:"Training Batch"}),s.jsx("h6",{className:"mb-0 text-warning small d-md-none",style:{minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-word"},children:r.trainingBatch}),s.jsx("h6",{className:"mb-0 text-warning d-none d-md-block",style:{minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.trainingBatch})]})})})]})}),s.jsxs(de,{className:"mb-4 g-3 g-md-4 align-items-stretch",children:[s.jsx(H,{xs:12,sm:12,md:6,lg:6,className:"mb-3 mb-md-0 d-flex",children:s.jsxs(W,{className:"border-0 shadow-sm w-100 d-flex flex-column",children:[s.jsx(W.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white h6 h-md-5",children:"Personal Information"})}),s.jsxs(W.Body,{className:"p-3 p-md-4 flex-grow-1",children:[s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Employee ID:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.eid})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Vi,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Email:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1 text-break",children:r.email})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Q2,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Phone Number:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.phoneNumber})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Gender:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.gender})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(or,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Date of Birth:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:d(r.dob)})]})]}),s.jsxs("div",{className:"mb-0 d-flex align-items-start",children:[s.jsx(Lo,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Address:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1 text-break",children:r.address})]})]})]})]})}),s.jsx(H,{xs:12,sm:12,md:6,lg:6,className:"mb-0 d-flex",children:s.jsxs(W,{className:"border-0 shadow-sm w-100 d-flex flex-column",children:[s.jsx(W.Header,{className:"department-head-section-header bg-primary text-white border-0",children:s.jsx("h5",{className:"mb-0 text-white h6 h-md-5",children:"Trainee Profile"})}),s.jsxs(W.Body,{className:"p-3 p-md-4 flex-grow-1",children:[s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Vs,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Department:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.department})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Pt,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Role:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.role})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(or,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Enrollment Date:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:d(r.enrollmentDate)})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Il,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Training Batch:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.trainingBatch})]})]}),s.jsxs("div",{className:"mb-3 d-flex align-items-start",children:[s.jsx(Il,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Passport No:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.passportNo})]})]}),s.jsxs("div",{className:"mb-0 d-flex align-items-start",children:[s.jsx(Lo,{size:16,className:"me-2 text-muted mt-1 flex-shrink-0"}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("strong",{className:"d-block d-md-inline",children:"Nation:"})," ",s.jsx("span",{className:"d-block d-md-inline ms-md-1",children:r.nation})]})]})]})]})})]})]}):s.jsx(Ce,{fluid:!0,className:"py-4",children:s.jsxs(De,{variant:"warning",children:[s.jsx(De.Heading,{children:"Trainee Not Found"}),s.jsx("p",{children:"The requested trainee could not be found."})]})})},Bce=$5([{path:"/",element:s.jsx(Qm,{}),errorElement:s.jsx(_t,{})},{path:"/login",element:s.jsx(Qm,{}),errorElement:s.jsx(_t,{})},{path:"/reset-password",element:s.jsx(zR,{}),errorElement:s.jsx(_t,{})},{path:"/profile",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(yH,{})}]},{path:je.DASHBOARD,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(jo,{})}]},{path:je.USERS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_USERS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access user management."}),children:s.jsx(YW,{})})}]},{path:je.ROLES,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_ROLES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access role management."}),children:s.jsx(rH,{})})}]},{path:je.DEPARTMENTS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permissions:[Te.VIEW_ALL_DEPARTMENTS,Te.UPDATE_DEPARTMENT],requireAll:!0,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department management."}),children:s.jsx(cH,{})})},{path:":id",element:s.jsx(zt,{permission:Te.VIEW_DEPARTMENT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view department details."}),children:s.jsx(pH,{})})}]},{path:je.TEMPLATES,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_TEMPLATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access form templates."}),children:s.jsx(Ple,{})})},{path:"editor",element:s.jsx(zt,{permission:Te.CREATE_TEMPLATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to edit form templates."}),children:s.jsx($le,{})})},{path:"drafts",element:s.jsx(zt,{permission:Te.CREATE_TEMPLATE,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view drafts."}),children:s.jsx(Ule,{})})},{path:":templateId",element:s.jsx(zt,{permission:Te.VIEW_TEMPLATE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template details."}),children:s.jsx(C2,{})})}]},{path:je.SYSTEM_CONFIG,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_GLOBAL_FIELDS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access system configuration."}),children:s.jsx(Kle,{})})}]},{path:je.MAIN_MENU,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(Wle,{})}]},{path:je.COURSES_INSTRUCTED,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_COURSES,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view instructed courses."}),children:s.jsx(xce,{})})}]},{path:je.COURSES_ENROLLED,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view enrolled courses."}),children:s.jsx(Ele,{})})}]},{path:"/courses/:courseId",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_COURSE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(A2,{})})}]},{path:"/courses/:courseId/enroll-trainees",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(y2,{})}]},{path:"/courses/:courseId/subjects/:subjectId",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_SUBJECT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:s.jsx(I2,{})})}]},{path:je.ASSESSMENTS_UPCOMING,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(mce,{})}]},{path:je.ASSESSMENTS_MY_ASSESSMENTS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(S2,{})}]},{path:je.ASSESSMENTS_RESULTS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(hce,{})}]},{path:je.ASSESSMENTS_SIGNATURE_REQUIRED,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(Xle,{})}]},{path:"/assessments/assign/:entityType/:entityId",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(Kh,{})}]},{path:"/assessments/:assessmentId/sections",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(_2,{})}]},{path:"/assessments/sections/:sectionId/fields",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(k2,{})}]},{path:je.ASSESSMENT_EVENTS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(b2,{})}]},{path:je.REPORTS_CREATE,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_SUBMITTED_REPORTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to create incident/feedback reports."}),children:s.jsx(rce,{})})}]},{path:je.REPORTS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access incident/feedback reports."}),children:s.jsx(Yd,{})})}]},{path:je.REPORTS_ISSUES,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access issue list."}),children:s.jsx(Yd,{defaultTab:"incidents"})})}]},{path:je.REPORTS_FEEDBACK,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_INCIDENT_FEEDBACK_REPORT,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access feedback list."}),children:s.jsx(Yd,{defaultTab:"feedback"})})}]},{path:"/reports/:reportId",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_INCIDENT_FEEDBACK_REPORT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view incident/feedback report details."}),children:s.jsx(sce,{})})}]},{path:je.TRAINER_CONFIGURE_SIGNATURE,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(Nce,{})}]},{path:je.DEPARTMENT_MY_DETAILS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_DEPARTMENT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department details."}),children:s.jsx(Dce,{})})},{path:":courseId",element:s.jsx(zt,{permission:Te.VIEW_COURSE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(D2,{})})}]},{path:je.DEPARTMENT_REVIEW_REQUESTS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(Yh,{})},{path:":requestId",element:s.jsx(Yh,{})}]},{path:je.TRAINEE_ACADEMIC_DETAILS,element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view academic details."}),children:s.jsx(wle,{})})}]},{path:"/admin",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(jo,{})},{path:"main-menu",element:s.jsx(wr,{})},{path:"users",element:s.jsx(wr,{})},{path:"roles",element:s.jsx(wr,{})},{path:"departments",element:s.jsx(wr,{})},{path:"departments/:id",element:s.jsx(wr,{})},{path:"forms",element:s.jsx(wr,{})},{path:"forms/editor",element:s.jsx(wr,{})},{path:"forms/drafts",element:s.jsx(wr,{})},{path:"system-config",element:s.jsx(wr,{})}]},{path:"/academic",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(jo,{})},{path:"dashboard",element:s.jsx(Aoe,{})},{path:"departments",element:s.jsx(bH,{})},{path:"course/:courseId",element:s.jsx(Roe,{})},{path:"course-detail/:courseId",element:s.jsx(tle,{})},{path:"course/:courseId/enroll-trainees",element:s.jsx(y2,{})},{path:"subject/:subjectId",element:s.jsx(g2,{})},{path:"course/:courseId/subject/:subjectId",element:s.jsx(g2,{})},{path:"assessment-events",element:s.jsx(b2,{})}]},{path:"/trainee",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(zt,{permission:Te.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee portal."}),children:s.jsx(j2,{})})},{path:"dashboard",element:s.jsx(zt,{permission:Te.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee dashboard."}),children:s.jsx(j2,{})})},{path:":traineeId/course/:courseId",element:s.jsx(zt,{permission:Te.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee courses."}),children:s.jsx(D5,{})})},{path:":traineeId/course/:courseId/subject/:subjectId",element:s.jsx(zt,{permission:Te.VIEW_ALL_ENROLLMENTS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee subjects."}),children:s.jsx(fle,{})})},{path:":traineeId/assessments",element:s.jsx(ple,{})},{path:":traineeId/assessment/:assessmentId",element:s.jsx(xle,{})},{path:":traineeId/signature-pad/:documentId",element:s.jsx(gle,{})},{path:":traineeId/assessment-section/:sectionId",element:s.jsx(yle,{})},{path:"academic-details",element:s.jsx(wr,{})},{path:"enrolled-courses",element:s.jsx(wr,{})},{path:"signature-required",element:s.jsx(wr,{})},{path:"completion-required",element:s.jsx(wr,{})},{path:"your-assessments",element:s.jsx(wr,{})},{path:"create-incident-feedback-report",element:s.jsx(wr,{})},{path:"assessment-pending",element:s.jsx(S2,{})}]},{path:"/sqa",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(jo,{})},{path:"issues",element:s.jsx(wr,{})},{path:"feedback",element:s.jsx(wr,{})},{path:"templates/:templateId",element:s.jsx(zt,{permission:Te.VIEW_TEMPLATE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template details."}),children:s.jsx(C2,{})})}]},{path:"/trainer",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(jo,{})},{path:"dashboard",element:s.jsx(dce,{})},{path:"upcoming-assessments",element:s.jsx(wr,{})},{path:"assessment-results",element:s.jsx(wr,{})},{path:"instructed-courses",element:s.jsx(wr,{})},{path:"configure-signature",element:s.jsx(wr,{})},{path:"assessment-details/:resultId",element:s.jsx(Sce,{})},{path:"assess/:entityType/:entityId",element:s.jsx(Kh,{})},{path:"assessments/:assessmentId/sections",element:s.jsx(_2,{})},{path:"assessments/sections/:sectionId/fields",element:s.jsx(k2,{})},{path:"assess/:entityType/:entityId",element:s.jsx(Kh,{})},{path:"approval-notes/:resultId",element:s.jsx(Ace,{})},{path:"courses/:courseId",element:s.jsx(zt,{permission:Te.VIEW_COURSE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(A2,{})})},{path:"trainees/:traineeId",element:s.jsx(zt,{permission:Te.VIEW_USER_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:s.jsx(yce,{})})},{path:"subjects/:subjectId",element:s.jsx(zt,{permission:Te.VIEW_SUBJECT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:s.jsx(jce,{})})}]},{path:"/department-head",element:s.jsx(Lt,{children:s.jsx(Ft,{})}),errorElement:s.jsx(_t,{}),children:[{path:"",element:s.jsx(jo,{})},{path:"dashboard",element:s.jsx(zt,{permission:Te.VIEW_DEPARTMENT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department dashboard."}),children:s.jsx(_ce,{})})},{path:"my-department-details",element:s.jsx(wr,{})},{path:"my-department-details/:courseId",element:s.jsx(zt,{permission:Te.VIEW_COURSE_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:s.jsx(D2,{})})},{path:"assessment-review-requests",element:s.jsx(wr,{})},{path:"assessment-review-requests/:requestId",element:s.jsx(Yh,{})},{path:"courses/:courseId/subjects/:subjectId",element:s.jsx(zt,{permission:Te.VIEW_SUBJECT_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:s.jsx(I2,{})})},{path:"trainees/:traineeId",element:s.jsx(zt,{permission:Te.VIEW_USER_DETAILS,fallback:s.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:s.jsx(Mce,{})})}]},{path:"*",element:s.jsx(Qm,{}),errorElement:s.jsx(_t,{})}],{basename:Gx()});function zce(){return v.useEffect(()=>{(()=>{const t=window.location;if(t.hostname.includes("github.io")&&t.search.includes("?/")){const r=t.search,a=t.hash,n=r.match(/\?\/(.+?)(?:&|$)/);if(n){const o=`/${n[1].replace(/~and~/g,"&")}${a}`;window.history.replaceState(null,"",o)}}})()},[]),s.jsxs(RR,{children:[s.jsx(U5,{router:Bce}),s.jsx(wR,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}V5.createRoot(document.getElementById("root")).render(s.jsx(v.StrictMode,{children:s.jsx(zce,{})}));
