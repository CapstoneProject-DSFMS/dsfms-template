import{P as R,j as a,B as se,N as St,a as r1,T as It,C as _e,b as M,A as Re,S as Pt,I as s1,F as k,M as ue,R as oe,c as H,O as $2,d as z2,D as $t,e as Pe,L as a1,f as zk,g as Vt,h as tx,i as N0}from"./bootstrap-36CUpx7I.js";import{r as b,R as Z,u as $n,b as Qe,L as Nm,O as Uk,c as Wk,d as rx,N as Hk,e as sx,f as Nr,g as Vk,h as Gk,i as qk}from"./router-C6Ic_n8-.js";import{a as Kk,g as zn,r as ax}from"./vendor-D3F3s8fL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Rc={},n1;function Yk(){if(n1)return Rc;n1=1;var e=Kk();return Rc.createRoot=e.createRoot,Rc.hydrateRoot=e.hydrateRoot,Rc}var Xk=Yk(),Jk=["color","size","title","className"];function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},S0.apply(null,arguments)}function Zk(e,t){if(e==null)return{};var r,s,n=Qk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Qk(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var U2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Zk(e,Jk);return Z.createElement("svg",S0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-airplane",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"}))});U2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var e4=["color","size","title","className"];function E0(){return E0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},E0.apply(null,arguments)}function t4(e,t){if(e==null)return{};var r,s,n=r4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function r4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var W2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=t4(e,e4);return Z.createElement("svg",E0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-archive",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"}))});W2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var s4=["color","size","title","className"];function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},T0.apply(null,arguments)}function a4(e,t){if(e==null)return{};var r,s,n=n4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function n4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var H2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=a4(e,s4);return Z.createElement("svg",T0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-clockwise",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),Z.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"}))});H2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var i4=["color","size","title","className"];function A0(){return A0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},A0.apply(null,arguments)}function o4(e,t){if(e==null)return{};var r,s,n=l4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var V2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=o4(e,i4);return Z.createElement("svg",A0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-counterclockwise",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"}),Z.createElement("path",{d:"M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"}))});V2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var c4=["color","size","title","className"];function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},C0.apply(null,arguments)}function d4(e,t){if(e==null)return{};var r,s,n=u4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function u4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Sl=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=d4(e,c4);return Z.createElement("svg",C0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-down",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"}))});Sl.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var m4=["color","size","title","className"];function _0(){return _0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_0.apply(null,arguments)}function f4(e,t){if(e==null)return{};var r,s,n=h4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function h4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Tt=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=f4(e,m4);return Z.createElement("svg",_0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-left",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"}))});Tt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var p4=["color","size","title","className"];function k0(){return k0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},k0.apply(null,arguments)}function x4(e,t){if(e==null)return{};var r,s,n=g4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function g4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var on=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=x4(e,p4);return Z.createElement("svg",k0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-arrow-right",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"}))});on.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var v4=["color","size","title","className"];function P0(){return P0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},P0.apply(null,arguments)}function b4(e,t){if(e==null)return{};var r,s,n=y4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function y4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var nx=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=b4(e,v4);return Z.createElement("svg",P0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-award",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702z"}),Z.createElement("path",{d:"M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z"}))});nx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var w4=["color","size","title","className"];function O0(){return O0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},O0.apply(null,arguments)}function j4(e,t){if(e==null)return{};var r,s,n=N4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function N4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var hd=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=j4(e,w4);return Z.createElement("svg",O0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-bar-chart",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M4 11H2v3h2zm5-4H7v7h2zm5-5v12h-2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1z"}))});hd.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var S4=["color","size","title","className"];function D0(){return D0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},D0.apply(null,arguments)}function E4(e,t){if(e==null)return{};var r,s,n=T4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function T4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var bt=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=E4(e,S4);return Z.createElement("svg",D0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-book",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"}))});bt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var A4=["color","size","title","className"];function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},I0.apply(null,arguments)}function C4(e,t){if(e==null)return{};var r,s,n=_4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var R0=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=C4(e,A4);return Z.createElement("svg",I0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-box-arrow-right",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"}),Z.createElement("path",{fillRule:"evenodd",d:"M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"}))});R0.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var k4=["color","size","title","className"];function F0(){return F0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},F0.apply(null,arguments)}function P4(e,t){if(e==null)return{};var r,s,n=O4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ka=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=P4(e,k4);return Z.createElement("svg",F0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-building",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"}),Z.createElement("path",{d:"M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3z"}))});ka.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var D4=["color","size","title","className"];function L0(){return L0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},L0.apply(null,arguments)}function I4(e,t){if(e==null)return{};var r,s,n=R4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function R4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var no=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=I4(e,D4);return Z.createElement("svg",L0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-calendar-event",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"}),Z.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});no.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var F4=["color","size","title","className"];function M0(){return M0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},M0.apply(null,arguments)}function L4(e,t){if(e==null)return{};var r,s,n=M4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function M4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var pr=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=L4(e,F4);return Z.createElement("svg",M0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-calendar",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"}))});pr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var B4=["color","size","title","className"];function B0(){return B0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},B0.apply(null,arguments)}function $4(e,t){if(e==null)return{};var r,s,n=z4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var G2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=$4(e,B4);return Z.createElement("svg",B0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-chat-dots",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"}),Z.createElement("path",{d:"m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"}))});G2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var U4=["color","size","title","className"];function $0(){return $0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$0.apply(null,arguments)}function W4(e,t){if(e==null)return{};var r,s,n=H4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function H4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var lt=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=W4(e,U4);return Z.createElement("svg",$0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-check-circle",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Z.createElement("path",{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"}))});lt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var V4=["color","size","title","className"];function z0(){return z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},z0.apply(null,arguments)}function G4(e,t){if(e==null)return{};var r,s,n=q4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function q4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var q2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=G4(e,V4);return Z.createElement("svg",z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-check-square",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}),Z.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});q2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var K4=["color","size","title","className"];function U0(){return U0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},U0.apply(null,arguments)}function Y4(e,t){if(e==null)return{};var r,s,n=X4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function X4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var K2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Y4(e,K4);return Z.createElement("svg",U0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-check",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))});K2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var J4=["color","size","title","className"];function W0(){return W0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},W0.apply(null,arguments)}function Z4(e,t){if(e==null)return{};var r,s,n=Q4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Q4(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ha=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Z4(e,J4);return Z.createElement("svg",W0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-chevron-down",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"}))});Ha.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var e5=["color","size","title","className"];function H0(){return H0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},H0.apply(null,arguments)}function t5(e,t){if(e==null)return{};var r,s,n=r5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function r5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ec=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=t5(e,e5);return Z.createElement("svg",H0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-chevron-right",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"}))});ec.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var s5=["color","size","title","className"];function V0(){return V0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},V0.apply(null,arguments)}function a5(e,t){if(e==null)return{};var r,s,n=n5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function n5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Y2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=a5(e,s5);return Z.createElement("svg",V0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-chevron-up",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"}))});Y2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var i5=["color","size","title","className"];function G0(){return G0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},G0.apply(null,arguments)}function o5(e,t){if(e==null)return{};var r,s,n=l5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var At=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=o5(e,i5);return Z.createElement("svg",G0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-clipboard-check",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),Z.createElement("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"}),Z.createElement("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"}))});At.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var c5=["color","size","title","className"];function q0(){return q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},q0.apply(null,arguments)}function d5(e,t){if(e==null)return{};var r,s,n=u5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function u5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var it=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=d5(e,c5);return Z.createElement("svg",q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-clock",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"}),Z.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"}))});it.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var m5=["color","size","title","className"];function K0(){return K0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},K0.apply(null,arguments)}function f5(e,t){if(e==null)return{};var r,s,n=h5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function h5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var X2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=f5(e,m5);return Z.createElement("svg",K0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-code",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M5.854 4.854a.5.5 0 1 0-.708-.708l-3.5 3.5a.5.5 0 0 0 0 .708l3.5 3.5a.5.5 0 0 0 .708-.708L2.707 8zm4.292 0a.5.5 0 0 1 .708-.708l3.5 3.5a.5.5 0 0 1 0 .708l-3.5 3.5a.5.5 0 0 1-.708-.708L13.293 8z"}))});X2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var p5=["color","size","title","className"];function Y0(){return Y0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Y0.apply(null,arguments)}function x5(e,t){if(e==null)return{};var r,s,n=g5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function g5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Fi=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=x5(e,p5);return Z.createElement("svg",Y0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-download",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),Z.createElement("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"}))});Fi.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var v5=["color","size","title","className"];function X0(){return X0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},X0.apply(null,arguments)}function b5(e,t){if(e==null)return{};var r,s,n=y5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function y5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var wi=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=b5(e,v5);return Z.createElement("svg",X0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-envelope",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"}))});wi.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var w5=["color","size","title","className"];function J0(){return J0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},J0.apply(null,arguments)}function j5(e,t){if(e==null)return{};var r,s,n=N5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function N5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var J2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=j5(e,w5);return Z.createElement("svg",J0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-exclamation-circle",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Z.createElement("path",{d:"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});J2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var S5=["color","size","title","className"];function Z0(){return Z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Z0.apply(null,arguments)}function E5(e,t){if(e==null)return{};var r,s,n=T5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function T5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var yr=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=E5(e,S5);return Z.createElement("svg",Z0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-exclamation-triangle",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"}),Z.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"}))});yr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var A5=["color","size","title","className"];function Q0(){return Q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Q0.apply(null,arguments)}function C5(e,t){if(e==null)return{};var r,s,n=_5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var El=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=C5(e,A5);return Z.createElement("svg",Q0({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-eye-slash",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7 7 0 0 0-2.79.588l.77.771A6 6 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755q-.247.248-.517.486z"}),Z.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829"}),Z.createElement("path",{d:"M3.35 5.47q-.27.24-.518.487A13 13 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7 7 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12z"}))});El.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var k5=["color","size","title","className"];function eh(){return eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},eh.apply(null,arguments)}function P5(e,t){if(e==null)return{};var r,s,n=O5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Nt=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=P5(e,k5);return Z.createElement("svg",eh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-eye",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),Z.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"}))});Nt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var D5=["color","size","title","className"];function th(){return th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},th.apply(null,arguments)}function I5(e,t){if(e==null)return{};var r,s,n=R5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function R5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var fo=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=I5(e,D5);return Z.createElement("svg",th({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark-excel",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"}),Z.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}))});fo.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var F5=["color","size","title","className"];function rh(){return rh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},rh.apply(null,arguments)}function L5(e,t){if(e==null)return{};var r,s,n=M5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function M5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Nu=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=L5(e,F5);return Z.createElement("svg",rh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark-pdf",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"}),Z.createElement("path",{d:"M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"}))});Nu.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var B5=["color","size","title","className"];function sh(){return sh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},sh.apply(null,arguments)}function $5(e,t){if(e==null)return{};var r,s,n=z5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Su=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=$5(e,B5);return Z.createElement("svg",sh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark-text",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"}),Z.createElement("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"}))});Su.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var U5=["color","size","title","className"];function ah(){return ah=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ah.apply(null,arguments)}function W5(e,t){if(e==null)return{};var r,s,n=H5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function H5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Nd=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=W5(e,U5);return Z.createElement("svg",ah({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-earmark",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}))});Nd.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var V5=["color","size","title","className"];function nh(){return nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},nh.apply(null,arguments)}function G5(e,t){if(e==null)return{};var r,s,n=q5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function q5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Z2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=G5(e,V5);return Z.createElement("svg",nh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-text-fill",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1m0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1"}))});Z2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var K5=["color","size","title","className"];function ih(){return ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ih.apply(null,arguments)}function Y5(e,t){if(e==null)return{};var r,s,n=X5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function X5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var nr=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Y5(e,K5);return Z.createElement("svg",ih({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-file-text",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),Z.createElement("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"}))});nr.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var J5=["color","size","title","className"];function oh(){return oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},oh.apply(null,arguments)}function Z5(e,t){if(e==null)return{};var r,s,n=Q5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Q5(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Li=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Z5(e,J5);return Z.createElement("svg",oh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-funnel",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z"}))});Li.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var e3=["color","size","title","className"];function lh(){return lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},lh.apply(null,arguments)}function t3(e,t){if(e==null)return{};var r,s,n=r3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function r3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Q2=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=t3(e,e3);return Z.createElement("svg",lh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-gear",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"}),Z.createElement("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"}))});Q2.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var s3=["color","size","title","className"];function ch(){return ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ch.apply(null,arguments)}function a3(e,t){if(e==null)return{};var r,s,n=n3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function n3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var tc=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=a3(e,s3);return Z.createElement("svg",ch({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-geo-alt",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"}),Z.createElement("path",{d:"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});tc.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var i3=["color","size","title","className"];function dh(){return dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},dh.apply(null,arguments)}function o3(e,t){if(e==null)return{};var r,s,n=l3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function l3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var eN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=o3(e,i3);return Z.createElement("svg",dh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-house",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"}))});eN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var c3=["color","size","title","className"];function uh(){return uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},uh.apply(null,arguments)}function d3(e,t){if(e==null)return{};var r,s,n=u3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function u3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var tN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=d3(e,c3);return Z.createElement("svg",uh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-info-circle",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Z.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});tN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var m3=["color","size","title","className"];function mh(){return mh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mh.apply(null,arguments)}function f3(e,t){if(e==null)return{};var r,s,n=h3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function h3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Tl=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=f3(e,m3);return Z.createElement("svg",mh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-key",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),Z.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});Tl.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var p3=["color","size","title","className"];function fh(){return fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},fh.apply(null,arguments)}function x3(e,t){if(e==null)return{};var r,s,n=g3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function g3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ix=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=x3(e,p3);return Z.createElement("svg",fh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-list",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"}))});ix.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var v3=["color","size","title","className"];function hh(){return hh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},hh.apply(null,arguments)}function b3(e,t){if(e==null)return{};var r,s,n=y3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function y3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ln=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=b3(e,v3);return Z.createElement("svg",hh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-pen",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))});ln.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var w3=["color","size","title","className"];function ph(){return ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ph.apply(null,arguments)}function j3(e,t){if(e==null)return{};var r,s,n=N3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function N3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ox=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=j3(e,w3);return Z.createElement("svg",ph({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-pencil-square",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),Z.createElement("path",{fillRule:"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"}))});ox.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var S3=["color","size","title","className"];function xh(){return xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},xh.apply(null,arguments)}function E3(e,t){if(e==null)return{};var r,s,n=T3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function T3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var as=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=E3(e,S3);return Z.createElement("svg",xh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-pencil",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"}))});as.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var A3=["color","size","title","className"];function gh(){return gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},gh.apply(null,arguments)}function C3(e,t){if(e==null)return{};var r,s,n=_3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ar=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=C3(e,A3);return Z.createElement("svg",gh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-people",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"}))});Ar.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var k3=["color","size","title","className"];function vh(){return vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},vh.apply(null,arguments)}function P3(e,t){if(e==null)return{};var r,s,n=O3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function O3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var rN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=P3(e,k3);return Z.createElement("svg",vh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person-check-fill",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{fillRule:"evenodd",d:"M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"}),Z.createElement("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}))});rN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var D3=["color","size","title","className"];function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},bh.apply(null,arguments)}function I3(e,t){if(e==null)return{};var r,s,n=R3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function R3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ma=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=I3(e,D3);return Z.createElement("svg",bh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person-check",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m1.679-4.493-1.335 2.226a.75.75 0 0 1-1.174.144l-.774-.773a.5.5 0 0 1 .708-.708l.547.548 1.17-1.951a.5.5 0 1 1 .858.514M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"}),Z.createElement("path",{d:"M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}))});ma.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var F3=["color","size","title","className"];function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},yh.apply(null,arguments)}function L3(e,t){if(e==null)return{};var r,s,n=M3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function M3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var to=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=L3(e,F3);return Z.createElement("svg",yh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person-circle",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),Z.createElement("path",{fillRule:"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"}))});to.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var B3=["color","size","title","className"];function wh(){return wh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},wh.apply(null,arguments)}function $3(e,t){if(e==null)return{};var r,s,n=z3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var rc=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=$3(e,B3);return Z.createElement("svg",wh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person-x",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m.256 7a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"}),Z.createElement("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m-.646-4.854.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 0 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 .708-.708"}))});rc.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var U3=["color","size","title","className"];function jh(){return jh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},jh.apply(null,arguments)}function W3(e,t){if(e==null)return{};var r,s,n=H3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function H3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Lt=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=W3(e,U3);return Z.createElement("svg",jh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-person",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"}))});Lt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var V3=["color","size","title","className"];function Nh(){return Nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Nh.apply(null,arguments)}function G3(e,t){if(e==null)return{};var r,s,n=q3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function q3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var sN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=G3(e,V3);return Z.createElement("svg",Nh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-pie-chart",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M7.5 1.018a7 7 0 0 0-4.79 11.566L7.5 7.793zm1 0V7.5h6.482A7 7 0 0 0 8.5 1.018M14.982 8.5H8.207l-4.79 4.79A7 7 0 0 0 14.982 8.5M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8"}))});sN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var K3=["color","size","title","className"];function Sh(){return Sh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Sh.apply(null,arguments)}function Y3(e,t){if(e==null)return{};var r,s,n=X3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function X3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Eh=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Y3(e,K3);return Z.createElement("svg",Sh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-play-circle",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Z.createElement("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"}))});Eh.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var J3=["color","size","title","className"];function Th(){return Th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Th.apply(null,arguments)}function Z3(e,t){if(e==null)return{};var r,s,n=Q3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Q3(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var lx=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=Z3(e,J3);return Z.createElement("svg",Th({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-play",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"}))});lx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var eP=["color","size","title","className"];function Ah(){return Ah=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ah.apply(null,arguments)}function tP(e,t){if(e==null)return{};var r,s,n=rP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function rP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var aN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=tP(e,eP);return Z.createElement("svg",Ah({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-plus-circle",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Z.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});aN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var sP=["color","size","title","className"];function Ch(){return Ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ch.apply(null,arguments)}function aP(e,t){if(e==null)return{};var r,s,n=nP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function nP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Cs=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=aP(e,sP);return Z.createElement("svg",Ch({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-plus",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))});Cs.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var iP=["color","size","title","className"];function _h(){return _h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_h.apply(null,arguments)}function oP(e,t){if(e==null)return{};var r,s,n=lP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function lP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var xa=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=oP(e,iP);return Z.createElement("svg",_h({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-save",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z"}))});xa.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var cP=["color","size","title","className"];function kh(){return kh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},kh.apply(null,arguments)}function dP(e,t){if(e==null)return{};var r,s,n=uP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function uP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var cx=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=dP(e,cP);return Z.createElement("svg",kh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-search",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"}))});cx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var mP=["color","size","title","className"];function Ph(){return Ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ph.apply(null,arguments)}function fP(e,t){if(e==null)return{};var r,s,n=hP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function hP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var nN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=fP(e,mP);return Z.createElement("svg",Ph({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-send",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"}))});nN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var pP=["color","size","title","className"];function Oh(){return Oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Oh.apply(null,arguments)}function xP(e,t){if(e==null)return{};var r,s,n=gP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var iN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=xP(e,pP);return Z.createElement("svg",Oh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-shield-x",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}),Z.createElement("path",{d:"M6.146 5.146a.5.5 0 0 1 .708 0L8 6.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 7l1.147 1.146a.5.5 0 0 1-.708.708L8 7.707 6.854 8.854a.5.5 0 1 1-.708-.708L7.293 7 6.146 5.854a.5.5 0 0 1 0-.708"}))});iN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var vP=["color","size","title","className"];function Dh(){return Dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Dh.apply(null,arguments)}function bP(e,t){if(e==null)return{};var r,s,n=yP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function yP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var dx=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=bP(e,vP);return Z.createElement("svg",Dh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-shield",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"}))});dx.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var wP=["color","size","title","className"];function Ih(){return Ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ih.apply(null,arguments)}function jP(e,t){if(e==null)return{};var r,s,n=NP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function NP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var oN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=jP(e,wP);return Z.createElement("svg",Ih({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-square",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"}))});oN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var SP=["color","size","title","className"];function Rh(){return Rh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Rh.apply(null,arguments)}function EP(e,t){if(e==null)return{};var r,s,n=TP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function TP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var lN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=EP(e,SP);return Z.createElement("svg",Rh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-star",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"}))});lN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var AP=["color","size","title","className"];function Fh(){return Fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fh.apply(null,arguments)}function CP(e,t){if(e==null)return{};var r,s,n=_P(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _P(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var qt=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=CP(e,AP);return Z.createElement("svg",Fh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-three-dots-vertical",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"}))});qt.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var kP=["color","size","title","className"];function Lh(){return Lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Lh.apply(null,arguments)}function PP(e,t){if(e==null)return{};var r,s,n=OP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function OP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Mi=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=PP(e,kP);return Z.createElement("svg",Lh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-trash",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),Z.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});Mi.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var DP=["color","size","title","className"];function Mh(){return Mh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Mh.apply(null,arguments)}function IP(e,t){if(e==null)return{};var r,s,n=RP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function RP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var cN=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=IP(e,DP);return Z.createElement("svg",Mh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-trophy",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"}))});cN.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var FP=["color","size","title","className"];function Bh(){return Bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Bh.apply(null,arguments)}function LP(e,t){if(e==null)return{};var r,s,n=MP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function MP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ts=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=LP(e,FP);return Z.createElement("svg",Bh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-upload",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),Z.createElement("path",{d:"M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"}))});Ts.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var BP=["color","size","title","className"];function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$h.apply(null,arguments)}function $P(e,t){if(e==null)return{};var r,s,n=zP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ks=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=$P(e,BP);return Z.createElement("svg",$h({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-x-circle",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),Z.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});Ks.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};var UP=["color","size","title","className"];function zh(){return zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},zh.apply(null,arguments)}function WP(e,t){if(e==null)return{};var r,s,n=HP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function HP(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ze=b.forwardRef(function(e,t){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,i=n===void 0?"1em":n,o=e.title,l=o===void 0?null:o,c=e.className,d=c===void 0?"":c,u=WP(e,UP);return Z.createElement("svg",zh({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:s,className:["bi","bi-x",d].filter(Boolean).join(" ")},u),l?Z.createElement("title",null,l):null,Z.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"}))});Ze.propTypes={color:R.string,size:R.oneOfType([R.string,R.number]),title:R.string,className:R.string};const VP="/dsfms-template/assets/logo-light-BjNHVeeQ.png";function dN(e,t){return function(){return e.apply(t,arguments)}}const{toString:GP}=Object.prototype,{getPrototypeOf:ux}=Object,{iterator:Eu,toStringTag:uN}=Symbol,Tu=(e=>t=>{const r=GP.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Da=e=>(e=e.toLowerCase(),t=>Tu(t)===e),Au=e=>t=>typeof t===e,{isArray:ko}=Array,ho=Au("undefined");function sc(e){return e!==null&&!ho(e)&&e.constructor!==null&&!ho(e.constructor)&&Rs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const mN=Da("ArrayBuffer");function qP(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&mN(e.buffer),t}const KP=Au("string"),Rs=Au("function"),fN=Au("number"),ac=e=>e!==null&&typeof e=="object",YP=e=>e===!0||e===!1,pd=e=>{if(Tu(e)!=="object")return!1;const t=ux(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(uN in e)&&!(Eu in e)},XP=e=>{if(!ac(e)||sc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},JP=Da("Date"),ZP=Da("File"),QP=Da("Blob"),eO=Da("FileList"),tO=e=>ac(e)&&Rs(e.pipe),rO=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Rs(e.append)&&((t=Tu(e))==="formdata"||t==="object"&&Rs(e.toString)&&e.toString()==="[object FormData]"))},sO=Da("URLSearchParams"),[aO,nO,iO,oO]=["ReadableStream","Request","Response","Headers"].map(Da),lO=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function nc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let s,n;if(typeof e!="object"&&(e=[e]),ko(e))for(s=0,n=e.length;s<n;s++)t.call(null,e[s],s,e);else{if(sc(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(s=0;s<o;s++)l=i[s],t.call(null,e[l],l,e)}}function hN(e,t){if(sc(e))return null;t=t.toLowerCase();const r=Object.keys(e);let s=r.length,n;for(;s-- >0;)if(n=r[s],t===n.toLowerCase())return n;return null}const ni=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pN=e=>!ho(e)&&e!==ni;function Uh(){const{caseless:e,skipUndefined:t}=pN(this)&&this||{},r={},s=(n,i)=>{const o=e&&hN(r,i)||i;pd(r[o])&&pd(n)?r[o]=Uh(r[o],n):pd(n)?r[o]=Uh({},n):ko(n)?r[o]=n.slice():(!t||!ho(n))&&(r[o]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&nc(arguments[n],s);return r}const cO=(e,t,r,{allOwnKeys:s}={})=>(nc(t,(n,i)=>{r&&Rs(n)?e[i]=dN(n,r):e[i]=n},{allOwnKeys:s}),e),dO=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),uO=(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},mO=(e,t,r,s)=>{let n,i,o;const l={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)o=n[i],(!s||s(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&ux(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},fO=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return s!==-1&&s===r},hO=e=>{if(!e)return null;if(ko(e))return e;let t=e.length;if(!fN(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},pO=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ux(Uint8Array)),xO=(e,t)=>{const s=(e&&e[Eu]).call(e);let n;for(;(n=s.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},gO=(e,t)=>{let r;const s=[];for(;(r=e.exec(t))!==null;)s.push(r);return s},vO=Da("HTMLFormElement"),bO=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,n){return s.toUpperCase()+n}),i1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),yO=Da("RegExp"),xN=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};nc(r,(n,i)=>{let o;(o=t(n,i,e))!==!1&&(s[i]=o||n)}),Object.defineProperties(e,s)},wO=e=>{xN(e,(t,r)=>{if(Rs(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=e[r];if(Rs(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},jO=(e,t)=>{const r={},s=n=>{n.forEach(i=>{r[i]=!0})};return ko(e)?s(e):s(String(e).split(t)),r},NO=()=>{},SO=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function EO(e){return!!(e&&Rs(e.append)&&e[uN]==="FormData"&&e[Eu])}const TO=e=>{const t=new Array(10),r=(s,n)=>{if(ac(s)){if(t.indexOf(s)>=0)return;if(sc(s))return s;if(!("toJSON"in s)){t[n]=s;const i=ko(s)?[]:{};return nc(s,(o,l)=>{const c=r(o,n+1);!ho(c)&&(i[l]=c)}),t[n]=void 0,i}}return s};return r(e,0)},AO=Da("AsyncFunction"),CO=e=>e&&(ac(e)||Rs(e))&&Rs(e.then)&&Rs(e.catch),gN=((e,t)=>e?setImmediate:t?((r,s)=>(ni.addEventListener("message",({source:n,data:i})=>{n===ni&&i===r&&s.length&&s.shift()()},!1),n=>{s.push(n),ni.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Rs(ni.postMessage)),_O=typeof queueMicrotask<"u"?queueMicrotask.bind(ni):typeof process<"u"&&process.nextTick||gN,kO=e=>e!=null&&Rs(e[Eu]),we={isArray:ko,isArrayBuffer:mN,isBuffer:sc,isFormData:rO,isArrayBufferView:qP,isString:KP,isNumber:fN,isBoolean:YP,isObject:ac,isPlainObject:pd,isEmptyObject:XP,isReadableStream:aO,isRequest:nO,isResponse:iO,isHeaders:oO,isUndefined:ho,isDate:JP,isFile:ZP,isBlob:QP,isRegExp:yO,isFunction:Rs,isStream:tO,isURLSearchParams:sO,isTypedArray:pO,isFileList:eO,forEach:nc,merge:Uh,extend:cO,trim:lO,stripBOM:dO,inherits:uO,toFlatObject:mO,kindOf:Tu,kindOfTest:Da,endsWith:fO,toArray:hO,forEachEntry:xO,matchAll:gO,isHTMLForm:vO,hasOwnProperty:i1,hasOwnProp:i1,reduceDescriptors:xN,freezeMethods:wO,toObjectSet:jO,toCamelCase:bO,noop:NO,toFiniteNumber:SO,findKey:hN,global:ni,isContextDefined:pN,isSpecCompliantForm:EO,toJSONObject:TO,isAsyncFn:AO,isThenable:CO,setImmediate:gN,asap:_O,isIterable:kO};function gt(e,t,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}we.inherits(gt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:we.toJSONObject(this.config),code:this.code,status:this.status}}});const vN=gt.prototype,bN={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{bN[e]={value:e}});Object.defineProperties(gt,bN);Object.defineProperty(vN,"isAxiosError",{value:!0});gt.from=(e,t,r,s,n,i)=>{const o=Object.create(vN);we.toFlatObject(e,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return gt.call(o,l,c,r,s,n),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const PO=null;function Wh(e){return we.isPlainObject(e)||we.isArray(e)}function yN(e){return we.endsWith(e,"[]")?e.slice(0,-2):e}function o1(e,t,r){return e?e.concat(t).map(function(n,i){return n=yN(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function OO(e){return we.isArray(e)&&!e.some(Wh)}const DO=we.toFlatObject(we,{},null,function(t){return/^is[A-Z]/.test(t)});function Cu(e,t,r){if(!we.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=we.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,g){return!we.isUndefined(g[x])});const s=r.metaTokens,n=r.visitor||u,i=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&we.isSpecCompliantForm(t);if(!we.isFunction(n))throw new TypeError("visitor must be a function");function d(p){if(p===null)return"";if(we.isDate(p))return p.toISOString();if(we.isBoolean(p))return p.toString();if(!c&&we.isBlob(p))throw new gt("Blob is not supported. Use a Buffer instead.");return we.isArrayBuffer(p)||we.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,x,g){let v=p;if(p&&!g&&typeof p=="object"){if(we.endsWith(x,"{}"))x=s?x:x.slice(0,-2),p=JSON.stringify(p);else if(we.isArray(p)&&OO(p)||(we.isFileList(p)||we.endsWith(x,"[]"))&&(v=we.toArray(p)))return x=yN(x),v.forEach(function(y,S){!(we.isUndefined(y)||y===null)&&t.append(o===!0?o1([x],S,i):o===null?x:x+"[]",d(y))}),!1}return Wh(p)?!0:(t.append(o1(g,x,i),d(p)),!1)}const m=[],f=Object.assign(DO,{defaultVisitor:u,convertValue:d,isVisitable:Wh});function h(p,x){if(!we.isUndefined(p)){if(m.indexOf(p)!==-1)throw Error("Circular reference detected in "+x.join("."));m.push(p),we.forEach(p,function(v,w){(!(we.isUndefined(v)||v===null)&&n.call(t,v,we.isString(w)?w.trim():w,x,f))===!0&&h(v,x?x.concat(w):[w])}),m.pop()}}if(!we.isObject(e))throw new TypeError("data must be an object");return h(e),t}function l1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function mx(e,t){this._pairs=[],e&&Cu(e,this,t)}const wN=mx.prototype;wN.append=function(t,r){this._pairs.push([t,r])};wN.toString=function(t){const r=t?function(s){return t.call(this,s,l1)}:l1;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function IO(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function jN(e,t,r){if(!t)return e;const s=r&&r.encode||IO;we.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=we.isURLSearchParams(t)?t.toString():new mx(t,r).toString(s),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class c1{constructor(){this.handlers=[]}use(t,r,s){return this.handlers.push({fulfilled:t,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){we.forEach(this.handlers,function(s){s!==null&&t(s)})}}const NN={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},RO=typeof URLSearchParams<"u"?URLSearchParams:mx,FO=typeof FormData<"u"?FormData:null,LO=typeof Blob<"u"?Blob:null,MO={isBrowser:!0,classes:{URLSearchParams:RO,FormData:FO,Blob:LO},protocols:["http","https","file","blob","url","data"]},fx=typeof window<"u"&&typeof document<"u",Hh=typeof navigator=="object"&&navigator||void 0,BO=fx&&(!Hh||["ReactNative","NativeScript","NS"].indexOf(Hh.product)<0),$O=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",zO=fx&&window.location.href||"http://localhost",UO=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:fx,hasStandardBrowserEnv:BO,hasStandardBrowserWebWorkerEnv:$O,navigator:Hh,origin:zO},Symbol.toStringTag,{value:"Module"})),fs={...UO,...MO};function WO(e,t){return Cu(e,new fs.classes.URLSearchParams,{visitor:function(r,s,n,i){return fs.isNode&&we.isBuffer(r)?(this.append(s,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function HO(e){return we.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function VO(e){const t={},r=Object.keys(e);let s;const n=r.length;let i;for(s=0;s<n;s++)i=r[s],t[i]=e[i];return t}function SN(e){function t(r,s,n,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=r.length;return o=!o&&we.isArray(n)?n.length:o,c?(we.hasOwnProp(n,o)?n[o]=[n[o],s]:n[o]=s,!l):((!n[o]||!we.isObject(n[o]))&&(n[o]=[]),t(r,s,n[o],i)&&we.isArray(n[o])&&(n[o]=VO(n[o])),!l)}if(we.isFormData(e)&&we.isFunction(e.entries)){const r={};return we.forEachEntry(e,(s,n)=>{t(HO(s),n,r,0)}),r}return null}function GO(e,t,r){if(we.isString(e))try{return(t||JSON.parse)(e),we.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(e)}const ic={transitional:NN,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const s=r.getContentType()||"",n=s.indexOf("application/json")>-1,i=we.isObject(t);if(i&&we.isHTMLForm(t)&&(t=new FormData(t)),we.isFormData(t))return n?JSON.stringify(SN(t)):t;if(we.isArrayBuffer(t)||we.isBuffer(t)||we.isStream(t)||we.isFile(t)||we.isBlob(t)||we.isReadableStream(t))return t;if(we.isArrayBufferView(t))return t.buffer;if(we.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return WO(t,this.formSerializer).toString();if((l=we.isFileList(t))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Cu(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),GO(t)):t}],transformResponse:[function(t){const r=this.transitional||ic.transitional,s=r&&r.forcedJSONParsing,n=this.responseType==="json";if(we.isResponse(t)||we.isReadableStream(t))return t;if(t&&we.isString(t)&&(s&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?gt.from(l,gt.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:fs.classes.FormData,Blob:fs.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};we.forEach(["delete","get","head","post","put","patch"],e=>{ic.headers[e]={}});const qO=we.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),KO=e=>{const t={};let r,s,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),s=o.substring(n+1).trim(),!(!r||t[r]&&qO[r])&&(r==="set-cookie"?t[r]?t[r].push(s):t[r]=[s]:t[r]=t[r]?t[r]+", "+s:s)}),t},d1=Symbol("internals");function Yo(e){return e&&String(e).trim().toLowerCase()}function xd(e){return e===!1||e==null?e:we.isArray(e)?e.map(xd):String(e)}function YO(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(e);)t[s[1]]=s[2];return t}const XO=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Sm(e,t,r,s,n){if(we.isFunction(s))return s.call(this,t,r);if(n&&(t=r),!!we.isString(t)){if(we.isString(s))return t.indexOf(s)!==-1;if(we.isRegExp(s))return s.test(t)}}function JO(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,s)=>r.toUpperCase()+s)}function ZO(e,t){const r=we.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+r,{value:function(n,i,o){return this[s].call(this,t,n,i,o)},configurable:!0})})}let Fs=class{constructor(t){t&&this.set(t)}set(t,r,s){const n=this;function i(l,c,d){const u=Yo(c);if(!u)throw new Error("header name must be a non-empty string");const m=we.findKey(n,u);(!m||n[m]===void 0||d===!0||d===void 0&&n[m]!==!1)&&(n[m||c]=xd(l))}const o=(l,c)=>we.forEach(l,(d,u)=>i(d,u,c));if(we.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(we.isString(t)&&(t=t.trim())&&!XO(t))o(KO(t),r);else if(we.isObject(t)&&we.isIterable(t)){let l={},c,d;for(const u of t){if(!we.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?we.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}o(l,r)}else t!=null&&i(r,t,s);return this}get(t,r){if(t=Yo(t),t){const s=we.findKey(this,t);if(s){const n=this[s];if(!r)return n;if(r===!0)return YO(n);if(we.isFunction(r))return r.call(this,n,s);if(we.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Yo(t),t){const s=we.findKey(this,t);return!!(s&&this[s]!==void 0&&(!r||Sm(this,this[s],s,r)))}return!1}delete(t,r){const s=this;let n=!1;function i(o){if(o=Yo(o),o){const l=we.findKey(s,o);l&&(!r||Sm(s,s[l],l,r))&&(delete s[l],n=!0)}}return we.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let s=r.length,n=!1;for(;s--;){const i=r[s];(!t||Sm(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,s={};return we.forEach(this,(n,i)=>{const o=we.findKey(s,i);if(o){r[o]=xd(n),delete r[i];return}const l=t?JO(i):String(i).trim();l!==i&&delete r[i],r[l]=xd(n),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return we.forEach(this,(s,n)=>{s!=null&&s!==!1&&(r[n]=t&&we.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const s=new this(t);return r.forEach(n=>s.set(n)),s}static accessor(t){const s=(this[d1]=this[d1]={accessors:{}}).accessors,n=this.prototype;function i(o){const l=Yo(o);s[l]||(ZO(n,o),s[l]=!0)}return we.isArray(t)?t.forEach(i):i(t),this}};Fs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);we.reduceDescriptors(Fs.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[r]=s}}});we.freezeMethods(Fs);function Em(e,t){const r=this||ic,s=t||r,n=Fs.from(s.headers);let i=s.data;return we.forEach(e,function(l){i=l.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function EN(e){return!!(e&&e.__CANCEL__)}function Po(e,t,r){gt.call(this,e??"canceled",gt.ERR_CANCELED,t,r),this.name="CanceledError"}we.inherits(Po,gt,{__CANCEL__:!0});function TN(e,t,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):t(new gt("Request failed with status code "+r.status,[gt.ERR_BAD_REQUEST,gt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function QO(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function eD(e,t){e=e||10;const r=new Array(e),s=new Array(e);let n=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=s[i];o||(o=d),r[n]=c,s[n]=d;let m=i,f=0;for(;m!==n;)f+=r[m++],m=m%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),d-o<t)return;const h=u&&d-u;return h?Math.round(f*1e3/h):void 0}}function tD(e,t){let r=0,s=1e3/t,n,i;const o=(d,u=Date.now())=>{r=u,n=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const u=Date.now(),m=u-r;m>=s?o(d,u):(n=d,i||(i=setTimeout(()=>{i=null,o(n)},s-m)))},()=>n&&o(n)]}const Sd=(e,t,r=3)=>{let s=0;const n=eD(50,250);return tD(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-s,d=n(c),u=o<=l;s=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-o)/d:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},u1=(e,t)=>{const r=e!=null;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},m1=e=>(...t)=>we.asap(()=>e(...t)),rD=fs.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,fs.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(fs.origin),fs.navigator&&/(msie|trident)/i.test(fs.navigator.userAgent)):()=>!0,sD=fs.hasStandardBrowserEnv?{write(e,t,r,s,n,i){const o=[e+"="+encodeURIComponent(t)];we.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),we.isString(s)&&o.push("path="+s),we.isString(n)&&o.push("domain="+n),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function aD(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function nD(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function AN(e,t,r){let s=!aD(t);return e&&(s||r==!1)?nD(e,t):t}const f1=e=>e instanceof Fs?{...e}:e;function ji(e,t){t=t||{};const r={};function s(d,u,m,f){return we.isPlainObject(d)&&we.isPlainObject(u)?we.merge.call({caseless:f},d,u):we.isPlainObject(u)?we.merge({},u):we.isArray(u)?u.slice():u}function n(d,u,m,f){if(we.isUndefined(u)){if(!we.isUndefined(d))return s(void 0,d,m,f)}else return s(d,u,m,f)}function i(d,u){if(!we.isUndefined(u))return s(void 0,u)}function o(d,u){if(we.isUndefined(u)){if(!we.isUndefined(d))return s(void 0,d)}else return s(void 0,u)}function l(d,u,m){if(m in t)return s(d,u);if(m in e)return s(void 0,d)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,u,m)=>n(f1(d),f1(u),m,!0)};return we.forEach(Object.keys({...e,...t}),function(u){const m=c[u]||n,f=m(e[u],t[u],u);we.isUndefined(f)&&m!==l||(r[u]=f)}),r}const CN=e=>{const t=ji({},e);let{data:r,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=Fs.from(o),t.url=jN(AN(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),we.isFormData(r)){if(fs.hasStandardBrowserEnv||fs.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(we.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([u,m])=>{d.includes(u.toLowerCase())&&o.set(u,m)})}}if(fs.hasStandardBrowserEnv&&(s&&we.isFunction(s)&&(s=s(t)),s||s!==!1&&rD(t.url))){const c=n&&i&&sD.read(i);c&&o.set(n,c)}return t},iD=typeof XMLHttpRequest<"u",oD=iD&&function(e){return new Promise(function(r,s){const n=CN(e);let i=n.data;const o=Fs.from(n.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=n,u,m,f,h,p;function x(){h&&h(),p&&p(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout;function v(){if(!g)return;const y=Fs.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),E={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:y,config:e,request:g};TN(function(j){r(j),x()},function(j){s(j),x()},E),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(s(new gt("Request aborted",gt.ECONNABORTED,e,g)),g=null)},g.onerror=function(S){const E=S&&S.message?S.message:"Network Error",N=new gt(E,gt.ERR_NETWORK,e,g);N.event=S||null,s(N),g=null},g.ontimeout=function(){let S=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const E=n.transitional||NN;n.timeoutErrorMessage&&(S=n.timeoutErrorMessage),s(new gt(S,E.clarifyTimeoutError?gt.ETIMEDOUT:gt.ECONNABORTED,e,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&we.forEach(o.toJSON(),function(S,E){g.setRequestHeader(E,S)}),we.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),l&&l!=="json"&&(g.responseType=n.responseType),d&&([f,p]=Sd(d,!0),g.addEventListener("progress",f)),c&&g.upload&&([m,h]=Sd(c),g.upload.addEventListener("progress",m),g.upload.addEventListener("loadend",h)),(n.cancelToken||n.signal)&&(u=y=>{g&&(s(!y||y.type?new Po(null,e,g):y),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const w=QO(n.url);if(w&&fs.protocols.indexOf(w)===-1){s(new gt("Unsupported protocol "+w+":",gt.ERR_BAD_REQUEST,e));return}g.send(i||null)})},lD=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let s=new AbortController,n;const i=function(d){if(!n){n=!0,l();const u=d instanceof Error?d:this.reason;s.abort(u instanceof gt?u:new Po(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,i(new gt(`timeout ${t} of ms exceeded`,gt.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=s;return c.unsubscribe=()=>we.asap(l),c}},cD=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let s=0,n;for(;s<r;)n=s+t,yield e.slice(s,n),s=n},dD=async function*(e,t){for await(const r of uD(e))yield*cD(r,t)},uD=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:s}=await t.read();if(r)break;yield s}}finally{await t.cancel()}},h1=(e,t,r,s)=>{const n=dD(e,t);let i=0,o,l=c=>{o||(o=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await n.next();if(d){l(),c.close();return}let m=u.byteLength;if(r){let f=i+=m;r(f)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),n.return()}},{highWaterMark:2})},p1=64*1024,{isFunction:Fc}=we,mD=(({Request:e,Response:t})=>({Request:e,Response:t}))(we.global),{ReadableStream:x1,TextEncoder:g1}=we.global,v1=(e,...t)=>{try{return!!e(...t)}catch{return!1}},fD=e=>{e=we.merge.call({skipUndefined:!0},mD,e);const{fetch:t,Request:r,Response:s}=e,n=t?Fc(t):typeof fetch=="function",i=Fc(r),o=Fc(s);if(!n)return!1;const l=n&&Fc(x1),c=n&&(typeof g1=="function"?(p=>x=>p.encode(x))(new g1):async p=>new Uint8Array(await new r(p).arrayBuffer())),d=i&&l&&v1(()=>{let p=!1;const x=new r(fs.origin,{body:new x1,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!x}),u=o&&l&&v1(()=>we.isReadableStream(new s("").body)),m={stream:u&&(p=>p.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!m[p]&&(m[p]=(x,g)=>{let v=x&&x[p];if(v)return v.call(x);throw new gt(`Response type '${p}' is not supported`,gt.ERR_NOT_SUPPORT,g)})});const f=async p=>{if(p==null)return 0;if(we.isBlob(p))return p.size;if(we.isSpecCompliantForm(p))return(await new r(fs.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(we.isArrayBufferView(p)||we.isArrayBuffer(p))return p.byteLength;if(we.isURLSearchParams(p)&&(p=p+""),we.isString(p))return(await c(p)).byteLength},h=async(p,x)=>{const g=we.toFiniteNumber(p.getContentLength());return g??f(x)};return async p=>{let{url:x,method:g,data:v,signal:w,cancelToken:y,timeout:S,onDownloadProgress:E,onUploadProgress:N,responseType:j,headers:T,withCredentials:C="same-origin",fetchOptions:L}=CN(p),A=t||fetch;j=j?(j+"").toLowerCase():"text";let P=lD([w,y&&y.toAbortSignal()],S),I=null;const _=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let D;try{if(N&&d&&g!=="get"&&g!=="head"&&(D=await h(T,v))!==0){let Ae=new r(x,{method:"POST",body:v,duplex:"half"}),O;if(we.isFormData(v)&&(O=Ae.headers.get("content-type"))&&T.setContentType(O),Ae.body){const[G,U]=u1(D,Sd(m1(N)));v=h1(Ae.body,p1,G,U)}}we.isString(C)||(C=C?"include":"omit");const W=i&&"credentials"in r.prototype,K={...L,signal:P,method:g.toUpperCase(),headers:T.normalize().toJSON(),body:v,duplex:"half",credentials:W?C:void 0};I=i&&new r(x,K);let J=await(i?A(I,L):A(x,K));const F=u&&(j==="stream"||j==="response");if(u&&(E||F&&_)){const Ae={};["status","statusText","headers"].forEach(B=>{Ae[B]=J[B]});const O=we.toFiniteNumber(J.headers.get("content-length")),[G,U]=E&&u1(O,Sd(m1(E),!0))||[];J=new s(h1(J.body,p1,G,()=>{U&&U(),_&&_()}),Ae)}j=j||"text";let le=await m[we.findKey(m,j)||"text"](J,p);return!F&&_&&_(),await new Promise((Ae,O)=>{TN(Ae,O,{data:le,headers:Fs.from(J.headers),status:J.status,statusText:J.statusText,config:p,request:I})})}catch(W){throw _&&_(),W&&W.name==="TypeError"&&/Load failed|fetch/i.test(W.message)?Object.assign(new gt("Network Error",gt.ERR_NETWORK,p,I),{cause:W.cause||W}):gt.from(W,W&&W.code,p,I)}}},hD=new Map,_N=e=>{let t=e?e.env:{};const{fetch:r,Request:s,Response:n}=t,i=[s,n,r];let o=i.length,l=o,c,d,u=hD;for(;l--;)c=i[l],d=u.get(c),d===void 0&&u.set(c,d=l?new Map:fD(t)),u=d;return d};_N();const Vh={http:PO,xhr:oD,fetch:{get:_N}};we.forEach(Vh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const b1=e=>`- ${e}`,pD=e=>we.isFunction(e)||e===null||e===!1,kN={getAdapter:(e,t)=>{e=we.isArray(e)?e:[e];const{length:r}=e;let s,n;const i={};for(let o=0;o<r;o++){s=e[o];let l;if(n=s,!pD(s)&&(n=Vh[(l=String(s)).toLowerCase()],n===void 0))throw new gt(`Unknown adapter '${l}'`);if(n&&(we.isFunction(n)||(n=n.get(t))))break;i[l||"#"+o]=n}if(!n){const o=Object.entries(i).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(b1).join(`
`):" "+b1(o[0]):"as no adapter specified";throw new gt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n},adapters:Vh};function Tm(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Po(null,e)}function y1(e){return Tm(e),e.headers=Fs.from(e.headers),e.data=Em.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),kN.getAdapter(e.adapter||ic.adapter,e)(e).then(function(s){return Tm(e),s.data=Em.call(e,e.transformResponse,s),s.headers=Fs.from(s.headers),s},function(s){return EN(s)||(Tm(e),s&&s.response&&(s.response.data=Em.call(e,e.transformResponse,s.response),s.response.headers=Fs.from(s.response.headers))),Promise.reject(s)})}const PN="1.12.2",_u={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{_u[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const w1={};_u.transitional=function(t,r,s){function n(i,o){return"[Axios v"+PN+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,l)=>{if(t===!1)throw new gt(n(o," has been removed"+(r?" in "+r:"")),gt.ERR_DEPRECATED);return r&&!w1[o]&&(w1[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};_u.spelling=function(t){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function xD(e,t,r){if(typeof e!="object")throw new gt("options must be an object",gt.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let n=s.length;for(;n-- >0;){const i=s[n],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new gt("option "+i+" must be "+c,gt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new gt("Unknown option "+i,gt.ERR_BAD_OPTION)}}const gd={assertOptions:xD,validators:_u},Ra=gd.validators;let mi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new c1,response:new c1}}async request(t,r){try{return await this._request(t,r)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ji(this.defaults,r);const{transitional:s,paramsSerializer:n,headers:i}=r;s!==void 0&&gd.assertOptions(s,{silentJSONParsing:Ra.transitional(Ra.boolean),forcedJSONParsing:Ra.transitional(Ra.boolean),clarifyTimeoutError:Ra.transitional(Ra.boolean)},!1),n!=null&&(we.isFunction(n)?r.paramsSerializer={serialize:n}:gd.assertOptions(n,{encode:Ra.function,serialize:Ra.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),gd.assertOptions(r,{baseUrl:Ra.spelling("baseURL"),withXsrfToken:Ra.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&we.merge(i.common,i[r.method]);i&&we.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),r.headers=Fs.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(c=c&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let u,m=0,f;if(!c){const p=[y1.bind(this),void 0];for(p.unshift(...l),p.push(...d),f=p.length,u=Promise.resolve(r);m<f;)u=u.then(p[m++],p[m++]);return u}f=l.length;let h=r;for(;m<f;){const p=l[m++],x=l[m++];try{h=p(h)}catch(g){x.call(this,g);break}}try{u=y1.call(this,h)}catch(p){return Promise.reject(p)}for(m=0,f=d.length;m<f;)u=u.then(d[m++],d[m++]);return u}getUri(t){t=ji(this.defaults,t);const r=AN(t.baseURL,t.url,t.allowAbsoluteUrls);return jN(r,t.params,t.paramsSerializer)}};we.forEach(["delete","get","head","options"],function(t){mi.prototype[t]=function(r,s){return this.request(ji(s||{},{method:t,url:r,data:(s||{}).data}))}});we.forEach(["post","put","patch"],function(t){function r(s){return function(i,o,l){return this.request(ji(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}mi.prototype[t]=r(),mi.prototype[t+"Form"]=r(!0)});let gD=class ON{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const s=this;this.promise.then(n=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](n);s._listeners=null}),this.promise.then=n=>{let i;const o=new Promise(l=>{s.subscribe(l),i=l}).then(n);return o.cancel=function(){s.unsubscribe(i)},o},t(function(i,o,l){s.reason||(s.reason=new Po(i,o,l),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new ON(function(n){t=n}),cancel:t}}};function vD(e){return function(r){return e.apply(null,r)}}function bD(e){return we.isObject(e)&&e.isAxiosError===!0}const Gh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Gh).forEach(([e,t])=>{Gh[t]=e});function DN(e){const t=new mi(e),r=dN(mi.prototype.request,t);return we.extend(r,mi.prototype,t,{allOwnKeys:!0}),we.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return DN(ji(e,n))},r}const xr=DN(ic);xr.Axios=mi;xr.CanceledError=Po;xr.CancelToken=gD;xr.isCancel=EN;xr.VERSION=PN;xr.toFormData=Cu;xr.AxiosError=gt;xr.Cancel=xr.CanceledError;xr.all=function(t){return Promise.all(t)};xr.spread=vD;xr.isAxiosError=bD;xr.mergeConfig=ji;xr.AxiosHeaders=Fs;xr.formToJSON=e=>SN(we.isHTMLForm(e)?new FormData(e):e);xr.getAdapter=kN.getAdapter;xr.HttpStatusCode=Gh;xr.default=xr;const{Axios:ole,AxiosError:lle,CanceledError:cle,isCancel:dle,CancelToken:ule,VERSION:mle,all:fle,Cancel:hle,isAxiosError:ple,spread:xle,toFormData:gle,AxiosHeaders:vle,HttpStatusCode:ble,formToJSON:yle,getAdapter:wle,mergeConfig:jle}=xr,$a={BASE_URL:"https://dsfms.id.vn",TIMEOUT:1e4,ENDPOINTS:{AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",STATUS:"/auth/status",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"}}},hx=()=>"/dsfms-template/",yD=(e="/")=>{const r=`${hx()}${e}`;window.location.href=r},Am=()=>{yD("/")},IN="https://dsfms.id.vn",Ie=xr.create({baseURL:IN,timeout:1e4,headers:{"Content-Type":"application/json"}});let Cm=!1,qh=[],Lc=0;const j1=2,RN=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp<r}catch{return!0}},wD=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),r=Date.now()/1e3;return t.exp-r<300}catch{return!0}},N1=(e,t=null)=>{qh.forEach(r=>{e?r.reject(e):r.resolve(t)}),qh=[]};Ie.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(RN(t)?console.log(" Token is expired, will trigger refresh in response interceptor"):wD(t)&&console.log(" Token expires soon, consider refreshing"),e.headers.Authorization=`Bearer ${t}`,e.url?.includes("/roles/")&&e.method==="put"&&console.log(" Role update request:",{url:e.url,method:e.method,data:e.data,headers:{Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}}),e.url?.includes("/assign-trainees")&&e.method==="post"&&console.log(" Assign Trainees Request (Interceptor):",{url:e.url,method:e.method,data:e.data,dataType:typeof e.data,dataIsArray:Array.isArray(e.data),dataStringified:JSON.stringify(e.data),headers:{"Content-Type":e.headers["Content-Type"],Authorization:e.headers.Authorization?"Bearer [TOKEN]":"No token"}})),e},e=>Promise.reject(e));Ie.interceptors.response.use(e=>e,async e=>{const t=e.config,r=e.response?.status;if(r===401&&!t._retry&&!t.url?.includes("/auth/")&&Lc<j1){if(console.log(" API call failed with 401 (token expired), attempting token refresh..."),Cm)return new Promise((n,i)=>{qh.push({resolve:n,reject:i})}).then(n=>(t.headers.Authorization=`Bearer ${n}`,Ie(t))).catch(n=>Promise.reject(n));t._retry=!0,Cm=!0,Lc++;const s=localStorage.getItem("refreshToken");if(s)try{if(console.log(" Token ht hn (401), ang refresh token..."),RN(s))throw new Error("Refresh token is also expired");const n=await xr.post(`${IN}/auth/refresh`,{refresh_token:s}),{access_token:i,refresh_token:o}=n.data;if(!i||!o)throw new Error("Invalid token response from server");return localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",o),Lc=0,console.log(" Refresh token thnh cng, retry request gc"),N1(null,i),t.headers.Authorization=`Bearer ${i}`,await Ie(t)}catch(n){return console.error(" Refresh token tht bi:",n),N1(n,null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Am(),Promise.reject(n)}finally{Cm=!1}else console.log(" Khng c refresh token, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),Am()}else{if(r===403)return console.log(" API call failed with 403 (insufficient permissions) - user remains logged in"),Promise.reject(e);Lc>=j1&&(console.error("  vt qu s ln refresh cho php, logout user"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),Am())}return Promise.reject(e)});const Mc=xr.create({baseURL:"https://dsfms.id.vn",timeout:1e4,headers:{"Content-Type":"application/json"}}),Sn={login:async e=>{try{return(await Mc.post("/auth/login",e)).data}catch(t){throw t.response?.data||t.message}},refreshToken:async e=>{try{return(await Mc.post("/auth/refresh",{refresh_token:e})).data}catch(t){throw t.response?.data||t.message}},checkStatus:async()=>{try{return(await Ie.get("/auth/status")).data}catch(e){throw e.response?.data||e.message}},forgotPassword:async(e,t)=>{try{return(await Mc.post("/auth/forgot-password",{email:e,magicLink:t})).data}catch(r){throw r.response?.data||r.message}},resetPasswordWithToken:async(e,t,r)=>{try{return(await Mc.post("/auth/reset-password",{token:e,newPassword:t,confirmPassword:r})).data}catch(s){throw s.response?.data||s.message}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")}},bs={getUsers:async(e={})=>{try{const r=(await Ie.get("/users",{params:e})).data;if(r&&r.data){if(Array.isArray(r.data))return{data:r.data};if(r.data.users&&Array.isArray(r.data.users))return{data:r.data.users}}return Array.isArray(r)?{data:r}:r&&r.users&&Array.isArray(r.users)?{data:r.users}:r}catch(t){throw t.response?.data||t.message}},getUserById:async e=>{try{return(await Ie.get(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},getProfile:async()=>{try{return(await Ie.get("/profile")).data}catch(e){throw e.response?.data||e.message}},createUser:async e=>{try{return(await Ie.post("/users",e)).data}catch(t){throw t.response?.data||t.message}},updateUser:async(e,t)=>{try{return(await Ie.put(`/users/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteUser:async e=>{try{return(await Ie.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},bulkImportUsers:async e=>{try{return(await Ie.post("/users/bulk",{users:e})).data}catch(t){throw t.response?.data||t.message}},getRoles:async()=>{try{const t=(await Ie.get("/roles")).data;return t&&t.data&&typeof t.data=="object"?t.data:t}catch(e){throw e.response?.data||e.message}},enableUser:async e=>{try{return(await Ie.patch(`/users/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}},disableUser:async e=>{try{return(await Ie.delete(`/users/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleUserStatus:async(e,t)=>{try{return(await Ie.patch(`/users/${e}`,{status:t})).data}catch(r){throw r.response?.data||r.message}},resetPassword:async e=>{try{return(await Ie.put("/profile/reset-password",{newPassword:e.newPassword,confirmNewPassword:e.confirmPassword})).data}catch(t){throw t.response?.data||t.message}},getTrainers:async(e={})=>{try{return(await Ie.get("/users",{params:{roleName:"TRAINER",...e}})).data}catch(t){throw t.response?.data||t.message}}},En=e=>e&&e.data&&typeof e.data=="object"?e.data:e,ys={getRoles:async(e={})=>{try{const t=await Ie.get("/roles",{params:e});return En(t.data)}catch(t){throw t.response?.data||t.message}},getRoleById:async e=>{try{const t=await Ie.get(`/roles/${e}`);return En(t.data)}catch(t){throw t.response?.data||t.message}},createRole:async e=>{try{const t=await Ie.post("/roles",e);return En(t.data)}catch(t){throw t.response?.data||t.message}},updateRole:async(e,t)=>{try{console.log(" API updateRole called with:",{id:e,roleData:t,url:`/roles/${e}`,method:"PUT"});const r=await Ie.put(`/roles/${e}`,t),s=En(r.data);return console.log(" API updateRole success:",s),s}catch(r){throw console.error(" API updateRole error:",{status:r.response?.status,statusText:r.response?.statusText,data:r.response?.data,message:r.message}),r.response?.data||r.message}},deleteRole:async e=>{try{const t=await Ie.delete(`/roles/${e}`);return En(t.data)}catch(t){throw t.response?.data||t.message}},toggleRoleStatus:async e=>{try{const t=await Ie.patch(`/roles/${e}/toggle-status`);return En(t.data)}catch(t){throw t.response?.data||t.message}},enableRole:async e=>{try{const t=await Ie.patch(`/roles/${e}/enable`);return En(t.data)}catch(t){throw t.response?.data||t.message}},disableRole:async e=>{try{const t=await Ie.delete(`/roles/${e}`);return En(t.data)}catch(t){throw t.response?.data||t.message}}},Ft={getDepartments:async(e={})=>{try{return(await Ie.get("/departments",{params:{includeDeleted:!0,...e}})).data}catch(t){throw console.error("Error fetching departments:",t),t}},getDepartmentById:async e=>{try{return(await Ie.get(`/departments/${e}`,{params:{includeDeleted:!0}})).data}catch(t){throw console.error("Error fetching department:",t),t}},createDepartment:async e=>{try{console.log(" API - Creating department with data:",e);const t=await Ie.post("/departments",e);return console.log(" API - Department created successfully:",t.data),t.data}catch(t){throw console.error(" API - Error creating department:",t),console.error(" API - Error response:",t.response?.data),console.error(" API - Error status:",t.response?.status),t}},updateDepartment:async(e,t)=>{try{console.log(" API - Updating department:",{id:e,departmentData:t});const r=await Ie.put(`/departments/${e}`,t);return console.log(" API - Department updated successfully:",r.data),r.data}catch(r){if(console.error(" API - Error updating department:",r),console.error(" API - Error response:",r.response?.data),console.error(" API - Error status:",r.response?.status),console.error(" API - Request config:",{url:r.config?.url,method:r.config?.method,data:r.config?.data}),r.code==="ERR_NETWORK"||r.message==="Network Error"){const s=new Error("Network error: Unable to connect to server. Please check your internet connection or contact support.");throw s.code="NETWORK_ERROR",s}else if(r.response?.status===502){const s=new Error("Server error (502): Bad Gateway. The server is temporarily unavailable. Please try again later.");throw s.code="BAD_GATEWAY",s}else if(r.response?.status===403){const s=new Error("Permission denied: You do not have permission to update this department.");throw s.code="PERMISSION_DENIED",s}throw r}},deleteDepartment:async e=>{try{return(await Ie.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error deleting department:",t),t}},disableDepartment:async e=>{try{return(await Ie.delete(`/departments/${e}`)).data}catch(t){throw console.error("Error disabling department:",t),t}},enableDepartment:async e=>{try{return(await Ie.patch(`/departments/${e}/enable`)).data}catch(t){throw console.error("Error enabling department:",t),t}},toggleDepartmentStatus:async e=>{try{return(await Ie.patch(`/departments/${e}/toggle-status`)).data}catch(t){throw console.error("Error toggling department status:",t),t}},bulkDeleteDepartments:async e=>{try{return(await Ie.delete("/departments/bulk",{data:{ids:e}})).data}catch(t){throw console.error("Error bulk deleting departments:",t),t}},bulkToggleStatus:async(e,t)=>{try{return(await Ie.patch("/departments/bulk/toggle-status",{ids:e,status:t})).data}catch(r){throw console.error("Error bulk toggling department status:",r),r}},getDepartmentHeads:async()=>{try{return(await Ie.get("/departments/helpers/department-heads")).data}catch(e){throw console.error("Error fetching department heads:",e),e}},assignTrainersToDepartment:async(e,t)=>{try{return(await Ie.patch(`/departments/${e}/add-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error assigning trainers to department:",r),r}},removeTrainersFromDepartment:async(e,t)=>{try{return(await Ie.patch(`/departments/${e}/remove-trainers`,{trainerEids:t})).data}catch(r){throw console.error("Error removing trainers from department:",r),r}}},Ds={getCourses:async(e={})=>{try{return(await Ie.get("/courses",{params:e})).data}catch(t){throw console.error("Error fetching courses:",t),t}},getCourseById:async e=>{try{return(await Ie.get(`/courses/${e}`)).data}catch(t){throw console.error("Error fetching course:",t),t}},createCourse:async e=>{try{return(await Ie.post("/courses",e)).data}catch(t){throw console.error("Error creating course:",t),t}},updateCourse:async(e,t)=>{try{return(await Ie.put(`/courses/${e}`,t)).data}catch(r){throw console.error("Error updating course:",r),r}},deleteCourse:async e=>{try{return(await Ie.delete(`/courses/${e}`)).data}catch(t){throw console.error("Error deleting course:",t),t}},archiveCourse:async e=>{try{return(await Ie.delete(`/courses/${e}`)).data}catch(t){throw console.error("Error deleting course:",t),t}},restoreCourse:async e=>{try{return(await Ie.post(`/courses/${e}/restore`)).data}catch(t){throw console.error("Error restoring course:",t),t}},getCoursesByDepartment:async(e,t={})=>{try{return(await Ie.get("/courses",{params:{departmentId:e,...t}})).data}catch(r){throw console.error("Error fetching courses by department:",r),r}},getDepartmentWithCourses:async e=>{try{return(await Ie.get(`/courses/department/${e}`)).data}catch(t){throw console.error("Error fetching department with courses:",t),t}},getDepartmentById:async e=>{try{return(await Ie.get(`/departments/${e}`)).data}catch(t){throw console.error("Error fetching department by ID:",t),t}},getTraineeEnrollments:async e=>(await Ie.get(`/courses/trainees/${e}/enrollments`)).data,getCourseTrainees:async e=>{try{return(await Ie.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching course trainees:",t),t}}},Al={getTrainees:async(e={})=>{try{return(await Ie.get("/trainees",{params:e})).data}catch(t){throw t.response?.data||t.message}},getTraineeById:async e=>{try{return(await Ie.get(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},createTrainee:async e=>{try{return(await Ie.post("/trainees",e)).data}catch(t){throw t.response?.data||t.message}},updateTrainee:async(e,t)=>{try{return(await Ie.put(`/trainees/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deleteTrainee:async e=>{try{return(await Ie.delete(`/trainees/${e}`)).data}catch(t){throw t.response?.data||t.message}},toggleTraineeStatus:async e=>{try{return(await Ie.patch(`/trainees/${e}/toggle-status`)).data}catch(t){throw t.response?.data||t.message}},getTraineeCourses:async e=>{try{return(await Ie.get(`/trainees/${e}/courses`)).data}catch(t){throw t.response?.data||t.message}},getTraineeSubjects:async(e,t=null)=>{try{const r=t?`/trainees/${e}/subjects?courseId=${t}`:`/trainees/${e}/subjects`;return(await Ie.get(r)).data}catch(r){throw r.response?.data||r.message}},getTraineeAssessments:async e=>{try{return(await Ie.get(`/trainees/${e}/assessments`)).data}catch(t){throw t.response?.data||t.message}},enrollTrainee:async(e,t)=>{try{return(await Ie.post(`/trainees/${e}/enroll`,{courseId:t})).data}catch(r){throw r.response?.data||r.message}},unenrollTrainee:async(e,t)=>{try{return(await Ie.delete(`/trainees/${e}/enroll/${t}`)).data}catch(r){throw r.response?.data||r.message}},bulkImportTrainees:async e=>{try{return(await Ie.post("/trainees/bulk-import",e)).data}catch(t){throw t.response?.data||t.message}},getTraineesForEnrollment:async(e={})=>{try{return(await Ie.get("/users",{params:{roleName:"TRAINEE",...e}})).data}catch(t){throw t.response?.data||t.message}},lookupTrainees:async e=>{try{console.log("API call - lookupTrainees with:",e);const t={traineesList:e};console.log("Sending request with format:",t);const r=await Ie.post("/subjects/trainees/lookup",t);return console.log("API response:",r.data),r.data}catch(t){throw console.error("Lookup failed:",t.response?.data),t.response?.data||t.message}},getTraineesByCourseId:async e=>{try{return(await Ie.get(`/courses/${e}/trainees`)).data}catch(t){throw console.error("Error fetching trainees by course ID:",t),t}}},cs={getSubjects:async(e={})=>{try{return(await Ie.get("/subjects",{params:e})).data}catch(t){throw t}},getSubjectsByCourse:async(e,t={})=>{const r=`/subjects/course/${e}`;try{return(await Ie.get(r,{params:t})).data}catch(s){throw s}},getSubjectById:async e=>{try{const t=await Ie.get(`/subjects/${e}`,{data:void 0,transformRequest:[(r,s)=>{delete s["Content-Type"]}]});return t.data&&t.data.data?t.data.data:t.data}catch(t){throw t}},createSubject:async e=>{try{return(await Ie.post("/subjects",e)).data}catch(t){throw t}},updateSubject:async(e,t)=>{try{return(await Ie.put(`/subjects/${e}`,t)).data}catch(r){throw r}},deleteSubject:async e=>{try{return(await Ie.delete(`/subjects/${e}`)).data}catch(t){throw t}},archiveSubject:async e=>{try{return(await Ie.delete(`/subjects/${e}/archive`)).data}catch(t){throw t}},bulkImportSubjects:async e=>{try{const r={courseId:e[0]?.courseId,subjects:e.map(n=>{const{courseId:i,...o}=n;return o})},s=await Ie.post("/subjects/bulk",r);return s.status===304?{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"}:s.data}catch(t){if(t.response?.status===304)return{summary:{created:0,failed:0,skipped:e.length,total:e.length},message:"All subjects already exist"};throw t}},assignTrainees:async(e,t)=>{try{const r={batchCode:t.batchCode||t.batch_code||"",traineeUserIds:t.traineeUserIds||t.trainee_user_ids||[]};if(!r.batchCode||typeof r.batchCode!="string")throw new Error("batchCode must be a non-empty string");if(!Array.isArray(r.traineeUserIds)||r.traineeUserIds.length===0)throw new Error("traineeUserIds must be a non-empty array");const s={batchCode:String(r.batchCode).trim(),traineeUserIds:Array.isArray(r.traineeUserIds)?[...r.traineeUserIds]:[]};return(await Ie.post(`/subjects/${e}/assign-trainees`,s)).data}catch(r){throw r}},removeTraineeFromSubject:async(e,t,r)=>{try{const s={batchCode:r};return(await Ie.delete(`/subjects/${e}/trainees/${t}`,{data:s})).data}catch(s){throw s}},addTrainerToSubject:async(e,t)=>{try{if(!t||typeof t!="object")throw new Error("Trainer data is required and must be an object");if(!t.trainer_user_id)throw new Error("trainer_user_id is required");if(!t.role_in_subject)throw new Error("role_in_subject is required");const r=["EXAMINER","ASSESSMENT_REVIEWER"];if(!r.includes(t.role_in_subject))throw new Error(`Invalid role_in_subject: ${t.role_in_subject}. Must be one of: ${r.join(", ")}`);const s=String(t.trainer_user_id).trim(),n=String(t.role_in_subject).trim();if(!s||s==="")throw new Error("trainerUserId cannot be empty");if(!n||n==="")throw new Error("roleInSubject cannot be empty");const i={trainerUserId:s,roleInSubject:n};let o;try{o=await Ie.post(`/subjects/${e}/instructors`,i,{headers:{"Content-Type":"application/json"}})}catch(l){if(l.response?.status===404||l.response?.status===422)console.warn(" /instructors endpoint failed, trying /trainers..."),o=await Ie.post(`/subjects/${e}/trainers`,i,{headers:{"Content-Type":"application/json"}});else throw l}return o.data}catch(r){throw r.response?.data?r.response.data:new Error(r.message||"Failed to add trainer to subject")}},getSubjectTrainers:async e=>{try{return(await Ie.get(`/subjects/${e}/trainers`)).data}catch(t){throw t.response?.data||t.message}},updateTrainerRole:async(e,t,r)=>{try{const s={roleInSubject:r.roleInSubject};return(await Ie.put(`/subjects/${e}/trainers/${t}`,s)).data}catch(s){throw s.response?.data||s.message}},removeTrainerFromSubject:async(e,t)=>{try{return(await Ie.delete(`/subjects/${e}/trainers/${t}`)).data}catch(r){throw r.response?.data||r.message}}},jD={getTemplates:async(e={})=>{try{return(await Ie.get("/templates",{params:e})).data}catch(t){throw t}},getTemplateById:async e=>{try{return(await Ie.get(`/templates/${e}`)).data}catch(t){throw t}},createTemplate:async e=>{try{return(await Ie.post("/templates",e)).data}catch(t){throw t}},updateTemplate:async(e,t)=>{try{return(await Ie.put(`/templates/${e}`,t)).data}catch(r){throw r}},deleteTemplate:async e=>{try{return(await Ie.delete(`/templates/${e}`)).data}catch(t){throw t}}},Ed={uploadDocument:async(e,t)=>{console.log(" uploadDocument called - FRESH VERSION 2025-01-17");const r=["files"];for(const s of r)try{const n=new FormData;n.append(s,e),console.log(` Testing field name: "${s}"`);const i=await Ie.post(`/media/docs/upload/${t}`,n,{headers:{"Content-Type":void 0}});return console.log(` Success with field name: "${s}"`,i.data),i.data&&i.data.data&&i.data.data.length>0&&i.data.data[0].url?console.log(` File uploaded successfully! URL: ${i.data.data[0].url}`):i.data&&i.data.url?console.log(` File uploaded successfully! URL: ${i.data.url}`):i.data&&i.data.fileUrl?console.log(` File uploaded successfully! URL: ${i.data.fileUrl}`):i.data&&i.data.path?console.log(` File uploaded successfully! Path: ${i.data.path}`):console.log(" File uploaded successfully! Response:",i.data),i.data}catch(n){console.log(` Failed with field name: "${s}"`,n.response?.data?.message)}throw new Error('Upload failed with field name "files". Please check backend logs.')},getDocsType:e=>e.substring(0,3).toLowerCase(),buildUploadUrl:e=>`https://dsfms.id.vn/media/docs/upload/${e}`},Xo={"Validation failed":{default:"Invalid data. Please check your information and try again.",fields:{firstName:"First name is required",lastName:"Last name is required",email:"Email is invalid or already exists",phoneNumber:"Phone number is invalid",password:"Password must be at least 8 characters",role:"Role is invalid",department:"Department is invalid",address:"Address is required",gender:"Gender is invalid",dob:"Date of birth is invalid",trainingBatch:"Training batch is required",passportNo:"Passport number is invalid",nation:"Nationality is required",certificationNumber:"Certification number is invalid",specialization:"Specialization is required",yearsOfExp:"Years of experience must be a positive number"}},Unauthorized:"You do not have permission to access. Please login again.","Unauthorized access":"Wrong username or password. Please check your credentials and try again.","Access token is missing":"Your session has expired. Please login again.","Invalid refresh token":"Your session is invalid. Please login again.","User not found or inactive":"Account does not exist or has been deactivated.","Email or password is incorrect":"Email or password is incorrect.","Wrong password or username":"Wrong password or username. Please check your credentials and try again.",Forbidden:"You do not have permission to perform this action. Please contact your administrator.","Insufficient permissions":"You do not have sufficient permissions to perform this action.","Access denied":"Access denied. You do not have permission to access this resource.","User not found":"User not found.","User already exists":"User already exists.","Cannot delete user":"Cannot delete this user.","Cannot update user":"Cannot update user information.","Role not found":"Role not found.","Role already exists":"Role already exists.","Cannot delete role":"Cannot delete this role.","Prohibited action on base role":"Cannot modify base roles. Base roles are system-defined and cannot be edited.","Department not found":"Department not found.","Department already exists":"Department already exists.","Cannot delete department":"Cannot delete this department.","Internal server error":"System error. Please try again later.","Network error":"Connection error. Please check your network and try again.","Request timeout":"Request timeout. Please try again.","Not found":"Data not found.",Conflict:"Data already exists or conflicts.","Too many requests":"Too many requests. Please try again later."},Ea=(e,t={})=>{if(e?.response?.status===403)return"You do not have permission to perform this action. Please contact your administrator.";if(e?.response?.status===401)return"Your session has expired. Please login again.";if(typeof e=="string")return Xo[e]||e;if(e&&typeof e=="object"){const{message:r,errors:s}=e;let n=r;if(Array.isArray(r))if(r.length>0){const o=r[0];typeof o=="object"&&o!==null?n=o.message||o.field||"Validation failed":n=o}else n="Validation failed";const i=Xo[n]||n;if(s&&Array.isArray(s)&&s.length>0){const o=s.map(l=>{if(typeof l=="string"){const c=l.match(/(\w+)\s+(.+)/);if(c){const[,d,u]=c;return Xo[n]?.fields?.[d]||u}return l}else if(typeof l=="object"&&l!==null)return l.field&&l.message?Xo[n]?.fields?.[l.field]||l.message:l.property&&l.constraints?Xo[n]?.fields?.[l.property]||Object.values(l.constraints)[0]||l.property:JSON.stringify(l);return String(l)});return`${i}

Details:
${o.join(`
`)}`}return i}return e?.response?.data?Ea(e.response.data,t):e?.message||"An unknown error occurred. Please try again."},FN=b.createContext({user:null,setUser:()=>{},userRole:null,userPermissions:[],isAuthenticated:!1,setIsAuthenticated:()=>{},isLoading:!0,login:async()=>({success:!1}),logout:()=>{},refreshToken:async()=>({success:!1}),fetchUserRoleAndPermissions:async()=>({role:null,permissions:[]})}),ND=({children:e})=>{const[t,r]=b.useState(null),[s,n]=b.useState(null),[i,o]=b.useState([]),[l,c]=b.useState(!1),[d,u]=b.useState(!0);b.useEffect(()=>{(async()=>{try{const v=localStorage.getItem("authToken"),w=localStorage.getItem("user"),y=localStorage.getItem("refreshToken");if(v&&w&&y)try{const S=JSON.parse(atob(v.split(".")[1])),E=Date.now()/1e3;if(S.exp<E)try{const N=await Sn.refreshToken(y);localStorage.setItem("authToken",N.access_token),localStorage.setItem("refreshToken",N.refresh_token);const j=JSON.parse(w);r(j),c(!0);try{const{role:T,permissions:C}=await m(j.role,j.roleId);if(T&&C)n(T),o(C);else throw new Error("Failed to fetch role and permissions")}catch(T){console.error("Failed to fetch role and permissions on initialization:",T),Sn.logout(),r(null),n(null),o([]),c(!1)}}catch{Sn.logout(),r(null),n(null),o([]),c(!1)}else{const N=JSON.parse(w);r(N),c(!0);try{const{role:j,permissions:T}=await m(N.role,N.roleId);if(j&&T)n(j),o(T);else throw new Error("Failed to fetch role and permissions")}catch(j){console.error("Failed to fetch role and permissions on initialization:",j),Sn.logout(),r(null),n(null),o([]),c(!1)}}}catch(S){console.error(" Error parsing token or user data:",S),Sn.logout(),r(null),n(null),o([]),c(!1)}else r(null),n(null),o([]),c(!1)}catch(v){console.error("Error accessing localStorage:",v),r(null),n(null),o([]),c(!1)}finally{u(!1)}})()},[]),b.useEffect(()=>{if(!l||d)return;const g=async()=>{const w=localStorage.getItem("authToken"),y=localStorage.getItem("refreshToken");if(!w||!y){p();return}try{const S=JSON.parse(atob(w.split(".")[1])),E=Date.now()/1e3;S.exp-E<300&&((await h()).success||(console.error(" Token refresh failed in validation"),p()))}catch(S){console.error(" Token validation failed:",S);try{(await h()).success||(console.error(" Token refresh failed after validation error"),p())}catch(E){console.error(" Token refresh failed:",E),p()}}},v=setTimeout(()=>{g();const w=setInterval(g,120*1e3);return()=>clearInterval(w)},500);return()=>clearTimeout(v)},[l,d]);const m=async(g,v)=>{try{if(v)try{const w=await ys.getRoleById(v);console.log(" Role data fetched:",{hasId:!!w?.id,hasName:!!w?.name,hasPermissions:!!w?.permissions,permissionsCount:w?.permissions?.length||0});const y=Array.isArray(w?.permissions)?w.permissions:[];return n(w),o(y),{role:w,permissions:y}}catch(w){if(console.error("Error fetching role by ID:",w),w.response?.status===403){console.warn("User does not have permission to view role details, trying alternative approach");try{const S=await Ie.get("/users/me");if(S.data&&S.data.role&&S.data.role.permissions){const E={id:v,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:S.data.role.permissions};return n(E),o(E.permissions),{role:E,permissions:E.permissions}}}catch(S){console.error("Failed to get user profile:",S)}console.warn("Cannot fetch permissions, creating minimal role");const y={id:v,name:g,description:`${g} role`,isActive:"ACTIVE",permissions:[]};return n(y),o([]),{role:y,permissions:[]}}throw new Error("Failed to fetch role details. Please contact administrator.")}try{const w=await ys.getRoles(),y=w.data||w;let S;if(y&&y.roles&&Array.isArray(y.roles))S=y.roles;else if(Array.isArray(y))S=y;else throw new Error("Invalid roles data structure");const E=S.find(N=>N.name===g);if(E){const N=await ys.getRoleById(E.id);return n(N),o(N.permissions||[]),{role:N,permissions:N.permissions||[]}}throw new Error(`Role '${g}' not found`)}catch(w){throw console.error("Fallback method failed:",w),new Error(`Role '${g}' not found. Please contact administrator.`)}}catch(w){return console.error("Error fetching user role and permissions:",w),{role:null,permissions:[]}}},f=async g=>{try{u(!0);const v=await Sn.login(g);localStorage.setItem("authToken",v.access_token),localStorage.setItem("refreshToken",v.refresh_token);let w;try{const E=JSON.parse(atob(v.access_token.split(".")[1]));if(!E.userId||!E.roleName)throw new Error("Invalid token: missing required fields (userId, roleName)");w={id:E.userId,email:g.email,fullName:E.fullName||E.name||"User",role:E.roleName,roleId:E.roleId,department:E.department||"IT",lastLogin:new Date().toISOString()},g.email==="depthead@test.com"&&(w.role="DEPARTMENT_HEAD",w.roleId="dept-head-001")}catch(E){throw console.error("Error decoding token:",E),new Error("Invalid token format or missing required fields")}localStorage.setItem("user",JSON.stringify(w));const{role:y,permissions:S}=await m(w.role,w.roleId);if(!y||!S)throw new Error("Failed to fetch user role and permissions");return r(w),n(y),o(S),c(!0),{success:!0,user:w,role:y,permissions:S}}catch(v){return{success:!1,error:Ea(v)||"Login failed"}}finally{u(!1)}},h=async()=>{try{const g=localStorage.getItem("refreshToken");if(!g)throw new Error("No refresh token available");const v=await Sn.refreshToken(g);return localStorage.setItem("authToken",v.access_token),localStorage.setItem("refreshToken",v.refresh_token),{success:!0,tokens:v}}catch(g){return console.error("Manual token refresh failed:",g),p(),{success:!1,error:g.message}}},p=()=>{Sn.logout(),r(null),n(null),o([]),c(!1)},x={user:t,setUser:r,userRole:s,userPermissions:i,isAuthenticated:l,setIsAuthenticated:c,isLoading:d,login:f,logout:p,refreshToken:h,fetchUserRoleAndPermissions:m};try{return a.jsx(FN.Provider,{value:x,children:e})}catch(g){return console.error(" AuthProvider error:",g),a.jsxs("div",{style:{padding:"20px",color:"red"},children:[a.jsx("h3",{children:"Authentication Error"}),a.jsx("p",{children:"There was an error initializing the authentication system."}),a.jsxs("details",{children:[a.jsx("summary",{children:"Error Details"}),a.jsx("pre",{children:g.message})]})]})}},_s=()=>{const e=b.useContext(FN);if(!e)throw console.error("AuthContext is null or undefined. Make sure AuthProvider is properly wrapping the component tree."),new Error("useAuth must be used within an AuthProvider");return e},SD={getPermissions:async(e={})=>{try{return(await Ie.get("/permissions",{params:e})).data}catch(t){throw t.response?.data||t.message}},getPermissionById:async e=>{try{return(await Ie.get(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},createPermission:async e=>{try{return(await Ie.post("/permissions",e)).data}catch(t){throw t.response?.data||t.message}},updatePermission:async(e,t)=>{try{return(await Ie.put(`/permissions/${e}`,t)).data}catch(r){throw r.response?.data||r.message}},deletePermission:async e=>{try{return(await Ie.delete(`/permissions/${e}`)).data}catch(t){throw t.response?.data||t.message}},enablePermission:async e=>{try{return(await Ie.patch(`/permissions/${e}/enable`)).data}catch(t){throw t.response?.data||t.message}}},S1=e=>{if(!e)return"";const t=e.split(" ");if(t.length>=2){const r=t[0],s=t[1],i=s.split("/").filter(c=>c&&!c.startsWith(":"))[0]||"Resource",l={GET:"View",POST:"Create",PUT:"Update",PATCH:"Update",DELETE:"Delete"}[r]||r;return s.includes("forgot-password")?"Forgot Password":s.includes("reset-password")?"Reset Password":s.includes("enable")?`Enable ${i.charAt(0).toUpperCase()+i.slice(1)}`:s.includes("archive")?`Archive ${i.charAt(0).toUpperCase()+i.slice(1)}`:s.includes("restore")?`Restore ${i.charAt(0).toUpperCase()+i.slice(1)}`:s.includes("add-trainers")?"Add Trainers to Department":s.includes("remove-trainers")?"Remove Trainers from Department":s.includes("new-feature")?"Create New Feature":s.includes("bulk-import")?"Bulk Import Data":s.includes("export-report")?"Export Report":ED(l,i,s)}return e},ED=(e,t,r)=>{if(r.includes("-")){const s=r.split("/").filter(o=>o&&!o.startsWith(":")),i=s[s.length-1].split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");return`${e} ${i}`}return`${e} ${t.charAt(0).toUpperCase()+t.slice(1)}`},ku=()=>{const[e,t]=b.useState([]),[r,s]=b.useState(!1),[n,i]=b.useState(null),{userPermissions:o,userRole:l}=_s(),c=b.useCallback(async()=>{s(!0),i(null);try{o&&o.length>0?t(o):(t([]),console.log(" No userPermissions available"))}catch(N){console.error("Error setting permissions:",N),i(N),t([])}finally{s(!1)}},[o]),d=b.useCallback(()=>e.map(N=>({id:N.id,title:N.viewName||N.description||S1(N.name),description:N.description||"",module:N.module,method:N.method,path:N.path,isActive:N.isActive,viewName:N.viewName,viewModule:N.viewModule})),[e]),u=b.useCallback(()=>{const N=d(),j={};return N.forEach(T=>{const C=T.module,L=T.viewModule||`${T.module} Management`;j[C]||(j[C]={id:C,name:L,description:`Manage ${L.toLowerCase()} related permissions`,permissions:[]}),j[C].permissions.push({id:T.id,title:T.title,description:T.description,isActive:T.isActive,method:T.method,path:T.path})}),Object.values(j).sort((T,C)=>T.name.localeCompare(C.name))},[d]),m=b.useCallback(N=>{const j=e.find(T=>T.id===N);return j?j.isActive==="ACTIVE":!0},[e]),f=b.useCallback(N=>e.find(j=>j.id===N),[e]),h=b.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(N=>N.name)),[o]),p=b.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(N=>N.path)),[o]),x=b.useMemo(()=>!o||o.length===0?new Set:new Set(o.map(N=>N.id)),[o]),g=b.useCallback(N=>{if(!o||o.length===0)return!1;const T=(_=>{const D=_.trim().split(/\s+/);if(D.length>=2){const W=D[0],K=D.slice(1).join(" ");return{method:W,path:K}}return{method:null,path:_}})(N),C=h.has(N),L=p.has(N),A=x.has(N);if(C||L||A||T.method&&T.path&&o.some(D=>{const W=D.method&&D.method.toUpperCase()===T.method.toUpperCase();let K=!1;if(D.path)if(D.path===T.path)K=!0;else{const J=F=>F.replace(/:\w+/g,":param");(J(D.path)===J(T.path)||D.name&&D.name.includes(T.path.replace("/","")))&&(K=!0)}return W&&K}))return!0;const P=N.toLowerCase().replace(/\s+/g," ");return o.some(_=>{if(!_.name)return!1;const D=_.name.toLowerCase(),W=P.split(/[\s/:]+/).filter(K=>K.length>2&&!["get","post","put","patch","delete"].includes(K));return W.length>0?W.some(K=>D.includes(K)):!1})},[o,h,p,x]),v=b.useCallback(N=>!o||o.length===0?!1:N.some(j=>g(j)),[o,g]),w=b.useCallback(N=>!o||o.length===0?!1:N.every(j=>g(j)),[o,g]),y=b.useCallback(N=>!o||o.length===0?!1:o.some(j=>j.module===N),[o]),S=b.useCallback(()=>!o||o.length===0?[]:[...new Set(o.map(j=>j.module))],[o]),E=b.useCallback(()=>{if(!o||o.length===0)return[];const N=o.map(T=>({id:T.id,title:T.viewName||T.description||S1(T.name),description:T.description||"",module:T.module,method:T.method,path:T.path,isActive:T.isActive,viewName:T.viewName,viewModule:T.viewModule})),j={};return N.forEach(T=>{const C=T.module,L=T.viewModule||`${T.module} Management`;j[C]||(j[C]={id:C,name:L,description:`Manage ${L.toLowerCase()} related permissions`,permissions:[]}),j[C].permissions.push({id:T.id,title:T.title,description:T.description,isActive:T.isActive,method:T.method,path:T.path})}),Object.values(j).sort((T,C)=>T.name.localeCompare(C.name))},[o]);return b.useEffect(()=>{c()},[c]),{permissions:e,loading:r,error:n,fetchPermissions:c,getUIPermissions:d,getPermissionGroups:u,isPermissionActive:m,getApiPermission:f,hasPermission:g,hasAnyPermission:v,hasAllPermissions:w,hasModuleAccess:y,getAccessibleModules:S,getUserPermissionGroups:E,userPermissions:o,userRole:l}},TD=()=>{const[e,t]=b.useState([]),[r,s]=b.useState(!1),[n,i]=b.useState(null),o=b.useCallback(async()=>{s(!0),i(null);try{const l=await SD.getPermissions({includeDeleted:!0});let c=null;if(l&&l.data&&l.data.modules&&Array.isArray(l.data.modules))c=l.data.modules;else if(Array.isArray(l))c=l;else if(l&&l.data&&Array.isArray(l.data))c=l.data;else if(l&&typeof l=="object"){const u=Object.keys(l).find(m=>Array.isArray(l[m]));u&&(c=l[u])}if(c&&Array.isArray(c)){const d=[];c.forEach(u=>{u.module&&u.module.listPermissions&&u.module.listPermissions.forEach(m=>{const f=m.id||m.permissionId;d.push({id:f,name:m.name,module:u.module.name,viewName:m.name,viewModule:u.module.name,isActive:!0})})}),t(d)}else t([])}catch(l){console.error("Error fetching all permissions from API:",l),i(l),t([])}finally{s(!1)}},[]);return{allPermissions:e,loading:r,error:n,fetchAllPermissions:o}},Ne={USERS:{CREATE:"POST /users",VIEW_ALL:"GET /users",VIEW_DETAIL:"GET /users/:userId",UPDATE:"PUT /users/:userId",BULK_CREATE:"POST /users/bulk"},ROLES:{CREATE:"POST /roles",VIEW_ALL:"GET /roles"},DEPARTMENTS:{CREATE:"POST /departments",VIEW_ALL:"GET /departments",VIEW_DETAIL:"GET /departments/:departmentId",UPDATE:"PUT /departments/:departmentId"},COURSES:{CREATE:"POST /courses",VIEW_ALL:"GET /courses",VIEW_DETAIL:"GET /courses/:id",UPDATE:"PUT /courses/:id",RESTORE:"POST /courses/:id/restore",ARCHIVE:"PATCH /courses/:courseId/archive"},SUBJECTS:{VIEW_DETAIL:"GET /subjects/:id",UPDATE:"PUT /subjects/:id",DELETE:"DELETE /subjects/:id",ARCHIVE:"PATCH /subjects/:subjectId/archive",REMOVE_INSTRUCTOR:"DELETE /subjects/:id/instructors"},ASSESSMENTS:{VIEW_ALL:"GET /assessments",VIEW_RESULTS:"GET /assessments/results",APPROVE:"POST /assessments/:assessmentId/approve"},TEMPLATES:{CREATE:"POST /templates",VIEW_ALL:"GET /templates"},PROFILES:{VIEW:"GET /profile"},GLOBAL_FIELDS:{VIEW_ALL:"GET /global-fields"},DASHBOARD:{VIEW:"GET /dashboard"},TRAINEES:{VIEW_ALL:"GET /trainees",VIEW_DETAIL:"GET /trainees/:id",UPDATE:"PUT /trainees/:id",VIEW_COURSES:"GET /trainees/:id/courses",VIEW_SUBJECTS:"GET /trainees/:id/subjects",VIEW_ASSESSMENTS:"GET /trainees/:id/assessments"},SQA:{VIEW_TEMPLATES:"GET /templates",VIEW_TEMPLATE_DETAIL:"GET /templates/:id"}};function LN(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=LN(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function Et(){for(var e,t,r=0,s="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=LN(e))&&(s&&(s+=" "),s+=t);return s}function AD(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}AD(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var oc=e=>typeof e=="number"&&!isNaN(e),Ni=e=>typeof e=="string",cn=e=>typeof e=="function",CD=e=>Ni(e)||oc(e),Kh=e=>Ni(e)||cn(e)?e:null,_D=(e,t)=>e===!1||oc(e)&&e>0?e:t,Yh=e=>b.isValidElement(e)||Ni(e)||cn(e)||oc(e);function kD(e,t,r=300){let{scrollHeight:s,style:n}=e;requestAnimationFrame(()=>{n.minHeight="initial",n.height=s+"px",n.transition=`all ${r}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(t,r)})})}function PD({enter:e,exit:t,appendPosition:r=!1,collapse:s=!0,collapseDuration:n=300}){return function({children:i,position:o,preventExitTransition:l,done:c,nodeRef:d,isIn:u,playToast:m}){let f=r?`${e}--${o}`:e,h=r?`${t}--${o}`:t,p=b.useRef(0);return b.useLayoutEffect(()=>{let x=d.current,g=f.split(" "),v=w=>{w.target===d.current&&(m(),x.removeEventListener("animationend",v),x.removeEventListener("animationcancel",v),p.current===0&&w.type!=="animationcancel"&&x.classList.remove(...g))};x.classList.add(...g),x.addEventListener("animationend",v),x.addEventListener("animationcancel",v)},[]),b.useEffect(()=>{let x=d.current,g=()=>{x.removeEventListener("animationend",g),s?kD(x,c,n):c()};u||(l?g():(p.current=1,x.className+=` ${h}`,x.addEventListener("animationend",g)))},[u]),Z.createElement(Z.Fragment,null,i)}}function E1(e,t){return{content:MN(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function MN(e,t,r=!1){return b.isValidElement(e)&&!Ni(e.type)?b.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):cn(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function OD({closeToast:e,theme:t,ariaLabel:r="close"}){return Z.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:s=>{s.stopPropagation(),e(!0)},"aria-label":r},Z.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Z.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function DD({delay:e,isRunning:t,closeToast:r,type:s="default",hide:n,className:i,controlledProgress:o,progress:l,rtl:c,isIn:d,theme:u}){let m=n||o&&l===0,f={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};o&&(f.transform=`scaleX(${l})`);let h=Et("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${u}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":c}),p=cn(i)?i({rtl:c,type:s,defaultClassName:h}):Et(h,i),x={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{d&&r()}};return Z.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":m},Z.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${u} Toastify__progress-bar--${s}`}),Z.createElement("div",{role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:p,style:f,...x}))}var ID=1,BN=()=>`${ID++}`;function RD(e,t,r){let s=1,n=0,i=[],o=[],l=t,c=new Map,d=new Set,u=w=>(d.add(w),()=>d.delete(w)),m=()=>{o=Array.from(c.values()),d.forEach(w=>w())},f=({containerId:w,toastId:y,updateId:S})=>{let E=w?w!==e:e!==1,N=c.has(y)&&S==null;return E||N},h=(w,y)=>{c.forEach(S=>{var E;(y==null||y===S.props.toastId)&&((E=S.toggle)==null||E.call(S,w))})},p=w=>{var y,S;(S=(y=w.props)==null?void 0:y.onClose)==null||S.call(y,w.removalReason),w.isActive=!1},x=w=>{if(w==null)c.forEach(p);else{let y=c.get(w);y&&p(y)}m()},g=()=>{n-=i.length,i=[]},v=w=>{var y,S;let{toastId:E,updateId:N}=w.props,j=N==null;w.staleId&&c.delete(w.staleId),w.isActive=!0,c.set(E,w),m(),r(E1(w,j?"added":"updated")),j&&((S=(y=w.props).onOpen)==null||S.call(y))};return{id:e,props:l,observe:u,toggle:h,removeToast:x,toasts:c,clearQueue:g,buildToast:(w,y)=>{if(f(y))return;let{toastId:S,updateId:E,data:N,staleId:j,delay:T}=y,C=E==null;C&&n++;let L={...l,style:l.toastStyle,key:s++,...Object.fromEntries(Object.entries(y).filter(([P,I])=>I!=null)),toastId:S,updateId:E,data:N,isIn:!1,className:Kh(y.className||l.toastClassName),progressClassName:Kh(y.progressClassName||l.progressClassName),autoClose:y.isLoading?!1:_D(y.autoClose,l.autoClose),closeToast(P){c.get(S).removalReason=P,x(S)},deleteToast(){let P=c.get(S);if(P!=null){if(r(E1(P,"removed")),c.delete(S),n--,n<0&&(n=0),i.length>0){v(i.shift());return}m()}}};L.closeButton=l.closeButton,y.closeButton===!1||Yh(y.closeButton)?L.closeButton=y.closeButton:y.closeButton===!0&&(L.closeButton=Yh(l.closeButton)?l.closeButton:!0);let A={content:w,props:L,staleId:j};l.limit&&l.limit>0&&n>l.limit&&C?i.push(A):oc(T)?setTimeout(()=>{v(A)},T):v(A)},setProps(w){l=w},setToggle:(w,y)=>{let S=c.get(w);S&&(S.toggle=y)},isToastActive:w=>{var y;return(y=c.get(w))==null?void 0:y.isActive},getSnapshot:()=>o}}var Ss=new Map,Cl=[],Xh=new Set,FD=e=>Xh.forEach(t=>t(e)),$N=()=>Ss.size>0;function LD(){Cl.forEach(e=>UN(e.content,e.options)),Cl=[]}var MD=(e,{containerId:t})=>{var r;return(r=Ss.get(t||1))==null?void 0:r.toasts.get(e)};function zN(e,t){var r;if(t)return!!((r=Ss.get(t))!=null&&r.isToastActive(e));let s=!1;return Ss.forEach(n=>{n.isToastActive(e)&&(s=!0)}),s}function BD(e){if(!$N()){Cl=Cl.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||CD(e))Ss.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Ss.get(e.containerId);t?t.removeToast(e.id):Ss.forEach(r=>{r.removeToast(e.id)})}}var $D=(e={})=>{Ss.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function UN(e,t){Yh(e)&&($N()||Cl.push({content:e,options:t}),Ss.forEach(r=>{r.buildToast(e,t)}))}function zD(e){var t;(t=Ss.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function WN(e,t){Ss.forEach(r=>{(t==null||!(t!=null&&t.containerId)||t?.containerId===r.id)&&r.toggle(e,t?.id)})}function UD(e){let t=e.containerId||1;return{subscribe(r){let s=RD(t,e,FD);Ss.set(t,s);let n=s.observe(r);return LD(),()=>{n(),Ss.delete(t)}},setProps(r){var s;(s=Ss.get(t))==null||s.setProps(r)},getSnapshot(){var r;return(r=Ss.get(t))==null?void 0:r.getSnapshot()}}}function WD(e){return Xh.add(e),()=>{Xh.delete(e)}}function HD(e){return e&&(Ni(e.toastId)||oc(e.toastId))?e.toastId:BN()}function lc(e,t){return UN(e,t),t.toastId}function Pu(e,t){return{...t,type:t&&t.type||e,toastId:HD(t)}}function Ou(e){return(t,r)=>lc(t,Pu(e,r))}function ce(e,t){return lc(e,Pu("default",t))}ce.loading=(e,t)=>lc(e,Pu("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function VD(e,{pending:t,error:r,success:s},n){let i;t&&(i=Ni(t)?ce.loading(t,n):ce.loading(t.render,{...n,...t}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(d,u,m)=>{if(u==null){ce.dismiss(i);return}let f={type:d,...o,...n,data:m},h=Ni(u)?{render:u}:u;return i?ce.update(i,{...f,...h}):ce(h.render,{...f,...h}),m},c=cn(e)?e():e;return c.then(d=>l("success",s,d)).catch(d=>l("error",r,d)),c}ce.promise=VD;ce.success=Ou("success");ce.info=Ou("info");ce.error=Ou("error");ce.warning=Ou("warning");ce.warn=ce.warning;ce.dark=(e,t)=>lc(e,Pu("default",{theme:"dark",...t}));function GD(e){BD(e)}ce.dismiss=GD;ce.clearWaitingQueue=$D;ce.isActive=zN;ce.update=(e,t={})=>{let r=MD(e,t);if(r){let{props:s,content:n}=r,i={delay:100,...s,...t,toastId:t.toastId||e,updateId:BN()};i.toastId!==e&&(i.staleId=e);let o=i.render||n;delete i.render,lc(o,i)}};ce.done=e=>{ce.update(e,{progress:1})};ce.onChange=WD;ce.play=e=>WN(!0,e);ce.pause=e=>WN(!1,e);function qD(e){var t;let{subscribe:r,getSnapshot:s,setProps:n}=b.useRef(UD(e)).current;n(e);let i=(t=b.useSyncExternalStore(r,s,s))==null?void 0:t.slice();function o(l){if(!i)return[];let c=new Map;return e.newestOnTop&&i.reverse(),i.forEach(d=>{let{position:u}=d.props;c.has(u)||c.set(u,[]),c.get(u).push(d)}),Array.from(c,d=>l(d[0],d[1]))}return{getToastToRender:o,isToastActive:zN,count:i?.length}}function KD(e){let[t,r]=b.useState(!1),[s,n]=b.useState(!1),i=b.useRef(null),o=b.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:d,onClick:u,closeOnClick:m}=e;zD({id:e.toastId,containerId:e.containerId,fn:r}),b.useEffect(()=>{if(e.pauseOnFocusLoss)return f(),()=>{h()}},[e.pauseOnFocusLoss]);function f(){document.hasFocus()||v(),window.addEventListener("focus",g),window.addEventListener("blur",v)}function h(){window.removeEventListener("focus",g),window.removeEventListener("blur",v)}function p(j){if(e.draggable===!0||e.draggable===j.pointerType){w();let T=i.current;o.canCloseOnClick=!0,o.canDrag=!0,T.style.transition="none",e.draggableDirection==="x"?(o.start=j.clientX,o.removalDistance=T.offsetWidth*(e.draggablePercent/100)):(o.start=j.clientY,o.removalDistance=T.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function x(j){let{top:T,bottom:C,left:L,right:A}=i.current.getBoundingClientRect();j.nativeEvent.type!=="touchend"&&e.pauseOnHover&&j.clientX>=L&&j.clientX<=A&&j.clientY>=T&&j.clientY<=C?v():g()}function g(){r(!0)}function v(){r(!1)}function w(){o.didMove=!1,document.addEventListener("pointermove",S),document.addEventListener("pointerup",E)}function y(){document.removeEventListener("pointermove",S),document.removeEventListener("pointerup",E)}function S(j){let T=i.current;if(o.canDrag&&T){o.didMove=!0,t&&v(),e.draggableDirection==="x"?o.delta=j.clientX-o.start:o.delta=j.clientY-o.start,o.start!==j.clientX&&(o.canCloseOnClick=!1);let C=e.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;T.style.transform=`translate3d(${C},0)`,T.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function E(){y();let j=i.current;if(o.canDrag&&o.didMove&&j){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){n(!0),e.closeToast(!0),e.collapseAll();return}j.style.transition="transform 0.2s, opacity 0.2s",j.style.removeProperty("transform"),j.style.removeProperty("opacity")}}let N={onPointerDown:p,onPointerUp:x};return l&&c&&(N.onMouseEnter=v,e.stacked||(N.onMouseLeave=g)),m&&(N.onClick=j=>{u&&u(j),o.canCloseOnClick&&d(!0)}),{playToast:g,pauseToast:v,isRunning:t,preventExitTransition:s,toastRef:i,eventHandlers:N}}var YD=typeof window<"u"?b.useLayoutEffect:b.useEffect,Du=({theme:e,type:t,isLoading:r,...s})=>Z.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...s});function XD(e){return Z.createElement(Du,{...e},Z.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function JD(e){return Z.createElement(Du,{...e},Z.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function ZD(e){return Z.createElement(Du,{...e},Z.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function QD(e){return Z.createElement(Du,{...e},Z.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function eI(){return Z.createElement("div",{className:"Toastify__spinner"})}var Jh={info:JD,warning:XD,success:ZD,error:QD,spinner:eI},tI=e=>e in Jh;function rI({theme:e,type:t,isLoading:r,icon:s}){let n=null,i={theme:e,type:t};return s===!1||(cn(s)?n=s({...i,isLoading:r}):b.isValidElement(s)?n=b.cloneElement(s,i):r?n=Jh.spinner():tI(t)&&(n=Jh[t](i))),n}var sI=e=>{let{isRunning:t,preventExitTransition:r,toastRef:s,eventHandlers:n,playToast:i}=KD(e),{closeButton:o,children:l,autoClose:c,onClick:d,type:u,hideProgressBar:m,closeToast:f,transition:h,position:p,className:x,style:g,progressClassName:v,updateId:w,role:y,progress:S,rtl:E,toastId:N,deleteToast:j,isIn:T,isLoading:C,closeOnClick:L,theme:A,ariaLabel:P}=e,I=Et("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":L}),_=cn(x)?x({rtl:E,position:p,type:u,defaultClassName:I}):Et(I,x),D=rI(e),W=!!S||!c,K={closeToast:f,type:u,theme:A},J=null;return o===!1||(cn(o)?J=o(K):b.isValidElement(o)?J=b.cloneElement(o,K):J=OD(K)),Z.createElement(h,{isIn:T,done:j,position:p,preventExitTransition:r,nodeRef:s,playToast:i},Z.createElement("div",{id:N,tabIndex:0,onClick:d,"data-in":T,className:_,...n,style:g,ref:s,...T&&{role:y,"aria-label":P}},D!=null&&Z.createElement("div",{className:Et("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!C})},D),MN(l,e,!t),J,!e.customProgressBar&&Z.createElement(DD,{...w&&!W?{key:`p-${w}`}:{},rtl:E,theme:A,delay:c,isRunning:t,isIn:T,closeToast:f,hide:m,type:u,className:v,controlledProgress:W,progress:S||0})))},aI=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),nI=PD(aI("bounce",!0)),iI={position:"top-right",transition:nI,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function oI(e){let t={...iI,...e},r=e.stacked,[s,n]=b.useState(!0),i=b.useRef(null),{getToastToRender:o,isToastActive:l,count:c}=qD(t),{className:d,style:u,rtl:m,containerId:f,hotKeys:h}=t;function p(g){let v=Et("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":m});return cn(d)?d({position:g,rtl:m,defaultClassName:v}):Et(v,Kh(d))}function x(){r&&(n(!0),ce.play())}return YD(()=>{var g;if(r){let v=i.current.querySelectorAll('[data-in="true"]'),w=12,y=(g=t.position)==null?void 0:g.includes("top"),S=0,E=0;Array.from(v).reverse().forEach((N,j)=>{let T=N;T.classList.add("Toastify__toast--stacked"),j>0&&(T.dataset.collapsed=`${s}`),T.dataset.pos||(T.dataset.pos=y?"top":"bot");let C=S*(s?.2:1)+(s?0:w*j);T.style.setProperty("--y",`${y?C:C*-1}px`),T.style.setProperty("--g",`${w}`),T.style.setProperty("--s",`${1-(s?E:0)}`),S+=T.offsetHeight,E+=.025})}},[s,c,r]),b.useEffect(()=>{function g(v){var w;let y=i.current;h(v)&&((w=y.querySelector('[tabIndex="0"]'))==null||w.focus(),n(!1),ce.pause()),v.key==="Escape"&&(document.activeElement===y||y!=null&&y.contains(document.activeElement))&&(n(!0),ce.play())}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[h]),Z.createElement("section",{ref:i,className:"Toastify",id:f,onMouseEnter:()=>{r&&(n(!1),ce.pause())},onMouseLeave:x,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},o((g,v)=>{let w=v.length?{...u}:{...u,pointerEvents:"none"};return Z.createElement("div",{tabIndex:-1,className:p(g),"data-stacked":r,style:w,key:`c-${g}`},v.map(({content:y,props:S})=>Z.createElement(sI,{...S,stacked:r,collapseAll:x,isIn:l(S.toastId,S.containerId),key:`t-${S.key}`},y)))}))}const Fa=e=>e.map(t=>({id:t.id,name:t.name,code:t.code,type:t.code,description:t.description,departmentHeadId:t.headUserId,departmentHead:t.headUser?{id:t.headUser.id,name:t.headUser.name||t.headUser.email,email:t.headUser.email,role:t.headUser.role}:null,status:t.isActive===!0?"ACTIVE":"INACTIVE",coursesCount:t.courseCount||t.coursesCount||0,traineesCount:t.traineeCount||t.traineesCount||0,trainersCount:t.trainerCount||t.trainersCount||0,createdAt:t.createdAt,updatedAt:t.updatedAt,deletedAt:t.deletedAt})),px=(e=!0)=>{const[t,r]=b.useState([]),[s,n]=b.useState([]),[i,o]=b.useState(!1),[l,c]=b.useState(null),[d,u]=b.useState(""),[m,f]=b.useState({type:"",status:""}),[h,p]=b.useState({key:null,direction:"asc"}),[x,g]=b.useState([]);return b.useEffect(()=>{if(!e)return;(async()=>{o(!0),c(null);try{const J=(await Ft.getDepartments()).departments||[],F=Fa(J);r(F)}catch(K){console.error("Error loading departments:",K),c("Failed to load departments"),r([])}finally{o(!1)}})()},[e]),b.useEffect(()=>{let W=t;d&&(W=W.filter(K=>K.name.toLowerCase().includes(d.toLowerCase())||K.code.toLowerCase().includes(d.toLowerCase())||K.description.toLowerCase().includes(d.toLowerCase()))),m.type&&(W=W.filter(K=>K.type===m.type)),m.status&&(W=W.filter(K=>K.status===m.status)),n(W)},[t,d,m]),{departments:s,selectedDepartments:x,loading:i,error:l,searchTerm:d,setSearchTerm:u,filters:m,sortConfig:h,createDepartment:async W=>{o(!0),c(null);try{const K=await Ft.createDepartment(W),F=(await Ft.getDepartments()).departments||[],le=Fa(F);return r(le),K}catch(K){throw console.error("Error creating department:",K),c("Failed to create department"),K}finally{o(!1)}},updateDepartment:async(W,K)=>{o(!0),c(null);try{const J=await Ft.updateDepartment(W,K),le=(await Ft.getDepartments()).departments||[],Ae=Fa(le);return r(Ae),J}catch(J){throw console.error("Error updating department:",J),c("Failed to update department"),J}finally{o(!1)}},deleteDepartment:async W=>{o(!0),c(null);try{await Ft.deleteDepartment(W);const J=(await Ft.getDepartments()).departments||[],F=Fa(J);r(F)}catch(K){throw console.error("Error deleting department:",K),c("Failed to delete department"),K}finally{o(!1)}},toggleDepartmentStatus:async W=>{o(!0),c(null);try{await Ft.toggleDepartmentStatus(W);const J=(await Ft.getDepartments()).departments||[],F=Fa(J);r(F)}catch(K){throw console.error("Error toggling department status:",K),ce.error("Failed to toggle department status"),K}finally{o(!1)}},disableDepartment:async W=>{o(!0),c(null);try{await Ft.disableDepartment(W);const J=(await Ft.getDepartments()).departments||[],F=Fa(J);r(F)}catch(K){throw console.error("Error disabling department:",K),ce.error("Failed to disable department"),K}finally{o(!1)}},enableDepartment:async W=>{o(!0),c(null);try{await Ft.enableDepartment(W);const J=(await Ft.getDepartments()).departments||[],F=Fa(J);r(F)}catch(K){throw console.error("Error enabling department:",K),ce.error("Failed to enable department"),K}finally{o(!1)}},bulkDeleteDepartments:async W=>{o(!0),c(null);try{await Ft.bulkDeleteDepartments(W);const J=(await Ft.getDepartments()).departments||[],F=Fa(J);r(F),g([])}catch(K){throw console.error("Error bulk deleting departments:",K),ce.error("Failed to delete departments"),K}finally{o(!1)}},bulkToggleStatus:async(W,K)=>{o(!0),c(null);try{await Ft.bulkToggleStatus(W,K);const F=(await Ft.getDepartments()).departments||[],le=Fa(F);r(le),g([])}catch(J){throw console.error("Error bulk toggling department status:",J),ce.error("Failed to update department status"),J}finally{o(!1)}},sortDepartments:W=>{let K="asc";h.key===W&&h.direction==="asc"&&(K="desc"),p({key:W,direction:K});const J=[...s].sort((F,le)=>F[W]<le[W]?K==="asc"?-1:1:F[W]>le[W]?K==="asc"?1:-1:0);n(J)},handleSelectDepartment:W=>{g(K=>K.includes(W)?K.filter(J=>J!==W):[...K,W])},handleSelectAll:()=>{x.length===s.length?g([]):g(s.map(W=>W.id))},handleFilterChange:(W,K)=>{f(J=>({...J,[W]:K}))},clearFilters:()=>{f({type:"",status:""}),u("")},getAvailableUsers:async()=>{try{return(await Ft.getDepartmentHeads())?.users||[]}catch(W){return console.error("Error fetching department heads:",W),ce.error("Failed to load department heads"),[]}},refreshDepartments:async()=>{o(!0),c(null);try{const K=(await Ft.getDepartments()).departments||[],J=Fa(K);r(J)}catch(W){console.error("Error refreshing departments:",W),c("Failed to refresh departments")}finally{o(!1)}},setError:c}},T1=({collapsed:e,onClose:t})=>{const{hasModuleAccess:r,hasPermission:s}=ku(),{user:n}=_s(),i=$n(),o=Qe(),c=(typeof n?.role=="string"?n.role:n?.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim(),d=c==="ACADEMIC_DEPARTMENT"||c==="ACADEMIC_DEPT"||c.startsWith("ACADEMIC"),{departments:u,loading:m}=px(d),[f,h]=b.useState(!1),[p,x]=b.useState(!1),[g,v]=b.useState(!1),w=b.useRef(null);b.useEffect(()=>{if(w.current&&f){const S=w.current,E=S.scrollHeight>S.clientHeight;v(E)}},[f,u]);const y=b.useMemo(()=>{const E=(typeof n?.role=="string"?n.role:n?.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();return[{id:"main-menu",label:"Main Menu",icon:ix,path:"/admin/main-menu",permission:null,module:"ADMIN"},{id:"users",label:"User Management",icon:Ar,path:"/admin/users",permission:Ne.USERS.VIEW_ALL,module:"USERS"},{id:"roles",label:"Role Management",icon:dx,path:"/admin/roles",permission:Ne.ROLES.VIEW_ALL,module:"ROLES"},{id:"departments",label:"Departments",icon:ka,path:"/admin/departments",permission:Ne.DEPARTMENTS.VIEW_ALL,module:"DEPARTMENTS"},{id:"forms",label:"Form Templates",icon:nr,path:"/admin/forms",permission:Ne.TEMPLATES.VIEW_ALL,module:"TEMPLATES"},{id:"system-config",label:"System Configuration",icon:Q2,path:"/admin/system-config",permission:Ne.GLOBAL_FIELDS.VIEW_ALL,module:"GLOBAL_FIELDS"},{id:"academic-dashboard",label:"Academic Dashboard",icon:eN,path:"/academic/dashboard",permission:Ne.DASHBOARD.VIEW,module:"ACADEMIC"},{id:"trainee-dashboard",label:"Trainee Dashboard",icon:ma,path:"/trainee/dashboard",permission:Ne.TRAINEES.VIEW_DETAIL,module:"TRAINEES"},{id:"enrolled-courses",label:"Enrolled Course List",icon:ma,path:"/trainee/enrolled-courses",permission:Ne.TRAINEES.VIEW_COURSES,module:"TRAINEES"},{id:"all-assessments",label:"All Assessments",icon:ma,path:"/trainee/all-assessments",permission:Ne.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES",children:[{id:"your-assessments",label:"Your Assessments",path:"/trainee/your-assessments",permission:Ne.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"signature-required",label:"Signature Required List",path:"/trainee/signature-required",permission:Ne.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"},{id:"completion-required",label:"Section Completion Required List",path:"/trainee/completion-required",permission:Ne.TRAINEES.VIEW_ASSESSMENTS,module:"TRAINEES"}]},{id:"create-issue",label:"Create Incident/Feedback Report",icon:ma,path:"/trainee/create-incident-feedback-report",permission:Ne.TRAINEES.VIEW_ALL,module:"TRAINEES"},{id:"upcoming-assessments",label:"List Upcoming Assessment",icon:it,path:"/trainer/upcoming-assessments",permission:Ne.ASSESSMENTS.VIEW_ALL,module:"TRAINER"},{id:"assessment-results",label:"List Assessment Result",icon:lt,path:"/trainer/assessment-results",permission:Ne.ASSESSMENTS.VIEW_RESULTS,module:"TRAINER"},{id:"instructed-courses",label:"List Instructed Course",icon:bt,path:"/trainer/instructed-courses",permission:Ne.COURSES.VIEW_ALL,module:"TRAINER"},{id:"department-dashboard",label:"Department Dashboard",icon:ka,path:"/department-head/dashboard",permission:Ne.DASHBOARD.VIEW,module:"DEPARTMENT_HEAD"},{id:"my-department-details",label:"My Department Details",icon:bt,path:"/department-head/my-department-details",permission:Ne.DEPARTMENTS.VIEW_DETAIL,module:"DEPARTMENT_HEAD"},{id:"assessment-review-requests",label:"List Assessment Review Requests",icon:At,path:"/department-head/assessment-review-requests",permission:Ne.ASSESSMENTS.VIEW_ALL,module:"DEPARTMENT_HEAD"},{id:"issue-list",label:"Issue List",icon:yr,path:"/sqa/issues",permission:Ne.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"feedback-list",label:"Feedback List",icon:G2,path:"/sqa/feedback",permission:Ne.SQA.VIEW_TEMPLATES,module:"SQA"},{id:"template-list",label:"Template List",icon:Su,path:"/sqa/templates",permission:Ne.SQA.VIEW_TEMPLATES,module:"SQA",children:[{id:"template-history",label:"List History Version",path:"/sqa/templates/history",permission:Ne.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-sections",label:"Section List",path:"/sqa/templates/sections",permission:Ne.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-fields",label:"Field List",path:"/sqa/templates/fields",permission:Ne.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"},{id:"template-export",label:"PDF Preview for Export",path:"/sqa/templates/export",permission:Ne.SQA.VIEW_TEMPLATE_DETAIL,module:"SQA"}]}].filter(j=>E==="ADMINISTRATOR"?["main-menu","users","roles","departments","forms","system-config"].includes(j.id)?j.id==="main-menu"?!0:r(j.module)||s(j.permission):!1:E==="ACADEMIC_DEPARTMENT"||E==="ACADEMIC_DEPT"||E.startsWith("ACADEMIC")?["academic-dashboard"].includes(j.id):E==="TRAINEE"?["trainee-dashboard","enrolled-courses","all-assessments","create-issue"].includes(j.id):E==="TRAINER"?["upcoming-assessments","assessment-results","instructed-courses"].includes(j.id):E==="SQA_AUDITOR"?["issue-list","feedback-list","template-list"].includes(j.id):E==="DEPARTMENT_HEAD"?["department-dashboard","my-department-details","assessment-review-requests"].includes(j.id):r(j.module)||s(j.permission))},[n,r,s]);return a.jsxs("div",{className:`bg-primary-custom text-white d-flex flex-column transition-all ${e?"sidebar-collapsed":""}`,style:{width:e?"60px":"260px",minHeight:"100vh",transition:"width 0.3s ease",position:"sticky",top:0,height:"100vh",overflowY:"hidden",overflowX:"hidden"},children:[a.jsxs("div",{className:"p-3 border-bottom border-secondary bg-gradient-primary-custom position-relative",children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[!e&&a.jsx(a.Fragment,{children:a.jsx("img",{src:VP,alt:"Logo",style:{width:"50%",marginRight:"0px"}})}),e&&a.jsx("div",{children:a.jsx(U2,{size:24})})]}),t&&a.jsx(se,{variant:"link",className:"position-absolute top-0 end-0 text-white p-2 d-md-none",onClick:t,style:{border:"none",background:"transparent"},children:a.jsx(Ze,{size:20})})]}),a.jsxs(St,{className:"flex-column flex-grow-1 p-3 bg-gradient-primary-custom",children:[y.map(S=>{const E=S.icon,N=i.pathname===S.path;return S.id==="all-assessments"&&n?.role==="TRAINEE"?a.jsx(St.Item,{className:"mb-3",children:a.jsxs("div",{className:"position-relative",children:[a.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/trainee/signature-required")||i.pathname.startsWith("/trainee/completion-required")||i.pathname.startsWith("/trainee/your-assessments")?"rgba(255, 255, 255, 0.1)":"transparent",cursor:"pointer"},onClick:()=>{e?(o("/trainee/all-assessments"),t()):x(!p)},children:[a.jsx(E,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},children:S.label}),a.jsx(Ha,{size:16,className:`ms-auto transition-transform ${p?"rotate-180":""}`,style:{transition:"transform 0.3s ease"}})]})]}),!e&&p&&a.jsx("div",{className:"mt-2 ms-4",children:S.children&&S.children.map(j=>a.jsx(Nm,{to:j.path,className:"sidebar-nav-link text-white d-flex align-items-center py-2 pe-1 rounded nav-link",style:{backgroundColor:i.pathname===j.path?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:"normal",wordWrap:"break-word",overflowWrap:"break-word"},onClick:t,children:a.jsx("span",{className:"sidebar-nav-label",children:j.label})},j.id))})]})},S.id):a.jsx(St.Item,{className:"mb-3",children:a.jsxs(Nm,{to:S.path,className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${N?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:N?"rgba(255, 255, 255, 0.1)":"transparent",whiteSpace:e?"nowrap":"normal",wordWrap:e?"normal":"break-word",overflowWrap:"break-word"},onClick:()=>{t()},children:[a.jsx(E,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&a.jsx("span",{className:"sidebar-nav-label",style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},children:S.label})]})},S.id)}),d&&a.jsx(St.Item,{className:"mb-3",children:a.jsxs("div",{className:"position-relative",children:[a.jsxs("div",{className:`sidebar-nav-link text-white d-flex align-items-center py-3 pe-1 rounded nav-link ${e?"justify-content-center":""} ${i.pathname.startsWith("/academic/departments")?"active":""}`,style:{minHeight:e?"48px":"auto",backgroundColor:i.pathname.startsWith("/academic/departments")?"rgba(255, 255, 255, 0.1)":"transparent"},children:[a.jsx(ka,{size:20,className:e?"me-2":"me-3",style:{display:"inline-block",flexShrink:0,transition:"transform 0.3s cubic-bezier(.68,-0.55,.27,1.55)"}}),!e&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"sidebar-nav-label flex-grow-1",style:{cursor:"pointer",wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.2"},onClick:()=>{h(!f),o("/academic/departments")},children:"Department"}),a.jsx(Ha,{size:16,className:"ms-auto",style:{transition:"transform 0.3s ease",cursor:"pointer",transform:f?"rotate(180deg)":"rotate(0deg)"},onClick:()=>{h(!f)}})]})]}),!e&&f&&a.jsx("div",{ref:w,className:`position-absolute start-0 end-0 mt-1 sidebar-department-dropdown ${g?"scrollable":""}`,style:{zIndex:1e3,maxHeight:"300px",overflowY:"auto"},children:m?a.jsx("div",{className:"px-3 py-2 text-white-50 sidebar-department-loading",children:a.jsx("small",{children:"Loading departments..."})}):u.length>0?u.map(S=>a.jsxs(Nm,{to:`/academic/course/${S.id}`,className:`d-block px-3 py-2 text-white text-decoration-none d-flex align-items-center sidebar-department-item ${i.pathname===`/academic/course/${S.id}`?"active":""}`,style:{fontSize:"0.875rem",backgroundColor:i.pathname===`/academic/course/${S.id}`?"rgba(255, 255, 255, 0.15)":"transparent",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},onClick:()=>{t&&t()},children:[a.jsx(ec,{size:12,className:"me-2 sidebar-department-chevron"}),S.code]},S.id)):a.jsx("div",{className:"px-3 py-2 text-white-50",children:a.jsx("small",{children:"No departments found"})})})]})})]})]})},On={getProfile:async()=>{try{return(await Ie.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},updateAvatar:async(e,t)=>{try{const s={...t||await On.getProfile(),avatarUrl:e};return s.address||(s.address=""),s.phoneNumber||(s.phoneNumber=""),s.avatarUrl||(s.avatarUrl=""),s.firstName||(s.firstName=""),s.lastName||(s.lastName=""),s.middleName||(s.middleName=""),Object.keys(s).forEach(i=>{(s[i]===void 0||s[i]===null)&&delete s[i]}),(await Ie.put("/profile",s)).data}catch(r){throw console.error("Error updating avatar:",r),r}},updateProfile:async e=>{try{console.log("updateProfile - sending data:",e);const t=await Ie.put("/profile",e);return console.log("updateProfile - response:",t.data),t.data}catch(t){throw console.error("Error updating profile:",t),console.error("Error response:",t.response?.data),t.response?.data?.errors&&console.error("Validation errors:",t.response.data.errors),t}},resetPassword:async e=>{try{return(await Ie.put("/profile/password",e)).data}catch(t){throw console.error("Error resetting password:",t),t}}},lI=()=>{const[e,t]=b.useState(null),[r,s]=b.useState(!0),[n,i]=b.useState(null),o=async()=>{try{s(!0),i(null);const u=await On.getProfile();t(u)}catch(u){console.error("Error fetching profile:",u),i(u.message||"Failed to fetch profile")}finally{s(!1)}},l=async u=>{try{s(!0),i(null);const m=await On.updateProfile(u);return t(m),m}catch(m){throw console.error("Error updating profile:",m),i(m.message||"Failed to update profile"),m}finally{s(!1)}},c=()=>{if(!e)return"Loading...";const{firstName:u,lastName:m,middleName:f}=e,h=[];return u&&h.push(u),f&&h.push(f),m&&h.push(m),h.join(" ")||"User"},d=()=>e?.role?e.role.name:"User";return b.useEffect(()=>{o()},[]),{profile:e,loading:r,error:n,fetchProfile:o,updateProfile:l,getDisplayName:c,getRoleName:d}},cI={position:"absolute",top:"100%",right:"0",zIndex:9999,minWidth:"250px",maxWidth:"300px",backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",borderRadius:"0.375rem",padding:"0.5rem 0",width:"auto",height:"auto",overflow:"visible",boxShadow:"none !important",WebkitBoxShadow:"none !important",MozBoxShadow:"none !important"},dI=({onToggleSidebar:e})=>{const t=$n(),r=Qe(),[s,n]=b.useState(!1),[i,o]=b.useState(!1),l=b.useRef(null),{user:c,isLoading:d}=_s(),{profile:u,getDisplayName:m,loading:f}=lI(),h=()=>{if(!c||f)return"Loading...";if(u&&m&&m()&&m()!=="Loading..."){const S=m();if(S&&S.trim()!=="")return S}if(u&&u.firstName){const S=[u.firstName];u.middleName&&S.push(u.middleName),u.lastName&&S.push(u.lastName);const E=S.join(" ").trim();if(E)return E}if(c.fullName&&c.fullName!=="User"&&c.fullName.trim()!=="")return c.fullName;if(c.firstName&&c.lastName)return`${c.firstName} ${c.lastName}`;try{const S=localStorage.getItem("authToken");if(S){const E=JSON.parse(atob(S.split(".")[1]));if(E.fullName&&E.fullName!=="User")return E.fullName;if(E.name&&E.name!=="User")return E.name;if(E.firstName&&E.lastName)return`${E.firstName} ${E.lastName}`}}catch(S){console.error("Error parsing JWT token for display name:",S)}return c.name||"User"},p=()=>c&&c.email||"No email",x=S=>{const E={"/profile":"Profile","/admin":"Dashboard","/admin/dashboard":"Dashboard","/admin/users":"User Management","/admin/roles":"Role Management","/admin/departments":"Department Management","/admin/forms":"Form Templates","/admin/main-menu":"Main Menu","/admin/system-config":"System Configuration","/academic":"Academic Dashboard","/academic/dashboard":"Academic Dashboard","/academic/departments":"Department Management","/trainee":"Trainee Dashboard","/trainee/dashboard":"Trainee Dashboard","/trainee/academic-details":"Academic Details","/trainee/enrolled-courses":"Enrolled Course List","/trainee/signature-required":"Signature Required List","/trainee/completion-required":"Section Completion Required List","/trainee/your-assessments":"Your Assessments","/trainee/create-incident-feedback-report":"Create Incident/Feedback Report","/trainee/assessment-pending/section-completion":"Section Completion Required List","/trainer":"Trainer Dashboard","/trainer/dashboard":"Trainer Dashboard","/trainer/upcoming-assessments":"Upcoming Assessments","/trainer/assessment-results":"Assessment Results","/trainer/instructed-courses":"Instructed Courses","/trainer/courses":"Course Details","/trainer/configure-signature":"Configure Signature","/trainer/section-completion":"Section Completion","/trainer/assessment-details":"Assessment Result Details","/trainer/approval-notes":"Result Approval Note","/sqa":"Issue List","/sqa/issues":"Issue List","/sqa/feedback":"Feedback List","/sqa/templates":"Template List","/sqa/templates/history":"Template History","/sqa/templates/sections":"Template Sections","/sqa/templates/fields":"Template Fields","/sqa/templates/pdf-preview":"PDF Preview"};return S.startsWith("/admin/departments/")&&S!=="/admin/departments"?"Department Details":S.startsWith("/academic/departments/")&&S!=="/academic/departments"?"Department Management":S.includes("/enroll-trainees")?"Trainee Enrollments":S.startsWith("/academic/course/")&&!S.includes("/subject/")?"Department Details":S.startsWith("/academic/course-detail/")?"Course Details":S.includes("/subject/")?"Subject Details":S.includes("/enroll-trainees")?"Enroll Trainees":S.match(/^\/trainee\/[^/]+\/course\/[^/]+$/)?"Course Details":S.match(/^\/trainee\/[^/]+\/course\/[^/]+\/subject\/[^/]+$/)?"Subject Details":S.match(/^\/trainee\/[^/]+\/assessments$/)?"Assessment Details":S.match(/^\/trainee\/[^/]+\/signature-pad\/[^/]+$/)?"Digital Signature":S.match(/^\/trainee\/[^/]+\/assessment-section\/[^/]+$/)?"Assessment Section":S.startsWith("/sqa/templates/")&&S!=="/sqa/templates"?"Template Detail":S.startsWith("/trainer/trainees/")?"Trainee Details":S.startsWith("/trainer/subjects/")?"Subject Details":S.startsWith("/trainer/courses/")?"Course Details":S.startsWith("/trainer/assessment-details/")?"Assessment Result Details":S.startsWith("/trainer/approval-notes/")?"Result Approval Note":S.includes("/department-head/courses/")&&S.includes("/subjects/")?"Subject Details":S.startsWith("/department-head/trainees/")||S.startsWith("/trainee/")&&S!=="/trainee"&&!S.startsWith("/trainee/dashboard")&&!S.startsWith("/trainee/academic-details")&&!S.startsWith("/trainee/enrolled-courses")&&!S.startsWith("/trainee/assessment-pending")&&!S.startsWith("/trainee/create-incident-feedback-report")&&!S.startsWith("/trainee/signature-required")&&!S.startsWith("/trainee/completion-required")&&!S.startsWith("/trainee/your-assessments")?"Trainee Details":E[S]||"Dashboard"},g=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user");const S=()=>window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/";window.location.href=S()},v=()=>{n(!s)},w=()=>{n(!1)},y=()=>{r("/profile"),n(!1)};return b.useEffect(()=>{const S=E=>{l.current&&!l.current.contains(E.target)&&o(!1)};return i&&document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[i]),a.jsxs(a.Fragment,{children:[a.jsx(r1,{bg:"white",expand:"lg",className:"border-bottom border-neutral-200 shadow-sm",style:{minHeight:"60px"},children:a.jsxs("div",{className:"container-fluid",children:[a.jsx(se,{variant:"link",className:"text-primary-custom p-2 me-3",onClick:e,style:{border:"none",background:"transparent"},children:a.jsx(ix,{size:20})}),a.jsx(r1.Brand,{className:"text-primary-custom fw-bold custom-title",children:x(t.pathname)}),a.jsx("div",{className:"d-none d-lg-block ms-auto",style:{position:"relative"},children:a.jsxs("div",{ref:l,style:{position:"relative"},children:[a.jsxs("button",{className:"text-primary-custom p-0 d-flex align-items-center",style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",boxShadow:"none",WebkitBoxShadow:"none",MozBoxShadow:"none"},onClick:()=>o(!i),children:[a.jsx(to,{size:32,className:"me-2"}),a.jsx("span",{children:d||f?"Loading...":h()})]}),a.jsxs("div",{className:`custom-dropdown ${i?"show":"hide"}`,style:cI,children:[a.jsxs("div",{className:"dropdown-header",style:{padding:"0.5rem 1rem",wordBreak:"break-all"},children:[a.jsx("div",{className:"fw-bold text-primary-custom",children:d||f?"Loading...":h()}),a.jsx("small",{className:"text-muted",style:{wordBreak:"break-all",whiteSpace:"normal",lineHeight:"1.2"},children:d?"Loading...":p()})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsxs("button",{className:"dropdown-item d-flex align-items-center text-primary-custom",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),y()},children:[a.jsx(to,{className:"me-2",size:16}),"Profile"]}),a.jsx("div",{className:"dropdown-divider"}),a.jsxs("button",{className:"dropdown-item d-flex align-items-center text-danger",style:{border:"none",background:"transparent",width:"100%",textAlign:"left",padding:"0.25rem 1rem"},onClick:()=>{o(!1),g()},children:[a.jsx(R0,{className:"me-2",size:16}),"Logout"]})]})]})}),a.jsx("div",{className:"d-lg-none text-primary-custom p-2",onClick:v,style:{border:"none",background:"transparent",textDecoration:"none",cursor:"pointer",marginLeft:"auto"},children:a.jsx(to,{size:32})})]})}),s&&a.jsx("div",{className:`profile-menu-overlay ${s?"show":""}`,onClick:w}),a.jsxs("div",{className:`profile-menu-slide ${s?"show":""}`,children:[a.jsxs("div",{className:"profile-menu-header",children:[a.jsx("button",{className:"profile-menu-close",onClick:w,"aria-label":"Close profile menu",children:a.jsx(Ze,{size:20})}),a.jsx("div",{className:"profile-avatar",children:a.jsx(to,{size:40})}),a.jsx("div",{className:"profile-name",children:d||f?"Loading...":h()}),a.jsx("div",{className:"profile-email",children:d?"Loading...":p()})]}),a.jsxs("ul",{className:"profile-menu-items",children:[a.jsx("li",{className:"profile-menu-item",children:a.jsxs("a",{href:"#",className:"profile-menu-link",onClick:S=>{S.preventDefault(),y()},children:[a.jsx(to,{className:"icon"}),"Profile"]})}),a.jsx("li",{className:"profile-menu-item",children:a.jsxs("a",{href:"#",className:"profile-menu-link danger",onClick:S=>{S.preventDefault(),w(),g()},children:[a.jsx(R0,{className:"icon"}),"Logout"]})})]})]})]})},uI=({children:e})=>{const[t,r]=b.useState(!1),[s,n]=b.useState(!1),[i,o]=b.useState(!1);b.useEffect(()=>{const d=()=>{n(window.innerWidth<=768)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const l=()=>{s?o(!i):r(!t)},c=()=>{s&&o(!1)};return a.jsxs("div",{className:"d-flex",style:{height:"100vh",overflow:"hidden"},children:[a.jsx("div",{className:`sidebar-desktop ${t?"sidebar-collapsed":""}`,children:a.jsx(T1,{collapsed:t})}),s&&i&&a.jsx("div",{className:"sidebar-mobile-overlay",onClick:c}),a.jsx("div",{className:`sidebar-mobile ${i?"show":""}`,children:a.jsx(T1,{collapsed:!1,onClose:c})}),a.jsxs("div",{className:`flex-grow-1 d-flex flex-column ${s?"main-content-mobile":""}`,children:[a.jsx(dI,{onToggleSidebar:l}),a.jsx("main",{className:"flex-grow-1 bg-light-custom",style:{overflowY:"auto"},children:e})]})]})},Zn=()=>a.jsx(uI,{children:a.jsx(Uk,{})}),Zt=(e,t=null,r="asc")=>{const[s,n]=b.useState({key:t,direction:r});return{sortedData:b.useMemo(()=>!s.key||!e?e:[...e].sort((d,u)=>{let m=d[s.key],f=u[s.key];if(s.key.includes(".")){const h=s.key.split(".");m=h.reduce((p,x)=>p?.[x],d),f=h.reduce((p,x)=>p?.[x],u)}if(s.key.includes("length")){const h=s.key.replace(".length","");m=d[h]?.length||0,f=u[h]?.length||0}return typeof m=="string"&&typeof f=="string"&&(m=m.toLowerCase(),f=f.toLowerCase()),m<f?s.direction==="asc"?-1:1:m>f?s.direction==="asc"?1:-1:0}),[e,s]),sortConfig:s,handleSort:d=>{let u="asc";if(s.key===d&&s.direction==="asc")u="desc";else if(s.key===d&&s.direction==="desc"){n({key:null,direction:"asc"});return}n({key:d,direction:u})},getSortIcon:d=>s.key!==d?"":s.direction==="asc"?"":"",getSortClass:d=>s.key!==d?"text-muted":(s.direction==="asc","text-primary")}},po=({data:e,loading:t,columns:r,renderRow:s,emptyMessage:n="No data found",emptyDescription:i="Try adjusting your search criteria."})=>{const{sortedData:o,sortConfig:l,handleSort:c}=Zt(e);if(t)return a.jsx(Wt,{rows:5,columns:r.length});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:n}),a.jsx("p",{children:i})]})});const d=({columnKey:u,children:m,className:f=""})=>{const h=l.key===u,p=h?l.direction:null;return a.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:m}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:p,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsx("tr",{children:r.map((u,m)=>u.sortable?a.jsx(d,{columnKey:u.key,className:u.className||"",children:u.title},m):a.jsx("th",{className:`fw-semibold ${u.className||""}`,style:{textTransform:"uppercase",letterSpacing:"0.5px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:u.title},m))})}),a.jsx("tbody",{children:o.map((u,m)=>s(u,m))})]})})},mI=({children:e})=>a.jsx(ND,{children:e}),Na=()=>{const e=Wk(),t=Qe(),s=(o=>o?.status===404?{title:"404 - Page Not Found",message:"The page you're looking for doesn't exist.",suggestion:"Check the URL or go back to the dashboard."}:o?.status===403?{title:"403 - Access Denied",message:"You don't have permission to access this page.",suggestion:"Contact your administrator for access."}:{title:"Something went wrong",message:o?.message||"An unexpected error occurred.",suggestion:"Please try refreshing the page or contact support."})(e),n=()=>{t((window.location.pathname.includes("/dsfms-template")?"/dsfms-template":"/")+"/admin")},i=()=>{t(-1)};return a.jsx(_e,{fluid:!0,className:"py-5",children:a.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-50",children:a.jsxs("div",{className:"text-center",style:{maxWidth:"500px"},children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h1",{className:"display-1 text-muted",children:""}),a.jsx("h2",{className:"text-primary-custom mb-3",children:s.title}),a.jsx("p",{className:"text-muted mb-4",children:s.message}),a.jsx("p",{className:"small text-muted",children:s.suggestion})]}),a.jsxs("div",{className:"d-flex gap-3 justify-content-center",children:[a.jsx(se,{variant:"primary",onClick:n,className:"px-4",children:"Go to Dashboard"}),a.jsx(se,{variant:"outline-secondary",onClick:i,className:"px-4",children:"Go Back"})]}),!1]})})})},Wt=({rows:e=5,columns:t=4})=>{const r=()=>a.jsx("tr",{children:Array.from({length:t}).map((s,n)=>a.jsx("td",{children:a.jsx("div",{className:"placeholder-glow",style:{height:"20px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px",animation:"placeholder-glow 2s ease-in-out infinite alternate"},children:a.jsx("span",{className:"placeholder col-12"})})},n))});return a.jsxs(M,{className:"border-neutral-200",children:[a.jsx(M.Header,{className:"bg-light-custom border-neutral-200",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("div",{className:"placeholder-glow",style:{height:"24px",width:"200px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:a.jsx("span",{className:"placeholder col-12"})}),a.jsx("div",{className:"placeholder-glow",style:{height:"32px",width:"100px",backgroundColor:"var(--bs-neutral-200)",borderRadius:"4px"},children:a.jsx("span",{className:"placeholder col-12"})})]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{className:"bg-neutral-50",children:a.jsx("tr",{children:Array.from({length:t}).map((s,n)=>a.jsx("th",{className:"border-neutral-200",children:a.jsx("div",{className:"placeholder-glow",style:{height:"16px",backgroundColor:"var(--bs-neutral-300)",borderRadius:"4px"},children:a.jsx("span",{className:"placeholder col-12"})})},n))})}),a.jsx("tbody",{children:Array.from({length:e}).map((s,n)=>a.jsx(r,{},n))})]})})})]})},mt=({permission:e,permissions:t=[],requireAll:r=!1,children:s,redirectTo:n=null})=>{const{hasPermission:i,hasAnyPermission:o,hasAllPermissions:l}=ku(),{user:c}=_s();return(!e&&(!t||t.length===0)||c?.role==="TRAINEE"?!0:e?i(e):t&&t.length>0?r?l(t):o(t):!1)?s:a.jsxs("div",{className:"p-4 text-center text-muted",children:[a.jsx("h4",{children:"Access Denied"}),a.jsx("p",{children:"You don't have permission to access this page."}),a.jsxs("p",{className:"small text-muted",children:["Required permission: ",e||t.join(", ")]}),a.jsxs("p",{className:"small text-muted",children:["Your role: ",c?.role||"Unknown"]})]})},wr=({permission:e,permissions:t=[],requireAll:r=!1,children:s,fallback:n=null,showMessage:i=!1,message:o="You do not have permission to access this feature."})=>{const{hasPermission:l,hasAnyPermission:c,hasAllPermissions:d}=ku();return(!e&&(!t||t.length===0)?!0:e?l(e):t&&t.length>0?r?d(t):c(t):!1)?s:n||(i?a.jsxs(Re,{variant:"warning",className:"mt-3",children:[a.jsx(Re.Heading,{children:"Access Denied"}),a.jsx("p",{children:o})]}):null)},Xt=({trigger:e,items:t=[],align:r="end",className:s="",onItemClick:n,placement:i="bottom-end",disabled:o=!1,...l})=>{const[c,d]=b.useState(!1),[u,m]=b.useState({top:0,left:0}),f=b.useRef(null),h=b.useRef(null),p=()=>{if(!f.current)return;const y=f.current.getBoundingClientRect(),S=200,E=150,N=4;let j,T;switch(i){case"bottom-start":j=y.bottom+N,T=y.left;break;case"bottom-end":j=y.bottom+N,T=y.right-S;break;case"top-start":j=y.top-E-N,T=y.left;break;case"top-end":j=y.top-E-N,T=y.right-S;break;default:j=y.bottom+N,T=y.right-S}j+E>window.innerHeight&&(j=y.top-E-N),j<0&&(j=N),T+S>window.innerWidth&&(T=window.innerWidth-S-N),T<0&&(T=N),m({top:j,left:T})},x=y=>{y.preventDefault(),y.stopPropagation(),!o&&(c||p(),d(!c))},g=()=>{d(!1)},v=y=>{y.onClick&&y.onClick(),n&&n(y),g()};b.useEffect(()=>{const y=E=>{c&&f.current&&!f.current.contains(E.target)&&h.current&&!h.current.contains(E.target)&&g()},S=E=>{E.key==="Escape"&&g()};return c&&(document.addEventListener("mousedown",y),document.addEventListener("keydown",S),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",y),document.removeEventListener("keydown",S),document.body.style.overflow=""}},[c]),b.useEffect(()=>{if(c){const y=()=>p(),S=()=>p();return window.addEventListener("scroll",y,!0),window.addEventListener("resize",S),()=>{window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",S)}}},[c,i]);const w=c&&rx.createPortal(a.jsx("div",{ref:h,className:"dropdown-menu show portal-dropdown border-0",style:{position:"fixed",top:u.top,left:u.left,zIndex:1070,minWidth:"200px",background:"#fff",border:"none",borderRadius:"0.25rem",boxShadow:"none",padding:"0.5rem 0",transform:"none",maxHeight:"none",overflowY:"visible"},children:t.map((y,S)=>y.type==="header"?a.jsx("div",{className:`dropdown-header ${y.className||""}`,children:y.content},S):y.type==="divider"?a.jsx("div",{className:"dropdown-divider"},S):a.jsxs("button",{onClick:()=>v(y),className:`dropdown-item ${y.className||""}`,disabled:y.disabled,children:[y.icon&&a.jsx("span",{className:"me-2",children:y.icon}),y.label]},S))}),document.body);return a.jsxs("div",{className:`dropdown ${s}`,children:[a.jsx("button",{ref:f,className:`btn ${e?.variant==="link"?"btn-link":"btn-light"} ${e?.className||""}`,type:"button",onClick:x,disabled:o,"aria-expanded":c,"aria-haspopup":"true",style:e?.style||{},children:e?.children}),w]})},Qn=({children:e})=>{const{isAuthenticated:t,isLoading:r}=_s(),s=$n();return r?a.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("div",{className:"mt-3",children:"Checking authentication..."})]})}):t?e:a.jsx(Hk,{to:"/",state:{from:s},replace:!0})},Mr=({placeholder:e="Search...",value:t,onChange:r,className:s="",size:n="md"})=>a.jsxs(s1,{className:s,size:n,children:[a.jsx(s1.Text,{className:"bg-white border-end-0",children:a.jsx(cx,{className:"text-primary-custom"})}),a.jsx(k.Control,{type:"text",placeholder:e,value:t,onChange:i=>r(i.target.value),className:"border-start-0",style:{borderColor:"var(--bs-neutral)",boxShadow:"none"},onFocus:i=>{i.target.style.borderColor="var(--bs-primary)",i.target.style.boxShadow="0 0 0 0.25rem rgba(27, 60, 83, 0.25)"},onBlur:i=>{i.target.style.borderColor="var(--bs-neutral)",i.target.style.boxShadow="none"}})]}),ir=({direction:e,size:t=16,color:r})=>{const s=r||"var(--bs-primary)",n={fontSize:`${t}px`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"inline-block",lineHeight:1,fontWeight:"bold"};return e==="asc"?a.jsx("span",{style:{...n,color:s,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):e==="desc"?a.jsx("span",{style:{...n,color:s,textShadow:r==="white"?"none":"0 0 8px rgba(0, 123, 255, 0.3)",transform:"scale(1.1)"},className:"sort-icon",children:""}):a.jsxs("span",{style:{...n,color:r||void 0},className:r?"":"text-muted sort-icon",children:[a.jsx("span",{style:{display:"inline-block",transform:"translateY(-1px)",opacity:r?.8:.5,marginRight:"1px"},children:""}),a.jsx("span",{style:{display:"inline-block",transform:"translateY(1px)",opacity:r?.8:.5},children:""})]})},Jo=()=>{const{user:e}=_s(),t=Qe();return b.useEffect(()=>{if(e?.role){const s=(typeof e.role=="string"?e.role:e.role?.name||"").toUpperCase().replace(/\s+/g,"_").trim();let n="/admin/users";s==="ACADEMIC_DEPARTMENT"||s==="ACADEMIC_DEPT"||s.startsWith("ACADEMIC")?n="/academic/dashboard":s==="TRAINEE"?n="/trainee":s==="TRAINER"?n="/trainer/upcoming-assessments":s==="SQA_AUDITOR"?n="/sqa/issues":s==="DEPARTMENT_HEAD"?n="/department-head/dashboard":n="/admin/users",t(n,{replace:!0})}},[e,t]),null},fI=({show:e,onHide:t})=>{const[r,s]=b.useState(""),[n,i]=b.useState(!1),[o,l]=b.useState(""),c=async u=>{u.preventDefault(),l(""),i(!0);try{const m=await fetch(`${$a.BASE_URL}${$a.ENDPOINTS.AUTH.FORGOT_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,magicLink:`${window.location.origin}${hx()}reset-password/`})});if(!m.ok){m.status===405?l("Forgot password feature is not available on this server. Please contact support."):m.status===404?l("Forgot password endpoint not found. Please contact support."):l(`Server error (${m.status}). Please try again later.`);return}try{await m.json()}catch(f){console.error("JSON parsing error:",f),l("Server returned invalid response. Please try again later.");return}ce.success("Password reset link has been sent to your email!"),s(""),t()}catch(m){console.error("Forgot password error:",m),m.name==="TypeError"&&m.message.includes("fetch")?l("Cannot connect to server. Please check your internet connection."):l("An unexpected error occurred. Please try again later.")}finally{i(!1)}},d=()=>{s(""),l(""),t()};return a.jsxs(ue,{show:e,onHide:d,centered:!0,children:[a.jsxs(ue.Header,{className:"border-0 pb-0",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:[a.jsxs(ue.Title,{className:"d-flex align-items-center text-white",children:[a.jsx(wi,{className:"me-2",size:20}),"Forgot Password"]}),a.jsx(se,{variant:"link",onClick:d,className:"p-0 ms-auto",style:{fontSize:"1.5rem",lineHeight:1,color:"white",filter:"brightness(1.2)"},children:a.jsx(Ze,{})})]}),a.jsxs(ue.Body,{className:"pt-0",children:[a.jsx("p",{className:"text-muted mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),o&&a.jsx(Re,{variant:"danger",className:"mb-3",children:o}),a.jsxs(k,{onSubmit:c,children:[a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Email Address"}),a.jsx(k.Control,{type:"email",placeholder:"Enter your email",value:r,onChange:u=>s(u.target.value),required:!0,disabled:n,className:"py-3 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}})]}),a.jsxs("div",{className:"d-grid gap-2",children:[a.jsx(se,{type:"submit",variant:"primary",size:"lg",disabled:n||!r.trim(),className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:u=>{u.target.style.transform="translateY(-2px)",u.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:u=>{u.target.style.transform="translateY(0)",u.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Sending..."]}):"Send Reset Link"}),a.jsx(se,{type:"button",variant:"outline-secondary",onClick:d,disabled:n,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:u=>{u.target.style.background="var(--bs-neutral-100)",u.target.style.borderColor="var(--bs-primary)",u.target.style.transform="translateY(-1px)"},onMouseLeave:u=>{u.target.style.background="rgba(255, 255, 255, 0.8)",u.target.style.borderColor="var(--bs-neutral-300)",u.target.style.transform="translateY(0)"},children:"Cancel"})]})]})]})]})};function _m(){const[e,t]=b.useState(""),[r,s]=b.useState(""),[n,i]=b.useState(!1),[o,l]=b.useState(!1),[c,d]=b.useState(!1),u=Qe(),m=$n(),{login:f,isAuthenticated:h,isLoading:p}=_s();if(b.useEffect(()=>{if(h){const g=m.state?.from?.pathname||"/admin";u(g,{replace:!0})}},[h,u,m.state?.from?.pathname]),p)return a.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("div",{className:"mt-3",children:"Loading..."})]})});if(h)return null;const x=async g=>{g.preventDefault(),l(!0);try{const v=await f({email:e,password:r});if(v.success){const w=m.state?.from?.pathname;w?u(w,{replace:!0}):u("/admin",{replace:!0})}else ce.error(v.error||"Email or password is incorrect. Please try again.")}catch{ce.error("Login failed. Please try again.")}finally{l(!1)}};return a.jsxs("div",{className:"min-vh-100 d-flex position-relative overflow-hidden",children:[a.jsx("div",{className:"position-absolute w-100 h-100",style:{backgroundImage:'url("./login-background.png")',backgroundSize:"cover",backgroundPosition:"center",filter:"blur(1px)",zIndex:-1}}),a.jsx("div",{className:"position-absolute w-100 h-100 bg-dark",style:{opacity:.3,zIndex:0}}),a.jsx(_e,{fluid:!0,className:"position-relative",style:{zIndex:1},children:a.jsxs(oe,{className:"min-vh-100",children:[a.jsx(H,{lg:6,className:"d-flex align-items-center justify-content-center p-5 d-none d-lg-flex",children:a.jsxs("div",{className:"text-white text-start",style:{maxWidth:"500px"},children:[a.jsxs("div",{className:"d-flex align-items-center mb-4",children:[a.jsx("div",{className:"dashed-line me-3"}),a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})})]}),a.jsxs("h1",{className:"display-4 fw-bold mb-4 custom-title",style:{lineHeight:"1.1"},children:["AVIATION",a.jsx("br",{}),"ACADEMY"]}),a.jsx("p",{className:"fs-5 mb-3",style:{opacity:.9},children:"Where Your Dream Destinations Become Reality."}),a.jsx("p",{className:"fs-6",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]})}),a.jsx(H,{lg:6,xs:12,className:"d-flex align-items-center justify-content-center p-3 p-lg-5",children:a.jsxs("div",{className:"w-100 login-form-container",style:{maxWidth:"400px",background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)",padding:"2rem",position:"relative",overflow:"hidden"},children:[a.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",zIndex:1}}),a.jsx("div",{style:{position:"absolute",top:"20%",left:"-50%",width:"200%",height:"60%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",transform:"rotate(-15deg)",zIndex:0}}),a.jsxs("div",{style:{position:"relative",zIndex:2},children:[a.jsxs("div",{className:"text-center mb-4 d-lg-none",children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-3",children:[a.jsx("div",{className:"dashed-line me-3"}),a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M21 16V14L13 9V3.5A1.5 1.5 0 0 0 11.5 2A1.5 1.5 0 0 0 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z",fill:"white"})}),a.jsx("div",{className:"dashed-line ms-3"})]}),a.jsxs("h1",{className:"text-white fw-bold mb-2 mobile-title",style:{lineHeight:"1.1",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:["AVIATION",a.jsx("br",{}),"ACADEMY"]}),a.jsx("p",{className:"text-white mb-2 mobile-subtitle",style:{opacity:.9,textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Where Your Dream Destinations Become Reality."}),a.jsx("p",{className:"text-white-50 mobile-description",style:{opacity:.8},children:"Embark on a journey where every corner of the world is within your reach."})]}),a.jsxs(k,{onSubmit:x,children:[a.jsxs(k.Group,{className:"mb-3",controlId:"email",children:[a.jsx(k.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Email"}),a.jsx(k.Control,{type:"email",value:e,onChange:g=>t(g.target.value),placeholder:"Enter your email",className:"bg-white border-0 rounded-3 py-3",style:{fontSize:"1rem"},required:!0})]}),a.jsxs(k.Group,{className:"mb-4",controlId:"password",children:[a.jsx(k.Label,{className:"text-white fw-medium",style:{textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:"Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(k.Control,{type:n?"text":"password",value:r,onChange:g=>s(g.target.value),placeholder:"Enter your password",className:"bg-white border-0 rounded-3 py-3 pe-5",style:{fontSize:"1rem"},required:!0}),a.jsx("span",{role:"button",tabIndex:0,onClick:()=>i(g=>!g),onKeyPress:g=>{(g.key==="Enter"||g.key===" ")&&i(v=>!v)},"aria-label":"Toggle password visibility",className:"position-absolute top-50 translate-middle-y end-0 me-3 d-flex align-items-center justify-content-center",style:{width:24,height:24,cursor:"pointer"},children:n?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[a.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),a.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"}),a.jsx("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#6b7280",strokeWidth:"1.5"})]}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",margin:"auto"},children:[a.jsx("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z",stroke:"#6b7280",strokeWidth:"1.5"}),a.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"#6b7280",strokeWidth:"1.5"})]})})]})]}),a.jsx(se,{type:"submit",variant:"primary",className:"w-100 py-4 fw-bold rounded-3 mb-3",style:{fontSize:"1.1rem"},disabled:o,children:o?a.jsxs(a.Fragment,{children:[a.jsx(Pt,{size:"sm",className:"me-2"})," Signing In..."]}):"Sign In"}),a.jsx("div",{className:"text-center mb-2",children:a.jsx("button",{type:"button",onClick:()=>d(!0),className:"btn btn-link text-decoration-none fw-semibold px-2 border-0 p-0",style:{fontSize:"0.9rem",color:"rgba(201, 212, 229, 0.8)",boxShadow:"none",textShadow:"none",cursor:"pointer",background:"none"},children:"Forgot password?"})}),a.jsx("div",{className:"text-center mb-4",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}}),a.jsx("hr",{className:"flex-grow-1",style:{borderColor:"rgba(255, 255, 255, 0.3)"}})]})}),a.jsxs("div",{className:"text-center",children:[a.jsx("small",{className:"text-white-50 d-block mb-2",children:"Test Credentials:"}),a.jsx("div",{className:"text-white-50 small",children:a.jsx("div",{children:"Admin: michael.brown@admin.com / Admin@123"})})]})]})]})]})})]})}),a.jsx("style",{children:`
        .dashed-line {
          width: 60px;
          height: 2px;
          background: repeating-linear-gradient(
            to right,
            white 0px,
            white 8px,
            transparent 8px,
            transparent 16px
          );
        }
        
        /* Mobile responsive styles */
        .mobile-title {
          font-size: 1.8rem;
        }
        
        .mobile-subtitle {
          font-size: 0.9rem;
        }
        
        .mobile-description {
          font-size: 0.75rem;
        }
        
        /* Tablet styles */
        @media (min-width: 576px) and (max-width: 991.98px) {
          .mobile-title {
            font-size: 2.2rem;
          }
          
          .mobile-subtitle {
            font-size: 1rem;
          }
          
          .mobile-description {
            font-size: 0.85rem;
          }
        }
        
        /* Mobile styles */
        @media (max-width: 575.98px) {
          .dashed-line {
            width: 40px;
          }
          
          .login-form-container {
            padding: 1.5rem !important;
          }
        }
      `}),a.jsx(fI,{show:c,onHide:()=>d(!1)})]})}const hI=()=>{const[e]=sx(),t=Qe(),[r,s]=b.useState({newPassword:"",confirmPassword:""}),[n,i]=b.useState(!1),[o,l]=b.useState(!1),[c,d]=b.useState(!1),[u,m]=b.useState(""),[f,h]=b.useState("");b.useEffect(()=>{const g=e.get("token");g&&h(g)},[e]);const p=g=>{const{name:v,value:w}=g.target;s(y=>({...y,[v]:w})),u&&m("")},x=async g=>{if(g.preventDefault(),m(""),!r.newPassword||!r.confirmPassword){m("Please fill in all fields.");return}if(r.newPassword!==r.confirmPassword){m("Passwords do not match.");return}d(!0);try{const v=await fetch(`${$a.BASE_URL}${$a.ENDPOINTS.AUTH.RESET_PASSWORD}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:f,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!v.ok){v.status===405?m("Reset password feature is not available on this server. Please contact support."):v.status===404?m("Reset password endpoint not found. Please contact support."):v.status===400?m("Invalid token or password. Please request a new reset link."):m(`Server error (${v.status}). Please try again later.`);return}try{await v.json()}catch(w){console.error("JSON parsing error:",w),m("Server returned invalid response. Please try again later.");return}ce.success("Password has been reset successfully! You can now login with your new password."),t("/login")}catch(v){console.error("Reset password error:",v),v.name==="TypeError"&&v.message.includes("fetch")?m("Cannot connect to server. Please check your internet connection."):m("An unexpected error occurred. Please try again later.")}finally{d(!1)}};return a.jsx("div",{className:"min-vh-100 d-flex align-items-center",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)"},children:a.jsx(_e,{children:a.jsx(oe,{className:"justify-content-center",children:a.jsx(H,{md:6,lg:5,xl:4,children:a.jsx(M,{className:"shadow-lg border-0",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 32px rgba(27, 60, 83, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},children:a.jsxs(M.Body,{className:"p-4",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)"},children:a.jsx(Tl,{size:24,className:"text-white"})}),a.jsx("h4",{className:"fw-bold mb-2",style:{color:"var(--bs-primary)"},children:"Reset Password"}),a.jsx("p",{className:"text-muted",children:"Enter your new password below"})]}),u&&a.jsx(Re,{variant:"danger",className:"mb-3",children:u}),a.jsxs(k,{onSubmit:x,children:[a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"New Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(k.Control,{type:n?"text":"password",name:"newPassword",value:r.newPassword,onChange:p,placeholder:"Enter new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),a.jsx(se,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>i(!n),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:n?a.jsx(El,{size:16}):a.jsx(Nt,{size:16})})]})]}),a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{style:{color:"var(--bs-primary)",fontWeight:"600"},children:"Confirm New Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(k.Control,{type:o?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:p,placeholder:"Confirm new password",required:!0,disabled:c,className:"py-3 pe-5 border-0 rounded-3",style:{background:"rgba(255, 255, 255, 0.9)",border:"1px solid var(--bs-neutral-200)",fontSize:"1rem",boxShadow:"0 2px 8px rgba(27, 60, 83, 0.1)"}}),a.jsx(se,{type:"button",variant:"link",className:"position-absolute end-0 top-50 translate-middle-y p-1",onClick:()=>l(!o),style:{border:"none",background:"none",color:"var(--bs-neutral-500)"},children:o?a.jsx(El,{size:16}):a.jsx(Nt,{size:16})})]})]}),a.jsxs("div",{className:"d-grid gap-2",children:[a.jsx(se,{type:"submit",variant:"primary",size:"lg",disabled:c||!r.newPassword||!r.confirmPassword,className:"py-3 fw-bold rounded-3",style:{background:"linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-secondary) 100%)",border:"none",fontSize:"1.1rem",boxShadow:"0 4px 15px rgba(27, 60, 83, 0.3)",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(27, 60, 83, 0.4)"},onMouseLeave:g=>{g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 15px rgba(27, 60, 83, 0.3)"},children:c?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Resetting..."]}):"Reset Password"}),a.jsx(se,{type:"button",variant:"outline-secondary",onClick:()=>t("/login"),disabled:c,className:"py-3 rounded-3",style:{border:"2px solid var(--bs-neutral-300)",color:"var(--bs-primary)",background:"rgba(255, 255, 255, 0.8)",fontSize:"1rem",fontWeight:"500",transition:"all 0.3s ease"},onMouseEnter:g=>{g.target.style.background="var(--bs-neutral-100)",g.target.style.borderColor="var(--bs-primary)",g.target.style.transform="translateY(-1px)"},onMouseLeave:g=>{g.target.style.background="rgba(255, 255, 255, 0.8)",g.target.style.borderColor="var(--bs-neutral-300)",g.target.style.transform="translateY(0)"},children:"Back to Login"})]})]})]})})})})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Td={};Td.version="0.18.5";var HN=1252,pI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},gx=function(e){pI.indexOf(e)!=-1&&(HN=xx[0]=e)};function xI(){gx(1252)}var Ca=function(e){gx(e)};function vx(){Ca(1200),xI()}function A1(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function gI(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function VN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ll=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?gI(e.slice(2)):t==254&&r==255?VN(e.slice(2)):t==65279?e.slice(1):e},Bc=function(t){return String.fromCharCode(t)},C1=function(t){return String.fromCharCode(t)},_l,kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kl(e){for(var t="",r=0,s=0,n=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,s=e.charCodeAt(d++),o=(r&3)<<4|s>>4,n=e.charCodeAt(d++),l=(s&15)<<2|n>>6,c=n&63,isNaN(s)?l=c=64:isNaN(n)&&(c=64),t+=kn.charAt(i)+kn.charAt(o)+kn.charAt(l)+kn.charAt(c);return t}function Xs(e){var t="",r=0,s=0,n=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=kn.indexOf(e.charAt(d++)),o=kn.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=kn.indexOf(e.charAt(d++)),s=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),c=kn.indexOf(e.charAt(d++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var wt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),pn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function In(e){return wt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function _1(e){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Vs=function(t){return wt?pn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Iu(e){if(typeof ArrayBuffer>"u")return Vs(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function Un(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function vI(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function bx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return bx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Gr=wt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:pn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function bI(e){for(var t=[],r=0,s=e.length+250,n=In(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>s&&(t.push(n.slice(0,r)),r=0,n=In(65535),s=65530)}return t.push(n.slice(0,r)),Gr(t)}var As=/\u0000/g,cl=/[\u0001-\u0006]/g;function io(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function _a(e,t){var r=""+e;return r.length>=t?r:vr("0",t-r.length)+r}function yx(e,t){var r=""+e;return r.length>=t?r:vr(" ",t-r.length)+r}function Ad(e,t){var r=""+e;return r.length>=t?r:r+vr(" ",t-r.length)}function yI(e,t){var r=""+Math.round(e);return r.length>=t?r:vr("0",t-r.length)+r}function wI(e,t){var r=""+e;return r.length>=t?r:vr("0",t-r.length)+r}var k1=Math.pow(2,32);function Ji(e,t){if(e>k1||e<-k1)return yI(e,t);var r=Math.round(e);return wI(r,t)}function Cd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var P1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],km=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jI(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},O1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},NI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _d(e,t,r){for(var s=e<0?-1:1,n=e*s,i=0,o=1,l=0,c=1,d=0,u=0,m=Math.floor(n);d<t&&(m=Math.floor(n),l=m*o+i,u=m*d+c,!(n-m<5e-8));)n=1/(n-m),i=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=o)),!r)return[0,s*l,u];var f=Math.floor(s*l/u);return[f,s*l-f*u,u]}function ii(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),i=0,o=[],l={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),s<60&&(i=(i+6)%7),r&&(i=_I(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var GN=new Date(1899,11,31,0,0,0),SI=GN.getTime(),EI=new Date(1900,2,1,0,0,0);function qN(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=EI&&(r+=1440*60*1e3),(r-(SI+(e.getTimezoneOffset()-GN.getTimezoneOffset())*6e4))/(1440*60*1e3)}function wx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function TI(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function AI(e){var t=e<0?12:11,r=wx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function CI(e){var t=wx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Pl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=AI(e):t===10?r=e.toFixed(10).substr(0,12):r=CI(e),wx(TI(r.toUpperCase()))}function Si(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Pl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ga(14,qN(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _I(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function kI(e,t,r,s){var n="",i=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return km[r.m-1][1];case 5:return km[r.m-1][0];default:return km[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return P1[r.q][0];default:return P1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?_a(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=_a(i,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?_a(c,d):"";return u}function Pn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var KN=/%/g;function PI(e,t,r){var s=t.replace(KN,""),n=t.length-s.length;return tn(e,s,r*Math.pow(10,2*n))+vr("%",n)}function OI(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return tn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function YN(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+YN(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var XN=/# (\?+)( ?)\/( ?)(\d+)/;function DI(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),i=Math.floor(n/s),o=n-i*s,l=s;return r+(i===0?"":""+i)+" "+(o===0?vr(" ",e[1].length+1+e[4].length):yx(o,e[1].length)+e[2]+"/"+e[3]+_a(l,e[4].length))}function II(e,t,r){return r+(t===0?"":""+t)+vr(" ",e[1].length+2+e[4].length)}var JN=/^#*0*\.([0#]+)/,ZN=/\).*[0#]/,QN=/\(###\) ###\\?-####/;function ws(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function D1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function I1(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function RI(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function FI(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function na(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZN)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?na("n",s,r):"("+na("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return OI(e,t,r);if(t.indexOf("%")!==-1)return PI(e,t,r);if(t.indexOf("E")!==-1)return YN(t,r);if(t.charCodeAt(0)===36)return"$"+na(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ji(c,t.length);if(t.match(/^[#?]+$/))return n=Ji(r,0),n==="0"&&(n=""),n.length>t.length?n:ws(t.substr(0,t.length-n.length))+n;if(i=t.match(XN))return DI(i,c,d);if(t.match(/^#+0+$/))return d+Ji(c,t.length-t.indexOf("0"));if(i=t.match(JN))return n=D1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ws(i[1])).replace(/\.$/,"."+ws(i[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+vr("0",ws(i[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+D1(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Pn(Ji(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+na(e,t,-r):Pn(""+(Math.floor(r)+RI(r,i[1].length)))+"."+_a(I1(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return na(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=io(na(e,t.replace(/[\\-]/g,""),r)),o=0,io(io(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<n.length?n.charAt(o++):p==="0"?"0":""}));if(t.match(QN))return n=na(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=_d(c,Math.pow(10,o)-1,!1),n=""+d,u=tn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=Ad(l[2],o),u.length<i[4].length&&(u=ws(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=_d(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?yx(l[1],o)+i[2]+"/"+i[3]+Ad(l[2],o):vr(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=Ji(r,0),t.length<=n.length?n:ws(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var m=t.indexOf(".")-o,f=t.length-n.length-m;return ws(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=I1(r,i[1].length),r<0?"-"+na(e,t,-r):Pn(FI(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?_a(0,3-p.length):"")+p})+"."+_a(o,i[1].length);switch(t){case"###,##0.00":return na(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Pn(Ji(c,0));return h!=="0"?d+h:"";case"###,###.00":return na(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return na(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function LI(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return tn(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function MI(e,t,r){var s=t.replace(KN,""),n=t.length-s.length;return tn(e,s,r*Math.pow(10,2*n))+vr("%",n)}function eS(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+eS(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZN)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ma("n",s,r):"("+Ma("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return LI(e,t,r);if(t.indexOf("%")!==-1)return MI(e,t,r);if(t.indexOf("E")!==-1)return eS(t,r);if(t.charCodeAt(0)===36)return"$"+Ma(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+_a(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:ws(t.substr(0,t.length-n.length))+n;if(i=t.match(XN))return II(i,c,d);if(t.match(/^#+0+$/))return d+_a(c,t.length-t.indexOf("0"));if(i=t.match(JN))return n=(""+r).replace(/^([^\.]+)$/,"$1."+ws(i[1])).replace(/\.$/,"."+ws(i[1])),n=n.replace(/\.(\d*)$/,function(p,x){return"."+x+vr("0",ws(i[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Pn(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):Pn(""+r)+"."+vr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ma(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=io(Ma(e,t.replace(/[\\-]/g,""),r)),o=0,io(io(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<n.length?n.charAt(o++):p==="0"?"0":""}));if(t.match(QN))return n=Ma(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=_d(c,Math.pow(10,o)-1,!1),n=""+d,u=tn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=Ad(l[2],o),u.length<i[4].length&&(u=ws(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=_d(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?yx(l[1],o)+i[2]+"/"+i[3]+Ad(l[2],o):vr(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:ws(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var m=t.indexOf(".")-o,f=t.length-n.length-m;return ws(t.substr(0,m)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):Pn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?_a(0,3-p.length):"")+p})+"."+_a(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Pn(""+c);return h!=="0"?d+h:"";default:if(t.match(/\.[0#?]*$/))return Ma(e,t.slice(0,t.lastIndexOf(".")),r)+ws(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function tn(e,t,r){return(r|0)===r?Ma(e,t,r):na(e,t,r)}function BI(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var tS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Oo(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Cd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(tS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function $I(e,t,r,s){for(var n=[],i="",o=0,l="",c="t",d,u,m,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Cd(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(m=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(m);n[n.length]={t:"t",v:i},++o;break;case"\\":var h=e.charAt(++o),p=h==="("||h===")"?h:"t";n[n.length]={t:p,v:h},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ii(t,r,e.charAt(o+1)==="2"),d==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ii(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),n[n.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var x={t:l,v:l};if(d==null&&(d=ii(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(x.v=d.H>=12?"P":"A"),x.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(x.v=d.H>=12?"PM":"AM"),x.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(x.v=d.H>=12?"":""),x.t="T",o+=5,f="h"):(x.t="t",++o),d==null&&x.t==="T")return"";n[n.length]=x,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(tS)){if(d==null&&(d=ii(t,r),d==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Oo(e)||(n[n.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var g=0,v=0,w;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=f,c="h",g<1&&(g=1);break;case"s":(w=n[o].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[o].v.match(/[Hh]/)&&(g=1),g<2&&n[o].v.match(/[Mm]/)&&(g=2),g<3&&n[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var y="",S;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=kI(n[o].t.charCodeAt(0),n[o].v,d,v),n[o].t="t";break;case"n":case"?":for(S=o+1;n[S]!=null&&((l=n[S].t)==="?"||l==="D"||(l===" "||l==="t")&&n[S+1]!=null&&(n[S+1].t==="?"||n[S+1].t==="t"&&n[S+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[S].v==="/"||n[S].v===" "&&n[S+1]!=null&&n[S+1].t=="?"));)n[o].v+=n[S].v,n[S]={v:"",t:";"},++S;y+=n[o].v,o=S-1;break;case"G":n[o].t="t",n[o].v=Si(t,r);break}var E="",N,j;if(y.length>0){y.charCodeAt(0)==40?(N=t<0&&y.charCodeAt(0)===45?-t:t,j=tn("n",y,N)):(N=t<0&&s>1?-t:t,j=tn("n",y,N),N<0&&n[0]&&n[0].t=="t"&&(j=j.substr(1),n[0].v="-"+n[0].v)),S=j.length-1;var T=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){T=o;break}var C=n.length;if(T===n.length&&j.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(S>=n[o].v.length-1?(S-=n[o].v.length,n[o].v=j.substr(S+1,n[o].v.length)):S<0?n[o].v="":(n[o].v=j.substr(0,S+1),S=-1),n[o].t="t",C=o);S>=0&&C<n.length&&(n[C].v=j.substr(0,S+1)+n[C].v)}else if(T!==n.length&&j.indexOf("E")===-1){for(S=j.indexOf(".")-1,o=T;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(u=n[o].v.indexOf(".")>-1&&o===T?n[o].v.indexOf(".")-1:n[o].v.length-1,E=n[o].v.substr(u+1);u>=0;--u)S>=0&&(n[o].v.charAt(u)==="0"||n[o].v.charAt(u)==="#")&&(E=j.charAt(S--)+E);n[o].v=E,n[o].t="t",C=o}for(S>=0&&C<n.length&&(n[C].v=j.substr(0,S+1)+n[C].v),S=j.indexOf(".")+1,o=T;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==T)){for(u=n[o].v.indexOf(".")>-1&&o===T?n[o].v.indexOf(".")+1:0,E=n[o].v.substr(0,u);u<n[o].v.length;++u)S<j.length&&(E+=j.charAt(S++));n[o].v=E,n[o].t="t",C=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(N=s>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=tn(n[o].t,n[o].v,N),n[o].t="t");var L="";for(o=0;o!==n.length;++o)n[o]!=null&&(L+=n[o].v);return L}var R1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function F1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function zI(e,t){var r=BI(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(R1),l=r[1].match(R1);return F1(t,o)?[s,r[0]]:F1(t,l)?[s,r[1]]:[s,r[o!=null&&l!=null?2:1]]}return[s,i]}function ga(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:ot)[e],s==null&&(s=r.table&&r.table[O1[e]]||ot[O1[e]]),s==null&&(s=NI[e]||"General");break}if(Cd(s,0))return Si(t,r);t instanceof Date&&(t=qN(t,r.date1904));var n=zI(s,t);if(Cd(n[1]))return Si(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return $I(n[1],t,r,n[0])}function rn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ot[r]==null){t<0&&(t=r);continue}if(ot[r]==e){t=r;break}}t<0&&(t=391)}return ot[t]=e,t}function Ru(e){for(var t=0;t!=392;++t)e[t]!==void 0&&rn(e[t],t)}function Do(){ot=jI()}var UI={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function WI(e){var t=typeof e=="number"?ot[e]:e;return t=t.replace(rS,"(\\d+)"),new RegExp("^"+t+"$")}function HI(e,t,r){var s=-1,n=-1,i=-1,o=-1,l=-1,c=-1;(t.match(rS)||[]).forEach(function(m,f){var h=parseInt(r[f+1],10);switch(m.toLowerCase().charAt(0)){case"y":s=h;break;case"d":i=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:n=h;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var d=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:s==-1&&n==-1&&i==-1?u:d+"T"+u}var VI=(function(){var e={};e.version="1.2.0";function t(){for(var j=0,T=new Array(256),C=0;C!=256;++C)j=C,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,T[C]=j;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function s(j){var T=0,C=0,L=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)A[L]=j[L];for(L=0;L!=256;++L)for(C=j[L],T=256+L;T<4096;T+=256)C=A[T]=C>>>8^j[C&255];var P=[];for(L=1;L!=16;++L)P[L-1]=typeof Int32Array<"u"?A.subarray(L*256,L*256+256):A.slice(L*256,L*256+256);return P}var n=s(r),i=n[0],o=n[1],l=n[2],c=n[3],d=n[4],u=n[5],m=n[6],f=n[7],h=n[8],p=n[9],x=n[10],g=n[11],v=n[12],w=n[13],y=n[14];function S(j,T){for(var C=T^-1,L=0,A=j.length;L<A;)C=C>>>8^r[(C^j.charCodeAt(L++))&255];return~C}function E(j,T){for(var C=T^-1,L=j.length-15,A=0;A<L;)C=y[j[A++]^C&255]^w[j[A++]^C>>8&255]^v[j[A++]^C>>16&255]^g[j[A++]^C>>>24]^x[j[A++]]^p[j[A++]]^h[j[A++]]^f[j[A++]]^m[j[A++]]^u[j[A++]]^d[j[A++]]^c[j[A++]]^l[j[A++]]^o[j[A++]]^i[j[A++]]^r[j[A++]];for(L+=15;A<L;)C=C>>>8^r[(C^j[A++])&255];return~C}function N(j,T){for(var C=T^-1,L=0,A=j.length,P=0,I=0;L<A;)P=j.charCodeAt(L++),P<128?C=C>>>8^r[(C^P)&255]:P<2048?(C=C>>>8^r[(C^(192|P>>6&31))&255],C=C>>>8^r[(C^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,I=j.charCodeAt(L++)&1023,C=C>>>8^r[(C^(240|P>>8&7))&255],C=C>>>8^r[(C^(128|P>>2&63))&255],C=C>>>8^r[(C^(128|I>>6&15|(P&3)<<4))&255],C=C>>>8^r[(C^(128|I&63))&255]):(C=C>>>8^r[(C^(224|P>>12&15))&255],C=C>>>8^r[(C^(128|P>>6&63))&255],C=C>>>8^r[(C^(128|P&63))&255]);return~C}return e.table=r,e.bstr=S,e.buf=E,e.str=N,e})(),rt=(function(){var t={};t.version="1.2.1";function r(V,Q){for(var q=V.split("/"),X=Q.split("/"),ee=0,re=0,xe=Math.min(q.length,X.length);ee<xe;++ee){if(re=q[ee].length-X[ee].length)return re;if(q[ee]!=X[ee])return q[ee]<X[ee]?-1:1}return q.length-X.length}function s(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:s(V.slice(0,-1));var Q=V.lastIndexOf("/");return Q===-1?V:V.slice(0,Q+1)}function n(V){if(V.charAt(V.length-1)=="/")return n(V.slice(0,-1));var Q=V.lastIndexOf("/");return Q===-1?V:V.slice(Q+1)}function i(V,Q){typeof Q=="string"&&(Q=new Date(Q));var q=Q.getHours();q=q<<6|Q.getMinutes(),q=q<<5|Q.getSeconds()>>>1,V.write_shift(2,q);var X=Q.getFullYear()-1980;X=X<<4|Q.getMonth()+1,X=X<<5|Q.getDate(),V.write_shift(2,X)}function o(V){var Q=V.read_shift(2)&65535,q=V.read_shift(2)&65535,X=new Date,ee=q&31;q>>>=5;var re=q&15;q>>>=4,X.setMilliseconds(0),X.setFullYear(q+1980),X.setMonth(re-1),X.setDate(ee);var xe=Q&31;Q>>>=5;var Te=Q&63;return Q>>>=6,X.setHours(Q),X.setMinutes(Te),X.setSeconds(xe<<1),X}function l(V){ts(V,0);for(var Q={},q=0;V.l<=V.length-4;){var X=V.read_shift(2),ee=V.read_shift(2),re=V.l+ee,xe={};switch(X){case 21589:q=V.read_shift(1),q&1&&(xe.mtime=V.read_shift(4)),ee>5&&(q&2&&(xe.atime=V.read_shift(4)),q&4&&(xe.ctime=V.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}V.l=re,Q[X]=xe}return Q}var c;function d(){return c||(c={})}function u(V,Q){if(V[0]==80&&V[1]==75)return Sr(V,Q);if((V[0]|32)==109&&(V[1]|32)==105)return Rk(V,Q);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var q=3,X=512,ee=0,re=0,xe=0,Te=0,pe=0,ge=[],ye=V.slice(0,512);ts(ye,0);var Le=m(ye);switch(q=Le[0],q){case 3:X=512;break;case 4:X=4096;break;case 0:if(Le[1]==0)return Sr(V,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}X!==512&&(ye=V.slice(0,X),ts(ye,28));var Ue=V.slice(0,X);f(ye,q);var Ve=ye.read_shift(4,"i");if(q===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);ye.l+=4,xe=ye.read_shift(4,"i"),ye.l+=4,ye.chk("00100000","Mini Stream Cutoff Size: "),Te=ye.read_shift(4,"i"),ee=ye.read_shift(4,"i"),pe=ye.read_shift(4,"i"),re=ye.read_shift(4,"i");for(var Be=-1,He=0;He<109&&(Be=ye.read_shift(4,"i"),!(Be<0));++He)ge[He]=Be;var xt=h(V,X);g(pe,re,xt,X,ge);var dr=w(xt,xe,ge,X);dr[xe].name="!Directory",ee>0&&Te!==I&&(dr[Te].name="!MiniFAT"),dr[ge[0]].name="!FAT",dr.fat_addrs=ge,dr.ssz=X;var ur={},ns=[],Go=[],qo=[];y(xe,dr,xt,ns,ee,ur,Go,Te),p(Go,qo,ns),ns.shift();var Ko={FileIndex:Go,FullPaths:qo};return Q&&Q.raw&&(Ko.raw={header:Ue,sectors:xt}),Ko}function m(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(_,"Header Signature: "),V.l+=16;var Q=V.read_shift(2,"u");return[V.read_shift(2,"u"),Q]}function f(V,Q){var q=9;switch(V.l+=2,q=V.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function h(V,Q){for(var q=Math.ceil(V.length/Q)-1,X=[],ee=1;ee<q;++ee)X[ee-1]=V.slice(ee*Q,(ee+1)*Q);return X[q-1]=V.slice(q*Q),X}function p(V,Q,q){for(var X=0,ee=0,re=0,xe=0,Te=0,pe=q.length,ge=[],ye=[];X<pe;++X)ge[X]=ye[X]=X,Q[X]=q[X];for(;Te<ye.length;++Te)X=ye[Te],ee=V[X].L,re=V[X].R,xe=V[X].C,ge[X]===X&&(ee!==-1&&ge[ee]!==ee&&(ge[X]=ge[ee]),re!==-1&&ge[re]!==re&&(ge[X]=ge[re])),xe!==-1&&(ge[xe]=X),ee!==-1&&X!=ge[X]&&(ge[ee]=ge[X],ye.lastIndexOf(ee)<Te&&ye.push(ee)),re!==-1&&X!=ge[X]&&(ge[re]=ge[X],ye.lastIndexOf(re)<Te&&ye.push(re));for(X=1;X<pe;++X)ge[X]===X&&(re!==-1&&ge[re]!==re?ge[X]=ge[re]:ee!==-1&&ge[ee]!==ee&&(ge[X]=ge[ee]));for(X=1;X<pe;++X)if(V[X].type!==0){if(Te=X,Te!=ge[Te])do Te=ge[Te],Q[X]=Q[Te]+"/"+Q[X];while(Te!==0&&ge[Te]!==-1&&Te!=ge[Te]);ge[X]=-1}for(Q[0]+="/",X=1;X<pe;++X)V[X].type!==2&&(Q[X]+="/")}function x(V,Q,q){for(var X=V.start,ee=V.size,re=[],xe=X;q&&ee>0&&xe>=0;)re.push(Q.slice(xe*P,xe*P+P)),ee-=P,xe=ai(q,xe*4);return re.length===0?Ee(0):Gr(re).slice(0,V.size)}function g(V,Q,q,X,ee){var re=I;if(V===I){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var xe=q[V],Te=(X>>>2)-1;if(!xe)return;for(var pe=0;pe<Te&&(re=ai(xe,pe*4))!==I;++pe)ee.push(re);g(ai(xe,X-4),Q-1,q,X,ee)}}function v(V,Q,q,X,ee){var re=[],xe=[];ee||(ee=[]);var Te=X-1,pe=0,ge=0;for(pe=Q;pe>=0;){ee[pe]=!0,re[re.length]=pe,xe.push(V[pe]);var ye=q[Math.floor(pe*4/X)];if(ge=pe*4&Te,X<4+ge)throw new Error("FAT boundary crossed: "+pe+" 4 "+X);if(!V[ye])break;pe=ai(V[ye],ge)}return{nodes:re,data:K1([xe])}}function w(V,Q,q,X){var ee=V.length,re=[],xe=[],Te=[],pe=[],ge=X-1,ye=0,Le=0,Ue=0,Ve=0;for(ye=0;ye<ee;++ye)if(Te=[],Ue=ye+Q,Ue>=ee&&(Ue-=ee),!xe[Ue]){pe=[];var Be=[];for(Le=Ue;Le>=0;){Be[Le]=!0,xe[Le]=!0,Te[Te.length]=Le,pe.push(V[Le]);var He=q[Math.floor(Le*4/X)];if(Ve=Le*4&ge,X<4+Ve)throw new Error("FAT boundary crossed: "+Le+" 4 "+X);if(!V[He]||(Le=ai(V[He],Ve),Be[Le]))break}re[Ue]={nodes:Te,data:K1([pe])}}return re}function y(V,Q,q,X,ee,re,xe,Te){for(var pe=0,ge=X.length?2:0,ye=Q[V].data,Le=0,Ue=0,Ve;Le<ye.length;Le+=128){var Be=ye.slice(Le,Le+128);ts(Be,64),Ue=Be.read_shift(2),Ve=Cx(Be,0,Ue-ge),X.push(Ve);var He={name:Ve,type:Be.read_shift(1),color:Be.read_shift(1),L:Be.read_shift(4,"i"),R:Be.read_shift(4,"i"),C:Be.read_shift(4,"i"),clsid:Be.read_shift(16),state:Be.read_shift(4,"i"),start:0,size:0},xt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);xt!==0&&(He.ct=S(Be,Be.l-8));var dr=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);dr!==0&&(He.mt=S(Be,Be.l-8)),He.start=Be.read_shift(4,"i"),He.size=Be.read_shift(4,"i"),He.size<0&&He.start<0&&(He.size=He.type=0,He.start=I,He.name=""),He.type===5?(pe=He.start,ee>0&&pe!==I&&(Q[pe].name="!StreamData")):He.size>=4096?(He.storage="fat",Q[He.start]===void 0&&(Q[He.start]=v(q,He.start,Q.fat_addrs,Q.ssz)),Q[He.start].name=He.name,He.content=Q[He.start].data.slice(0,He.size)):(He.storage="minifat",He.size<0?He.size=0:pe!==I&&He.start!==I&&Q[pe]&&(He.content=x(He,Q[pe].data,(Q[Te]||{}).data))),He.content&&ts(He.content,0),re[Ve]=He,xe.push(He)}}function S(V,Q){return new Date((Hs(V,Q+4)/1e7*Math.pow(2,32)+Hs(V,Q)/1e7-11644473600)*1e3)}function E(V,Q){return d(),u(c.readFileSync(V),Q)}function N(V,Q){var q=Q&&Q.type;switch(q||wt&&Buffer.isBuffer(V)&&(q="buffer"),q||"base64"){case"file":return E(V,Q);case"base64":return u(Vs(Xs(V)),Q);case"binary":return u(Vs(V),Q)}return u(V,Q)}function j(V,Q){var q=Q||{},X=q.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=X+"/",V.FileIndex[0]={name:X,type:5}),q.CLSID&&(V.FileIndex[0].clsid=q.CLSID),T(V)}function T(V){var Q="Sh33tJ5";if(!rt.find(V,"/"+Q)){var q=Ee(4);q[0]=55,q[1]=q[3]=50,q[2]=54,V.FileIndex.push({name:Q,type:2,content:q,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+Q),C(V)}}function C(V,Q){j(V);for(var q=!1,X=!1,ee=V.FullPaths.length-1;ee>=0;--ee){var re=V.FileIndex[ee];switch(re.type){case 0:X?q=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(re.R*re.L*re.C)&&(q=!0),re.R>-1&&re.L>-1&&re.R==re.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!Q)){var xe=new Date(1987,1,19),Te=0,pe=Object.create?Object.create(null):{},ge=[];for(ee=0;ee<V.FullPaths.length;++ee)pe[V.FullPaths[ee]]=!0,V.FileIndex[ee].type!==0&&ge.push([V.FullPaths[ee],V.FileIndex[ee]]);for(ee=0;ee<ge.length;++ee){var ye=s(ge[ee][0]);X=pe[ye],X||(ge.push([ye,{name:n(ye).replace("/",""),type:1,clsid:W,ct:xe,mt:xe,content:null}]),pe[ye]=!0)}for(ge.sort(function(Ve,Be){return r(Ve[0],Be[0])}),V.FullPaths=[],V.FileIndex=[],ee=0;ee<ge.length;++ee)V.FullPaths[ee]=ge[ee][0],V.FileIndex[ee]=ge[ee][1];for(ee=0;ee<ge.length;++ee){var Le=V.FileIndex[ee],Ue=V.FullPaths[ee];if(Le.name=n(Ue).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||W,ee===0)Le.C=ge.length>1?1:-1,Le.size=0,Le.type=5;else if(Ue.slice(-1)=="/"){for(Te=ee+1;Te<ge.length&&s(V.FullPaths[Te])!=Ue;++Te);for(Le.C=Te>=ge.length?-1:Te,Te=ee+1;Te<ge.length&&s(V.FullPaths[Te])!=s(Ue);++Te);Le.R=Te>=ge.length?-1:Te,Le.type=1}else s(V.FullPaths[ee+1]||"")==s(Ue)&&(Le.R=ee+1),Le.type=2}}}function L(V,Q){var q=Q||{};if(q.fileType=="mad")return Fk(V,q);switch(C(V),q.fileType){case"zip":return Vo(V,q)}var X=(function(Ve){for(var Be=0,He=0,xt=0;xt<Ve.FileIndex.length;++xt){var dr=Ve.FileIndex[xt];if(dr.content){var ur=dr.content.length;ur>0&&(ur<4096?Be+=ur+63>>6:He+=ur+511>>9)}}for(var ns=Ve.FullPaths.length+3>>2,Go=Be+7>>3,qo=Be+127>>7,Ko=Go+He+ns+qo,Jn=Ko+127>>7,jm=Jn<=109?0:Math.ceil((Jn-109)/127);Ko+Jn+jm+127>>7>Jn;)jm=++Jn<=109?0:Math.ceil((Jn-109)/127);var Ya=[1,jm,Jn,qo,ns,He,Be,0];return Ve.FileIndex[0].size=Be<<6,Ya[7]=(Ve.FileIndex[0].start=Ya[0]+Ya[1]+Ya[2]+Ya[3]+Ya[4]+Ya[5])+(Ya[6]+7>>3),Ya})(V),ee=Ee(X[7]<<9),re=0,xe=0;{for(re=0;re<8;++re)ee.write_shift(1,D[re]);for(re=0;re<8;++re)ee.write_shift(2,0);for(ee.write_shift(2,62),ee.write_shift(2,3),ee.write_shift(2,65534),ee.write_shift(2,9),ee.write_shift(2,6),re=0;re<3;++re)ee.write_shift(2,0);for(ee.write_shift(4,0),ee.write_shift(4,X[2]),ee.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),ee.write_shift(4,0),ee.write_shift(4,4096),ee.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:I),ee.write_shift(4,X[3]),ee.write_shift(-4,X[1]?X[0]-1:I),ee.write_shift(4,X[1]),re=0;re<109;++re)ee.write_shift(-4,re<X[2]?X[1]+re:-1)}if(X[1])for(xe=0;xe<X[1];++xe){for(;re<236+xe*127;++re)ee.write_shift(-4,re<X[2]?X[1]+re:-1);ee.write_shift(-4,xe===X[1]-1?I:xe+1)}var Te=function(Ve){for(xe+=Ve;re<xe-1;++re)ee.write_shift(-4,re+1);Ve&&(++re,ee.write_shift(-4,I))};for(xe=re=0,xe+=X[1];re<xe;++re)ee.write_shift(-4,K.DIFSECT);for(xe+=X[2];re<xe;++re)ee.write_shift(-4,K.FATSECT);Te(X[3]),Te(X[4]);for(var pe=0,ge=0,ye=V.FileIndex[0];pe<V.FileIndex.length;++pe)ye=V.FileIndex[pe],ye.content&&(ge=ye.content.length,!(ge<4096)&&(ye.start=xe,Te(ge+511>>9)));for(Te(X[6]+7>>3);ee.l&511;)ee.write_shift(-4,K.ENDOFCHAIN);for(xe=re=0,pe=0;pe<V.FileIndex.length;++pe)ye=V.FileIndex[pe],ye.content&&(ge=ye.content.length,!(!ge||ge>=4096)&&(ye.start=xe,Te(ge+63>>6)));for(;ee.l&511;)ee.write_shift(-4,K.ENDOFCHAIN);for(re=0;re<X[4]<<2;++re){var Le=V.FullPaths[re];if(!Le||Le.length===0){for(pe=0;pe<17;++pe)ee.write_shift(4,0);for(pe=0;pe<3;++pe)ee.write_shift(4,-1);for(pe=0;pe<12;++pe)ee.write_shift(4,0);continue}ye=V.FileIndex[re],re===0&&(ye.start=ye.size?ye.start-1:I);var Ue=re===0&&q.root||ye.name;if(ge=2*(Ue.length+1),ee.write_shift(64,Ue,"utf16le"),ee.write_shift(2,ge),ee.write_shift(1,ye.type),ee.write_shift(1,ye.color),ee.write_shift(-4,ye.L),ee.write_shift(-4,ye.R),ee.write_shift(-4,ye.C),ye.clsid)ee.write_shift(16,ye.clsid,"hex");else for(pe=0;pe<4;++pe)ee.write_shift(4,0);ee.write_shift(4,ye.state||0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,ye.start),ee.write_shift(4,ye.size),ee.write_shift(4,0)}for(re=1;re<V.FileIndex.length;++re)if(ye=V.FileIndex[re],ye.size>=4096)if(ee.l=ye.start+1<<9,wt&&Buffer.isBuffer(ye.content))ye.content.copy(ee,ee.l,0,ye.size),ee.l+=ye.size+511&-512;else{for(pe=0;pe<ye.size;++pe)ee.write_shift(1,ye.content[pe]);for(;pe&511;++pe)ee.write_shift(1,0)}for(re=1;re<V.FileIndex.length;++re)if(ye=V.FileIndex[re],ye.size>0&&ye.size<4096)if(wt&&Buffer.isBuffer(ye.content))ye.content.copy(ee,ee.l,0,ye.size),ee.l+=ye.size+63&-64;else{for(pe=0;pe<ye.size;++pe)ee.write_shift(1,ye.content[pe]);for(;pe&63;++pe)ee.write_shift(1,0)}if(wt)ee.l=ee.length;else for(;ee.l<ee.length;)ee.write_shift(1,0);return ee}function A(V,Q){var q=V.FullPaths.map(function(pe){return pe.toUpperCase()}),X=q.map(function(pe){var ge=pe.split("/");return ge[ge.length-(pe.slice(-1)=="/"?2:1)]}),ee=!1;Q.charCodeAt(0)===47?(ee=!0,Q=q[0].slice(0,-1)+Q):ee=Q.indexOf("/")!==-1;var re=Q.toUpperCase(),xe=ee===!0?q.indexOf(re):X.indexOf(re);if(xe!==-1)return V.FileIndex[xe];var Te=!re.match(cl);for(re=re.replace(As,""),Te&&(re=re.replace(cl,"!")),xe=0;xe<q.length;++xe)if((Te?q[xe].replace(cl,"!"):q[xe]).replace(As,"")==re||(Te?X[xe].replace(cl,"!"):X[xe]).replace(As,"")==re)return V.FileIndex[xe];return null}var P=64,I=-2,_="d0cf11e0a1b11ae1",D=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:I,FREESECT:-1,HEADER_SIGNATURE:_,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(V,Q,q){d();var X=L(V,q);c.writeFileSync(Q,X)}function F(V){for(var Q=new Array(V.length),q=0;q<V.length;++q)Q[q]=String.fromCharCode(V[q]);return Q.join("")}function le(V,Q){var q=L(V,Q);switch(Q&&Q.type||"buffer"){case"file":return d(),c.writeFileSync(Q.filename,q),q;case"binary":return typeof q=="string"?q:F(q);case"base64":return kl(typeof q=="string"?q:F(q));case"buffer":if(wt)return Buffer.isBuffer(q)?q:pn(q);case"array":return typeof q=="string"?Vs(q):q}return q}var Ae;function O(V){try{var Q=V.InflateRaw,q=new Q;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)Ae=V;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function G(V,Q){if(!Ae)return at(V,Q);var q=Ae.InflateRaw,X=new q,ee=X._processChunk(V.slice(V.l),X._finishFlushFlag);return V.l+=X.bytesRead,ee}function U(V){return Ae?Ae.deflateRawSync(V):De(V)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(V){var Q=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var ne=typeof Uint8Array<"u",fe=ne?new Uint8Array(256):[],je=0;je<256;++je)fe[je]=ae(je);function z(V,Q){var q=fe[V&255];return Q<=8?q>>>8-Q:(q=q<<8|fe[V>>8&255],Q<=16?q>>>16-Q:(q=q<<8|fe[V>>16&255],q>>>24-Q))}function me(V,Q){var q=Q&7,X=Q>>>3;return(V[X]|(q<=6?0:V[X+1]<<8))>>>q&3}function ie(V,Q){var q=Q&7,X=Q>>>3;return(V[X]|(q<=5?0:V[X+1]<<8))>>>q&7}function ke(V,Q){var q=Q&7,X=Q>>>3;return(V[X]|(q<=4?0:V[X+1]<<8))>>>q&15}function Fe(V,Q){var q=Q&7,X=Q>>>3;return(V[X]|(q<=3?0:V[X+1]<<8))>>>q&31}function he(V,Q){var q=Q&7,X=Q>>>3;return(V[X]|(q<=1?0:V[X+1]<<8))>>>q&127}function Me(V,Q,q){var X=Q&7,ee=Q>>>3,re=(1<<q)-1,xe=V[ee]>>>X;return q<8-X||(xe|=V[ee+1]<<8-X,q<16-X)||(xe|=V[ee+2]<<16-X,q<24-X)||(xe|=V[ee+3]<<24-X),xe&re}function de(V,Q,q){var X=Q&7,ee=Q>>>3;return X<=5?V[ee]|=(q&7)<<X:(V[ee]|=q<<X&255,V[ee+1]=(q&7)>>8-X),Q+3}function We(V,Q,q){var X=Q&7,ee=Q>>>3;return q=(q&1)<<X,V[ee]|=q,Q+1}function et(V,Q,q){var X=Q&7,ee=Q>>>3;return q<<=X,V[ee]|=q&255,q>>>=8,V[ee+1]=q,Q+8}function ht(V,Q,q){var X=Q&7,ee=Q>>>3;return q<<=X,V[ee]|=q&255,q>>>=8,V[ee+1]=q&255,V[ee+2]=q>>>8,Q+16}function Ke(V,Q){var q=V.length,X=2*q>Q?2*q:Q+5,ee=0;if(q>=Q)return V;if(wt){var re=_1(X);if(V.copy)V.copy(re);else for(;ee<V.length;++ee)re[ee]=V[ee];return re}else if(ne){var xe=new Uint8Array(X);if(xe.set)xe.set(V);else for(;ee<q;++ee)xe[ee]=V[ee];return xe}return V.length=X,V}function Je(V){for(var Q=new Array(V),q=0;q<V;++q)Q[q]=0;return Q}function ft(V,Q,q){var X=1,ee=0,re=0,xe=0,Te=0,pe=V.length,ge=ne?new Uint16Array(32):Je(32);for(re=0;re<32;++re)ge[re]=0;for(re=pe;re<q;++re)V[re]=0;pe=V.length;var ye=ne?new Uint16Array(pe):Je(pe);for(re=0;re<pe;++re)ge[ee=V[re]]++,X<ee&&(X=ee),ye[re]=0;for(ge[0]=0,re=1;re<=X;++re)ge[re+16]=Te=Te+ge[re-1]<<1;for(re=0;re<pe;++re)Te=V[re],Te!=0&&(ye[re]=ge[Te+16]++);var Le=0;for(re=0;re<pe;++re)if(Le=V[re],Le!=0)for(Te=z(ye[re],X)>>X-Le,xe=(1<<X+4-Le)-1;xe>=0;--xe)Q[Te|xe<<Le]=Le&15|re<<4;return X}var nt=ne?new Uint16Array(512):Je(512),qe=ne?new Uint16Array(32):Je(32);if(!ne){for(var be=0;be<512;++be)nt[be]=0;for(be=0;be<32;++be)qe[be]=0}(function(){for(var V=[],Q=0;Q<32;Q++)V.push(5);ft(V,qe,32);var q=[];for(Q=0;Q<=143;Q++)q.push(8);for(;Q<=255;Q++)q.push(9);for(;Q<=279;Q++)q.push(7);for(;Q<=287;Q++)q.push(8);ft(q,nt,288)})();var Se=(function(){for(var Q=ne?new Uint8Array(32768):[],q=0,X=0;q<te.length-1;++q)for(;X<te[q+1];++X)Q[X]=q;for(;X<32768;++X)Q[X]=29;var ee=ne?new Uint8Array(259):[];for(q=0,X=0;q<Y.length-1;++q)for(;X<Y[q+1];++X)ee[X]=q;function re(Te,pe){for(var ge=0;ge<Te.length;){var ye=Math.min(65535,Te.length-ge),Le=ge+ye==Te.length;for(pe.write_shift(1,+Le),pe.write_shift(2,ye),pe.write_shift(2,~ye&65535);ye-- >0;)pe[pe.l++]=Te[ge++]}return pe.l}function xe(Te,pe){for(var ge=0,ye=0,Le=ne?new Uint16Array(32768):[];ye<Te.length;){var Ue=Math.min(65535,Te.length-ye);if(Ue<10){for(ge=de(pe,ge,+(ye+Ue==Te.length)),ge&7&&(ge+=8-(ge&7)),pe.l=ge/8|0,pe.write_shift(2,Ue),pe.write_shift(2,~Ue&65535);Ue-- >0;)pe[pe.l++]=Te[ye++];ge=pe.l*8;continue}ge=de(pe,ge,+(ye+Ue==Te.length)+2);for(var Ve=0;Ue-- >0;){var Be=Te[ye];Ve=(Ve<<5^Be)&32767;var He=-1,xt=0;if((He=Le[Ve])&&(He|=ye&-32768,He>ye&&(He-=32768),He<ye))for(;Te[He+xt]==Te[ye+xt]&&xt<250;)++xt;if(xt>2){Be=ee[xt],Be<=22?ge=et(pe,ge,fe[Be+1]>>1)-1:(et(pe,ge,3),ge+=5,et(pe,ge,fe[Be-23]>>5),ge+=3);var dr=Be<8?0:Be-4>>2;dr>0&&(ht(pe,ge,xt-Y[Be]),ge+=dr),Be=Q[ye-He],ge=et(pe,ge,fe[Be]>>3),ge-=3;var ur=Be<4?0:Be-2>>1;ur>0&&(ht(pe,ge,ye-He-te[Be]),ge+=ur);for(var ns=0;ns<xt;++ns)Le[Ve]=ye&32767,Ve=(Ve<<5^Te[ye])&32767,++ye;Ue-=xt-1}else Be<=143?Be=Be+48:ge=We(pe,ge,1),ge=et(pe,ge,fe[Be]),Le[Ve]=ye&32767,++ye}ge=et(pe,ge,0)-1}return pe.l=(ge+7)/8|0,pe.l}return function(pe,ge){return pe.length<8?re(pe,ge):xe(pe,ge)}})();function De(V){var Q=Ee(50+Math.floor(V.length*1.1)),q=Se(V,Q);return Q.slice(0,q)}var st=ne?new Uint16Array(32768):Je(32768),ut=ne?new Uint16Array(32768):Je(32768),Ye=ne?new Uint16Array(128):Je(128),Ht=1,Ce=1;function pt(V,Q){var q=Fe(V,Q)+257;Q+=5;var X=Fe(V,Q)+1;Q+=5;var ee=ke(V,Q)+4;Q+=4;for(var re=0,xe=ne?new Uint8Array(19):Je(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pe=1,ge=ne?new Uint8Array(8):Je(8),ye=ne?new Uint8Array(8):Je(8),Le=xe.length,Ue=0;Ue<ee;++Ue)xe[B[Ue]]=re=ie(V,Q),pe<re&&(pe=re),ge[re]++,Q+=3;var Ve=0;for(ge[0]=0,Ue=1;Ue<=pe;++Ue)ye[Ue]=Ve=Ve+ge[Ue-1]<<1;for(Ue=0;Ue<Le;++Ue)(Ve=xe[Ue])!=0&&(Te[Ue]=ye[Ve]++);var Be=0;for(Ue=0;Ue<Le;++Ue)if(Be=xe[Ue],Be!=0){Ve=fe[Te[Ue]]>>8-Be;for(var He=(1<<7-Be)-1;He>=0;--He)Ye[Ve|He<<Be]=Be&7|Ue<<3}var xt=[];for(pe=1;xt.length<q+X;)switch(Ve=Ye[he(V,Q)],Q+=Ve&7,Ve>>>=3){case 16:for(re=3+me(V,Q),Q+=2,Ve=xt[xt.length-1];re-- >0;)xt.push(Ve);break;case 17:for(re=3+ie(V,Q),Q+=3;re-- >0;)xt.push(0);break;case 18:for(re=11+he(V,Q),Q+=7;re-- >0;)xt.push(0);break;default:xt.push(Ve),pe<Ve&&(pe=Ve);break}var dr=xt.slice(0,q),ur=xt.slice(q);for(Ue=q;Ue<286;++Ue)dr[Ue]=0;for(Ue=X;Ue<30;++Ue)ur[Ue]=0;return Ht=ft(dr,st,286),Ce=ft(ur,ut,30),Q}function cr(V,Q){if(V[0]==3&&!(V[1]&3))return[In(Q),2];for(var q=0,X=0,ee=_1(Q||1<<18),re=0,xe=ee.length>>>0,Te=0,pe=0;(X&1)==0;){if(X=ie(V,q),q+=3,X>>>1)X>>1==1?(Te=9,pe=5):(q=pt(V,q),Te=Ht,pe=Ce);else{q&7&&(q+=8-(q&7));var ge=V[q>>>3]|V[(q>>>3)+1]<<8;if(q+=32,ge>0)for(!Q&&xe<re+ge&&(ee=Ke(ee,re+ge),xe=ee.length);ge-- >0;)ee[re++]=V[q>>>3],q+=8;continue}for(;;){!Q&&xe<re+32767&&(ee=Ke(ee,re+32767),xe=ee.length);var ye=Me(V,q,Te),Le=X>>>1==1?nt[ye]:st[ye];if(q+=Le&15,Le>>>=4,(Le>>>8&255)===0)ee[re++]=Le;else{if(Le==256)break;Le-=257;var Ue=Le<8?0:Le-4>>2;Ue>5&&(Ue=0);var Ve=re+Y[Le];Ue>0&&(Ve+=Me(V,q,Ue),q+=Ue),ye=Me(V,q,pe),Le=X>>>1==1?qe[ye]:ut[ye],q+=Le&15,Le>>>=4;var Be=Le<4?0:Le-2>>1,He=te[Le];for(Be>0&&(He+=Me(V,q,Be),q+=Be),!Q&&xe<Ve&&(ee=Ke(ee,Ve+100),xe=ee.length);re<Ve;)ee[re]=ee[re-He],++re}}}return Q?[ee,q+7>>>3]:[ee.slice(0,re),q+7>>>3]}function at(V,Q){var q=V.slice(V.l||0),X=cr(q,Q);return V.l+=X[1],X[0]}function Kt(V,Q){if(V)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function Sr(V,Q){var q=V;ts(q,0);var X=[],ee=[],re={FileIndex:X,FullPaths:ee};j(re,{root:Q.root});for(var xe=q.length-4;(q[xe]!=80||q[xe+1]!=75||q[xe+2]!=5||q[xe+3]!=6)&&xe>=0;)--xe;q.l=xe+4,q.l+=4;var Te=q.read_shift(2);q.l+=6;var pe=q.read_shift(4);for(q.l=pe,xe=0;xe<Te;++xe){q.l+=20;var ge=q.read_shift(4),ye=q.read_shift(4),Le=q.read_shift(2),Ue=q.read_shift(2),Ve=q.read_shift(2);q.l+=8;var Be=q.read_shift(4),He=l(q.slice(q.l+Le,q.l+Le+Ue));q.l+=Le+Ue+Ve;var xt=q.l;q.l=Be+4,Xn(q,ge,ye,re,He),q.l=xt}return re}function Xn(V,Q,q,X,ee){V.l+=2;var re=V.read_shift(2),xe=V.read_shift(2),Te=o(V);if(re&8257)throw new Error("Unsupported ZIP encryption");for(var pe=V.read_shift(4),ge=V.read_shift(4),ye=V.read_shift(4),Le=V.read_shift(2),Ue=V.read_shift(2),Ve="",Be=0;Be<Le;++Be)Ve+=String.fromCharCode(V[V.l++]);if(Ue){var He=l(V.slice(V.l,V.l+Ue));(He[21589]||{}).mt&&(Te=He[21589].mt),((ee||{})[21589]||{}).mt&&(Te=ee[21589].mt)}V.l+=Ue;var xt=V.slice(V.l,V.l+ge);switch(xe){case 8:xt=G(V,ye);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var dr=!1;re&8&&(pe=V.read_shift(4),pe==134695760&&(pe=V.read_shift(4),dr=!0),ge=V.read_shift(4),ye=V.read_shift(4)),ge!=Q&&Kt(dr,"Bad compressed size: "+Q+" != "+ge),ye!=q&&Kt(dr,"Bad uncompressed size: "+q+" != "+ye),wm(X,Ve,xt,{unsafe:!0,mt:Te})}function Vo(V,Q){var q=Q||{},X=[],ee=[],re=Ee(1),xe=q.compression?8:0,Te=0,pe=0,ge=0,ye=0,Le=0,Ue=V.FullPaths[0],Ve=Ue,Be=V.FileIndex[0],He=[],xt=0;for(pe=1;pe<V.FullPaths.length;++pe)if(Ve=V.FullPaths[pe].slice(Ue.length),Be=V.FileIndex[pe],!(!Be.size||!Be.content||Ve=="Sh33tJ5")){var dr=ye,ur=Ee(Ve.length);for(ge=0;ge<Ve.length;++ge)ur.write_shift(1,Ve.charCodeAt(ge)&127);ur=ur.slice(0,ur.l),He[Le]=VI.buf(Be.content,0);var ns=Be.content;xe==8&&(ns=U(ns)),re=Ee(30),re.write_shift(4,67324752),re.write_shift(2,20),re.write_shift(2,Te),re.write_shift(2,xe),Be.mt?i(re,Be.mt):re.write_shift(4,0),re.write_shift(-4,He[Le]),re.write_shift(4,ns.length),re.write_shift(4,Be.content.length),re.write_shift(2,ur.length),re.write_shift(2,0),ye+=re.length,X.push(re),ye+=ur.length,X.push(ur),ye+=ns.length,X.push(ns),re=Ee(46),re.write_shift(4,33639248),re.write_shift(2,0),re.write_shift(2,20),re.write_shift(2,Te),re.write_shift(2,xe),re.write_shift(4,0),re.write_shift(-4,He[Le]),re.write_shift(4,ns.length),re.write_shift(4,Be.content.length),re.write_shift(2,ur.length),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(4,0),re.write_shift(4,dr),xt+=re.l,ee.push(re),xt+=ur.length,ee.push(ur),++Le}return re=Ee(22),re.write_shift(4,101010256),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,Le),re.write_shift(2,Le),re.write_shift(4,xt),re.write_shift(4,ye),re.write_shift(2,0),Gr([Gr(X),Gr(ee),re])}var Xi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function kk(V,Q){if(V.ctype)return V.ctype;var q=V.name||"",X=q.match(/\.([^\.]+)$/);return X&&Xi[X[1]]||Q&&(X=(q=Q).match(/[\.\\]([^\.\\])+$/),X&&Xi[X[1]])?Xi[X[1]]:"application/octet-stream"}function Pk(V){for(var Q=kl(V),q=[],X=0;X<Q.length;X+=76)q.push(Q.slice(X,X+76));return q.join(`\r
`)+`\r
`}function Ok(V){var Q=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var ye=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(ye.length==1?"0"+ye:ye)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],X=Q.split(`\r
`),ee=0;ee<X.length;++ee){var re=X[ee];if(re.length==0){q.push("");continue}for(var xe=0;xe<re.length;){var Te=76,pe=re.slice(xe,xe+Te);pe.charAt(Te-1)=="="?Te--:pe.charAt(Te-2)=="="?Te-=2:pe.charAt(Te-3)=="="&&(Te-=3),pe=re.slice(xe,xe+Te),xe+=Te,xe<re.length&&(pe+="="),q.push(pe)}}return q.join(`\r
`)}function Dk(V){for(var Q=[],q=0;q<V.length;++q){for(var X=V[q];q<=V.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+V[++q];Q.push(X)}for(var ee=0;ee<Q.length;++ee)Q[ee]=Q[ee].replace(/[=][0-9A-Fa-f]{2}/g,function(re){return String.fromCharCode(parseInt(re.slice(1),16))});return Vs(Q.join(`\r
`))}function Ik(V,Q,q){for(var X="",ee="",re="",xe,Te=0;Te<10;++Te){var pe=Q[Te];if(!pe||pe.match(/^\s*$/))break;var ge=pe.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":X=ge[2].trim();break;case"content-type":re=ge[2].trim();break;case"content-transfer-encoding":ee=ge[2].trim();break}}switch(++Te,ee.toLowerCase()){case"base64":xe=Vs(Xs(Q.slice(Te).join("")));break;case"quoted-printable":xe=Dk(Q.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ee)}var ye=wm(V,X.slice(q.length),xe,{unsafe:!0});re&&(ye.ctype=re)}function Rk(V,Q){if(F(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=Q&&Q.root||"",X=(wt&&Buffer.isBuffer(V)?V.toString("binary"):F(V)).split(`\r
`),ee=0,re="";for(ee=0;ee<X.length;++ee)if(re=X[ee],!!/^Content-Location:/i.test(re)&&(re=re.slice(re.indexOf("file")),q||(q=re.slice(0,re.lastIndexOf("/")+1)),re.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),re.slice(0,q.length)!=q););var xe=(X[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var Te="--"+(xe[1]||""),pe=[],ge=[],ye={FileIndex:pe,FullPaths:ge};j(ye);var Le,Ue=0;for(ee=0;ee<X.length;++ee){var Ve=X[ee];Ve!==Te&&Ve!==Te+"--"||(Ue++&&Ik(ye,X.slice(Le,ee),q),Le=ee)}return ye}function Fk(V,Q){var q=Q||{},X=q.boundary||"SheetJS";X="------="+X;for(var ee=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],re=V.FullPaths[0],xe=re,Te=V.FileIndex[0],pe=1;pe<V.FullPaths.length;++pe)if(xe=V.FullPaths[pe].slice(re.length),Te=V.FileIndex[pe],!(!Te.size||!Te.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(xt){return"_x"+xt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(xt){return"_u"+xt.charCodeAt(0).toString(16)+"_"});for(var ge=Te.content,ye=wt&&Buffer.isBuffer(ge)?ge.toString("binary"):F(ge),Le=0,Ue=Math.min(1024,ye.length),Ve=0,Be=0;Be<=Ue;++Be)(Ve=ye.charCodeAt(Be))>=32&&Ve<128&&++Le;var He=Le>=Ue*4/5;ee.push(X),ee.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+xe),ee.push("Content-Transfer-Encoding: "+(He?"quoted-printable":"base64")),ee.push("Content-Type: "+kk(Te,xe)),ee.push(""),ee.push(He?Ok(ye):Pk(ye))}return ee.push(X+`--\r
`),ee.join(`\r
`)}function Lk(V){var Q={};return j(Q,V),Q}function wm(V,Q,q,X){var ee=X&&X.unsafe;ee||j(V);var re=!ee&&rt.find(V,Q);if(!re){var xe=V.FullPaths[0];Q.slice(0,xe.length)==xe?xe=Q:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+Q).replace("//","/")),re={name:n(Q),type:2},V.FileIndex.push(re),V.FullPaths.push(xe),ee||rt.utils.cfb_gc(V)}return re.content=q,re.size=q?q.length:0,X&&(X.CLSID&&(re.clsid=X.CLSID),X.mt&&(re.mt=X.mt),X.ct&&(re.ct=X.ct)),re}function Mk(V,Q){j(V);var q=rt.find(V,Q);if(q){for(var X=0;X<V.FileIndex.length;++X)if(V.FileIndex[X]==q)return V.FileIndex.splice(X,1),V.FullPaths.splice(X,1),!0}return!1}function Bk(V,Q,q){j(V);var X=rt.find(V,Q);if(X){for(var ee=0;ee<V.FileIndex.length;++ee)if(V.FileIndex[ee]==X)return V.FileIndex[ee].name=n(q),V.FullPaths[ee]=q,!0}return!1}function $k(V){C(V,!0)}return t.find=A,t.read=N,t.parse=u,t.write=le,t.writeFile=J,t.utils={cfb_new:Lk,cfb_add:wm,cfb_del:Mk,cfb_mov:Bk,cfb_gc:$k,ReadShift:hl,CheckField:SS,prep_blob:ts,bconcat:Gr,use_zlib:O,_deflateRaw:De,_inflateRaw:at,consts:K},t})();function GI(e){return typeof e=="string"?Iu(e):Array.isArray(e)?vI(e):e}function cc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Iu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?za(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([GI(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Un(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function qI(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function jr(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function L1(e,t){for(var r=[],s=jr(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function Fu(e){for(var t=[],r=jr(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Lu(e){for(var t=[],r=jr(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function KI(e){for(var t=[],r=jr(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var kd=new Date(1899,11,30,0,0,0);function Br(e,t){var r=e.getTime(),s=kd.getTime()+(e.getTimezoneOffset()-kd.getTimezoneOffset())*6e4;return(r-s)/(1440*60*1e3)}var sS=new Date,YI=kd.getTime()+(sS.getTimezoneOffset()-kd.getTimezoneOffset())*6e4,M1=sS.getTimezoneOffset();function Mu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+YI),t.getTimezoneOffset()!==M1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-M1)*6e4),t}function XI(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(s=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var B1=new Date("2017-02-19T19:06:09.000Z"),aS=isNaN(B1.getFullYear())?new Date("2/19/17"):B1,JI=aS.getFullYear()==2017;function rr(e,t){var r=new Date(e);if(JI)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(aS.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ei(e,t){if(wt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return za(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return za(VN(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return za(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return za(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function sr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=sr(e[r]));return t}function vr(e,t){for(var r="";r.length<t;)r+=e;return r}function Pa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(s)))?t/r:t}var ZI=["january","february","march","april","may","june","july","august","september","october","november","december"];function xo(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&ZI.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||i>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var QI=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var i=r.split(s),o=[i[0]],l=1;l<i.length;++l)o.push(n),o.push(i[l]);return o}})();function nS(e){return e?e.content&&e.type?Ei(e.content,!0):e.data?ll(e.data):e.asNodeBuffer&&wt?ll(e.asNodeBuffer().toString("binary")):e.asBinary?ll(e.asBinary()):e._data&&e._data.getContent?ll(Ei(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function iS(e){if(!e)return null;if(e.data)return A1(e.data);if(e.asNodeBuffer&&wt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?A1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function e6(e){return e&&e.name.slice(-4)===".bin"?iS(e):nS(e)}function ca(e,t){for(var r=e.FullPaths||jr(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==o||n==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function jx(e,t){var r=ca(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Or(e,t,r){if(!r)return e6(jx(e,t));if(!t)return null;try{return Or(e,t)}catch{return null}}function Gs(e,t,r){if(!r)return nS(jx(e,t));if(!t)return null;try{return Gs(e,t)}catch{return null}}function t6(e,t,r){return iS(jx(e,t))}function $1(e){for(var t=e.FullPaths||jr(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function yt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return wt?s=pn(r):s=bI(r),rt.utils.cfb_add(e,t,s)}rt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Nx(){return rt.utils.cfb_new()}function oS(e,t){switch(t.type){case"base64":return rt.read(e,{type:"base64"});case"binary":return rt.read(e,{type:"binary"});case"buffer":case"array":return rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function dl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var _r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,r6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,z1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,s6=/<[^>]*>/g,vs=_r.match(z1)?z1:s6,a6=/<\w*:/,n6=/<(\/?)\w+:/;function dt(e,t,r){for(var s={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var o=e.match(r6),l=0,c="",d=0,u="",m="",f=1;if(o)for(d=0;d!=o.length;++d){for(m=o[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(u=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(f=(n=m.charCodeAt(i+1))==34||n==39?1:0,c=m.slice(i+1+f,m.length-f),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),s[u]=c,s[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(s[h]&&u.slice(l-3,l)=="ext")continue;s[h]=c,s[h.toLowerCase()]=c}}return s}function qa(e){return e.replace(n6,"<$1")}var lS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sx=Fu(lS),Ct=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(l,c){return lS[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,o)+r(n.slice(o+3))}})(),Ex=/[&<>'"]/g,i6=/[\u0000-\u0008\u000b-\u001f]/g;function Ut(e){var t=e+"";return t.replace(Ex,function(r){return Sx[r]}).replace(i6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function U1(e){return Ut(e).replace(/ /g,"_x0020_")}var cS=/[\u0000-\u001f]/g;function Tx(e){var t=e+"";return t.replace(Ex,function(r){return Sx[r]}).replace(/\n/g,"<br/>").replace(cS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function o6(e){var t=e+"";return t.replace(Ex,function(r){return Sx[r]}).replace(cS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var W1=(function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}})();function l6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function er(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Pm(e){for(var t="",r=0,s=0,n=0,i=0,o=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((s&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function H1(e){var t=In(2*e.length),r,s,n=1,i=0,o=0,l;for(s=0;s<e.length;s+=n)n=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function V1(e){return pn(e,"binary").toString("utf8")}var $c="foo bar baz",Gt=wt&&(V1($c)==Pm($c)&&V1||H1($c)==Pm($c)&&H1)||Pm,za=wt?function(e){return pn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},Ol=(function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}})(),dS=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}})(),c6=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),d6=/<\/?(?:vt:)?variant>/g,u6=/<(?:vt:)([^>]*)>([\s\S]*)</;function G1(e,t){var r=dt(e),s=e.match(c6(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(i){var o=i.replace(d6,"").match(u6);o&&n.push({v:Gt(o[2]),t:o[1]})}),n}var uS=/(^\s|\s$|\n)/;function ss(e,t){return"<"+e+(t.match(uS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Dl(e){return jr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function $e(e,t,r){return"<"+e+(r!=null?Dl(r):"")+(t!=null?(t.match(uS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Zh(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function m6(e,t){switch(typeof e){case"string":var r=$e("vt:lpwstr",Ut(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return $e((e|0)==e?"vt:i4":"vt:r8",Ut(String(e)));case"boolean":return $e("vt:bool",e?"true":"false")}if(e instanceof Date)return $e("vt:filetime",Zh(e));throw new Error("Unable to serialize "+e)}function Ax(e){if(wt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Gt(Un(bx(e)));throw new Error("Bad input format: expected Buffer or string")}var Il=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Lr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Bi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ws={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function f6(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function h6(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=s?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|s}var q1=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,i=e[0][s].length;n<i;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},K1=wt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:pn(t)})):q1(e)}:q1,Y1=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(Za(e,n)));return s.join("").replace(As,"")},Cx=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(As,""):Y1(e,t,r)}:Y1,X1=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},mS=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):X1(e,t,r)}:X1,J1=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(ro(e,n)));return s.join("")},dc=wt?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):J1(t,r,s)}:J1,fS=function(e,t){var r=Hs(e,t);return r>0?dc(e,t+4,t+4+r-1):""},hS=fS,pS=function(e,t){var r=Hs(e,t);return r>0?dc(e,t+4,t+4+r-1):""},xS=pS,gS=function(e,t){var r=2*Hs(e,t);return r>0?dc(e,t+4,t+4+r-1):""},vS=gS,bS=function(t,r){var s=Hs(t,r);return s>0?Cx(t,r+4,r+4+s):""},yS=bS,wS=function(e,t){var r=Hs(e,t);return r>0?dc(e,t+4,t+4+r):""},jS=wS,NS=function(e,t){return f6(e,t)},Pd=NS,_x=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};wt&&(hS=function(t,r){if(!Buffer.isBuffer(t))return fS(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},xS=function(t,r){if(!Buffer.isBuffer(t))return pS(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},vS=function(t,r){if(!Buffer.isBuffer(t))return gS(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},yS=function(t,r){if(!Buffer.isBuffer(t))return bS(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},jS=function(t,r){if(!Buffer.isBuffer(t))return wS(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Pd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):NS(t,r)},_x=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ro=function(e,t){return e[t]},Za=function(e,t){return e[t+1]*256+e[t]},p6=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Hs=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ai=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},x6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function hl(e,t){var r="",s,n,i=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Za(this,d)),d+=2;e*=2;break;case"utf8":r=dc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Cx(this,this.l,this.l+e);break;case"wstr":return hl.call(this,e,"dbcs");case"lpstr-ansi":r=hS(this,this.l),e=4+Hs(this,this.l);break;case"lpstr-cp":r=xS(this,this.l),e=4+Hs(this,this.l);break;case"lpwstr":r=vS(this,this.l),e=4+2*Hs(this,this.l);break;case"lpp4":e=4+Hs(this,this.l),r=yS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Hs(this,this.l),r=jS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=ro(this,this.l+e++))!==0;)i.push(Bc(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Za(this,this.l+e))!==0;)i.push(Bc(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ro(this,d),this.l=d+1,l=hl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Bc(Za(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ro(this,d),this.l=d+1,l=hl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Bc(ro(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return s=ro(this,this.l),this.l++,s;case 2:return s=(t==="i"?p6:Za)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(s=(e>0?ai:x6)(this,this.l),this.l+=4,s):(n=Hs(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Pd(this,this.l):n=Pd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=mS(this,this.l,e);break}}return this.l+=e,r}var g6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},v6=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},b6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function y6(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)b6(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,g6(this,t,this.l);break;case 8:if(s=8,r==="f"){h6(this,t,this.l);break}case 16:break;case-4:s=4,v6(this,t,this.l);break}return this.l+=s,this}function SS(e,t){var r=mS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ts(e,t){e.l=t,e.read_shift=hl,e.chk=SS,e.write_shift=y6}function gs(e,t){e.l+=t}function Ee(e){var t=In(e);return ts(t,0),t}function xn(e,t,r){if(e){var s,n,i;ts(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=$l[l]||$l[65535];for(s=e.read_shift(1),i=s&127,n=1;n<4&&s&128;++n)i+=((s=e.read_shift(1))&127)<<7*n;c=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=c,t(u,d,l))return}}}function Ls(){var e=[],t=wt?256:2048,r=function(d){var u=Ee(d);return ts(u,0),u},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},i=function(d){return s&&d<s.length-s.l?s:(n(),s=r(Math.max(d+1,t)))},o=function(){return n(),Gr(e)},l=function(d){n(),s=d,s.l==null&&(s.l=s.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function Oe(e,t,r,s){var n=+t,i;if(!isNaN(n)){s||(s=$l[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=e.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&_x(r)&&e.push(r)}}function pl(e,t,r){var s=sr(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Z1(e,t,r){var s=sr(e);return s.s=pl(s.s,t.s,r),s.e=pl(s.e,t.s,r),s}function xl(e,t){if(e.cRel&&e.c<0)for(e=sr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=sr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ct(e);return!e.cRel&&e.cRel!=null&&(r=N6(r)),!e.rRel&&e.rRel!=null&&(r=w6(r)),r}function Om(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+mr(e.s.c)+":"+(e.e.cRel?"":"$")+mr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Cr(e.s.r)+":"+(e.e.rRel?"":"$")+Cr(e.e.r):xl(e.s,t.biff)+":"+xl(e.e,t.biff)}function kx(e){return parseInt(j6(e),10)-1}function Cr(e){return""+(e+1)}function w6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function j6(e){return e.replace(/\$(\d+)$/,"$1")}function Px(e){for(var t=S6(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function mr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function N6(e){return e.replace(/^([A-Z])/,"$$$1")}function S6(e){return e.replace(/^\$([A-Z])/,"$1")}function E6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function fr(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function ct(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ms(e){var t=e.indexOf(":");return t==-1?{s:fr(e),e:fr(e)}:{s:fr(e.slice(0,t)),e:fr(e.slice(t+1))}}function vt(e,t){return typeof t>"u"||typeof t=="number"?vt(e.s,e.e):(typeof e!="string"&&(e=ct(e)),typeof t!="string"&&(t=ct(t)),e==t?e:e+":"+t)}function _t(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,i=e.length;for(r=0;s<i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function Q1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ga(e.z,r?Br(t):t)}catch{}try{return e.w=ga((e.XF||{}).numFmtId||(r?14:0),r?Br(t):t)}catch{return""+t}}function dn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?gn[e.v]||e.v:t==null?Q1(e,e.v):Q1(e,t))}function Wn(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function ES(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,i=e||(n?[]:{}),o=0,l=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?fr(s.origin):s.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=_t(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[m].length;++f)if(!(typeof t[m][f]>"u")){var h={v:t[m][f]},p=o+m,x=l+f;if(d.s.r>p&&(d.s.r=p),d.s.c>x&&(d.s.c=x),d.e.r<p&&(d.e.r=p),d.e.c<x&&(d.e.c=x),t[m][f]&&typeof t[m][f]=="object"&&!Array.isArray(t[m][f])&&!(t[m][f]instanceof Date))h=t[m][f];else if(Array.isArray(h.v)&&(h.f=t[m][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(s.nullError)h.t="e",h.v=0;else if(s.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=s.dateNF||ot[14],s.cellDates?(h.t="d",h.w=ga(h.z,Br(h.v))):(h.t="n",h.v=Br(h.v),h.w=ga(h.z,h.v))):h.t="s";if(n)i[p]||(i[p]=[]),i[p][x]&&i[p][x].z&&(h.z=i[p][x].z),i[p][x]=h;else{var g=ct({c:x,r:p});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return d.s.c<1e7&&(i["!ref"]=vt(d)),i}function Io(e,t){return ES(null,e,t)}function T6(e){return e.read_shift(4,"i")}function Oa(e,t){return t||(t=Ee(4)),t.write_shift(4,e),t}function ps(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function qr(e,t){var r=!1;return t==null&&(r=!0,t=Ee(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function A6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function C6(e,t){return t||(t=Ee(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ox(e,t){var r=e.l,s=e.read_shift(1),n=ps(e),i=[],o={t:n,h:n};if((s&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(A6(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function _6(e,t){var r=!1;return t==null&&(r=!0,t=Ee(15+4*e.t.length)),t.write_shift(1,0),qr(e.t,t),r?t.slice(0,t.l):t}var k6=Ox;function P6(e,t){var r=!1;return t==null&&(r=!0,t=Ee(23+4*e.t.length)),t.write_shift(1,1),qr(e.t,t),t.write_shift(4,1),C6({},t),r?t.slice(0,t.l):t}function ya(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function $i(e,t){return t==null&&(t=Ee(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function zi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ui(e,t){return t==null&&(t=Ee(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var O6=ps,TS=qr;function Dx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Od(e,t){var r=!1;return t==null&&(r=!0,t=Ee(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var D6=ps,Qh=Dx,Ix=Od;function Rx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Pd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ai(t,0)>>2;return r?n/100:n}function AS(e,t){t==null&&(t=Ee(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function CS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function I6(e,t){return t||(t=Ee(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Wi=CS,Ro=I6;function hs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ti(e,t){return(t||Ee(8)).write_shift(8,e,"f")}function R6(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var d=fi[n];d&&(t.rgb=Fl(d));break;case 2:t.rgb=Fl([o,l,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Dd(e,t){if(t||(t=Ee(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function F6(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function L6(e,t){t||(t=Ee(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function _S(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function M6(e){return _S(e,1)}function B6(e){return _S(e,2)}var Fx=2,Ps=3,zc=11,eb=12,Id=19,Uc=64,$6=65,z6=71,U6=4108,W6=4126,Hr=80,kS=81,H6=[Hr,kS],ep={1:{n:"CodePage",t:Fx},2:{n:"Category",t:Hr},3:{n:"PresentationFormat",t:Hr},4:{n:"ByteCount",t:Ps},5:{n:"LineCount",t:Ps},6:{n:"ParagraphCount",t:Ps},7:{n:"SlideCount",t:Ps},8:{n:"NoteCount",t:Ps},9:{n:"HiddenCount",t:Ps},10:{n:"MultimediaClipCount",t:Ps},11:{n:"ScaleCrop",t:zc},12:{n:"HeadingPairs",t:U6},13:{n:"TitlesOfParts",t:W6},14:{n:"Manager",t:Hr},15:{n:"Company",t:Hr},16:{n:"LinksUpToDate",t:zc},17:{n:"CharacterCount",t:Ps},19:{n:"SharedDoc",t:zc},22:{n:"HyperlinksChanged",t:zc},23:{n:"AppVersion",t:Ps,p:"version"},24:{n:"DigSig",t:$6},26:{n:"ContentType",t:Hr},27:{n:"ContentStatus",t:Hr},28:{n:"Language",t:Hr},29:{n:"Version",t:Hr},255:{},2147483648:{n:"Locale",t:Id},2147483651:{n:"Behavior",t:Id},1919054434:{}},tp={1:{n:"CodePage",t:Fx},2:{n:"Title",t:Hr},3:{n:"Subject",t:Hr},4:{n:"Author",t:Hr},5:{n:"Keywords",t:Hr},6:{n:"Comments",t:Hr},7:{n:"Template",t:Hr},8:{n:"LastAuthor",t:Hr},9:{n:"RevNumber",t:Hr},10:{n:"EditTime",t:Uc},11:{n:"LastPrinted",t:Uc},12:{n:"CreatedDate",t:Uc},13:{n:"ModifiedDate",t:Uc},14:{n:"PageCount",t:Ps},15:{n:"WordCount",t:Ps},16:{n:"CharCount",t:Ps},17:{n:"Thumbnail",t:z6},18:{n:"Application",t:Hr},19:{n:"DocSecurity",t:Ps},255:{},2147483648:{n:"Locale",t:Id},2147483651:{n:"Behavior",t:Id},1919054434:{}},tb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},V6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function G6(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var q6=G6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fi=sr(q6),gn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},PS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},rp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Wc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Lx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function K6(e){var t=Lx();if(!e||!e.match)return t;var r={};if((e.match(vs)||[]).forEach(function(s){var n=dt(s);switch(n[0].replace(a6,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[rp[n.ContentType]]!==void 0&&t[rp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Lr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function OS(e,t){var r=KI(rp),s=[],n;s[s.length]=_r,s[s.length]=$e("Types",null,{xmlns:Lr.CT,"xmlns:xsd":Lr.xsd,"xmlns:xsi":Lr.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return $e("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],s[s.length]=$e("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Wc[c][t.bookType]||Wc[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){s[s.length]=$e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Wc[c][t.bookType]||Wc[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){s[s.length]=$e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Rl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function gl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(vs)||[]).forEach(function(n){var i=dt(n);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:dl(i.Target,t);r[l]=o,s[i.Id]=o}}),r["!id"]=s,r}function oo(e){var t=[_r,$e("Relationships",null,{xmlns:Lr.RELS})];return jr(e["!id"]).forEach(function(r){t[t.length]=$e("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Bt(e,t,r,s,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[jt.HLINK,jt.XPATH,jt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var Y6="application/vnd.oasis.opendocument.spreadsheet";function X6(e,t){for(var r=Ax(e),s,n;s=Il.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=dt(s[0],!1),n.path=="/"&&n.type!==Y6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function J6(e){var t=[_r];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function rb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Z6(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Q6(e){var t=[_r];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(rb(e[r][0],e[r][1])),t.push(Z6("",e[r][0]));return t.push(rb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function DS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Td.version+"</meta:generator></office:meta></office:document-meta>"}var pa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],eR=(function(){for(var e=new Array(pa.length),t=0;t<pa.length;++t){var r=pa[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e})();function IS(e){var t={};e=Gt(e);for(var r=0;r<pa.length;++r){var s=pa[r],n=e.match(eR[r]);n!=null&&n.length>0&&(t[s[1]]=Ct(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=rr(t[s[1]]))}return t}function Dm(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Ut(t),s[s.length]=r?$e(e,t,r):ss(e,t))}function RS(e,t){var r=t||{},s=[_r,$e("cp:coreProperties",null,{"xmlns:cp":Lr.CORE_PROPS,"xmlns:dc":Lr.dc,"xmlns:dcterms":Lr.dcterms,"xmlns:dcmitype":Lr.dcmitype,"xmlns:xsi":Lr.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&Dm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Zh(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&Dm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Zh(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var i=0;i!=pa.length;++i){var o=pa[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Dm(o[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var hi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],FS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function LS(e,t,r,s){var n=[];if(typeof e=="string")n=G1(e,s);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?G1(t,s).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var d=0;d!==n.length;d+=2){switch(c=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function tR(e,t,r){var s={};return t||(t={}),e=Gt(e),hi.forEach(function(n){var i=(e.match(Ol(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Ct(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(s[n[1]]=o[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&LS(s.HeadingPairs,s.TitlesOfParts,t,r),t}function MS(e){var t=[],r=$e;return e||(e={}),e.Application="SheetJS",t[t.length]=_r,t[t.length]=$e("Properties",null,{xmlns:Lr.EXT_PROPS,"xmlns:vt":Lr.vt}),hi.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=Ut(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+Ut(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var rR=/<[^>]+>[^<]*/g;function sR(e,t){var r={},s="",n=e.match(rR);if(n)for(var i=0;i!=n.length;++i){var o=n[i],l=dt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":s=Ct(l.name);break;case"</property>":s=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[s]=Ct(u);break;case"bool":r[s]=er(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(u);break;case"filetime":case"date":r[s]=rr(u);break;case"cy":case"error":r[s]=Ct(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function BS(e){var t=[_r,$e("Properties",null,{xmlns:Lr.CUST_PROPS,"xmlns:vt":Lr.vt})];if(!e)return t.join("");var r=1;return jr(e).forEach(function(n){++r,t[t.length]=$e("property",m6(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ut(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var sp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Im;function aR(e,t,r){Im||(Im=Fu(sp)),t=Im[t]||t,e[t]=r}function nR(e,t){var r=[];return jr(sp).map(function(s){for(var n=0;n<pa.length;++n)if(pa[n][1]==s)return pa[n];for(n=0;n<hi.length;++n)if(hi[n][1]==s)return hi[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(ss(sp[s[1]]||s[1],n))}}),$e("DocumentProperties",r.join(""),{xmlns:Ws.o})}function iR(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&jr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<pa.length;++o)if(i==pa[o][1])return;for(o=0;o<hi.length;++o)if(i==hi[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push($e(U1(i),l,{"dt:dt":c}))}}),t&&jr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push($e(U1(i),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+Ws.o+'">'+n.join("")+"</"+s+">"}function Mx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function oR(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),n+=i);var o=Ee(8);return o.write_shift(4,s),o.write_shift(4,n),o}function $S(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function zS(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function US(e,t,r){return t===31?zS(e):$S(e,t,r)}function ap(e,t,r){return US(e,t,r===!1?0:4)}function lR(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return US(e,t,0)}function cR(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(As,""),e.l-n&2&&(e.l+=2)}return r}function dR(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(As,"");return r}function uR(e){var t=e.l,r=Rd(e,kS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=Rd(e,Ps);return[r,s]}function mR(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(uR(e));return r}function sb(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var i=e.read_shift(4),o=e.read_shift(4);s[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(As,"").replace(cl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function WS(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function fR(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Rd(e,t,r){var s=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==eb&&s!==t&&H6.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===eb?s:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return $S(e,s,4).replace(As,"");case 31:return zS(e);case 64:return Mx(e);case 65:return WS(e);case 71:return fR(e);case 80:return ap(e,s,!i.raw).replace(As,"");case 81:return lR(e,s).replace(As,"");case 4108:return mR(e);case 4126:case 4127:return s==4127?cR(e):dR(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function ab(e,t){var r=Ee(4),s=Ee(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=Ee(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=oR(t);break;case 31:case 80:for(s=Ee(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Gr([r,s])}function nb(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=n;++o){var u=e.read_shift(4),m=e.read_shift(4);i[o]=[u,m+r]}i.sort(function(w,y){return w[1]-y[1]});var f={};for(o=0;o!=n;++o){if(e.l!==i[o][1]){var h=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(h=!1,e.l=i[o][1]),h)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var p=t[i[o][0]];if(f[p.n]=Rd(e,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ca(l=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(i[o][0]===1){if(l=f.CodePage=Rd(e,Fx),Ca(l),c!==-1){var x=e.l;e.l=i[c][1],d=sb(e,l),e.l=x}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}d=sb(e,l)}else{var g=d[i[o][0]],v;switch(e[e.l]){case 65:e.l+=4,v=WS(e);break;case 30:e.l+=4,v=ap(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=ap(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Er(e,4);break;case 64:e.l+=4,v=rr(Mx(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[g]=v}}return e.l=r+s,f}var HS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function hR(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ib(e,t,r){var s=Ee(8),n=[],i=[],o=8,l=0,c=Ee(8),d=Ee(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),n.push(d),o+=8+c.length,!t){d=Ee(8),d.write_shift(4,0),n.unshift(d);var u=[Ee(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(c=Ee(8+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Gr(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(HS.indexOf(e[l][0])>-1||FS.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],h=0;if(t){h=+t[e[l][0]];var p=r[h];if(p.p=="version"&&typeof f=="string"){var x=f.split(".");f=(+x[0]<<16)+(+x[1]||0)}c=ab(p.t,f)}else{var g=hR(f);g==-1&&(g=31,f=String(f)),c=ab(g,f)}i.push(c),d=Ee(8),d.write_shift(4,t?h:2+l),n.push(d),o+=8+c.length}var v=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,v),v+=i[l].length;return s.write_shift(4,o),s.write_shift(4,i.length),Gr([s].concat(n).concat(i))}function ob(e,t,r){var s=e.content;if(!s)return{};ts(s,0);var n,i,o,l,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var d=s.read_shift(4),u=s.read_shift(16);if(u!==rt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=s.read_shift(16),l=s.read_shift(4),n===1&&l!==s.l)throw new Error("Length mismatch: "+l+" !== "+s.l);n===2&&(o=s.read_shift(16),c=s.read_shift(4));var m=nb(s,t),f={SystemIdentifier:d};for(var h in m)f[h]=m[h];if(f.FMTID=i,n===1)return f;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var p;try{p=nb(s,null)}catch{}for(h in p)f[h]=p[h];return f.FMTID=[i,o],f}function lb(e,t,r,s,n,i){var o=Ee(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,rt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var c=ib(e,r,s);if(l.push(c),n){var d=ib(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Gr(l)}function Tn(e,t){return e.read_shift(t),null}function pR(e,t){t||(t=Ee(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function xR(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function Er(e,t){return e.read_shift(t)===1}function js(e,t){return t||(t=Ee(2)),t.write_shift(2,+!!e),t}function Dr(e){return e.read_shift(2,"u")}function da(e,t){return t||(t=Ee(2)),t.write_shift(2,e),t}function VS(e,t){return xR(e,t,Dr)}function gR(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function GS(e,t,r){return r||(r=Ee(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function uc(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=s?e.read_shift(s,n):"";return o}function vR(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,i=1+(r&1),o=0,l,c={};n&&(o=e.read_shift(2)),s&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return n&&(e.l+=4*o),s&&(e.l+=l),c.t=u,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function bR(e){var t=e.t||"",r=Ee(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=Ee(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return Gr(n)}function Ai(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function mc(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):Ai(e,s,r)}function Hi(e,t,r){if(r.biff>5)return mc(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function qS(e,t,r){return r||(r=Ee(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function yR(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function wR(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(As,"");return s&&(e.l+=24),n}function jR(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(As,"");return r+o}function NR(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return wR(e);case"0303000000000000c000000000000046":return jR(e);default:throw new Error("Unsupported Moniker "+r)}}function Hc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(As,""):"";return r}function cb(e,t){t||(t=Ee(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function SR(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var i,o,l,c,d="",u,m;n&16&&(i=Hc(e,r-e.l)),n&128&&(o=Hc(e,r-e.l)),(n&257)===257&&(l=Hc(e,r-e.l)),(n&257)===1&&(c=NR(e,r-e.l)),n&8&&(d=Hc(e,r-e.l)),n&32&&(u=e.read_shift(16)),n&64&&(m=Mx(e)),e.l=r;var f=o||l||c||"";f&&d&&(f+="#"+d),f||(f="#"+d),n&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return u&&(h.guid=u),m&&(h.time=m),i&&(h.Tooltip=i),h}function ER(e){var t=Ee(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),i=n>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)s=s.slice(1),cb(s,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&cb(n>-1?s.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,s.length-3*c+1),r=0;r<s.length-3*c;++r)t.write_shift(1,s.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function KS(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function YS(e,t){var r=KS(e);return r[3]=0,r}function Ka(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function Ci(e,t,r,s){return s||(s=Ee(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function TR(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function AR(e,t,r){return t===0?"":Hi(e,t,r)}function CR(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),i=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[n,i,o]}function XS(e){var t=e.read_shift(2),r=Rx(e);return[t,r]}function _R(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=uc(e,t,r),i=e.read_shift(2);if(s-=e.l,i!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return e.l+=i,n}function Bu(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function JS(e,t){return t||(t=Ee(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ZS(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var kR=ZS;function QS(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function PR(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function OR(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function is(e){e.l+=2,e.l+=e.read_shift(2)}var DR={0:is,4:is,5:is,6:is,7:OR,8:is,9:is,10:is,11:is,12:is,13:PR,14:is,15:is,16:is,17:is,18:is,19:is,20:is,21:QS};function IR(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(DR[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function Vc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Bx(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ee(n);return i.write_shift(2,s),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function RR(e,t){return t===0||e.read_shift(2),1200}function FR(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=Hi(e,0,r);return e.read_shift(t+s-e.l),n}function LR(e,t){var r=!t||t.biff==8,s=Ee(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function MR(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function BR(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=uc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:s,hs:n,dt:i,name:o}}function $R(e,t){var r=!t||t.biff>=8?2:1,s=Ee(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function zR(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),i=[],o=0;o!=n&&e.l<r;++o)i.push(vR(e));return i.Count=s,i.Unique=n,i}function UR(e,t){var r=Ee(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=bR(e[n]);var i=Gr([r].concat(s));return i.parts=[r.length].concat(s.map(function(o){return o.length})),i}function WR(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function HR(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function VR(e){var t=TR(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function GR(e){return e.read_shift(2),e.read_shift(4)}function db(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var i={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[i,n]}function qR(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function KR(){var e=Ee(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function YR(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function XR(e){var t=Ee(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function JR(){}function ZR(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=uc(e,0,r),s}function QR(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,i=Ee(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),i}function e8(e){var t=Ka(e);return t.isst=e.read_shift(4),t}function t8(e,t,r,s){var n=Ee(10);return Ci(e,t,s,n),n.write_shift(4,r),n}function r8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=Ka(e);r.biff==2&&e.l++;var i=mc(e,s-e.l,r);return n.val=i,n}function s8(e,t,r,s,n){var i=!n||n.biff==8,o=Ee(8+ +i+(1+i)*r.length);return Ci(e,t,s,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function a8(e,t,r){var s=e.read_shift(2),n=Hi(e,0,r);return[s,n]}function n8(e,t,r,s){var n=r&&r.biff==5;s||(s=Ee(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}var i8=Hi;function ub(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=s,{s:{r:i,c:l},e:{r:o,c}}}function o8(e,t){var r=t.biff==8||!t.biff?4:2,s=Ee(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function l8(e){var t=e.read_shift(2),r=e.read_shift(2),s=XS(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function c8(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(XS(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:o,rkrec:i}}function d8(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:o,ixfe:i}}function u8(e,t,r,s){var n={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=V6[l>>26],s.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function m8(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=u8(e,t,s.fStyle,r),s}function mb(e,t,r,s){var n=r&&r.biff==5;s||(s=Ee(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function f8(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function h8(e){var t=Ee(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function fb(e,t,r){var s=Ka(e);(r.biff==2||t==9)&&++e.l;var n=gR(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function p8(e,t,r,s,n,i){var o=Ee(8);return Ci(e,t,s,o),GS(r,i,o),o}function x8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=Ka(e),n=hs(e);return s.val=n,s}function g8(e,t,r,s){var n=Ee(14);return Ci(e,t,s,n),Ti(r,n),n}var hb=AR;function v8(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Ai(e,i),l=[];s>e.l;)l.push(mc(e));return[i,n,o,l]}function pb(e,t,r){var s=e.read_shift(2),n,i={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=_R(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var b8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function xb(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Ai(e,o,r);n&32&&(d=b8[d.charCodeAt(0)]);var u=s-e.l;r&&r.biff==2&&--u;var m=s==e.l||l===0||!(u>0)?[]:IB(e,u,r,l);return{chKey:i,Name:d,itab:c,rgce:m}}function eE(e,t,r){if(r.biff<8)return y8(e,t,r);for(var s=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)s.push(CR(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function y8(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=uc(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function w8(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),i=Ai(e,s,r),o=Ai(e,n,r);return[i,o]}function j8(e,t,r){var s=ZS(e);e.l++;var n=e.read_shift(1);return t-=8,[RB(e,t,r),n,s]}function gb(e,t,r){var s=kR(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,OB(e,t,r)]}function N8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function S8(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Hi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},l,o,i]}}function E8(e,t,r){return S8(e,t,r)}function T8(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(Bu(e));return r}function A8(e){var t=Ee(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)JS(e[r],t);return t}function C8(e,t,r){if(r&&r.biff<8)return k8(e,t,r);var s=QS(e),n=IR(e,t-22,s[1]);return{cmo:s,ft:n}}var _8={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function k8(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((_8[s]||gs)(e,t,r)),{cmo:[n,s,i],ft:o}}function P8(e,t,r){var s=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=yR(e,6,r);var l=e.read_shift(2);e.read_shift(2),Dr(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-s!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],m=Ai(e,e.lens[d+1]-e.lens[d]-1);if(n+=m,n.length>=(u?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function O8(e,t){var r=Bu(e);e.l+=16;var s=SR(e,t-24);return[r,s]}function D8(e){var t=Ee(24),r=fr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return Gr([t,ER(e[1])])}function I8(e,t){e.read_shift(2);var r=Bu(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(As,""),[r,s]}function R8(e){var t=e[1].Tooltip,r=Ee(10+2*(t.length+1));r.write_shift(2,2048);var s=fr(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function F8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=tb[r]||r,r=e.read_shift(2),t[1]=tb[r]||r,t}function L8(e){return e||(e=Ee(4)),e.write_shift(2,1),e.write_shift(2,1),e}function M8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(YS(e));return r}function B8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(YS(e));return r}function $8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function tE(e,t,r){if(!r.cellStyles)return gs(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),c=e.read_shift(2);s==2&&(e.l+=2);var d={s:n,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function z8(e,t){var r=Ee(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function U8(e,t){var r={};return t<32||(e.l+=16,r.header=hs(e),r.footer=hs(e),e.l+=2),r}function W8(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}function H8(e){for(var t=Ee(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var V8=Ka,G8=VS,q8=mc;function K8(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function Y8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=Ka(e);++e.l;var n=Hi(e,t-7,r);return s.t="str",s.val=n,s}function X8(e){var t=Ka(e);++e.l;var r=hs(e);return t.t="n",t.val=r,t}function J8(e,t,r){var s=Ee(15);return xc(s,e,t),s.write_shift(8,r,"f"),s}function Z8(e){var t=Ka(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Q8(e,t,r){var s=Ee(9);return xc(s,e,t),s.write_shift(2,r),s}function eF(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function tF(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function rF(e,t,r){var s=e.l+t,n=Ka(e),i=e.read_shift(2),o=Ai(e,i,r);return e.l=s,n.t="str",n.val=o,n}var sF=[2,3,48,49,131,139,140,245],np=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Fu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=In(1);switch(c.type){case"base64":u=Vs(Xs(l));break;case"binary":u=Vs(l);break;case"buffer":case"array":u=l;break}ts(u,0);var m=u.read_shift(1),f=!!(m&136),h=!1,p=!1;switch(m){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var x=0,g=521;m==2&&(x=u.read_shift(2)),u.l+=3,m!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),m!=2&&(g=u.read_shift(2));var v=u.read_shift(2),w=c.codepage||1252;m!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var y=[],S={},E=Math.min(u.length,m==2?521:g-10-(h?264:0)),N=p?32:11;u.l<E&&u[u.l]!=13;)switch(S={},S.name=_l.utils.decode(w,u.slice(u.l,u.l+N)).replace(/[\u0000\r\n].*$/g,""),u.l+=N,S.type=String.fromCharCode(u.read_shift(1)),m!=2&&!p&&(S.offset=u.read_shift(4)),S.len=u.read_shift(1),m==2&&(S.offset=u.read_shift(2)),S.dec=u.read_shift(1),S.name.length&&y.push(S),m!=2&&(u.l+=p?13:14),S.type){case"B":(!h||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var j=0,T=0;for(d[0]=[],T=0;T!=y.length;++T)d[0][T]=y[T].name;for(;x-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,d[++j]=[],T=0,T=0;T!=y.length;++T){var C=u.slice(u.l,u.l+y[T].len);u.l+=y[T].len,ts(C,0);var L=_l.utils.decode(w,C);switch(y[T].type){case"C":L.trim().length&&(d[j][T]=L.replace(/\s+$/,""));break;case"D":L.length===8?d[j][T]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):d[j][T]=L;break;case"F":d[j][T]=parseFloat(L.trim());break;case"+":case"I":d[j][T]=p?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":d[j][T]=!0;break;case"N":case"F":d[j][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[j][T]="##MEMO##"+(p?parseInt(L.trim(),10):C.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(d[j][T]=+L||0);break;case"@":d[j][T]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":d[j][T]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":d[j][T]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[j][T]=-C.read_shift(-8,"f");break;case"B":if(h&&y[T].len==8){d[j][T]=C.read_shift(8,"f");break}case"G":case"P":C.l+=y[T].len;break;case"0":if(y[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[T].type)}}}if(m!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=y,d}function s(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=Io(r(l,d),d);return u["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,u}function n(l,c){try{return Wn(s(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&Ca(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ls(),m=Md(l,{header:1,raw:!0,cellDates:!0}),f=m[0],h=m.slice(1),p=l["!cols"]||[],x=0,g=0,v=0,w=1;for(x=0;x<f.length;++x){if(((p[x]||{}).DBF||{}).name){f[x]=p[x].DBF.name,++v;continue}if(f[x]!=null){if(++v,typeof f[x]=="number"&&(f[x]=f[x].toString(10)),typeof f[x]!="string")throw new Error("DBF Invalid column name "+f[x]+" |"+typeof f[x]+"|");if(f.indexOf(f[x])!==x){for(g=0;g<1024;++g)if(f.indexOf(f[x]+"_"+g)==-1){f[x]+="_"+g;break}}}}var y=_t(l["!ref"]),S=[],E=[],N=[];for(x=0;x<=y.e.c-y.s.c;++x){var j="",T="",C=0,L=[];for(g=0;g<h.length;++g)h[g][x]!=null&&L.push(h[g][x]);if(L.length==0||f[x]==null){S[x]="?";continue}for(g=0;g<L.length;++g){switch(typeof L[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=L[g]instanceof Date?"D":"C";break;default:T="C"}C=Math.max(C,String(L[g]).length),j=j&&j!=T?"C":T}C>250&&(C=250),T=((p[x]||{}).DBF||{}).type,T=="C"&&p[x].DBF.len>C&&(C=p[x].DBF.len),j=="B"&&T=="N"&&(j="N",N[x]=p[x].DBF.dec,C=p[x].DBF.len),E[x]=j=="C"||T=="N"?C:i[j]||0,w+=E[x],S[x]=j}var A=u.next(32);for(A.write_shift(4,318902576),A.write_shift(4,h.length),A.write_shift(2,296+32*v),A.write_shift(2,w),x=0;x<4;++x)A.write_shift(4,0);for(A.write_shift(4,0|(+t[HN]||3)<<8),x=0,g=0;x<f.length;++x)if(f[x]!=null){var P=u.next(32),I=(f[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,I,"sbcs"),P.write_shift(1,S[x]=="?"?"C":S[x],"sbcs"),P.write_shift(4,g),P.write_shift(1,E[x]||i[S[x]]||0),P.write_shift(1,N[x]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),g+=E[x]||i[S[x]]||0}var _=u.next(264);for(_.write_shift(4,13),x=0;x<65;++x)_.write_shift(4,0);for(x=0;x<h.length;++x){var D=u.next(w);for(D.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(S[g]){case"L":D.write_shift(1,h[x][g]==null?63:h[x][g]?84:70);break;case"B":D.write_shift(8,h[x][g]||0,"f");break;case"N":var W="0";for(typeof h[x][g]=="number"&&(W=h[x][g].toFixed(N[g]||0)),v=0;v<E[g]-W.length;++v)D.write_shift(1,32);D.write_shift(1,W,"sbcs");break;case"D":h[x][g]?(D.write_shift(4,("0000"+h[x][g].getFullYear()).slice(-4),"sbcs"),D.write_shift(2,("00"+(h[x][g].getMonth()+1)).slice(-2),"sbcs"),D.write_shift(2,("00"+h[x][g].getDate()).slice(-2),"sbcs")):D.write_shift(8,"00000000","sbcs");break;case"C":var K=String(h[x][g]!=null?h[x][g]:"").slice(0,E[g]);for(D.write_shift(1,K,"sbcs"),v=0;v<E[g]-K.length;++v)D.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:s,from_sheet:o}})(),rE=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+jr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var p=e[h];return typeof p=="number"?C1(p):p},s=function(f,h,p){var x=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?f:C1(x)};e["|"]=254;function n(f,h){switch(h.type){case"base64":return i(Xs(f),h);case"binary":return i(f,h);case"buffer":return i(wt&&Buffer.isBuffer(f)?f.toString("binary"):Un(f),h);case"array":return i(Ei(f),h)}throw new Error("Unrecognized type "+h.type)}function i(f,h){var p=f.split(/[\n\r]+/),x=-1,g=-1,v=0,w=0,y=[],S=[],E=null,N={},j=[],T=[],C=[],L=0,A;for(+h.codepage>=0&&Ca(+h.codepage);v!==p.length;++v){L=0;var P=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),I=P.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),_=I[0],D;if(P.length>0)switch(_){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":I[1].charAt(0)=="P"&&S.push(P.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,K=!1,J=!1,F=!1,le=-1,Ae=-1;for(w=1;w<I.length;++w)switch(I[w].charAt(0)){case"A":break;case"X":g=parseInt(I[w].slice(1))-1,K=!0;break;case"Y":for(x=parseInt(I[w].slice(1))-1,K||(g=0),A=y.length;A<=x;++A)y[A]=[];break;case"K":D=I[w].slice(1),D.charAt(0)==='"'?D=D.slice(1,D.length-1):D==="TRUE"?D=!0:D==="FALSE"?D=!1:isNaN(Pa(D))?isNaN(xo(D).getDate())||(D=rr(D)):(D=Pa(D),E!==null&&Oo(E)&&(D=Mu(D))),W=!0;break;case"E":F=!0;var O=lo(I[w].slice(1),{r:x,c:g});y[x][g]=[y[x][g],O];break;case"S":J=!0,y[x][g]=[y[x][g],"S5S"];break;case"G":break;case"R":le=parseInt(I[w].slice(1))-1;break;case"C":Ae=parseInt(I[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(W&&(y[x][g]&&y[x][g].length==2?y[x][g][0]=D:y[x][g]=D,E=null),J){if(F)throw new Error("SYLK shared formula cannot have own formula");var G=le>-1&&y[le][Ae];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");y[x][g][1]=yE(G[1],{r:x-le,c:g-Ae})}break;case"F":var U=0;for(w=1;w<I.length;++w)switch(I[w].charAt(0)){case"X":g=parseInt(I[w].slice(1))-1,++U;break;case"Y":for(x=parseInt(I[w].slice(1))-1,A=y.length;A<=x;++A)y[A]=[];break;case"M":L=parseInt(I[w].slice(1))/20;break;case"F":break;case"G":break;case"P":E=S[parseInt(I[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=I[w].slice(1).split(" "),A=parseInt(C[0],10);A<=parseInt(C[1],10);++A)L=parseInt(C[2],10),T[A-1]=L===0?{hidden:!0}:{wch:L},Rn(T[A-1]);break;case"C":g=parseInt(I[w].slice(1))-1,T[g]||(T[g]={});break;case"R":x=parseInt(I[w].slice(1))-1,j[x]||(j[x]={}),L>0?(j[x].hpt=L,j[x].hpx=vo(L)):L===0&&(j[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}U<1&&(E=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return j.length>0&&(N["!rows"]=j),T.length>0&&(N["!cols"]=T),h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),[y,N]}function o(f,h){var p=n(f,h),x=p[0],g=p[1],v=Io(x,h);return jr(g).forEach(function(w){v[w]=g[w]}),v}function l(f,h){return Wn(o(f,h),h)}function c(f,h,p,x){var g="C;Y"+(p+1)+";X"+(x+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+Vx(f.f,{r:p,c:x}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(f,h){h.forEach(function(p,x){var g="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Ll(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Ml(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function u(f,h){h.forEach(function(p,x){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*Bl(p.hpx)+";"),g.length>2&&f.push(g+"R"+(x+1))})}function m(f,h){var p=["ID;PWXL;N;E"],x=[],g=_t(f["!ref"]),v,w=Array.isArray(f),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&d(p,f["!cols"]),f["!rows"]&&u(p,f["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var E=g.s.c;E<=g.e.c;++E){var N=ct({r:S,c:E});v=w?(f[S]||[])[E]:f[N],!(!v||v.v==null&&(!v.f||v.F))&&x.push(c(v,f,S,E))}return p.join(y)+y+x.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:m}})(),sE=(function(){function e(i,o){switch(o.type){case"base64":return t(Xs(i),o);case"binary":return t(i,o);case"buffer":return t(wt&&Buffer.isBuffer(i)?i.toString("binary"):Un(i),o);case"array":return t(Ei(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,d=-1,u=0,m=[];u!==l.length;++u){if(l[u].trim()==="BOT"){m[++c]=[],d=0;continue}if(!(c<0)){var f=l[u].trim().split(","),h=f[0],p=f[1];++u;for(var x=l[u]||"";(x.match(/["]/g)||[]).length&1&&u<l.length-1;)x+=`
`+l[++u];switch(x=x.trim(),+h){case-1:if(x==="BOT"){m[++c]=[],d=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?m[c][d]=!0:x==="FALSE"?m[c][d]=!1:isNaN(Pa(p))?isNaN(xo(p).getDate())?m[c][d]=p:m[c][d]=rr(p):m[c][d]=Pa(p),++d;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),m[c][d++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(i,o){return Io(e(i,o),o)}function s(i,o){return Wn(r(i,o),o)}var n=(function(){var i=function(c,d,u,m,f){c.push(d),c.push(u+","+m),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,d,u,m){c.push(d+","+u),c.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var d=[],u=_t(c["!ref"]),m,f=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(d,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var x=ct({r:h,c:p});if(m=f?(c[h]||[])[p]:c[x],!m){o(d,1,0,"");continue}switch(m.t){case"n":var g=m.w;!g&&m.v!=null&&(g=m.v),g==null?m.f&&!m.F?o(d,1,0,"="+m.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=ga(m.z||ot[14],Br(rr(m.v)))),o(d,0,m.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var v=`\r
`,w=d.join(v);return w}})();return{to_workbook:s,to_sheet:r,from_sheet:n}})(),aE=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,f){for(var h=m.split(`
`),p=-1,x=-1,g=0,v=[];g!==h.length;++g){var w=h[g].trim().split(":");if(w[0]==="cell"){var y=fr(w[1]);if(v.length<=y.r)for(p=v.length;p<=y.r;++p)v[p]||(v[p]=[]);switch(p=y.r,x=y.c,w[2]){case"t":v[p][x]=e(w[3]);break;case"v":v[p][x]=+w[3];break;case"vtf":var S=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[p][x]=!!+w[4];break;default:v[p][x]=+w[4];break}w[2]=="vtf"&&(v[p][x]=[v[p][x],S])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function s(m,f){return Io(r(m,f),f)}function n(m,f){return Wn(s(m,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var f=[],h=[],p,x="",g=Ms(m["!ref"]),v=Array.isArray(m),w=g.s.r;w<=g.e.r;++w)for(var y=g.s.c;y<=g.e.c;++y)if(x=ct({r:w,c:y}),p=v?(m[w]||[])[y]:m[x],!(!p||p.v==null||p.t==="z")){switch(h=["cell",x,"t"],p.t){case"s":case"str":h.push(t(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=t(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var S=Br(rr(p.v));h[2]="vtc",h[3]="nd",h[4]=""+S,h[5]=p.w||ga(p.z||ot[14],S);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(m){return[i,o,l,o,d(m),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:u}})(),go=(function(){function e(u,m,f,h,p){p.raw?m[f][h]=u:u===""||(u==="TRUE"?m[f][h]=!0:u==="FALSE"?m[f][h]=!1:isNaN(Pa(u))?isNaN(xo(u).getDate())?m[f][h]=u:m[f][h]=rr(u):m[f][h]=Pa(u))}function t(u,m){var f=m||{},h=[];if(!u||u.length===0)return h;for(var p=u.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var g=10,v=0,w=0;w<=x;++w)v=p[w].indexOf(" "),v==-1?v=p[w].length:v++,g=Math.max(g,v);for(w=0;w<=x;++w){h[w]=[];var y=0;for(e(p[w].slice(0,g).trim(),h,w,y,f),y=1;y<=(p[w].length-g)/10+1;++y)e(p[w].slice(g+(y-1)*10,g+y*10).trim(),h,w,y,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(u){for(var m={},f=!1,h=0,p=0;h<u.length;++h)(p=u.charCodeAt(h))==34?f=!f:!f&&p in r&&(m[p]=(m[p]||0)+1);p=[];for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&p.push([m[h],h]);if(!p.length){m=s;for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&p.push([m[h],h])}return p.sort(function(x,g){return x[0]-g[0]||s[x[1]]-s[g[1]]}),r[p.pop()[1]]||44}function i(u,m){var f=m||{},h="",p=f.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=n(u.slice(0,1024)):f&&f.FS?h=f.FS:h=n(u.slice(0,1024));var g=0,v=0,w=0,y=0,S=0,E=h.charCodeAt(0),N=!1,j=0,T=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var C=f.dateNF!=null?WI(f.dateNF):null;function L(){var A=u.slice(y,S),P={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)P.t="z";else if(f.raw)P.t="s",P.v=A;else if(A.trim().length===0)P.t="s",P.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(P.t="s",P.v=A.slice(2,-1).replace(/""/g,'"')):vM(A)?(P.t="n",P.f=A.slice(1)):(P.t="s",P.v=A);else if(A=="TRUE")P.t="b",P.v=!0;else if(A=="FALSE")P.t="b",P.v=!1;else if(!isNaN(w=Pa(A)))P.t="n",f.cellText!==!1&&(P.w=A),P.v=w;else if(!isNaN(xo(A).getDate())||C&&A.match(C)){P.z=f.dateNF||ot[14];var I=0;C&&A.match(C)&&(A=HI(A,f.dateNF,A.match(C)||[]),I=1),f.cellDates?(P.t="d",P.v=rr(A,I)):(P.t="n",P.v=Br(rr(A,I))),f.cellText!==!1&&(P.w=ga(P.z,P.v instanceof Date?Br(P.v):P.v)),f.cellNF||delete P.z}else P.t="s",P.v=A;if(P.t=="z"||(f.dense?(p[g]||(p[g]=[]),p[g][v]=P):p[ct({c:v,r:g})]=P),y=S+1,T=u.charCodeAt(y),x.e.c<v&&(x.e.c=v),x.e.r<g&&(x.e.r=g),j==E)++v;else if(v=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;S<u.length;++S)switch(j=u.charCodeAt(S)){case 34:T===34&&(N=!N);break;case E:case 10:case 13:if(!N&&L())break e;break}return S-y>0&&L(),p["!ref"]=vt(x),p}function o(u,m){return!(m&&m.PRN)||m.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,m):Io(t(u,m),m)}function l(u,m){var f="",h=m.type=="string"?[0,0,0,0]:Qx(u,m);switch(m.type){case"base64":f=Xs(u);break;case"binary":f=u;break;case"buffer":m.codepage==65001?f=u.toString("utf8"):m.codepage&&typeof _l<"u"||(f=wt&&Buffer.isBuffer(u)?u.toString("binary"):Un(u));break;case"array":f=Ei(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+m.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=Gt(f.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?f=Gt(f):m.type=="binary"&&typeof _l<"u",f.slice(0,19)=="socialcalc:version:"?aE.to_sheet(m.type=="string"?f:Gt(f),m):o(f,m)}function c(u,m){return Wn(l(u,m),m)}function d(u){for(var m=[],f=_t(u["!ref"]),h,p=Array.isArray(u),x=f.s.r;x<=f.e.r;++x){for(var g=[],v=f.s.c;v<=f.e.c;++v){var w=ct({r:x,c:v});if(h=p?(u[x]||[])[v]:u[w],!h||h.v==null){g.push("          ");continue}for(var y=(h.w||(dn(h),h.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(v===0?" ":""))}m.push(g.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})();function aF(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=rE.to_workbook(e,r);return r.WTF=s,n}catch(i){if(r.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return go.to_workbook(e,t)}}var pi=(function(){function e(O,G,U){if(O){ts(O,O.l||0);for(var B=U.Enum||le;O.l<O.length;){var Y=O.read_shift(2),te=B[Y]||B[65535],ae=O.read_shift(2),ne=O.l+ae,fe=te.f&&te.f(O,ae,U);if(O.l=ne,G(fe,te,Y))return}}}function t(O,G){switch(G.type){case"base64":return r(Vs(Xs(O)),G);case"binary":return r(Vs(O),G);case"buffer":case"array":return r(O,G)}throw"Unsupported type "+G.type}function r(O,G){if(!O)return O;var U=G||{},B=U.dense?[]:{},Y="Sheet1",te="",ae=0,ne={},fe=[],je=[],z={s:{r:0,c:0},e:{r:0,c:0}},me=U.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)U.Enum=le,e(O,function(he,Me,de){switch(de){case 0:U.vers=he,he>=4096&&(U.qpro=!0);break;case 6:z=he;break;case 204:he&&(te=he);break;case 222:te=he;break;case 15:case 51:U.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:de==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=U.dateNF||ot[14],U.cellDates&&(he[1].t="d",he[1].v=Mu(he[1].v))),U.qpro&&he[3]>ae&&(B["!ref"]=vt(z),ne[Y]=B,fe.push(Y),B=U.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},ae=he[3],Y=te||"Sheet"+(ae+1),te="");var We=U.dense?(B[he[0].r]||[])[he[0].c]:B[ct(he[0])];if(We){We.t=he[1].t,We.v=he[1].v,he[1].z!=null&&(We.z=he[1].z),he[1].f!=null&&(We.f=he[1].f);break}U.dense?(B[he[0].r]||(B[he[0].r]=[]),B[he[0].r][he[0].c]=he[1]):B[ct(he[0])]=he[1];break}},U);else if(O[2]==26||O[2]==14)U.Enum=Ae,O[2]==14&&(U.qpro=!0,O.l=0),e(O,function(he,Me,de){switch(de){case 204:Y=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>ae&&(B["!ref"]=vt(z),ne[Y]=B,fe.push(Y),B=U.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},ae=he[3],Y="Sheet"+(ae+1)),me>0&&he[0].r>=me)break;U.dense?(B[he[0].r]||(B[he[0].r]=[]),B[he[0].r][he[0].c]=he[1]):B[ct(he[0])]=he[1],z.e.c<he[0].c&&(z.e.c=he[0].c),z.e.r<he[0].r&&(z.e.r=he[0].r);break;case 27:he[14e3]&&(je[he[14e3][0]]=he[14e3][1]);break;case 1537:je[he[0]]=he[1],he[0]==ae&&(Y=he[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(B["!ref"]=vt(z),ne[te||Y]=B,fe.push(te||Y),!je.length)return{SheetNames:fe,Sheets:ne};for(var ie={},ke=[],Fe=0;Fe<je.length;++Fe)ne[fe[Fe]]?(ke.push(je[Fe]||fe[Fe]),ie[je[Fe]]=ne[je[Fe]]||ne[fe[Fe]]):(ke.push(je[Fe]),ie[je[Fe]]={"!ref":"A1"});return{SheetNames:ke,Sheets:ie}}function s(O,G){var U=G||{};if(+U.codepage>=0&&Ca(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Ls(),Y=_t(O["!ref"]),te=Array.isArray(O),ae=[];ze(B,0,i(1030)),ze(B,6,c(Y));for(var ne=Math.min(Y.e.r,8191),fe=Y.s.r;fe<=ne;++fe)for(var je=Cr(fe),z=Y.s.c;z<=Y.e.c;++z){fe===Y.s.r&&(ae[z]=mr(z));var me=ae[z]+je,ie=te?(O[fe]||[])[z]:O[me];if(!(!ie||ie.t=="z"))if(ie.t=="n")(ie.v|0)==ie.v&&ie.v>=-32768&&ie.v<=32767?ze(B,13,h(fe,z,ie.v)):ze(B,14,x(fe,z,ie.v));else{var ke=dn(ie);ze(B,15,m(fe,z,ke.slice(0,239)))}}return ze(B,1),B.end()}function n(O,G){var U=G||{};if(+U.codepage>=0&&Ca(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Ls();ze(B,0,o(O));for(var Y=0,te=0;Y<O.SheetNames.length;++Y)(O.Sheets[O.SheetNames[Y]]||{})["!ref"]&&ze(B,27,F(O.SheetNames[Y],te++));var ae=0;for(Y=0;Y<O.SheetNames.length;++Y){var ne=O.Sheets[O.SheetNames[Y]];if(!(!ne||!ne["!ref"])){for(var fe=_t(ne["!ref"]),je=Array.isArray(ne),z=[],me=Math.min(fe.e.r,8191),ie=fe.s.r;ie<=me;++ie)for(var ke=Cr(ie),Fe=fe.s.c;Fe<=fe.e.c;++Fe){ie===fe.s.r&&(z[Fe]=mr(Fe));var he=z[Fe]+ke,Me=je?(ne[ie]||[])[Fe]:ne[he];if(!(!Me||Me.t=="z"))if(Me.t=="n")ze(B,23,L(ie,Fe,ae,Me.v));else{var de=dn(Me);ze(B,22,j(ie,Fe,ae,de.slice(0,239)))}}++ae}}return ze(B,1),B.end()}function i(O){var G=Ee(2);return G.write_shift(2,O),G}function o(O){var G=Ee(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var U=0,B=0,Y=0,te=0;te<O.SheetNames.length;++te){var ae=O.SheetNames[te],ne=O.Sheets[ae];if(!(!ne||!ne["!ref"])){++Y;var fe=Ms(ne["!ref"]);U<fe.e.r&&(U=fe.e.r),B<fe.e.c&&(B=fe.e.c)}}return U>8191&&(U=8191),G.write_shift(2,U),G.write_shift(1,Y),G.write_shift(1,B),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function l(O,G,U){var B={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&U.qpro?(B.s.c=O.read_shift(1),O.l++,B.s.r=O.read_shift(2),B.e.c=O.read_shift(1),O.l++,B.e.r=O.read_shift(2),B):(B.s.c=O.read_shift(2),B.s.r=O.read_shift(2),G==12&&U.qpro&&(O.l+=2),B.e.c=O.read_shift(2),B.e.r=O.read_shift(2),G==12&&U.qpro&&(O.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function c(O){var G=Ee(8);return G.write_shift(2,O.s.c),G.write_shift(2,O.s.r),G.write_shift(2,O.e.c),G.write_shift(2,O.e.r),G}function d(O,G,U){var B=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(B[0].c=O.read_shift(1),B[3]=O.read_shift(1),B[0].r=O.read_shift(2),O.l+=2):(B[2]=O.read_shift(1),B[0].c=O.read_shift(2),B[0].r=O.read_shift(2)),B}function u(O,G,U){var B=O.l+G,Y=d(O,G,U);if(Y[1].t="s",U.vers==20768){O.l++;var te=O.read_shift(1);return Y[1].v=O.read_shift(te,"utf8"),Y}return U.qpro&&O.l++,Y[1].v=O.read_shift(B-O.l,"cstr"),Y}function m(O,G,U){var B=Ee(7+U.length);B.write_shift(1,255),B.write_shift(2,G),B.write_shift(2,O),B.write_shift(1,39);for(var Y=0;Y<B.length;++Y){var te=U.charCodeAt(Y);B.write_shift(1,te>=128?95:te)}return B.write_shift(1,0),B}function f(O,G,U){var B=d(O,G,U);return B[1].v=O.read_shift(2,"i"),B}function h(O,G,U){var B=Ee(7);return B.write_shift(1,255),B.write_shift(2,G),B.write_shift(2,O),B.write_shift(2,U,"i"),B}function p(O,G,U){var B=d(O,G,U);return B[1].v=O.read_shift(8,"f"),B}function x(O,G,U){var B=Ee(13);return B.write_shift(1,255),B.write_shift(2,G),B.write_shift(2,O),B.write_shift(8,U,"f"),B}function g(O,G,U){var B=O.l+G,Y=d(O,G,U);if(Y[1].v=O.read_shift(8,"f"),U.qpro)O.l=B;else{var te=O.read_shift(2);S(O.slice(O.l,O.l+te),Y),O.l+=te}return Y}function v(O,G,U){var B=G&32768;return G&=-32769,G=(B?O:0)+(G>=8192?G-16384:G),(B?"":"$")+(U?mr(G):Cr(G))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(O,G){ts(O,0);for(var U=[],B=0,Y="",te="",ae="",ne="";O.l<O.length;){var fe=O[O.l++];switch(fe){case 0:U.push(O.read_shift(8,"f"));break;case 1:te=v(G[0].c,O.read_shift(2),!0),Y=v(G[0].r,O.read_shift(2),!1),U.push(te+Y);break;case 2:{var je=v(G[0].c,O.read_shift(2),!0),z=v(G[0].r,O.read_shift(2),!1);te=v(G[0].c,O.read_shift(2),!0),Y=v(G[0].r,O.read_shift(2),!1),U.push(je+z+":"+te+Y)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(O.read_shift(2));break;case 6:{for(var me="";fe=O[O.l++];)me+=String.fromCharCode(fe);U.push('"'+me.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:ne=U.pop(),ae=U.pop(),U.push(["AND","OR"][fe-20]+"("+ae+","+ne+")");break;default:if(fe<32&&y[fe])ne=U.pop(),ae=U.pop(),U.push(ae+y[fe]+ne);else if(w[fe]){if(B=w[fe][1],B==69&&(B=O[O.l++]),B>U.length){console.error("WK1 bad formula parse 0x"+fe.toString(16)+":|"+U.join("|")+"|");return}var ie=U.slice(-B);U.length-=B,U.push(w[fe][0]+"("+ie.join(",")+")")}else return fe<=7?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=24?console.error("WK1 unsupported op "+fe.toString(16)):fe<=30?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=115?console.error("WK1 unsupported function opcode "+fe.toString(16)):console.error("WK1 unrecognized opcode "+fe.toString(16))}}U.length==1?G[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function E(O){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=O.read_shift(2),G[3]=O[O.l++],G[0].c=O[O.l++],G}function N(O,G){var U=E(O);return U[1].t="s",U[1].v=O.read_shift(G-4,"cstr"),U}function j(O,G,U,B){var Y=Ee(6+B.length);Y.write_shift(2,O),Y.write_shift(1,U),Y.write_shift(1,G),Y.write_shift(1,39);for(var te=0;te<B.length;++te){var ae=B.charCodeAt(te);Y.write_shift(1,ae>=128?95:ae)}return Y.write_shift(1,0),Y}function T(O,G){var U=E(O);U[1].v=O.read_shift(2);var B=U[1].v>>1;if(U[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return U[1].v=B,U}function C(O,G){var U=E(O),B=O.read_shift(4),Y=O.read_shift(4),te=O.read_shift(2);if(te==65535)return B===0&&Y===3221225472?(U[1].t="e",U[1].v=15):B===0&&Y===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var ae=te&32768;return te=(te&32767)-16446,U[1].v=(1-ae*2)*(Y*Math.pow(2,te+32)+B*Math.pow(2,te)),U}function L(O,G,U,B){var Y=Ee(14);if(Y.write_shift(2,O),Y.write_shift(1,U),Y.write_shift(1,G),B==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var te=0,ae=0,ne=0,fe=0;return B<0&&(te=1,B=-B),ae=Math.log2(B)|0,B/=Math.pow(2,ae-31),fe=B>>>0,(fe&2147483648)==0&&(B/=2,++ae,fe=B>>>0),B-=fe,fe|=2147483648,fe>>>=0,B*=Math.pow(2,32),ne=B>>>0,Y.write_shift(4,ne),Y.write_shift(4,fe),ae+=16383+(te?32768:0),Y.write_shift(2,ae),Y}function A(O,G){var U=C(O);return O.l+=G-14,U}function P(O,G){var U=E(O),B=O.read_shift(4);return U[1].v=B>>6,U}function I(O,G){var U=E(O),B=O.read_shift(8,"f");return U[1].v=B,U}function _(O,G){var U=I(O);return O.l+=G-10,U}function D(O,G){return O[O.l+G-1]==0?O.read_shift(G,"cstr"):""}function W(O,G){var U=O[O.l++];U>G-1&&(U=G-1);for(var B="";B.length<U;)B+=String.fromCharCode(O[O.l++]);return B}function K(O,G,U){if(!(!U.qpro||G<21)){var B=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var Y=O.read_shift(G-21,"cstr");return[B,Y]}}function J(O,G){for(var U={},B=O.l+G;O.l<B;){var Y=O.read_shift(2);if(Y==14e3){for(U[Y]=[0,""],U[Y][0]=O.read_shift(2);O[O.l];)U[Y][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return U}function F(O,G){var U=Ee(5+O.length);U.write_shift(2,14e3),U.write_shift(2,G);for(var B=0;B<O.length;++B){var Y=O.charCodeAt(B);U[U.l++]=Y>127?95:Y}return U[U.l++]=0,U}var le={0:{n:"BOF",f:Dr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:D},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},Ae={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:I},40:{n:"FORMULA28",f:_},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:D},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}})();function nF(e){var t={},r=e.match(vs),s=0,n=!1;if(r)for(;s!=r.length;++s){var i=dt(r[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=xx[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var iF=(function(){var e=Ol("t"),t=Ol("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Ct(o[1])},c=i.match(t);return c&&(l.s=nF(c[1])),l}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(s,"").split(n).map(r).filter(function(l){return l.v})}})(),oF=(function(){var t=/(\r\n|\n)/g;function r(n,i,o){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),n.b&&(i.push("<b>"),o.push("</b>")),n.i&&(i.push("<i>"),o.push("</i>")),n.strike&&(i.push("<s>"),o.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),n}function s(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(s).join("")}})(),lF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cF=/<(?:\w+:)?r>/,dF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function $x(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Ct(Gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Gt(e),r&&(s.h=Tx(s.t))):e.match(cF)&&(s.r=Gt(e),s.t=Ct(Gt((e.replace(dF,"").match(lF)||[]).join("").replace(vs,""))),r&&(s.h=oF(iF(s.r)))),s):{t:""}}var uF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,mF=/<(?:\w+:)?(?:si|sstItem)>/g,fF=/<\/(?:\w+:)?(?:si|sstItem)>/;function hF(e,t){var r=[],s="";if(!e)return r;var n=e.match(uF);if(n){s=n[2].replace(mF,"").split(fF);for(var i=0;i!=s.length;++i){var o=$x(s[i].trim(),t);o!=null&&(r[r.length]=o)}n=dt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var pF=/^\s|\s$|[\t\n\r]/;function nE(e,t){if(!t.bookSST)return"";var r=[_r];r[r.length]=$e("sst",null,{xmlns:Bi[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(pF)&&(i+=' xml:space="preserve"'),i+=">"+Ut(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function xF(e){return[e.read_shift(4),e.read_shift(4)]}function gF(e,t){var r=[],s=!1;return xn(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(o.T,!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function vF(e,t){return t||(t=Ee(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var bF=_6;function yF(e){var t=Ls();Oe(t,159,vF(e));for(var r=0;r<e.length;++r)Oe(t,19,bF(e[r]));return Oe(t,160),t.end()}function iE(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function sn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function wF(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=sn(e,4),t.U=sn(e,4),t.W=sn(e,4),t}function jF(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function NF(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(jF(e));return t}function SF(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function EF(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=sn(e,4),t.U=sn(e,4),t.W=sn(e,4),t}function TF(e){var t=EF(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function oE(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function lE(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function AF(e){var t=sn(e);switch(t.Minor){case 2:return[t.Minor,CF(e)];case 3:return[t.Minor,_F()];case 4:return[t.Minor,kF(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function CF(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=oE(e,r),n=lE(e,e.length-e.l);return{t:"Std",h:s,v:n}}function _F(){throw new Error("File is password-protected: ECMA-376 Extensible")}function kF(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(vs,function(i){var o=dt(i);switch(qa(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){s[l]=o[l]});break;case"<dataIntegrity":s.encryptedHmacKey=o.encryptedHmacKey,s.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(o);break;default:throw o[0]}}),s}function PF(e,t){var r={},s=r.EncryptionVersionInfo=sn(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=oE(e,n),t-=n,r.EncryptionVerifier=lE(e,t),r}function OF(e){var t={},r=t.EncryptionVersionInfo=sn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function zx(e){var t=0,r,s=iE(e),n=s.length+1,i,o,l,c,d;for(r=In(n),r[0]=s.length,i=1;i!=n;++i)r[i]=s[i-1];for(i=n-1;i>=0;--i)o=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var cE=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(o){return(o/2|o*128)&255},n=function(o,l){return s(o^l)},i=function(o){for(var l=t[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],m=0;m!=7;++m)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=iE(o),c=i(l),d=l.length,u=In(16),m=0;m!=16;++m)u[m]=0;var f,h,p;for((d&1)===1&&(f=c>>8,u[d]=n(e[0],f),--d,f=c&255,h=l[l.length-1],u[d]=n(h,f));d>0;)--d,f=c>>8,u[d]=n(l[d],f),--d,f=c&255,u[d]=n(l[d],f);for(d=15,p=15-l.length;p>0;)f=c>>8,u[d]=n(e[p],f),--d,--p,f=c&255,u[d]=n(l[d],f),--d,--p;return u}})(),DF=function(e,t,r,s,n){n||(n=t),s||(s=cE(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=s[r],o=(o>>5|o<<3)&255,n[i]=o,++r;return[n,r,s]},IF=function(e){var t=0,r=cE(e);return function(s){var n=DF("",s,t,r);return t=n[1],n[0]}};function RF(e,t,r,s){var n={key:Dr(e),verificationBytes:Dr(e)};return r.password&&(n.verifier=zx(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=IF(r.password)),n}function FF(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=OF(e):s.Data=PF(e,t),s}function LF(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?FF(e,t-2,s):RF(e,r.biff>=8?t:t-2,r,s),s}var dE=(function(){function e(n,i){switch(i.type){case"base64":return t(Xs(n),i);case"binary":return t(n,i);case"buffer":return t(wt&&Buffer.isBuffer(n)?n.toString("binary"):Un(n),i);case"array":return t(Ei(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,m){Array.isArray(l)&&(l[m]=[]);for(var f=/\\\w+\b/g,h=0,p,x=-1;p=f.exec(u);){switch(p[0]){case"\\cell":var g=u.slice(h,f.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var v={v:g,t:"s"};Array.isArray(l)?l[m][x]=v:l[ct({r:m,c:x})]=v}break}h=f.lastIndex}x>d.e.c&&(d.e.c=x)}),l["!ref"]=vt(d),l}function r(n,i){return Wn(e(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],o=_t(n["!ref"]),l,c=Array.isArray(n),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var m=ct({r:d,c:u});l=c?(n[d]||[])[u]:n[m],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(dn(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}})();function MF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Fl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function BF(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),i=Math.min(t,r,s),o=n-i;if(o===0)return[0,0,t];var l=0,c=0,d=n+i;switch(c=o/(d>1?2-d:d),n){case t:l=((r-s)/o+6)%6;break;case r:l=(s-t)/o+2;break;case s:l=(t-r)/o+4;break}return[l/6,c,d/2]}function $F(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),i=s-n/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,o[0]+=n,o[1]+=c;break;case 1:c=n*(2-l),o[0]+=c,o[1]+=n;break;case 2:c=n*(l-2),o[1]+=n,o[2]+=c;break;case 3:c=n*(4-l),o[1]+=c,o[2]+=n;break;case 4:c=n*(l-4),o[2]+=n,o[0]+=c;break;case 5:c=n*(6-l),o[2]+=c,o[0]+=n;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Fd(e,t){if(t===0)return e;var r=BF(MF(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Fl($F(r))}var uE=6,zF=15,UF=1,us=uE;function Ll(e){return Math.floor((e+Math.round(128/us)/256)*us)}function Ml(e){return Math.floor((e-5)/us*100+.5)/100}function Ld(e){return Math.round((e*us+5)/us*256)/256}function Rm(e){return Ld(Ml(Ll(e)))}function Ux(e){var t=Math.abs(e-Rm(e)),r=us;if(t>.005)for(us=UF;us<zF;++us)Math.abs(e-Rm(e))<=t&&(t=Math.abs(e-Rm(e)),r=us);us=r}function Rn(e){e.width?(e.wpx=Ll(e.width),e.wch=Ml(e.wpx),e.MDW=us):e.wpx?(e.wch=Ml(e.wpx),e.width=Ld(e.wch),e.MDW=us):typeof e.wch=="number"&&(e.width=Ld(e.wch),e.wpx=Ll(e.width),e.MDW=us),e.customWidth&&delete e.customWidth}var WF=96,mE=WF;function Bl(e){return e*96/mE}function vo(e){return e*mE/96}var HF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function VF(e,t,r,s){t.Borders=[];var n={},i=!1;(e[0].match(vs)||[]).forEach(function(o){var l=dt(o);switch(qa(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=er(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=er(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function GF(e,t,r,s){t.Fills=[];var n={},i=!1;(e[0].match(vs)||[]).forEach(function(o){var l=dt(o);switch(qa(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function qF(e,t,r,s){t.Fonts=[];var n={},i=!1;(e[0].match(vs)||[]).forEach(function(o){var l=dt(o);switch(qa(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=Gt(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?er(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?er(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?er(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?er(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?er(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?er(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?er(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=xx[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=er(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=fi[n.color.index];n.color.index==81&&(c=fi[1]),c||(c=fi[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Fd(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function KF(e,t,r){t.NumberFmt=[];for(var s=jr(ot),n=0;n<s.length;++n)t.NumberFmt[s[n]]=ot[s[n]];var i=e[0].match(vs);if(i)for(n=0;n<i.length;++n){var o=dt(i[n]);switch(qa(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Ct(Gt(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}rn(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function YF(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=$e("numFmt",null,{numFmtId:s,formatCode:Ut(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=$e("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Gc=["numFmtId","fillId","fontId","borderId","xfId"],qc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function XF(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(vs)||[]).forEach(function(i){var o=dt(i),l=0;switch(qa(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=o,delete s[0],l=0;l<Gc.length;++l)s[Gc[l]]&&(s[Gc[l]]=parseInt(s[Gc[l]],10));for(l=0;l<qc.length;++l)s[qc[l]]&&(s[qc[l]]=er(s[qc[l]]));if(t.NumberFmt&&s.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[l]){s.numFmtId=l;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=er(o.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function JF(e){var t=[];return t[t.length]=$e("cellXfs",null),e.forEach(function(r){t[t.length]=$e("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=$e("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ZF=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&KF(m,u,d),(m=l.match(n))&&qF(m,u,c,d),(m=l.match(s))&&GF(m,u,c,d),(m=l.match(i))&&VF(m,u,c,d),(m=l.match(r))&&XF(m,u,d),u}})();function fE(e,t){var r=[_r,$e("styleSheet",null,{xmlns:Bi[0],"xmlns:vt":Lr.vt})],s;return e.SSF&&(s=YF(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=JF(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function QF(e,t){var r=e.read_shift(2),s=ps(e);return[r,s]}function eL(e,t,r){r||(r=Ee(6+4*t.length)),r.write_shift(2,e),qr(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function tL(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=F6(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=e.read_shift(2);switch(i===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var l=e.read_shift(1);l>0&&(s.family=l);var c=e.read_shift(1);switch(c>0&&(s.charset=c),e.l++,s.color=R6(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=ps(e),s}function rL(e,t){t||(t=Ee(153)),t.write_shift(2,e.sz*20),L6(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Dd(e.color,t);var s=0;return s=2,t.write_shift(1,s),qr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var sL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Fm,aL=gs;function vb(e,t){t||(t=Ee(84)),Fm||(Fm=Fu(sL));var r=Fm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Dd({auto:1},t),Dd({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function nL(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function hE(e,t,r){r||(r=Ee(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Zo(e,t){return t||(t=Ee(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var iL=gs;function oL(e,t){return t||(t=Ee(51)),t.write_shift(1,0),Zo(null,t),Zo(null,t),Zo(null,t),Zo(null,t),Zo(null,t),t.length>t.l?t.slice(0,t.l):t}function lL(e,t){return t||(t=Ee(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Od(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function cL(e,t,r){var s=Ee(2052);return s.write_shift(4,e),Od(t,s),Od(r,s),s.length>s.l?s.slice(0,s.l):s}function dL(e,t,r){var s={};s.NumberFmt=[];for(var n in ot)s.NumberFmt[n]=ot[n];s.CellXf=[],s.Fonts=[];var i=[],o=!1;return xn(e,function(c,d,u){switch(u){case 44:s.NumberFmt[c[0]]=c[1],rn(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Fd(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),s}function uL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(Oe(e,615,Oa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&Oe(e,44,eL(n,t[n]))}),Oe(e,616))}}function mL(e){var t=1;Oe(e,611,Oa(t)),Oe(e,43,rL({sz:12,color:{theme:1},name:"Calibri",family:2})),Oe(e,612)}function fL(e){var t=2;Oe(e,603,Oa(t)),Oe(e,45,vb({patternType:"none"})),Oe(e,45,vb({patternType:"gray125"})),Oe(e,604)}function hL(e){var t=1;Oe(e,613,Oa(t)),Oe(e,46,oL()),Oe(e,614)}function pL(e){var t=1;Oe(e,626,Oa(t)),Oe(e,47,hE({numFmtId:0},65535)),Oe(e,627)}function xL(e,t){Oe(e,617,Oa(t.length)),t.forEach(function(r){Oe(e,47,hE(r,0))}),Oe(e,618)}function gL(e){var t=1;Oe(e,619,Oa(t)),Oe(e,48,lL({xfId:0,name:"Normal"})),Oe(e,620)}function vL(e){var t=0;Oe(e,505,Oa(t)),Oe(e,506)}function bL(e){var t=0;Oe(e,508,cL(t,"TableStyleMedium9","PivotStyleMedium4")),Oe(e,509)}function yL(e,t){var r=Ls();return Oe(r,278),uL(r,e.SSF),mL(r),fL(r),hL(r),pL(r),xL(r,t.cellXfs),gL(r),vL(r),bL(r),Oe(r,279),r.end()}var wL=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function jL(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(vs)||[]).forEach(function(n){var i=dt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=i.val;break;case"<a:sysClr":s.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[wL.indexOf(i[0])]=s,s={}):s.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function NL(){}function SL(){}var EL=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,TL=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,AL=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function CL(e,t,r){t.themeElements={};var s;[["clrScheme",EL,jL],["fontScheme",TL,NL],["fmtScheme",AL,SL]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var _L=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function pE(e,t){(!e||e.length===0)&&(e=Wx());var r,s={};if(!(r=e.match(_L)))throw new Error("themeElements not found in theme");return CL(r[0],s,t),s.raw=e,s}function Wx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[_r];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function kL(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var i=e.slice(e.l);e.l=s;var o;try{o=oS(i,{type:"array"})}catch{return}var l=Gs(o,"theme/theme/theme1.xml",!0);if(l)return pE(l,r)}}function PL(e){return e.read_shift(4)}function OL(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=DL(e,4);break;case 2:t.xclrValue=KS(e);break;case 3:t.xclrValue=PL(e);break;case 4:e.l+=4;break}return e.l+=8,t}function DL(e,t){return gs(e,t)}function IL(e,t){return gs(e,t)}function RL(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=OL(e);break;case 6:s[1]=IL(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function FL(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(RL(e,r-e.l));return{ixfe:s,ext:i}}function LL(e,t){t.forEach(function(r){r[0]})}function ML(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ps(e)}}function BL(e){var t=Ee(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),qr(e.name,t),t.slice(0,t.l)}function $L(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function zL(e){var t=Ee(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function UL(e,t){var r=Ee(8+2*t.length);return r.write_shift(4,e),qr(t,r),r.slice(0,r.l)}function WL(e){return e.l+=4,e.read_shift(4)!=0}function HL(e,t){var r=Ee(8);return r.write_shift(4,e),r.write_shift(4,1),r}function VL(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},i=[],o=!1,l=2;return xn(e,function(c,d,u){switch(u){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(m){l==1?s.Cell.push({type:s.Types[m[0]-1].name,index:m[1]}):l==0&&s.Value.push({type:s.Types[m[0]-1].name,index:m[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),s}function GL(){var e=Ls();return Oe(e,332),Oe(e,334,Oa(1)),Oe(e,335,BL({name:"XLDAPR",version:12e4,flags:3496657072})),Oe(e,336),Oe(e,339,UL(1,"XLDAPR")),Oe(e,52),Oe(e,35,Oa(514)),Oe(e,4096,Oa(0)),Oe(e,4097,da(1)),Oe(e,36),Oe(e,53),Oe(e,340),Oe(e,337,HL(1)),Oe(e,51,zL([[1,0]])),Oe(e,338),Oe(e,333),e.end()}function qL(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,i=2,o;return e.replace(vs,function(l){var c=dt(l);switch(qa(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<s.Types.length;++d)s.Types[d].name==c.name&&(o=s.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):i==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),s}function xE(){var e=[_r];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function KL(e){var t=[];if(!e)return t;var r=1;return(e.match(vs)||[]).forEach(function(s){var n=dt(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function YL(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ct(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function XL(e,t,r){var s=[];return xn(e,function(i,o,l){switch(l){case 63:s.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),s}function JL(e,t,r,s){if(!e)return e;var n=s||{},i=!1;xn(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function ZL(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var so=1024;function gE(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[$e("xml",null,{"xmlns:v":Ws.v,"xmlns:o":Ws.o,"xmlns:x":Ws.x,"xmlns:mv":Ws.mv}).replace(/\/>/,">"),$e("o:shapelayout",$e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),$e("v:shapetype",[$e("v:stroke",null,{joinstyle:"miter"}),$e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];so<e*1e3;)so+=1e3;return t.forEach(function(i){var o=fr(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?$e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=$e("v:fill",c,l),u={on:"t",obscured:"t"};++so,n=n.concat(["<v:shape"+Dl({id:"_x0000_s"+so,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,$e("v:shadow",null,u),$e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ss("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ss("x:AutoFill","False"),ss("x:Row",String(o.r)),ss("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function bb(e,t,r,s){var n=Array.isArray(e),i;t.forEach(function(o){var l=fr(o.ref);if(n?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},n?e[l.r][l.c]=i:e[o.ref]=i;var c=_t(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=vt(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&s){for(m=0;m<s.length;++m)if(u.a==s[m].id){u.a=s[m].name||u.a;break}}i.c.push(u)})}function QL(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=dt(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=fr(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!m&&!!m[1]&&$x(m[1])||{r:"",t:"",h:""};d.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),d.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=f.h),s.push(d)}}}}),s}function vE(e){var t=[_r,$e("comments",null,{xmlns:Bi[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var i=Ut(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=r.indexOf(Ut(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(ss("t",Ut(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(ss("t",Ut(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function eM(e,t){var r=[],s=!1,n={},i=0;return e.replace(vs,function(l,c){var d=dt(l);switch(qa(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function tM(e,t,r){var s=[_r,$e("ThreadedComments",null,{xmlns:Lr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),s.push($e("threadedComment",ss("text",o.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function rM(e,t){var r=[],s=!1;return e.replace(vs,function(i){var o=dt(i);switch(qa(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function sM(e){var t=[_r,$e("personList",null,{xmlns:Lr.TCMNT,"xmlns:x":Bi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push($e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function aM(e){var t={};t.iauthor=e.read_shift(4);var r=Wi(e);return t.rfx=r.s,t.ref=ct(r.s),e.l+=16,t}function nM(e,t){return t==null&&(t=Ee(36)),t.write_shift(4,e[1].iauthor),Ro(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var iM=ps;function oM(e){return qr(e.slice(0,54))}function lM(e,t){var r=[],s=[],n={},i=!1;return xn(e,function(l,c,d){switch(d){case 632:s.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function cM(e){var t=Ls(),r=[];return Oe(t,628),Oe(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Oe(t,632,oM(n.a)))})}),Oe(t,631),Oe(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:fr(s[0]),e:fr(s[0])};Oe(t,635,nM([i,n])),n.t&&n.t.length>0&&Oe(t,637,P6(n)),Oe(t,636),delete n.iauthor})}),Oe(t,634),Oe(t,629),t.end()}var dM="application/vnd.ms-office.vbaProject";function uM(e){var t=rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(t,n,e.FileIndex[s].content)}}),rt.write(t)}function mM(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&rt.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var bE=["xlsb","xlsm","xlam","biff8","xla"];function fM(){return{"!type":"dialog"}}function hM(){return{"!type":"dialog"}}function pM(){return{"!type":"macro"}}function xM(){return{"!type":"macro"}}var lo=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,n+(l?"":"$")+mr(u)+(c?"":"$")+Cr(d)}return function(n,i){return t=i,n.replace(e,r)}})(),Hx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Vx=(function(){return function(t,r){return t.replace(Hx,function(s,n,i,o,l,c){var d=Px(o)-(i?0:r.c),u=kx(c)-(l?0:r.r),m=u==0?"":l?u+1:"["+u+"]",f=d==0?"":i?d+1:"["+d+"]";return n+"R"+m+"C"+f})}})();function yE(e,t){return e.replace(Hx,function(r,s,n,i,o,l){return s+(n=="$"?n+i:mr(Px(i)+t.c))+(o=="$"?o+l:Cr(kx(l)+t.r))})}function gM(e,t,r){var s=Ms(t),n=s.s,i=fr(r),o={r:i.r-n.r,c:i.c-n.c};return yE(e,o)}function vM(e){return e.length!=1}function yb(e){return e.replace(/_xlfn\./g,"")}function Pr(e){e.l+=1}function Fn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function wE(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return jE(e);r.biff==12&&(s=4)}var n=e.read_shift(s),i=e.read_shift(s),o=Fn(e),l=Fn(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function jE(e){var t=Fn(e),r=Fn(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function bM(e,t,r){if(r.biff<8)return jE(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=Fn(e),o=Fn(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function NE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return yM(e);var s=e.read_shift(r&&r.biff==12?4:2),n=Fn(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function yM(e){var t=Fn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function wM(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function jM(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return NM(e);var n=e.read_shift(s>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function NM(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function SM(e,t,r){var s=(e[e.l++]&96)>>5,n=wE(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function EM(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=wE(e,i,r);return[s,n,o]}function TM(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function AM(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[s,n]}function CM(e,t,r){var s=(e[e.l++]&96)>>5,n=bM(e,t-1,r);return[s,n]}function _M(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function wb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function kM(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function PM(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function OM(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function DM(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function IM(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function SE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function RM(e){return e.read_shift(2),SE(e)}function FM(e){return e.read_shift(2),SE(e)}function LM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=NE(e,0,r);return[s,n]}function MM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=jM(e,0,r);return[s,n]}function BM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=NE(e,0,r);return[s,n,i]}function $M(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[WB[n],AE[n],s]}function zM(e,t,r){var s=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:UM(e);return[n,(i[0]===0?AE:UB)[i[1]]]}function UM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function WM(e,t,r){e.l+=r&&r.biff==2?3:4}function HM(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function VM(e){return e.l++,gn[e.read_shift(1)]}function GM(e){return e.l++,e.read_shift(2)}function qM(e){return e.l++,e.read_shift(1)!==0}function KM(e){return e.l++,hs(e)}function YM(e,t,r){return e.l++,uc(e,t-1,r)}function XM(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Er(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=gn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=hs(e);break;case 2:r[1]=Hi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function JM(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((r.biff==12?Wi:Bu)(e));return n}function ZM(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=XM(e,r.biff);return o}function QM(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,i]}function eB(e,t,r){if(r.biff==5)return tB(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[s,n,i]}function tB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function rB(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function sB(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function aB(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function nB(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[s,n]}var iB=gs,oB=gs,lB=gs;function fc(e,t,r){return e.l+=2,[wM(e)]}function Gx(e){return e.l+=6,[]}var cB=fc,dB=Gx,uB=Gx,mB=fc;function EE(e){return e.l+=2,[Dr(e),e.read_shift(2)&1]}var fB=fc,hB=EE,pB=Gx,xB=fc,gB=fc,vB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bB(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=vB[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:n,C:i}}function yB(e){return e.l+=2,[e.read_shift(4)]}function wB(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function jB(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function NB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function SB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function EB(e){return e.l+=4,[0,0]}var jb={1:{n:"PtgExp",f:HM},2:{n:"PtgTbl",f:lB},3:{n:"PtgAdd",f:Pr},4:{n:"PtgSub",f:Pr},5:{n:"PtgMul",f:Pr},6:{n:"PtgDiv",f:Pr},7:{n:"PtgPower",f:Pr},8:{n:"PtgConcat",f:Pr},9:{n:"PtgLt",f:Pr},10:{n:"PtgLe",f:Pr},11:{n:"PtgEq",f:Pr},12:{n:"PtgGe",f:Pr},13:{n:"PtgGt",f:Pr},14:{n:"PtgNe",f:Pr},15:{n:"PtgIsect",f:Pr},16:{n:"PtgUnion",f:Pr},17:{n:"PtgRange",f:Pr},18:{n:"PtgUplus",f:Pr},19:{n:"PtgUminus",f:Pr},20:{n:"PtgPercent",f:Pr},21:{n:"PtgParen",f:Pr},22:{n:"PtgMissArg",f:Pr},23:{n:"PtgStr",f:YM},26:{n:"PtgSheet",f:wB},27:{n:"PtgEndSheet",f:jB},28:{n:"PtgErr",f:VM},29:{n:"PtgBool",f:qM},30:{n:"PtgInt",f:GM},31:{n:"PtgNum",f:KM},32:{n:"PtgArray",f:_M},33:{n:"PtgFunc",f:$M},34:{n:"PtgFuncVar",f:zM},35:{n:"PtgName",f:QM},36:{n:"PtgRef",f:LM},37:{n:"PtgArea",f:SM},38:{n:"PtgMemArea",f:rB},39:{n:"PtgMemErr",f:iB},40:{n:"PtgMemNoMem",f:oB},41:{n:"PtgMemFunc",f:sB},42:{n:"PtgRefErr",f:aB},43:{n:"PtgAreaErr",f:TM},44:{n:"PtgRefN",f:MM},45:{n:"PtgAreaN",f:CM},46:{n:"PtgMemAreaN",f:NB},47:{n:"PtgMemNoMemN",f:SB},57:{n:"PtgNameX",f:eB},58:{n:"PtgRef3d",f:BM},59:{n:"PtgArea3d",f:EM},60:{n:"PtgRefErr3d",f:nB},61:{n:"PtgAreaErr3d",f:AM},255:{}},TB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},AB={1:{n:"PtgElfLel",f:EE},2:{n:"PtgElfRw",f:xB},3:{n:"PtgElfCol",f:cB},6:{n:"PtgElfRwV",f:gB},7:{n:"PtgElfColV",f:mB},10:{n:"PtgElfRadical",f:fB},11:{n:"PtgElfRadicalS",f:pB},13:{n:"PtgElfColS",f:dB},15:{n:"PtgElfColSV",f:uB},16:{n:"PtgElfRadicalLel",f:hB},25:{n:"PtgList",f:bB},29:{n:"PtgSxName",f:yB},255:{}},CB={0:{n:"PtgAttrNoop",f:EB},1:{n:"PtgAttrSemi",f:IM},2:{n:"PtgAttrIf",f:OM},4:{n:"PtgAttrChoose",f:kM},8:{n:"PtgAttrGoto",f:PM},16:{n:"PtgAttrSum",f:WM},32:{n:"PtgAttrBaxcel",f:wb},33:{n:"PtgAttrBaxcel",f:wb},64:{n:"PtgAttrSpace",f:RM},65:{n:"PtgAttrSpaceSemi",f:FM},128:{n:"PtgAttrIfError",f:DM},255:{}};function hc(e,t,r,s){if(s.biff<8)return gs(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=ZM(e,0,s),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=JM(e,r[o][1],s),i.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(gs(e,t)),i}function pc(e,t,r){for(var s=e.l+t,n,i,o=[];s!=e.l;)t=s-e.l,i=e[e.l],n=jb[i]||jb[TB[i]],(i===24||i===25)&&(n=(i===24?AB:CB)[e[e.l+1]]),!n||!n.f?gs(e,t):o.push([n.n,n.f(e,t,r)]);return o}function _B(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var kB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function PB(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function TE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Nb(e,t,r){var s=TE(e,t,r);return s=="#REF"?s:PB(s,r)}function ds(e,t,r,s,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,m=0,f=0,h,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,g="",v=0,w=e[0].length;v<w;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:g=vr(" ",e[0][x][1][1]);break;case 1:g=vr("\r",e[0][x][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}d=d+g,x=-1}l.push(d+kB[y[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=pl(y[1][1],o,n),l.push(xl(u,i));break;case"PtgRefN":u=r?pl(y[1][1],r,n):y[1][1],l.push(xl(u,i));break;case"PtgRef3d":m=y[1][1],u=pl(y[1][2],o,n),p=Nb(s,m,n),l.push(p+"!"+xl(u,i));break;case"PtgFunc":case"PtgFuncVar":var S=y[1][0],E=y[1][1];S||(S=0),S&=127;var N=S==0?[]:l.slice(-S);l.length-=S,E==="User"&&(E=N.shift()),l.push(E+"("+N.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":h=Z1(y[1][1],r?{s:r}:o,n),l.push(Om(h,n));break;case"PtgArea":h=Z1(y[1][1],o,n),l.push(Om(h,n));break;case"PtgArea3d":m=y[1][1],h=y[1][2],p=Nb(s,m,n),l.push(p+"!"+Om(h,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var j=(s.names||[])[f-1]||(s[0]||[])[f],T=j?j.Name:"SH33TJSNAME"+String(f);T&&T.slice(0,6)=="_xlfn."&&!n.xlfn&&(T=T.slice(6)),l.push(T);break;case"PtgNameX":var C=y[1][1];f=y[1][2];var L;if(n.biff<=5)C<0&&(C=-C),s[C]&&(L=s[C][f]);else{var A="";if(((s[C]||[])[0]||[])[0]==14849||(((s[C]||[])[0]||[])[0]==1025?s[C][f]&&s[C][f].itab>0&&(A=s.SheetNames[s[C][f].itab-1]+"!"):A=s.SheetNames[f-1]+"!"),s[C]&&s[C][f])A+=s[C][f].Name;else if(s[0]&&s[0][f])A+=s[0][f].Name;else{var P=(TE(s,C,n)||"").split(";;");P[f-1]?A=P[f-1]:A+="SH33TJSERRX"}l.push(A);break}L||(L={Name:"SH33TJSERRY"}),l.push(L.Name);break;case"PtgParen":var I="(",_=")";if(x>=0){switch(g="",e[0][x][1][0]){case 2:I=vr(" ",e[0][x][1][1])+I;break;case 3:I=vr("\r",e[0][x][1][1])+I;break;case 4:_=vr(" ",e[0][x][1][1])+_;break;case 5:_=vr("\r",e[0][x][1][1])+_;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(I+l.pop()+_);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var D={c:r.c,r:r.r};if(s.sharedf[ct(u)]){var W=s.sharedf[ct(u)];l.push(ds(W,o,D,s,n))}else{var K=!1;for(c=0;c!=s.arrayf.length;++c)if(d=s.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(ds(d[1],o,D,s,n)),K=!0;break}K||l.push(y[1])}break;case"PtgArray":l.push("{"+_B(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&J.indexOf(e[0][v][0])==-1){y=e[0][x];var F=!0;switch(y[1][0]){case 4:F=!1;case 0:g=vr(" ",y[1][1]);break;case 5:F=!1;case 1:g=vr("\r",y[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((F?g:"")+l.pop()+(F?"":g)),x=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function OB(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],gs(e,t-2)];var l=pc(e,o,r);return t!==o+n&&(i=hc(e,t-o-n,l,r)),e.l=s,[l,i]}function DB(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],gs(e,t-2)];var l=pc(e,o,r);return t!==o+n&&(i=hc(e,t-o-n,l,r)),e.l=s,[l,i]}function IB(e,t,r,s){var n=e.l+t,i=pc(e,s,r),o;return n!==e.l&&(o=hc(e,n-e.l,i,r)),[i,o]}function RB(e,t,r){var s=e.l+t,n,i=e.read_shift(2),o=pc(e,i,r);return i==65535?[[],gs(e,t-2)]:(t!==i+2&&(n=hc(e,s-i-2,o,r)),[o,n])}function FB(e){var t;if(Za(e,e.l+6)!==65535)return[hs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function LB(e){if(e==null){var t=Ee(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ti(e);return Ti(0)}function Lm(e,t,r){var s=e.l+t,n=Ka(e);r.biff==2&&++e.l;var i=FB(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=DB(e,s-e.l,r);return{cell:n,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function MB(e,t,r,s,n){var i=Ci(t,r,n),o=LB(e.v),l=Ee(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=Ee(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var m=Gr([i,o,l,d]);return m}function $u(e,t,r){var s=e.read_shift(4),n=pc(e,s,r),i=e.read_shift(4),o=i>0?hc(e,i,n,r):null;return[n,o]}var BB=$u,zu=$u,$B=$u,zB=$u,UB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},AE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},WB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Sb(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function HB(e){var t="of:="+e.replace(Hx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Mm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function VB(e){return e.replace(/\./,"!")}var vl={},co={},bl=typeof Map<"u";function qx(e,t,r){var s=0,n=e.length;if(r){if(bl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=bl?r.get(t):r[t];s<i.length;++s)if(e[i[s]].t===t)return e.Count++,i[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(bl?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Uu(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(us=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Ml(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=Ld(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function xi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Hn(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){rn(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===s)return n;return e[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function CE(e,t,r,s,n,i){try{s.cellNF&&(e.z=ot[t])}catch(l){if(s.WTF)throw l}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=rr(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(ot[t]==null&&rn(UI[t]||"General",t),e.t==="e")e.w=e.w||gn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pl(e.v);else if(e.t==="d"){var o=Br(e.v);(o|0)===o?e.w=o.toString(10):e.w=Pl(o)}else{if(e.v===void 0)return"";e.w=Si(e.v,co)}else e.t==="d"?e.w=ga(t,Br(e.v),co):e.w=ga(t,e.v,co)}catch(l){if(s.WTF)throw l}if(s.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Fd(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Fd(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(s.WTF&&i.Fills)throw l}}}function GB(e,t,r){if(e&&e["!ref"]){var s=_t(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function qB(e,t){var r=_t(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=vt(r))}var KB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,YB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,XB=/<(?:\w:)?hyperlink [^>]*>/mg,JB=/"(\w*:\w*)"/,ZB=/<(?:\w:)?col\b[^>]*[\/]?>/g,QB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,e7=/<(?:\w:)?pageMargins[^>]*\/>/g,_E=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,t7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,r7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function s7(e,t,r,s,n,i,o){if(!e)return e;s||(s={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",m=e.match(YB);m?(d=e.slice(0,m.index),u=e.slice(m.index+m[0].length)):d=u=e;var f=d.match(_E);f?Kx(f[0],l,n,r):(f=d.match(t7))&&n7(f[0],f[1]||"",l,n,r);var h=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=d.slice(h,h+50).match(JB);p&&qB(l,p[1])}var x=d.match(r7);x&&x[1]&&v7(x[1],n);var g=[];if(t.cellStyles){var v=d.match(ZB);v&&f7(g,v)}m&&w7(m[1],l,t,c,i,o);var w=u.match(QB);w&&(l["!autofilter"]=p7(w[0]));var y=[],S=u.match(KB);if(S)for(h=0;h!=S.length;++h)y[h]=_t(S[h].slice(S[h].indexOf('"')+1));var E=u.match(XB);E&&d7(l,E,s);var N=u.match(e7);if(N&&(l["!margins"]=u7(dt(N[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=vt(c)),t.sheetRows>0&&l["!ref"]){var j=_t(l["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>c.e.r&&(j.e.r=c.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>c.e.c&&(j.e.c=c.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),l["!fullref"]=l["!ref"],l["!ref"]=vt(j))}return g.length>0&&(l["!cols"]=g),y.length>0&&(l["!merges"]=y),l}function a7(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+vt(e[r])+'"/>';return t+"</mergeCells>"}function Kx(e,t,r,s){var n=dt(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=Ct(Gt(n.codeName)))}function n7(e,t,r,s,n){Kx(e.slice(0,e.indexOf(">")),r,s,n)}function i7(e,t,r,s,n){var i=!1,o={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=za(Ut(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+$e("outlinePr",null,d)}!i&&!l||(n[n.length]=$e("sheetPr",l,o))}var o7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],l7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function c7(e){var t={sheet:1};return o7.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),l7.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=zx(e.password).toString(16).toUpperCase()),$e("sheetProtection",null,t)}function d7(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var i=dt(Gt(t[n]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Ct(i.location))):(i.Target="#"+Ct(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=_t(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=ct({c:d,r:c});s?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function u7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function m7(e){return xi(e),$e("pageMargins",null,e)}function f7(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=dt(t[s],!0);n.hidden&&(n.hidden=er(n.hidden));var i=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Ux(n.width)),Rn(n);i<=o;)e[i++]=sr(n)}}function h7(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=$e("col",null,Uu(n,s)));return r[r.length]="</cols>",r.join("")}function p7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function x7(e,t,r,s){var n=typeof e.ref=="string"?e.ref:vt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Ms(n);o.s.r==o.e.r&&(o.e.r=Ms(t["!ref"]).e.r,n=vt(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),$e("autoFilter",null,{ref:n})}var g7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function v7(e,t){t.Views||(t.Views=[{}]),(e.match(g7)||[]).forEach(function(r,s){var n=dt(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),er(n.rightToLeft)&&(t.Views[s].RTL=!0)})}function b7(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),$e("sheetViews",$e("sheetView",null,n),{})}function y7(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=gn[e.v];break;case"d":s&&s.cellDates?n=rr(e.v,-1).toISOString():(e=sr(e),e.t="n",n=""+(e.v=Br(rr(e.v)))),typeof e.z>"u"&&(e.z=ot[14]);break;default:n=e.v;break}var l=ss("v",Ut(n)),c={r:t},d=Hn(s.cellXfs,e,s);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=ss("v",""+qx(s.Strings,e.v,s.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=$e("f",Ut(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),$e("c",l,c)}var w7=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=Ol("v"),o=Ol("f");return function(c,d,u,m,f,h){for(var p=0,x="",g=[],v=[],w=0,y=0,S=0,E="",N,j,T=0,C=0,L,A,P=0,I=0,_=Array.isArray(h.CellXf),D,W=[],K=[],J=Array.isArray(d),F=[],le={},Ae=!1,O=!!u.sheetStubs,G=c.split(t),U=0,B=G.length;U!=B;++U){x=G[U].trim();var Y=x.length;if(Y!==0){var te=0;e:for(p=0;p<Y;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(j=dt(x.slice(te,p),!0),T=j.r!=null?parseInt(j.r,10):T+1,C=-1,u.sheetRows&&u.sheetRows<T)continue;le={},Ae=!1,j.ht&&(Ae=!0,le.hpt=parseFloat(j.ht),le.hpx=vo(le.hpt)),j.hidden=="1"&&(Ae=!0,le.hidden=!0),j.outlineLevel!=null&&(Ae=!0,le.level=+j.outlineLevel),Ae&&(F[T-1]=le)}break;case"<":te=p;break}if(te>=p)break;if(j=dt(x.slice(te,p),!0),T=j.r!=null?parseInt(j.r,10):T+1,C=-1,!(u.sheetRows&&u.sheetRows<T)){m.s.r>T-1&&(m.s.r=T-1),m.e.r<T-1&&(m.e.r=T-1),u&&u.cellStyles&&(le={},Ae=!1,j.ht&&(Ae=!0,le.hpt=parseFloat(j.ht),le.hpx=vo(le.hpt)),j.hidden=="1"&&(Ae=!0,le.hidden=!0),j.outlineLevel!=null&&(Ae=!0,le.level=+j.outlineLevel),Ae&&(F[T-1]=le)),g=x.slice(p).split(e);for(var ae=0;ae!=g.length&&g[ae].trim().charAt(0)=="<";++ae);for(g=g.slice(ae),p=0;p!=g.length;++p)if(x=g[p].trim(),x.length!==0){if(v=x.match(r),w=p,y=0,S=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,v!=null&&v.length===2){for(w=0,E=v[1],y=0;y!=E.length&&!((S=E.charCodeAt(y)-64)<1||S>26);++y)w=26*w+S;--w,C=w}else++C;for(y=0;y!=x.length&&x.charCodeAt(y)!==62;++y);if(++y,j=dt(x.slice(0,y),!0),j.r||(j.r=ct({r:T-1,c:C})),E=x.slice(y),N={t:""},(v=E.match(i))!=null&&v[1]!==""&&(N.v=Ct(v[1])),u.cellFormula){if((v=E.match(o))!=null&&v[1]!==""){if(N.f=Ct(Gt(v[1])).replace(/\r\n/g,`
`),u.xlfn||(N.f=yb(N.f)),v[0].indexOf('t="array"')>-1)N.F=(E.match(n)||[])[1],N.F.indexOf(":")>-1&&W.push([_t(N.F),N.F]);else if(v[0].indexOf('t="shared"')>-1){A=dt(v[0]);var ne=Ct(Gt(v[1]));u.xlfn||(ne=yb(ne)),K[parseInt(A.si,10)]=[A,ne,j.r]}}else(v=E.match(/<f[^>]*\/>/))&&(A=dt(v[0]),K[A.si]&&(N.f=gM(K[A.si][1],K[A.si][2],j.r)));var fe=fr(j.r);for(y=0;y<W.length;++y)fe.r>=W[y][0].s.r&&fe.r<=W[y][0].e.r&&fe.c>=W[y][0].s.c&&fe.c<=W[y][0].e.c&&(N.F=W[y][1])}if(j.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(O)N.t="z";else continue;else N.t=j.t||"n";switch(m.s.c>C&&(m.s.c=C),m.e.c<C&&(m.e.c=C),N.t){case"n":if(N.v==""||N.v==null){if(!O)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!O)continue;N.t="z"}else L=vl[parseInt(N.v,10)],N.v=L.t,N.r=L.r,u.cellHTML&&(N.h=L.h);break;case"str":N.t="s",N.v=N.v!=null?Gt(N.v):"",u.cellHTML&&(N.h=Tx(N.v));break;case"inlineStr":v=E.match(s),N.t="s",v!=null&&(L=$x(v[1]))?(N.v=L.t,u.cellHTML&&(N.h=L.h)):N.v="";break;case"b":N.v=er(N.v);break;case"d":u.cellDates?N.v=rr(N.v,1):(N.v=Br(rr(N.v,1)),N.t="n");break;case"e":(!u||u.cellText!==!1)&&(N.w=N.v),N.v=PS[N.v];break}if(P=I=0,D=null,_&&j.s!==void 0&&(D=h.CellXf[j.s],D!=null&&(D.numFmtId!=null&&(P=D.numFmtId),u.cellStyles&&D.fillId!=null&&(I=D.fillId))),CE(N,P,I,u,f,h),u.cellDates&&_&&N.t=="n"&&Oo(ot[P])&&(N.t="d",N.v=Mu(N.v)),j.cm&&u.xlmeta){var je=(u.xlmeta.Cell||[])[+j.cm-1];je&&je.type=="XLDAPR"&&(N.D=!0)}if(J){var z=fr(j.r);d[z.r]||(d[z.r]=[]),d[z.r][z.c]=N}else d[j.r]=N}}}}F.length>0&&(d["!rows"]=F)}})();function j7(e,t,r,s){var n=[],i=[],o=_t(e["!ref"]),l="",c,d="",u=[],m=0,f=0,h=e["!rows"],p=Array.isArray(e),x={r:d},g,v=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=mr(f);for(m=o.s.r;m<=o.e.r;++m){for(i=[],d=Cr(m),f=o.s.c;f<=o.e.c;++f){c=u[f]+d;var w=p?(e[m]||[])[f]:e[c];w!==void 0&&(l=y7(w,c,e,t))!=null&&i.push(l)}(i.length>0||h&&h[m])&&(x={r:d},h&&h[m]&&(g=h[m],g.hidden&&(x.hidden=1),v=-1,g.hpx?v=Bl(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(x.ht=v,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),n[n.length]=$e("row",i.join(""),x))}if(h)for(;m<h.length;++m)h&&h[m]&&(x={r:m+1},g=h[m],g.hidden&&(x.hidden=1),v=-1,g.hpx?v=Bl(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(x.ht=v,x.customHeight=1),g.level&&(x.outlineLevel=g.level),n[n.length]=$e("row","",x));return n.join("")}function kE(e,t,r,s){var n=[_r,$e("worksheet",null,{xmlns:Bi[0],"xmlns:r":Lr.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=_t(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=vt(u)}s||(s={}),c["!comments"]=[];var m=[];i7(c,r,e,t,n),n[n.length]=$e("dimension",null,{ref:d}),n[n.length]=b7(c,t,e,r),t.sheetFormat&&(n[n.length]=$e("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=h7(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=j7(c,t),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=c7(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=x7(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=a7(c["!merges"]));var f=-1,h,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(h={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=Bt(s,-1,Ut(x[1].Target).replace(/#.*$/,""),jt.HLINK),h["r:id"]="rId"+p),(f=x[1].Target.indexOf("#"))>-1&&(h.location=Ut(x[1].Target.slice(f+1))),x[1].Tooltip&&(h.tooltip=Ut(x[1].Tooltip)),n[n.length]=$e("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=m7(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=ss("ignoredErrors",$e("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(p=Bt(s,-1,"../drawings/drawing"+(e+1)+".xml",jt.DRAW),n[n.length]=$e("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=m),c["!comments"].length>0&&(p=Bt(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",jt.VML),n[n.length]=$e("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function N7(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function S7(e,t,r){var s=Ee(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var i=320;n.hpx?i=Bl(n.hpx)*20:n.hpt&&(i=n.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var m=-1,f=-1,h=u<<10;h<u+1<<10;++h){d.c=h;var p=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ct(d)];p&&(m<0&&(m=h),f=h)}m<0||(++l,s.write_shift(4,m),s.write_shift(4,f))}var x=s.l;return s.l=c,s.write_shift(4,l),s.l=x,s.length>s.l?s.slice(0,s.l):s}function E7(e,t,r,s){var n=S7(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&Oe(e,0,n)}var T7=Wi,A7=Ro;function C7(){}function _7(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=O6(e),r}function k7(e,t,r){r==null&&(r=Ee(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Dd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),TS(e,r),r.slice(0,r.l)}function P7(e){var t=ya(e);return[t]}function O7(e,t,r){return r==null&&(r=Ee(8)),$i(t,r)}function D7(e){var t=zi(e);return[t]}function I7(e,t,r){return r==null&&(r=Ee(4)),Ui(t,r)}function R7(e){var t=ya(e),r=e.read_shift(1);return[t,r,"b"]}function F7(e,t,r){return r==null&&(r=Ee(9)),$i(t,r),r.write_shift(1,e.v?1:0),r}function L7(e){var t=zi(e),r=e.read_shift(1);return[t,r,"b"]}function M7(e,t,r){return r==null&&(r=Ee(5)),Ui(t,r),r.write_shift(1,e.v?1:0),r}function B7(e){var t=ya(e),r=e.read_shift(1);return[t,r,"e"]}function $7(e,t,r){return r==null&&(r=Ee(9)),$i(t,r),r.write_shift(1,e.v),r}function z7(e){var t=zi(e),r=e.read_shift(1);return[t,r,"e"]}function U7(e,t,r){return r==null&&(r=Ee(8)),Ui(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function W7(e){var t=ya(e),r=e.read_shift(4);return[t,r,"s"]}function H7(e,t,r){return r==null&&(r=Ee(12)),$i(t,r),r.write_shift(4,t.v),r}function V7(e){var t=zi(e),r=e.read_shift(4);return[t,r,"s"]}function G7(e,t,r){return r==null&&(r=Ee(8)),Ui(t,r),r.write_shift(4,t.v),r}function q7(e){var t=ya(e),r=hs(e);return[t,r,"n"]}function K7(e,t,r){return r==null&&(r=Ee(16)),$i(t,r),Ti(e.v,r),r}function PE(e){var t=zi(e),r=hs(e);return[t,r,"n"]}function Y7(e,t,r){return r==null&&(r=Ee(12)),Ui(t,r),Ti(e.v,r),r}function X7(e){var t=ya(e),r=Rx(e);return[t,r,"n"]}function J7(e,t,r){return r==null&&(r=Ee(12)),$i(t,r),AS(e.v,r),r}function Z7(e){var t=zi(e),r=Rx(e);return[t,r,"n"]}function Q7(e,t,r){return r==null&&(r=Ee(8)),Ui(t,r),AS(e.v,r),r}function e$(e){var t=ya(e),r=Ox(e);return[t,r,"is"]}function t$(e){var t=ya(e),r=ps(e);return[t,r,"str"]}function r$(e,t,r){return r==null&&(r=Ee(12+4*e.v.length)),$i(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function s$(e){var t=zi(e),r=ps(e);return[t,r,"str"]}function a$(e,t,r){return r==null&&(r=Ee(8+4*e.v.length)),Ui(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function n$(e,t,r){var s=e.l+t,n=ya(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var l=zu(e,s-e.l,r);o[3]=ds(l,null,n,r.supbooks,r)}else e.l=s;return o}function i$(e,t,r){var s=e.l+t,n=ya(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var l=zu(e,s-e.l,r);o[3]=ds(l,null,n,r.supbooks,r)}else e.l=s;return o}function o$(e,t,r){var s=e.l+t,n=ya(e);n.r=r["!row"];var i=hs(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var l=zu(e,s-e.l,r);o[3]=ds(l,null,n,r.supbooks,r)}else e.l=s;return o}function l$(e,t,r){var s=e.l+t,n=ya(e);n.r=r["!row"];var i=ps(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var l=zu(e,s-e.l,r);o[3]=ds(l,null,n,r.supbooks,r)}else e.l=s;return o}var c$=Wi,d$=Ro;function u$(e,t){return t==null&&(t=Ee(4)),t.write_shift(4,e),t}function m$(e,t){var r=e.l+t,s=Wi(e),n=Dx(e),i=ps(e),o=ps(e),l=ps(e);e.l=r;var c={rfx:s,relId:n,loc:i,display:l};return o&&(c.Tooltip=o),c}function f$(e,t){var r=Ee(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ro({s:fr(e[0]),e:fr(e[0])},r),Ix("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return qr(n||"",r),qr(e[1].Tooltip||"",r),qr("",r),r.slice(0,r.l)}function h$(){}function p$(e,t,r){var s=e.l+t,n=CS(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var l=BB(e,s-e.l,r);o[1]=l}else e.l=s;return o}function x$(e,t,r){var s=e.l+t,n=Wi(e),i=[n];if(r.cellFormula){var o=zB(e,s-e.l,r);i[1]=o,e.l=s}else e.l=s;return i}function g$(e,t,r){r==null&&(r=Ee(18));var s=Uu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var OE=["left","right","top","bottom","header","footer"];function v$(e){var t={};return OE.forEach(function(r){t[r]=hs(e)}),t}function b$(e,t){return t==null&&(t=Ee(48)),xi(e),OE.forEach(function(r){Ti(e[r],t)}),t}function y$(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function w$(e,t,r){r==null&&(r=Ee(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function j$(e){var t=Ee(24);return t.write_shift(4,4),t.write_shift(4,1),Ro(e,t),t}function N$(e,t){return t==null&&(t=Ee(66)),t.write_shift(2,e.password?zx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function S$(){}function E$(){}function T$(e,t,r,s,n,i,o){if(!e)return e;var l=t||{};s||(s={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,f=!1,h,p,x,g,v,w,y,S,E,N=[];l.biff=12,l["!row"]=0;var j=0,T=!1,C=[],L={},A=l.supbooks||n.supbooks||[[]];if(A.sharedf=L,A.arrayf=C,A.SheetNames=n.SheetNames||n.Sheets.map(function(J){return J.name}),!l.supbooks&&(l.supbooks=A,n.Names))for(var P=0;P<n.Names.length;++P)A[0][P+1]=n.Names[P];var I=[],_=[],D=!1;$l[16]={n:"BrtShortReal",f:PE};var W;if(xn(e,function(F,le,Ae){if(!f)switch(Ae){case 148:d=F;break;case 0:h=F,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),S=Cr(g=h.r),l["!row"]=h.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=vo(F.hpt)),_[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:F[2]},F[2]){case"n":p.v=F[1];break;case"s":y=vl[F[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!F[1];break;case"e":p.v=F[1],l.cellText!==!1&&(p.w=gn[p.v]);break;case"str":p.t="s",p.v=F[1];break;case"is":p.t="s",p.v=F[1].t;break}if((x=o.CellXf[F[0].iStyleRef])&&CE(p,x.numFmtId,null,l,i,o),v=F[0].c==-1?v+1:F[0].c,l.dense?(c[g]||(c[g]=[]),c[g][v]=p):c[mr(v)+S]=p,l.cellFormula){for(T=!1,j=0;j<C.length;++j){var O=C[j];h.r>=O[0].s.r&&h.r<=O[0].e.r&&v>=O[0].s.c&&v<=O[0].e.c&&(p.F=vt(O[0]),T=!0)}!T&&F.length>3&&(p.f=F[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>v&&(u.s.c=v),u.e.r<h.r&&(u.e.r=h.r),u.e.c<v&&(u.e.c=v),l.cellDates&&x&&p.t=="n"&&Oo(ot[x.numFmtId])){var G=ii(p.v);G&&(p.t="d",p.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}W&&(W.type=="XLDAPR"&&(p.D=!0),W=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;p={t:"z",v:void 0},v=F[0].c==-1?v+1:F[0].c,l.dense?(c[g]||(c[g]=[]),c[g][v]=p):c[mr(v)+S]=p,u.s.r>h.r&&(u.s.r=h.r),u.s.c>v&&(u.s.c=v),u.e.r<h.r&&(u.e.r=h.r),u.e.c<v&&(u.e.c=v),W&&(W.type=="XLDAPR"&&(p.D=!0),W=void 0);break;case 176:N.push(F);break;case 49:W=((l.xlmeta||{}).Cell||[])[F-1];break;case 494:var U=s["!id"][F.relId];for(U?(F.Target=U.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=U):F.relId==""&&(F.Target="#"+F.loc),g=F.rfx.s.r;g<=F.rfx.e.r;++g)for(v=F.rfx.s.c;v<=F.rfx.e.c;++v)l.dense?(c[g]||(c[g]=[]),c[g][v]||(c[g][v]={t:"z",v:void 0}),c[g][v].l=F):(w=ct({c:v,r:g}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=F);break;case 426:if(!l.cellFormula)break;C.push(F),E=l.dense?c[g][v]:c[mr(v)+S],E.f=ds(F[1],u,{r:h.r,c:v},A,l),E.F=vt(F[0]);break;case 427:if(!l.cellFormula)break;L[ct(F[0].s)]=F[1],E=l.dense?c[g][v]:c[mr(v)+S],E.f=ds(F[1],u,{r:h.r,c:v},A,l);break;case 60:if(!l.cellStyles)break;for(;F.e>=F.s;)I[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},D||(D=!0,Ux(F.w/256)),Rn(I[F.e+1]);break;case 161:c["!autofilter"]={ref:vt(F)};break;case 476:c["!margins"]=F;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),F.name&&(n.Sheets[r].CodeName=F.name),(F.above||F.left)&&(c["!outline"]={above:F.above,left:F.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),F.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!le.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+Ae.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=vt(d||u)),l.sheetRows&&c["!ref"]){var K=_t(c["!ref"]);l.sheetRows<=+K.e.r&&(K.e.r=l.sheetRows-1,K.e.r>u.e.r&&(K.e.r=u.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>u.e.c&&(K.e.c=u.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),c["!fullref"]=c["!ref"],c["!ref"]=vt(K))}return N.length>0&&(c["!merges"]=N),I.length>0&&(c["!cols"]=I),_.length>0&&(c["!rows"]=_),c}function A$(e,t,r,s,n,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=sr(t),t.z=t.z||ot[14],t.v=Br(rr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:s};switch(c.s=Hn(n.cellXfs,t,n),t.l&&i["!links"].push([ct(c),t.l]),t.c&&i["!comments"].push([ct(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=qx(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,o?Oe(e,18,G7(t,c)):Oe(e,7,H7(t,c))):(c.t="str",o?Oe(e,17,a$(t,c)):Oe(e,6,r$(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Oe(e,13,Q7(t,c)):Oe(e,2,J7(t,c)):o?Oe(e,16,Y7(t,c)):Oe(e,5,K7(t,c)),!0;case"b":return c.t="b",o?Oe(e,15,M7(t,c)):Oe(e,4,F7(t,c)),!0;case"e":return c.t="e",o?Oe(e,14,U7(t,c)):Oe(e,3,$7(t,c)),!0}return o?Oe(e,12,I7(t,c)):Oe(e,1,O7(t,c)),!0}function C$(e,t,r,s){var n=_t(t["!ref"]||"A1"),i,o="",l=[];Oe(e,145);var c=Array.isArray(t),d=n.e.r;t["!rows"]&&(d=Math.max(n.e.r,t["!rows"].length-1));for(var u=n.s.r;u<=d;++u){o=Cr(u),E7(e,t,n,u);var m=!1;if(u<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){u===n.s.r&&(l[f]=mr(f)),i=l[f]+o;var h=c?(t[u]||[])[f]:t[i];if(!h){m=!1;continue}m=A$(e,h,u,f,s,t,m)}}Oe(e,146)}function _$(e,t){!t||!t["!merges"]||(Oe(e,177,u$(t["!merges"].length)),t["!merges"].forEach(function(r){Oe(e,176,d$(r))}),Oe(e,178))}function k$(e,t){!t||!t["!cols"]||(Oe(e,390),t["!cols"].forEach(function(r,s){r&&Oe(e,60,g$(s,r))}),Oe(e,391))}function P$(e,t){!t||!t["!ref"]||(Oe(e,648),Oe(e,649,j$(_t(t["!ref"]))),Oe(e,650))}function O$(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=Bt(r,-1,s[1].Target.replace(/#.*$/,""),jt.HLINK);Oe(e,494,f$(s,n))}}),delete t["!links"]}function D$(e,t,r,s){if(t["!comments"].length>0){var n=Bt(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",jt.VML);Oe(e,551,Ix("rId"+n)),t["!legacy"]=n}}function I$(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:vt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ms(i);l.s.r==l.e.r&&(l.e.r=Ms(t["!ref"]).e.r,i=vt(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),Oe(e,161,Ro(_t(i))),Oe(e,162)}}function R$(e,t,r){Oe(e,133),Oe(e,137,w$(t,r)),Oe(e,138),Oe(e,134)}function F$(e,t){t["!protect"]&&Oe(e,535,N$(t["!protect"]))}function L$(e,t,r,s){var n=Ls(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=_t(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Oe(n,129),(r.vbaraw||o["!outline"])&&Oe(n,147,k7(l,o["!outline"])),Oe(n,148,A7(c)),R$(n,o,r.Workbook),k$(n,o),C$(n,o,e,t),F$(n,o),I$(n,o,r,e),_$(n,o),O$(n,o,s),o["!margins"]&&Oe(n,476,b$(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&P$(n,o),D$(n,o,e,s),Oe(n,130),n.end()}function M$(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=Ct((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){s=i.replace(/<.*?>/g,"")}),[t,n,s]}function B$(e,t,r,s,n,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var f=M$(m);u.s.r=u.s.c=0,u.e.c=l,d=mr(l),f[0].forEach(function(h,p){o[d+Cr(p)]={t:"n",v:h,z:f[1]},c=p}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=vt(u)),o}function $$(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(_E);return l&&Kx(l[0],i,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}function z$(e,t){e.l+=10;var r=ps(e);return{name:r}}function U$(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return xn(e,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}var Yx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],W$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],H$=[],V$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Eb(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var i=t[n];if(s[i[0]]==null)s[i[0]]=i[1];else switch(i[2]){case"bool":typeof s[i[0]]=="string"&&(s[i[0]]=er(s[i[0]]));break;case"int":typeof s[i[0]]=="string"&&(s[i[0]]=parseInt(s[i[0]],10));break}}}function Tb(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=er(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function DE(e){Tb(e.WBProps,Yx),Tb(e.CalcPr,V$),Eb(e.WBView,W$),Eb(e.Sheets,H$),co.date1904=er(e.WBProps.date1904)}function G$(e){return!e.Workbook||!e.Workbook.WBProps?"false":er(e.Workbook.WBProps.date1904)?"true":"false"}var q$="][*?/\\".split("");function IE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return q$.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function K$(e,t,r){e.forEach(function(s,n){IE(s);for(var i=0;i<n;++i)if(s==e[i])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=t&&t[n]&&t[n].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Y$(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];K$(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)GB(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var X$=/<\w+:workbook/;function J$(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",i={},o=0;if(e.replace(vs,function(c,d){var u=dt(c);switch(qa(u[0])){case"<?xml":break;case"<workbook":c.match(X$)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[n];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Yx.forEach(function(m){if(u[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=er(u[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(u[m[0]],10);break;default:r.WBProps[m[0]]=u[m[0]]}}),u.codeName&&(r.WBProps.CodeName=Gt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ct(Gt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":i={},i.Name=Gt(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),er(u.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=Ct(Gt(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Bi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return DE(r),r}function RE(e){var t=[_r];t[t.length]=$e("workbook",null,{xmlns:Bi[0],"xmlns:r":Lr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Yx.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=$e("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Ut(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=$e("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=$e("definedName",Ut(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Z$(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Qh(e),r.name=ps(e),r}function Q$(e,t){return t||(t=Ee(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Ix(e.strRelID,t),qr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function ez(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?ps(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function tz(e,t){t||(t=Ee(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),TS(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function rz(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function sz(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=D6(e),o=$B(e,0,r),l=Dx(e);e.l=s;var c={Name:i,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function az(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],$l[16]={n:"BrtFRTArchID$",f:rz},xn(e,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=ds(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(u),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(u),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),DE(r),r.Names=i,r.supbooks=o,r}function nz(e,t){Oe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Oe(e,156,Q$(n))}Oe(e,144)}function iz(e,t){t||(t=Ee(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return qr("SheetJS",t),qr(Td.version,t),qr(Td.version,t),qr("7262",t),t.length>t.l?t.slice(0,t.l):t}function oz(e,t){t||(t=Ee(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function lz(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,i=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&i==-1&&(i=s);i>n||(Oe(e,135),Oe(e,158,oz(n)),Oe(e,136))}}function cz(e,t){var r=Ls();return Oe(r,131),Oe(r,128,iz()),Oe(r,153,tz(e.Workbook&&e.Workbook.WBProps||null)),lz(r,e),nz(r,e),Oe(r,132),r.end()}function dz(e,t,r){return t.slice(-4)===".bin"?az(e,r):J$(e,r)}function uz(e,t,r,s,n,i,o,l){return t.slice(-4)===".bin"?T$(e,s,r,n,i,o,l):s7(e,s,r,n,i,o,l)}function mz(e,t,r,s,n,i,o,l){return t.slice(-4)===".bin"?U$(e,s,r,n,i):$$(e,s,r,n,i)}function fz(e,t,r,s,n,i,o,l){return t.slice(-4)===".bin"?pM():xM()}function hz(e,t,r,s,n,i,o,l){return t.slice(-4)===".bin"?fM():hM()}function pz(e,t,r,s){return t.slice(-4)===".bin"?dL(e,r,s):ZF(e,r,s)}function xz(e,t,r){return pE(e,r)}function gz(e,t,r){return t.slice(-4)===".bin"?gF(e,r):hF(e,r)}function vz(e,t,r){return t.slice(-4)===".bin"?lM(e,r):QL(e,r)}function bz(e,t,r){return t.slice(-4)===".bin"?XL(e):KL(e)}function yz(e,t,r,s){return r.slice(-4)===".bin"?JL(e,t,r,s):void 0}function wz(e,t,r){return t.slice(-4)===".bin"?VL(e,t,r):qL(e,t,r)}function jz(e,t,r){return(t.slice(-4)===".bin"?cz:RE)(e)}function Nz(e,t,r,s,n){return(t.slice(-4)===".bin"?L$:kE)(e,r,s,n)}function Sz(e,t,r){return(t.slice(-4)===".bin"?yL:fE)(e,r)}function Ez(e,t,r){return(t.slice(-4)===".bin"?yF:nE)(e,r)}function Tz(e,t,r){return(t.slice(-4)===".bin"?cM:vE)(e)}function Az(e){return(e.slice(-4)===".bin"?GL:xE)()}var FE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,LE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Sa(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(FE),i,o,l,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(LE),(o=i[1].indexOf(":"))===-1?s[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),s[l]=i[2].slice(1,i[2].length-1));return s}function Cz(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(FE),n,i,o,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(LE),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),r[o]=n[2].slice(1,n[2].length-1));return r}var yl;function _z(e,t){var r=yl[e]||Ct(e);return r==="General"?Si(t):ga(r,t)}function kz(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=er(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=rr(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ct(t)]=n}function Pz(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||gn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pl(e.v):e.w=Si(e.v):e.w=_z(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var s=yl[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&Oo(s)){var n=ii(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function Oz(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=HF[s.Pattern]||s.Pattern)}e[t.ID]=t}function Dz(e,t,r,s,n,i,o,l,c,d){var u="General",m=s.StyleID,f={};d=d||{};var h=[],p=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);i[m]!==void 0&&(i[m].nf&&(u=i[m].nf),i[m].Interior&&h.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=er(e);break;case"String":s.t="s",s.r=W1(Ct(e)),s.v=e.indexOf("<")>-1?Ct(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(rr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=Ct(e):s.v<60&&(s.v=s.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=PS[e],d.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=W1(t||e));break}if(Pz(s,u,d),d.cellFormula!==!1)if(s.Formula){var x=Ct(s.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),s.f=lo(x,n),delete s.Formula,s.ArrayRange=="RC"?s.F=lo("RC:RC",n):s.ArrayRange&&(s.F=lo(s.ArrayRange,n),c.push([_t(s.F),s.F]))}else for(p=0;p<c.length;++p)n.r>=c[p][0].s.r&&n.r<=c[p][0].e.r&&n.c>=c[p][0].s.c&&n.c<=c[p][0].e.c&&(s.F=c[p][1]);d.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),s.s=f),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function Iz(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Bm(e,t){var r=t||{};Do();var s=ll(Ax(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=Gt(s));var n=s.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=sr(r);return o.type="string",go.to_workbook(s,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Me){n.indexOf("<"+Me)>=0&&(i=!0)}),i)return b9(s,r);yl={"General Number":"General","General Date":ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ot[15],"Short Date":ot[14],"Long Time":ot[19],"Medium Time":ot[18],"Short Time":ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ot[2],Standard:ot[4],Percent:ot[10],Scientific:ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},m=[],f=r.dense?[]:{},h="",p={},x={},g=Sa('<Data ss:Type="String">'),v=0,w=0,y=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},N={},j="",T=0,C=[],L={},A={},P=0,I=[],_=[],D={},W=[],K,J=!1,F=[],le=[],Ae={},O=0,G=0,U={Sheets:[],WBProps:{date1904:!1}},B={};Il.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";l=Il.exec(s);)switch(l[3]=(Y=l[3]).toLowerCase()){case"data":if(Y=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Dz(s.slice(v,l.index),j,g,c[c.length-1][0]=="comment"?D:p,{c:w,r:y},E,W[w],x,F,r):(j="",g=Sa(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(_.length>0&&(p.c=_),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(f[y]||(f[y]=[]),f[y][w]=p):f[mr(w)+Cr(y)]=p),p.HRef&&(p.l={Target:Ct(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(O=w+(parseInt(p.MergeAcross,10)|0),G=y+(parseInt(p.MergeDown,10)|0),C.push({s:{c:w,r:y},e:{c:O,r:G}})),!r.sheetStubs)p.MergeAcross?w=O+1:++w;else if(p.MergeAcross||p.MergeDown){for(var te=w;te<=O;++te)for(var ae=y;ae<=G;++ae)(te>w||ae>y)&&(r.dense?(f[ae]||(f[ae]=[]),f[ae][te]={t:"z"}):f[mr(te)+Cr(ae)]={t:"z"});w=O+1}else++w;else p=Cz(l[0]),p.Index&&(w=+p.Index-1),w<S.s.c&&(S.s.c=w),w>S.e.c&&(S.e.c=w),l[0].slice(-2)==="/>"&&++w,_=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<S.s.r&&(S.s.r=y),y>S.e.r&&(S.e.r=y),l[0].slice(-2)==="/>"&&(x=Sa(l[0]),x.Index&&(y=+x.Index-1)),w=0,++y):(x=Sa(l[0]),x.Index&&(y=+x.Index-1),Ae={},(x.AutoFitHeight=="0"||x.Height)&&(Ae.hpx=parseInt(x.Height,10),Ae.hpt=Bl(Ae.hpx),le[y]=Ae),x.Hidden=="1"&&(Ae.hidden=!0,le[y]=Ae));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));m.push(h),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(f["!ref"]=vt(S),r.sheetRows&&r.sheetRows<=S.e.r&&(f["!fullref"]=f["!ref"],S.e.r=r.sheetRows-1,f["!ref"]=vt(S))),C.length&&(f["!merges"]=C),W.length>0&&(f["!cols"]=W),le.length>0&&(f["!rows"]=le),u[h]=f}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,c.push([l[3],!1]),d=Sa(l[0]),h=Ct(d.Name),f=r.dense?[]:{},C=[],F=[],le=[],B={name:h,Hidden:0},U.Sheets.push(B);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),W=[],J=!1}break;case"style":l[1]==="/"?Oz(E,N,r):N=Sa(l[0]);break;case"numberformat":N.nf=Ct(Sa(l[0]).Format||"General"),yl[N.nf]&&(N.nf=yl[N.nf]);for(var ne=0;ne!=392&&ot[ne]!=N.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if(ot[ne]==null){rn(N.nf,ne);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(K=Sa(l[0]),K.Hidden&&(K.hidden=!0,delete K.Hidden),K.Width&&(K.wpx=parseInt(K.Width,10)),!J&&K.wpx>10){J=!0,us=uE;for(var fe=0;fe<W.length;++fe)W[fe]&&Rn(W[fe])}J&&Rn(K),W[K.Index-1||W.length]=K;for(var je=0;je<+K.Span;++je)W[W.length]=sr(K);break;case"namedrange":if(l[1]==="/")break;U.Names||(U.Names=[]);var z=dt(l[0]),me={Name:z.Name,Ref:lo(z.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(me.Sheet=U.Sheets.length-1),U.Names.push(me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?j+=s.slice(T,l.index):T=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=Sa(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?aR(L,Y,s.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));Iz(D),_.push(D)}else c.push([l[3],!1]),d=Sa(l[0]),D={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ie=Sa(l[0]);f["!autofilter"]={ref:lo(ie.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Pb(s,r);var ke=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ke=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ke=!1}break;case"excelworkbook":switch(l[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ke=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:ke=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(s.slice(P,l.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else P=l.index+l[0].length;break;case"header":f["!margins"]||xi(f["!margins"]={},"xlml"),isNaN(+dt(l[0]).Margin)||(f["!margins"].header=+dt(l[0]).Margin);break;case"footer":f["!margins"]||xi(f["!margins"]={},"xlml"),isNaN(+dt(l[0]).Margin)||(f["!margins"].footer=+dt(l[0]).Margin);break;case"pagemargins":var Fe=dt(l[0]);f["!margins"]||xi(f["!margins"]={},"xlml"),isNaN(+Fe.Top)||(f["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(f["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(f["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(f["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ke=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ke=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ke=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ke=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ke=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ke=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ke=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ke=!1}break;case"smarttags":break;default:ke=!1;break}if(ke||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?kz(A,Y,I,s.slice(P,l.index)):(I=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=u),he.SheetNames=m,he.Workbook=U,he.SSF=sr(ot),he.Props=L,he.Custprops=A,he}function ip(e,t){switch(Jx(t=t||{}),t.type||"base64"){case"base64":return Bm(Xs(e),t);case"binary":case"buffer":case"file":return Bm(e,t);case"array":return Bm(Un(e),t)}}function Rz(e,t){var r=[];return e.Props&&r.push(nR(e.Props,t)),e.Custprops&&r.push(iR(e.Props,e.Custprops)),r.join("")}function Fz(){return""}function Lz(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var i=[];i.push($e("NumberFormat",null,{"ss:Format":Ut(ot[s.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push($e("Style",i.join(""),o))}),$e("Styles",r.join(""))}function ME(e){return $e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Vx(e.Ref,{r:0,c:0})})}function Mz(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(ME(n)))}return $e("Names",r.join(""))}function Bz(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(ME(l)))}return i.join("")}function $z(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push($e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push($e("Footer",null,{"x:Margin":e["!margins"].footer})),n.push($e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push($e("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ss("ProtectContents","True")),e["!protect"].objects&&n.push(ss("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ss("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(ss("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(ss("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":$e("WorksheetOptions",n.join(""),{xmlns:Ws.x})}function zz(e){return e.map(function(t){var r=l6(t.t||""),s=$e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return $e("Comment",s,{"ss:Author":t.a})}).join("")}function Uz(e,t,r,s,n,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Ut(Vx(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=fr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Ut(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Ut(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var m="",f="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":m="Number",f=String(e.v);break;case"b":m="Boolean",f=e.v?"1":"0";break;case"e":m="Error",f=gn[e.v];break;case"d":m="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ot[14]);break;case"s":m="String",f=o6(e.v||"");break}var h=Hn(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var p=e.v!=null?f:"",x=e.t=="z"?"":'<Data ss:Type="'+m+'">'+p+"</Data>";return(e.c||[]).length>0&&(x+=zz(e.c)),$e("Cell",x,l)}function Wz(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=vo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Hz(e,t,r,s){if(!e["!ref"])return"";var n=_t(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,v){Rn(g);var w=!!g.width,y=Uu(v,g),S={"ss:Index":v+1};w&&(S["ss:Width"]=Ll(y.width)),g.hidden&&(S["ss:Hidden"]="1"),l.push($e("Column",null,S))});for(var c=Array.isArray(e),d=n.s.r;d<=n.e.r;++d){for(var u=[Wz(d,(e["!rows"]||[])[d])],m=n.s.c;m<=n.e.c;++m){var f=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>m)&&!(i[o].s.r>d)&&!(i[o].e.c<m)&&!(i[o].e.r<d)){(i[o].s.c!=m||i[o].s.r!=d)&&(f=!0);break}if(!f){var h={r:d,c:m},p=ct(h),x=c?(e[d]||[])[m]:e[p];u.push(Uz(x,p,e,t,r,s,h))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function Vz(e,t,r){var s=[],n=r.SheetNames[e],i=r.Sheets[n],o=i?Bz(i,t,e,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?Hz(i,t,e,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push($z(i,t,e,r)),s.join("")}function Gz(e,t){t||(t={}),e.SSF||(e.SSF=sr(ot)),e.SSF&&(Do(),Ru(e.SSF),t.revssf=Lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Hn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Rz(e,t)),r.push(Fz()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push($e("Worksheet",Vz(s,t,e),{"ss:Name":Ut(e.SheetNames[s])}));return r[2]=Lz(e,t),r[3]=Mz(e),_r+$e("Workbook",r.join(""),{xmlns:Ws.ss,"xmlns:o":Ws.o,"xmlns:x":Ws.x,"xmlns:ss":Ws.ss,"xmlns:dt":Ws.dt,"xmlns:html":Ws.html})}function qz(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=M6(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=B6(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Kz=[60,1084,2066,2165,2175];function Yz(e,t,r,s,n){var i=s,o=[],l=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Za(r,r.l),d=op[c],u=0;d!=null&&Kz.indexOf(c)>-1;)i=Za(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+i),o.push(l),r.l+=4+i,d=op[c=Za(r,r.l)];var m=Gr(o);ts(m,0);var f=0;m.lens=[];for(var h=0;h<o.length;++h)m.lens.push(f),f+=o[h].length;if(m.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+s;return t.f(m,m.length,n)}function La(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ot[s])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||gn[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pl(e.v):e.w=Si(e.v):e.w=ga(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&s&&e.t=="n"&&Oo(ot[s]||String(s))){var n=ii(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Kc(e,t,r){return{v:e,ixfe:t,t:r}}function Xz(e,t){var r={opts:{}},s={},n=t.dense?[]:{},i={},o={},l=null,c=[],d="",u={},m,f="",h,p,x,g,v={},w=[],y,S,E=[],N=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},C=function(De){return De<8?fi[De]:De<64&&N[De-8]||fi[De]},L=function(De,st,ut){var Ye=st.XF.data;if(!(!Ye||!Ye.patternType||!ut||!ut.cellStyles)){st.s={},st.s.patternType=Ye.patternType;var Ht;(Ht=Fl(C(Ye.icvFore)))&&(st.s.fgColor={rgb:Ht}),(Ht=Fl(C(Ye.icvBack)))&&(st.s.bgColor={rgb:Ht})}},A=function(De,st,ut){if(!(Ae>1)&&!(ut.sheetRows&&De.r>=ut.sheetRows)){if(ut.cellStyles&&st.XF&&st.XF.data&&L(De,st,ut),delete st.ixfe,delete st.XF,m=De,f=ct(De),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),De.r<o.s.r&&(o.s.r=De.r),De.c<o.s.c&&(o.s.c=De.c),De.r+1>o.e.r&&(o.e.r=De.r+1),De.c+1>o.e.c&&(o.e.c=De.c+1),ut.cellFormula&&st.f){for(var Ye=0;Ye<w.length;++Ye)if(!(w[Ye][0].s.c>De.c||w[Ye][0].s.r>De.r)&&!(w[Ye][0].e.c<De.c||w[Ye][0].e.r<De.r)){st.F=vt(w[Ye][0]),(w[Ye][0].s.c!=De.c||w[Ye][0].s.r!=De.r)&&delete st.f,st.f&&(st.f=""+ds(w[Ye][1],o,De,F,P));break}}ut.dense?(n[De.r]||(n[De.r]=[]),n[De.r][De.c]=st):n[f]=st}},P={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var I,_=[],D=[],W=[],K=[],J=!1,F=[];F.SheetNames=P.snames,F.sharedf=P.sharedf,F.arrayf=P.arrayf,F.names=[],F.XTI=[];var le=0,Ae=0,O=0,G=[],U=[],B;P.codepage=1200,Ca(1200);for(var Y=!1;e.l<e.length-1;){var te=e.l,ae=e.read_shift(2);if(ae===0&&le===10)break;var ne=e.l===e.length?0:e.read_shift(2),fe=op[ae];if(fe&&fe.f){if(t.bookSheets&&le===133&&ae!==133)break;if(le=ae,fe.r===2||fe.r==12){var je=e.read_shift(2);if(ne-=2,!P.enc&&je!==ae&&((je&255)<<8|je>>8)!==ae)throw new Error("rt mismatch: "+je+"!="+ae);fe.r==12&&(e.l+=10,ne-=10)}var z={};if(ae===10?z=fe.f(e,ne,P):z=Yz(ae,fe,e,ne,P),Ae==0&&[9,521,1033,2057].indexOf(le)===-1)continue;switch(ae){case 34:r.opts.Date1904=j.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=z,!t.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=z;break;case 66:var me=Number(z);switch(me){case 21010:me=1200;break;case 32768:me=1e4;break;case 32769:me=1252;break}Ca(P.codepage=me),Y=!0;break;case 317:P.rrtabid=z;break;case 25:P.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:P.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(n["!type"]="dialog"),z.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),z.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:E.push(z);break;case 430:F.push([z]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(z);break;case 24:case 536:B={Name:z.Name,Ref:ds(z.rgce,o,null,F,P)},z.itab>0&&(B.Sheet=z.itab-1),F.names.push(B),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(U[z.itab-1]={ref:vt(z.rgce[0][0][1][2])});break;case 22:P.ExternCount=z;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(z),F.XTI=F.XTI.concat(z);break;case 2196:if(P.biff<8)break;B!=null&&(B.Comment=z[1]);break;case 18:n["!protect"]=z;break;case 19:z!==0&&P.WTF&&console.error("Password verifier: "+z);break;case 133:i[z.pos]=z,P.snames.push(z.name);break;case 10:{if(--Ae)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=vt(o),t.sheetRows&&t.sheetRows<=o.e.r){var ie=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=vt(o),o.e.r=ie}o.e.r++,o.e.c++}_.length>0&&(n["!merges"]=_),D.length>0&&(n["!objects"]=D),W.length>0&&(n["!cols"]=W),K.length>0&&(n["!rows"]=K),j.Sheets.push(T)}d===""?u=n:s[d]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),P.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(P.biff=5,Y=!0,Ca(P.codepage=28591)),P.biff==8&&z.BIFFVer==0&&z.dt==16&&(P.biff=2),Ae++)break;if(n=t.dense?[]:{},P.biff<8&&!Y&&(Y=!0,Ca(P.codepage=t.codepage||1252)),P.biff<5||z.BIFFVer==0&&z.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ke={pos:e.l-ne,name:d};i[ke.pos]=ke,P.snames.push(d)}else d=(i[te]||{name:""}).name;z.dt==32&&(n["!type"]="chart"),z.dt==64&&(n["!type"]="macro"),_=[],D=[],P.arrayf=w=[],W=[],K=[],J=!1,T={Hidden:(i[te]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[z.r]||[])[z.c]:n[ct({c:z.c,r:z.r})])&&++z.c,y={ixfe:z.ixfe,XF:E[z.ixfe]||{},v:z.val,t:"n"},O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A({c:z.c,r:z.r},y,t);break;case 5:case 517:y={ixfe:z.ixfe,XF:E[z.ixfe],v:z.val,t:z.t},O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A({c:z.c,r:z.r},y,t);break;case 638:y={ixfe:z.ixfe,XF:E[z.ixfe],v:z.rknum,t:"n"},O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A({c:z.c,r:z.r},y,t);break;case 189:for(var Fe=z.c;Fe<=z.C;++Fe){var he=z.rkrec[Fe-z.c][0];y={ixfe:he,XF:E[he],v:z.rkrec[Fe-z.c][1],t:"n"},O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A({c:Fe,r:z.r},y,t)}break;case 6:case 518:case 1030:{if(z.val=="String"){l=z;break}if(y=Kc(z.val,z.cell.ixfe,z.tt),y.XF=E[y.ixfe],t.cellFormula){var Me=z.formula;if(Me&&Me[0]&&Me[0][0]&&Me[0][0][0]=="PtgExp"){var de=Me[0][0][1][0],We=Me[0][0][1][1],et=ct({r:de,c:We});v[et]?y.f=""+ds(z.formula,o,z.cell,F,P):y.F=((t.dense?(n[de]||[])[We]:n[et])||{}).F}else y.f=""+ds(z.formula,o,z.cell,F,P)}O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A(z.cell,y,t),l=z}break;case 7:case 519:if(l)l.val=z,y=Kc(z,l.cell.ixfe,"s"),y.XF=E[y.ixfe],t.cellFormula&&(y.f=""+ds(l.formula,o,l.cell,F,P)),O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(z);var ht=ct(z[0].s);if(h=t.dense?(n[z[0].s.r]||[])[z[0].s.c]:n[ht],t.cellFormula&&h){if(!l||!ht||!h)break;h.f=""+ds(z[1],o,z[0],F,P),h.F=vt(z[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!l)break;v[ct(l.cell)]=z[0],h=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[ct(l.cell)],(h||{}).f=""+ds(z[0],o,m,F,P)}}break;case 253:y=Kc(c[z.isst].t,z.ixfe,"s"),c[z.isst].h&&(y.h=c[z.isst].h),y.XF=E[y.ixfe],O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A({c:z.c,r:z.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:z.ixfe,XF:E[z.ixfe],t:"z"},O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A({c:z.c,r:z.r},y,t));break;case 190:if(t.sheetStubs)for(var Ke=z.c;Ke<=z.C;++Ke){var Je=z.ixfe[Ke-z.c];y={ixfe:Je,XF:E[Je],t:"z"},O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A({c:Ke,r:z.r},y,t)}break;case 214:case 516:case 4:y=Kc(z.val,z.ixfe,"s"),y.XF=E[y.ixfe],O>0&&(y.z=G[y.ixfe>>8&63]),La(y,t,r.opts.Date1904),A({c:z.c,r:z.r},y,t);break;case 0:case 512:Ae===1&&(o=z);break;case 252:c=z;break;case 1054:if(P.biff==4){G[O++]=z[1];for(var ft=0;ft<O+163&&ot[ft]!=z[1];++ft);ft>=163&&rn(z[1],O+163)}else rn(z[1],z[0]);break;case 30:{G[O++]=z;for(var nt=0;nt<O+163&&ot[nt]!=z;++nt);nt>=163&&rn(z,O+163)}break;case 229:_=_.concat(z);break;case 93:D[z.cmo[0]]=P.lastobj=z;break;case 438:P.lastobj.TxO=z;break;case 127:P.lastobj.ImData=z;break;case 440:for(g=z[0].s.r;g<=z[0].e.r;++g)for(x=z[0].s.c;x<=z[0].e.c;++x)h=t.dense?(n[g]||[])[x]:n[ct({c:x,r:g})],h&&(h.l=z[1]);break;case 2048:for(g=z[0].s.r;g<=z[0].e.r;++g)for(x=z[0].s.c;x<=z[0].e.c;++x)h=t.dense?(n[g]||[])[x]:n[ct({c:x,r:g})],h&&h.l&&(h.l.Tooltip=z[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;h=t.dense?(n[z[0].r]||[])[z[0].c]:n[ct(z[0])];var qe=D[z[2]];h||(t.dense?(n[z[0].r]||(n[z[0].r]=[]),h=n[z[0].r][z[0].c]={t:"z"}):h=n[ct(z[0])]={t:"z"},o.e.r=Math.max(o.e.r,z[0].r),o.s.r=Math.min(o.s.r,z[0].r),o.e.c=Math.max(o.e.c,z[0].c),o.s.c=Math.min(o.s.c,z[0].c)),h.c||(h.c=[]),p={a:z[1],t:qe.TxO.t},h.c.push(p)}break;case 2173:LL(E[z.ixfe],z.ext);break;case 125:{if(!P.cellStyles)break;for(;z.e>=z.s;)W[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},J||(J=!0,Ux(z.w/256)),Rn(W[z.e+1])}break;case 520:{var be={};z.level!=null&&(K[z.r]=be,be.level=z.level),z.hidden&&(K[z.r]=be,be.hidden=!0),z.hpt&&(K[z.r]=be,be.hpt=z.hpt,be.hpx=vo(z.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||xi(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=z;break;case 161:n["!margins"]||xi(n["!margins"]={}),n["!margins"].header=z.header,n["!margins"].footer=z.footer;break;case 574:z.RTL&&(j.Views[0].RTL=!0);break;case 146:N=z;break;case 2198:I=z;break;case 140:S=z;break;case 442:d?T.CodeName=z||T.name:j.WBProps.CodeName=z||"ThisWorkbook";break}}else fe||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=ne}return r.SheetNames=jr(i).sort(function(Se,De){return Number(Se)-Number(De)}).map(function(Se){return i[Se].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&U.forEach(function(Se,De){r.Sheets[r.SheetNames[De]]["!autofilter"]=Se}),r.Strings=c,r.SSF=sr(ot),P.enc&&(r.Encryption=P.enc),I&&(r.Themes=I),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),F.names.length>0&&(j.Names=F.names),r.Workbook=j,r}var wl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Jz(e,t,r){var s=rt.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=ob(s,ep,wl.DSI);for(var i in n)t[i]=n[i]}catch(d){if(r.WTF)throw d}var o=rt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=ob(o,tp,wl.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(LS(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Zz(e,t){var r=[],s=[],n=[],i=0,o,l=L1(ep,"n"),c=L1(tp,"n");if(e.Props)for(o=jr(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?s:n).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=jr(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?s:n).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<n.length;++i)HS.indexOf(n[i][0])>-1||FS.indexOf(n[i][0])>-1||n[i][1]!=null&&d.push(n[i]);s.length&&rt.utils.cfb_add(t,"/SummaryInformation",lb(s,wl.SI,c,tp)),(r.length||d.length)&&rt.utils.cfb_add(t,"/DocumentSummaryInformation",lb(r,wl.DSI,l,ep,d.length?d:null,wl.UDI))}function BE(e,t){t||(t={}),Jx(t),vx(),t.codepage&&gx(t.codepage);var r,s;if(e.FullPaths){if(rt.find(e,"/encryption"))throw new Error("File is password-protected");r=rt.find(e,"!CompObj"),s=rt.find(e,"/Workbook")||rt.find(e,"/Book")}else{switch(t.type){case"base64":e=Vs(Xs(e));break;case"binary":e=Vs(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ts(e,0),s={content:e}}var n,i;if(r&&qz(r),t.bookProps&&!t.bookSheets)n={};else{var o=wt?"buffer":"array";if(s&&s.content)n=Xz(s.content,t);else if((i=rt.find(e,"PerfectOffice_MAIN"))&&i.content)n=pi.to_workbook(i.content,(t.type=o,t));else if((i=rt.find(e,"NativeContent_MAIN"))&&i.content)n=pi.to_workbook(i.content,(t.type=o,t));else throw(i=rt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=uM(e))}var l={};return e.FullPaths&&Jz(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function Qz(e,t){var r=t||{},s=rt.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return rt.utils.cfb_add(s,n,$E(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Zz(e,s),r.biff==8&&e.vbaraw&&mM(s,rt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var $l={0:{f:N7},1:{f:P7},2:{f:X7},3:{f:B7},4:{f:R7},5:{f:q7},6:{f:t$},7:{f:W7},8:{f:l$},9:{f:o$},10:{f:n$},11:{f:i$},12:{f:D7},13:{f:Z7},14:{f:z7},15:{f:L7},16:{f:PE},17:{f:s$},18:{f:V7},19:{f:Ox},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:sz},40:{},42:{},43:{f:tL},44:{f:QF},45:{f:aL},46:{f:iL},47:{f:nL},48:{},49:{f:T6},50:{},51:{f:$L},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tE},62:{f:e$},63:{f:YL},64:{f:S$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:gs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:y$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:_7},148:{f:T7,p:16},151:{f:h$},152:{},153:{f:ez},154:{},155:{},156:{f:Z$},157:{},158:{},159:{T:1,f:xF},160:{T:-1},161:{T:1,f:Wi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:c$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ML},336:{T:-1},337:{f:WL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:eE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:p$},427:{f:x$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:v$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:C7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:m$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:iM},633:{T:1},634:{T:-1},635:{T:1,f:aM},636:{T:-1},637:{f:k6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:z$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:E$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},op={6:{f:Lm},10:{f:Tn},12:{f:Dr},13:{f:Dr},14:{f:Er},15:{f:Er},16:{f:hs},17:{f:Er},18:{f:Er},19:{f:Dr},20:{f:hb},21:{f:hb},23:{f:eE},24:{f:xb},25:{f:Er},26:{},27:{},28:{f:E8},29:{},34:{f:Er},35:{f:pb},38:{f:hs},39:{f:hs},40:{f:hs},41:{f:hs},42:{f:Er},43:{f:Er},47:{f:LF},49:{f:ZR},51:{f:Dr},60:{},61:{f:qR},64:{f:Er},65:{f:JR},66:{f:Dr},77:{},80:{},81:{},82:{},85:{f:Dr},89:{},90:{},91:{},92:{f:FR},93:{f:C8},94:{},95:{f:Er},96:{},97:{},99:{f:Er},125:{f:tE},128:{f:f8},129:{f:MR},130:{f:Dr},131:{f:Er},132:{f:Er},133:{f:BR},134:{},140:{f:F8},141:{f:Dr},144:{},146:{f:B8},151:{},152:{},153:{},154:{},155:{},156:{f:Dr},157:{},158:{},160:{f:G8},161:{f:U8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:c8},190:{f:d8},193:{f:Tn},197:{},198:{},199:{},200:{},201:{},202:{f:Er},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Dr},220:{},221:{f:Er},222:{},224:{f:m8},225:{f:RR},226:{f:Tn},227:{},229:{f:T8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zR},253:{f:e8},255:{f:WR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:VS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Er},353:{f:Tn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:v8},431:{f:Er},432:{},433:{},434:{},437:{},438:{f:P8},439:{f:Er},440:{f:O8},441:{},442:{f:mc},443:{},444:{f:Dr},445:{},446:{},448:{f:Tn},449:{f:GR,r:2},450:{f:Tn},512:{f:ub},513:{f:V8},515:{f:x8},516:{f:r8},517:{f:fb},519:{f:q8},520:{f:HR},523:{},545:{f:gb},549:{f:db},566:{},574:{f:YR},638:{f:l8},659:{},1048:{},1054:{f:a8},1084:{},1212:{f:j8},2048:{f:I8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Vc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Tn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:$8,r:12},2173:{f:FL,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Er,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:w8,r:12},2197:{},2198:{f:kL,r:12},2199:{},2200:{},2201:{},2202:{f:N8,r:12},2203:{f:Tn},2204:{},2205:{},2206:{},2207:{},2211:{f:VR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Dr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:W8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:M8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ub},1:{},2:{f:Z8},3:{f:X8},4:{f:Y8},5:{f:fb},7:{f:eF},8:{},9:{f:Vc},11:{},22:{f:Dr},30:{f:i8},31:{},32:{},33:{f:gb},36:{},37:{f:db},50:{f:tF},62:{},52:{},67:{},68:{f:Dr},69:{},86:{},126:{},127:{f:K8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rF},223:{},234:{},354:{},421:{},518:{f:Lm},521:{f:Vc},536:{f:xb},547:{f:pb},561:{},579:{},1030:{f:Lm},1033:{f:Vc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(e,t,r,s){var n=t;if(!isNaN(n)){var i=s||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&_x(r)&&e.push(r)}}function e9(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return ze(e,t,r,n);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<n;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function xc(e,t,r){return e||(e=Ee(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function t9(e,t,r,s){var n=Ee(9);return xc(n,e,t),GS(r,s||"b",n),n}function r9(e,t,r){var s=Ee(8+2*r.length);return xc(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function s9(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Br(rr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?ze(e,2,Q8(r,s,n)):ze(e,3,J8(r,s,n));return;case"b":case"e":ze(e,5,t9(r,s,t.v,t.t));return;case"s":case"str":ze(e,4,r9(r,s,(t.v||"").slice(0,255)));return}ze(e,1,xc(null,r,s))}function a9(e,t,r,s){var n=Array.isArray(t),i=_t(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=vt(i)}for(var d=i.s.r;d<=i.e.r;++d){l=Cr(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=mr(u)),o=c[u]+l;var m=n?(t[d]||[])[u]:t[o];m&&s9(e,m,d,u)}}}function n9(e,t){for(var r=t||{},s=Ls(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(s,r.biff==4?1033:r.biff==3?521:9,Bx(e,16,r)),a9(s,e.Sheets[e.SheetNames[n]],n,r),ze(s,10),s.end()}function i9(e,t,r){ze(e,49,QR({sz:12,name:"Arial"},r))}function o9(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&ze(e,1054,n8(n,t[n],r))})}function l9(e,t){var r=Ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(e,2151,r),r=Ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),JS(_t(t["!ref"]||"A1"),r),r.write_shift(4,4),ze(e,2152,r)}function c9(e,t){for(var r=0;r<16;++r)ze(e,224,mb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){ze(e,224,mb(s,0,t))})}function d9(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];ze(e,440,D8(s)),s[1].Tooltip&&ze(e,2048,R8(s))}delete t["!links"]}function u9(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&ze(e,125,z8(Uu(n,s),n))})}}function m9(e,t,r,s,n){var i=16+Hn(n.cellXfs,t,n);if(t.v==null&&!t.bf){ze(e,513,Ci(r,s,i));return}if(t.bf)ze(e,6,MB(t,r,s,n,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Br(rr(t.v)):t.v;ze(e,515,g8(r,s,o,i));break;case"b":case"e":ze(e,517,p8(r,s,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var l=qx(n.Strings,t.v,n.revStrings);ze(e,253,t8(r,s,l,i))}else ze(e,516,s8(r,s,(t.v||"").slice(0,255),i,n));break;default:ze(e,513,Ci(r,s,i))}}function f9(e,t,r){var s=Ls(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,m="",f=[],h=_t(i["!ref"]||"A1"),p=d?65536:16384;if(h.e.c>255||h.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}ze(s,2057,Bx(r,16,t)),ze(s,13,da(1)),ze(s,12,da(100)),ze(s,15,js(!0)),ze(s,17,js(!1)),ze(s,16,Ti(.001)),ze(s,95,js(!0)),ze(s,42,js(!1)),ze(s,43,js(!1)),ze(s,130,da(1)),ze(s,128,h8()),ze(s,131,js(!1)),ze(s,132,js(!1)),d&&u9(s,i["!cols"]),ze(s,512,o8(h,t)),d&&(i["!links"]=[]);for(var x=h.s.r;x<=h.e.r;++x){m=Cr(x);for(var g=h.s.c;g<=h.e.c;++g){x===h.s.r&&(f[g]=mr(g)),u=f[g]+m;var v=c?(i[x]||[])[g]:i[u];v&&(m9(s,v,x,g,t),d&&v.l&&i["!links"].push([u,v.l]))}}var w=l.CodeName||l.name||n;return d&&ze(s,574,XR((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&ze(s,229,A8(i["!merges"])),d&&d9(s,i),ze(s,442,qS(w)),d&&l9(s,i),ze(s,10),s.end()}function h9(e,t,r){var s=Ls(),n=(e||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(ze(s,2057,Bx(e,5,r)),r.bookType=="xla"&&ze(s,135),ze(s,225,l?da(1200):null),ze(s,193,pR(2)),c&&ze(s,191),c&&ze(s,192),ze(s,226),ze(s,92,LR("SheetJS",r)),ze(s,66,da(l?1200:1252)),l&&ze(s,353,da(0)),l&&ze(s,448),ze(s,317,H8(e.SheetNames.length)),l&&e.vbaraw&&ze(s,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";ze(s,442,qS(d))}ze(s,156,da(17)),ze(s,25,js(!1)),ze(s,18,js(!1)),ze(s,19,da(0)),l&&ze(s,431,js(!1)),l&&ze(s,444,da(0)),ze(s,61,KR()),ze(s,64,js(!1)),ze(s,141,da(0)),ze(s,34,js(G$(e)=="true")),ze(s,14,js(!0)),l&&ze(s,439,js(!1)),ze(s,218,da(0)),i9(s,e,r),o9(s,e.SSF,r),c9(s,r),l&&ze(s,352,js(!1));var u=s.end(),m=Ls();l&&ze(m,140,L8()),l&&r.Strings&&e9(m,252,UR(r.Strings)),ze(m,10);var f=m.end(),h=Ls(),p=0,x=0;for(x=0;x<e.SheetNames.length;++x)p+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var g=u.length+p+f.length;for(x=0;x<e.SheetNames.length;++x){var v=i[x]||{};ze(h,133,$R({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[x]},r)),g+=t[x].length}var w=h.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var y=[];return u.length&&y.push(u),w.length&&y.push(w),f.length&&y.push(f),Gr(y)}function p9(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=sr(ot)),e&&e.SSF&&(Do(),Ru(e.SSF),r.revssf=Lu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Zx(r),r.cellXfs=[],Hn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=f9(n,r,e);return s.unshift(h9(e,s,r)),Gr(s)}function $E(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Ms(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return p9(e,t);case 4:case 3:case 2:return n9(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Ab(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=n.index,l=i&&i.index||e.length,c=QI(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,m=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<c.length;++o){var x=c[o].trim(),g=x.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var v=x.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var w=v[l].trim();if(w.match(/<t[dh]/i)){for(var y=w,S=0;y.charAt(0)=="<"&&(S=y.indexOf(">"))>-1;)y=y.slice(S+1);for(var E=0;E<p.length;++E){var N=p[E];N.s.c==u&&N.s.r<d&&d<=N.e.r&&(u=N.e.c+1,E=-1)}var j=dt(w.slice(0,w.indexOf(">")));f=j.colspan?+j.colspan:1,((m=+j.rowspan)>1||f>1)&&p.push({s:{r:d,c:u},e:{r:d+(m||1)-1,c:u+f-1}});var T=j.t||j["data-t"]||"";if(!y.length){u+=f;continue}if(y=dS(y),h.s.r>d&&(h.s.r=d),h.e.r<d&&(h.e.r=d),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!y.length){u+=f;continue}var C={t:"s",v:y};r.raw||!y.trim().length||T=="s"||(y==="TRUE"?C={t:"b",v:!0}:y==="FALSE"?C={t:"b",v:!1}:isNaN(Pa(y))?isNaN(xo(y).getDate())||(C={t:"d",v:rr(y)},r.cellDates||(C={t:"n",v:Br(C.v)}),C.z=r.dateNF||ot[14]):C={t:"n",v:Pa(y)}),r.dense?(s[d]||(s[d]=[]),s[d][u]=C):s[ct({r:d,c:u})]=C,u+=f}}}}return s["!ref"]=vt(h),p.length&&(s["!merges"]=p),s}function x9(e,t,r,s){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>o)&&!(n[d].e.r<r||n[d].e.c<o)){if(n[d].s.r<r||n[d].s.c<o){l=-1;break}l=n[d].e.r-n[d].s.r+1,c=n[d].e.c-n[d].s.c+1;break}if(!(l<0)){var u=ct({r,c:o}),m=s.dense?(e[r]||[])[o]:e[u],f=m&&m.v!=null&&(m.h||Tx(m.w||(dn(m),m.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),s.editable?f='<span contenteditable="true">'+f+"</span>":m&&(h["data-t"]=m&&m.t||"z",m.v!=null&&(h["data-v"]=m.v),m.z!=null&&(h["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+m.l.Target+'">'+f+"</a>")),h.id=(s.id||"sjs")+"-"+u,i.push($e("td",f,h))}}var p="<tr>";return p+i.join("")+"</tr>"}var g9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',v9="</body></html>";function b9(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Wn(Ab(r[0],t),t);var s=rg();return r.forEach(function(n,i){sg(s,Ab(n,t),"Sheet"+(i+1))}),s}function y9(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function zE(e,t){var r=t||{},s=r.header!=null?r.header:g9,n=r.footer!=null?r.footer:v9,i=[s],o=Ms(e["!ref"]);r.dense=Array.isArray(e),i.push(y9(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(x9(e,o,l,r));return i.push("</table>"+n),i.join("")}function UE(e,t,r){var s=r||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var o=typeof s.origin=="string"?fr(s.origin):s.origin;n=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var u=Ms(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),n==-1&&(d.e.r=n=u.e.r+1)}var m=[],f=0,h=e["!rows"]||(e["!rows"]=[]),p=0,x=0,g=0,v=0,w=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<l.length&&x<c;++p){var S=l[p];if(Cb(S)){if(s.display)continue;h[x]={hidden:!0}}var E=S.children;for(g=v=0;g<E.length;++g){var N=E[g];if(!(s.display&&Cb(N))){var j=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):dS(N.innerHTML),T=N.getAttribute("data-z")||N.getAttribute("z");for(f=0;f<m.length;++f){var C=m[f];C.s.c==v+i&&C.s.r<x+n&&x+n<=C.e.r&&(v=C.e.c+1-i,f=-1)}y=+N.getAttribute("colspan")||1,((w=+N.getAttribute("rowspan")||1)>1||y>1)&&m.push({s:{r:x+n,c:v+i},e:{r:x+n+(w||1)-1,c:v+i+(y||1)-1}});var L={t:"s",v:j},A=N.getAttribute("data-t")||N.getAttribute("t")||"";j!=null&&(j.length==0?L.t=A||"z":s.raw||j.trim().length==0||A=="s"||(j==="TRUE"?L={t:"b",v:!0}:j==="FALSE"?L={t:"b",v:!1}:isNaN(Pa(j))?isNaN(xo(j).getDate())||(L={t:"d",v:rr(j)},s.cellDates||(L={t:"n",v:Br(L.v)}),L.z=s.dateNF||ot[14]):L={t:"n",v:Pa(j)})),L.z===void 0&&T!=null&&(L.z=T);var P="",I=N.getElementsByTagName("A");if(I&&I.length)for(var _=0;_<I.length&&!(I[_].hasAttribute("href")&&(P=I[_].getAttribute("href"),P.charAt(0)!="#"));++_);P&&P.charAt(0)!="#"&&(L.l={Target:P}),s.dense?(e[x+n]||(e[x+n]=[]),e[x+n][v+i]=L):e[ct({c:v+i,r:x+n})]=L,d.e.c<v+i&&(d.e.c=v+i),v+=y}}++x}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,x-1+n),e["!ref"]=vt(d),x>=c&&(e["!fullref"]=vt((d.e.r=l.length-p+x-1+n,d))),e}function WE(e,t){var r=t||{},s=r.dense?[]:{};return UE(s,e,t)}function w9(e,t){return Wn(WE(e,t),t)}function Cb(e){var t="",r=j9(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function j9(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function N9(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ct(t.replace(/<[^>]*>/g,""));return[r]}var _b={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function HE(e,t){var r=t||{},s=Ax(e),n=[],i,o,l={name:""},c="",d=0,u,m,f={},h=[],p=r.dense?[]:{},x,g,v={value:""},w="",y=0,S=[],E=-1,N=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,C={},L=[],A={},P=0,I=0,_=[],D=1,W=1,K=[],J={Names:[]},F={},le=["",""],Ae=[],O={},G="",U=0,B=!1,Y=!1,te=0;for(Il.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Il.exec(s);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?p["!ref"]=vt(j):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(p["!fullref"]=p["!ref"],j.e.r=r.sheetRows-1,p["!ref"]=vt(j)),L.length&&(p["!merges"]=L),_.length&&(p["!rows"]=_),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),f[u.name]=p,Y=!1):x[0].charAt(x[0].length-2)!=="/"&&(u=dt(x[0],!1),E=N=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,p=r.dense?[]:{},L=[],_=[],Y=!0);break;case"table-row-group":x[1]==="/"?--T:++T;break;case"table-row":case"":if(x[1]==="/"){E+=D,D=1;break}if(m=dt(x[0],!1),m.?E=m.-1:E==-1&&(E=0),D=+m["number-rows-repeated"]||1,D<10)for(te=0;te<D;++te)T>0&&(_[E+te]={level:T});N=-1;break;case"covered-table-cell":x[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(p[E]||(p[E]=[]),p[E][N]={t:"z"}):p[ct({r:E,c:N})]={t:"z"}),w="",S=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++N,v=dt(x[0],!1),W=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=Sb(Ct(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=Ct(v["string-value"]||""),r.dense?(p[E]||(p[E]=[]),p[E][N]=g):p[ct({r:E,c:N})]=g),N+=W-1;else if(x[1]!=="/"){++N,w="",y=0,S=[],W=1;var ae=D?E+D-1:E;if(N>j.e.c&&(j.e.c=N),N<j.s.c&&(j.s.c=N),E<j.s.r&&(j.s.r=E),ae>j.e.r&&(j.e.r=ae),v=dt(x[0],!1),Ae=[],O={},g={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ct(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(P=parseInt(v["number-matrix-rows-spanned"],10)||0,I=parseInt(v["number-matrix-columns-spanned"],10)||0,A={s:{r:E,c:N},e:{r:E+P-1,c:N+I-1}},g.F=vt(A),K.push([A,g.F])),v.formula)g.f=Sb(v.formula);else for(te=0;te<K.length;++te)E>=K[te][0].s.r&&E<=K[te][0].e.r&&N>=K[te][0].s.c&&N<=K[te][0].e.c&&(g.F=K[te][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(P=parseInt(v["number-rows-spanned"],10)||0,I=parseInt(v["number-columns-spanned"],10)||0,A={s:{r:E,c:N},e:{r:E+P-1,c:N+I-1}},L.push(A)),v["number-columns-repeated"]&&(W=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=er(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=rr(v["date-value"]),r.cellDates||(g.t="n",g.v=Br(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=XI(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Mu(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(w=Ct(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(B=!1,g.t==="s"&&(g.v=w||"",S.length&&(g.R=S),B=y==0),F.Target&&(g.l=F),Ae.length>0&&(g.c=Ae,Ae=[]),w&&r.cellText!==!1&&(g.w=w),B&&(g.t="z",delete g.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var ne=0;ne<D;++ne){if(W=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[E+ne]||(p[E+ne]=[]),p[E+ne][N]=ne==0?g:sr(g);--W>0;)p[E+ne][N+W]=sr(g);else for(p[ct({r:E+ne,c:N})]=g;--W>0;)p[ct({r:E+ne,c:N+W})]=sr(g);j.e.c<=N&&(j.e.c=N)}W=parseInt(v["number-columns-repeated"]||"1",10),N+=W-1,W=0,g={},w="",S=[]}F={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i;O.t=w,S.length&&(O.R=S),O.a=G,Ae.push(O)}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);G="",U=0,w="",y=0,S=[];break;case"creator":x[1]==="/"?G=s.slice(U,x.index):U=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);w="",y=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(C[l.name]=c,(i=n.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(c="",l=dt(x[0],!1),n.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=dt(x[0],!1),c+=_b[x[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=dt(x[0],!1),c+=_b[x[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(d,x.index);break}else d=x.index+x[0].length;break;case"named-range":o=dt(x[0],!1),le=Mm(o["cell-range-address"]);var fe={Name:o.name,Ref:le[0]+"!"+le[1]};Y&&(fe.Sheet=h.length),J.Names.push(fe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(x[1]==="/"&&(!v||!v["string-value"])){var je=N9(s.slice(y,x.index));w=(w.length>0?w+`
`:"")+je[0]}else dt(x[0],!1),y=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{le=Mm(dt(x[0])["target-range-address"]),f[le[0]]["!autofilter"]={ref:le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(F=dt(x[0],!1),!F.href)break;F.Target=Ct(F.href),delete F.href,F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1?(le=Mm(F.Target.slice(1)),F.Target="#"+le[0]+"!"+le[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var z={Sheets:f,SheetNames:h,Workbook:J};return r.bookSheets&&delete z.Sheets,z}function kb(e,t){t=t||{},ca(e,"META-INF/manifest.xml")&&X6(Or(e,"META-INF/manifest.xml"),t);var r=Gs(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=HE(Gt(r),t);return ca(e,"meta.xml")&&(s.Props=IS(Or(e,"meta.xml"))),s}function Pb(e,t){return HE(e,t)}var S9=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return _r+t}})(),Ob=(function(){var e=function(i){return Ut(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Ut(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,m=Ms(i["!ref"]||"A1"),f=i["!merges"]||[],h=0,p=Array.isArray(i);if(i["!cols"])for(u=0;u<=m.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",g=i["!rows"]||[];for(d=0;d<m.s.r;++d)x=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;d<=m.e.r;++d){for(x=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+x+`>
`),u=0;u<m.s.c;++u)c.push(t);for(;u<=m.e.c;++u){var v=!1,w={},y="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>u)&&!(f[h].s.r>d)&&!(f[h].e.c<u)&&!(f[h].e.r<d)){(f[h].s.c!=u||f[h].s.r!=d)&&(v=!0),w["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,w["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(v){c.push(r);continue}var S=ct({r:d,c:u}),E=p?(i[d]||[])[u]:i[S];if(E&&E.f&&(w["table:formula"]=Ut(HB(E.f)),E.F&&E.F.slice(0,S.length)==S)){var N=Ms(E.F);w["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,w["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":y=E.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=E.v?"true":"false";break;case"n":y=E.w||String(E.v||0),w["office:value-type"]="float",w["office:value"]=E.v||0;break;case"s":case"str":y=E.v==null?"":E.v,w["office:value-type"]="string";break;case"d":y=E.w||rr(E.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=rr(E.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var j=e(y);if(E.l&&E.l.Target){var T=E.l.Target;T=T.charAt(0)=="#"?"#"+VB(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),j=$e("text:a",j,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+$e("table:table-cell",$e("text:p",j,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var m=d["!cols"][u];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Rn(m),m.ods=l;var f=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var m=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[_r],d=Dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Dl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(DS().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)c.push(s(o.Sheets[o.SheetNames[m]],o,m));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function VE(e,t){if(t.bookType=="fods")return Ob(e,t);var r=Nx(),s="",n=[],i=[];return s="mimetype",yt(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",yt(r,s,Ob(e,t)),n.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",yt(r,s,S9(e,t)),n.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",yt(r,s,_r+DS()),n.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",yt(r,s,Q6(i)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",yt(r,s,J6(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _i(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function lp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Gt(Un(e))}function E9(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Vs(za(e))}function T9(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function Ln(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function Db(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function A9(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function C9(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function zl(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function Mt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function br(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function kt(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=zl(e,r),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=zl(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var d={data:l,type:i};t[n]==null?t[n]=[d]:t[n].push(d)}return t}function Zr(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(Mt(s*8+n.type)),n.type==2&&t.push(Mt(n.data.length)),t.push(n.data))})}),Ln(t)}function Xx(e,t){return e?.map(function(r){return t(r.data)})||[]}function ia(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=zl(e,s),i=kt(e.slice(s[0],s[0]+n));s[0]+=n;var o={id:br(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=kt(l.data),d=br(c[3][0].data);o.messages.push({meta:c,data:e.slice(s[0],s[0]+d)}),s[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=br(i[3][0].data)>>>0>0),r.push(o)}return r}function Zi(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:Mt(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:Mt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Mt(o.data.length)}],s[2].push({data:Zr(o.meta),type:2})});var i=Zr(s);t.push(Mt(i.length)),t.push(i),n.forEach(function(o){return t.push(o)})}),Ln(t)}function _9(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=zl(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Ln(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(n.push(n[0].slice(-c)),d-=c;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-c,-c+d))}}var u=Ln(n);if(u.length!=s)throw new Error("Unexpected length: ".concat(u.length," != ").concat(s));return u}function oa(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(_9(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ln(t)}function Qi(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Mt(s),o=i.length;t.push(i),s<=60?(o++,t.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),o+=s,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=s}return Ln(t)}function k9(e,t,r,s){var n=_i(e),i=n.getUint32(4,!0),o=(s>1?12:8)+Db(i&(s>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(l=n.getUint32(o,!0),o+=4),o+=Db(i&(s>1?12288:4096))*4,i&16&&(c=n.getUint32(o,!0),o+=4),i&32&&(d=n.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:u};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(c>-1)m={t:"s",v:t[c]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function P9(e,t,r){var s=_i(e),n=s.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);n&1&&(c=A9(e,i),i+=16),n&2&&(d=s.getFloat64(i,!0),i+=8),n&4&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8),n&8&&(l=s.getUint32(i,!0),i+=4),n&16&&(o=s.getUint32(i,!0),i+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:c};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:u};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return m}function $m(e,t){var r=new Uint8Array(32),s=_i(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,C9(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,i,!0),r.slice(0,n)}function zm(e,t){var r=new Uint8Array(32),s=_i(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,i,!0),r.slice(0,n)}function O9(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return k9(e,t,r,e[0]);case 5:return P9(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ls(e){var t=kt(e);return zl(t[1][0].data)}function Ib(e,t){var r=kt(t.data),s=br(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(o){var l=kt(o.data),c=br(l[1][0].data)>>>0;switch(s){case 1:i[c]=lp(l[3][0].data);break;case 8:{var d=e[ls(l[9][0].data)][0],u=kt(d.data),m=e[ls(u[1][0].data)][0],f=br(m.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=kt(m.data);i[c]=h[3].map(function(p){return lp(p.data)}).join("")}break}}),i}function D9(e,t){var r,s,n,i,o,l,c,d,u,m,f,h,p,x,g=kt(e),v=br(g[1][0].data)>>>0,w=br(g[2][0].data)>>>0,y=((s=(r=g[8])==null?void 0:r[0])==null?void 0:s.data)&&br(g[8][0].data)>0||!1,S,E;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&t!=0)S=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,E=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((m=(u=g[4])==null?void 0:u[0])!=null&&m.data&&t!=1)S=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,E=(x=(p=g[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=y?4:1,j=_i(S),T=[],C=0;C<S.length/2;++C){var L=j.getUint16(C*2,!0);L<65535&&T.push([C,L])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var A=[];for(C=0;C<T.length-1;++C)A[T[C][0]]=E.subarray(T[C][1]*N,T[C+1][1]*N);return T.length>=1&&(A[T[T.length-1][0]]=E.subarray(T[T.length-1][1]*N)),{R:v,cells:A}}function I9(e,t){var r,s=kt(t.data),n=(r=s?.[7])!=null&&r[0]?br(s[7][0].data)>>>0>0?1:0:-1,i=Xx(s[5],function(o){return D9(o,n)});return{nrows:br(s[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function R9(e,t,r){var s,n=kt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(br(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(br(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=vt(i);var o=kt(n[4][0].data),l=Ib(e,e[ls(o[4][0].data)][0]),c=(s=o[17])!=null&&s[0]?Ib(e,e[ls(o[17][0].data)][0]):[],d=kt(o[3][0].data),u=0;d[1].forEach(function(m){var f=kt(m.data),h=e[ls(f[2][0].data)][0],p=br(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=I9(e,h);x.data.forEach(function(g,v){g.forEach(function(w,y){var S=ct({r:u+v,c:y}),E=O9(w,l,c);E&&(r[S]=E)})}),u+=x.nrows})}function F9(e,t){var r=kt(t.data),s={"!ref":"A1"},n=e[ls(r[2][0].data)],i=br(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return R9(e,n[0],s),s}function L9(e,t){var r,s=kt(t.data),n={name:(r=s[1])!=null&&r[0]?lp(s[1][0].data):"",sheets:[]},i=Xx(s[2],ls);return i.forEach(function(o){e[o].forEach(function(l){var c=br(l.meta[1][0].data);c==6e3&&n.sheets.push(F9(e,l))})}),n}function M9(e,t){var r=rg(),s=kt(t.data),n=Xx(s[1],ls);if(n.forEach(function(i){e[i].forEach(function(o){var l=br(o.meta[1][0].data);if(l==2){var c=L9(e,o);c.sheets.forEach(function(d,u){sg(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Um(e){var t,r,s,n,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=oa(c.content)}catch(m){return console.log("?? "+c.content.length+" "+(m.message||m))}var u;try{u=ia(d)}catch(m){return console.log("## "+(m.message||m))}u.forEach(function(m){i[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((n=(s=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&br(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var u=br(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return M9(i,l)}function B9(e,t,r){var s,n,i,o;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&br(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=_i(e[7][0].data),u=0,m=[],f=_i(e[4][0].data),h=0,p=[],x=0;x<t.length;++x){if(t[x]==null){d.setUint16(x*2,65535,!0),f.setUint16(x*2,65535);continue}d.setUint16(x*2,u,!0),f.setUint16(x*2,h,!0);var g,v;switch(typeof t[x]){case"string":g=$m({t:"s",v:t[x]},r),v=zm({t:"s",v:t[x]},r);break;case"number":g=$m({t:"n",v:t[x]},r),v=zm({t:"n",v:t[x]},r);break;case"boolean":g=$m({t:"b",v:t[x]},r),v=zm({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}m.push(g),u+=g.length,p.push(v),h+=v.length,++c}for(e[2][0].data=Mt(c);x<e[7][0].data.length/2;++x)d.setUint16(x*2,65535,!0),f.setUint16(x*2,65535,!0);return e[6][0].data=Ln(m),e[3][0].data=Ln(p),c}function $9(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Ms(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(vt(s)));var i=Md(r,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(G){return G.forEach(function(U){typeof U=="string"&&o.push(U)})});var l={},c=[],d=rt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(G,U){return[G,d.FullPaths[U]]}).forEach(function(G){var U=G[0],B=G[1];if(U.type==2&&U.name.match(/\.iwa/)){var Y=U.content,te=oa(Y),ae=ia(te);ae.forEach(function(ne){c.push(ne.id),l[ne.id]={deps:[],location:B,type:br(ne.messages[0].meta[1][0].data)}})}}),c.sort(function(G,U){return G-U});var u=c.filter(function(G){return G>1}).map(function(G){return[G,Mt(G)]});d.FileIndex.map(function(G,U){return[G,d.FullPaths[U]]}).forEach(function(G){var U=G[0];if(G[1],!!U.name.match(/\.iwa/)){var B=ia(oa(U.content));B.forEach(function(Y){Y.messages.forEach(function(te){u.forEach(function(ae){Y.messages.some(function(ne){return br(ne.meta[1][0].data)!=11006&&T9(ne.data,ae[1])})&&l[ae[0]].deps.push(Y.id)})})})}});for(var m=rt.find(d,l[1].location),f=ia(oa(m.content)),h,p=0;p<f.length;++p){var x=f[p];x.id==1&&(h=x)}var g=ls(kt(h.messages[0].data)[1][0].data);for(m=rt.find(d,l[g].location),f=ia(oa(m.content)),p=0;p<f.length;++p)x=f[p],x.id==g&&(h=x);for(g=ls(kt(h.messages[0].data)[2][0].data),m=rt.find(d,l[g].location),f=ia(oa(m.content)),p=0;p<f.length;++p)x=f[p],x.id==g&&(h=x);for(g=ls(kt(h.messages[0].data)[2][0].data),m=rt.find(d,l[g].location),f=ia(oa(m.content)),p=0;p<f.length;++p)x=f[p],x.id==g&&(h=x);var v=kt(h.messages[0].data);{v[6][0].data=Mt(s.e.r+1),v[7][0].data=Mt(s.e.c+1);var w=ls(v[46][0].data),y=rt.find(d,l[w].location),S=ia(oa(y.content));{for(var E=0;E<S.length&&S[E].id!=w;++E);if(S[E].id!=w)throw"Bad ColumnRowUIDMapArchive";var N=kt(S[E].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var j=0;j<=s.e.c;++j){var T=[];T[1]=T[2]=[{type:0,data:Mt(j+420690)}],N[1].push({type:2,data:Zr(T)}),N[2].push({type:0,data:Mt(j)}),N[3].push({type:0,data:Mt(j)})}N[4]=[],N[5]=[],N[6]=[];for(var C=0;C<=s.e.r;++C)T=[],T[1]=T[2]=[{type:0,data:Mt(C+726270)}],N[4].push({type:2,data:Zr(T)}),N[5].push({type:0,data:Mt(C)}),N[6].push({type:0,data:Mt(C)});S[E].messages[0].data=Zr(N)}y.content=Qi(Zi(S)),y.size=y.content.length,delete v[46];var L=kt(v[4][0].data);{L[7][0].data=Mt(s.e.r+1);var A=kt(L[1][0].data),P=ls(A[2][0].data);y=rt.find(d,l[P].location),S=ia(oa(y.content));{if(S[0].id!=P)throw"Bad HeaderStorageBucket";var I=kt(S[0].messages[0].data);for(C=0;C<i.length;++C){var _=kt(I[2][0].data);_[1][0].data=Mt(C),_[4][0].data=Mt(i[C].length),I[2][C]={type:I[2][0].type,data:Zr(_)}}S[0].messages[0].data=Zr(I)}y.content=Qi(Zi(S)),y.size=y.content.length;var D=ls(L[2][0].data);y=rt.find(d,l[D].location),S=ia(oa(y.content));{if(S[0].id!=D)throw"Bad HeaderStorageBucket";for(I=kt(S[0].messages[0].data),j=0;j<=s.e.c;++j)_=kt(I[2][0].data),_[1][0].data=Mt(j),_[4][0].data=Mt(s.e.r+1),I[2][j]={type:I[2][0].type,data:Zr(_)};S[0].messages[0].data=Zr(I)}y.content=Qi(Zi(S)),y.size=y.content.length;var W=ls(L[4][0].data);(function(){for(var G=rt.find(d,l[W].location),U=ia(oa(G.content)),B,Y=0;Y<U.length;++Y){var te=U[Y];te.id==W&&(B=te)}var ae=kt(B.messages[0].data);{ae[3]=[];var ne=[];o.forEach(function(z,me){ne[1]=[{type:0,data:Mt(me)}],ne[2]=[{type:0,data:Mt(1)}],ne[3]=[{type:2,data:E9(z)}],ae[3].push({type:2,data:Zr(ne)})})}B.messages[0].data=Zr(ae);var fe=Zi(U),je=Qi(fe);G.content=je,G.size=G.content.length})();var K=kt(L[3][0].data);{var J=K[1][0];delete K[2];var F=kt(J.data);{var le=ls(F[2][0].data);(function(){for(var G=rt.find(d,l[le].location),U=ia(oa(G.content)),B,Y=0;Y<U.length;++Y){var te=U[Y];te.id==le&&(B=te)}var ae=kt(B.messages[0].data);{delete ae[6],delete K[7];var ne=new Uint8Array(ae[5][0].data);ae[5]=[];for(var fe=0,je=0;je<=s.e.r;++je){var z=kt(ne);fe+=B9(z,i[je],o),z[1][0].data=Mt(je),ae[5].push({data:Zr(z),type:2})}ae[1]=[{type:0,data:Mt(s.e.c+1)}],ae[2]=[{type:0,data:Mt(s.e.r+1)}],ae[3]=[{type:0,data:Mt(fe)}],ae[4]=[{type:0,data:Mt(s.e.r+1)}]}B.messages[0].data=Zr(ae);var me=Zi(U),ie=Qi(me);G.content=ie,G.size=G.content.length})()}J.data=Zr(F)}L[3][0].data=Zr(K)}v[4][0].data=Zr(L)}h.messages[0].data=Zr(v);var Ae=Zi(f),O=Qi(Ae);return m.content=O,m.size=m.content.length,d}function GE(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Jx(e){GE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Zx(e){GE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function z9(e){return jt.WS.indexOf(e)>-1?"sheet":e==jt.CS?"chart":e==jt.DS?"dialog":e==jt.MS?"macro":e&&e.length?e:"sheet"}function U9(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,z9(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function W9(e,t,r,s,n,i,o,l,c,d,u,m){try{i[s]=gl(Gs(e,r,!0),t);var f=Or(e,t),h;switch(l){case"sheet":h=uz(f,t,n,c,i[s],d,u,m);break;case"chart":if(h=mz(f,t,n,c,i[s],d,u,m),!h||!h["!drawel"])break;var p=dl(h["!drawel"].Target,t),x=Rl(p),g=ZL(Gs(e,p,!0),gl(Gs(e,x,!0),p)),v=dl(g,p),w=Rl(v);h=B$(Gs(e,v,!0),v,c,gl(Gs(e,w,!0),v),d,h);break;case"macro":h=fz(f,t,n,c,i[s],d,u,m);break;case"dialog":h=hz(f,t,n,c,i[s],d,u,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[s]=h;var y=[];i&&i[s]&&jr(i[s]).forEach(function(S){var E="";if(i[s][S].Type==jt.CMNT){E=dl(i[s][S].Target,t);var N=vz(Or(e,E,!0),E,c);if(!N||!N.length)return;bb(h,N,!1)}i[s][S].Type==jt.TCMNT&&(E=dl(i[s][S].Target,t),y=y.concat(eM(Or(e,E,!0),c)))}),y&&y.length&&bb(h,y,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function ta(e){return e.charAt(0)=="/"?e.slice(1):e}function H9(e,t){if(Do(),t=t||{},Jx(t),ca(e,"META-INF/manifest.xml")||ca(e,"objectdata.xml"))return kb(e,t);if(ca(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Um<"u"){if(e.FileIndex)return Um(e);var r=rt.utils.cfb_new();return $1(e).forEach(function(_){yt(r,_,t6(e,_))}),Um(r)}throw new Error("Unsupported NUMBERS file")}if(!ca(e,"[Content_Types].xml"))throw ca(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ca(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=$1(e),n=K6(Gs(e,"[Content_Types].xml")),i=!1,o,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",Or(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!Or(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(vl=[],n.sst)try{vl=gz(Or(e,ta(n.sst)),n.sst,t)}catch(_){if(t.WTF)throw _}t.cellStyles&&n.themes.length&&(c=xz(Gs(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(d=pz(Or(e,ta(n.style)),n.style,c,t))}n.links.map(function(_){try{var D=gl(Gs(e,Rl(ta(_))),_);return yz(Or(e,ta(_)),D,_,t)}catch{}});var u=dz(Or(e,ta(n.workbooks[0])),n.workbooks[0],t),m={},f="";n.coreprops.length&&(f=Or(e,ta(n.coreprops[0]),!0),f&&(m=IS(f)),n.extprops.length!==0&&(f=Or(e,ta(n.extprops[0]),!0),f&&tR(f,m,t)));var h={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(f=Gs(e,ta(n.custprops[0]),!0),f&&(h=sR(f,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(D){return D.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(p.Props=m,p.Custprops=h),t.bookSheets&&typeof o<"u"&&(p.SheetNames=o),t.bookSheets?p.SheetNames:t.bookProps))return p;o={};var x={};t.bookDeps&&n.calcchain&&(x=bz(Or(e,ta(n.calcchain)),n.calcchain));var g=0,v={},w,y;{var S=u.Sheets;m.Worksheets=S.length,m.SheetNames=[];for(var E=0;E!=S.length;++E)m.SheetNames[E]=S[E].name}var N=i?"bin":"xml",j=n.workbooks[0].lastIndexOf("/"),T=(n.workbooks[0].slice(0,j+1)+"_rels/"+n.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");ca(e,T)||(T="xl/_rels/workbook."+N+".rels");var C=gl(Gs(e,T,!0),T.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=wz(Or(e,ta(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=rM(Or(e,ta(n.people[0])),t)),C&&(C=U9(C,u.Sheets));var L=Or(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=m.Worksheets;++g){var A="sheet";if(C&&C[g]?(w="xl/"+C[g][1].replace(/[\/]?xl\//,""),ca(e,w)||(w=C[g][1]),ca(e,w)||(w=T.replace(/_rels\/.*$/,"")+C[g][1]),A=C[g][2]):(w="xl/worksheets/sheet"+(g+1-L)+"."+N,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(m.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,I=0;I!=t.sheets.length;++I)typeof t.sheets[I]=="number"&&t.sheets[I]==g&&(P=1),typeof t.sheets[I]=="string"&&t.sheets[I].toLowerCase()==m.SheetNames[g].toLowerCase()&&(P=1);if(!P)continue e}}W9(e,w,y,m.SheetNames[g],g,v,o,A,t,u,c,d)}return p={Directory:n,Workbook:u,Props:m,Custprops:h,Deps:x,Sheets:o,SheetNames:m.SheetNames,Strings:vl,Styles:d,Themes:c,SSF:sr(ot)},t&&t.bookFiles&&(e.files?(p.keys=s,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(_,D){_=_.replace(/^Root Entry[\/]/,""),p.keys.push(_),p.files[_]=e.FileIndex[D]}))),t&&t.bookVBA&&(n.vba.length>0?p.vbaraw=Or(e,ta(n.vba[0]),!0):n.defaults&&n.defaults.bin===dM&&(p.vbaraw=Or(e,"xl/vbaProject.bin",!0))),p}function V9(e,t){var r=t||{},s="Workbook",n=rt.find(e,s);try{if(s="/!DataSpaces/Version",n=rt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(wF(n.content),s="/!DataSpaces/DataSpaceMap",n=rt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=NF(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=rt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=SF(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=rt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);TF(n.content)}catch{}if(s="/EncryptionInfo",n=rt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=AF(n.content);if(s="/EncryptedPackage",n=rt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function G9(e,t){return t.bookType=="ods"?VE(e,t):t.bookType=="numbers"?$9(e,t):t.bookType=="xlsb"?q9(e,t):K9(e,t)}function q9(e,t){so=1024,e&&!e.SSF&&(e.SSF=sr(ot)),e&&e.SSF&&(Do(),Ru(e.SSF),t.revssf=Lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=bE.indexOf(t.bookType)>-1,n=Lx();Zx(t=t||{});var i=Nx(),o="",l=0;if(t.cellXfs=[],Hn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(i,o,RS(e.Props,t)),n.coreprops.push(o),Bt(t.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,yt(i,o,MS(e.Props)),n.extprops.push(o),Bt(t.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&jr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(i,o,BS(e.Custprops)),n.custprops.push(o),Bt(t.rels,4,o,jt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,yt(i,o,Nz(l-1,o,t,e,u)),n.sheets.push(o),Bt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,jt.WS[0])}if(m){var h=m["!comments"],p=!1,x="";h&&h.length>0&&(x="xl/comments"+l+"."+r,yt(i,x,Tz(h,x)),n.comments.push(x),Bt(u,-1,"../comments"+l+"."+r,jt.CMNT),p=!0),m["!legacy"]&&p&&yt(i,"xl/drawings/vmlDrawing"+l+".vml",gE(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}u["!id"].rId1&&yt(i,Rl(o),oo(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,yt(i,o,Ez(t.Strings,o,t)),n.strs.push(o),Bt(t.wbrels,-1,"sharedStrings."+r,jt.SST)),o="xl/workbook."+r,yt(i,o,jz(e,o)),n.workbooks.push(o),Bt(t.rels,1,o,jt.WB),o="xl/theme/theme1.xml",yt(i,o,Wx(e.Themes,t)),n.themes.push(o),Bt(t.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+r,yt(i,o,Sz(e,o,t)),n.styles.push(o),Bt(t.wbrels,-1,"styles."+r,jt.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",yt(i,o,e.vbaraw),n.vba.push(o),Bt(t.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+r,yt(i,o,Az(o)),n.metadata.push(o),Bt(t.wbrels,-1,"metadata."+r,jt.XLMETA),yt(i,"[Content_Types].xml",OS(n,t)),yt(i,"_rels/.rels",oo(t.rels)),yt(i,"xl/_rels/workbook."+r+".rels",oo(t.wbrels)),delete t.revssf,delete t.ssf,i}function K9(e,t){so=1024,e&&!e.SSF&&(e.SSF=sr(ot)),e&&e.SSF&&(Do(),Ru(e.SSF),t.revssf=Lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=bE.indexOf(t.bookType)>-1,n=Lx();Zx(t=t||{});var i=Nx(),o="",l=0;if(t.cellXfs=[],Hn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(i,o,RS(e.Props,t)),n.coreprops.push(o),Bt(t.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,yt(i,o,MS(e.Props)),n.extprops.push(o),Bt(t.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&jr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(i,o,BS(e.Custprops)),n.custprops.push(o),Bt(t.rels,4,o,jt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,yt(i,o,kE(l-1,t,e,m)),n.sheets.push(o),Bt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,jt.WS[0])}if(f){var p=f["!comments"],x=!1,g="";if(p&&p.length>0){var v=!1;p.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+l+"."+r,yt(i,g,tM(p,u,t)),n.threadedcomments.push(g),Bt(m,-1,"../threadedComments/threadedComment"+l+"."+r,jt.TCMNT)),g="xl/comments"+l+"."+r,yt(i,g,vE(p)),n.comments.push(g),Bt(m,-1,"../comments"+l+"."+r,jt.CMNT),x=!0}f["!legacy"]&&x&&yt(i,"xl/drawings/vmlDrawing"+l+".vml",gE(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&yt(i,Rl(o),oo(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,yt(i,o,nE(t.Strings,t)),n.strs.push(o),Bt(t.wbrels,-1,"sharedStrings."+r,jt.SST)),o="xl/workbook."+r,yt(i,o,RE(e)),n.workbooks.push(o),Bt(t.rels,1,o,jt.WB),o="xl/theme/theme1.xml",yt(i,o,Wx(e.Themes,t)),n.themes.push(o),Bt(t.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+r,yt(i,o,fE(e,t)),n.styles.push(o),Bt(t.wbrels,-1,"styles."+r,jt.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",yt(i,o,e.vbaraw),n.vba.push(o),Bt(t.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+r,yt(i,o,xE()),n.metadata.push(o),Bt(t.wbrels,-1,"metadata."+r,jt.XLMETA),u.length>1&&(o="xl/persons/person.xml",yt(i,o,sM(u)),n.people.push(o),Bt(t.wbrels,-1,"persons/person.xml",jt.PEOPLE)),yt(i,"[Content_Types].xml",OS(n,t)),yt(i,"_rels/.rels",oo(t.rels)),yt(i,"xl/_rels/workbook."+r+".rels",oo(t.wbrels)),delete t.revssf,delete t.ssf,i}function Qx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Xs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Y9(e,t){return rt.find(e,"EncryptedPackage")?V9(e,t):BE(e,t)}function X9(e,t){var r,s=e,n=t||{};return n.type||(n.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r=oS(s,n),H9(r,n)}function qE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ip(e.slice(r),t);default:break e}return go.to_workbook(e,t)}function J9(e,t){var r="",s=Qx(e,t);switch(t.type){case"base64":r=Xs(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ei(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=Gt(r)),t.type="binary",qE(r,t)}function Z9(e,t){var r=e;return t.type=="base64"&&(r=Xs(r)),r=_l.utils.decode(1200,r.slice(2),"str"),t.type="binary",qE(r,t)}function Q9(e){return e.match(/[^\x00-\x7F]/)?za(e):e}function Wm(e,t,r,s){return s?(r.type="string",go.to_workbook(e,r)):go.to_workbook(t,r)}function Ul(e,t){vx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ul(new Uint8Array(e),(r=sr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),co={},r.dateNF&&(co.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",s=qI(e),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,s=Q9(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=sr(r),r.type="array",Ul(bx(s),r)}switch((n=Qx(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return Y9(rt.read(s,r),r);break;case 9:if(n[1]<=8)return BE(s,r);break;case 60:return ip(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return aF(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return sE.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?X9(s,r):Wm(e,s,r,i);case 239:return n[3]===60?ip(s,r):Wm(e,s,r,i);case 255:if(n[1]===254)return Z9(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return pi.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return pi.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return np.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return dE.to_workbook(s,r);break;case 10:case 13:case 32:return J9(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return sF.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?np.to_workbook(s,r):Wm(e,s,r,i)}function KE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return cc(t.file,rt.write(e,{type:wt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return rt.write(e,t)}function eU(e,t){var r=sr(t||{}),s=G9(e,r);return tU(s,r)}function tU(e,t){var r={},s=wt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?rt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Iu(n))}return t.password&&typeof encrypt_agile<"u"?KE(encrypt_agile(n,t.password),t):t.type==="file"?cc(t.file,n):t.type=="string"?Gt(n):n}function rU(e,t){var r=t||{},s=Qz(e,r);return KE(s,r)}function Ba(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return kl(za(s));case"binary":return za(s);case"string":return e;case"file":return cc(t.file,s,"utf8");case"buffer":return wt?pn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Ba(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function sU(e,t){switch(t.type){case"base64":return kl(e);case"binary":return e;case"string":return e;case"file":return cc(t.file,e,"binary");case"buffer":return wt?pn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Yc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?kl(r):t.type=="string"?Gt(r):r;case"file":return cc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function YE(e,t){vx(),Y$(e);var r=sr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=YE(e,r);return r.type="array",Iu(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ba(Gz(e,r),r);case"slk":case"sylk":return Ba(rE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return Ba(zE(e.Sheets[e.SheetNames[n]],r),r);case"txt":return sU(XE(e.Sheets[e.SheetNames[n]],r),r);case"csv":return Ba(tg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return Ba(sE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Yc(np.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return Ba(go.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return Ba(dE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return Ba(aE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return Ba(VE(e,r),r);case"wk1":return Yc(pi.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Yc(pi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Yc($E(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),rU(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return eU(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function aU(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function eg(e,t,r){var s=r||{};return s.type="file",s.file=t,aU(s),YE(e,s)}function nU(e,t,r,s,n,i,o,l){var c=Cr(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var p=o?e[r][h]:e[s[h]+c];if(p===void 0||p.t===void 0){if(d===void 0)continue;i[h]!=null&&(f[i[h]]=d);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[h]!=null){if(x==null)if(p.t=="e"&&x===null)f[i[h]]=null;else if(d!==void 0)f[i[h]]=d;else if(u&&x===null)f[i[h]]=null;else continue;else f[i[h]]=u&&(p.t!=="n"||p.t==="n"&&l.rawNumbers!==!1)?x:dn(p,x,l);x!=null&&(m=!1)}}return{row:f,isempty:m}}function Md(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?s=1:d.header==="A"?s=2:Array.isArray(d.header)?s=3:d.header==null&&(s=0),typeof u){case"string":c=_t(u);break;case"number":c=_t(e["!ref"]),c.s.r=u;break;default:c=u}s>0&&(n=0);var m=Cr(c.s.r),f=[],h=[],p=0,x=0,g=Array.isArray(e),v=c.s.r,w=0,y={};g&&!e[v]&&(e[v]=[]);var S=d.skipHidden&&e["!cols"]||[],E=d.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(S[w]||{}).hidden)switch(f[w]=mr(w),r=g?e[v][w]:e[f[w]+m],s){case 1:i[w]=w-c.s.c;break;case 2:i[w]=f[w];break;case 3:i[w]=d.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=dn(r,null,d),x=y[o]||0,!x)y[o]=1;else{do l=o+"_"+x++;while(y[l]);y[o]=x,y[l]=1}i[w]=l}for(v=c.s.r+n;v<=c.e.r;++v)if(!(E[v]||{}).hidden){var N=nU(e,c,v,f,s,i,g,d);(N.isempty===!1||(s===1?d.blankrows!==!1:d.blankrows))&&(h[p++]=N.row)}return h.length=p,h}var Rb=/"/g;function iU(e,t,r,s,n,i,o,l){for(var c=!0,d=[],u="",m=Cr(r),f=t.s.c;f<=t.e.c;++f)if(s[f]){var h=l.dense?(e[r]||[])[f]:e[s[f]+m];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:dn(h,null,l));for(var p=0,x=0;p!==u.length;++p)if((x=u.charCodeAt(p))===n||x===i||x===34||l.forceQuotes){u='"'+u.replace(Rb,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(Rb,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function tg(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=_t(e["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",m=[];s.dense=Array.isArray(e);for(var f=s.skipHidden&&e["!cols"]||[],h=s.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(f[p]||{}).hidden||(m[p]=mr(p));for(var x=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||(u=iU(e,n,g,m,o,c,i,s),u!=null&&(s.strip&&(u=u.replace(d,"")),(u||s.blankrows!==!1)&&r.push((x++?l:"")+u)));return delete s.dense,r.join("")}function XE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=tg(e,t);return r}function oU(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=_t(e["!ref"]),i="",o=[],l,c=[],d=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=mr(l);for(var u=n.s.r;u<=n.e.r;++u)for(i=Cr(u),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+i,r=d?(e[u]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=t+"="+s}return c}function JE(e,t,r){var s=r||{},n=+!s.skipHeader,i=e||{},o=0,l=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?fr(s.origin):s.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var m=_t(i["!ref"]);u.e.c=Math.max(u.e.c,m.e.c),u.e.r=Math.max(u.e.r,m.e.r),o==-1&&(o=m.e.r+1,u.e.r=o+t.length-1+n)}else o==-1&&(o=0,u.e.r=t.length-1+n);var f=s.header||[],h=0;t.forEach(function(x,g){jr(x).forEach(function(v){(h=f.indexOf(v))==-1&&(f[h=f.length]=v);var w=x[v],y="z",S="",E=ct({c:l+h,r:o+g+n});d=Wl(i,E),w&&typeof w=="object"&&!(w instanceof Date)?i[E]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",s.cellDates||(y="n",w=Br(w)),S=s.dateNF||ot[14]):w===null&&s.nullError&&(y="e",w=0),d?(d.t=y,d.v=w,delete d.w,delete d.R,S&&(d.z=S)):i[E]=d={t:y,v:w},S&&(d.z=S))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var p=Cr(o);if(n)for(h=0;h<f.length;++h)i[mr(h+l)+p]={t:"s",v:f[h]};return i["!ref"]=vt(u),i}function lU(e,t){return JE(null,e,t)}function Wl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=fr(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wl(e,ct(t)):Wl(e,ct({r:t,c:r||0}))}function cU(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function rg(){return{SheetNames:[],Sheets:{}}}function sg(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(IE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function dU(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=cU(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function uU(e,t){return e.z=t,e}function ZE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mU(e,t,r){return ZE(e,"#"+t,r)}function fU(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function hU(e,t,r,s){for(var n=typeof t!="string"?t:_t(t),i=typeof t=="string"?t:vt(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=Wl(e,o,l);c.t="n",c.F=i,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=r,s&&(c.D=!0))}return e}var fa={encode_col:mr,encode_row:Cr,encode_cell:ct,encode_range:vt,decode_col:Px,decode_row:kx,split_cell:E6,decode_cell:fr,decode_range:Ms,format_cell:dn,sheet_add_aoa:ES,sheet_add_json:JE,sheet_add_dom:UE,aoa_to_sheet:Io,json_to_sheet:lU,table_to_sheet:WE,table_to_book:w9,sheet_to_csv:tg,sheet_to_txt:XE,sheet_to_json:Md,sheet_to_html:zE,sheet_to_formulae:oU,sheet_to_row_object_array:Md,sheet_get_cell:Wl,book_new:rg,book_append_sheet:sg,book_set_sheet_visibility:dU,cell_set_number_format:uU,cell_set_hyperlink:ZE,cell_set_internal_link:mU,cell_add_comment:fU,sheet_set_array_formula:hU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const pU=({show:e,onClose:t,onImport:r,loading:s=!1})=>{const[n,i]=b.useState(!1),[o,l]=b.useState(null),[c,d]=b.useState([]),[u,m]=b.useState([]),[f,h]=b.useState([]),[p,x]=b.useState([]),[g,v]=b.useState(!1),w=b.useRef(null),y=["first_name","last_name","email","role"],S=["first_name","middle_name","last_name","address","email","phone_number","avatar_url","gender","role","department","certification_number","specialization","years_of_experience","bio","date_of_birth","enrollment_date","training_batch","passport_no","nation"];b.useEffect(()=>{e&&E()},[e]);const E=async()=>{try{v(!0);const O=await bs.getRoles();let G=[];Array.isArray(O)?G=O:O?.data?.roles?G=O.data.roles:O?.roles?G=O.roles:O?.data&&Array.isArray(O.data)&&(G=O.data),console.log(" Roles fetched:",{responseType:typeof O,responseKeys:O?Object.keys(O):"null",rolesCount:G.length,roles:G.map(U=>({id:U.id,name:U.name}))}),x(G)}catch(O){console.error("Failed to fetch roles:",O),m(["Failed to load roles. Please refresh the page."]),x([])}finally{v(!1)}},N=O=>{if(!O)return"";try{return decodeURIComponent(escape(O)).trim()}catch{return O.toString().trim()}},j=O=>{if(!O)return"";try{let G;if(O instanceof Date)G=O;else{const B=O.toString().trim();if(!B||B===""||B==="null"||B==="undefined")return"";if(B.includes("/")){const Y=B.split("/");Y.length===3&&(G=new Date(Y[2],Y[0]-1,Y[1]))}else if(B.includes("-")){const Y=B.split("-");Y.length===3&&(Y[0].length===4?G=new Date(Y[0],Y[1]-1,Y[2]):G=new Date(Y[2],Y[1]-1,Y[0]))}else G=new Date(B)}if(isNaN(G.getTime()))return"";const U=G.getFullYear();return U<1900||U>2100?"":G.toISOString()}catch(G){return console.error("Error formatting date:",G,"Input:",O),""}},T=O=>{if(!O)return"MALE";const G=O.toString().toUpperCase().trim();return G==="MALE"||G==="FEMALE"?G:{M:"MALE",F:"FEMALE"}[G]||"MALE"},C=O=>{if(!O)return null;const G=O.toString().toUpperCase().trim();return["MALE","FEMALE","M","F"].includes(G)?null:"Invalid gender value. Accepted values: MALE, FEMALE, M, F"},L=O=>O?O.toString().toUpperCase().trim().replace(/\s+/g,"_"):"",A=O=>{if(!O||!p.length)return console.warn(" findRoleId: No roleName or roles not loaded",{roleName:O,rolesCount:p.length}),null;const G=L(O);console.log(" Finding role:",{input:O,normalized:G,availableRoles:p.map(ae=>({name:ae.name,normalized:L(ae.name),id:ae.id}))});const U=p.find(ae=>{const ne=L(ae.name),fe=ne===G;return fe&&console.log(" Direct match:",{input:O,inputNormalized:G,dbRole:ae.name,dbRoleNormalized:ne,match:fe}),fe});if(U)return console.log(" Direct match found:",U.name,U.id),U.id;console.log(" Direct match failed, checking normalization..."),p.forEach(ae=>{const ne=L(ae.name);ne===G&&console.log(" Found potential match:",{input:O,inputNormalized:G,dbRole:ae.name,dbRoleNormalized:ne,match:ne===G})});const Y={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE"}[G];if(Y){const ae=p.find(ne=>L(ne.name)===Y);if(ae)return console.log(" Partial match found:",ae.name,ae.id),ae.id}const te=p.find(ae=>{const ne=L(ae.name),fe=ne.includes(G)||G.includes(ne);return fe&&console.log(" Fuzzy match candidate:",{input:O,inputNormalized:G,dbRole:ae.name,dbRoleNormalized:ne}),fe});return te?(console.log(" Fuzzy match found:",te.name,te.id),te.id):(console.warn(" No role match found for:",{input:O,normalized:G,availableRoles:p.map(ae=>({name:ae.name,normalized:L(ae.name)}))}),null)},P=O=>{if(!O||!p.length)return null;const G=L(O),U=p.find(ae=>L(ae.name)===G);if(U)return U.name;const Y={ADMIN:"ADMINISTRATOR",ADMINISTRATOR:"ADMINISTRATOR",TRAINER:"TRAINER",TRAINEE:"TRAINEE",DEPT_HEAD:"DEPARTMENT_HEAD",DEPARTMENT_HEAD:"DEPARTMENT_HEAD","DEPARTMENT HEAD":"DEPARTMENT_HEAD",SQA_AUDITOR:"SQA_AUDITOR","SQA AUDITOR":"SQA_AUDITOR",ACADEMIC_DEPARTMENT:"ACADEMIC_DEPARTMENT",ACADEMIC_DEPT:"ACADEMIC_DEPARTMENT","ACADEMIC DEPT":"ACADEMIC_DEPARTMENT","ACADEMIC DEPARTMENT":"ACADEMIC_DEPARTMENT"}[G];if(Y){const ae=p.find(ne=>L(ne.name)===Y);if(ae)return ae.name}const te=p.find(ae=>{const ne=L(ae.name);return ne.includes(G)||G.includes(ne)});return te?te.name:null},I=()=>{const O=[S,["Nguyn","Vn","An","123 ng L Li, Qun 1, TP.HCM","nguyen.van.an@example.com","+84 123 456 789","TRAINER","M","1","CERT001","Flight Training","5","1990-01-15","BATCH2023-01","P123456789","Vietnam"]],G=fa.aoa_to_sheet(O),U=fa.book_new();fa.book_append_sheet(U,G,"Users"),eg(U,"User_Upload_Template.xlsx",{bookType:"xlsx",type:"binary"})},_=O=>{O.preventDefault(),O.stopPropagation(),O.type==="dragenter"||O.type==="dragover"?i(!0):O.type==="dragleave"&&i(!1)},D=O=>{O.preventDefault(),O.stopPropagation(),i(!1),O.dataTransfer.files&&O.dataTransfer.files[0]&&K(O.dataTransfer.files[0])},W=O=>{O.target.files&&O.target.files[0]&&K(O.target.files[0])},K=O=>{if(!O.name.match(/\.(xlsx|xls)$/)){m(["Please upload an Excel file (.xlsx or .xls)"]);return}if(O.size>100*1024*1024){m(["File size must be less than 100MB"]);return}if(l(O),m([]),h([]),d([]),g){h(["Roles are still loading. Please wait a moment and try again."]);return}if(p.length===0){h(["Roles are not loaded yet. Please refresh the page and try again."]);return}console.log(" Processing file with roles loaded:",{rolesCount:p.length,roles:p.map(U=>U.name)});const G=new FileReader;G.onload=U=>{try{const B=new Uint8Array(U.target.result),Y=Ul(B,{type:"array",cellText:!1,cellDates:!0,raw:!1}),te=Y.SheetNames[0],ae=Y.Sheets[te],ne=fa.sheet_to_json(ae,{header:1,defval:"",raw:!1});if(ne.length<2){m(["File must contain at least a header row and one data row"]);return}const fe=ne[0].map(he=>he?he.toString().trim().toLowerCase().replace(/\s+/g,"_"):""),je=ne.slice(1),z={first_name:"first_name",firstname:"first_name","first name":"first_name",middle_name:"middle_name",middlename:"middle_name","middle name":"middle_name",last_name:"last_name",lastname:"last_name","last name":"last_name",full_name:"full_name",fullname:"full_name","full name":"full_name",name:"full_name",address:"address",email:"email",phone_number:"phone_number",phonenumber:"phone_number","phone number":"phone_number",phone:"phone_number",role:"role",department:"department",dept:"department",dept_id:"department",department_id:"department",certification_number:"certification_number",certificationnumber:"certification_number","certification number":"certification_number",certification:"certification_number",specialization:"specialization",years_of_experience:"years_of_experience",yearsofexperience:"years_of_experience","years of experience":"years_of_experience",experience:"years_of_experience",date_of_birth:"date_of_birth",dateofbirth:"date_of_birth","date of birth":"date_of_birth",dob:"date_of_birth",training_batch:"training_batch",trainingbatch:"training_batch","training batch":"training_batch",batch:"training_batch",passport_no:"passport_no",passportno:"passport_no","passport no":"passport_no",passport:"passport_no",nation:"nation",nationality:"nation",country:"nation",gender:"gender",sex:"gender"},ie=fe.map(he=>z[he]||he).filter(he=>S.includes(he)),ke=y.filter(he=>!ie.includes(he));if(ke.length>0){h([`Your file is missing these essential data to create a user: ${ke.join(", ")}`]);return}p.length===0&&(console.warn(" Roles not loaded yet, validation may fail"),h([" Roles are still loading. Role validation may fail. Please wait and try again if you see role errors."]));const Fe=je.map((he,Me)=>{const de={};let We=!1;const et=[];fe.forEach((Ke,Je)=>{const ft=z[Ke]||Ke;if(S.includes(ft)){let nt="";he[Je]!==null&&he[Je]!==void 0&&(typeof he[Je]=="string"?nt=N(he[Je]):typeof he[Je]=="number"?nt=he[Je].toString():nt=N(he[Je].toString())),ft==="gender"&&(nt=T(nt)),de[ft]=nt}}),ie.forEach(Ke=>{const Je=de[Ke]||"";if(y.includes(Ke)&&!Je&&(We=!0,et.push("Required field missing")),Ke==="email"&&Je&&!/\S+@\S+\.\S+/.test(Je)&&(We=!0,et.push("Invalid email")),Ke==="role"&&Je)if(p.length>0){const ft=A(Je);if(ft)console.log(" Role validated successfully:",Je,"",ft);else{We=!0;const nt=L(Je),qe=p.map(be=>({original:be.name,normalized:L(be.name)}));console.error(" Role validation failed:",{input:Je,normalizedInput:nt,availableRoles:p.map(be=>be.name),availableNormalized:qe}),et.push(`Invalid role: "${Je}". Available roles: ${p.map(be=>be.name).join(", ")}`)}}else console.warn(" Roles not loaded, cannot validate role:",Je);if(Ke==="phone_number"&&Je&&Je.length>15&&(We=!0,et.push("Phone number too long (max 15 characters)")),Ke==="years_of_experience"&&Je&&isNaN(Je)&&(We=!0,et.push("Invalid experience value")),Ke==="gender"&&Je){const ft=C(Je);ft&&(We=!0,et.push(ft))}});const ht=P(de.role);return ht==="TRAINER"?((!de.specialization||de.specialization.trim()==="")&&(We=!0,et.push("Trainer requires specialization")),(!de.years_of_experience||de.years_of_experience.trim()==="")&&(We=!0,et.push("Trainer requires years of experience")),de.department&&de.department.trim()!==""&&de.department.trim()!=="-"&&(We=!0,et.push("Department is not allowed for Trainer role"))):ht==="TRAINEE"&&(!de.date_of_birth||de.date_of_birth.trim()===""?(We=!0,et.push("Trainee requires date of birth")):j(de.date_of_birth)||(We=!0,et.push(`Invalid date format for date of birth: "${de.date_of_birth}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)),(!de.training_batch||de.training_batch.trim()==="")&&(We=!0,et.push("Trainee requires training batch")),(!de.passport_no||de.passport_no.trim()==="")&&(We=!0,et.push("Trainee requires passport number")),(!de.nation||de.nation.trim()==="")&&(We=!0,et.push("Trainee requires nation")),de.enrollment_date&&de.enrollment_date.trim()!==""&&(j(de.enrollment_date)||(We=!0,et.push(`Invalid date format for enrollment date: "${de.enrollment_date}". Use YYYY-MM-DD, MM/DD/YYYY, or DD/MM/YYYY`)))),{id:Me+1,...de,hasError:We,errors:et,status:We?"error":"valid"}});d(Fe)}catch{m(["Error reading file. Please make sure it's a valid Excel file."])}},G.readAsArrayBuffer(O)},J=async()=>{const O=c.filter(U=>!U.hasError);if(O.length===0){m(["No valid users to import"]);return}if(!p.length){m(["Roles not loaded. Please wait and try again."]);return}const G=O.map(U=>{const B=U.phone_number?U.phone_number.substring(0,15):"",Y=A(U.role),te=P(U.role);if(!Y||!te)throw new Error(`Role "${U.role}" not found in system`);const ae={firstName:U.first_name||"",middleName:U.middle_name||"",lastName:U.last_name||"",address:U.address||"",email:U.email||"",phoneNumber:B,avatarUrl:U.avatar_url||"",gender:T(U.gender),role:{id:Y,name:te}};if(te==="DEPARTMENT_HEAD"?U.department&&U.department.trim()!==""&&U.department.trim()!=="-"?ae.departmentId=U.department:ae.departmentId=null:te!=="TRAINER"&&U.department&&U.department.trim()!==""&&U.department.trim()!=="-"&&(ae.departmentId=U.department),te==="TRAINER")ae.trainerProfile={specialization:U.specialization||"",yearsOfExp:U.years_of_experience?parseInt(U.years_of_experience):0,certificationNumber:U.certification_number||"",bio:U.bio||""};else if(te==="TRAINEE"){const ne={trainingBatch:U.training_batch||"",passportNo:U.passport_no||"",nation:U.nation||""},fe=j(U.date_of_birth);fe&&(ne.dob=fe);const je=j(U.enrollment_date);je?ne.enrollmentDate=je:ne.enrollmentDate=new Date().toISOString(),ae.traineeProfile=ne}return ae});try{await r(G),F()}catch(U){m([U.message||"Failed to import users. Please try again."])}},F=()=>{l(null),d([]),m([]),h([]),i(!1),t()},le=O=>{d(G=>G.filter(U=>U.id!==O))},Ae=O=>O==="valid"?a.jsx(lt,{className:"text-success",size:16}):a.jsx(Ks,{className:"text-danger",size:16});return a.jsxs(ue,{show:e,onHide:F,size:"xl",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Ts,{className:"me-2",size:20}),"Bulk Import Users"]}),a.jsx(se,{variant:"link",onClick:F,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[g&&a.jsxs("div",{className:"text-center mb-3",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",style:{width:"1.5rem",height:"1.5rem",borderWidth:"0.2em"},children:a.jsx("span",{className:"visually-hidden",children:"Loading roles..."})}),a.jsx("span",{className:"ms-2 text-muted",children:"Loading roles..."})]}),a.jsx(M,{className:"mb-4",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:_,onDragLeave:_,onDragOver:_,onDrop:D,onClick:()=>w.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[a.jsx(fo,{size:48,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),a.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),a.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",onChange:W,style:{display:"none"}})]}),a.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[o&&a.jsxs("p",{className:"text-success mb-1",children:[a.jsx("strong",{children:"Uploaded file:"})," ",o.name]}),a.jsx("p",{className:"text-muted mb-0",children:"Up to 100 records per upload."}),a.jsxs("small",{className:"text-info d-block mt-1",children:[a.jsx("strong",{children:"Gender format:"})," M/F or MALE/FEMALE"]})]}),a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:I,className:"d-flex align-items-center",children:[a.jsx(Fi,{className:"me-1",size:14}),"Download Template"]})]})]})}),u.length>0&&a.jsx("div",{className:"alert alert-danger mb-3",children:a.jsx("ul",{className:"mb-0",children:u.map((O,G)=>a.jsx("li",{children:O},G))})}),f.length>0&&a.jsx(Re,{variant:"warning",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:f.map((O,G)=>a.jsx("li",{children:O},G))})}),c.length>0&&a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:a.jsxs(It,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{style:{minWidth:"50px"},children:"NO."}),a.jsx("th",{style:{minWidth:"120px"},children:"FIRST NAME"}),a.jsx("th",{style:{minWidth:"120px"},children:"MIDDLE NAME"}),a.jsx("th",{style:{minWidth:"120px"},children:"LAST NAME"}),a.jsx("th",{style:{minWidth:"200px"},children:"EMAIL"}),a.jsx("th",{style:{minWidth:"120px"},children:"ROLE"}),a.jsx("th",{style:{minWidth:"100px"},children:"DEPARTMENT"}),a.jsx("th",{style:{minWidth:"150px"},children:"PHONE NUMBER"}),a.jsx("th",{style:{minWidth:"100px"},children:"GENDER"}),a.jsx("th",{style:{minWidth:"150px"},children:"CERTIFICATION"}),a.jsx("th",{style:{minWidth:"150px"},children:"SPECIALIZATION"}),a.jsx("th",{style:{minWidth:"100px"},children:"EXPERIENCE"}),a.jsx("th",{style:{minWidth:"120px"},children:"DATE OF BIRTH"}),a.jsx("th",{style:{minWidth:"120px"},children:"TRAINING BATCH"}),a.jsx("th",{style:{minWidth:"120px"},children:"PASSPORT NO"}),a.jsx("th",{style:{minWidth:"100px"},children:"NATION"}),a.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),a.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),a.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),a.jsx("tbody",{children:c.map(O=>a.jsxs("tr",{className:O.hasError?"table-danger":"",children:[a.jsx("td",{children:O.id}),a.jsx("td",{children:O.first_name||O.full_name||"-"}),a.jsx("td",{children:O.middle_name||"-"}),a.jsx("td",{children:O.last_name||"-"}),a.jsx("td",{children:O.email||"-"}),a.jsx("td",{children:O.role||"-"}),a.jsx("td",{children:O.department||"-"}),a.jsx("td",{children:O.phone_number||"-"}),a.jsx("td",{children:O.gender?a.jsx("span",{title:`Original: ${O.gender}`,children:T(O.gender)}):"-"}),a.jsx("td",{children:O.certification_number||"-"}),a.jsx("td",{children:O.specialization||"-"}),a.jsx("td",{children:O.years_of_experience||"-"}),a.jsx("td",{children:O.date_of_birth||"-"}),a.jsx("td",{children:O.training_batch||"-"}),a.jsx("td",{children:O.passport_no||"-"}),a.jsx("td",{children:O.nation||"-"}),a.jsx("td",{className:"text-center",children:Ae(O.status)}),a.jsx("td",{children:O.errors.length>0&&a.jsx("small",{className:"text-danger",children:O.errors.length>1?`${O.errors[0]} (+${O.errors.length-1} more)`:O.errors[0]})}),a.jsx("td",{children:a.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>le(O.id),children:a.jsx(Mi,{size:14})})})]},O.id))})]})})})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:F,disabled:s,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),c.length>0&&a.jsx($2,{placement:"top",overlay:a.jsxs(z2,{id:"import-tooltip",children:["Only ",c.filter(O=>!O.hasError).length,"/",c.length," users will be imported into DSFMS"]}),children:a.jsx(se,{variant:"primary",onClick:J,disabled:s||c.filter(O=>!O.hasError).length===0,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ts,{className:"me-2",size:16}),"Import All (",c.filter(O=>!O.hasError).length," users)"]})})})]})]})},xU=({show:e,user:t,onConfirm:r,onCancel:s,loading:n=!1})=>{if(!t)return null;const i=t.status==="ACTIVE",o=i?"Disable":"Enable",c=i?rc:lt;return a.jsxs(ue,{show:e,onHide:s,centered:!0,backdrop:"static",keyboard:!1,children:[a.jsx(ue.Header,{closeButton:!0,className:`border-0 ${i?"bg-warning-subtle":"bg-success-subtle"}`,children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(yr,{className:`me-2 ${i?"text-warning":"text-success"}`,size:20}),o," User"]})}),a.jsxs(ue.Body,{className:"py-4",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:`rounded-circle d-inline-flex align-items-center justify-content-center mb-3 ${i?"bg-warning-subtle":"bg-success-subtle"}`,style:{width:"64px",height:"64px"},children:a.jsx(c,{size:32,className:i?"text-warning":"text-success"})}),a.jsx("h5",{className:"mb-3",children:i?"Disable User Account":"Enable User Account"}),a.jsx("p",{className:"text-muted mb-4",children:i?"Are you sure you want to disable this user account? This action will:":"Are you sure you want to enable this user account? This action will:"})]}),a.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx("div",{className:"me-3",children:a.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:a.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:t.fullName}),a.jsx("small",{className:"text-muted",children:t.email})]})]}),a.jsxs("div",{className:"row text-center",children:[a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"text-muted small",children:"EID"}),a.jsx("div",{className:"fw-medium",children:t.eid})]}),a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"text-muted small",children:"Role"}),a.jsx("div",{className:"fw-medium",children:t.role})]}),a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"text-muted small",children:"Department"}),a.jsx("div",{className:"fw-medium",children:t.department})]})]})]}),i?a.jsxs(Re,{variant:"warning",className:"mb-0",children:[a.jsx("div",{className:"fw-semibold mb-2",children:" What happens when disabled:"}),a.jsxs("ul",{className:"mb-0 small",children:[a.jsx("li",{children:"User cannot log into the system"}),a.jsx("li",{children:"All active sessions will be terminated"}),a.jsx("li",{children:"User data will be preserved but access restricted"}),a.jsx("li",{children:"User can be re-enabled later by an administrator"})]})]}):a.jsxs(Re,{variant:"success",className:"mb-0",children:[a.jsx("div",{className:"fw-semibold mb-2",children:" What happens when enabled:"}),a.jsxs("ul",{className:"mb-0 small",children:[a.jsx("li",{children:"User can log into the system normally"}),a.jsx("li",{children:"All permissions and access will be restored"}),a.jsx("li",{children:"User will receive notification of account activation"}),a.jsx("li",{children:"Previous data and settings will be available"})]})]})]}),a.jsxs(ue.Footer,{className:"border-0 bg-light",children:[a.jsx(se,{variant:"outline-secondary",onClick:s,disabled:n,children:"Cancel"}),a.jsx(se,{variant:i?"warning":"success",onClick:r,disabled:n,className:"d-flex align-items-center",children:n?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):a.jsxs(a.Fragment,{children:[a.jsx(c,{className:"me-2",size:16}),o," User"]})})]})]})},gU=({uniqueRoles:e,uniqueDepartments:t,selectedRoles:r,selectedDepartments:s,onRoleToggle:n,onDepartmentToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||s.length>0;return a.jsxs($t,{className:`filter-panel-dropdown ${l}`,children:[a.jsx($t.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Li,{size:14,className:"me-2"}),"Filters",c&&a.jsx("span",{className:"badge bg-primary ms-2",children:r.length+s.length})]})}),a.jsxs($t.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Roles"}),r.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>a.jsx(k.Check,{type:"checkbox",id:`role-${d}`,label:d,checked:r.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Departments"}),s.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>a.jsx(k.Check,{type:"checkbox",id:`dept-${d}`,label:d,checked:s.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[a.jsx(Ze,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},vU=({show:e,user:t,newRole:r,onConfirm:s,onCancel:n,loading:i=!1})=>{if(!t)return null;const o=d=>{switch(d){case"ADMIN":return"AD";case"ACADEMIC_DEPT":return"AC";case"DEPT_HEAD":return"DH";case"TRAINER":return"TR";case"TRAINEE":return"TN";case"SQA_AUDITOR":return"QA";default:return"EM"}},l=o(t.role),c=o(r);return a.jsxs(ue,{show:e,onHide:n,centered:!0,backdrop:"static",keyboard:!1,children:[a.jsx(ue.Header,{closeButton:!0,className:"bg-warning-subtle border-0",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(yr,{className:"me-2 text-warning",size:20}),"Role Change Confirmation"]})}),a.jsxs(ue.Body,{className:"py-4",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"bg-warning-subtle rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"64px",height:"64px"},children:a.jsx(yr,{size:32,className:"text-warning"})}),a.jsx("h5",{className:"mb-3",children:"Role Change Will Update EID"}),a.jsx("p",{className:"text-muted mb-4",children:"Changing the user's role will automatically update their Employee ID (EID) to match the new role prefix."})]}),a.jsxs("div",{className:"bg-light rounded p-3 mb-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx("div",{className:"me-3",children:a.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:a.jsx("span",{className:"fw-bold",children:t.fullName.charAt(0)})})}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:t.fullName}),a.jsx("small",{className:"text-muted",children:t.email})]})]}),a.jsxs("div",{className:"row text-center",children:[a.jsxs("div",{className:"col-6",children:[a.jsx("div",{className:"text-muted small",children:"Current Role"}),a.jsx("div",{className:"fw-medium",children:t.role})]}),a.jsxs("div",{className:"col-6",children:[a.jsx("div",{className:"text-muted small",children:"New Role"}),a.jsx("div",{className:"fw-medium text-primary",children:r})]})]})]}),a.jsxs(Re,{variant:"warning",className:"mb-0",children:[a.jsx("div",{className:"fw-semibold mb-2",children:" EID Change Details:"}),a.jsxs("ul",{className:"mb-0 small",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Current EID:"})," ",t.eid," (Prefix: ",l,")"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"New EID:"})," ",c,"XXXXXX (Prefix: ",c,")"]}),a.jsx("li",{children:"The EID will be automatically updated to reflect the new role"}),a.jsx("li",{children:"This change cannot be undone easily"})]})]})]}),a.jsxs(ue.Footer,{className:"border-0 bg-light",children:[a.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:i,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:"warning",onClick:()=>{s()},disabled:i,className:"d-flex align-items-center",children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Updating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(lt,{className:"me-2",size:16}),"Confirm Role Change"]})})]})]})},bU=({show:e,user:t,mode:r,onSave:s,onClose:n})=>{const[i,o]=b.useState({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",roleId:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),[l,c]=b.useState({}),[d,u]=b.useState(!1),[m,f]=b.useState([]),[h,p]=b.useState(!1),[x,g]=b.useState([]),[v,w]=b.useState(!1),[y,S]=b.useState([]),E=async()=>{p(!0);try{const _=await Ft.getDepartments(),W=(_.departments||_.data||[]).map(K=>K.name);f(W)}catch(_){console.error("Error fetching departments:",_),ce.error("Failed to load departments"),f([])}finally{p(!1)}},N=async()=>{w(!0);try{const _=await ys.getRoles(),W=(_.roles||_.data||[]).map(K=>K.name);g(W)}catch(_){console.error("Error fetching roles:",_),ce.error("Failed to load roles"),g([])}finally{w(!1)}},j=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Egypt","Estonia","Finland","France","Georgia","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Jordan","Kazakhstan","Kuwait","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Uzbekistan","Vietnam","Yemen"],T=async()=>{try{const D=(await Ft.getDepartments({includeDeleted:!0}))?.departments?.filter(W=>W.headUser)||[];S(D)}catch(_){console.error("Error fetching departments with heads:",_),S([])}};b.useEffect(()=>{e&&(E(),N(),T())},[e]),b.useEffect(()=>{t&&r!=="add"?o({firstName:t.firstName||"",middleName:t.middleName||"",lastName:t.lastName||"",address:t.address||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:t.role||"",roleId:t.roleId||"",certificationNumber:t.certificationNumber||"",specialization:t.specialization||"",yearsOfExperience:t.yearsOfExperience||"",dateOfBirth:t.dateOfBirth||"",trainingBatch:t.trainingBatch||"",passportNo:t.passportNo||"",nation:t.nation||"",department:t.department||""}):r==="add"&&o({firstName:"",middleName:"",lastName:"",address:"",email:"",phoneNumber:"",role:"",certificationNumber:"",specialization:"",yearsOfExperience:"",dateOfBirth:"",trainingBatch:"",passportNo:"",nation:"",department:""}),c({})},[t,r,e]);const C=()=>{const _={};if(i.firstName.trim()?/^[a-zA-Z\s]+$/.test(i.firstName.trim())||(_.firstName="First name can only contain letters and spaces"):_.firstName="First name is required",i.lastName.trim()?/^[a-zA-Z\s]+$/.test(i.lastName.trim())||(_.lastName="Last name can only contain letters and spaces"):_.lastName="Last name is required",i.middleName.trim()&&!/^[a-zA-Z\s]+$/.test(i.middleName.trim())&&(_.middleName="Middle name can only contain letters and spaces"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(_.email="Email is invalid"):_.email="Email is required",!i.phoneNumber.trim())_.phoneNumber="Phone number is required";else if(!/^[+]?[0-9\s\-()]+$/.test(i.phoneNumber))_.phoneNumber="Phone number cannot contain letters";else{const D=i.phoneNumber.replace(/[^\d+]/g,"");(D.length<7||D.length>16)&&(_.phoneNumber="Phone number must be 7-16 digits")}if(i.role||(_.role="Role is required"),i.role==="DEPARTMENT_HEAD"&&i.department&&i.department.trim()){const D=y.find(W=>{const K=W.name,J=i.department,F=W.headUser?.id,le=K&&J&&K.toLowerCase()===J.toLowerCase(),Ae=r!=="edit"||F!==t?.id;return le&&Ae});if(D){const W=`${D.headUser?.firstName||""} ${D.headUser?.lastName||""}`.trim();_.department=`Department "${i.department}" already has a head: ${W}`}}return i.role==="TRAINER"&&(i.specialization.trim()||(_.specialization="Specialization is required for trainers"),i.certificationNumber.trim()||(_.certificationNumber="Certification number is required for trainers"),i.department&&i.department.trim()!==""&&(_.department="Department is not allowed for Trainer role")),i.role==="TRAINEE"&&(i.trainingBatch.trim()||(_.trainingBatch="Training batch is required for trainees"),i.passportNo.trim()?/^\d{1,20}$/.test(i.passportNo.trim())||(_.passportNo="Passport number must be 1-20 digits only"):_.passportNo="Passport number is required for trainees",i.dateOfBirth.trim()?i.dateOfBirth.length!==10||!/^\d{4}-\d{2}-\d{2}$/.test(i.dateOfBirth)?_.dateOfBirth="Please enter date in YYYY-MM-DD format":new Date(i.dateOfBirth)>=new Date&&(_.dateOfBirth="Date of birth must be in the past"):_.dateOfBirth="Date of birth is required for trainees"),c(_),Object.keys(_).length===0},L=async _=>{if(_.preventDefault(),!!C()&&!d){u(!0);try{await s(i)}catch(D){console.error("Error in handleSubmit:",D)}finally{u(!1)}}},A=(_,D)=>{o(W=>({...W,[_]:D})),c(W=>{const K={...W};if(K[_]&&delete K[_],_==="role"&&(delete K.specialization,delete K.certificationNumber,delete K.trainingBatch,delete K.passportNo,delete K.dateOfBirth,delete K.department),_==="department"){if(delete K.department,i.role==="TRAINER")D&&D.trim()!==""&&(K.department="Department is not allowed for Trainer role");else if(i.role==="DEPARTMENT_HEAD"&&D&&D.trim()){const J=y.find(F=>{const le=F.name,Ae=D,O=F.headUser?.id;return le&&Ae&&le.toLowerCase()===Ae.toLowerCase()&&(r!=="edit"||O!==t?.id)});if(J){const F=`${J.headUser?.firstName||""} ${J.headUser?.lastName||""}`.trim();K.department=`Department "${D}" already has a head: ${F}`}}}return _==="role"&&D==="TRAINER"&&o(J=>({...J,department:""})),K})},P=()=>{switch(r){case"add":return"Add New User";case"edit":return"Edit User";case"view":return"User Details";default:return"User"}},I=r==="view";return a.jsxs(ue,{show:e,onHide:n,size:"lg",centered:!0,children:[a.jsx(ue.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[r==="view"?a.jsx(Nt,{className:"me-2",size:20}):a.jsx(xa,{className:"me-2",size:20}),P()]})}),a.jsxs(k,{onSubmit:L,children:[a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(l).length>0&&a.jsxs("div",{className:"alert alert-danger mb-3",children:[a.jsx("strong",{children:"Please fix the following errors:"}),a.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([_,D])=>a.jsx("li",{children:D},_))})]}),a.jsxs(oe,{children:[a.jsx(H,{md:4,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"First Name *"}),a.jsx(k.Control,{type:"text",value:i.firstName,onChange:_=>A("firstName",_.target.value),isInvalid:!!l.firstName,readOnly:I,style:{borderColor:l.firstName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.firstName})]})}),a.jsx(H,{md:4,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Middle Name"}),a.jsx(k.Control,{type:"text",value:i.middleName,onChange:_=>A("middleName",_.target.value),isInvalid:!!l.middleName,readOnly:I,style:{borderColor:l.middleName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.middleName})]})}),a.jsx(H,{md:4,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Last Name *"}),a.jsx(k.Control,{type:"text",value:i.lastName,onChange:_=>A("lastName",_.target.value),isInvalid:!!l.lastName,readOnly:I,style:{borderColor:l.lastName?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.lastName})]})})]}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Email *"}),a.jsx(k.Control,{type:"email",value:i.email,onChange:_=>A("email",_.target.value),isInvalid:!!l.email,readOnly:I,style:{borderColor:l.email?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.email})]})})}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Phone Number *"}),a.jsx(k.Control,{type:"tel",value:i.phoneNumber,onChange:_=>A("phoneNumber",_.target.value),isInvalid:!!l.phoneNumber,readOnly:I,placeholder:"Enter phone number",style:{borderColor:l.phoneNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.phoneNumber})]})})}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Address (optional)"}),a.jsx(k.Control,{as:"textarea",rows:3,value:i.address,onChange:_=>A("address",_.target.value),readOnly:I,placeholder:"Enter address (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),a.jsxs(oe,{children:[a.jsx(H,{md:i.role==="DEPT_HEAD"||i.role==="TRAINER"?6:12,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Role *"}),a.jsxs(k.Select,{value:i.role,onChange:_=>A("role",_.target.value),isInvalid:!!l.role,disabled:I||v,style:{borderColor:l.role?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[a.jsx("option",{value:"",children:v?"Loading roles...":"Select a role"}),x.map(_=>a.jsx("option",{value:_,children:_},_))]}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.role})]})}),i.role==="DEPARTMENT_HEAD"&&a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Department"}),a.jsxs(k.Select,{value:i.department,onChange:_=>A("department",_.target.value),isInvalid:!!l.department,disabled:I||h,style:{borderColor:l.department?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[a.jsx("option",{value:"",children:h?"Loading departments...":"Select a department"}),m.map(_=>a.jsx("option",{value:_,children:_},_))]}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.department})]})})]}),i.role==="TRAINER"&&a.jsxs(a.Fragment,{children:[a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Specialization *"}),a.jsx(k.Control,{type:"text",value:i.specialization,onChange:_=>A("specialization",_.target.value),isInvalid:!!l.specialization,readOnly:I,placeholder:"Enter specialization",style:{borderColor:l.specialization?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.specialization})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Certification Number *"}),a.jsx(k.Control,{type:"text",value:i.certificationNumber,onChange:_=>A("certificationNumber",_.target.value),isInvalid:!!l.certificationNumber,readOnly:I,placeholder:"Enter certification number",style:{borderColor:l.certificationNumber?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.certificationNumber})]})})]}),a.jsx(oe,{children:a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Years of Experience"}),a.jsx(k.Control,{type:"number",value:i.yearsOfExperience,onChange:_=>A("yearsOfExperience",_.target.value),readOnly:I,placeholder:"Enter years of experience",min:"0",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})})]}),i.role==="TRAINEE"&&a.jsxs(a.Fragment,{children:[a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Date of Birth *"}),a.jsx(k.Control,{type:"date",value:i.dateOfBirth,onChange:_=>{const D=_.target.value;(D===""||D.length===10&&/^\d{4}-\d{2}-\d{2}$/.test(D))&&A("dateOfBirth",D)},isInvalid:!!l.dateOfBirth,readOnly:I,max:"2024-12-31",min:"1900-01-01",style:{borderColor:l.dateOfBirth?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.dateOfBirth})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Training Batch *"}),a.jsx(k.Control,{type:"text",value:i.trainingBatch,onChange:_=>A("trainingBatch",_.target.value),isInvalid:!!l.trainingBatch,readOnly:I,placeholder:"Enter training batch",style:{borderColor:l.trainingBatch?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.trainingBatch})]})})]}),a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Passport No *"}),a.jsx(k.Control,{type:"text",value:i.passportNo,onChange:_=>A("passportNo",_.target.value),isInvalid:!!l.passportNo,readOnly:I,placeholder:"Enter passport number",style:{borderColor:l.passportNo?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.passportNo})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Nation"}),a.jsxs(k.Select,{value:i.nation,onChange:_=>A("nation",_.target.value),disabled:I,style:{borderColor:"var(--bs-primary)",borderWidth:"2px"},children:[a.jsx("option",{value:"",children:"Select a nation"}),j.map(_=>a.jsx("option",{value:_,children:_},_))]})]})})]})]}),r==="view"&&t&&a.jsx(oe,{children:a.jsx(H,{children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Employee ID"}),a.jsx(k.Control,{type:"text",value:t.eid,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:d,children:[a.jsx(Ze,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&a.jsx(se,{variant:"primary-custom",type:"submit",disabled:d,children:d?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{className:"me-2",size:16}),r==="add"?"Add User":"Save Changes"]})})]})]})]})},yU=({user:e,index:t,onView:r,onEdit:s,onDisable:n})=>{const i=l=>l==="ACTIVE"?"success":"secondary",o=l=>l==="ACTIVE"?"":"";return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"fw-semibold text-primary-custom",children:e.eid})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("div",{className:"fw-medium text-dark",children:e.fullName})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:e.email})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx(Pe,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.role})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.department})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs(Pe,{bg:i(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:o(e.status)}),e.status]})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.USERS.VIEW_DETAIL,Ne.USERS.UPDATE],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>r(e),permission:Ne.USERS.VIEW_DETAIL},{label:"Edit User",icon:a.jsx(as,{}),onClick:()=>s(e),permission:Ne.USERS.UPDATE},{type:"divider"},{label:e.status==="ACTIVE"?"Disable User":"Enable User",icon:a.jsx(rc,{}),className:"text-danger",onClick:()=>n(e),permission:Ne.USERS.UPDATE}]})})})]})},wU=({users:e,loading:t,onView:r,onEdit:s,onDisable:n})=>{const{sortedData:i,sortConfig:o,handleSort:l}=Zt(e);if(t)return a.jsx(Wt,{rows:5,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No users found"}),a.jsx("p",{children:"Try adjusting your search criteria or add a new user."})]})});const c=({columnKey:d,children:u,className:m=""})=>{const f=o.key===d,h=f?o.direction:null;return a.jsxs("th",{className:`fw-semibold ${m}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>l(d),onMouseEnter:p=>{p.target.style.backgroundColor="#214760",p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:p=>{p.target.style.backgroundColor="var(--bs-primary)",p.target.style.transform="translateY(0)",p.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:f?"600":"500",color:"white"},children:u}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:h,size:14,color:"white"})})]}),f&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(c,{columnKey:"eid",className:"show-mobile",children:"EID"}),a.jsx(c,{columnKey:"fullName",className:"show-mobile",children:"Full Name"}),a.jsx(c,{columnKey:"email",className:"show-mobile",children:"Email"}),a.jsx(c,{columnKey:"role",className:"show-mobile",children:"Role"}),a.jsx(c,{columnKey:"department",className:"hide-mobile",children:"Department"}),a.jsx(c,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:i.map((d,u)=>a.jsx(yU,{user:d,index:u,onView:r,onEdit:s,onDisable:n},d.id))})]})})},jU=()=>{const[e,t]=b.useState([]),[r,s]=b.useState([]),[n,i]=b.useState(""),[o,l]=b.useState([]),[c,d]=b.useState([]),[u,m]=b.useState(!1),[f,h]=b.useState(null),[p,x]=b.useState("view"),[g,v]=b.useState(!1),[w,y]=b.useState(null),[S,E]=b.useState(!1),[N,j]=b.useState(null);b.useEffect(()=>{(async()=>{v(!0);try{const[Y,te]=await Promise.all([bs.getUsers(),Ft.getDepartments({includeDeleted:!0})]);let ae=[];Array.isArray(Y)?ae=Y:Array.isArray(Y?.data)?ae=Y.data:Y?.users&&Array.isArray(Y.users)?ae=Y.users:(console.warn(" Unexpected users response format:",Y),ae=[]);const ne=ae.map(je=>({id:je.id,eid:je.eid,fullName:[je.firstName,je.middleName,je.lastName].filter(Boolean).join(" "),firstName:je.firstName,middleName:je.middleName,lastName:je.lastName,role:je.role?.name||"N/A",roleId:je.role?.id||"",department:je.department?.name||"N/A",status:je.status,email:je.email,phoneNumber:je.phoneNumber||"",address:je.address||"",certificationNumber:je.certificationNumber||"",specialization:je.specialization||"",yearsOfExperience:je.yearsOfExperience||"",dateOfBirth:je.dateOfBirth||"",trainingBatch:je.trainingBatch||"",passportNo:je.passportNo||"",nation:je.nation||"",createdAt:je.createdAt,lastLogin:je.lastLogin||""})),fe=te.departments||te||[];t(ne),s(fe),y(null)}catch(Y){const te=Ea(Y,{});y(te)}finally{v(!1)}})()},[]);const T=[...new Set(e.map(B=>B.role).filter(Boolean))],C=[...new Set(r.map(B=>B.name).filter(Boolean)),...new Set(e.map(B=>B.department).filter(Boolean))].filter((B,Y,te)=>te.indexOf(B)===Y),L=e.filter(B=>{const Y=!n||B.fullName.toLowerCase().includes(n.toLowerCase())||B.eid.toLowerCase().includes(n.toLowerCase())||B.email.toLowerCase().includes(n.toLowerCase()),te=o.length===0||o.includes(B.role),ae=c.length===0||c.includes(B.department);return Y&&te&&ae}),A=B=>i(B),P=B=>{l(Y=>Y.includes(B)?Y.filter(te=>te!==B):[...Y,B])},I=B=>{d(Y=>Y.includes(B)?Y.filter(te=>te!==B):[...Y,B])},_=()=>{l([]),d([]),i("")},D=async B=>{try{v(!0);const Y=await bs.getUserById(B.id),te={id:Y.id,eid:Y.eid,fullName:[Y.firstName,Y.middleName,Y.lastName].filter(Boolean).join(" "),firstName:Y.firstName,middleName:Y.middleName,lastName:Y.lastName,role:Y.role?.name||"N/A",roleId:Y.role?.id||"",department:Y.department?.name||"N/A",status:Y.status,email:Y.email,phoneNumber:Y.phoneNumber||"",address:Y.address||"",certificationNumber:Y.trainerProfile?.certificationNumber||"",specialization:Y.trainerProfile?.specialization||"",yearsOfExperience:Y.trainerProfile?.yearsOfExp||"",dateOfBirth:Y.traineeProfile?.dob?Y.traineeProfile.dob.split("T")[0]:"",trainingBatch:Y.traineeProfile?.trainingBatch||"",passportNo:Y.traineeProfile?.passportNo||"",nation:Y.traineeProfile?.nation||"",createdAt:Y.createdAt,lastLogin:Y.lastLogin||""};h(te),x("view"),m(!0)}catch{y("Unable to load user details")}finally{v(!1)}},W=async B=>{try{v(!0);const Y=await bs.getUserById(B.id),te={id:Y.id,eid:Y.eid,fullName:[Y.firstName,Y.middleName,Y.lastName].filter(Boolean).join(" "),firstName:Y.firstName,middleName:Y.middleName,lastName:Y.lastName,role:Y.role?.name||"N/A",roleId:Y.role?.id||"",department:Y.department?.name||"N/A",status:Y.status,email:Y.email,phoneNumber:Y.phoneNumber||"",address:Y.address||"",certificationNumber:Y.trainerProfile?.certificationNumber||"",specialization:Y.trainerProfile?.specialization||"",yearsOfExperience:Y.trainerProfile?.yearsOfExp||"",dateOfBirth:Y.traineeProfile?.dob?Y.traineeProfile.dob.split("T")[0]:"",trainingBatch:Y.traineeProfile?.trainingBatch||"",passportNo:Y.traineeProfile?.passportNo||"",nation:Y.traineeProfile?.nation||"",createdAt:Y.createdAt,lastLogin:Y.lastLogin||""};h(te),x("edit"),m(!0)}catch{y("Unable to load user details")}finally{v(!1)}},K=()=>{h(null),x("add"),m(!0)},J=async B=>{try{v(!0);let Y,te;B.status==="ACTIVE"?(Y=await bs.disableUser(B.id),te="disabled"):(Y=await bs.enableUser(B.id),te="enabled");const[ae,ne]=await Promise.all([bs.getUsers(),Ft.getDepartments({includeDeleted:!0})]);let fe=[];Array.isArray(ae)?fe=ae:Array.isArray(ae?.data)?fe=ae.data:ae?.users&&Array.isArray(ae.users)?fe=ae.users:(console.warn(" Unexpected users response format:",ae),fe=[]);const je=fe.map(ie=>({id:ie.id,eid:ie.eid,fullName:[ie.firstName,ie.middleName,ie.lastName].filter(Boolean).join(" "),firstName:ie.firstName,middleName:ie.middleName,lastName:ie.lastName,role:ie.role?.name||"N/A",roleId:ie.role?.id||"",department:ie.department?.name||"N/A",status:ie.status,email:ie.email,phoneNumber:ie.phoneNumber||"",address:ie.address||"",certificationNumber:ie.trainerProfile?.certificationNumber||"",specialization:ie.trainerProfile?.specialization||"",yearsOfExperience:ie.trainerProfile?.yearsOfExp||"",dateOfBirth:ie.traineeProfile?.dob?ie.traineeProfile.dob.split("T")[0]:"",trainingBatch:ie.traineeProfile?.trainingBatch||"",passportNo:ie.traineeProfile?.passportNo||"",nation:ie.traineeProfile?.nation||"",createdAt:ie.createdAt,lastLogin:ie.lastLogin||""})),z=ne.departments||ne||[];t(je),s(z);const me=Y?.message||`User has been ${te} successfully!`;ce.success(me)}catch(Y){const te=Ea(Y,{});y(te),ce.error(te)}finally{v(!1)}},F=async B=>{try{if(v(!0),p==="edit"&&f&&f.role!==B.role){j(B),E(!0),v(!1);return}await le(B)}catch{v(!1)}},le=async B=>{try{v(!0);let Y=null;try{const ie=(await bs.getRoles()).roles?.find(ke=>ke.name===B.role);if(ie)Y=ie.id;else throw new Error(`Role '${B.role}' not found in backend`)}catch(me){throw new Error(`Failed to get role ID for '${B.role}': ${me.message}`)}const te={firstName:B.firstName,middleName:B.middleName||"",lastName:B.lastName,address:B.address||"",email:B.email,gender:"MALE",avatarUrl:"",phoneNumber:B.phoneNumber||"",role:{id:Y,name:B.role}};if(B.role==="TRAINER")te.trainerProfile={specialization:B.specialization||"",certificationNumber:B.certificationNumber||"",yearsOfExp:B.yearsOfExperience?parseInt(B.yearsOfExperience):0,bio:""};else if(B.role==="DEPARTMENT_HEAD")if(B.department&&B.department.trim()){const me=r.find(ie=>ie.name===B.department);if(me)te.departmentId=me.id;else throw new Error(`Department '${B.department}' not found`)}else te.departmentId=null;else B.role==="TRAINEE"&&(B.dateOfBirth||B.trainingBatch||B.passportNo||B.nation)&&(te.traineeProfile={dob:B.dateOfBirth?new Date(B.dateOfBirth).toISOString():null,enrollmentDate:new Date().toISOString(),trainingBatch:B.trainingBatch||"",passportNo:B.passportNo||"",nation:B.nation||""});p==="add"?(await bs.createUser(te),ce.success("User created successfully!")):p==="edit"&&(await bs.updateUser(f.id,te),ce.success("User updated successfully!")),m(!1);const[ae,ne]=await Promise.all([bs.getUsers(),Ft.getDepartments({includeDeleted:!0})]);let fe=[];if(Array.isArray(ae)?fe=ae:Array.isArray(ae?.data)?fe=ae.data:ae?.users&&Array.isArray(ae.users)?fe=ae.users:(console.warn(" Unexpected users response format:",ae),fe=[]),p==="edit"&&f?.id){const me=fe.find(ie=>ie.id===f.id)}const je=fe.map(me=>({id:me.id,eid:me.eid,fullName:[me.firstName,me.middleName,me.lastName].filter(Boolean).join(" "),firstName:me.firstName,middleName:me.middleName,lastName:me.lastName,role:me.role?.name||"N/A",roleId:me.role?.id||"",department:me.department?.name||"N/A",status:me.status,email:me.email,phoneNumber:me.phoneNumber||"",address:me.address||"",certificationNumber:me.trainerProfile?.certificationNumber||"",specialization:me.trainerProfile?.specialization||"",yearsOfExperience:me.trainerProfile?.yearsOfExp||"",dateOfBirth:me.traineeProfile?.dob?me.traineeProfile.dob.split("T")[0]:"",trainingBatch:me.traineeProfile?.trainingBatch||"",passportNo:me.traineeProfile?.passportNo||"",nation:me.traineeProfile?.nation||"",createdAt:me.createdAt,lastLogin:me.lastLogin||""})),z=ne.departments||ne||[];t(je),s(z)}catch(Y){const te=Ea(Y,{});throw y(te),new Error(te)}finally{v(!1)}};return{users:L,searchTerm:n,selectedRoles:o,selectedDepartments:c,uniqueRoles:T,uniqueDepartments:C,modalShow:u,selectedUser:f,modalMode:p,loading:g,error:w,confirmRoleChange:S,pendingUserData:N,handleSearch:A,handleRoleToggle:P,handleDepartmentToggle:I,handleClearFilters:_,handleView:D,handleEdit:W,handleAdd:K,handleDisable:J,handleSave:F,handleBulkImport:async B=>{try{v(!0);const Y=await bs.bulkImportUsers(B);if(Y.success&&Y.success.length>0&&ce.success(`Successfully imported ${Y.success.length} users!`),Y.failed&&Y.failed.length>0){const z=Y.failed.map(me=>`User ${me.index+1}: ${me.error}`);ce.error(`Failed to import ${Y.failed.length} users: ${z.join(", ")}`)}const[te,ae]=await Promise.all([bs.getUsers(),Ft.getDepartments({includeDeleted:!0})]);let ne=[];Array.isArray(te)?ne=te:Array.isArray(te?.data)?ne=te.data:te?.users&&Array.isArray(te.users)?ne=te.users:(console.warn(" Unexpected users response format:",te),ne=[]);const fe=ne.map(z=>({id:z.id,eid:z.eid,fullName:[z.firstName,z.middleName,z.lastName].filter(Boolean).join(" "),firstName:z.firstName,middleName:z.middleName,lastName:z.lastName,role:z.role?.name||"N/A",roleId:z.role?.id||"",department:z.department?.name||"N/A",status:z.status,email:z.email,phoneNumber:z.phoneNumber||"",address:z.address||"",certificationNumber:z.trainerProfile?.certificationNumber||"",specialization:z.trainerProfile?.specialization||"",yearsOfExperience:z.trainerProfile?.yearsOfExp||"",dateOfBirth:z.traineeProfile?.dob?z.traineeProfile.dob.split("T")[0]:"",trainingBatch:z.traineeProfile?.trainingBatch||"",passportNo:z.traineeProfile?.passportNo||"",nation:z.traineeProfile?.nation||"",createdAt:z.createdAt,lastLogin:z.lastLogin||""})),je=ae.departments||ae||[];t(fe),s(je)}catch(Y){const te=Ea(Y,{});y(te),ce.error(te)}finally{v(!1)}},handleModalClose:()=>{m(!1),h(null)},handleConfirmRoleChange:async()=>{E(!1),N&&(await le(N),j(null))},handleCancelRoleChange:()=>{E(!1),j(null)},setError:y}},NU=()=>{const[e,t]=sx();Qe();const[r,s]=b.useState(!1),[n,i]=b.useState(null),[o,l]=b.useState(!1),[c,d]=b.useState(!1);b.useEffect(()=>{if(e.get("action")==="bulk-import"){d(!0);const U=new URLSearchParams(e);U.delete("action"),t(U,{replace:!0})}},[e,t]);const{users:u,loading:m,error:f,searchTerm:h,selectedRoles:p,selectedDepartments:x,uniqueRoles:g,uniqueDepartments:v,modalShow:w,selectedUser:y,modalMode:S,confirmRoleChange:E,pendingUserData:N,handleSearch:j,handleRoleToggle:T,handleDepartmentToggle:C,handleClearFilters:L,handleView:A,handleEdit:P,handleAdd:I,handleDisable:_,handleSave:D,handleBulkImport:W,handleModalClose:K,handleConfirmRoleChange:J,handleCancelRoleChange:F}=jU(),le=G=>{i(G),s(!0)},Ae=async()=>{if(n){l(!0);try{await _(n),s(!1),i(null)}catch(G){console.error("Error disabling user:",G)}finally{l(!1)}}},O=()=>{s(!1),i(null)};return Z.useEffect(()=>{f&&ce.error(f)},[f]),a.jsx(_e,{fluid:!0,className:"py-4 user-management-page",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(oe,{className:"align-items-center",children:a.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx(wr,{permission:Ne.USERS.BULK_CREATE,fallback:null,children:a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>d(!0),className:"d-flex align-items-center",children:[a.jsx(Ts,{className:"me-1",size:16}),a.jsx("span",{className:"d-none d-sm-inline",children:"Bulk Import"}),a.jsx("span",{className:"d-sm-none",children:"Import"})]})}),a.jsx(wr,{permission:Ne.USERS.CREATE,fallback:null,children:a.jsxs(se,{variant:"primary-custom",size:"sm",onClick:I,className:"d-flex align-items-center",children:[a.jsx(Cs,{className:"me-1",size:16}),"Add User"]})})]})})})}),a.jsxs(M.Body,{children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search users by name, EID, or email...",value:h,onChange:j,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(gU,{uniqueRoles:g,uniqueDepartments:v,selectedRoles:p,selectedDepartments:x,onRoleToggle:T,onDepartmentToggle:C,onClearFilters:L,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[u.length," user",u.length!==1?"s":""]})})})]}),a.jsxs("div",{className:"position-relative",children:[a.jsx(wU,{users:u,loading:m,onView:A,onEdit:P,onDisable:le}),u.length>8&&a.jsxs("div",{className:"scroll-indicator",children:[a.jsx(Ha,{size:12,className:"me-1"}),"Scroll to see more users"]})]}),a.jsx(bU,{show:w,user:y,mode:S,onSave:D,onClose:K}),a.jsx(pU,{show:c,onClose:()=>{if(d(!1),e.get("action")==="bulk-import"){const G=new URLSearchParams(e);G.delete("action"),t(G,{replace:!0})}},onImport:W,loading:m}),a.jsx(xU,{show:r,user:n,onConfirm:Ae,onCancel:O,loading:o}),a.jsx(vU,{show:E,user:y,newRole:N?.role,onConfirm:J,onCancel:F,loading:m})]})]})})},SU=({show:e,role:t,onConfirm:r,onCancel:s,loading:n})=>{if(!t)return null;const i=t.status==="Active",o=i?"Disable":"Enable",c=i?iN:lt;return a.jsxs(ue,{show:e,onHide:s,centered:!0,backdrop:"static",keyboard:!1,children:[a.jsx(ue.Header,{closeButton:!0,className:"text-white border-0",style:{backgroundColor:i?"var(--bs-secondary)":"#28a745",borderBottom:"none"},children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(c,{size:24,className:"me-2"}),o," Role: ",t.name]})}),a.jsxs(ue.Body,{className:"py-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 text-white",style:{width:"50px",height:"50px",backgroundColor:i?"var(--bs-secondary)":"#28a745",fontSize:"1.5rem",fontWeight:"bold"},children:t.name.charAt(0).toUpperCase()}),a.jsx("div",{children:a.jsx("h6",{className:"mb-0",children:t.name})})]}),i?a.jsxs(Re,{variant:"warning",className:"mb-3",style:{backgroundColor:"#f0e8e0",borderColor:"var(--bs-secondary)",color:"var(--bs-dark)"},children:[a.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[a.jsx(yr,{className:"me-2",style:{color:"var(--bs-secondary)"}})," Warning: Disabling Role"]}),a.jsxs("p",{className:"mb-1",children:["This action will disable the ",a.jsx("span",{className:"fw-bold",children:t.name})," role."]}),a.jsxs("ul",{className:"mb-0 ps-3",children:[a.jsx("li",{children:"Users with this role will lose access to associated permissions."}),a.jsx("li",{children:"Role data will be preserved but access will be restricted."}),a.jsx("li",{children:"Role can be re-enabled later by an administrator."}),a.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}):a.jsxs(Re,{variant:"success",className:"mb-3",children:[a.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[a.jsx(lt,{className:"me-2"})," Confirm: Enabling Role"]}),a.jsxs("p",{className:"mb-1",children:["This action will restore the ",a.jsx("span",{className:"fw-bold",children:t.name})," role."]}),a.jsxs("ul",{className:"mb-0 ps-3",children:[a.jsx("li",{children:"Users with this role will regain access to associated permissions."}),a.jsx("li",{children:"All role permissions and access will be restored."}),a.jsx("li",{children:"Role will be available for assignment to new users."}),a.jsxs("li",{children:["Currently assigned to ",t.assignedUsers," user",t.assignedUsers!==1?"s":"","."]})]})]}),a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx(se,{variant:"outline-secondary",onClick:s,disabled:n,children:"Cancel"}),a.jsx(se,{variant:i?"secondary":"success",onClick:r,disabled:n,className:"d-flex align-items-center",style:i?{backgroundColor:"var(--bs-secondary)",borderColor:"var(--bs-secondary)",color:"#fff"}:{},children:n?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",style:{width:"0.8rem",height:"0.8rem",borderWidth:"0.15em"},children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),i?"Disabling...":"Enabling..."]}):a.jsxs(a.Fragment,{children:[a.jsx(c,{size:16,className:"me-2"}),o," Role"]})})]})]})]})},EU=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:s,className:n=""})=>{const i=t.length>0;return a.jsxs($t,{className:`filter-panel-dropdown ${n}`,children:[a.jsx($t.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Li,{size:14,className:"me-2"}),"Filters",i&&a.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),a.jsxs($t.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"280px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(o=>a.jsx(k.Check,{type:"checkbox",id:`status-${o}`,label:o,checked:t.includes(o),onChange:()=>r(o),className:"mb-1"},o))})]}),i&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:s,children:[a.jsx(Ze,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},TU=["ADMINISTRATOR"],Fb=e=>TU.includes(e?.toUpperCase()),AU=({show:e,role:t,mode:r,onSave:s,onClose:n})=>{const[i,o]=b.useState({name:"",description:"",permissionIds:[]}),[l,c]=b.useState({}),[d,u]=b.useState(!1),[m,f]=b.useState({}),{allPermissions:h,loading:p,error:x,fetchAllPermissions:g}=TD(),v=b.useMemo(()=>{if(!h||h.length===0)return[];const L={};return h.forEach(A=>{const P=A.module,I=A.viewModule||`${A.module} Management`;L[P]||(L[P]={id:P,name:I,description:`Manage ${I.toLowerCase()} related permissions`,permissions:[]});const _=A.id||A.permissionId;_&&L[P].permissions.push({id:_,title:A.viewName||A.name,description:A.description||"",isActive:A.isActive,method:A.method,path:A.path})}),Object.values(L).sort((A,P)=>A.name.localeCompare(P.name))},[h]),w=b.useMemo(()=>{const L=v;if(r==="view"&&t?.permissions){const A=t.permissions.map(P=>P.id||P);return L.map(P=>({...P,permissions:P.permissions.filter(I=>A.includes(I.id))})).filter(P=>P.permissions.length>0)}return L},[v,r,t?.permissions]);b.useEffect(()=>{if(t&&r!=="add"){const L=t.permissions?t.permissions.map(A=>A.id||A):[];o({name:t.name||"",description:t.description||"",permissionIds:L})}else r==="add"&&o({name:"",description:"",permissionIds:[]});c({})},[t,r,e]),b.useEffect(()=>{e&&g()},[e,g]),b.useEffect(()=>{if(r==="view"){const L={};w.map(P=>P.id).forEach(P=>{L[P]=!0}),f(L)}else if(r==="edit"){const L={};w.map(P=>P.id).forEach(P=>{L[P]=!0}),f(L)}else f({})},[r,w]);const y=()=>{const L={};return i.name.trim()?/^[a-zA-Z0-9\s_]+$/.test(i.name.trim())||(L.name="Role name cannot contain special characters"):L.name="Role name is required",i.permissionIds.length===0&&(L.permissionIds="At least one permission is required"),c(L),Object.keys(L).length===0},S=async L=>{if(L.preventDefault(),!!y()){u(!0);try{await s(i)}catch(A){console.error("Error saving role:",A)}finally{u(!1)}}},E=(L,A)=>{o(P=>({...P,[L]:A})),l[L]&&c(P=>({...P,[L]:""}))},N=L=>{!L||L===null||L===void 0||(o(A=>{const P=A.permissionIds||[],I=P.some(_=>String(_)===String(L));return{...A,permissionIds:I?P.filter(_=>String(_)!==String(L)):[...P,L]}}),l.permissionIds&&c(A=>({...A,permissionIds:""})))},j=L=>{f(A=>({...A,[L]:!A[L]}))},T=()=>{switch(r){case"add":return"Add New Role";case"edit":return"Edit Role";case"view":return"Role Details";default:return"Role"}},C=r==="view";return a.jsxs(ue,{show:e,onHide:n,size:"lg",centered:!0,children:[a.jsx(ue.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[r==="view"?a.jsx(Nt,{className:"me-2",size:20}):a.jsx(dx,{className:"me-2",size:20}),T()]})}),a.jsxs(k,{onSubmit:S,children:[a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[t&&Fb(t.name)&&r==="edit"&&a.jsxs(Re,{variant:"warning",className:"mb-3",children:[a.jsx(yr,{className:"me-2"}),a.jsx("strong",{children:"Base Role Warning:"})," This role cannot be modified."]}),Object.keys(l).length>0&&a.jsxs("div",{className:"alert alert-danger mb-3",children:[a.jsx("strong",{children:"Please fix the following errors:"}),a.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(l).map(([L,A])=>a.jsx("li",{children:A},L))})]}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsx(k.Group,{className:"mb-3",children:a.jsxs(oe,{className:"align-items-center",children:[a.jsx(H,{md:2,children:a.jsx(k.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Role Name *"})}),a.jsxs(H,{md:4,children:[a.jsx(k.Control,{type:"text",size:"sm",value:i.name,onChange:L=>{const A=L.target.value;/^[a-zA-Z0-9\s_]*$/.test(A)&&E("name",A)},isInvalid:!!l.name,readOnly:C,style:{borderColor:l.name?"#dc3545":"var(--bs-primary)",borderWidth:"1px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.name})]})]})})})}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsx(k.Group,{className:"mb-3",children:a.jsxs(oe,{className:"align-items-start",children:[a.jsx(H,{md:2,children:a.jsx(k.Label,{className:"text-primary-custom fw-semibold fs-6 mb-0",children:"Description"})}),a.jsx(H,{md:4,children:a.jsx(k.Control,{as:"textarea",rows:2,size:"sm",value:i.description,onChange:L=>E("description",L.target.value),readOnly:C,placeholder:"Enter role description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"1px",resize:"none"}})})]})})})}),a.jsx(oe,{children:a.jsx(H,{children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold fs-5 mb-3",children:"Permissions *"}),l.permissionIds&&a.jsx("div",{className:"text-danger small mb-2",children:l.permissionIds}),x&&a.jsxs("div",{className:"text-danger small mb-2",children:["Error loading permissions: ",x.message||"Unknown error"]}),a.jsx("div",{className:"border rounded p-4 bg-light",style:{maxHeight:"300px",overflowY:"auto",borderColor:"var(--bs-primary)",borderWidth:"2px"},children:p?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Pt,{animation:"border",size:"sm",className:"me-2"}),"Loading permissions..."]}):w.length>0?a.jsx(a.Fragment,{children:w.map(L=>{const A=m[L.id];return a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:`d-flex align-items-center p-2 bg-light rounded permission-group-header ${C?"":"cursor-pointer"}`,onClick:()=>!C&&j(L.id),role:C?void 0:"button",tabIndex:C?void 0:0,onKeyDown:C?void 0:P=>{(P.key==="Enter"||P.key===" ")&&(P.preventDefault(),j(L.id))},"aria-expanded":C?void 0:A,children:a.jsxs("div",{className:"d-flex align-items-center",children:[!C&&(A?a.jsx(Ha,{className:"me-2",size:16}):a.jsx(ec,{className:"me-2",size:16})),a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold text-primary-custom",children:L.name}),a.jsx("small",{className:"text-muted",children:L.description})]})]})}),A&&L.permissions.length>0&&a.jsx("div",{className:"ms-3 mt-2",children:a.jsx(a1,{variant:"flush",children:L.permissions.map(P=>{const I=P.id;return I?a.jsx(a1.Item,{className:"border-0 px-0 py-2 permission-item",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"form-check me-3",children:a.jsx("input",{type:"checkbox",className:"form-check-input",id:`permission-${I}`,checked:i.permissionIds.some(_=>String(_)===String(I)),onChange:_=>{_.stopPropagation(),!C&&I&&N(I)},onClick:_=>{_.stopPropagation()},disabled:C,style:{cursor:C?"not-allowed":"pointer",width:"1.25rem",height:"1.25rem"}})}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("div",{className:"fw-medium text-dark",children:P.title}),a.jsx("small",{className:"text-muted",children:P.description})]}),!C&&i.permissionIds.some(_=>String(_)===String(I))&&a.jsx(Pe,{bg:"primary",className:"ms-2",children:"Selected"})]})},`${L.id}-${I}`):null})})})]},L.id)})}):a.jsx("div",{className:"text-center py-4 text-muted",children:"No permissions available"})}),a.jsx("div",{className:"mt-2",children:a.jsxs("small",{className:"text-muted",children:[i.permissionIds.length," of ",w.reduce((L,A)=>L+A.permissions.length,0)," permissions assigned"]})})]})})}),r==="view"&&t&&a.jsx(oe,{children:a.jsx(H,{children:a.jsxs("div",{className:"bg-light-custom p-3 rounded",children:[a.jsx("h6",{className:"text-primary-custom mb-2",children:"Role Information"}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-md-6",children:[a.jsx("small",{className:"text-muted",children:"Assigned Users:"}),a.jsx("div",{className:"fw-medium",children:t.assignedUsers||0})]}),a.jsxs("div",{className:"col-md-6",children:[a.jsx("small",{className:"text-muted",children:"Total Permissions:"}),a.jsx("div",{className:"fw-medium",children:i.permissionIds.length})]})]})]})})})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:d,children:[a.jsx(Ze,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&a.jsx(se,{variant:"primary-custom",type:"submit",disabled:d||t&&Fb(t.name),children:d?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{className:"me-2",size:16}),r==="add"?"Add Role":"Save Changes"]})})]})]})]})},CU=({roles:e,loading:t,actionsComponent:r,onView:s,onEdit:n,onDisable:i})=>{const{sortedData:o,sortConfig:l,handleSort:c}=Zt(e);if(t)return a.jsx(Wt,{rows:4,columns:4});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No roles found"}),a.jsx("p",{children:"Try adjusting your search criteria or add a new role."})]})});const d=({columnKey:u,children:m,className:f=""})=>{const h=l.key===u,p=h?l.direction:null;return a.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:h?"700":"600",color:"white"},children:m}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:p,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",children:[a.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:a.jsxs("tr",{children:[a.jsx(d,{columnKey:"name",className:"show-mobile",children:"Role Name"}),a.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(d,{columnKey:"assignedUsers",className:"show-mobile",children:"Assigned Users"}),a.jsx(d,{columnKey:"lastModified",className:"show-mobile",children:"Last Modified"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:o.map((u,m)=>a.jsxs("tr",{children:[a.jsx("td",{className:"show-mobile",children:u.name}),a.jsx("td",{className:"show-mobile",children:a.jsxs(Pe,{bg:u.status==="Active"?"success":"secondary",className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:u.status==="Active"?"":""}),u.status]})}),a.jsx("td",{className:"show-mobile",children:u.assignedUsers}),a.jsx("td",{className:"show-mobile",children:u.lastModified}),a.jsx("td",{className:"text-center show-mobile",children:a.jsx(r,{role:u})})]},u.id))})]})})},Qo=e=>e===!0||e==="ACTIVE",_U=()=>{const[e,t]=b.useState([]),[r,s]=b.useState(""),[n,i]=b.useState([]),[o,l]=b.useState(!1),[c,d]=b.useState(null),[u,m]=b.useState("view"),[f,h]=b.useState(!1),[p,x]=b.useState(null);b.useEffect(()=>{(async()=>{h(!0);try{const P=await ys.getRoles({includeDeleted:!0}),_=(Array.isArray(P)?P:P?.roles||[]).map(D=>({id:D.id,name:D.name,description:D.description||"",assignedUsers:D.userCount||0,status:Qo(D.isActive)?"Active":"Inactive",createdAt:D.createdAt?D.createdAt.split("T")[0]:"",lastModified:D.updatedAt?D.updatedAt.split("T")[0]:"",isActive:D.isActive,permissions:D.permissions||[],originalData:D}));t(_),x(null)}catch(P){const I=Ea(P,{});x(I),console.error("Error fetching roles:",P)}finally{h(!1)}})()},[]);const g=A=>s(A),v=A=>{i(A==="clear"?[]:P=>P.includes(A)?P.filter(I=>I!==A):[...P,A])},w=()=>{i([])},y=async A=>{try{h(!0);const P=await ys.getRoleById(A.id);d(P),m("view"),l(!0)}catch(P){const I=Ea(P,{});x(I),console.error("Error fetching role details:",P)}finally{h(!1)}},S=async A=>{try{h(!0);const P=await ys.getRoleById(A.id),I={id:P.id,name:P.name,description:P.description||"",assignedUsers:P.userCount||0,status:Qo(P.isActive)?"Active":"Inactive",createdAt:P.createdAt?P.createdAt.split("T")[0]:"",lastModified:P.updatedAt?P.updatedAt.split("T")[0]:"",isActive:P.isActive,permissions:P.permissions||[],originalData:P};d(I),m("edit"),l(!0),x(null)}catch(P){const I=Ea(P,{});x(I)}finally{h(!1)}},E=()=>{d(null),m("add"),l(!0)},N=async A=>{if(window.confirm("Are you sure you want to delete this role?")){h(!0);try{await new Promise(P=>setTimeout(P,1e3)),t(P=>P.filter(I=>I.id!==A)),x(null)}catch{x("Failed to delete role")}finally{h(!1)}}},j=async A=>{h(!0);try{u==="add"?(await ys.createRole(A),ce.success("Role created successfully!")):(await ys.updateRole(c.id,A),ce.success("Role updated successfully!"));const P=await ys.getRoles({includeDeleted:!0}),_=(Array.isArray(P)?P:P?.roles||[]).map(D=>({id:D.id,name:D.name,description:D.description||"",assignedUsers:D.userCount||0,status:Qo(D.isActive)?"Active":"Inactive",createdAt:D.createdAt?D.createdAt.split("T")[0]:"",lastModified:D.updatedAt?D.updatedAt.split("T")[0]:"",isActive:D.isActive,originalData:D}));t(_),l(!1),d(null),x(null)}catch(P){const I=Ea(P,{});x(I),ce.error(I)}finally{h(!1)}},T=async A=>{h(!0);try{const P=e.find(le=>le.id===A);if(!P)throw new Error("Role not found");let I,_;Qo(P.isActive)?(I=await ys.disableRole(A),_="disabled"):(I=await ys.enableRole(A),_="enabled");const W=await ys.getRoles({includeDeleted:!0}),J=(Array.isArray(W)?W:W?.roles||[]).map(le=>({id:le.id,name:le.name,description:le.description||"",assignedUsers:le.userCount||0,status:Qo(le.isActive)?"Active":"Inactive",createdAt:le.createdAt?le.createdAt.split("T")[0]:"",lastModified:le.updatedAt?le.updatedAt.split("T")[0]:"",isActive:le.isActive,originalData:le}));t(J);const F=I?.message||`Role has been ${_} successfully!`;ce.success(F),x(null)}catch(P){const I=Ea(P,{});x(I)}finally{h(!1)}},C=[...new Set(e.map(A=>A.status))];return{roles:e.filter(A=>{const P=A.name.toLowerCase().includes(r.toLowerCase()),I=n.length===0||n.includes(A.status);return P&&I}),loading:f,error:p,searchTerm:r,selectedStatuses:n,uniqueStatuses:C,modalShow:o,selectedRole:c,modalMode:u,handleSearch:g,handleStatusToggle:v,handleClearFilters:w,handleView:y,handleEdit:S,handleAdd:E,handleDelete:N,handleSave:j,handleDisable:T,handleModalClose:()=>l(!1),setError:x}},kU=()=>{const[e,t]=b.useState(!1),[r,s]=b.useState(null),[n,i]=b.useState(!1),{roles:o,loading:l,error:c,searchTerm:d,selectedStatuses:u,uniqueStatuses:m,modalShow:f,selectedRole:h,modalMode:p,handleSearch:x,handleStatusToggle:g,handleClearFilters:v,handleView:w,handleEdit:y,handleAdd:S,handleSave:E,handleDisable:N,handleModalClose:j}=_U(),T=P=>{s(P),t(!0)},C=async()=>{if(r){i(!0);try{await N(r.id),t(!1),s(null)}catch(P){console.error("Error disabling role:",P)}finally{i(!1)}}},L=()=>{t(!1),s(null)},A=({role:P})=>a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"light",className:"btn btn-light btn-sm border-0",children:a.jsx(qt,{size:16})},items:[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>w(P)},{label:"Edit Role",icon:a.jsx(as,{}),onClick:()=>y(P)},...P.name.toUpperCase()!=="ADMINISTRATOR"?[{type:"divider"},{label:P.status==="Active"?"Disable Role":"Enable Role",icon:a.jsx(rc,{}),className:P.status==="Active"?"text-warning":"text-success",onClick:()=>T(P)}]:[]]});return Z.useEffect(()=>{c&&ce.error(c)},[c]),a.jsx(_e,{fluid:!0,className:"py-4 role-management-page",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(oe,{className:"align-items-center",children:a.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsx("div",{className:"d-flex justify-content-end",children:a.jsx(wr,{permission:Ne.ROLES.CREATE,fallback:null,children:a.jsxs(se,{variant:"primary-custom",size:"sm",onClick:S,className:"d-flex align-items-center",children:[a.jsx(Cs,{className:"me-1",size:16}),"Add Role"]})})})})})}),a.jsxs(M.Body,{children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search roles by name...",value:d,onChange:x,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(EU,{uniqueStatuses:m,selectedStatuses:u,onStatusToggle:g,onClearFilters:v,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[o.length," role",o.length!==1?"s":""]})})})]}),a.jsx(CU,{roles:o,loading:l,actionsComponent:A,onView:w,onEdit:y,onDisable:N}),a.jsx(AU,{show:f,role:h,mode:p,onSave:E,onClose:j}),a.jsx(SU,{show:e,role:r,onConfirm:C,onCancel:L,loading:n})]})]})})},PU=({show:e,department:t,onClose:r})=>{if(!e||!t)return null;const s=n=>{switch(n){case"CCT":return"bg-info";case"FCTD":return"bg-success";case"GOT":return"bg-warning";case"SQA":return"bg-secondary";default:return"bg-dark"}};return a.jsxs(ue,{show:e,onHide:r,size:"lg",centered:!0,style:{maxHeight:"100vh"},children:[a.jsx(ue.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(ka,{className:"me-2",size:20}),"Department Details"]})}),a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[a.jsxs(oe,{className:"mb-4",children:[a.jsxs(H,{md:8,children:[a.jsx("h3",{className:"fw-bold text-dark mb-2",children:t.name}),a.jsx("p",{className:"text-muted mb-3",children:t.description})]}),a.jsx(H,{md:4,className:"text-end",children:a.jsx(Pe,{bg:t.status==="ACTIVE"?"success":"secondary",className:"px-3 py-2 fs-6",children:t.status})})]}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Code"}),a.jsx("div",{className:"p-3 bg-light rounded",children:a.jsx(Pe,{bg:"primary",className:"px-3 py-2 fs-6",children:t.code})})]})}),a.jsx(H,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Type"}),a.jsx("div",{className:"p-3 bg-light rounded",children:a.jsx(Pe,{bg:s(t.type).replace("bg-",""),className:"px-3 py-2 fs-6",children:t.type})})]})})]}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{md:12,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Department Head"}),a.jsx("div",{className:"p-3 bg-light rounded",children:t.departmentHead?a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ma,{className:"me-3 text-primary",size:24}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold text-dark",children:t.departmentHead.name}),a.jsx("div",{className:"text-muted",children:t.departmentHead.email})]})]}):a.jsx("span",{className:"text-muted italic",children:"Not assigned"})})]})})}),a.jsx(oe,{className:"mb-4",children:a.jsxs(H,{md:12,children:[a.jsx("label",{className:"form-label fw-semibold text-dark mb-3",children:"Department Statistics"}),a.jsxs(oe,{children:[a.jsx(H,{md:4,children:a.jsxs("div",{className:"bg-primary bg-opacity-10 p-4 rounded text-center",children:[a.jsx(bt,{className:"text-primary mb-2",size:32}),a.jsx("div",{className:"h3 fw-bold text-primary mb-1",children:t.coursesCount||0}),a.jsx("div",{className:"text-primary fw-semibold",children:"Courses"})]})}),a.jsx(H,{md:4,children:a.jsxs("div",{className:"bg-success bg-opacity-10 p-4 rounded text-center",children:[a.jsx(Ar,{className:"text-success mb-2",size:32}),a.jsx("div",{className:"h3 fw-bold text-success mb-1",children:t.traineesCount||0}),a.jsx("div",{className:"text-success fw-semibold",children:"Trainees"})]})}),a.jsx(H,{md:4,children:a.jsxs("div",{className:"bg-info bg-opacity-10 p-4 rounded text-center",children:[a.jsx(ma,{className:"text-info mb-2",size:32}),a.jsx("div",{className:"h3 fw-bold text-info mb-1",children:t.trainersCount||0}),a.jsx("div",{className:"text-info fw-semibold",children:"Trainers"})]})})]})]})}),a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Created Date"}),a.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.createdAt).toLocaleDateString()})]})}),a.jsx(H,{md:6,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label fw-semibold text-dark",children:"Last Updated"}),a.jsx("div",{className:"p-3 bg-light rounded",children:new Date(t.updatedAt).toLocaleDateString()})]})})]})]}),a.jsx(ue.Footer,{className:"border-0 p-4",children:a.jsxs("button",{className:"btn btn-secondary",onClick:r,children:[a.jsx(Ze,{className:"me-2",size:16}),"Close"]})})]})},OU=({uniqueTypes:e,uniqueStatuses:t,selectedTypes:r,selectedStatuses:s,onTypeToggle:n,onStatusToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||s.length>0;return a.jsxs($t,{className:`filter-panel-dropdown ${l}`,children:[a.jsx($t.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Li,{size:14,className:"me-2"}),"Filters",c&&a.jsx("span",{className:"badge bg-primary ms-2",children:r.length+s.length})]})}),a.jsxs($t.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Department Types"}),r.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>a.jsx(k.Check,{type:"checkbox",id:`type-${d}`,label:d,checked:r.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),s.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>a.jsx(k.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:s.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[a.jsx(Ze,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},DU=({show:e,department:t,mode:r,onSave:s,onClose:n,availableUsers:i})=>{const[o,l]=b.useState({name:"",code:"",description:"",departmentHeadId:""}),[c,d]=b.useState({}),[u,m]=b.useState(!1);b.useEffect(()=>{t&&r!=="add"?l({name:t.name||"",code:t.code||"",description:t.description||"",departmentHeadId:t.departmentHeadId||""}):r==="add"&&l({name:"",code:"",description:"",departmentHeadId:""}),d({})},[t,r,e]);const f=()=>{const v={};return o.name.trim()?o.name.trim().length<3?v.name="Department name must be at least 3 characters":/^[a-zA-Z0-9\s]+$/.test(o.name.trim())||(v.name="Department name cannot contain special characters"):v.name="Department name is required",o.code.trim()?/^[A-Z]{2,5}$/.test(o.code.trim())||(v.code="Department code must be 2-5 uppercase letters"):v.code="Department code is required",o.departmentHeadId||(v.departmentHeadId="Department head is required"),d(v),Object.keys(v).length===0},h=async v=>{if(v.preventDefault(),!!f()){m(!0);try{const w={name:o.name.trim(),code:o.code.trim(),description:o.description.trim(),headUserId:o.departmentHeadId};console.log(" Department data being sent:",w),await s(w)}catch(w){console.error("Error saving department:",w)}finally{m(!1)}}},p=(v,w)=>{l(y=>({...y,[v]:w})),c[v]&&d(y=>({...y,[v]:""}))},x=()=>{switch(r){case"add":return"Add New Department";case"edit":return"Edit Department";case"view":return"Department Details";default:return"Department"}},g=r==="view";return a.jsxs(ue,{show:e,onHide:n,size:"lg",centered:!0,children:[a.jsx(ue.Header,{className:"bg-gradient-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[r==="view"?a.jsx(Nt,{className:"me-2",size:20}):a.jsx(xa,{className:"me-2",size:20}),x()]})}),a.jsxs(k,{onSubmit:h,children:[a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[Object.keys(c).length>0&&a.jsxs("div",{className:"alert alert-danger mb-3",children:[a.jsx("strong",{children:"Please fix the following errors:"}),a.jsx("ul",{className:"mb-0 mt-2",children:Object.entries(c).map(([v,w])=>a.jsx("li",{children:w},v))})]}),a.jsxs(oe,{children:[a.jsx(H,{md:8,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Department Name *"}),a.jsx(k.Control,{type:"text",value:o.name,onChange:v=>p("name",v.target.value),isInvalid:!!c.name,readOnly:g,placeholder:"Enter department name",style:{borderColor:c.name?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:c.name})]})}),a.jsx(H,{md:4,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Department Code *"}),a.jsx(k.Control,{type:"text",value:o.code,onChange:v=>p("code",v.target.value.toUpperCase()),isInvalid:!!c.code,readOnly:g,placeholder:"e.g., CCT",style:{borderColor:c.code?"#dc3545":"var(--bs-primary)",borderWidth:"2px"}}),a.jsx(k.Control.Feedback,{type:"invalid",children:c.code})]})})]}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Department Head *"}),a.jsxs(k.Select,{value:o.departmentHeadId,onChange:v=>p("departmentHeadId",v.target.value),isInvalid:!!c.departmentHeadId,disabled:g,style:{borderColor:c.departmentHeadId?"#dc3545":"var(--bs-primary)",borderWidth:"2px"},children:[a.jsx("option",{value:"",children:"Select department head"}),i.map(v=>a.jsxs("option",{value:v.id,children:[v.firstName," ",v.lastName," (",v.eid,")"]},v.id))]}),a.jsx(k.Control.Feedback,{type:"invalid",children:c.departmentHeadId})]})})}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Description"}),a.jsx(k.Control,{as:"textarea",rows:4,value:o.description,onChange:v=>p("description",v.target.value),readOnly:g,placeholder:"Enter department description (optional)",style:{borderColor:"var(--bs-primary)",borderWidth:"2px"}})]})})}),r==="view"&&t&&a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Courses Count"}),a.jsx(k.Control,{type:"text",value:t.coursesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Trainees Count"}),a.jsx(k.Control,{type:"text",value:t.traineesCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Trainers Count"}),a.jsx(k.Control,{type:"text",value:t.trainersCount||0,readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{className:"text-primary-custom fw-semibold",children:"Created Date"}),a.jsx(k.Control,{type:"text",value:new Date(t.createdAt).toLocaleDateString(),readOnly:!0,className:"bg-light",style:{borderColor:"var(--bs-neutral)"}})]})})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:n,disabled:u,children:[a.jsx(Ze,{className:"me-2",size:16}),r==="view"?"Close":"Cancel"]}),r!=="view"&&a.jsx(se,{variant:"primary-custom",type:"submit",disabled:u,children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{className:"me-2",size:16}),r==="add"?"Add Department":"Save Changes"]})})]})]})]})},IU=({department:e,index:t,onView:r,onToggleStatus:s})=>{const n=o=>o==="ACTIVE"?"success":"secondary",i=o=>o==="ACTIVE"?"":"";return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx("div",{className:"fw-medium text-dark",children:e.name})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx(Pe,{bg:"secondary",className:"px-2 py-1",style:{backgroundColor:"var(--bs-secondary)",fontSize:"0.75rem"},children:e.code})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.departmentHead?.name||"Not assigned"})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.coursesCount})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.traineesCount})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:e.trainersCount})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsxs(Pe,{bg:n(e.status),className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:i(e.status)}),e.status]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.DEPARTMENTS.VIEW_DETAIL,Ne.DEPARTMENTS.UPDATE],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[...e.status==="ACTIVE"?[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>r(e),permission:Ne.DEPARTMENTS.VIEW_DETAIL}]:[],...e.status==="ACTIVE"?[{type:"divider"}]:[],{label:e.status==="ACTIVE"?"Deactivate":"Activate",icon:a.jsx(rc,{}),className:e.status==="ACTIVE"?"text-danger":"text-success",onClick:()=>s(e),permission:Ne.DEPARTMENTS.UPDATE}]})})})]})},RU=({departments:e,loading:t,onView:r,onToggleStatus:s})=>{const{sortedData:n,sortConfig:i,handleSort:o}=Zt(e);if(t)return a.jsx(Wt,{rows:5,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No departments found"}),a.jsx("p",{children:"Try adjusting your search criteria or add a new department."})]})});const l=({columnKey:c,children:d,className:u=""})=>{const m=i.key===c,f=m?i.direction:null;return a.jsxs("th",{className:`fw-semibold ${u}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>o(c),onMouseEnter:h=>{h.target.style.backgroundColor="#214760",h.target.style.transform="translateY(-1px)",h.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:h=>{h.target.style.backgroundColor="var(--bs-primary)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:m?"600":"500",color:"white"},children:d}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:f,size:14,color:"white"})})]}),m&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"scrollable-table-container",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive table-padded",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(l,{columnKey:"name",className:"show-mobile",children:"Department Name"}),a.jsx(l,{columnKey:"code",className:"show-mobile",children:"Code"}),a.jsx(l,{columnKey:"departmentHead.name",className:"hide-mobile",children:"Department Head"}),a.jsx(l,{columnKey:"coursesCount",className:"hide-mobile",children:"Courses"}),a.jsx(l,{columnKey:"traineesCount",className:"hide-mobile",children:"Trainees"}),a.jsx(l,{columnKey:"trainersCount",className:"hide-mobile",children:"Trainers"}),a.jsx(l,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:n.map((c,d)=>a.jsx(IU,{department:c,index:d,onView:r,onToggleStatus:s},c.id))})]})})},FU=({show:e,department:t,onConfirm:r,onCancel:s,isProcessing:n})=>{const[i,o]=b.useState({courseCount:0,traineeCount:0,trainerCount:0}),[l,c]=b.useState(!1),[d,u]=b.useState(null),[m,f]=b.useState(null);b.useEffect(()=>{e&&t?.id&&h()},[e,t?.id]);const h=async()=>{if(t?.id){c(!0);try{const w=await Ft.getDepartmentById(t.id);console.log(" DisableDepartmentModal - Full API response:",w),console.log(" DisableDepartmentModal - Department Head data:",w.departmentHead||w.headUser),u(w);const y=w.departmentHead||w.headUser;if(y&&y.id&&!y.eid)try{const S=await bs.getUserById(y.id);console.log(" DisableDepartmentModal - Head User detail from API:",S),f(S)}catch(S){console.warn(" Could not fetch headUser detail:",S)}o({courseCount:w.courseCount||w.coursesCount||0,traineeCount:w.traineeCount||w.traineesCount||0,trainerCount:w.trainerCount||w.trainersCount||0})}catch(w){console.error("Error fetching department statistics:",w),u(null),f(null),o({courseCount:t.courseCount||t.coursesCount||0,traineeCount:t.traineeCount||t.traineesCount||0,trainerCount:t.trainerCount||t.trainersCount||0})}finally{c(!1)}}};if(!t)return null;const p=t.status==="ACTIVE",x=p?"deactivate":"activate",g=p?"Deactivate":"Activate",v=!p||i.courseCount===0&&i.traineeCount===0&&i.trainerCount===0;return a.jsxs(ue,{show:e,onHide:s,centered:!0,children:[a.jsx(ue.Header,{className:"border-0 pb-0",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(yr,{className:"me-2 text-warning",size:20}),g," Department"]})}),a.jsxs(ue.Body,{className:"pt-0",children:[a.jsx(Re,{variant:p?"warning":"info",className:"mb-3",style:{backgroundColor:"#e3f2fd",borderColor:"#1b3c53",color:"#1b3c53"},children:a.jsx("div",{className:"d-flex align-items-start",children:a.jsxs("div",{children:[a.jsxs("strong",{children:["Are you sure you want to ",x," this department?"]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("strong",{children:"Department:"})," ",t.name," (",t.code,")"]}),p&&a.jsx("div",{className:"mt-2",children:v?a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Warning:"})," Deactivating this department will:",a.jsxs("ul",{className:"mb-0 mt-1",children:[a.jsx("li",{children:"Make it unavailable for new course assignments"}),a.jsx("li",{children:"Hide it from department selection dropdowns"}),a.jsx("li",{children:"Not affect existing courses and users"})]})]}):a.jsxs("div",{className:"text-danger",children:[a.jsx("strong",{children:"Cannot deactivate:"})," This department has active courses, trainees, or trainers. Please remove all courses, trainees, and trainers before deactivating."]})}),!p&&a.jsxs("div",{className:"mt-2",children:[a.jsx("strong",{children:"Note:"})," Activating this department will make it available for:",a.jsxs("ul",{className:"mb-0 mt-1",children:[a.jsx("li",{children:"New course assignments"}),a.jsx("li",{children:"Department selection in forms"}),a.jsx("li",{children:"User management operations"})]})]})]})})}),a.jsxs("div",{className:"bg-light p-4 rounded",children:[a.jsxs("div",{className:"row g-3",children:[a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"d-flex flex-column",children:[a.jsx("strong",{className:"mb-1",children:"Department Head:"}),a.jsx("span",{className:"text-muted text-break",children:(()=>{const w=d||t;let y=w.departmentHead||w.headUser;if(y&&m&&(y={...y,...m}),y){console.log(" Department Head object:",y);let S="";if(y.name)S=y.name;else if(y.firstName||y.lastName){const N=[];y.firstName&&N.push(y.firstName),y.middleName&&N.push(y.middleName),y.lastName&&N.push(y.lastName),S=N.join(" ").trim()}else y.fullName&&(S=y.fullName);const E=m?.eid||m?.employeeId||y.eid||y.employeeId||"";if(console.log(" Name:",S,"EID:",E||"NOT FOUND"),S&&E)return`${S} [${E}]`;if(S)return S;if(E)return`[${E}]`;if(y.email)return console.warn(" No name or EID found in headUser object, showing email as fallback"),console.warn(" headUser object keys:",Object.keys(y)),y.email}return"N/A"})()})]})}),a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"d-flex flex-column",children:[a.jsx("strong",{className:"mb-1",children:"Current Status:"}),a.jsx("span",{className:`badge ${t.status==="ACTIVE"?"bg-success":"bg-secondary"}`,style:{width:"fit-content",backgroundColor:t.status==="ACTIVE"?"#28a745":"#1b3c53"},children:t.status})]})})]}),a.jsx("hr",{className:"my-3"}),a.jsxs("div",{className:"row g-3",children:[a.jsx("div",{className:"col-4",children:a.jsxs("div",{className:"text-center",children:[l?a.jsx(Pt,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):a.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.courseCount}),a.jsx("small",{className:"text-muted",children:"Courses"})]})}),a.jsx("div",{className:"col-4",children:a.jsxs("div",{className:"text-center",children:[l?a.jsx(Pt,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):a.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.traineeCount}),a.jsx("small",{className:"text-muted",children:"Trainees"})]})}),a.jsx("div",{className:"col-4",children:a.jsxs("div",{className:"text-center",children:[l?a.jsx(Pt,{animation:"border",size:"sm",className:"text-primary",style:{width:"1rem",height:"1rem"}}):a.jsx("div",{className:"h5 mb-1",style:{color:"#1b3c53"},children:i.trainerCount}),a.jsx("small",{className:"text-muted",children:"Trainers"})]})})]})]})]}),a.jsxs(ue.Footer,{className:"border-0",children:[a.jsxs(se,{variant:"outline-secondary",onClick:s,disabled:n,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:p?"warning":"success",onClick:r,disabled:n||p&&!v,style:{backgroundColor:p?"#ffc107":"#28a745",borderColor:p?"#ffc107":"#28a745",opacity:p&&!v?.5:1},children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.8rem",height:"0.8rem"}}),"Processing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(yr,{className:"me-2",size:16}),p&&!v?"Cannot Deactivate":`${g} Department`]})})]})]})},LU=()=>{const e=Qe(),{departments:t,loading:r,searchTerm:s,setSearchTerm:n,createDepartment:i,updateDepartment:o,disableDepartment:l,enableDepartment:c,getAvailableUsers:d}=px(),[u,m]=b.useState(!1),[f,h]=b.useState(!1),[p,x]=b.useState(!1),[g,v]=b.useState("add"),[w,y]=b.useState(null),[S,E]=b.useState(!1),[N,j]=b.useState([]),[T,C]=b.useState([]),[L,A]=b.useState([]);b.useEffect(()=>{(async()=>{try{const ae=await d();A(ae)}catch(ae){console.error("Error loading available users:",ae),A([])}})()},[]);const P=()=>{y(null),v("add"),m(!0)},I=te=>{e(`/admin/departments/${te.id}`)},_=te=>{y(te),h(!0)},D=()=>{m(!1),y(null),v("add")},W=()=>{h(!1),y(null)},K=()=>{x(!1),y(null)},J=async te=>{try{g==="add"?(await i(te),ce.success("Department created successfully")):g==="edit"&&(await o(w.id,te),ce.success("Department updated successfully")),D()}catch(ae){console.error("Error saving department:",ae),ce.error("Failed to save department")}},F=async()=>{try{w&&(w.status==="ACTIVE"?(await l(w.id),ce.success("Department disabled successfully")):(await c(w.id),ce.success("Department enabled successfully")),W())}catch(te){console.error("Error toggling department status:",te),ce.error("Failed to toggle department status")}},le=te=>{n(te)},Ae=te=>{j(te==="clear"?[]:ae=>ae.includes(te)?ae.filter(ne=>ne!==te):[...ae,te])},O=te=>{C(te==="clear"?[]:ae=>ae.includes(te)?ae.filter(ne=>ne!==te):[...ae,te])},G=()=>{j([]),C([])},U=[...new Set(t.map(te=>te.type).filter(Boolean))],B=["ACTIVE","INACTIVE"],Y=t.filter(te=>{const ae=N.length===0||N.includes(te.type),ne=T.length===0||T.includes(te.status);return ae&&ne});return a.jsxs(_e,{fluid:!0,className:"py-4 department-management-page",children:[a.jsxs(M,{className:"shadow-sm",children:[a.jsx(M.Header,{className:"bg-white border-0 pb-0",children:a.jsx(oe,{className:"align-items-center",children:a.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsx("div",{className:"d-flex justify-content-end",children:a.jsx(wr,{permission:Ne.DEPARTMENTS.CREATE,fallback:null,children:a.jsxs(se,{variant:"primary-custom",size:"sm",onClick:P,className:"d-flex align-items-center",children:[a.jsx(Cs,{className:"me-1",size:16}),"Add Department"]})})})})})}),a.jsxs(M.Body,{children:[a.jsxs(oe,{className:"mb-4 form-mobile-stack",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search departments by name, code, or description...",value:s,onChange:le,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(OU,{uniqueTypes:U,uniqueStatuses:B,selectedTypes:N,selectedStatuses:T,onTypeToggle:Ae,onStatusToggle:O,onClearFilters:G,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[Y.length," department",Y.length!==1?"s":""]})})})]}),a.jsx("div",{className:"position-relative mt-3",children:a.jsx(RU,{departments:Y,loading:r,onView:I,onToggleStatus:_})})]})]}),u&&a.jsx(DU,{show:u,department:w,mode:g,onSave:J,onClose:D,availableUsers:L}),f&&w&&a.jsx(FU,{show:f,department:w,onConfirm:F,onCancel:W,isProcessing:r}),p&&w&&a.jsx(PU,{show:p,department:w,onClose:K})]})},MU=({department:e,onBack:t})=>a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-start mb-3",children:[a.jsx(se,{variant:"outline-secondary",onClick:t,className:"me-3 mt-1",size:"sm",children:a.jsx(Tt,{})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:e.name}),a.jsx("p",{className:"text-muted mb-0",children:e.description})]})]})})}),BU=({activeTab:e,onTabChange:t})=>{const r=[{id:"info",label:"Department Info",icon:tN,description:"View department overview"},{id:"edit",label:"Edit Details",icon:as,description:"Modify department information"}];return a.jsxs("div",{className:"department-tabs",children:[a.jsx("div",{className:"tab-navigation",children:r.map(s=>{const n=s.icon,i=e===s.id;return a.jsxs("button",{className:`tab-button ${i?"active":""}`,onClick:()=>t(s.id),children:[a.jsx("div",{className:"tab-icon",children:a.jsx(n,{size:20})}),a.jsxs("div",{className:"tab-content",children:[a.jsx("div",{className:"tab-label",children:s.label}),a.jsx("div",{className:"tab-description",children:s.description})]}),i&&a.jsx("div",{className:"tab-indicator"})]},s.id)})}),a.jsx("div",{className:"tab-separator"})]})},$U=e=>({id:e.id,name:e.name,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),zU=({department:e,onUpdate:t})=>{const[r,s]=b.useState({name:e.name||"",description:e.description||"",headUserId:e.headUserId||""}),[n,i]=b.useState(!1),[o,l]=b.useState([]);b.useEffect(()=>{(async()=>{try{const m=await Ft.getDepartmentHeads(),f=Array.isArray(m)?m:m.data||m.users||[];l(f)}catch(m){console.error("Error loading department heads:",m),ce.error("Failed to load department heads"),l([])}})()},[]);const c=u=>{const{name:m,value:f}=u.target;s(h=>({...h,[m]:f}))},d=async u=>{u.preventDefault(),i(!0);try{if(!r.name||r.name.trim()===""){ce.error("Department name is required"),i(!1);return}console.log(" Submitting department update:",{departmentId:e.id,formData:r});const m=await Ft.updateDepartment(e.id,r),f=$U(m);t(f),ce.success("Department updated successfully!")}catch(m){console.error(" Error updating department:",m);let f="Failed to update department";m.code==="NETWORK_ERROR"?f="Network error: Unable to connect to server. Please check your connection.":m.code==="BAD_GATEWAY"?f="Server error (502): The server is temporarily unavailable. Please try again later.":m.code==="PERMISSION_DENIED"?f="Permission denied: You do not have permission to update this department.":m.response?.data?.message?f=m.response.data.message:m.message&&(f=m.message),ce.error(f)}finally{i(!1)}};return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Edit Department Details"}),a.jsxs("form",{onSubmit:d,children:[a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"name",className:"form-label",children:"Department Name"}),a.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",value:r.name,onChange:c,required:!0})]})})}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"headUserId",className:"form-label",children:"Department Head"}),a.jsxs("select",{className:"form-select",id:"headUserId",name:"headUserId",value:r.headUserId,onChange:c,children:[a.jsx("option",{value:"",children:"Select Department Head"}),Array.isArray(o)&&o.map(u=>a.jsxs("option",{value:u.id,children:["[",u.eid,"] - ",u.firstName," ",u.lastName]},u.id))]})]})})}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),a.jsx("textarea",{className:"form-control",id:"description",name:"description",rows:"4",value:r.description,onChange:c})]}),a.jsx("div",{className:"d-flex gap-2",children:a.jsx(se,{type:"submit",variant:"primary",disabled:n,children:n?"Updating...":"Update Department"})})]})]})},Lb=({department:e})=>{const t=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return a.jsxs("div",{className:"department-info",children:[a.jsx("h4",{className:"mb-4",children:"Department Overview"}),a.jsxs(oe,{className:"g-4",children:[a.jsx(H,{md:6,children:a.jsxs("div",{className:"info-card info-card-basic",children:[a.jsxs("div",{className:"info-header",children:[a.jsx(bt,{className:"info-icon"}),a.jsx("h6",{children:"Basic Information"})]}),a.jsxs("div",{className:"info-content",children:[a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Name:"}),a.jsx("span",{className:"info-value",children:e.name})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Code:"}),a.jsx("span",{className:"info-value",children:e.code||"N/A"})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Description:"}),a.jsx("span",{className:"info-value",children:e.description||"No description provided"})]})]})]})}),a.jsx(H,{md:6,children:a.jsxs("div",{className:"info-card info-card-statistics",children:[a.jsxs("div",{className:"info-header",children:[a.jsx(Ar,{className:"info-icon"}),a.jsx("h6",{children:"Department Statistics"})]}),a.jsxs("div",{className:"info-content",children:[a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Total Courses:"}),a.jsx("span",{className:"info-value",children:e.courseCount||0})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Total Trainees:"}),a.jsx("span",{className:"info-value",children:e.traineeCount||0})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Total Trainers:"}),a.jsx("span",{className:"info-value",children:e.trainerCount||0})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Head of Department:"}),a.jsx("span",{className:"info-value",children:e.headUser?`${e.headUser.firstName} ${e.headUser.lastName}`:"Not assigned"})]})]})]})}),a.jsx(H,{md:6,children:a.jsxs("div",{className:"info-card info-card-timeline",children:[a.jsxs("div",{className:"info-header",children:[a.jsx(pr,{className:"info-icon"}),a.jsx("h6",{children:"Timeline"})]}),a.jsxs("div",{className:"info-content",children:[a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Created:"}),a.jsx("span",{className:"info-value",children:t(e.createdAt)})]}),a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Last Updated:"}),a.jsx("span",{className:"info-value",children:t(e.updatedAt)})]}),e.deletedAt&&a.jsxs("div",{className:"info-item",children:[a.jsx("span",{className:"info-label",children:"Deleted:"}),a.jsx("span",{className:"info-value",children:t(e.deletedAt)})]})]})]})})]})]})},UU=e=>({id:e.id,name:e.name,code:e.code,description:e.description,headUserId:e.headUserId,headUser:e.headUser,isActive:e.isActive,courseCount:e.courseCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0,trainers:e.trainers||[],createdAt:e.createdAt,updatedAt:e.updatedAt,deletedAt:e.deletedAt}),WU=()=>{const{id:e}=Nr(),t=Qe(),[r,s]=b.useState(null),[n,i]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState("info"),u=b.useCallback(async()=>{if(!e){ce.error("Department ID is required"),i(!1);return}i(!0),l(null);try{const p=await Ft.getDepartmentById(e),x=UU(p);s(x)}catch(p){console.error("Error loading department:",p),ce.error("Failed to load department details"),l("Failed to load department details")}finally{i(!1)}},[e]);b.useEffect(()=>{u()},[u]);const m=()=>{t("/admin/departments")},f=p=>{d(p)};if(n)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:a.jsx(Pt,{animation:"border",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})})})});if(o)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsxs("div",{className:"text-danger mb-3",children:[a.jsx("h5",{children:"Unable to load department"}),a.jsx("p",{className:"text-muted",children:"Please try again or contact support if the problem persists."})]}),a.jsxs(se,{variant:"outline-primary",onClick:m,children:[a.jsx(Tt,{className:"me-2"}),"Back to Departments"]})]})});if(!r)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsxs("div",{className:"text-warning mb-3",children:[a.jsx("h5",{children:"Department not found"}),a.jsx("p",{className:"text-muted",children:"The department you're looking for doesn't exist or has been removed."})]}),a.jsxs(se,{variant:"outline-primary",onClick:m,children:[a.jsx(Tt,{className:"me-2"}),"Back to Departments"]})]})});const h=()=>{switch(c){case"info":return a.jsx(Lb,{department:r});case"edit":return a.jsx(zU,{department:r,onUpdate:s});default:return a.jsx(Lb,{department:r})}};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(MU,{department:r,onBack:m}),a.jsx(BU,{activeTab:c,onTabChange:f}),a.jsx(oe,{children:a.jsx(H,{children:a.jsx(M,{className:"shadow-sm",children:a.jsx(M.Body,{className:"p-4",children:h()})})})})]})},HU=({show:e,onClose:t,onSave:r,loading:s=!1})=>{const[n,i]=b.useState({newPassword:"",confirmPassword:""}),[o,l]=b.useState(!1),[c,d]=b.useState(!1),[u,m]=b.useState({show:!1,message:"",variant:"success"}),f=x=>{const{name:g,value:v}=x.target;i(w=>({...w,[g]:v})),u.show&&m({show:!1,message:"",variant:"success"})},h=async x=>{if(x.preventDefault(),n.newPassword!==n.confirmPassword){m({show:!0,message:"New password and confirm password do not match.",variant:"danger"});return}if(n.newPassword.length<6){m({show:!0,message:"New password must be at least 6 characters long.",variant:"danger"});return}try{await r(n),m({show:!0,message:"Password updated successfully!",variant:"success"}),i({newPassword:"",confirmPassword:""}),setTimeout(()=>{t(),m({show:!1,message:"",variant:"success"})},1500)}catch{m({show:!0,message:"Failed to update password. Please check your current password.",variant:"danger"})}},p=()=>{i({newPassword:"",confirmPassword:""}),m({show:!1,message:"",variant:"success"}),t()};return a.jsxs(ue,{show:e,onHide:p,size:"md",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary text-white",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Tl,{className:"me-2",size:20}),"Reset Password"]}),a.jsx(se,{variant:"link",className:"text-white p-0",onClick:p,style:{textDecoration:"none"},children:a.jsx(Ze,{size:20})})]}),a.jsxs(ue.Body,{className:"p-4",children:[u.show&&a.jsx(Re,{variant:u?.variant,className:"mb-3",children:u?.message}),a.jsxs(k,{onSubmit:h,children:[a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{className:"fw-semibold",children:"New Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(k.Control,{type:o?"text":"password",name:"newPassword",value:n.newPassword,onChange:f,required:!0,minLength:6,placeholder:"Enter new password"}),a.jsx(se,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>l(!o),type:"button",children:o?a.jsx(El,{size:16}):a.jsx(Nt,{size:16})})]})]}),a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{className:"fw-semibold",children:"Confirm New Password"}),a.jsxs("div",{className:"position-relative",children:[a.jsx(k.Control,{type:c?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:f,required:!0,minLength:6,placeholder:"Confirm new password"}),a.jsx(se,{variant:"outline-secondary",size:"sm",className:"position-absolute end-0 top-50 translate-middle-y border-0",style:{background:"none",right:"8px"},onClick:()=>d(!c),type:"button",children:c?a.jsx(El,{size:16}):a.jsx(Nt,{size:16})})]})]}),a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx(se,{variant:"outline-secondary",onClick:p,disabled:s,children:"Cancel"}),a.jsx(se,{type:"submit",variant:"secondary",disabled:s,children:s?"Updating...":a.jsxs(a.Fragment,{children:[a.jsx(Tl,{size:16,className:"me-1"}),"Update Password"]})})]})]})]})]})},VU=({profileData:e,user:t,onResetPassword:r,onAvatarUpdated:s,onConfigureSignature:n})=>{const i=b.useRef(null),[o,l]=b.useState(!1),[c,d]=b.useState(null),u=w=>({ADMIN:"danger",DEPT_HEAD:"primary",TRAINER:"info",TRAINEE:"success",ACADEMIC_DEPT:"warning",ACADEMIC_DEPARTMENT:"warning",SQA_AUDITOR:"secondary"})[w]||"secondary",m=()=>e&&[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||"User Name",f=()=>e?.email||t?.email||"user@example.com",h=()=>{const w=e?.role?.name||t?.role||"USER";return w==="ACADEMIC_DEPARTMENT"||w==="ACADEMIC_DEPT"?"ACADEMIC_DEPT":w},p=c||e?.avatarUrl||"",x=()=>{i.current&&i.current.click()},g=(w,y=200,S=200,E=.8)=>new Promise(N=>{const j=document.createElement("canvas"),T=j.getContext("2d"),C=new window.Image;C.onload=()=>{let{width:L,height:A}=C;L>A?L>y&&(A=A*y/L,L=y):A>S&&(L=L*S/A,A=S),j.width=L,j.height=A,T.drawImage(C,0,0,L,A);const P=j.toDataURL("image/jpeg",E);N(P)},C.src=URL.createObjectURL(w)}),v=async w=>{const y=w.target.files&&w.target.files[0];if(y){if(y.size>5*1024*1024){ce.error("File size too large. Please choose an image smaller than 5MB.");return}try{l(!0);const S=await g(y,200,200,.7);d(S);const E=await On.updateAvatar(S,e);ce.success("Avatar updated successfully"),s&&s(E)}catch(S){console.error("Update avatar failed:",S),S.response?.status===422?ce.error("Invalid avatar format. Please try a different image."):S.response?.status===413?ce.error("Image too large. Please choose a smaller image."):ce.error("Failed to update avatar. Please try again."),d(null)}finally{l(!1),i.current&&(i.current.value="")}}};return a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[p?a.jsx(zk,{roundedCircle:!0,src:p,alt:"Avatar",style:{width:"120px",height:"120px",objectFit:"cover"}}):a.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center",style:{width:"120px",height:"120px",margin:"0 auto"},children:a.jsx(Lt,{size:48,className:"text-white"})}),a.jsx("button",{className:"position-absolute rounded-circle border border-2 border-white shadow-sm",style:{width:"36px",height:"36px",bottom:"0px",right:"0px",transform:"translate(40%, 30%)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",cursor:"pointer",fontSize:"18px",color:"#456882",fontWeight:"bold",backgroundColor:"#d2c1b6",lineHeight:"1"},onClick:x,disabled:o,children:o?a.jsx(Pt,{animation:"border",size:"sm"}):""}),a.jsx("input",{ref:i,type:"file",accept:"image/*",className:"d-none",onChange:v})]}),a.jsx("h4",{className:"mb-1",children:m()}),a.jsx("p",{className:"text-muted mb-2",children:f()}),a.jsx(Pe,{bg:u(h()),className:"mb-3",children:h()}),a.jsxs("div",{className:"text-start",children:[e?.address&&a.jsxs("div",{className:"mb-3",children:[a.jsx("strong",{children:"Address:"}),a.jsx("br",{}),a.jsx("span",{className:"text-muted",children:e.address})]}),a.jsxs("div",{className:"d-flex flex-column gap-2",children:[a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:r,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[a.jsx(Tl,{size:14,className:"me-2"}),"Reset Password"]}),(()=>{const w=h();return w==="ACADEMIC_DEPT"||w==="ACADEMIC_DEPARTMENT"?null:a.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:n,className:"d-flex align-items-center justify-content-center",style:{minWidth:"140px",borderRadius:"20px",fontWeight:"500"},children:[a.jsx(ln,{size:14,className:"me-2"}),"Configure Signature"]})})()]})]})]})})},GU=({profileData:e,user:t,onUpdate:r})=>{const[s,n]=b.useState(!1),[i,o]=b.useState({firstName:"",lastName:"",middleName:"",email:"",phoneNumber:"",address:"",gender:"",avatarUrl:""}),[l,c]=b.useState(!1);b.useEffect(()=>{if(e&&e.firstName){const m={firstName:e.firstName||"",lastName:e.lastName||"",middleName:e.middleName||"",email:e.email||"",phoneNumber:e.phoneNumber||"",address:e.address||"",gender:e.gender||"",avatarUrl:e.avatarUrl||""};o(m),c(!0)}},[e,l]);const d=m=>{const{name:f,value:h}=m.target;o(p=>({...p,[f]:h}))},u=async m=>{m.preventDefault(),n(!0);try{r?await r(i):(await On.updateProfile(i),ce.success("Personal information updated successfully!"))}catch(f){console.error("Error updating personal info:",f),r||ce.error("Failed to update personal information. Please try again.")}finally{n(!1)}};return a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:20,className:"me-2 text-primary"}),a.jsx("h5",{className:"mb-0",children:"Personal Information"})]})}),a.jsx(M.Body,{children:a.jsxs(k,{onSubmit:u,children:[a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-md-4 mb-3",children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"First Name"}),a.jsx(k.Control,{type:"text",name:"firstName",value:i.firstName,onChange:d,required:!0})]})}),a.jsx("div",{className:"col-md-4 mb-3",children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Middle Name"}),a.jsx(k.Control,{type:"text",name:"middleName",value:i.middleName,onChange:d})]})}),a.jsx("div",{className:"col-md-4 mb-3",children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Last Name"}),a.jsx(k.Control,{type:"text",name:"lastName",value:i.lastName,onChange:d,required:!0})]})})]}),a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-md-6 mb-3",children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Email"}),a.jsx(k.Control,{type:"email",name:"email",value:i.email,onChange:d,required:!0})]})}),a.jsx("div",{className:"col-md-6 mb-3",children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Phone Number"}),a.jsx(k.Control,{type:"tel",name:"phoneNumber",value:i.phoneNumber,onChange:d})]})})]}),a.jsx("div",{className:"row",children:a.jsx("div",{className:"col-md-6 mb-3",children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Gender"}),a.jsxs(k.Select,{name:"gender",value:i.gender,onChange:d,children:[a.jsx("option",{value:"",children:"Select Gender"}),a.jsx("option",{value:"MALE",children:"Male"}),a.jsx("option",{value:"FEMALE",children:"Female"})]})]})})}),a.jsx("div",{className:"row",children:a.jsx("div",{className:"col-md-12 mb-3",children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Address"}),a.jsx(k.Control,{as:"textarea",rows:3,name:"address",value:i.address,onChange:d,placeholder:"Enter your address"})]})})}),a.jsx("div",{className:"d-flex justify-content-end",children:a.jsx(se,{type:"submit",variant:"primary",disabled:s,children:s?"Saving...":a.jsxs(a.Fragment,{children:[a.jsx(xa,{size:16,className:"me-1"}),"Save Changes"]})})})]})})]})},qU=()=>{const{user:e}=_s(),t=Qe(),[r,s]=b.useState(!1),[n,i]=b.useState(!1),[o,l]=b.useState(null),[c,d]=b.useState(!0),u=async()=>{try{d(!0);const p=await On.getProfile();l(p)}catch(p){console.error("Failed to refresh profile:",p)}finally{d(!1)}};b.useEffect(()=>{u()},[]);const m=async p=>{s(!0);try{const x=await On.updateProfile(p);l(x),ce.success("Personal information updated successfully!")}catch(x){throw console.error("Error updating profile:",x),ce.error("Failed to update personal information. Please try again."),x}finally{s(!1)}},f=async p=>{s(!0);try{const x=await On.resetPassword(p);ce.success(x.message||"Password updated successfully!")}catch(x){throw ce.error(x.message||"Failed to update password. Please check your current password."),x}finally{s(!1)}},h=()=>{e?.role,t("/trainer/configure-signature")};return c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(oe,{children:a.jsx(H,{children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading profile data..."})]})})})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsxs(oe,{children:[a.jsx(H,{lg:4,className:"mb-4",children:a.jsx(VU,{profileData:o,user:e,onResetPassword:()=>i(!0),onAvatarUpdated:u,onConfigureSignature:h})}),a.jsx(H,{lg:8,className:"mb-4",children:a.jsx(GU,{profileData:o,user:e,onUpdate:m})})]}),a.jsx(HU,{show:n,onClose:()=>i(!1),onSave:f,loading:r})]})},KU=()=>{const{user:e}=_s(),t=Qe(),{departments:r,loading:s,error:n}=px(),i=r.filter(l=>l.status==="ACTIVE"),o=l=>{t(`/academic/course/${l}`)};return a.jsx("div",{className:"course-selection",style:{paddingBottom:"2rem"},children:a.jsxs(_e,{className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"text-center",children:[a.jsx(ka,{size:48,className:"text-primary mb-3"}),a.jsx("h2",{className:"mb-2",children:"Academic Department Management"}),a.jsx("p",{className:"text-muted",children:"Select a department to view its details, including list of courses and related subjects"}),a.jsxs("p",{className:"text-muted small",children:["Total Departments: ",a.jsx("strong",{children:i.length})]})]})})}),a.jsx(oe,{className:"mb-5",children:s?a.jsxs(H,{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading departments..."})]}):n?a.jsx(H,{className:"text-center py-5",children:a.jsxs("p",{className:"text-danger",children:["Error loading departments: ",n.message]})}):i.map(l=>a.jsx(H,{md:6,lg:4,className:"mb-4",children:a.jsx(M,{className:"h-100 border-0 shadow-sm course-card d-flex flex-column",children:a.jsxs(M.Body,{className:"p-4 d-flex flex-column h-100",children:[a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:"course-icon me-3",children:a.jsx(bt,{size:24,className:"text-primary"})}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("h5",{className:"mb-1",children:l.name}),a.jsx(Pe,{bg:"secondary",className:"text-white",children:l.code})]})]}),a.jsx("div",{className:"text-muted description-container",children:l.description||a.jsx("span",{className:"text-muted fst-italic",children:"No description available"})}),a.jsxs(se,{variant:"outline-primary",className:"w-100",onClick:()=>o(l.id),children:["View Details",a.jsx(on,{size:16,className:"ms-2"})]})]})})},l.id))})]})})};var Hm={},Vm={},Mb;function YU(){return Mb||(Mb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Vm)),Vm}var Gm={},Bb;function QE(){return Bb||(Bb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Gm)),Gm}var qm={},$b;function ag(){return $b||($b=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(qm)),qm}var Km={},Ym={},zb;function XU(){return zb||(zb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const s=String(r);return s==="0"&&Object.is(Number(r),-0)?"-0":s}e.toString=t})(Ym)),Ym}var Ub;function ng(){return Ub||(Ub=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=XU(),r=ag();function s(n){if(Array.isArray(n))return n.map(r.toKey);if(typeof n=="symbol")return[n];n=t.toString(n);const i=[],o=n.length;if(o===0)return i;let l=0,c="",d="",u=!1;for(n.charCodeAt(0)===46&&(i.push(""),l++);l<o;){const m=n[l];d?m==="\\"&&l+1<o?(l++,c+=n[l]):m===d?d="":c+=m:u?m==='"'||m==="'"?d=m:m==="]"?(u=!1,i.push(c),c=""):c+=m:m==="["?(u=!0,c&&(i.push(c),c="")):m==="."?c&&(i.push(c),c=""):c+=m,l++}return c&&i.push(c),i}e.toPath=s})(Km)),Km}var Wb;function ig(){return Wb||(Wb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YU(),r=QE(),s=ag(),n=ng();function i(l,c,d){if(l==null)return d;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?r.isDeepKey(c)?i(l,n.toPath(c),d):d:u}case"number":case"symbol":{typeof c=="number"&&(c=s.toKey(c));const u=l[c];return u===void 0?d:u}default:{if(Array.isArray(c))return o(l,c,d);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?d:u}}}function o(l,c,d){if(c.length===0)return d;let u=l;for(let m=0;m<c.length;m++){if(u==null||t.isUnsafeProperty(c[m]))return d;u=u[c[m]]}return u===void 0?d:u}e.get=i})(Hm)),Hm}var Xm,Hb;function JU(){return Hb||(Hb=1,Xm=ig().get),Xm}var ZU=JU();const ki=zn(ZU);var Jm={exports:{}},Rt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vb;function QU(){if(Vb)return Rt;Vb=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,s=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,m=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,h=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,v=e?Symbol.for("react.responder"):60118,w=e?Symbol.for("react.scope"):60119;function y(E){if(typeof E=="object"&&E!==null){var N=E.$$typeof;switch(N){case t:switch(E=E.type,E){case c:case d:case s:case i:case n:case m:return E;default:switch(E=E&&E.$$typeof,E){case l:case u:case p:case h:case o:return E;default:return N}}case r:return N}}}function S(E){return y(E)===d}return Rt.AsyncMode=c,Rt.ConcurrentMode=d,Rt.ContextConsumer=l,Rt.ContextProvider=o,Rt.Element=t,Rt.ForwardRef=u,Rt.Fragment=s,Rt.Lazy=p,Rt.Memo=h,Rt.Portal=r,Rt.Profiler=i,Rt.StrictMode=n,Rt.Suspense=m,Rt.isAsyncMode=function(E){return S(E)||y(E)===c},Rt.isConcurrentMode=S,Rt.isContextConsumer=function(E){return y(E)===l},Rt.isContextProvider=function(E){return y(E)===o},Rt.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===t},Rt.isForwardRef=function(E){return y(E)===u},Rt.isFragment=function(E){return y(E)===s},Rt.isLazy=function(E){return y(E)===p},Rt.isMemo=function(E){return y(E)===h},Rt.isPortal=function(E){return y(E)===r},Rt.isProfiler=function(E){return y(E)===i},Rt.isStrictMode=function(E){return y(E)===n},Rt.isSuspense=function(E){return y(E)===m},Rt.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===s||E===d||E===i||E===n||E===m||E===f||typeof E=="object"&&E!==null&&(E.$$typeof===p||E.$$typeof===h||E.$$typeof===o||E.$$typeof===l||E.$$typeof===u||E.$$typeof===g||E.$$typeof===v||E.$$typeof===w||E.$$typeof===x)},Rt.typeOf=y,Rt}var Gb;function eW(){return Gb||(Gb=1,Jm.exports=QU()),Jm.exports}var tW=eW(),Kr=e=>e===0?0:e>0?1:-1,Js=e=>typeof e=="number"&&e!=+e,oi=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,tt=e=>(typeof e=="number"||e instanceof Number)&&!Js(e),Va=e=>tt(e)||typeof e=="string",rW=0,Hl=e=>{var t=++rW;return"".concat(e||"").concat(t)},xs=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!tt(t)&&typeof t!="string")return s;var i;if(oi(t)){if(r==null)return s;var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return Js(i)&&(i=s),n&&r!=null&&i>r&&(i=r),i},eT=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},s=0;s<t;s++)if(!r[e[s]])r[e[s]]=!0;else return!0;return!1};function rs(e,t,r){return tt(e)&&tt(t)?e+r*(t-e):t}function sW(e,t,r){if(!(!e||!e.length))return e.find(s=>s&&(typeof t=="function"?t(s):ki(s,t))===r)}var Yr=e=>e===null||typeof e>"u",gc=e=>Yr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),aW=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function og(e){if(typeof e!="string")return!1;var t=aW;return t.includes(e)}var nW=["viewBox","children"],qb=["points","pathLength"],Zm={svg:nW,polygon:qb,polyline:qb},iW=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(b.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var s={};return Object.keys(r).forEach(n=>{og(n)&&(s[n]=(i=>r[n](r,i)))}),s},oW=(e,t,r)=>s=>(e(t,r,s),null),vc=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var s=null;return Object.keys(e).forEach(n=>{var i=e[n];og(n)&&typeof i=="function"&&(s||(s={}),s[n]=oW(i,t,r))}),s},lW=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function tT(e){if(typeof e!="string")return!1;var t=lW;return t.includes(e)}function Vn(e){var t=Object.entries(e).filter(r=>{var[s]=r;return tT(s)});return Object.fromEntries(t)}var Kb=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",Yb=null,Qm=null,rT=e=>{if(e===Yb&&Array.isArray(Qm))return Qm;var t=[];return b.Children.forEach(e,r=>{Yr(r)||(tW.isFragment(r)?t=t.concat(rT(r.props.children)):t.push(r))}),Qm=t,Yb=e,t};function lg(e,t){var r=[],s=[];return Array.isArray(t)?s=t.map(n=>Kb(n)):s=[Kb(t)],rT(e).forEach(n=>{var i=ki(n,"type.displayName")||ki(n,"type.name");s.indexOf(i)!==-1&&r.push(n)}),r}var cW=(e,t,r,s)=>{var n;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(n=s&&Zm?.[s])!==null&&n!==void 0?n:[],o=t.startsWith("data-"),l=typeof e!="function"&&(!!s&&i.includes(t)||tT(t)),c=!!r&&og(t);return o||l||c},$r=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var s=e;if(b.isValidElement(e)&&(s=e.props),typeof s!="object"&&typeof s!="function")return null;var n={};return Object.keys(s).forEach(i=>{var o;cW((o=s)===null||o===void 0?void 0:o[i],i,t,r)&&(n[i]=s[i])}),n},dW=["children","width","height","viewBox","className","style","title","desc"];function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},cp.apply(null,arguments)}function uW(e,t){if(e==null)return{};var r,s,n=mW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mW(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var cg=b.forwardRef((e,t)=>{var{children:r,width:s,height:n,viewBox:i,className:o,style:l,title:c,desc:d}=e,u=uW(e,dW),m=i||{width:s,height:n,x:0,y:0},f=Et("recharts-surface",o);return b.createElement("svg",cp({},$r(u,!0,"svg"),{className:f,width:s,height:n,style:l,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),b.createElement("title",null,c),b.createElement("desc",null,d),r)}),fW=["children","className"];function dp(){return dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},dp.apply(null,arguments)}function hW(e,t){if(e==null)return{};var r,s,n=pW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pW(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Bs=b.forwardRef((e,t)=>{var{children:r,className:s}=e,n=hW(e,fW),i=Et("recharts-layer",s);return b.createElement("g",dp({className:i},$r(n,!0),{ref:t}),r)}),sT=b.createContext(null),xW=()=>b.useContext(sT);function Jt(e){return function(){return e}}const aT=Math.cos,Bd=Math.sin,Ia=Math.sqrt,$d=Math.PI,Wu=2*$d,up=Math.PI,mp=2*up,ti=1e-6,gW=mp-ti;function nT(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function vW(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return nT;const r=10**t;return function(s){this._+=s[0];for(let n=1,i=s.length;n<i;++n)this._+=Math.round(arguments[n]*r)/r+s[n]}}class bW{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?nT:vW(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,s,n){this._append`Q${+t},${+r},${this._x1=+s},${this._y1=+n}`}bezierCurveTo(t,r,s,n,i,o){this._append`C${+t},${+r},${+s},${+n},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,s,n,i){if(t=+t,r=+r,s=+s,n=+n,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=s-t,d=n-r,u=o-t,m=l-r,f=u*u+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>ti)if(!(Math.abs(m*c-d*u)>ti)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=s-o,p=n-l,x=c*c+d*d,g=h*h+p*p,v=Math.sqrt(x),w=Math.sqrt(f),y=i*Math.tan((up-Math.acos((x+f-g)/(2*v*w)))/2),S=y/w,E=y/v;Math.abs(S-1)>ti&&this._append`L${t+S*u},${r+S*m}`,this._append`A${i},${i},0,0,${+(m*h>u*p)},${this._x1=t+E*c},${this._y1=r+E*d}`}}arc(t,r,s,n,i,o){if(t=+t,r=+r,s=+s,o=!!o,s<0)throw new Error(`negative radius: ${s}`);let l=s*Math.cos(n),c=s*Math.sin(n),d=t+l,u=r+c,m=1^o,f=o?n-i:i-n;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>ti||Math.abs(this._y1-u)>ti)&&this._append`L${d},${u}`,s&&(f<0&&(f=f%mp+mp),f>gW?this._append`A${s},${s},0,1,${m},${t-l},${r-c}A${s},${s},0,1,${m},${this._x1=d},${this._y1=u}`:f>ti&&this._append`A${s},${s},0,${+(f>=up)},${m},${this._x1=t+s*Math.cos(i)},${this._y1=r+s*Math.sin(i)}`)}rect(t,r,s,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${s=+s}v${+n}h${-s}Z`}toString(){return this._}}function dg(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);t=s}return e},()=>new bW(t)}function ug(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function iT(e){this._context=e}iT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Hu(e){return new iT(e)}function oT(e){return e[0]}function lT(e){return e[1]}function cT(e,t){var r=Jt(!0),s=null,n=Hu,i=null,o=dg(l);e=typeof e=="function"?e:e===void 0?oT:Jt(e),t=typeof t=="function"?t:t===void 0?lT:Jt(t);function l(c){var d,u=(c=ug(c)).length,m,f=!1,h;for(s==null&&(i=n(h=o())),d=0;d<=u;++d)!(d<u&&r(m=c[d],d,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(m,d,c),+t(m,d,c));if(h)return i=null,h+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Jt(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Jt(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Jt(!!c),l):r},l.curve=function(c){return arguments.length?(n=c,s!=null&&(i=n(s)),l):n},l.context=function(c){return arguments.length?(c==null?s=i=null:i=n(s=c),l):s},l}function Xc(e,t,r){var s=null,n=Jt(!0),i=null,o=Hu,l=null,c=dg(d);e=typeof e=="function"?e:e===void 0?oT:Jt(+e),t=typeof t=="function"?t:Jt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?lT:Jt(+r);function d(m){var f,h,p,x=(m=ug(m)).length,g,v=!1,w,y=new Array(x),S=new Array(x);for(i==null&&(l=o(w=c())),f=0;f<=x;++f){if(!(f<x&&n(g=m[f],f,m))===v)if(v=!v)h=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),p=f-1;p>=h;--p)l.point(y[p],S[p]);l.lineEnd(),l.areaEnd()}v&&(y[f]=+e(g,f,m),S[f]=+t(g,f,m),l.point(s?+s(g,f,m):y[f],r?+r(g,f,m):S[f]))}if(w)return l=null,w+""||null}function u(){return cT().defined(n).curve(o).context(i)}return d.x=function(m){return arguments.length?(e=typeof m=="function"?m:Jt(+m),s=null,d):e},d.x0=function(m){return arguments.length?(e=typeof m=="function"?m:Jt(+m),d):e},d.x1=function(m){return arguments.length?(s=m==null?null:typeof m=="function"?m:Jt(+m),d):s},d.y=function(m){return arguments.length?(t=typeof m=="function"?m:Jt(+m),r=null,d):t},d.y0=function(m){return arguments.length?(t=typeof m=="function"?m:Jt(+m),d):t},d.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:Jt(+m),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(s).y(t)},d.defined=function(m){return arguments.length?(n=typeof m=="function"?m:Jt(!!m),d):n},d.curve=function(m){return arguments.length?(o=m,i!=null&&(l=o(i)),d):o},d.context=function(m){return arguments.length?(m==null?i=l=null:l=o(i=m),d):i},d}class dT{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function yW(e){return new dT(e,!0)}function wW(e){return new dT(e,!1)}const mg={draw(e,t){const r=Ia(t/$d);e.moveTo(r,0),e.arc(0,0,r,0,Wu)}},jW={draw(e,t){const r=Ia(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},uT=Ia(1/3),NW=uT*2,SW={draw(e,t){const r=Ia(t/NW),s=r*uT;e.moveTo(0,-r),e.lineTo(s,0),e.lineTo(0,r),e.lineTo(-s,0),e.closePath()}},EW={draw(e,t){const r=Ia(t),s=-r/2;e.rect(s,s,r,r)}},TW=.8908130915292852,mT=Bd($d/10)/Bd(7*$d/10),AW=Bd(Wu/10)*mT,CW=-aT(Wu/10)*mT,_W={draw(e,t){const r=Ia(t*TW),s=AW*r,n=CW*r;e.moveTo(0,-r),e.lineTo(s,n);for(let i=1;i<5;++i){const o=Wu*i/5,l=aT(o),c=Bd(o);e.lineTo(c*r,-l*r),e.lineTo(l*s-c*n,c*s+l*n)}e.closePath()}},ef=Ia(3),kW={draw(e,t){const r=-Ia(t/(ef*3));e.moveTo(0,r*2),e.lineTo(-ef*r,-r),e.lineTo(ef*r,-r),e.closePath()}},ra=-.5,sa=Ia(3)/2,fp=1/Ia(12),PW=(fp/2+1)*3,OW={draw(e,t){const r=Ia(t/PW),s=r/2,n=r*fp,i=s,o=r*fp+r,l=-i,c=o;e.moveTo(s,n),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(ra*s-sa*n,sa*s+ra*n),e.lineTo(ra*i-sa*o,sa*i+ra*o),e.lineTo(ra*l-sa*c,sa*l+ra*c),e.lineTo(ra*s+sa*n,ra*n-sa*s),e.lineTo(ra*i+sa*o,ra*o-sa*i),e.lineTo(ra*l+sa*c,ra*c-sa*l),e.closePath()}};function DW(e,t){let r=null,s=dg(n);e=typeof e=="function"?e:Jt(e||mg),t=typeof t=="function"?t:Jt(t===void 0?64:+t);function n(){let i;if(r||(r=i=s()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return n.type=function(i){return arguments.length?(e=typeof i=="function"?i:Jt(i),n):e},n.size=function(i){return arguments.length?(t=typeof i=="function"?i:Jt(+i),n):t},n.context=function(i){return arguments.length?(r=i??null,n):r},n}function zd(){}function Ud(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function fT(e){this._context=e}fT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ud(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ud(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function IW(e){return new fT(e)}function hT(e){this._context=e}hT.prototype={areaStart:zd,areaEnd:zd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ud(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function RW(e){return new hT(e)}function pT(e){this._context=e}pT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:Ud(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function FW(e){return new pT(e)}function xT(e){this._context=e}xT.prototype={areaStart:zd,areaEnd:zd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function LW(e){return new xT(e)}function Xb(e){return e<0?-1:1}function Jb(e,t,r){var s=e._x1-e._x0,n=t-e._x1,i=(e._y1-e._y0)/(s||n<0&&-0),o=(r-e._y1)/(n||s<0&&-0),l=(i*n+o*s)/(s+n);return(Xb(i)+Xb(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function Zb(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function tf(e,t,r){var s=e._x0,n=e._y0,i=e._x1,o=e._y1,l=(i-s)/3;e._context.bezierCurveTo(s+l,n+l*t,i-l,o-l*r,i,o)}function Wd(e){this._context=e}Wd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tf(this,this._t0,Zb(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,tf(this,Zb(this,r=Jb(this,e,t)),r);break;default:tf(this,this._t0,r=Jb(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function gT(e){this._context=new vT(e)}(gT.prototype=Object.create(Wd.prototype)).point=function(e,t){Wd.prototype.point.call(this,t,e)};function vT(e){this._context=e}vT.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,s,n,i){this._context.bezierCurveTo(t,e,s,r,i,n)}};function MW(e){return new Wd(e)}function BW(e){return new gT(e)}function bT(e){this._context=e}bT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var s=Qb(e),n=Qb(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(s[0][i],n[0][i],s[1][i],n[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Qb(e){var t,r=e.length-1,s,n=new Array(r),i=new Array(r),o=new Array(r);for(n[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)n[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(n[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)s=n[t]/i[t-1],i[t]-=s,o[t]-=s*o[t-1];for(n[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)n[t]=(o[t]-n[t+1])/i[t];for(i[r-1]=(e[r]+n[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-n[t+1];return[n,i]}function $W(e){return new bT(e)}function Vu(e,t){this._context=e,this._t=t}Vu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function zW(e){return new Vu(e,.5)}function UW(e){return new Vu(e,0)}function WW(e){return new Vu(e,1)}function bo(e,t){if((o=e.length)>1)for(var r=1,s,n,i=e[t[0]],o,l=i.length;r<o;++r)for(n=i,i=e[t[r]],s=0;s<l;++s)i[s][1]+=i[s][0]=isNaN(n[s][1])?n[s][0]:n[s][1]}function hp(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function HW(e,t){return e[t]}function VW(e){const t=[];return t.key=e,t}function GW(){var e=Jt([]),t=hp,r=bo,s=HW;function n(i){var o=Array.from(e.apply(this,arguments),VW),l,c=o.length,d=-1,u;for(const m of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+s(m,o[l].key,d,i)]).data=m;for(l=0,u=ug(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return n.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Jt(Array.from(i)),n):e},n.value=function(i){return arguments.length?(s=typeof i=="function"?i:Jt(+i),n):s},n.order=function(i){return arguments.length?(t=i==null?hp:typeof i=="function"?i:Jt(Array.from(i)),n):t},n.offset=function(i){return arguments.length?(r=i??bo,n):r},n}function qW(e,t){if((s=e.length)>0){for(var r,s,n=0,i=e[0].length,o;n<i;++n){for(o=r=0;r<s;++r)o+=e[r][n][1]||0;if(o)for(r=0;r<s;++r)e[r][n][1]/=o}bo(e,t)}}function KW(e,t){if((n=e.length)>0){for(var r=0,s=e[t[0]],n,i=s.length;r<i;++r){for(var o=0,l=0;o<n;++o)l+=e[o][r][1]||0;s[r][1]+=s[r][0]=-l/2}bo(e,t)}}function YW(e,t){if(!(!((o=e.length)>0)||!((i=(n=e[t[0]]).length)>0))){for(var r=0,s=1,n,i,o;s<i;++s){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],m=u[s][1]||0,f=u[s-1][1]||0,h=(m-f)/2,p=0;p<l;++p){var x=e[t[p]],g=x[s][1]||0,v=x[s-1][1]||0;h+=g-v}c+=m,d+=h*m}n[s-1][1]+=n[s-1][0]=r,c&&(r-=d/c)}n[s-1][1]+=n[s-1][0]=r,bo(e,t)}}var XW=["type","size","sizeType"];function pp(){return pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},pp.apply(null,arguments)}function ey(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ty(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ey(Object(r),!0).forEach(function(s){JW(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ey(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function JW(e,t,r){return(t=ZW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZW(e){var t=QW(e,"string");return typeof t=="symbol"?t:t+""}function QW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eH(e,t){if(e==null)return{};var r,s,n=tH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tH(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var yT={symbolCircle:mg,symbolCross:jW,symbolDiamond:SW,symbolSquare:EW,symbolStar:_W,symbolTriangle:kW,symbolWye:OW},rH=Math.PI/180,sH=e=>{var t="symbol".concat(gc(e));return yT[t]||mg},aH=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*rH;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},nH=(e,t)=>{yT["symbol".concat(gc(e))]=t},fg=e=>{var{type:t="circle",size:r=64,sizeType:s="area"}=e,n=eH(e,XW),i=ty(ty({},n),{},{type:t,size:r,sizeType:s}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var f=sH(o),h=DW().type(f).size(aH(r,s,o));return h()},{className:c,cx:d,cy:u}=i,m=$r(i,!0);return d===+d&&u===+u&&r===+r?b.createElement("path",pp({},m,{className:Et("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:l()})):null};fg.registerSymbol=nH;function xp(){return xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},xp.apply(null,arguments)}function ry(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function iH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ry(Object(r),!0).forEach(function(s){hg(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ry(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function hg(e,t,r){return(t=oH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oH(e){var t=lH(e,"string");return typeof t=="symbol"?t:t+""}function lH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aa=32;class pg extends b.PureComponent{renderIcon(t,r){var{inactiveColor:s}=this.props,n=aa/2,i=aa/6,o=aa/3,l=t.inactive?s:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return b.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:n,x2:aa,y2:n,className:"recharts-legend-icon"});if(c==="line")return b.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(n,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(n,`
            H`).concat(aa,"M").concat(2*o,",").concat(n,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(n),className:"recharts-legend-icon"});if(c==="rect")return b.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(aa/8,"h").concat(aa,"v").concat(aa*3/4,"h").concat(-aa,"z"),className:"recharts-legend-icon"});if(b.isValidElement(t.legendIcon)){var d=iH({},t);return delete d.legendIcon,b.cloneElement(t.legendIcon,d)}return b.createElement(fg,{fill:l,cx:n,cy:n,size:aa,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:s,formatter:n,inactiveColor:i,iconType:o}=this.props,l={x:0,y:0,width:aa,height:aa},c={display:s==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((u,m)=>{var f=u.formatter||n,h=Et({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:u.inactive});if(u.type==="none")return null;var p=u.inactive?i:u.color,x=f?f(u.value,u,m):u.value;return b.createElement("li",xp({className:h,style:c,key:"legend-item-".concat(m)},vc(this.props,u,m)),b.createElement(cg,{width:r,height:r,viewBox:l,style:d,"aria-label":"".concat(x," legend icon")},this.renderIcon(u,o)),b.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},x))})}render(){var{payload:t,layout:r,align:s}=this.props;if(!t||!t.length)return null;var n={padding:0,margin:0,textAlign:r==="horizontal"?s:"left"};return b.createElement("ul",{className:"recharts-default-legend",style:n},this.renderItems())}}hg(pg,"displayName","Legend");hg(pg,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var rf={},sf={},sy;function cH(){return sy||(sy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s){const n=new Map;for(let i=0;i<r.length;i++){const o=r[i],l=s(o);n.has(l)||n.set(l,o)}return Array.from(n.values())}e.uniqBy=t})(sf)),sf}var af={},ay;function wT(){return ay||(ay=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(af)),af}var nf={},of={},lf={},ny;function dH(){return ny||(ny=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(lf)),lf}var iy;function xg(){return iy||(iy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dH();function r(s){return s!=null&&typeof s!="function"&&t.isLength(s.length)}e.isArrayLike=r})(of)),of}var cf={},oy;function uH(){return oy||(oy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(cf)),cf}var ly;function mH(){return ly||(ly=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xg(),r=uH();function s(n){return r.isObjectLike(n)&&t.isArrayLike(n)}e.isArrayLikeObject=s})(nf)),nf}var df={},uf={},cy;function fH(){return cy||(cy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ig();function r(s){return function(n){return t.get(n,s)}}e.property=r})(uf)),uf}var mf={},ff={},hf={},pf={},dy;function jT(){return dy||(dy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(pf)),pf}var xf={},uy;function NT(){return uy||(uy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(xf)),xf}var gf={},my;function ST(){return my||(my=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s){return r===s||Number.isNaN(r)&&Number.isNaN(s)}e.eq=t})(gf)),gf}var fy;function hH(){return fy||(fy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gg(),r=jT(),s=NT(),n=ST();function i(m,f,h){return typeof h!="function"?t.isMatch(m,f):o(m,f,function p(x,g,v,w,y,S){const E=h(x,g,v,w,y,S);return E!==void 0?!!E:o(x,g,p,S)},new Map)}function o(m,f,h,p){if(f===m)return!0;switch(typeof f){case"object":return l(m,f,h,p);case"function":return Object.keys(f).length>0?o(m,{...f},h,p):n.eq(m,f);default:return r.isObject(m)?typeof f=="string"?f==="":!0:n.eq(m,f)}}function l(m,f,h,p){if(f==null)return!0;if(Array.isArray(f))return d(m,f,h,p);if(f instanceof Map)return c(m,f,h,p);if(f instanceof Set)return u(m,f,h,p);const x=Object.keys(f);if(m==null)return x.length===0;if(x.length===0)return!0;if(p&&p.has(f))return p.get(f)===m;p&&p.set(f,m);try{for(let g=0;g<x.length;g++){const v=x[g];if(!s.isPrimitive(m)&&!(v in m)||f[v]===void 0&&m[v]!==void 0||f[v]===null&&m[v]!==null||!h(m[v],f[v],v,m,f,p))return!1}return!0}finally{p&&p.delete(f)}}function c(m,f,h,p){if(f.size===0)return!0;if(!(m instanceof Map))return!1;for(const[x,g]of f.entries()){const v=m.get(x);if(h(v,g,x,m,f,p)===!1)return!1}return!0}function d(m,f,h,p){if(f.length===0)return!0;if(!Array.isArray(m))return!1;const x=new Set;for(let g=0;g<f.length;g++){const v=f[g];let w=!1;for(let y=0;y<m.length;y++){if(x.has(y))continue;const S=m[y];let E=!1;if(h(S,v,g,m,f,p)&&(E=!0),E){x.add(y),w=!0;break}}if(!w)return!1}return!0}function u(m,f,h,p){return f.size===0?!0:m instanceof Set?d([...m],[...f],h,p):!1}e.isMatchWith=i,e.isSetMatch=u})(hf)),hf}var hy;function gg(){return hy||(hy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hH();function r(s,n){return t.isMatchWith(s,n,()=>{})}e.isMatch=r})(ff)),ff}var vf={},bf={},yf={},py;function pH(){return py||(py=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(s=>Object.prototype.propertyIsEnumerable.call(r,s))}e.getSymbols=t})(yf)),yf}var wf={},xy;function ET(){return xy||(xy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(wf)),wf}var jf={},gy;function TT(){return gy||(gy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",s="[object Number]",n="[object Boolean]",i="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",d="[object Set]",u="[object Array]",m="[object Function]",f="[object ArrayBuffer]",h="[object Object]",p="[object Error]",x="[object DataView]",g="[object Uint8Array]",v="[object Uint8ClampedArray]",w="[object Uint16Array]",y="[object Uint32Array]",S="[object BigUint64Array]",E="[object Int8Array]",N="[object Int16Array]",j="[object Int32Array]",T="[object BigInt64Array]",C="[object Float32Array]",L="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=f,e.arrayTag=u,e.bigInt64ArrayTag=T,e.bigUint64ArrayTag=S,e.booleanTag=n,e.dataViewTag=x,e.dateTag=l,e.errorTag=p,e.float32ArrayTag=C,e.float64ArrayTag=L,e.functionTag=m,e.int16ArrayTag=N,e.int32ArrayTag=j,e.int8ArrayTag=E,e.mapTag=c,e.numberTag=s,e.objectTag=h,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=w,e.uint32ArrayTag=y,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=v})(jf)),jf}var Nf={},vy;function xH(){return vy||(vy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Nf)),Nf}var by;function AT(){return by||(by=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pH(),r=ET(),s=TT(),n=NT(),i=xH();function o(u,m){return l(u,void 0,u,new Map,m)}function l(u,m,f,h=new Map,p=void 0){const x=p?.(u,m,f,h);if(x!==void 0)return x;if(n.isPrimitive(u))return u;if(h.has(u))return h.get(u);if(Array.isArray(u)){const g=new Array(u.length);h.set(u,g);for(let v=0;v<u.length;v++)g[v]=l(u[v],v,f,h,p);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;h.set(u,g);for(const[v,w]of u)g.set(v,l(w,v,f,h,p));return g}if(u instanceof Set){const g=new Set;h.set(u,g);for(const v of u)g.add(l(v,void 0,f,h,p));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(i.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);h.set(u,g);for(let v=0;v<u.length;v++)g[v]=l(u[v],v,f,h,p);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return h.set(u,g),c(g,u,f,h,p),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return h.set(u,g),c(g,u,f,h,p),g}if(typeof Blob<"u"&&u instanceof Blob){const g=new Blob([u],{type:u.type});return h.set(u,g),c(g,u,f,h,p),g}if(u instanceof Error){const g=new u.constructor;return h.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,c(g,u,f,h,p),g}if(u instanceof Boolean){const g=new Boolean(u.valueOf());return h.set(u,g),c(g,u,f,h,p),g}if(u instanceof Number){const g=new Number(u.valueOf());return h.set(u,g),c(g,u,f,h,p),g}if(u instanceof String){const g=new String(u.valueOf());return h.set(u,g),c(g,u,f,h,p),g}if(typeof u=="object"&&d(u)){const g=Object.create(Object.getPrototypeOf(u));return h.set(u,g),c(g,u,f,h,p),g}return u}function c(u,m,f=u,h,p){const x=[...Object.keys(m),...t.getSymbols(m)];for(let g=0;g<x.length;g++){const v=x[g],w=Object.getOwnPropertyDescriptor(u,v);(w==null||w.writable)&&(u[v]=l(m[v],v,f,h,p))}}function d(u){switch(r.getTag(u)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(bf)),bf}var yy;function gH(){return yy||(yy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AT();function r(s){return t.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}e.cloneDeep=r})(vf)),vf}var wy;function vH(){return wy||(wy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gg(),r=gH();function s(n){return n=r.cloneDeep(n),i=>t.isMatch(i,n)}e.matches=s})(mf)),mf}var Sf={},Ef={},Tf={},jy;function bH(){return jy||(jy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AT(),r=TT();function s(n,i){return t.cloneDeepWith(n,(o,l,c,d)=>{const u=i?.(o,l,c,d);if(u!==void 0)return u;if(typeof n=="object")switch(Object.prototype.toString.call(n)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new n.constructor(n?.valueOf());return t.copyProperties(m,n),m}case r.argumentsTag:{const m={};return t.copyProperties(m,n),m.length=n.length,m[Symbol.iterator]=n[Symbol.iterator],m}default:return}})}e.cloneDeepWith=s})(Tf)),Tf}var Ny;function yH(){return Ny||(Ny=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bH();function r(s){return t.cloneDeepWith(s)}e.cloneDeep=r})(Ef)),Ef}var Af={},Cf={},Sy;function CT(){return Sy||(Sy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(s,n=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<n;case"symbol":return!1;case"string":return t.test(s)}}e.isIndex=r})(Cf)),Cf}var _f={},Ey;function wH(){return Ey||(Ey=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ET();function r(s){return s!==null&&typeof s=="object"&&t.getTag(s)==="[object Arguments]"}e.isArguments=r})(_f)),_f}var Ty;function jH(){return Ty||(Ty=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=QE(),r=CT(),s=wH(),n=ng();function i(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&o?.[l]==null?c=n.toPath(l):c=[l],c.length===0)return!1;let d=o;for(let u=0;u<c.length;u++){const m=c[u];if((d==null||!Object.hasOwn(d,m))&&!((Array.isArray(d)||s.isArguments(d))&&r.isIndex(m)&&m<d.length))return!1;d=d[m]}return!0}e.has=i})(Af)),Af}var Ay;function NH(){return Ay||(Ay=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gg(),r=ag(),s=yH(),n=ig(),i=jH();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=s.cloneDeep(c),function(d){const u=n.get(d,l);return u===void 0?i.has(d,l):c===void 0?u===void 0:t.isMatch(u,c)}}e.matchesProperty=o})(Sf)),Sf}var Cy;function SH(){return Cy||(Cy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wT(),r=fH(),s=vH(),n=NH();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?n.matchesProperty(o[0],o[1]):s.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=i})(df)),df}var _y;function EH(){return _y||(_y=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cH(),r=wT(),s=mH(),n=SH();function i(o,l=r.identity){return s.isArrayLikeObject(o)?t.uniqBy(Array.from(o),n.iteratee(l)):[]}e.uniqBy=i})(rf)),rf}var kf,ky;function TH(){return ky||(ky=1,kf=EH().uniqBy),kf}var AH=TH();const Py=zn(AH);function _T(e,t,r){return t===!0?Py(e,r):typeof t=="function"?Py(e,t):e}var Pf={exports:{}},Of={},Df={exports:{}},If={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oy;function CH(){if(Oy)return If;Oy=1;var e=ax();function t(m,f){return m===f&&(m!==0||1/m===1/f)||m!==m&&f!==f}var r=typeof Object.is=="function"?Object.is:t,s=e.useState,n=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function l(m,f){var h=f(),p=s({inst:{value:h,getSnapshot:f}}),x=p[0].inst,g=p[1];return i(function(){x.value=h,x.getSnapshot=f,c(x)&&g({inst:x})},[m,h,f]),n(function(){return c(x)&&g({inst:x}),m(function(){c(x)&&g({inst:x})})},[m]),o(h),h}function c(m){var f=m.getSnapshot;m=m.value;try{var h=f();return!r(m,h)}catch{return!0}}function d(m,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return If.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,If}var Dy;function _H(){return Dy||(Dy=1,Df.exports=CH()),Df.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iy;function kH(){if(Iy)return Of;Iy=1;var e=ax(),t=_H();function r(d,u){return d===u&&(d!==0||1/d===1/u)||d!==d&&u!==u}var s=typeof Object.is=="function"?Object.is:r,n=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;return Of.useSyncExternalStoreWithSelector=function(d,u,m,f,h){var p=i(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=l(function(){function v(N){if(!w){if(w=!0,y=N,N=f(N),h!==void 0&&x.hasValue){var j=x.value;if(h(j,N))return S=j}return S=N}if(j=S,s(y,N))return j;var T=f(N);return h!==void 0&&h(j,T)?(y=N,j):(y=N,S=T)}var w=!1,y,S,E=m===void 0?null:m;return[function(){return v(u())},E===null?void 0:function(){return v(E())}]},[u,m,f,h]);var g=n(d,p[0],p[1]);return o(function(){x.hasValue=!0,x.value=g},[g]),c(g),g},Of}var Ry;function PH(){return Ry||(Ry=1,Pf.exports=kH()),Pf.exports}var OH=PH(),vg=b.createContext(null),DH=e=>e,gr=()=>{var e=b.useContext(vg);return e?e.store.dispatch:DH},vd=()=>{},IH=()=>vd,RH=(e,t)=>e===t;function Xe(e){var t=b.useContext(vg);return OH.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:IH,t?t.store.getState:vd,t?t.store.getState:vd,t?e:vd,RH)}function FH(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function LH(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function MH(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${t}[${r}]`)}}var Fy=e=>Array.isArray(e)?e:[e];function BH(e){const t=Array.isArray(e[0])?e[0]:e;return MH(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function $H(e,t){const r=[],{length:s}=e;for(let n=0;n<s;n++)r.push(e[n].apply(null,t));return r}var zH=class{constructor(e){this.value=e}deref(){return this.value}},UH=typeof WeakRef<"u"?WeakRef:zH,WH=0,Ly=1;function Jc(){return{s:WH,v:void 0,o:null,p:null}}function kT(e,t={}){let r=Jc();const{resultEqualityCheck:s}=t;let n,i=0;function o(){let l=r;const{length:c}=arguments;for(let m=0,f=c;m<f;m++){const h=arguments[m];if(typeof h=="function"||typeof h=="object"&&h!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const x=p.get(h);x===void 0?(l=Jc(),p.set(h,l)):l=x}else{let p=l.p;p===null&&(l.p=p=new Map);const x=p.get(h);x===void 0?(l=Jc(),p.set(h,l)):l=x}}const d=l;let u;if(l.s===Ly)u=l.v;else if(u=e.apply(null,arguments),i++,s){const m=n?.deref?.()??n;m!=null&&s(m,u)&&(u=m,i!==0&&i--),n=typeof u=="object"&&u!==null||typeof u=="function"?new UH(u):u}return d.s=Ly,d.v=u,u}return o.clearCache=()=>{r=Jc(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function HH(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,s=(...n)=>{let i=0,o=0,l,c={},d=n.pop();typeof d=="object"&&(c=d,d=n.pop()),FH(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...r,...c},{memoize:m,memoizeOptions:f=[],argsMemoize:h=kT,argsMemoizeOptions:p=[]}=u,x=Fy(f),g=Fy(p),v=BH(n),w=m(function(){return i++,d.apply(null,arguments)},...x),y=h(function(){o++;const E=$H(v,arguments);return l=w.apply(null,E),l},...g);return Object.assign(y,{resultFunc:d,memoizedResultFunc:w,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:h})};return Object.assign(s,{withTypes:()=>s}),s}var ve=HH(kT),VH=Object.assign((e,t=ve)=>{LH(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),s=r.map(i=>e[i]);return t(s,(...i)=>i.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>VH}),Rf={},Ff={},Lf={},My;function GH(){return My||(My=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const r=(s,n,i)=>{if(s!==n){const o=t(s),l=t(n);if(o===l&&o===0){if(s<n)return i==="desc"?1:-1;if(s>n)return i==="desc"?-1:1}return i==="desc"?l-o:o-l}return 0};e.compareValues=r})(Lf)),Lf}var Mf={},Bf={},By;function PT(){return By||(By=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Bf)),Bf}var $y;function qH(){return $y||($y=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PT(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function n(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(s.test(i)||!r.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=n})(Mf)),Mf}var zy;function KH(){return zy||(zy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GH(),r=qH(),s=ng();function n(i,o,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const d=(h,p)=>{let x=h;for(let g=0;g<p.length&&x!=null;++g)x=x[p[g]];return x},u=(h,p)=>p==null||h==null?p:typeof h=="object"&&"key"in h?Object.hasOwn(p,h.key)?p[h.key]:d(p,h.path):typeof h=="function"?h(p):Array.isArray(h)?d(p,h):typeof p=="object"?p[h]:p,m=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:s.toPath(h)}));return i.map(h=>({original:h,criteria:m.map(p=>u(p,h))})).slice().sort((h,p)=>{for(let x=0;x<m.length;x++){const g=t.compareValues(h.criteria[x],p.criteria[x],l[x]);if(g!==0)return g}return 0}).map(h=>h.original)}e.orderBy=n})(Ff)),Ff}var $f={},Uy;function YH(){return Uy||(Uy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s=1){const n=[],i=Math.floor(s),o=(l,c)=>{for(let d=0;d<l.length;d++){const u=l[d];Array.isArray(u)&&c<i?o(u,c+1):n.push(u)}};return o(r,0),n}e.flatten=t})($f)),$f}var zf={},Wy;function OT(){return Wy||(Wy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CT(),r=xg(),s=jT(),n=ST();function i(o,l,c){return s.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?n.eq(c[l],o):!1}e.isIterateeCall=i})(zf)),zf}var Hy;function XH(){return Hy||(Hy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KH(),r=YH(),s=OT();function n(i,...o){const l=o.length;return l>1&&s.isIterateeCall(i,o[0],o[1])?o=[]:l>2&&s.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,r.flatten(o),["asc"])}e.sortBy=n})(Rf)),Rf}var Uf,Vy;function JH(){return Vy||(Vy=1,Uf=XH().sortBy),Uf}var ZH=JH();const Gu=zn(ZH);var DT=e=>e.legend.settings,QH=e=>e.legend.size,eV=e=>e.legend.payload,tV=ve([eV,DT],(e,t)=>{var{itemSorter:r}=t,s=e.flat(1);return r?Gu(s,r):s});function rV(){return Xe(tV)}var Zc=1;function IT(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=b.useState({height:0,left:0,top:0,width:0}),s=b.useCallback(n=>{if(n!=null){var i=n.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>Zc||Math.abs(o.left-t.left)>Zc||Math.abs(o.top-t.top)>Zc||Math.abs(o.width-t.width)>Zc)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,s]}function Qr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var sV=typeof Symbol=="function"&&Symbol.observable||"@@observable",Gy=sV,Wf=()=>Math.random().toString(36).substring(7).split("").join("."),aV={INIT:`@@redux/INIT${Wf()}`,REPLACE:`@@redux/REPLACE${Wf()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Wf()}`},Hd=aV;function bg(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function RT(e,t,r){if(typeof e!="function")throw new Error(Qr(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Qr(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Qr(1));return r(RT)(e,t)}let s=e,n=t,i=new Map,o=i,l=0,c=!1;function d(){o===i&&(o=new Map,i.forEach((g,v)=>{o.set(v,g)}))}function u(){if(c)throw new Error(Qr(3));return n}function m(g){if(typeof g!="function")throw new Error(Qr(4));if(c)throw new Error(Qr(5));let v=!0;d();const w=l++;return o.set(w,g),function(){if(v){if(c)throw new Error(Qr(6));v=!1,d(),o.delete(w),i=null}}}function f(g){if(!bg(g))throw new Error(Qr(7));if(typeof g.type>"u")throw new Error(Qr(8));if(typeof g.type!="string")throw new Error(Qr(17));if(c)throw new Error(Qr(9));try{c=!0,n=s(n,g)}finally{c=!1}return(i=o).forEach(w=>{w()}),g}function h(g){if(typeof g!="function")throw new Error(Qr(10));s=g,f({type:Hd.REPLACE})}function p(){const g=m;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(Qr(11));function w(){const S=v;S.next&&S.next(u())}return w(),{unsubscribe:g(w)}},[Gy](){return this}}}return f({type:Hd.INIT}),{dispatch:f,subscribe:m,getState:u,replaceReducer:h,[Gy]:p}}function nV(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Hd.INIT})>"u")throw new Error(Qr(12));if(typeof r(void 0,{type:Hd.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Qr(13))})}function FT(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}const s=Object.keys(r);let n;try{nV(r)}catch(i){n=i}return function(o={},l){if(n)throw n;let c=!1;const d={};for(let u=0;u<s.length;u++){const m=s[u],f=r[m],h=o[m],p=f(h,l);if(typeof p>"u")throw l&&l.type,new Error(Qr(14));d[m]=p,c=c||p!==h}return c=c||s.length!==Object.keys(o).length,c?d:o}}function Vd(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...s)=>t(r(...s)))}function iV(...e){return t=>(r,s)=>{const n=t(r,s);let i=()=>{throw new Error(Qr(15))};const o={getState:n.getState,dispatch:(c,...d)=>i(c,...d)},l=e.map(c=>c(o));return i=Vd(...l)(n.dispatch),{...n,dispatch:i}}}function LT(e){return bg(e)&&"type"in e&&typeof e.type=="string"}var MT=Symbol.for("immer-nothing"),qy=Symbol.for("immer-draftable"),Zs=Symbol.for("immer-state");function Ta(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var yo=Object.getPrototypeOf;function Pi(e){return!!e&&!!e[Zs]}function un(e){return e?BT(e)||Array.isArray(e)||!!e[qy]||!!e.constructor?.[qy]||bc(e)||Ku(e):!1}var oV=Object.prototype.constructor.toString();function BT(e){if(!e||typeof e!="object")return!1;const t=yo(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===oV}function Gd(e,t){qu(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,s)=>t(s,r,e))}function qu(e){const t=e[Zs];return t?t.type_:Array.isArray(e)?1:bc(e)?2:Ku(e)?3:0}function gp(e,t){return qu(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function $T(e,t,r){const s=qu(e);s===2?e.set(t,r):s===3?e.add(r):e[t]=r}function lV(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function bc(e){return e instanceof Map}function Ku(e){return e instanceof Set}function ri(e){return e.copy_||e.base_}function vp(e,t){if(bc(e))return new Map(e);if(Ku(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=BT(e);if(t===!0||t==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(e);delete s[Zs];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const o=n[i],l=s[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(s[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(yo(e),s)}else{const s=yo(e);if(s!==null&&r)return{...e};const n=Object.create(s);return Object.assign(n,e)}}function yg(e,t=!1){return Yu(e)||Pi(e)||!un(e)||(qu(e)>1&&Object.defineProperties(e,{set:{value:Qc},add:{value:Qc},clear:{value:Qc},delete:{value:Qc}}),Object.freeze(e),t&&Object.values(e).forEach(r=>yg(r,!0))),e}function Qc(){Ta(2)}function Yu(e){return Object.isFrozen(e)}var cV={};function Oi(e){const t=cV[e];return t||Ta(0,e),t}var Vl;function zT(){return Vl}function dV(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ky(e,t){t&&(Oi("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function bp(e){yp(e),e.drafts_.forEach(uV),e.drafts_=null}function yp(e){e===Vl&&(Vl=e.parent_)}function Yy(e){return Vl=dV(Vl,e)}function uV(e){const t=e[Zs];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Xy(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Zs].modified_&&(bp(t),Ta(4)),un(e)&&(e=qd(t,e),t.parent_||Kd(t,e)),t.patches_&&Oi("Patches").generateReplacementPatches_(r[Zs].base_,e,t.patches_,t.inversePatches_)):e=qd(t,r,[]),bp(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==MT?e:void 0}function qd(e,t,r){if(Yu(t))return t;const s=t[Zs];if(!s)return Gd(t,(n,i)=>Jy(e,s,t,n,i,r)),t;if(s.scope_!==e)return t;if(!s.modified_)return Kd(e,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const n=s.copy_;let i=n,o=!1;s.type_===3&&(i=new Set(n),n.clear(),o=!0),Gd(i,(l,c)=>Jy(e,s,n,l,c,r,o)),Kd(e,n,!1),r&&e.patches_&&Oi("Patches").generatePatches_(s,r,e.patches_,e.inversePatches_)}return s.copy_}function Jy(e,t,r,s,n,i,o){if(Pi(n)){const l=i&&t&&t.type_!==3&&!gp(t.assigned_,s)?i.concat(s):void 0,c=qd(e,n,l);if($T(r,s,c),Pi(c))e.canAutoFreeze_=!1;else return}else o&&r.add(n);if(un(n)&&!Yu(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;qd(e,n),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&(bc(r)?r.has(s):Object.prototype.propertyIsEnumerable.call(r,s))&&Kd(e,n)}}function Kd(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&yg(t,r)}function mV(e,t){const r=Array.isArray(e),s={type_:r?1:0,scope_:t?t.scope_:zT(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=wg;r&&(n=[s],i=Gl);const{revoke:o,proxy:l}=Proxy.revocable(n,i);return s.draft_=l,s.revoke_=o,l}var wg={get(e,t){if(t===Zs)return e;const r=ri(e);if(!gp(r,t))return fV(e,r,t);const s=r[t];return e.finalized_||!un(s)?s:s===Hf(e.base_,t)?(Vf(e),e.copy_[t]=jp(s,e)):s},has(e,t){return t in ri(e)},ownKeys(e){return Reflect.ownKeys(ri(e))},set(e,t,r){const s=UT(ri(e),t);if(s?.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const n=Hf(ri(e),t),i=n?.[Zs];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(lV(r,n)&&(r!==void 0||gp(e.base_,t)))return!0;Vf(e),wp(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Hf(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Vf(e),wp(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=ri(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:r[t]}},defineProperty(){Ta(11)},getPrototypeOf(e){return yo(e.base_)},setPrototypeOf(){Ta(12)}},Gl={};Gd(wg,(e,t)=>{Gl[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Gl.deleteProperty=function(e,t){return Gl.set.call(this,e,t,void 0)};Gl.set=function(e,t,r){return wg.set.call(this,e[0],t,r,e[0])};function Hf(e,t){const r=e[Zs];return(r?ri(r):e)[t]}function fV(e,t,r){const s=UT(t,r);return s?"value"in s?s.value:s.get?.call(e.draft_):void 0}function UT(e,t){if(!(t in e))return;let r=yo(e);for(;r;){const s=Object.getOwnPropertyDescriptor(r,t);if(s)return s;r=yo(r)}}function wp(e){e.modified_||(e.modified_=!0,e.parent_&&wp(e.parent_))}function Vf(e){e.copy_||(e.copy_=vp(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var hV=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,s)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(c=i,...d){return o.produce(c,u=>r.call(this,u,...d))}}typeof r!="function"&&Ta(6),s!==void 0&&typeof s!="function"&&Ta(7);let n;if(un(t)){const i=Yy(this),o=jp(t,void 0);let l=!0;try{n=r(o),l=!1}finally{l?bp(i):yp(i)}return Ky(i,s),Xy(n,i)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===MT&&(n=void 0),this.autoFreeze_&&yg(n,!0),s){const i=[],o=[];Oi("Patches").generateReplacementPatches_(t,n,i,o),s(i,o)}return n}else Ta(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let s,n;return[this.produce(t,r,(o,l)=>{s=o,n=l}),s,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){un(e)||Ta(8),Pi(e)&&(e=an(e));const t=Yy(this),r=jp(e,void 0);return r[Zs].isManual_=!0,yp(t),r}finishDraft(e,t){const r=e&&e[Zs];(!r||!r.isManual_)&&Ta(9);const{scope_:s}=r;return Ky(s,t),Xy(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const s=Oi("Patches").applyPatches_;return Pi(e)?s(e,t):this.produce(e,n=>s(n,t))}};function jp(e,t){const r=bc(e)?Oi("MapSet").proxyMap_(e,t):Ku(e)?Oi("MapSet").proxySet_(e,t):mV(e,t);return(t?t.scope_:zT()).drafts_.push(r),r}function an(e){return Pi(e)||Ta(10,e),WT(e)}function WT(e){if(!un(e)||Yu(e))return e;const t=e[Zs];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=vp(e,t.scope_.immer_.useStrictShallowCopy_)}else r=vp(e,!0);return Gd(r,(s,n)=>{$T(r,s,WT(n))}),t&&(t.finalized_=!1),r}var pV=new hV,HT=pV.produce;function VT(e){return({dispatch:r,getState:s})=>n=>i=>typeof i=="function"?i(r,s,e):n(i)}var xV=VT(),gV=VT,vV=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Vd:Vd.apply(null,arguments)};function va(e,t){function r(...s){if(t){let n=t(...s);if(!n)throw new Error(Ys(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:s[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=s=>LT(s)&&s.type===e,r}var GT=class ul extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,ul.prototype)}static get[Symbol.species](){return ul}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new ul(...t[0].concat(this)):new ul(...t.concat(this))}};function Zy(e){return un(e)?HT(e,()=>{}):e}function ed(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function bV(e){return typeof e=="boolean"}var yV=()=>function(t){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=t??{};let o=new GT;return r&&(bV(r)?o.push(xV):o.push(gV(r.extraArgument))),o},wV="RTK_autoBatch",Qy=e=>t=>{setTimeout(t,e)},jV=(e={type:"raf"})=>t=>(...r)=>{const s=t(...r);let n=!0,i=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Qy(10):e.type==="callback"?e.queueNotification:Qy(e.timeout),d=()=>{o=!1,i&&(i=!1,l.forEach(u=>u()))};return Object.assign({},s,{subscribe(u){const m=()=>n&&u(),f=s.subscribe(m);return l.add(u),()=>{f(),l.delete(u)}},dispatch(u){try{return n=!u?.meta?.[wV],i=!n,i&&(o||(o=!0,c(d))),s.dispatch(u)}finally{n=!0}}})},NV=e=>function(r){const{autoBatch:s=!0}=r??{};let n=new GT(e);return s&&n.push(jV(typeof s=="object"?s:void 0)),n};function SV(e){const t=yV(),{reducer:r=void 0,middleware:s,devTools:n=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(bg(r))l=FT(r);else throw new Error(Ys(1));let c;typeof s=="function"?c=s(t):c=t();let d=Vd;n&&(d=vV({trace:!1,...typeof n=="object"&&n}));const u=iV(...c),m=NV(u);let f=typeof o=="function"?o(m):m();const h=d(...f);return RT(l,i,h)}function qT(e){const t={},r=[];let s;const n={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Ys(28));if(l in t)throw new Error(Ys(29));return t[l]=o,n},addAsyncThunk(i,o){return o.pending&&(t[i.pending.type]=o.pending),o.rejected&&(t[i.rejected.type]=o.rejected),o.fulfilled&&(t[i.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:i.settled,reducer:o.settled}),n},addMatcher(i,o){return r.push({matcher:i,reducer:o}),n},addDefaultCase(i){return s=i,n}};return e(n),[t,r,s]}function EV(e){return typeof e=="function"}function TV(e,t){let[r,s,n]=qT(t),i;if(EV(e))i=()=>Zy(e());else{const l=Zy(e);i=()=>l}function o(l=i(),c){let d=[r[c.type],...s.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[n]),d.reduce((u,m)=>{if(m)if(Pi(u)){const h=m(u,c);return h===void 0?u:h}else{if(un(u))return HT(u,f=>m(f,c));{const f=m(u,c);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},l)}return o.getInitialState=i,o}var AV="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",CV=(e=21)=>{let t="",r=e;for(;r--;)t+=AV[Math.random()*64|0];return t},_V=Symbol.for("rtk-slice-createasyncthunk");function kV(e,t){return`${e}/${t}`}function PV({creators:e}={}){const t=e?.asyncThunk?.[_V];return function(s){const{name:n,reducerPath:i=n}=s;if(!n)throw new Error(Ys(11));const o=(typeof s.reducers=="function"?s.reducers(DV()):s.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(y,S){const E=typeof y=="string"?y:y.type;if(!E)throw new Error(Ys(12));if(E in c.sliceCaseReducersByType)throw new Error(Ys(13));return c.sliceCaseReducersByType[E]=S,d},addMatcher(y,S){return c.sliceMatchers.push({matcher:y,reducer:S}),d},exposeAction(y,S){return c.actionCreators[y]=S,d},exposeCaseReducer(y,S){return c.sliceCaseReducersByName[y]=S,d}};l.forEach(y=>{const S=o[y],E={reducerName:y,type:kV(n,y),createNotation:typeof s.reducers=="function"};RV(S)?LV(E,S,d,t):IV(E,S,d)});function u(){const[y={},S=[],E=void 0]=typeof s.extraReducers=="function"?qT(s.extraReducers):[s.extraReducers],N={...y,...c.sliceCaseReducersByType};return TV(s.initialState,j=>{for(let T in N)j.addCase(T,N[T]);for(let T of c.sliceMatchers)j.addMatcher(T.matcher,T.reducer);for(let T of S)j.addMatcher(T.matcher,T.reducer);E&&j.addDefaultCase(E)})}const m=y=>y,f=new Map,h=new WeakMap;let p;function x(y,S){return p||(p=u()),p(y,S)}function g(){return p||(p=u()),p.getInitialState()}function v(y,S=!1){function E(j){let T=j[y];return typeof T>"u"&&S&&(T=ed(h,E,g)),T}function N(j=m){const T=ed(f,S,()=>new WeakMap);return ed(T,j,()=>{const C={};for(const[L,A]of Object.entries(s.selectors??{}))C[L]=OV(A,j,()=>ed(h,j,g),S);return C})}return{reducerPath:y,getSelectors:N,get selectors(){return N(E)},selectSlice:E}}const w={name:n,reducer:x,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,...v(i),injectInto(y,{reducerPath:S,...E}={}){const N=S??i;return y.inject({reducerPath:N,reducer:x},E),{...w,...v(N,!0)}}};return w}}function OV(e,t,r,s){function n(i,...o){let l=t(i);return typeof l>"u"&&s&&(l=r()),e(l,...o)}return n.unwrapped=e,n}var ea=PV();function DV(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function IV({type:e,reducerName:t,createNotation:r},s,n){let i,o;if("reducer"in s){if(r&&!FV(s))throw new Error(Ys(17));i=s.reducer,o=s.prepare}else i=s;n.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?va(e,o):va(e))}function RV(e){return e._reducerDefinitionType==="asyncThunk"}function FV(e){return e._reducerDefinitionType==="reducerWithPrepare"}function LV({type:e,reducerName:t},r,s,n){if(!n)throw new Error(Ys(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=r,m=n(e,i,u);s.exposeAction(t,m),o&&s.addCase(m.fulfilled,o),l&&s.addCase(m.pending,l),c&&s.addCase(m.rejected,c),d&&s.addMatcher(m.settled,d),s.exposeCaseReducer(t,{fulfilled:o||td,pending:l||td,rejected:c||td,settled:d||td})}function td(){}var MV="task",KT="listener",YT="completed",jg="cancelled",BV=`task-${jg}`,$V=`task-${YT}`,Np=`${KT}-${jg}`,zV=`${KT}-${YT}`,Xu=class{constructor(e){this.code=e,this.message=`${MV} ${jg} (reason: ${e})`}name="TaskAbortError";message},Ng=(e,t)=>{if(typeof e!="function")throw new TypeError(Ys(32))},Yd=()=>{},XT=(e,t=Yd)=>(e.catch(t),e),JT=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),gi=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},vi=e=>{if(e.aborted){const{reason:t}=e;throw new Xu(t)}};function ZT(e,t){let r=Yd;return new Promise((s,n)=>{const i=()=>n(new Xu(e.reason));if(e.aborted){i();return}r=JT(e,i),t.finally(()=>r()).then(s,n)}).finally(()=>{r=Yd})}var UV=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Xu?"cancelled":"rejected",error:r}}finally{t?.()}},Xd=e=>t=>XT(ZT(e,t).then(r=>(vi(e),r))),QT=e=>{const t=Xd(e);return r=>t(new Promise(s=>setTimeout(s,r)))},{assign:uo}=Object,ew={},Ju="listenerMiddleware",WV=(e,t)=>{const r=s=>JT(e,()=>gi(s,e.reason));return(s,n)=>{Ng(s);const i=new AbortController;r(i);const o=UV(async()=>{vi(e),vi(i.signal);const l=await s({pause:Xd(i.signal),delay:QT(i.signal),signal:i.signal});return vi(i.signal),l},()=>gi(i,$V));return n?.autoJoin&&t.push(o.catch(Yd)),{result:Xd(e)(o),cancel(){gi(i,BV)}}}},HV=(e,t)=>{const r=async(s,n)=>{vi(t);let i=()=>{};const l=[new Promise((c,d)=>{let u=e({predicate:s,effect:(m,f)=>{f.unsubscribe(),c([m,f.getState(),f.getOriginalState()])}});i=()=>{u(),d()}})];n!=null&&l.push(new Promise(c=>setTimeout(c,n,null)));try{const c=await ZT(t,Promise.race(l));return vi(t),c}finally{i()}};return(s,n)=>XT(r(s,n))},eA=e=>{let{type:t,actionCreator:r,matcher:s,predicate:n,effect:i}=e;if(t)n=va(t).match;else if(r)t=r.type,n=r.match;else if(s)n=s;else if(!n)throw new Error(Ys(21));return Ng(i),{predicate:n,type:t,effect:i}},tA=uo(e=>{const{type:t,predicate:r,effect:s}=eA(e);return{id:CV(),effect:s,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Ys(22))}}},{withTypes:()=>tA}),tw=(e,t)=>{const{type:r,effect:s,predicate:n}=eA(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===s)},Sp=e=>{e.pending.forEach(t=>{gi(t,Np)})},VV=e=>()=>{e.forEach(Sp),e.clear()},rw=(e,t,r)=>{try{e(t,r)}catch(s){setTimeout(()=>{throw s},0)}},rA=uo(va(`${Ju}/add`),{withTypes:()=>rA}),GV=va(`${Ju}/removeAll`),sA=uo(va(`${Ju}/remove`),{withTypes:()=>sA}),qV=(...e)=>{console.error(`${Ju}/error`,...e)},yc=(e={})=>{const t=new Map,{extra:r,onError:s=qV}=e;Ng(s);const n=u=>(u.unsubscribe=()=>t.delete(u.id),t.set(u.id,u),m=>{u.unsubscribe(),m?.cancelActive&&Sp(u)}),i=u=>{const m=tw(t,u)??tA(u);return n(m)};uo(i,{withTypes:()=>i});const o=u=>{const m=tw(t,u);return m&&(m.unsubscribe(),u.cancelActive&&Sp(m)),!!m};uo(o,{withTypes:()=>o});const l=async(u,m,f,h)=>{const p=new AbortController,x=HV(i,p.signal),g=[];try{u.pending.add(p),await Promise.resolve(u.effect(m,uo({},f,{getOriginalState:h,condition:(v,w)=>x(v,w).then(Boolean),take:x,delay:QT(p.signal),pause:Xd(p.signal),extra:r,signal:p.signal,fork:WV(p.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{t.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((v,w,y)=>{v!==p&&(gi(v,Np),y.delete(v))})},cancel:()=>{gi(p,Np),u.pending.delete(p)},throwIfCancelled:()=>{vi(p.signal)}})))}catch(v){v instanceof Xu||rw(s,v,{raisedBy:"effect"})}finally{await Promise.all(g),gi(p,zV),u.pending.delete(p)}},c=VV(t);return{middleware:u=>m=>f=>{if(!LT(f))return m(f);if(rA.match(f))return i(f.payload);if(GV.match(f)){c();return}if(sA.match(f))return o(f.payload);let h=u.getState();const p=()=>{if(h===ew)throw new Error(Ys(23));return h};let x;try{if(x=m(f),t.size>0){const g=u.getState(),v=Array.from(t.values());for(const w of v){let y=!1;try{y=w.predicate(f,g,h)}catch(S){y=!1,rw(s,S,{raisedBy:"predicate"})}y&&l(w,f,u,p)}}}finally{h=ew}return x},startListening:i,stopListening:o,clearListeners:c}};function Ys(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var KV={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},aA=ea({name:"chartLayout",initialState:KV,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,s,n,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(s=t.payload.right)!==null&&s!==void 0?s:0,e.margin.bottom=(n=t.payload.bottom)!==null&&n!==void 0?n:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:YV,setLayout:XV,setChartSize:JV,setScale:ZV}=aA.actions,QV=aA.reducer;function sw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function aw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sw(Object(r),!0).forEach(function(s){eG(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function eG(e,t,r){return(t=tG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tG(e){var t=rG(e,"string");return typeof t=="symbol"?t:t+""}function rG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jd=Math.PI/180,sG=e=>e*180/Math.PI,Ir=(e,t,r,s)=>({x:e+Math.cos(-Jd*s)*r,y:t+Math.sin(-Jd*s)*r}),nA=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(r-(s.top||0)-(s.bottom||0)))/2},aG=(e,t)=>{var{x:r,y:s}=e,{x:n,y:i}=t;return Math.sqrt((r-n)**2+(s-i)**2)},nG=(e,t)=>{var{x:r,y:s}=e,{cx:n,cy:i}=t,o=aG({x:r,y:s},{x:n,y:i});if(o<=0)return{radius:o,angle:0};var l=(r-n)/o,c=Math.acos(l);return s>i&&(c=2*Math.PI-c),{radius:o,angle:sG(c),angleInRadian:c}},iG=e=>{var{startAngle:t,endAngle:r}=e,s=Math.floor(t/360),n=Math.floor(r/360),i=Math.min(s,n);return{startAngle:t-i*360,endAngle:r-i*360}},oG=(e,t)=>{var{startAngle:r,endAngle:s}=t,n=Math.floor(r/360),i=Math.floor(s/360),o=Math.min(n,i);return e+o*360},lG=(e,t)=>{var{x:r,y:s}=e,{radius:n,angle:i}=nG({x:r,y:s},t),{innerRadius:o,outerRadius:l}=t;if(n<o||n>l||n===0)return null;var{startAngle:c,endAngle:d}=iG(t),u=i,m;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;m=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;m=u>=d&&u<=c}return m?aw(aw({},t),{},{radius:n,angle:oG(u,t)}):null};function iA(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function nw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ua(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nw(Object(r),!0).forEach(function(s){cG(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function cG(e,t,r){return(t=dG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dG(e){var t=uG(e,"string");return typeof t=="symbol"?t:t+""}function uG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hr(e,t,r){return Yr(e)||Yr(t)?r:Va(t)?ki(e,t,r):typeof t=="function"?t(e):r}var mG=(e,t,r,s,n)=>{var i,o=-1,l=(i=t?.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(s==="angleAxis"&&n!=null&&Math.abs(Math.abs(n[1]-n[0])-360)<=1e-6)for(var c=0;c<l;c++){var d=c>0?r[c-1].coordinate:r[l-1].coordinate,u=r[c].coordinate,m=c>=l-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(Kr(u-d)!==Kr(m-u)){var h=[];if(Kr(m-u)===Kr(n[1]-n[0])){f=m;var p=u+n[1]-n[0];h[0]=Math.min(p,(p+d)/2),h[1]=Math.max(p,(p+d)/2)}else{f=d;var x=m+n[1]-n[0];h[0]=Math.min(u,(x+u)/2),h[1]=Math.max(u,(x+u)/2)}var g=[Math.min(u,(f+u)/2),Math.max(u,(f+u)/2)];if(e>g[0]&&e<=g[1]||e>=h[0]&&e<=h[1]){({index:o}=r[c]);break}}else{var v=Math.min(d,m),w=Math.max(d,m);if(e>(v+u)/2&&e<=(w+u)/2){({index:o}=r[c]);break}}}else if(t){for(var y=0;y<l;y++)if(y===0&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y>0&&y<l-1&&e>(t[y].coordinate+t[y-1].coordinate)/2&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y===l-1&&e>(t[y].coordinate+t[y-1].coordinate)/2){({index:o}=t[y]);break}}return o},fG=(e,t,r)=>{if(t&&r){var{width:s,height:n}=r,{align:i,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&i!=="center"&&tt(e[i]))return ua(ua({},e),{},{[i]:e[i]+(s||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&o!=="middle"&&tt(e[o]))return ua(ua({},e),{},{[o]:e[o]+(n||0)})}return e},Vi=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",oA=(e,t,r,s)=>{if(s)return e.map(l=>l.coordinate);var n,i,o=e.map(l=>(l.coordinate===t&&(n=!0),l.coordinate===r&&(i=!0),l.coordinate));return n||o.push(t),i||o.push(r),o},lA=(e,t,r)=>{if(!e)return null;var{duplicateDomain:s,type:n,range:i,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:d,tickCount:u,ticks:m,niceTicks:f,axisType:h}=e;if(!o)return null;var p=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,x=n==="category"&&o.bandwidth?o.bandwidth()/p:0;if(x=h==="angleAxis"&&i&&i.length>=2?Kr(i[0]-i[1])*2*x:x,m||f){var g=(m||f||[]).map((v,w)=>{var y=s?s.indexOf(v):v;return{coordinate:o(y)+x,value:v,offset:x,index:w}});return g.filter(v=>!Js(v.coordinate))}return c&&d?d.map((v,w)=>({coordinate:o(v)+x,value:v,index:w,offset:x})):o.ticks&&u!=null?o.ticks(u).map((v,w)=>({coordinate:o(v)+x,value:v,offset:x,index:w})):o.domain().map((v,w)=>({coordinate:o(v)+x,value:s?s[v]:v,index:w,offset:x}))},iw=1e-4,hG=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,s=e.range(),n=Math.min(s[0],s[1])-iw,i=Math.max(s[0],s[1])+iw,o=e(t[0]),l=e(t[r-1]);(o<n||o>i||l<n||l>i)&&e.domain([t[0],t[r-1]])}},pG=(e,t)=>{if(!t||t.length!==2||!tt(t[0])||!tt(t[1]))return e;var r=Math.min(t[0],t[1]),s=Math.max(t[0],t[1]),n=[e[0],e[1]];return(!tt(e[0])||e[0]<r)&&(n[0]=r),(!tt(e[1])||e[1]>s)&&(n[1]=s),n[0]>s&&(n[0]=s),n[1]<r&&(n[1]=r),n},xG=e=>{var t=e.length;if(!(t<=0))for(var r=0,s=e[0].length;r<s;++r)for(var n=0,i=0,o=0;o<t;++o){var l=Js(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=n,e[o][r][1]=n+l,n=e[o][r][1]):(e[o][r][0]=i,e[o][r][1]=i+l,i=e[o][r][1])}},gG=e=>{var t=e.length;if(!(t<=0))for(var r=0,s=e[0].length;r<s;++r)for(var n=0,i=0;i<t;++i){var o=Js(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=n,e[i][r][1]=n+o,n=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},vG={sign:xG,expand:qW,none:bo,silhouette:KW,wiggle:YW,positive:gG},bG=(e,t,r)=>{var s=vG[r],n=GW().keys(t).value((i,o)=>+hr(i,o,0)).order(hp).offset(s);return n(e)};function yG(e){return e==null?void 0:String(e)}var ow=e=>{var{axis:t,ticks:r,offset:s,bandSize:n,entry:i,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+s:null;var l=hr(i,t.dataKey,t.scale.domain()[o]);return Yr(l)?null:t.scale(l)-n/2+s},wG=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var s=Math.min(r[0],r[1]),n=Math.max(r[0],r[1]);return s<=0&&n>=0?0:n<0?n:s}return r[0]},jG=e=>{var t=e.flat(2).filter(tt);return[Math.min(...t),Math.max(...t)]},NG=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],SG=(e,t,r)=>{if(e!=null)return NG(Object.keys(e).reduce((s,n)=>{var i=e[n],{stackedData:o}=i,l=o.reduce((c,d)=>{var u=iA(d,t,r),m=jG(u);return[Math.min(c[0],m[0]),Math.max(c[1],m[1])]},[1/0,-1/0]);return[Math.min(l[0],s[0]),Math.max(l[1],s[1])]},[1/0,-1/0]))},lw=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cw=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Sg=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!r||s>0)return s}if(e&&t&&t.length>=2){for(var n=Gu(t,u=>u.coordinate),i=1/0,o=1,l=n.length;o<l;o++){var c=n[o],d=n[o-1];i=Math.min((c.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function dw(e){var{tooltipEntrySettings:t,dataKey:r,payload:s,value:n,name:i}=e;return ua(ua({},t),{},{dataKey:r,payload:s,value:n,name:i})}function Zu(e,t){if(e)return String(e);if(typeof t=="string")return t}function EG(e,t,r,s,n){if(r==="horizontal"||r==="vertical"){var i=e>=n.left&&e<=n.left+n.width&&t>=n.top&&t<=n.top+n.height;return i?{x:e,y:t}:null}return s?lG({x:e,y:t},s):null}var TG=(e,t,r,s)=>{var n=t.find(d=>d&&d.index===r);if(n){if(e==="horizontal")return{x:n.coordinate,y:s.y};if(e==="vertical")return{x:s.x,y:n.coordinate};if(e==="centric"){var i=n.coordinate,{radius:o}=s;return ua(ua(ua({},s),Ir(s.cx,s.cy,o,i)),{},{angle:i,radius:o})}var l=n.coordinate,{angle:c}=s;return ua(ua(ua({},s),Ir(s.cx,s.cy,l,c)),{},{angle:c,radius:l})}return{x:0,y:0}},AG=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,vn=e=>e.layout.width,bn=e=>e.layout.height,CG=e=>e.layout.scale,cA=e=>e.layout.margin,Qu=ve(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),em=ve(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),dA="data-recharts-item-index",uA="data-recharts-item-data-key",wc=60;function uw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function rd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uw(Object(r),!0).forEach(function(s){_G(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function _G(e,t,r){return(t=kG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kG(e){var t=PG(e,"string");return typeof t=="symbol"?t:t+""}function PG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OG=e=>e.brush.height;function DG(e){var t=em(e);return t.reduce((r,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var n=typeof s.width=="number"?s.width:wc;return r+n}return r},0)}function IG(e){var t=em(e);return t.reduce((r,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var n=typeof s.width=="number"?s.width:wc;return r+n}return r},0)}function RG(e){var t=Qu(e);return t.reduce((r,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?r+s.height:r,0)}function FG(e){var t=Qu(e);return t.reduce((r,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?r+s.height:r,0)}var zr=ve([vn,bn,cA,OG,DG,IG,RG,FG,DT,QH],(e,t,r,s,n,i,o,l,c,d)=>{var u={left:(r.left||0)+n,right:(r.right||0)+i},m={top:(r.top||0)+o,bottom:(r.bottom||0)+l},f=rd(rd({},m),u),h=f.bottom;f.bottom+=s,f=fG(f,c,d);var p=e-f.left-f.right,x=t-f.top-f.bottom;return rd(rd({brushBottom:h},f),{},{width:Math.max(p,0),height:Math.max(x,0)})}),LG=ve(zr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Eg=ve(vn,bn,(e,t)=>({x:0,y:0,width:e,height:t})),MG=b.createContext(null),wa=()=>b.useContext(MG)!=null,tm=e=>e.brush,rm=ve([tm,zr,cA],(e,t,r)=>({height:e.height,x:tt(e.x)?e.x:t.left,y:tt(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:tt(e.width)?e.width:t.width})),Tg=()=>{var e,t=wa(),r=Xe(LG),s=Xe(rm),n=(e=Xe(tm))===null||e===void 0?void 0:e.padding;return!t||!s||!n?r:{width:s.width-n.left-n.right,height:s.height-n.top-n.bottom,x:n.left,y:n.top}},BG={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},mA=()=>{var e;return(e=Xe(zr))!==null&&e!==void 0?e:BG},Ag=()=>Xe(vn),Cg=()=>Xe(bn),$G=()=>Xe(e=>e.layout.margin),Dt=e=>e.layout.layoutType,_g=()=>Xe(Dt),zG={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},fA=ea({name:"legend",initialState:zG,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=an(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:mw,setLegendSettings:UG,addLegendPayload:hA,removeLegendPayload:pA}=fA.actions,WG=fA.reducer,HG=["contextPayload"];function Ep(){return Ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ep.apply(null,arguments)}function fw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function wo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fw(Object(r),!0).forEach(function(s){kg(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function kg(e,t,r){return(t=VG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VG(e){var t=GG(e,"string");return typeof t=="symbol"?t:t+""}function GG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qG(e,t){if(e==null)return{};var r,s,n=KG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function KG(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function YG(e){return e.value}function XG(e){var{contextPayload:t}=e,r=qG(e,HG),s=_T(t,e.payloadUniqBy,YG),n=wo(wo({},r),{},{payload:s});return b.isValidElement(e.content)?b.cloneElement(e.content,n):typeof e.content=="function"?b.createElement(e.content,n):b.createElement(pg,n)}function JG(e,t,r,s,n,i){var{layout:o,align:l,verticalAlign:c}=t,d,u;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?d={left:((s||0)-i.width)/2}:d=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?u={top:((n||0)-i.height)/2}:u=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),wo(wo({},d),u)}function ZG(e){var t=gr();return b.useEffect(()=>{t(UG(e))},[t,e]),null}function QG(e){var t=gr();return b.useEffect(()=>(t(mw(e)),()=>{t(mw({width:0,height:0}))}),[t,e]),null}function eq(e){var t=rV(),r=xW(),s=$G(),{width:n,height:i,wrapperStyle:o,portal:l}=e,[c,d]=IT([t]),u=Ag(),m=Cg();if(u==null||m==null)return null;var f=u-(s.left||0)-(s.right||0),h=li.getWidthOrHeight(e.layout,i,n,f),p=l?o:wo(wo({position:"absolute",width:h?.width||n||"auto",height:h?.height||i||"auto"},JG(o,e,s,u,m,c)),o),x=l??r;if(x==null)return null;var g=b.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},b.createElement(ZG,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),b.createElement(QG,{width:c.width,height:c.height}),b.createElement(XG,Ep({},e,h,{margin:s,chartWidth:u,chartHeight:m,contextPayload:t})));return rx.createPortal(g,x)}class li extends b.PureComponent{static getWidthOrHeight(t,r,s,n){return t==="vertical"&&tt(r)?{height:r}:t==="horizontal"?{width:s||n}:null}render(){return b.createElement(eq,this.props)}}kg(li,"displayName","Legend");kg(li,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Tp(){return Tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Tp.apply(null,arguments)}function hw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Gf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hw(Object(r),!0).forEach(function(s){tq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function tq(e,t,r){return(t=rq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rq(e){var t=sq(e,"string");return typeof t=="symbol"?t:t+""}function sq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aq(e){return Array.isArray(e)&&Va(e[0])&&Va(e[1])?e.join(" ~ "):e}var nq=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:s={},labelStyle:n={},payload:i,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:m,accessibilityLayer:f=!1}=e,h=()=>{if(i&&i.length){var E={padding:0,margin:0},N=(l?Gu(i,l):i).map((j,T)=>{if(j.type==="none")return null;var C=j.formatter||o||aq,{value:L,name:A}=j,P=L,I=A;if(C){var _=C(L,A,j,T,i);if(Array.isArray(_))[P,I]=_;else if(_!=null)P=_;else return null}var D=Gf({display:"block",paddingTop:4,paddingBottom:4,color:j.color||"#000"},s);return b.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(T),style:D},Va(I)?b.createElement("span",{className:"recharts-tooltip-item-name"},I):null,Va(I)?b.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,b.createElement("span",{className:"recharts-tooltip-item-value"},P),b.createElement("span",{className:"recharts-tooltip-item-unit"},j.unit||""))});return b.createElement("ul",{className:"recharts-tooltip-item-list",style:E},N)}return null},p=Gf({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),x=Gf({margin:0},n),g=!Yr(u),v=g?u:"",w=Et("recharts-default-tooltip",c),y=Et("recharts-tooltip-label",d);g&&m&&i!==void 0&&i!==null&&(v=m(u,i));var S=f?{role:"status","aria-live":"assertive"}:{};return b.createElement("div",Tp({className:w,style:p},S),b.createElement("p",{className:y,style:x},b.isValidElement(v)?v:"".concat(v)),h())},el="recharts-tooltip-wrapper",iq={visibility:"hidden"};function oq(e){var{coordinate:t,translateX:r,translateY:s}=e;return Et(el,{["".concat(el,"-right")]:tt(r)&&t&&tt(t.x)&&r>=t.x,["".concat(el,"-left")]:tt(r)&&t&&tt(t.x)&&r<t.x,["".concat(el,"-bottom")]:tt(s)&&t&&tt(t.y)&&s>=t.y,["".concat(el,"-top")]:tt(s)&&t&&tt(t.y)&&s<t.y})}function pw(e){var{allowEscapeViewBox:t,coordinate:r,key:s,offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:d}=e;if(i&&tt(i[s]))return i[s];var u=r[s]-l-(n>0?n:0),m=r[s]+n;if(t[s])return o[s]?u:m;var f=c[s];if(f==null)return 0;if(o[s]){var h=u,p=f;return h<p?Math.max(m,f):Math.max(u,f)}if(d==null)return 0;var x=m+l,g=f+d;return x>g?Math.max(u,f):Math.max(m,f)}function lq(e){var{translateX:t,translateY:r,useTranslate3d:s}=e;return{transform:s?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function cq(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:s,position:n,reverseDirection:i,tooltipBox:o,useTranslate3d:l,viewBox:c}=e,d,u,m;return o.height>0&&o.width>0&&r?(u=pw({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:s,position:n,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),m=pw({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:s,position:n,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=lq({translateX:u,translateY:m,useTranslate3d:l})):d=iq,{cssProperties:d,cssClasses:oq({translateX:u,translateY:m,coordinate:r})}}function xw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function sd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xw(Object(r),!0).forEach(function(s){Ap(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Ap(e,t,r){return(t=dq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dq(e){var t=uq(e,"string");return typeof t=="symbol"?t:t+""}function uq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class mq extends b.PureComponent{constructor(){super(...arguments),Ap(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Ap(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,s,n,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0,y:(n=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&n!==void 0?n:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:s,animationEasing:n,children:i,coordinate:o,hasPayload:l,isAnimationActive:c,offset:d,position:u,reverseDirection:m,useTranslate3d:f,viewBox:h,wrapperStyle:p,lastBoundingBox:x,innerRef:g,hasPortalFromProps:v}=this.props,{cssClasses:w,cssProperties:y}=cq({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:d,position:u,reverseDirection:m,tooltipBox:{height:x.height,width:x.width},useTranslate3d:f,viewBox:h}),S=v?{}:sd(sd({transition:c&&t?"transform ".concat(s,"ms ").concat(n):void 0},y),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),E=sd(sd({},S),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},p);return b.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:w,style:E,ref:g},i)}}var fq=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Gi={devToolsEnabled:!1,isSsr:fq()},xA=()=>Xe(e=>e.rootProps.accessibilityLayer);function Qs(e){return Number.isFinite(e)}function jo(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Cp.apply(null,arguments)}function gw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gw(Object(r),!0).forEach(function(s){hq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function hq(e,t,r){return(t=pq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pq(e){var t=xq(e,"string");return typeof t=="symbol"?t:t+""}function xq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bw={curveBasisClosed:RW,curveBasisOpen:FW,curveBasis:IW,curveBumpX:yW,curveBumpY:wW,curveLinearClosed:LW,curveLinear:Hu,curveMonotoneX:MW,curveMonotoneY:BW,curveNatural:$W,curveStep:zW,curveStepAfter:WW,curveStepBefore:UW},ad=e=>Qs(e.x)&&Qs(e.y),tl=e=>e.x,rl=e=>e.y,gq=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(gc(e));return(r==="curveMonotone"||r==="curveBump")&&t?bw["".concat(r).concat(t==="vertical"?"Y":"X")]:bw[r]||Hu},vq=e=>{var{type:t="linear",points:r=[],baseLine:s,layout:n,connectNulls:i=!1}=e,o=gq(t,n),l=i?r.filter(ad):r,c;if(Array.isArray(s)){var d=i?s.filter(m=>ad(m)):s,u=l.map((m,f)=>vw(vw({},m),{},{base:d[f]}));return n==="vertical"?c=Xc().y(rl).x1(tl).x0(m=>m.base.x):c=Xc().x(tl).y1(rl).y0(m=>m.base.y),c.defined(ad).curve(o),c(u)}return n==="vertical"&&tt(s)?c=Xc().y(rl).x1(tl).x0(s):tt(s)?c=Xc().x(tl).y1(rl).y0(s):c=cT().x(tl).y(rl),c.defined(ad).curve(o),c(l)},gA=e=>{var{className:t,points:r,path:s,pathRef:n}=e;if((!r||!r.length)&&!s)return null;var i=r&&r.length?vq(e):s;return b.createElement("path",Cp({},Vn(e),iW(e),{className:Et("recharts-curve",t),d:i===null?void 0:i,ref:n}))},bq=["x","y","top","left","width","height","className"];function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_p.apply(null,arguments)}function yw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function yq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yw(Object(r),!0).forEach(function(s){wq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function wq(e,t,r){return(t=jq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jq(e){var t=Nq(e,"string");return typeof t=="symbol"?t:t+""}function Nq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sq(e,t){if(e==null)return{};var r,s,n=Eq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Eq(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Tq=(e,t,r,s,n,i)=>"M".concat(e,",").concat(n,"v").concat(s,"M").concat(i,",").concat(t,"h").concat(r),Aq=e=>{var{x:t=0,y:r=0,top:s=0,left:n=0,width:i=0,height:o=0,className:l}=e,c=Sq(e,bq),d=yq({x:t,y:r,top:s,left:n,width:i,height:o},c);return!tt(t)||!tt(r)||!tt(i)||!tt(o)||!tt(s)||!tt(n)?null:b.createElement("path",_p({},$r(d,!0),{className:Et("recharts-cross",l),d:Tq(t,r,i,o,s,n)}))};function Cq(e,t,r,s){var n=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-n:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-n,width:e==="horizontal"?s:r.width-1,height:e==="horizontal"?r.height-1:s}}function ww(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function _q(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ww(Object(r),!0).forEach(function(s){kq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ww(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function kq(e,t,r){return(t=Pq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pq(e){var t=Oq(e,"string");return typeof t=="symbol"?t:t+""}function Oq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ks(e,t){var r=_q({},e),s=t,n=Object.keys(t),i=n.reduce((o,l)=>(o[l]===void 0&&s[l]!==void 0&&(o[l]=s[l]),o),r);return i}function Dq(){}function jw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Nw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jw(Object(r),!0).forEach(function(s){Iq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Iq(e,t,r){return(t=Rq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rq(e){var t=Fq(e,"string");return typeof t=="symbol"?t:t+""}function Fq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lq=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),vA=(e,t,r)=>e.map(s=>"".concat(Lq(s)," ").concat(t,"ms ").concat(r)).join(","),Mq=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,s)=>r.filter(n=>s.includes(n))),ql=(e,t)=>Object.keys(t).reduce((r,s)=>Nw(Nw({},r),{},{[s]:e(s,t[s])}),{});function Sw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function es(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sw(Object(r),!0).forEach(function(s){Bq(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Bq(e,t,r){return(t=$q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $q(e){var t=zq(e,"string");return typeof t=="symbol"?t:t+""}function zq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zd=(e,t,r)=>e+(t-e)*r,kp=e=>{var{from:t,to:r}=e;return t!==r},bA=(e,t,r)=>{var s=ql((n,i)=>{if(kp(i)){var[o,l]=e(i.from,i.to,i.velocity);return es(es({},i),{},{from:o,velocity:l})}return i},t);return r<1?ql((n,i)=>kp(i)?es(es({},i),{},{velocity:Zd(i.velocity,s[n].velocity,r),from:Zd(i.from,s[n].from,r)}):i,t):bA(e,s,r-1)};function Uq(e,t,r,s,n,i){var o,l=s.reduce((f,h)=>es(es({},f),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>ql((f,h)=>h.from,l),d=()=>!Object.values(l).filter(kp).length,u=null,m=f=>{o||(o=f);var h=f-o,p=h/r.dt;l=bA(r,l,p),n(es(es(es({},e),t),c())),o=f,d()||(u=i.setTimeout(m))};return()=>(u=i.setTimeout(m),()=>{u()})}function Wq(e,t,r,s,n,i,o){var l=null,c=n.reduce((m,f)=>es(es({},m),{},{[f]:[e[f],t[f]]}),{}),d,u=m=>{d||(d=m);var f=(m-d)/s,h=ql((x,g)=>Zd(...g,r(f)),c);if(i(es(es(es({},e),t),h)),f<1)l=o.setTimeout(u);else{var p=ql((x,g)=>Zd(...g,r(1)),c);i(es(es(es({},e),t),p))}};return()=>(l=o.setTimeout(u),()=>{l()})}const Hq=(e,t,r,s,n,i)=>{var o=Mq(e,t);return r.isStepper===!0?Uq(e,t,r,o,n,i):Wq(e,t,r,s,o,n,i)};var Qd=1e-4,yA=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],wA=(e,t)=>e.map((r,s)=>r*t**s).reduce((r,s)=>r+s),Ew=(e,t)=>r=>{var s=yA(e,t);return wA(s,r)},Vq=(e,t)=>r=>{var s=yA(e,t),n=[...s.map((i,o)=>i*o).slice(1),0];return wA(n,r)},Tw=function(){for(var t,r,s,n,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];if(o.length===1)switch(o[0]){case"linear":[t,s,r,n]=[0,0,1,1];break;case"ease":[t,s,r,n]=[.25,.1,.25,1];break;case"ease-in":[t,s,r,n]=[.42,0,1,1];break;case"ease-out":[t,s,r,n]=[.42,0,.58,1];break;case"ease-in-out":[t,s,r,n]=[0,0,.58,1];break;default:{var c=o[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,s,r,n]=c[1].split(")")[0].split(",").map(p=>parseFloat(p)))}}else o.length===4&&([t,s,r,n]=o);var d=Ew(t,r),u=Ew(s,n),m=Vq(t,r),f=p=>p>1?1:p<0?0:p,h=p=>{for(var x=p>1?1:p,g=x,v=0;v<8;++v){var w=d(g)-x,y=m(g);if(Math.abs(w-x)<Qd||y<Qd)return u(g);g=f(g-w/y)}return u(g)};return h.isStepper=!1,h},Gq=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:s=8,dt:n=17}=t,i=(o,l,c)=>{var d=-(o-l)*r,u=c*s,m=c+(d-u)*n/1e3,f=c*n/1e3+o;return Math.abs(f-l)<Qd&&Math.abs(m)<Qd?[l,0]:[f,m]};return i.isStepper=!0,i.dt=n,i},qq=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Tw(e);case"spring":return Gq();default:if(e.split("(")[0]==="cubic-bezier")return Tw(e)}return typeof e=="function"?e:null};function Kq(e){var t,r=()=>null,s=!1,n=null,i=o=>{if(!s){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...d]=l;if(typeof c=="number"){n=e.setTimeout(i.bind(null,d),c);return}i(c),n=e.setTimeout(i.bind(null,d));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{s=!0},start:o=>{s=!1,n&&(n(),n=null),i(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class Yq{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),n=null,i=o=>{o-s>=r?t(o):typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(i))};return n=requestAnimationFrame(i),()=>{cancelAnimationFrame(n)}}}function Xq(){return Kq(new Yq)}var Jq=b.createContext(Xq);function Zq(e,t){var r=b.useContext(Jq);return b.useMemo(()=>t??r(e),[e,t,r])}var Qq={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Aw={t:0},qf={t:1};function sm(e){var t=ks(e,Qq),{isActive:r,canBegin:s,duration:n,easing:i,begin:o,onAnimationEnd:l,onAnimationStart:c,children:d}=t,u=Zq(t.animationId,t.animationManager),[m,f]=b.useState(r?Aw:qf),h=b.useRef(null);return b.useEffect(()=>{r||f(qf)},[r]),b.useEffect(()=>{if(!r||!s)return Dq;var p=Hq(Aw,qf,qq(i),n,f,u.getTimeoutController()),x=()=>{h.current=p()};return u.start([c,o,x,n,l]),()=>{u.stop(),h.current&&h.current(),l()}},[r,s,n,i,o,c,l,u]),d(m.t)}function am(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=b.useRef(Hl(t)),s=b.useRef(e);return s.current!==e&&(r.current=Hl(t),s.current=e),r.current}function Cw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function _w(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cw(Object(r),!0).forEach(function(s){eK(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cw(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function eK(e,t,r){return(t=tK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tK(e){var t=rK(e,"string");return typeof t=="symbol"?t:t+""}function rK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eu(){return eu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},eu.apply(null,arguments)}var kw=(e,t,r,s,n)=>{var i=Math.min(Math.abs(r)/2,Math.abs(s)/2),o=s>=0?1:-1,l=r>=0?1:-1,c=s>=0&&r>=0||s<0&&r<0?1:0,d;if(i>0&&n instanceof Array){for(var u=[0,0,0,0],m=0,f=4;m<f;m++)u[m]=n[m]>i?i:n[m];d="M".concat(e,",").concat(t+o*u[0]),u[0]>0&&(d+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+l*u[0],",").concat(t)),d+="L ".concat(e+r-l*u[1],",").concat(t),u[1]>0&&(d+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+o*u[1])),d+="L ".concat(e+r,",").concat(t+s-o*u[2]),u[2]>0&&(d+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+r-l*u[2],",").concat(t+s)),d+="L ".concat(e+l*u[3],",").concat(t+s),u[3]>0&&(d+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+s-o*u[3])),d+="Z"}else if(i>0&&n===+n&&n>0){var h=Math.min(i,n);d="M ".concat(e,",").concat(t+o*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,`
            L `).concat(e+r-l*h,",").concat(t,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r,",").concat(t+o*h,`
            L `).concat(e+r,",").concat(t+s-o*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r-l*h,",").concat(t+s,`
            L `).concat(e+l*h,",").concat(t+s,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+s-o*h," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(s," h ").concat(-r," Z");return d},sK={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},jA=e=>{var t=ks(e,sK),r=b.useRef(null),[s,n]=b.useState(-1);b.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&n(_)}catch{}},[]);var{x:i,y:o,width:l,height:c,radius:d,className:u}=t,{animationEasing:m,animationDuration:f,animationBegin:h,isAnimationActive:p,isUpdateAnimationActive:x}=t,g=b.useRef(l),v=b.useRef(c),w=b.useRef(i),y=b.useRef(o),S=b.useMemo(()=>({x:i,y:o,width:l,height:c,radius:d}),[i,o,l,c,d]),E=am(S,"rectangle-");if(i!==+i||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var N=Et("recharts-rectangle",u);if(!x)return b.createElement("path",eu({},$r(t,!0),{className:N,d:kw(i,o,l,c,d)}));var j=g.current,T=v.current,C=w.current,L=y.current,A="0px ".concat(s===-1?1:s,"px"),P="".concat(s,"px 0px"),I=vA(["strokeDasharray"],f,typeof m=="string"?m:void 0);return b.createElement(sm,{animationId:E,key:E,canBegin:s>0,duration:f,easing:m,isActive:x,begin:h},_=>{var D=rs(j,l,_),W=rs(T,c,_),K=rs(C,i,_),J=rs(L,o,_);r.current&&(g.current=D,v.current=W,w.current=K,y.current=J);var F;return p?_>0?F={transition:I,strokeDasharray:P}:F={strokeDasharray:A}:F={strokeDasharray:P},b.createElement("path",eu({},$r(t,!0),{className:N,d:kw(K,J,D,W,d),ref:r,style:_w(_w({},F),t.style)}))})};function NA(e){var{cx:t,cy:r,radius:s,startAngle:n,endAngle:i}=e,o=Ir(t,r,s,n),l=Ir(t,r,s,i);return{points:[o,l],cx:t,cy:r,radius:s,startAngle:n,endAngle:i}}function Pp(){return Pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Pp.apply(null,arguments)}var aK=(e,t)=>{var r=Kr(t-e),s=Math.min(Math.abs(t-e),359.999);return r*s},nd=e=>{var{cx:t,cy:r,radius:s,angle:n,sign:i,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,d=l*(o?1:-1)+s,u=Math.asin(l/d)/Jd,m=c?n:n+i*u,f=Ir(t,r,d,m),h=Ir(t,r,s,m),p=c?n-i*u:n,x=Ir(t,r,d*Math.cos(u*Jd),p);return{center:f,circleTangency:h,lineTangency:x,theta:u}},SA=e=>{var{cx:t,cy:r,innerRadius:s,outerRadius:n,startAngle:i,endAngle:o}=e,l=aK(i,o),c=i+l,d=Ir(t,r,n,i),u=Ir(t,r,n,c),m="M ".concat(d.x,",").concat(d.y,`
    A `).concat(n,",").concat(n,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(s>0){var f=Ir(t,r,s,i),h=Ir(t,r,s,c);m+="L ".concat(h.x,",").concat(h.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},nK=e=>{var{cx:t,cy:r,innerRadius:s,outerRadius:n,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d}=e,u=Kr(d-c),{circleTangency:m,lineTangency:f,theta:h}=nd({cx:t,cy:r,radius:n,angle:c,sign:u,cornerRadius:i,cornerIsExternal:l}),{circleTangency:p,lineTangency:x,theta:g}=nd({cx:t,cy:r,radius:n,angle:d,sign:-u,cornerRadius:i,cornerIsExternal:l}),v=l?Math.abs(c-d):Math.abs(c-d)-h-g;if(v<0)return o?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):SA({cx:t,cy:r,innerRadius:s,outerRadius:n,startAngle:c,endAngle:d});var w="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(n,",").concat(n,",0,").concat(+(v>180),",").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(x.x,",").concat(x.y,`
  `);if(s>0){var{circleTangency:y,lineTangency:S,theta:E}=nd({cx:t,cy:r,radius:s,angle:c,sign:u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:N,lineTangency:j,theta:T}=nd({cx:t,cy:r,radius:s,angle:d,sign:-u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),C=l?Math.abs(c-d):Math.abs(c-d)-E-T;if(C<0&&i===0)return"".concat(w,"L").concat(t,",").concat(r,"Z");w+="L".concat(j.x,",").concat(j.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(u>0),",").concat(y.x,",").concat(y.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(S.x,",").concat(S.y,"Z")}else w+="L".concat(t,",").concat(r,"Z");return w},iK={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},EA=e=>{var t=ks(e,iK),{cx:r,cy:s,innerRadius:n,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:m}=t;if(i<n||d===u)return null;var f=Et("recharts-sector",m),h=i-n,p=xs(o,h,0,!0),x;return p>0&&Math.abs(d-u)<360?x=nK({cx:r,cy:s,innerRadius:n,outerRadius:i,cornerRadius:Math.min(p,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):x=SA({cx:r,cy:s,innerRadius:n,outerRadius:i,startAngle:d,endAngle:u}),b.createElement("path",Pp({},$r(t,!0),{className:f,d:x}))};function oK(e,t,r){var s,n,i,o;if(e==="horizontal")s=t.x,i=s,n=r.top,o=r.top+r.height;else if(e==="vertical")n=t.y,o=n,s=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:c,innerRadius:d,outerRadius:u,angle:m}=t,f=Ir(l,c,d,m),h=Ir(l,c,u,m);s=f.x,n=f.y,i=h.x,o=h.y}else return NA(t);return[{x:s,y:n},{x:i,y:o}]}var Kf={},Yf={},Xf={},Pw;function lK(){return Pw||(Pw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PT();function r(s){return t.isSymbol(s)?NaN:Number(s)}e.toNumber=r})(Xf)),Xf}var Ow;function cK(){return Ow||(Ow=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lK();function r(s){return s?(s=t.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}e.toFinite=r})(Yf)),Yf}var Dw;function dK(){return Dw||(Dw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OT(),r=cK();function s(n,i,o){o&&typeof o!="number"&&t.isIterateeCall(n,i,o)&&(i=o=void 0),n=r.toFinite(n),i===void 0?(i=n,n=0):i=r.toFinite(i),o=o===void 0?n<i?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((i-n)/(o||1)),0),c=new Array(l);for(let d=0;d<l;d++)c[d]=n,n+=o;return c}e.range=s})(Kf)),Kf}var Jf,Iw;function uK(){return Iw||(Iw=1,Jf=dK().range),Jf}var mK=uK();const TA=zn(mK);function Dn(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function fK(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Pg(e){let t,r,s;e.length!==2?(t=Dn,r=(l,c)=>Dn(e(l),c),s=(l,c)=>e(l)-c):(t=e===Dn||e===fK?e:hK,r=e,s=e);function n(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const m=d+u>>>1;r(l[m],c)<0?d=m+1:u=m}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const m=d+u>>>1;r(l[m],c)<=0?d=m+1:u=m}while(d<u)}return d}function o(l,c,d=0,u=l.length){const m=n(l,c,d,u-1);return m>d&&s(l[m-1],c)>-s(l[m],c)?m-1:m}return{left:n,center:o,right:i}}function hK(){return 0}function AA(e){return e===null?NaN:+e}function*pK(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const xK=Pg(Dn),jc=xK.right;Pg(AA).center;class Rw extends Map{constructor(t,r=bK){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[s,n]of t)this.set(s,n)}get(t){return super.get(Fw(this,t))}has(t){return super.has(Fw(this,t))}set(t,r){return super.set(gK(this,t),r)}delete(t){return super.delete(vK(this,t))}}function Fw({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):r}function gK({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):(e.set(s,r),r)}function vK({_intern:e,_key:t},r){const s=t(r);return e.has(s)&&(r=e.get(s),e.delete(s)),r}function bK(e){return e!==null&&typeof e=="object"?e.valueOf():e}function yK(e=Dn){if(e===Dn)return CA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const s=e(t,r);return s||s===0?s:(e(r,r)===0)-(e(t,t)===0)}}function CA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const wK=Math.sqrt(50),jK=Math.sqrt(10),NK=Math.sqrt(2);function tu(e,t,r){const s=(t-e)/Math.max(0,r),n=Math.floor(Math.log10(s)),i=s/Math.pow(10,n),o=i>=wK?10:i>=jK?5:i>=NK?2:1;let l,c,d;return n<0?(d=Math.pow(10,-n)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,n)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?tu(e,t,r*2):[l,c,d]}function Op(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const s=t<e,[n,i,o]=s?tu(t,e,r):tu(e,t,r);if(!(i>=n))return[];const l=i-n+1,c=new Array(l);if(s)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(n+d)/-o;else for(let d=0;d<l;++d)c[d]=(n+d)*o;return c}function Dp(e,t,r){return t=+t,e=+e,r=+r,tu(e,t,r)[2]}function Ip(e,t,r){t=+t,e=+e,r=+r;const s=t<e,n=s?Dp(t,e,r):Dp(e,t,r);return(s?-1:1)*(n<0?1/-n:n)}function Lw(e,t){let r;for(const s of e)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function Mw(e,t){let r;for(const s of e)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function _A(e,t,r=0,s=1/0,n){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(e.length-1,s)),!(r<=t&&t<=s))return e;for(n=n===void 0?CA:yK(n);s>r;){if(s-r>600){const c=s-r+1,d=t-r+1,u=Math.log(c),m=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*m*(c-m)/c)*(d-c/2<0?-1:1),h=Math.max(r,Math.floor(t-d*m/c+f)),p=Math.min(s,Math.floor(t+(c-d)*m/c+f));_A(e,t,h,p,n)}const i=e[t];let o=r,l=s;for(sl(e,r,t),n(e[s],i)>0&&sl(e,r,s);o<l;){for(sl(e,o,l),++o,--l;n(e[o],i)<0;)++o;for(;n(e[l],i)>0;)--l}n(e[r],i)===0?sl(e,r,l):(++l,sl(e,l,s)),l<=t&&(r=l+1),t<=l&&(s=l-1)}return e}function sl(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function SK(e,t,r){if(e=Float64Array.from(pK(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return Mw(e);if(t>=1)return Lw(e);var s,n=(s-1)*t,i=Math.floor(n),o=Lw(_A(e,i).subarray(0,i+1)),l=Mw(e.subarray(i+1));return o+(l-o)*(n-i)}}function EK(e,t,r=AA){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+r(e[0],0,e);if(t>=1)return+r(e[s-1],s-1,e);var s,n=(s-1)*t,i=Math.floor(n),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(n-i)}}function TK(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var s=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(n);++s<n;)i[s]=e+s*r;return i}function ja(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function yn(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Rp=Symbol("implicit");function Og(){var e=new Rw,t=[],r=[],s=Rp;function n(i){let o=e.get(i);if(o===void 0){if(s!==Rp)return s;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return n.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Rw;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return n},n.range=function(i){return arguments.length?(r=Array.from(i),n):r.slice()},n.unknown=function(i){return arguments.length?(s=i,n):s},n.copy=function(){return Og(t,r).unknown(s)},ja.apply(n,arguments),n}function Dg(){var e=Og().unknown(void 0),t=e.domain,r=e.range,s=0,n=1,i,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function m(){var f=t().length,h=n<s,p=h?n:s,x=h?s:n;i=(x-p)/Math.max(1,f-c+d*2),l&&(i=Math.floor(i)),p+=(x-p-i*(f-c))*u,o=i*(1-c),l&&(p=Math.round(p),o=Math.round(o));var g=TK(f).map(function(v){return p+i*v});return r(h?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),m()):t()},e.range=function(f){return arguments.length?([s,n]=f,s=+s,n=+n,m()):[s,n]},e.rangeRound=function(f){return[s,n]=f,s=+s,n=+n,l=!0,m()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(l=!!f,m()):l},e.padding=function(f){return arguments.length?(c=Math.min(1,d=+f),m()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),m()):c},e.paddingOuter=function(f){return arguments.length?(d=+f,m()):d},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),m()):u},e.copy=function(){return Dg(t(),[s,n]).round(l).paddingInner(c).paddingOuter(d).align(u)},ja.apply(m(),arguments)}function kA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return kA(t())},e}function AK(){return kA(Dg.apply(null,arguments).paddingInner(1))}function Ig(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function PA(e,t){var r=Object.create(e.prototype);for(var s in t)r[s]=t[s];return r}function Nc(){}var Kl=.7,ru=1/Kl,mo="\\s*([+-]?\\d+)\\s*",Yl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Wa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",CK=/^#([0-9a-f]{3,8})$/,_K=new RegExp(`^rgb\\(${mo},${mo},${mo}\\)$`),kK=new RegExp(`^rgb\\(${Wa},${Wa},${Wa}\\)$`),PK=new RegExp(`^rgba\\(${mo},${mo},${mo},${Yl}\\)$`),OK=new RegExp(`^rgba\\(${Wa},${Wa},${Wa},${Yl}\\)$`),DK=new RegExp(`^hsl\\(${Yl},${Wa},${Wa}\\)$`),IK=new RegExp(`^hsla\\(${Yl},${Wa},${Wa},${Yl}\\)$`),Bw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ig(Nc,Xl,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$w,formatHex:$w,formatHex8:RK,formatHsl:FK,formatRgb:zw,toString:zw});function $w(){return this.rgb().formatHex()}function RK(){return this.rgb().formatHex8()}function FK(){return OA(this).formatHsl()}function zw(){return this.rgb().formatRgb()}function Xl(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=CK.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Uw(t):r===3?new Is(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?id(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?id(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=_K.exec(e))?new Is(t[1],t[2],t[3],1):(t=kK.exec(e))?new Is(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=PK.exec(e))?id(t[1],t[2],t[3],t[4]):(t=OK.exec(e))?id(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=DK.exec(e))?Vw(t[1],t[2]/100,t[3]/100,1):(t=IK.exec(e))?Vw(t[1],t[2]/100,t[3]/100,t[4]):Bw.hasOwnProperty(e)?Uw(Bw[e]):e==="transparent"?new Is(NaN,NaN,NaN,0):null}function Uw(e){return new Is(e>>16&255,e>>8&255,e&255,1)}function id(e,t,r,s){return s<=0&&(e=t=r=NaN),new Is(e,t,r,s)}function LK(e){return e instanceof Nc||(e=Xl(e)),e?(e=e.rgb(),new Is(e.r,e.g,e.b,e.opacity)):new Is}function Fp(e,t,r,s){return arguments.length===1?LK(e):new Is(e,t,r,s??1)}function Is(e,t,r,s){this.r=+e,this.g=+t,this.b=+r,this.opacity=+s}Ig(Is,Fp,PA(Nc,{brighter(e){return e=e==null?ru:Math.pow(ru,e),new Is(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Kl:Math.pow(Kl,e),new Is(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Is(bi(this.r),bi(this.g),bi(this.b),su(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ww,formatHex:Ww,formatHex8:MK,formatRgb:Hw,toString:Hw}));function Ww(){return`#${ci(this.r)}${ci(this.g)}${ci(this.b)}`}function MK(){return`#${ci(this.r)}${ci(this.g)}${ci(this.b)}${ci((isNaN(this.opacity)?1:this.opacity)*255)}`}function Hw(){const e=su(this.opacity);return`${e===1?"rgb(":"rgba("}${bi(this.r)}, ${bi(this.g)}, ${bi(this.b)}${e===1?")":`, ${e})`}`}function su(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function bi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ci(e){return e=bi(e),(e<16?"0":"")+e.toString(16)}function Vw(e,t,r,s){return s<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Aa(e,t,r,s)}function OA(e){if(e instanceof Aa)return new Aa(e.h,e.s,e.l,e.opacity);if(e instanceof Nc||(e=Xl(e)),!e)return new Aa;if(e instanceof Aa)return e;e=e.rgb();var t=e.r/255,r=e.g/255,s=e.b/255,n=Math.min(t,r,s),i=Math.max(t,r,s),o=NaN,l=i-n,c=(i+n)/2;return l?(t===i?o=(r-s)/l+(r<s)*6:r===i?o=(s-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+n:2-i-n,o*=60):l=c>0&&c<1?0:o,new Aa(o,l,c,e.opacity)}function BK(e,t,r,s){return arguments.length===1?OA(e):new Aa(e,t,r,s??1)}function Aa(e,t,r,s){this.h=+e,this.s=+t,this.l=+r,this.opacity=+s}Ig(Aa,BK,PA(Nc,{brighter(e){return e=e==null?ru:Math.pow(ru,e),new Aa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Kl:Math.pow(Kl,e),new Aa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*t,n=2*r-s;return new Is(Zf(e>=240?e-240:e+120,n,s),Zf(e,n,s),Zf(e<120?e+240:e-120,n,s),this.opacity)},clamp(){return new Aa(Gw(this.h),od(this.s),od(this.l),su(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=su(this.opacity);return`${e===1?"hsl(":"hsla("}${Gw(this.h)}, ${od(this.s)*100}%, ${od(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Gw(e){return e=(e||0)%360,e<0?e+360:e}function od(e){return Math.max(0,Math.min(1,e||0))}function Zf(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Rg=e=>()=>e;function $K(e,t){return function(r){return e+r*t}}function zK(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(s){return Math.pow(e+s*t,r)}}function UK(e){return(e=+e)==1?DA:function(t,r){return r-t?zK(t,r,e):Rg(isNaN(t)?r:t)}}function DA(e,t){var r=t-e;return r?$K(e,r):Rg(isNaN(e)?t:e)}const qw=(function e(t){var r=UK(t);function s(n,i){var o=r((n=Fp(n)).r,(i=Fp(i)).r),l=r(n.g,i.g),c=r(n.b,i.b),d=DA(n.opacity,i.opacity);return function(u){return n.r=o(u),n.g=l(u),n.b=c(u),n.opacity=d(u),n+""}}return s.gamma=e,s})(1);function WK(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,s=t.slice(),n;return function(i){for(n=0;n<r;++n)s[n]=e[n]*(1-i)+t[n]*i;return s}}function HK(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function VK(e,t){var r=t?t.length:0,s=e?Math.min(r,e.length):0,n=new Array(s),i=new Array(r),o;for(o=0;o<s;++o)n[o]=Fo(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<s;++o)i[o]=n[o](l);return i}}function GK(e,t){var r=new Date;return e=+e,t=+t,function(s){return r.setTime(e*(1-s)+t*s),r}}function au(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function qK(e,t){var r={},s={},n;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in e?r[n]=Fo(e[n],t[n]):s[n]=t[n];return function(i){for(n in r)s[n]=r[n](i);return s}}var Lp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qf=new RegExp(Lp.source,"g");function KK(e){return function(){return e}}function YK(e){return function(t){return e(t)+""}}function XK(e,t){var r=Lp.lastIndex=Qf.lastIndex=0,s,n,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(s=Lp.exec(e))&&(n=Qf.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(s=s[0])===(n=n[0])?l[o]?l[o]+=n:l[++o]=n:(l[++o]=null,c.push({i:o,x:au(s,n)})),r=Qf.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?YK(c[0].x):KK(t):(t=c.length,function(d){for(var u=0,m;u<t;++u)l[(m=c[u]).i]=m.x(d);return l.join("")})}function Fo(e,t){var r=typeof t,s;return t==null||r==="boolean"?Rg(t):(r==="number"?au:r==="string"?(s=Xl(t))?(t=s,qw):XK:t instanceof Xl?qw:t instanceof Date?GK:HK(t)?WK:Array.isArray(t)?VK:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?qK:au)(e,t)}function Fg(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function JK(e,t){t===void 0&&(t=e,e=Fo);for(var r=0,s=t.length-1,n=t[0],i=new Array(s<0?0:s);r<s;)i[r]=e(n,n=t[++r]);return function(o){var l=Math.max(0,Math.min(s-1,Math.floor(o*=s)));return i[l](o-l)}}function ZK(e){return function(){return e}}function nu(e){return+e}var Kw=[0,1];function Es(e){return e}function Mp(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:ZK(isNaN(t)?NaN:.5)}function QK(e,t){var r;return e>t&&(r=e,e=t,t=r),function(s){return Math.max(e,Math.min(t,s))}}function eY(e,t,r){var s=e[0],n=e[1],i=t[0],o=t[1];return n<s?(s=Mp(n,s),i=r(o,i)):(s=Mp(s,n),i=r(i,o)),function(l){return i(s(l))}}function tY(e,t,r){var s=Math.min(e.length,t.length)-1,n=new Array(s),i=new Array(s),o=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<s;)n[o]=Mp(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=jc(e,l,1,s)-1;return i[c](n[c](l))}}function Sc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function nm(){var e=Kw,t=Kw,r=Fo,s,n,i,o=Es,l,c,d;function u(){var f=Math.min(e.length,t.length);return o!==Es&&(o=QK(e[0],e[f-1])),l=f>2?tY:eY,c=d=null,m}function m(f){return f==null||isNaN(f=+f)?i:(c||(c=l(e.map(s),t,r)))(s(o(f)))}return m.invert=function(f){return o(n((d||(d=l(t,e.map(s),au)))(f)))},m.domain=function(f){return arguments.length?(e=Array.from(f,nu),u()):e.slice()},m.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},m.rangeRound=function(f){return t=Array.from(f),r=Fg,u()},m.clamp=function(f){return arguments.length?(o=f?!0:Es,u()):o!==Es},m.interpolate=function(f){return arguments.length?(r=f,u()):r},m.unknown=function(f){return arguments.length?(i=f,m):i},function(f,h){return s=f,n=h,u()}}function Lg(){return nm()(Es,Es)}function rY(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function iu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,s=e.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+e.slice(r+1)]}function No(e){return e=iu(Math.abs(e)),e?e[1]:NaN}function sY(e,t){return function(r,s){for(var n=r.length,i=[],o=0,l=e[0],c=0;n>0&&l>0&&(c+l+1>s&&(l=Math.max(1,s-c)),i.push(r.substring(n-=l,n+l)),!((c+=l+1)>s));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function aY(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var nY=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Jl(e){if(!(t=nY.exec(e)))throw new Error("invalid format: "+e);var t;return new Mg({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Jl.prototype=Mg.prototype;function Mg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Mg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function iY(e){e:for(var t=e.length,r=1,s=-1,n;r<t;++r)switch(e[r]){case".":s=n=r;break;case"0":s===0&&(s=r),n=r;break;default:if(!+e[r])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(n+1):e}var IA;function oY(e,t){var r=iu(e,t);if(!r)return e+"";var s=r[0],n=r[1],i=n-(IA=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,o=s.length;return i===o?s:i>o?s+new Array(i-o+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+iu(e,Math.max(0,t+i-1))[0]}function Yw(e,t){var r=iu(e,t);if(!r)return e+"";var s=r[0],n=r[1];return n<0?"0."+new Array(-n).join("0")+s:s.length>n+1?s.slice(0,n+1)+"."+s.slice(n+1):s+new Array(n-s.length+2).join("0")}const Xw={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:rY,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Yw(e*100,t),r:Yw,s:oY,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Jw(e){return e}var Zw=Array.prototype.map,Qw=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function lY(e){var t=e.grouping===void 0||e.thousands===void 0?Jw:sY(Zw.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",n=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Jw:aY(Zw.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(m){m=Jl(m);var f=m.fill,h=m.align,p=m.sign,x=m.symbol,g=m.zero,v=m.width,w=m.comma,y=m.precision,S=m.trim,E=m.type;E==="n"?(w=!0,E="g"):Xw[E]||(y===void 0&&(y=12),S=!0,E="g"),(g||f==="0"&&h==="=")&&(g=!0,f="0",h="=");var N=x==="$"?r:x==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",j=x==="$"?s:/[%p]/.test(E)?o:"",T=Xw[E],C=/[defgprs%]/.test(E);y=y===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function L(A){var P=N,I=j,_,D,W;if(E==="c")I=T(A)+I,A="";else{A=+A;var K=A<0||1/A<0;if(A=isNaN(A)?c:T(Math.abs(A),y),S&&(A=iY(A)),K&&+A==0&&p!=="+"&&(K=!1),P=(K?p==="("?p:l:p==="-"||p==="("?"":p)+P,I=(E==="s"?Qw[8+IA/3]:"")+I+(K&&p==="("?")":""),C){for(_=-1,D=A.length;++_<D;)if(W=A.charCodeAt(_),48>W||W>57){I=(W===46?n+A.slice(_+1):A.slice(_))+I,A=A.slice(0,_);break}}}w&&!g&&(A=t(A,1/0));var J=P.length+A.length+I.length,F=J<v?new Array(v-J+1).join(f):"";switch(w&&g&&(A=t(F+A,F.length?v-I.length:1/0),F=""),h){case"<":A=P+A+I+F;break;case"=":A=P+F+A+I;break;case"^":A=F.slice(0,J=F.length>>1)+P+A+I+F.slice(J);break;default:A=F+P+A+I;break}return i(A)}return L.toString=function(){return m+""},L}function u(m,f){var h=d((m=Jl(m),m.type="f",m)),p=Math.max(-8,Math.min(8,Math.floor(No(f)/3)))*3,x=Math.pow(10,-p),g=Qw[8+p/3];return function(v){return h(x*v)+g}}return{format:d,formatPrefix:u}}var ld,Bg,RA;cY({thousands:",",grouping:[3],currency:["$",""]});function cY(e){return ld=lY(e),Bg=ld.format,RA=ld.formatPrefix,ld}function dY(e){return Math.max(0,-No(Math.abs(e)))}function uY(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(No(t)/3)))*3-No(Math.abs(e)))}function mY(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,No(t)-No(e))+1}function FA(e,t,r,s){var n=Ip(e,t,r),i;switch(s=Jl(s??",f"),s.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=uY(n,o))&&(s.precision=i),RA(s,o)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=mY(n,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=dY(n))&&(s.precision=i-(s.type==="%")*2);break}}return Bg(s)}function Gn(e){var t=e.domain;return e.ticks=function(r){var s=t();return Op(s[0],s[s.length-1],r??10)},e.tickFormat=function(r,s){var n=t();return FA(n[0],n[n.length-1],r??10,s)},e.nice=function(r){r==null&&(r=10);var s=t(),n=0,i=s.length-1,o=s[n],l=s[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=n,n=i,i=d);u-- >0;){if(d=Dp(o,l,r),d===c)return s[n]=o,s[i]=l,t(s);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function LA(){var e=Lg();return e.copy=function(){return Sc(e,LA())},ja.apply(e,arguments),Gn(e)}function MA(e){var t;function r(s){return s==null||isNaN(s=+s)?t:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(e=Array.from(s,nu),r):e.slice()},r.unknown=function(s){return arguments.length?(t=s,r):t},r.copy=function(){return MA(e).unknown(t)},e=arguments.length?Array.from(e,nu):[0,1],Gn(r)}function BA(e,t){e=e.slice();var r=0,s=e.length-1,n=e[r],i=e[s],o;return i<n&&(o=r,r=s,s=o,o=n,n=i,i=o),e[r]=t.floor(n),e[s]=t.ceil(i),e}function ej(e){return Math.log(e)}function tj(e){return Math.exp(e)}function fY(e){return-Math.log(-e)}function hY(e){return-Math.exp(-e)}function pY(e){return isFinite(e)?+("1e"+e):e<0?0:e}function xY(e){return e===10?pY:e===Math.E?Math.exp:t=>Math.pow(e,t)}function gY(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function rj(e){return(t,r)=>-e(-t,r)}function $g(e){const t=e(ej,tj),r=t.domain;let s=10,n,i;function o(){return n=gY(s),i=xY(s),r()[0]<0?(n=rj(n),i=rj(i),e(fY,hY)):e(ej,tj),t}return t.base=function(l){return arguments.length?(s=+l,o()):s},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const m=u<d;m&&([d,u]=[u,d]);let f=n(d),h=n(u),p,x;const g=l==null?10:+l;let v=[];if(!(s%1)&&h-f<g){if(f=Math.floor(f),h=Math.ceil(h),d>0){for(;f<=h;++f)for(p=1;p<s;++p)if(x=f<0?p/i(-f):p*i(f),!(x<d)){if(x>u)break;v.push(x)}}else for(;f<=h;++f)for(p=s-1;p>=1;--p)if(x=f>0?p/i(-f):p*i(f),!(x<d)){if(x>u)break;v.push(x)}v.length*2<g&&(v=Op(d,u,g))}else v=Op(f,h,Math.min(h-f,g)).map(i);return m?v.reverse():v},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=s===10?"s":","),typeof c!="function"&&(!(s%1)&&(c=Jl(c)).precision==null&&(c.trim=!0),c=Bg(c)),l===1/0)return c;const d=Math.max(1,s*l/t.ticks().length);return u=>{let m=u/i(Math.round(n(u)));return m*s<s-.5&&(m*=s),m<=d?c(u):""}},t.nice=()=>r(BA(r(),{floor:l=>i(Math.floor(n(l))),ceil:l=>i(Math.ceil(n(l)))})),t}function $A(){const e=$g(nm()).domain([1,10]);return e.copy=()=>Sc(e,$A()).base(e.base()),ja.apply(e,arguments),e}function sj(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function aj(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function zg(e){var t=1,r=e(sj(t),aj(t));return r.constant=function(s){return arguments.length?e(sj(t=+s),aj(t)):t},Gn(r)}function zA(){var e=zg(nm());return e.copy=function(){return Sc(e,zA()).constant(e.constant())},ja.apply(e,arguments)}function nj(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function vY(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function bY(e){return e<0?-e*e:e*e}function Ug(e){var t=e(Es,Es),r=1;function s(){return r===1?e(Es,Es):r===.5?e(vY,bY):e(nj(r),nj(1/r))}return t.exponent=function(n){return arguments.length?(r=+n,s()):r},Gn(t)}function Wg(){var e=Ug(nm());return e.copy=function(){return Sc(e,Wg()).exponent(e.exponent())},ja.apply(e,arguments),e}function yY(){return Wg.apply(null,arguments).exponent(.5)}function ij(e){return Math.sign(e)*e*e}function wY(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function UA(){var e=Lg(),t=[0,1],r=!1,s;function n(i){var o=wY(e(i));return isNaN(o)?s:r?Math.round(o):o}return n.invert=function(i){return e.invert(ij(i))},n.domain=function(i){return arguments.length?(e.domain(i),n):e.domain()},n.range=function(i){return arguments.length?(e.range((t=Array.from(i,nu)).map(ij)),n):t.slice()},n.rangeRound=function(i){return n.range(i).round(!0)},n.round=function(i){return arguments.length?(r=!!i,n):r},n.clamp=function(i){return arguments.length?(e.clamp(i),n):e.clamp()},n.unknown=function(i){return arguments.length?(s=i,n):s},n.copy=function(){return UA(e.domain(),t).round(r).clamp(e.clamp()).unknown(s)},ja.apply(n,arguments),Gn(n)}function WA(){var e=[],t=[],r=[],s;function n(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=EK(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?s:t[jc(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Dn),n()},i.range=function(o){return arguments.length?(t=Array.from(o),n()):t.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.quantiles=function(){return r.slice()},i.copy=function(){return WA().domain(e).range(t).unknown(s)},ja.apply(i,arguments)}function HA(){var e=0,t=1,r=1,s=[.5],n=[0,1],i;function o(c){return c!=null&&c<=c?n[jc(s,c,0,r)]:i}function l(){var c=-1;for(s=new Array(r);++c<r;)s[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(n=Array.from(c)).length-1,l()):n.slice()},o.invertExtent=function(c){var d=n.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,s[0]]:d>=r?[s[r-1],t]:[s[d-1],s[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return s.slice()},o.copy=function(){return HA().domain([e,t]).range(n).unknown(i)},ja.apply(Gn(o),arguments)}function VA(){var e=[.5],t=[0,1],r,s=1;function n(i){return i!=null&&i<=i?t[jc(e,i,0,s)]:r}return n.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),n):e.slice()},n.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),n):t.slice()},n.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return VA().domain(e).range(t).unknown(r)},ja.apply(n,arguments)}const e0=new Date,t0=new Date;function Ur(e,t,r,s){function n(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return n.floor=i=>(e(i=new Date(+i)),i),n.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),n.round=i=>{const o=n(i),l=n.ceil(i);return i-o<l-i?o:l},n.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),n.range=(i,o,l)=>{const c=[];if(i=n.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},n.filter=i=>Ur(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(n.count=(i,o)=>(e0.setTime(+i),t0.setTime(+o),e(e0),e(t0),Math.floor(r(e0,t0))),n.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?n.filter(s?o=>s(o)%i===0:o=>n.count(0,o)%i===0):n)),n}const ou=Ur(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ou.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ur(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):ou);ou.range;const Qa=1e3,ha=Qa*60,en=ha*60,mn=en*24,Hg=mn*7,oj=mn*30,r0=mn*365,di=Ur(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Qa)},(e,t)=>(t-e)/Qa,e=>e.getUTCSeconds());di.range;const Vg=Ur(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Qa)},(e,t)=>{e.setTime(+e+t*ha)},(e,t)=>(t-e)/ha,e=>e.getMinutes());Vg.range;const Gg=Ur(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ha)},(e,t)=>(t-e)/ha,e=>e.getUTCMinutes());Gg.range;const qg=Ur(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Qa-e.getMinutes()*ha)},(e,t)=>{e.setTime(+e+t*en)},(e,t)=>(t-e)/en,e=>e.getHours());qg.range;const Kg=Ur(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*en)},(e,t)=>(t-e)/en,e=>e.getUTCHours());Kg.range;const Ec=Ur(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ha)/mn,e=>e.getDate()-1);Ec.range;const im=Ur(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/mn,e=>e.getUTCDate()-1);im.range;const GA=Ur(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/mn,e=>Math.floor(e/mn));GA.range;function qi(e){return Ur(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ha)/Hg)}const om=qi(0),lu=qi(1),jY=qi(2),NY=qi(3),So=qi(4),SY=qi(5),EY=qi(6);om.range;lu.range;jY.range;NY.range;So.range;SY.range;EY.range;function Ki(e){return Ur(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Hg)}const lm=Ki(0),cu=Ki(1),TY=Ki(2),AY=Ki(3),Eo=Ki(4),CY=Ki(5),_Y=Ki(6);lm.range;cu.range;TY.range;AY.range;Eo.range;CY.range;_Y.range;const Yg=Ur(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Yg.range;const Xg=Ur(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Xg.range;const fn=Ur(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());fn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ur(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});fn.range;const hn=Ur(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());hn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ur(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});hn.range;function qA(e,t,r,s,n,i){const o=[[di,1,Qa],[di,5,5*Qa],[di,15,15*Qa],[di,30,30*Qa],[i,1,ha],[i,5,5*ha],[i,15,15*ha],[i,30,30*ha],[n,1,en],[n,3,3*en],[n,6,6*en],[n,12,12*en],[s,1,mn],[s,2,2*mn],[r,1,Hg],[t,1,oj],[t,3,3*oj],[e,1,r0]];function l(d,u,m){const f=u<d;f&&([d,u]=[u,d]);const h=m&&typeof m.range=="function"?m:c(d,u,m),p=h?h.range(d,+u+1):[];return f?p.reverse():p}function c(d,u,m){const f=Math.abs(u-d)/m,h=Pg(([,,g])=>g).right(o,f);if(h===o.length)return e.every(Ip(d/r0,u/r0,m));if(h===0)return ou.every(Math.max(Ip(d,u,m),1));const[p,x]=o[f/o[h-1][2]<o[h][2]/f?h-1:h];return p.every(x)}return[l,c]}const[kY,PY]=qA(hn,Xg,lm,GA,Kg,Gg),[OY,DY]=qA(fn,Yg,om,Ec,qg,Vg);function s0(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function a0(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function al(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function IY(e){var t=e.dateTime,r=e.date,s=e.time,n=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=nl(n),u=il(n),m=nl(i),f=il(i),h=nl(o),p=il(o),x=nl(l),g=il(l),v=nl(c),w=il(c),y={a:K,A:J,b:F,B:le,c:null,d:fj,e:fj,f:sX,g:fX,G:pX,H:eX,I:tX,j:rX,L:KA,m:aX,M:nX,p:Ae,q:O,Q:xj,s:gj,S:iX,u:oX,U:lX,V:cX,w:dX,W:uX,x:null,X:null,y:mX,Y:hX,Z:xX,"%":pj},S={a:G,A:U,b:B,B:Y,c:null,d:hj,e:hj,f:yX,g:kX,G:OX,H:gX,I:vX,j:bX,L:XA,m:wX,M:jX,p:te,q:ae,Q:xj,s:gj,S:NX,u:SX,U:EX,V:TX,w:AX,W:CX,x:null,X:null,y:_X,Y:PX,Z:DX,"%":pj},E={a:L,A,b:P,B:I,c:_,d:uj,e:uj,f:XY,g:dj,G:cj,H:mj,I:mj,j:GY,L:YY,m:VY,M:qY,p:C,q:HY,Q:ZY,s:QY,S:KY,u:BY,U:$Y,V:zY,w:MY,W:UY,x:D,X:W,y:dj,Y:cj,Z:WY,"%":JY};y.x=N(r,y),y.X=N(s,y),y.c=N(t,y),S.x=N(r,S),S.X=N(s,S),S.c=N(t,S);function N(ne,fe){return function(je){var z=[],me=-1,ie=0,ke=ne.length,Fe,he,Me;for(je instanceof Date||(je=new Date(+je));++me<ke;)ne.charCodeAt(me)===37&&(z.push(ne.slice(ie,me)),(he=lj[Fe=ne.charAt(++me)])!=null?Fe=ne.charAt(++me):he=Fe==="e"?" ":"0",(Me=fe[Fe])&&(Fe=Me(je,he)),z.push(Fe),ie=me+1);return z.push(ne.slice(ie,me)),z.join("")}}function j(ne,fe){return function(je){var z=al(1900,void 0,1),me=T(z,ne,je+="",0),ie,ke;if(me!=je.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(fe&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(ie=a0(al(z.y,0,1)),ke=ie.getUTCDay(),ie=ke>4||ke===0?cu.ceil(ie):cu(ie),ie=im.offset(ie,(z.V-1)*7),z.y=ie.getUTCFullYear(),z.m=ie.getUTCMonth(),z.d=ie.getUTCDate()+(z.w+6)%7):(ie=s0(al(z.y,0,1)),ke=ie.getDay(),ie=ke>4||ke===0?lu.ceil(ie):lu(ie),ie=Ec.offset(ie,(z.V-1)*7),z.y=ie.getFullYear(),z.m=ie.getMonth(),z.d=ie.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),ke="Z"in z?a0(al(z.y,0,1)).getUTCDay():s0(al(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(ke+5)%7:z.w+z.U*7-(ke+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,a0(z)):s0(z)}}function T(ne,fe,je,z){for(var me=0,ie=fe.length,ke=je.length,Fe,he;me<ie;){if(z>=ke)return-1;if(Fe=fe.charCodeAt(me++),Fe===37){if(Fe=fe.charAt(me++),he=E[Fe in lj?fe.charAt(me++):Fe],!he||(z=he(ne,je,z))<0)return-1}else if(Fe!=je.charCodeAt(z++))return-1}return z}function C(ne,fe,je){var z=d.exec(fe.slice(je));return z?(ne.p=u.get(z[0].toLowerCase()),je+z[0].length):-1}function L(ne,fe,je){var z=h.exec(fe.slice(je));return z?(ne.w=p.get(z[0].toLowerCase()),je+z[0].length):-1}function A(ne,fe,je){var z=m.exec(fe.slice(je));return z?(ne.w=f.get(z[0].toLowerCase()),je+z[0].length):-1}function P(ne,fe,je){var z=v.exec(fe.slice(je));return z?(ne.m=w.get(z[0].toLowerCase()),je+z[0].length):-1}function I(ne,fe,je){var z=x.exec(fe.slice(je));return z?(ne.m=g.get(z[0].toLowerCase()),je+z[0].length):-1}function _(ne,fe,je){return T(ne,t,fe,je)}function D(ne,fe,je){return T(ne,r,fe,je)}function W(ne,fe,je){return T(ne,s,fe,je)}function K(ne){return o[ne.getDay()]}function J(ne){return i[ne.getDay()]}function F(ne){return c[ne.getMonth()]}function le(ne){return l[ne.getMonth()]}function Ae(ne){return n[+(ne.getHours()>=12)]}function O(ne){return 1+~~(ne.getMonth()/3)}function G(ne){return o[ne.getUTCDay()]}function U(ne){return i[ne.getUTCDay()]}function B(ne){return c[ne.getUTCMonth()]}function Y(ne){return l[ne.getUTCMonth()]}function te(ne){return n[+(ne.getUTCHours()>=12)]}function ae(ne){return 1+~~(ne.getUTCMonth()/3)}return{format:function(ne){var fe=N(ne+="",y);return fe.toString=function(){return ne},fe},parse:function(ne){var fe=j(ne+="",!1);return fe.toString=function(){return ne},fe},utcFormat:function(ne){var fe=N(ne+="",S);return fe.toString=function(){return ne},fe},utcParse:function(ne){var fe=j(ne+="",!0);return fe.toString=function(){return ne},fe}}}var lj={"-":"",_:" ",0:"0"},Xr=/^\s*\d+/,RY=/^%/,FY=/[\\^$*+?|[\]().{}]/g;function Ot(e,t,r){var s=e<0?"-":"",n=(s?-e:e)+"",i=n.length;return s+(i<r?new Array(r-i+1).join(t)+n:n)}function LY(e){return e.replace(FY,"\\$&")}function nl(e){return new RegExp("^(?:"+e.map(LY).join("|")+")","i")}function il(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function MY(e,t,r){var s=Xr.exec(t.slice(r,r+1));return s?(e.w=+s[0],r+s[0].length):-1}function BY(e,t,r){var s=Xr.exec(t.slice(r,r+1));return s?(e.u=+s[0],r+s[0].length):-1}function $Y(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.U=+s[0],r+s[0].length):-1}function zY(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.V=+s[0],r+s[0].length):-1}function UY(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.W=+s[0],r+s[0].length):-1}function cj(e,t,r){var s=Xr.exec(t.slice(r,r+4));return s?(e.y=+s[0],r+s[0].length):-1}function dj(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function WY(e,t,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function HY(e,t,r){var s=Xr.exec(t.slice(r,r+1));return s?(e.q=s[0]*3-3,r+s[0].length):-1}function VY(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.m=s[0]-1,r+s[0].length):-1}function uj(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.d=+s[0],r+s[0].length):-1}function GY(e,t,r){var s=Xr.exec(t.slice(r,r+3));return s?(e.m=0,e.d=+s[0],r+s[0].length):-1}function mj(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.H=+s[0],r+s[0].length):-1}function qY(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.M=+s[0],r+s[0].length):-1}function KY(e,t,r){var s=Xr.exec(t.slice(r,r+2));return s?(e.S=+s[0],r+s[0].length):-1}function YY(e,t,r){var s=Xr.exec(t.slice(r,r+3));return s?(e.L=+s[0],r+s[0].length):-1}function XY(e,t,r){var s=Xr.exec(t.slice(r,r+6));return s?(e.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function JY(e,t,r){var s=RY.exec(t.slice(r,r+1));return s?r+s[0].length:-1}function ZY(e,t,r){var s=Xr.exec(t.slice(r));return s?(e.Q=+s[0],r+s[0].length):-1}function QY(e,t,r){var s=Xr.exec(t.slice(r));return s?(e.s=+s[0],r+s[0].length):-1}function fj(e,t){return Ot(e.getDate(),t,2)}function eX(e,t){return Ot(e.getHours(),t,2)}function tX(e,t){return Ot(e.getHours()%12||12,t,2)}function rX(e,t){return Ot(1+Ec.count(fn(e),e),t,3)}function KA(e,t){return Ot(e.getMilliseconds(),t,3)}function sX(e,t){return KA(e,t)+"000"}function aX(e,t){return Ot(e.getMonth()+1,t,2)}function nX(e,t){return Ot(e.getMinutes(),t,2)}function iX(e,t){return Ot(e.getSeconds(),t,2)}function oX(e){var t=e.getDay();return t===0?7:t}function lX(e,t){return Ot(om.count(fn(e)-1,e),t,2)}function YA(e){var t=e.getDay();return t>=4||t===0?So(e):So.ceil(e)}function cX(e,t){return e=YA(e),Ot(So.count(fn(e),e)+(fn(e).getDay()===4),t,2)}function dX(e){return e.getDay()}function uX(e,t){return Ot(lu.count(fn(e)-1,e),t,2)}function mX(e,t){return Ot(e.getFullYear()%100,t,2)}function fX(e,t){return e=YA(e),Ot(e.getFullYear()%100,t,2)}function hX(e,t){return Ot(e.getFullYear()%1e4,t,4)}function pX(e,t){var r=e.getDay();return e=r>=4||r===0?So(e):So.ceil(e),Ot(e.getFullYear()%1e4,t,4)}function xX(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ot(t/60|0,"0",2)+Ot(t%60,"0",2)}function hj(e,t){return Ot(e.getUTCDate(),t,2)}function gX(e,t){return Ot(e.getUTCHours(),t,2)}function vX(e,t){return Ot(e.getUTCHours()%12||12,t,2)}function bX(e,t){return Ot(1+im.count(hn(e),e),t,3)}function XA(e,t){return Ot(e.getUTCMilliseconds(),t,3)}function yX(e,t){return XA(e,t)+"000"}function wX(e,t){return Ot(e.getUTCMonth()+1,t,2)}function jX(e,t){return Ot(e.getUTCMinutes(),t,2)}function NX(e,t){return Ot(e.getUTCSeconds(),t,2)}function SX(e){var t=e.getUTCDay();return t===0?7:t}function EX(e,t){return Ot(lm.count(hn(e)-1,e),t,2)}function JA(e){var t=e.getUTCDay();return t>=4||t===0?Eo(e):Eo.ceil(e)}function TX(e,t){return e=JA(e),Ot(Eo.count(hn(e),e)+(hn(e).getUTCDay()===4),t,2)}function AX(e){return e.getUTCDay()}function CX(e,t){return Ot(cu.count(hn(e)-1,e),t,2)}function _X(e,t){return Ot(e.getUTCFullYear()%100,t,2)}function kX(e,t){return e=JA(e),Ot(e.getUTCFullYear()%100,t,2)}function PX(e,t){return Ot(e.getUTCFullYear()%1e4,t,4)}function OX(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Eo(e):Eo.ceil(e),Ot(e.getUTCFullYear()%1e4,t,4)}function DX(){return"+0000"}function pj(){return"%"}function xj(e){return+e}function gj(e){return Math.floor(+e/1e3)}var eo,ZA,QA;IX({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function IX(e){return eo=IY(e),ZA=eo.format,eo.parse,QA=eo.utcFormat,eo.utcParse,eo}function RX(e){return new Date(e)}function FX(e){return e instanceof Date?+e:+new Date(+e)}function Jg(e,t,r,s,n,i,o,l,c,d){var u=Lg(),m=u.invert,f=u.domain,h=d(".%L"),p=d(":%S"),x=d("%I:%M"),g=d("%I %p"),v=d("%a %d"),w=d("%b %d"),y=d("%B"),S=d("%Y");function E(N){return(c(N)<N?h:l(N)<N?p:o(N)<N?x:i(N)<N?g:s(N)<N?n(N)<N?v:w:r(N)<N?y:S)(N)}return u.invert=function(N){return new Date(m(N))},u.domain=function(N){return arguments.length?f(Array.from(N,FX)):f().map(RX)},u.ticks=function(N){var j=f();return e(j[0],j[j.length-1],N??10)},u.tickFormat=function(N,j){return j==null?E:d(j)},u.nice=function(N){var j=f();return(!N||typeof N.range!="function")&&(N=t(j[0],j[j.length-1],N??10)),N?f(BA(j,N)):u},u.copy=function(){return Sc(u,Jg(e,t,r,s,n,i,o,l,c,d))},u}function LX(){return ja.apply(Jg(OY,DY,fn,Yg,om,Ec,qg,Vg,di,ZA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function MX(){return ja.apply(Jg(kY,PY,hn,Xg,lm,im,Kg,Gg,di,QA).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function cm(){var e=0,t=1,r,s,n,i,o=Es,l=!1,c;function d(m){return m==null||isNaN(m=+m)?c:o(n===0?.5:(m=(i(m)-r)*n,l?Math.max(0,Math.min(1,m)):m))}d.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),s=i(t=+t),n=r===s?0:1/(s-r),d):[e,t]},d.clamp=function(m){return arguments.length?(l=!!m,d):l},d.interpolator=function(m){return arguments.length?(o=m,d):o};function u(m){return function(f){var h,p;return arguments.length?([h,p]=f,o=m(h,p),d):[o(0),o(1)]}}return d.range=u(Fo),d.rangeRound=u(Fg),d.unknown=function(m){return arguments.length?(c=m,d):c},function(m){return i=m,r=m(e),s=m(t),n=r===s?0:1/(s-r),d}}function qn(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function eC(){var e=Gn(cm()(Es));return e.copy=function(){return qn(e,eC())},yn.apply(e,arguments)}function tC(){var e=$g(cm()).domain([1,10]);return e.copy=function(){return qn(e,tC()).base(e.base())},yn.apply(e,arguments)}function rC(){var e=zg(cm());return e.copy=function(){return qn(e,rC()).constant(e.constant())},yn.apply(e,arguments)}function Zg(){var e=Ug(cm());return e.copy=function(){return qn(e,Zg()).exponent(e.exponent())},yn.apply(e,arguments)}function BX(){return Zg.apply(null,arguments).exponent(.5)}function sC(){var e=[],t=Es;function r(s){if(s!=null&&!isNaN(s=+s))return t((jc(e,s,1)-1)/(e.length-1))}return r.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let n of s)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(Dn),r},r.interpolator=function(s){return arguments.length?(t=s,r):t},r.range=function(){return e.map((s,n)=>t(n/(e.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(n,i)=>SK(e,i/s))},r.copy=function(){return sC(t).domain(e)},yn.apply(r,arguments)}function dm(){var e=0,t=.5,r=1,s=1,n,i,o,l,c,d=Es,u,m=!1,f;function h(x){return isNaN(x=+x)?f:(x=.5+((x=+u(x))-i)*(s*x<s*i?l:c),d(m?Math.max(0,Math.min(1,x)):x))}h.domain=function(x){return arguments.length?([e,t,r]=x,n=u(e=+e),i=u(t=+t),o=u(r=+r),l=n===i?0:.5/(i-n),c=i===o?0:.5/(o-i),s=i<n?-1:1,h):[e,t,r]},h.clamp=function(x){return arguments.length?(m=!!x,h):m},h.interpolator=function(x){return arguments.length?(d=x,h):d};function p(x){return function(g){var v,w,y;return arguments.length?([v,w,y]=g,d=JK(x,[v,w,y]),h):[d(0),d(.5),d(1)]}}return h.range=p(Fo),h.rangeRound=p(Fg),h.unknown=function(x){return arguments.length?(f=x,h):f},function(x){return u=x,n=x(e),i=x(t),o=x(r),l=n===i?0:.5/(i-n),c=i===o?0:.5/(o-i),s=i<n?-1:1,h}}function aC(){var e=Gn(dm()(Es));return e.copy=function(){return qn(e,aC())},yn.apply(e,arguments)}function nC(){var e=$g(dm()).domain([.1,1,10]);return e.copy=function(){return qn(e,nC()).base(e.base())},yn.apply(e,arguments)}function iC(){var e=zg(dm());return e.copy=function(){return qn(e,iC()).constant(e.constant())},yn.apply(e,arguments)}function Qg(){var e=Ug(dm());return e.copy=function(){return qn(e,Qg()).exponent(e.exponent())},yn.apply(e,arguments)}function $X(){return Qg.apply(null,arguments).exponent(.5)}const ml=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Dg,scaleDiverging:aC,scaleDivergingLog:nC,scaleDivergingPow:Qg,scaleDivergingSqrt:$X,scaleDivergingSymlog:iC,scaleIdentity:MA,scaleImplicit:Rp,scaleLinear:LA,scaleLog:$A,scaleOrdinal:Og,scalePoint:AK,scalePow:Wg,scaleQuantile:WA,scaleQuantize:HA,scaleRadial:UA,scaleSequential:eC,scaleSequentialLog:tC,scaleSequentialPow:Zg,scaleSequentialQuantile:sC,scaleSequentialSqrt:BX,scaleSequentialSymlog:rC,scaleSqrt:yY,scaleSymlog:zA,scaleThreshold:VA,scaleTime:LX,scaleUtc:MX,tickFormat:FA},Symbol.toStringTag,{value:"Module"}));var Kn=e=>e.chartData,ev=ve([Kn],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),tv=(e,t,r,s)=>s?ev(e):Kn(e);function To(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Qs(t)&&Qs(r))return!0}return!1}function vj(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function zX(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,s]=e,n,i;if(Qs(r))n=r;else if(typeof r=="function")return;if(Qs(s))i=s;else if(typeof s=="function")return;var o=[n,i];if(To(o))return o}}function UX(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var s=e(t,r);if(To(s))return vj(s,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[n,i]=e,o,l;if(n==="auto")t!=null&&(o=Math.min(...t));else if(tt(n))o=n;else if(typeof n=="function")try{t!=null&&(o=n(t?.[0]))}catch{}else if(typeof n=="string"&&lw.test(n)){var c=lw.exec(n);if(c==null||t==null)o=void 0;else{var d=+c[1];o=t[0]-d}}else o=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(tt(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&cw.test(i)){var u=cw.exec(i);if(u==null||t==null)l=void 0;else{var m=+u[1];l=t[1]+m}}else l=t?.[1];var f=[o,l];if(To(f))return t==null?f:vj(f,t,r)}}}var Lo=1e9,WX={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},sv,or=!0,ba="[DecimalError] ",yi=ba+"Invalid argument: ",rv=ba+"Exponent out of range: ",Mo=Math.floor,si=Math.pow,HX=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,qs,Vr=1e7,Qt=7,oC=9007199254740991,du=Mo(oC/Qt),Ge={};Ge.absoluteValue=Ge.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Ge.comparedTo=Ge.cmp=function(e){var t,r,s,n,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,n=e.d.length,t=0,r=s<n?s:n;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===n?0:s>n^i.s<0?1:-1};Ge.decimalPlaces=Ge.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Qt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Ge.dividedBy=Ge.div=function(e){return nn(this,new this.constructor(e))};Ge.dividedToIntegerBy=Ge.idiv=function(e){var t=this,r=t.constructor;return Yt(nn(t,new r(e),0,1),r.precision)};Ge.equals=Ge.eq=function(e){return!this.cmp(e)};Ge.exponent=function(){return Rr(this)};Ge.greaterThan=Ge.gt=function(e){return this.cmp(e)>0};Ge.greaterThanOrEqualTo=Ge.gte=function(e){return this.cmp(e)>=0};Ge.isInteger=Ge.isint=function(){return this.e>this.d.length-2};Ge.isNegative=Ge.isneg=function(){return this.s<0};Ge.isPositive=Ge.ispos=function(){return this.s>0};Ge.isZero=function(){return this.s===0};Ge.lessThan=Ge.lt=function(e){return this.cmp(e)<0};Ge.lessThanOrEqualTo=Ge.lte=function(e){return this.cmp(e)<1};Ge.logarithm=Ge.log=function(e){var t,r=this,s=r.constructor,n=s.precision,i=n+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(qs))throw Error(ba+"NaN");if(r.s<1)throw Error(ba+(r.s?"NaN":"-Infinity"));return r.eq(qs)?new s(0):(or=!1,t=nn(Zl(r,i),Zl(e,i),i),or=!0,Yt(t,n))};Ge.minus=Ge.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?dC(t,e):lC(t,(e.s=-e.s,e))};Ge.modulo=Ge.mod=function(e){var t,r=this,s=r.constructor,n=s.precision;if(e=new s(e),!e.s)throw Error(ba+"NaN");return r.s?(or=!1,t=nn(r,e,0,1).times(e),or=!0,r.minus(t)):Yt(new s(r),n)};Ge.naturalExponential=Ge.exp=function(){return cC(this)};Ge.naturalLogarithm=Ge.ln=function(){return Zl(this)};Ge.negated=Ge.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Ge.plus=Ge.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?lC(t,e):dC(t,(e.s=-e.s,e))};Ge.precision=Ge.sd=function(e){var t,r,s,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(yi+e);if(t=Rr(n)+1,s=n.d.length-1,r=s*Qt+1,s=n.d[s],s){for(;s%10==0;s/=10)r--;for(s=n.d[0];s>=10;s/=10)r++}return e&&t>r?t:r};Ge.squareRoot=Ge.sqrt=function(){var e,t,r,s,n,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ba+"NaN")}for(e=Rr(l),or=!1,n=Math.sqrt(+l),n==0||n==1/0?(t=Ua(l.d),(t.length+e)%2==0&&(t+="0"),n=Math.sqrt(t),e=Mo((e+1)/2)-(e<0||e%2),n==1/0?t="5e"+e:(t=n.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new c(t)):s=new c(n.toString()),r=c.precision,n=o=r+3;;)if(i=s,s=i.plus(nn(l,i,o+2)).times(.5),Ua(i.d).slice(0,o)===(t=Ua(s.d)).slice(0,o)){if(t=t.slice(o-3,o+1),n==o&&t=="4999"){if(Yt(i,r+1,0),i.times(i).eq(l)){s=i;break}}else if(t!="9999")break;o+=4}return or=!0,Yt(s,r)};Ge.times=Ge.mul=function(e){var t,r,s,n,i,o,l,c,d,u=this,m=u.constructor,f=u.d,h=(e=new m(e)).d;if(!u.s||!e.s)return new m(0);for(e.s*=u.s,r=u.e+e.e,c=f.length,d=h.length,c<d&&(i=f,f=h,h=i,o=c,c=d,d=o),i=[],o=c+d,s=o;s--;)i.push(0);for(s=d;--s>=0;){for(t=0,n=c+s;n>s;)l=i[n]+h[s]*f[n-s-1]+t,i[n--]=l%Vr|0,t=l/Vr|0;i[n]=(i[n]+t)%Vr|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,or?Yt(e,m.precision):e};Ge.toDecimalPlaces=Ge.todp=function(e,t){var r=this,s=r.constructor;return r=new s(r),e===void 0?r:(Ga(e,0,Lo),t===void 0?t=s.rounding:Ga(t,0,8),Yt(r,e+Rr(r)+1,t))};Ge.toExponential=function(e,t){var r,s=this,n=s.constructor;return e===void 0?r=Di(s,!0):(Ga(e,0,Lo),t===void 0?t=n.rounding:Ga(t,0,8),s=Yt(new n(s),e+1,t),r=Di(s,!0,e+1)),r};Ge.toFixed=function(e,t){var r,s,n=this,i=n.constructor;return e===void 0?Di(n):(Ga(e,0,Lo),t===void 0?t=i.rounding:Ga(t,0,8),s=Yt(new i(n),e+Rr(n)+1,t),r=Di(s.abs(),!1,e+Rr(s)+1),n.isneg()&&!n.isZero()?"-"+r:r)};Ge.toInteger=Ge.toint=function(){var e=this,t=e.constructor;return Yt(new t(e),Rr(e)+1,t.rounding)};Ge.toNumber=function(){return+this};Ge.toPower=Ge.pow=function(e){var t,r,s,n,i,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(qs);if(l=new c(l),!l.s){if(e.s<1)throw Error(ba+"Infinity");return l}if(l.eq(qs))return l;if(s=c.precision,e.eq(qs))return Yt(l,s);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=oC){for(n=new c(qs),t=Math.ceil(s/Qt+4),or=!1;r%2&&(n=n.times(l),yj(n.d,t)),r=Mo(r/2),r!==0;)l=l.times(l),yj(l.d,t);return or=!0,e.s<0?new c(qs).div(n):Yt(n,s)}}else if(i<0)throw Error(ba+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,or=!1,n=e.times(Zl(l,s+d)),or=!0,n=cC(n),n.s=i,n};Ge.toPrecision=function(e,t){var r,s,n=this,i=n.constructor;return e===void 0?(r=Rr(n),s=Di(n,r<=i.toExpNeg||r>=i.toExpPos)):(Ga(e,1,Lo),t===void 0?t=i.rounding:Ga(t,0,8),n=Yt(new i(n),e,t),r=Rr(n),s=Di(n,e<=r||r<=i.toExpNeg,e)),s};Ge.toSignificantDigits=Ge.tosd=function(e,t){var r=this,s=r.constructor;return e===void 0?(e=s.precision,t=s.rounding):(Ga(e,1,Lo),t===void 0?t=s.rounding:Ga(t,0,8)),Yt(new s(r),e,t)};Ge.toString=Ge.valueOf=Ge.val=Ge.toJSON=Ge[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Rr(e),r=e.constructor;return Di(e,t<=r.toExpNeg||t>=r.toExpPos)};function lC(e,t){var r,s,n,i,o,l,c,d,u=e.constructor,m=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),or?Yt(t,m):t;if(c=e.d,d=t.d,o=e.e,n=t.e,c=c.slice(),i=o-n,i){for(i<0?(s=c,i=-i,l=d.length):(s=d,n=o,l=c.length),o=Math.ceil(m/Qt),l=o>l?o+1:l+1,i>l&&(i=l,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,s=d,d=c,c=s),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/Vr|0,c[i]%=Vr;for(r&&(c.unshift(r),++n),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=n,or?Yt(t,m):t}function Ga(e,t,r){if(e!==~~e||e<t||e>r)throw Error(yi+e)}function Ua(e){var t,r,s,n=e.length-1,i="",o=e[0];if(n>0){for(i+=o,t=1;t<n;t++)s=e[t]+"",r=Qt-s.length,r&&(i+=An(r)),i+=s;o=e[t],s=o+"",r=Qt-s.length,r&&(i+=An(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var nn=(function(){function e(s,n){var i,o=0,l=s.length;for(s=s.slice();l--;)i=s[l]*n+o,s[l]=i%Vr|0,o=i/Vr|0;return o&&s.unshift(o),s}function t(s,n,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(s[l]!=n[l]){c=s[l]>n[l]?1:-1;break}return c}function r(s,n,i){for(var o=0;i--;)s[i]-=o,o=s[i]<n[i]?1:0,s[i]=o*Vr+s[i]-n[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,n,i,o){var l,c,d,u,m,f,h,p,x,g,v,w,y,S,E,N,j,T,C=s.constructor,L=s.s==n.s?1:-1,A=s.d,P=n.d;if(!s.s)return new C(s);if(!n.s)throw Error(ba+"Division by zero");for(c=s.e-n.e,j=P.length,E=A.length,h=new C(L),p=h.d=[],d=0;P[d]==(A[d]||0);)++d;if(P[d]>(A[d]||0)&&--c,i==null?w=i=C.precision:o?w=i+(Rr(s)-Rr(n))+1:w=i,w<0)return new C(0);if(w=w/Qt+2|0,d=0,j==1)for(u=0,P=P[0],w++;(d<E||u)&&w--;d++)y=u*Vr+(A[d]||0),p[d]=y/P|0,u=y%P|0;else{for(u=Vr/(P[0]+1)|0,u>1&&(P=e(P,u),A=e(A,u),j=P.length,E=A.length),S=j,x=A.slice(0,j),g=x.length;g<j;)x[g++]=0;T=P.slice(),T.unshift(0),N=P[0],P[1]>=Vr/2&&++N;do u=0,l=t(P,x,j,g),l<0?(v=x[0],j!=g&&(v=v*Vr+(x[1]||0)),u=v/N|0,u>1?(u>=Vr&&(u=Vr-1),m=e(P,u),f=m.length,g=x.length,l=t(m,x,f,g),l==1&&(u--,r(m,j<f?T:P,f))):(u==0&&(l=u=1),m=P.slice()),f=m.length,f<g&&m.unshift(0),r(x,m,g),l==-1&&(g=x.length,l=t(P,x,j,g),l<1&&(u++,r(x,j<g?T:P,g))),g=x.length):l===0&&(u++,x=[0]),p[d++]=u,l&&x[0]?x[g++]=A[S]||0:(x=[A[S]],g=1);while((S++<E||x[0]!==void 0)&&w--)}return p[0]||p.shift(),h.e=c,Yt(h,o?i+Rr(h)+1:i)}})();function cC(e,t){var r,s,n,i,o,l,c=0,d=0,u=e.constructor,m=u.precision;if(Rr(e)>16)throw Error(rv+Rr(e));if(!e.s)return new u(qs);for(or=!1,l=m,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(s=Math.log(si(2,d))/Math.LN10*2+5|0,l+=s,r=n=i=new u(qs),u.precision=l;;){if(n=Yt(n.times(e),l),r=r.times(++c),o=i.plus(nn(n,r,l)),Ua(o.d).slice(0,l)===Ua(i.d).slice(0,l)){for(;d--;)i=Yt(i.times(i),l);return u.precision=m,t==null?(or=!0,Yt(i,m)):i}i=o}}function Rr(e){for(var t=e.e*Qt,r=e.d[0];r>=10;r/=10)t++;return t}function n0(e,t,r){if(t>e.LN10.sd())throw or=!0,r&&(e.precision=r),Error(ba+"LN10 precision limit exceeded");return Yt(new e(e.LN10),t)}function An(e){for(var t="";e--;)t+="0";return t}function Zl(e,t){var r,s,n,i,o,l,c,d,u,m=1,f=10,h=e,p=h.d,x=h.constructor,g=x.precision;if(h.s<1)throw Error(ba+(h.s?"NaN":"-Infinity"));if(h.eq(qs))return new x(0);if(t==null?(or=!1,d=g):d=t,h.eq(10))return t==null&&(or=!0),n0(x,d);if(d+=f,x.precision=d,r=Ua(p),s=r.charAt(0),i=Rr(h),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)h=h.times(e),r=Ua(h.d),s=r.charAt(0),m++;i=Rr(h),s>1?(h=new x("0."+r),i++):h=new x(s+"."+r.slice(1))}else return c=n0(x,d+2,g).times(i+""),h=Zl(new x(s+"."+r.slice(1)),d-f).plus(c),x.precision=g,t==null?(or=!0,Yt(h,g)):h;for(l=o=h=nn(h.minus(qs),h.plus(qs),d),u=Yt(h.times(h),d),n=3;;){if(o=Yt(o.times(u),d),c=l.plus(nn(o,new x(n),d)),Ua(c.d).slice(0,d)===Ua(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(n0(x,d+2,g).times(i+""))),l=nn(l,new x(m),d),x.precision=g,t==null?(or=!0,Yt(l,g)):l;l=c,n+=2}}function bj(e,t){var r,s,n;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(r<0&&(r=s),r+=+t.slice(s+1),t=t.substring(0,s)):r<0&&(r=t.length),s=0;t.charCodeAt(s)===48;)++s;for(n=t.length;t.charCodeAt(n-1)===48;)--n;if(t=t.slice(s,n),t){if(n-=s,r=r-s-1,e.e=Mo(r/Qt),e.d=[],s=(r+1)%Qt,r<0&&(s+=Qt),s<n){for(s&&e.d.push(+t.slice(0,s)),n-=Qt;s<n;)e.d.push(+t.slice(s,s+=Qt));t=t.slice(s),s=Qt-t.length}else s-=n;for(;s--;)t+="0";if(e.d.push(+t),or&&(e.e>du||e.e<-du))throw Error(rv+r)}else e.s=0,e.e=0,e.d=[0];return e}function Yt(e,t,r){var s,n,i,o,l,c,d,u,m=e.d;for(o=1,i=m[0];i>=10;i/=10)o++;if(s=t-o,s<0)s+=Qt,n=t,d=m[u=0];else{if(u=Math.ceil((s+1)/Qt),i=m.length,u>=i)return e;for(d=i=m[u],o=1;i>=10;i/=10)o++;s%=Qt,n=s-Qt+o}if(r!==void 0&&(i=si(10,o-n-1),l=d/i%10|0,c=t<0||m[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(s>0?n>0?d/si(10,o-n):0:m[u-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return c?(i=Rr(e),m.length=1,t=t-i-1,m[0]=si(10,(Qt-t%Qt)%Qt),e.e=Mo(-t/Qt)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(s==0?(m.length=u,i=1,u--):(m.length=u+1,i=si(10,Qt-s),m[u]=n>0?(d/si(10,o-n)%si(10,n)|0)*i:0),c)for(;;)if(u==0){(m[0]+=i)==Vr&&(m[0]=1,++e.e);break}else{if(m[u]+=i,m[u]!=Vr)break;m[u--]=0,i=1}for(s=m.length;m[--s]===0;)m.pop();if(or&&(e.e>du||e.e<-du))throw Error(rv+Rr(e));return e}function dC(e,t){var r,s,n,i,o,l,c,d,u,m,f=e.constructor,h=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),or?Yt(t,h):t;if(c=e.d,m=t.d,s=t.e,d=e.e,c=c.slice(),o=d-s,o){for(u=o<0,u?(r=c,o=-o,l=m.length):(r=m,s=d,l=c.length),n=Math.max(Math.ceil(h/Qt),l)+2,o>n&&(o=n,r.length=1),r.reverse(),n=o;n--;)r.push(0);r.reverse()}else{for(n=c.length,l=m.length,u=n<l,u&&(l=n),n=0;n<l;n++)if(c[n]!=m[n]){u=c[n]<m[n];break}o=0}for(u&&(r=c,c=m,m=r,t.s=-t.s),l=c.length,n=m.length-l;n>0;--n)c[l++]=0;for(n=m.length;n>o;){if(c[--n]<m[n]){for(i=n;i&&c[--i]===0;)c[i]=Vr-1;--c[i],c[n]+=Vr}c[n]-=m[n]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--s;return c[0]?(t.d=c,t.e=s,or?Yt(t,h):t):new f(0)}function Di(e,t,r){var s,n=Rr(e),i=Ua(e.d),o=i.length;return t?(r&&(s=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+An(s):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(n<0?"e":"e+")+n):n<0?(i="0."+An(-n-1)+i,r&&(s=r-o)>0&&(i+=An(s))):n>=o?(i+=An(n+1-o),r&&(s=r-n-1)>0&&(i=i+"."+An(s))):((s=n+1)<o&&(i=i.slice(0,s)+"."+i.slice(s)),r&&(s=r-o)>0&&(n+1===o&&(i+="."),i+=An(s))),e.s<0?"-"+i:i}function yj(e,t){if(e.length>t)return e.length=t,!0}function uC(e){var t,r,s;function n(i){var o=this;if(!(o instanceof n))return new n(i);if(o.constructor=n,i instanceof n){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(yi+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return bj(o,i.toString())}else if(typeof i!="string")throw Error(yi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,HX.test(i))bj(o,i);else throw Error(yi+i)}if(n.prototype=Ge,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.clone=uC,n.config=n.set=VX,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(r=s[t++])||(e[r]=this[r]);return n.config(e),n}function VX(e){if(!e||typeof e!="object")throw Error(ba+"Object expected");var t,r,s,n=["precision",1,Lo,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<n.length;t+=3)if((s=e[r=n[t]])!==void 0)if(Mo(s)===s&&s>=n[t+1]&&s<=n[t+2])this[r]=s;else throw Error(yi+r+": "+s);if((s=e[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(yi+r+": "+s);return this}var sv=uC(WX);qs=new sv(1);const zt=sv;var GX=e=>e,mC={},fC=e=>e===mC,wj=e=>function t(){return arguments.length===0||arguments.length===1&&fC(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},hC=(e,t)=>e===1?t:wj(function(){for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];var i=s.filter(o=>o!==mC).length;return i>=e?t(...s):hC(e-i,wj(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var d=s.map(u=>fC(u)?l.shift():u);return t(...d,...l)}))}),um=e=>hC(e.length,e),Bp=(e,t)=>{for(var r=[],s=e;s<t;++s)r[s-e]=s;return r},qX=um((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),KX=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];if(!r.length)return GX;var n=r.reverse(),i=n[0],o=n.slice(1);return function(){return o.reduce((l,c)=>c(l),i(...arguments))}},$p=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),pC=e=>{var t=null,r=null;return function(){for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];return t&&n.every((o,l)=>{var c;return o===((c=t)===null||c===void 0?void 0:c[l])})||(t=n,r=e(...n)),r}};function xC(e){var t;return e===0?t=1:t=Math.floor(new zt(e).abs().log(10).toNumber())+1,t}function gC(e,t,r){for(var s=new zt(e),n=0,i=[];s.lt(t)&&n<1e5;)i.push(s.toNumber()),s=s.add(r),n++;return i}um((e,t,r)=>{var s=+e,n=+t;return s+r*(n-s)});um((e,t,r)=>{var s=t-+e;return s=s||1/0,(r-e)/s});um((e,t,r)=>{var s=t-+e;return s=s||1/0,Math.max(0,Math.min(1,(r-e)/s))});var vC=e=>{var[t,r]=e,[s,n]=[t,r];return t>r&&([s,n]=[r,t]),[s,n]},bC=(e,t,r)=>{if(e.lte(0))return new zt(0);var s=xC(e.toNumber()),n=new zt(10).pow(s),i=e.div(n),o=s!==1?.05:.1,l=new zt(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(n);return t?new zt(c.toNumber()):new zt(Math.ceil(c.toNumber()))},YX=(e,t,r)=>{var s=new zt(1),n=new zt(e);if(!n.isint()&&r){var i=Math.abs(e);i<1?(s=new zt(10).pow(xC(e)-1),n=new zt(Math.floor(n.div(s).toNumber())).mul(s)):i>1&&(n=new zt(Math.floor(e)))}else e===0?n=new zt(Math.floor((t-1)/2)):r||(n=new zt(Math.floor(e)));var o=Math.floor((t-1)/2),l=KX(qX(c=>n.add(new zt(c-o).mul(s)).toNumber()),Bp);return l(0,t)},yC=function(t,r,s,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(s-1)))return{step:new zt(0),tickMin:new zt(0),tickMax:new zt(0)};var o=bC(new zt(r).sub(t).div(s-1),n,i),l;t<=0&&r>=0?l=new zt(0):(l=new zt(t).add(r).div(2),l=l.sub(new zt(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),d=Math.ceil(new zt(r).sub(l).div(o).toNumber()),u=c+d+1;return u>s?yC(t,r,s,n,i+1):(u<s&&(d=r>0?d+(s-u):d,c=r>0?c:c+(s-u)),{step:o,tickMin:l.sub(new zt(c).mul(o)),tickMax:l.add(new zt(d).mul(o))})};function XX(e){var[t,r]=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(s,2),[o,l]=vC([t,r]);if(o===-1/0||l===1/0){var c=l===1/0?[o,...Bp(0,s-1).map(()=>1/0)]:[...Bp(0,s-1).map(()=>-1/0),l];return t>r?$p(c):c}if(o===l)return YX(o,s,n);var{step:d,tickMin:u,tickMax:m}=yC(o,l,i,n,0),f=gC(u,m.add(new zt(.1).mul(d)),d);return t>r?$p(f):f}function JX(e,t){var[r,s]=e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=vC([r,s]);if(i===-1/0||o===1/0)return[r,s];if(i===o)return[i];var l=Math.max(t,2),c=bC(new zt(o).sub(i).div(l-1),n,0),d=[...gC(new zt(i),new zt(o),c),o];return n===!1&&(d=d.map(u=>Math.round(u))),r>s?$p(d):d}var ZX=pC(XX),QX=pC(JX),wC=e=>e.rootProps.maxBarSize,eJ=e=>e.rootProps.barGap,jC=e=>e.rootProps.barCategoryGap,tJ=e=>e.rootProps.barSize,Tc=e=>e.rootProps.stackOffset,av=e=>e.options.chartName,nv=e=>e.rootProps.syncId,NC=e=>e.rootProps.syncMethod,iv=e=>e.options.eventEmitter,Xa={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Us={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},mm=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},rJ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Xa.angleAxisId,includeHidden:!1,name:void 0,reversed:Xa.reversed,scale:Xa.scale,tick:Xa.tick,tickCount:void 0,ticks:void 0,type:Xa.type,unit:void 0},sJ={allowDataOverflow:Us.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Us.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Us.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Us.scale,tick:Us.tick,tickCount:Us.tickCount,ticks:void 0,type:Us.type,unit:void 0},aJ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Xa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Xa.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Xa.scale,tick:Xa.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},nJ={allowDataOverflow:Us.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Us.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Us.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Us.scale,tick:Us.tick,tickCount:Us.tickCount,ticks:void 0,type:"category",unit:void 0},ov=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?aJ:rJ,lv=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?nJ:sJ,fm=e=>e.polarOptions,cv=ve([vn,bn,zr],nA),SC=ve([fm,cv],(e,t)=>{if(e!=null)return xs(e.innerRadius,t,0)}),EC=ve([fm,cv],(e,t)=>{if(e!=null)return xs(e.outerRadius,t,t*.8)}),iJ=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},TC=ve([fm],iJ);ve([ov,TC],mm);var AC=ve([cv,SC,EC],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});ve([lv,AC],mm);var CC=ve([Dt,fm,SC,EC,vn,bn],(e,t,r,s,n,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||s==null)){var{cx:o,cy:l,startAngle:c,endAngle:d}=t;return{cx:xs(o,n,n/2),cy:xs(l,i,i/2),innerRadius:r,outerRadius:s,startAngle:c,endAngle:d,clockWise:!1}}}),lr=(e,t)=>t,Ac=(e,t,r)=>r;function dv(e){return e?.id}var Wr=e=>{var t=Dt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Bo=e=>e.tooltip.settings.axisId,Jr=e=>{var t=Wr(e),r=Bo(e);return Cc(e,t,r)},_C=ve([Jr],e=>e?.dataKey);function kC(e,t,r){var{chartData:s=[]}=t,{allowDuplicatedCategory:n,dataKey:i}=r,o=new Map;return e.forEach(l=>{var c,d=(c=l.data)!==null&&c!==void 0?c:s;if(!(d==null||d.length===0)){var u=dv(l);d.forEach((m,f)=>{var h=i==null||n?f:String(hr(m,i,null)),p=hr(m,l.dataKey,0),x;o.has(h)?x=o.get(h):x={},Object.assign(x,{[u]:p}),o.set(h,x)})}}),Array.from(o.values())}function hm(e){return e.stackId!=null&&e.dataKey!=null}function jj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function uu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jj(Object(r),!0).forEach(function(s){oJ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function oJ(e,t,r){return(t=lJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lJ(e){var t=cJ(e,"string");return typeof t=="symbol"?t:t+""}function cJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zp=[0,"auto"],$s={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},PC=(e,t)=>e.cartesianAxis.xAxis[t],wn=(e,t)=>{var r=PC(e,t);return r??$s},zs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:zp,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:wc},OC=(e,t)=>e.cartesianAxis.yAxis[t],jn=(e,t)=>{var r=OC(e,t);return r??zs},dJ={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},uv=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??dJ},kr=(e,t,r)=>{switch(t){case"xAxis":return wn(e,r);case"yAxis":return jn(e,r);case"zAxis":return uv(e,r);case"angleAxis":return ov(e,r);case"radiusAxis":return lv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},uJ=(e,t,r)=>{switch(t){case"xAxis":return wn(e,r);case"yAxis":return jn(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Cc=(e,t,r)=>{switch(t){case"xAxis":return wn(e,r);case"yAxis":return jn(e,r);case"angleAxis":return ov(e,r);case"radiusAxis":return lv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},DC=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function mv(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var fv=e=>e.graphicalItems.cartesianItems,mJ=ve([lr,Ac],mv),hv=(e,t,r)=>e.filter(r).filter(s=>t?.includeHidden===!0?!0:!s.hide),_c=ve([fv,kr,mJ],hv),IC=ve([_c],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(hm)),RC=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),FC=ve([_c],RC),pv=e=>e.map(t=>t.data).filter(Boolean).flat(1),fJ=ve([_c],pv),xv=(e,t)=>{var{chartData:r=[],dataStartIndex:s,dataEndIndex:n}=t;return e.length>0?e:r.slice(s,n+1)},gv=ve([fJ,tv],xv),vv=(e,t,r)=>t?.dataKey!=null?e.map(s=>({value:hr(s,t.dataKey)})):r.length>0?r.map(s=>s.dataKey).flatMap(s=>e.map(n=>({value:hr(n,s)}))):e.map(s=>({value:s})),pm=ve([gv,kr,_c],vv);function LC(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Yi(e){return e.filter(t=>Va(t)||t instanceof Date).map(Number).filter(t=>Js(t)===!1)}function hJ(e,t,r){return!r||typeof t!="number"||Js(t)?[]:r.length?Yi(r.flatMap(s=>{var n=hr(e,s.dataKey),i,o;if(Array.isArray(n)?[i,o]=n:i=o=n,!(!Qs(i)||!Qs(o)))return[t-i,t+o]})):[]}var pJ=ve([IC,tv,Jr],kC),MC=(e,t,r)=>{var s={},n=t.reduce((i,o)=>(o.stackId==null||(i[o.stackId]==null&&(i[o.stackId]=[]),i[o.stackId].push(o)),i),s);return Object.fromEntries(Object.entries(n).map(i=>{var[o,l]=i,c=l.map(dv);return[o,{stackedData:bG(e,c,r),graphicalItems:l}]}))},Up=ve([pJ,IC,Tc],MC),BC=(e,t,r)=>{var{dataStartIndex:s,dataEndIndex:n}=t;if(r!=="zAxis"){var i=SG(e,s,n);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},xJ=ve([Up,Kn,lr],BC),$C=(e,t,r,s,n)=>r.length>0?e.flatMap(i=>r.flatMap(o=>{var l,c,d=(l=s[o.id])===null||l===void 0?void 0:l.filter(m=>LC(n,m)),u=hr(i,(c=t.dataKey)!==null&&c!==void 0?c:o.dataKey);return{value:u,errorDomain:hJ(i,u,d)}})).filter(Boolean):t?.dataKey!=null?e.map(i=>({value:hr(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),xm=e=>e.errorBars,zC=(e,t,r)=>e.flatMap(s=>t[s.id]).filter(Boolean).filter(s=>LC(r,s));ve([FC,xm,lr],zC);var gJ=ve([gv,kr,FC,xm,lr],$C);function vJ(e){var{value:t}=e;if(Va(t)||t instanceof Date)return t}var Nj=e=>{var t=e.flatMap(s=>[s.value,s.errorDomain]).flat(1),r=Yi(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},bJ=(e,t,r)=>{var s=e.map(vJ).filter(n=>n!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&eT(s))?TA(0,e.length):t.allowDuplicatedCategory?s:Array.from(new Set(s))},bv=e=>{var t;if(e==null||!("domain"in e))return zp;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Yi(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:zp},mu=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var n=r.filter(Boolean);if(n.length!==0){var i=n.flat(),o=Math.min(...i),l=Math.max(...i);return[o,l]}},UC=e=>e.referenceElements.dots,$o=(e,t,r)=>e.filter(s=>s.ifOverflow==="extendDomain").filter(s=>t==="xAxis"?s.xAxisId===r:s.yAxisId===r),yJ=ve([UC,lr,Ac],$o),WC=e=>e.referenceElements.areas,wJ=ve([WC,lr,Ac],$o),HC=e=>e.referenceElements.lines,jJ=ve([HC,lr,Ac],$o),VC=(e,t)=>{var r=Yi(e.map(s=>t==="xAxis"?s.x:s.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},NJ=ve(yJ,lr,VC),GC=(e,t)=>{var r=Yi(e.flatMap(s=>[t==="xAxis"?s.x1:s.y1,t==="xAxis"?s.x2:s.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},SJ=ve([wJ,lr],GC),qC=(e,t)=>{var r=Yi(e.map(s=>t==="xAxis"?s.x:s.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},EJ=ve(jJ,lr,qC),TJ=ve(NJ,EJ,SJ,(e,t,r)=>mu(e,r,t)),KC=ve([kr],bv),yv=(e,t,r,s,n,i,o)=>{var l=zX(t,e.allowDataOverflow);if(l!=null)return l;var c=i==="vertical"&&o==="xAxis"||i==="horizontal"&&o==="yAxis",d=c?mu(r,n,Nj(s)):mu(n,Nj(s));return UX(t,d,e.allowDataOverflow)},AJ=ve([kr,KC,xJ,gJ,TJ,Dt,lr],yv),CJ=[0,1],wv=(e,t,r,s,n,i,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,d=Vi(t,i);return d&&l==null?TA(0,r.length):c==="category"?bJ(s,e,d):n==="expand"?CJ:o}},jv=ve([kr,Dt,gv,pm,Tc,lr,AJ],wv),YC=(e,t,r,s,n)=>{if(e!=null){var{scale:i,type:o}=e;if(i==="auto")return t==="radial"&&n==="radiusAxis"?"band":t==="radial"&&n==="angleAxis"?"linear":o==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(gc(i));return l in ml?l:"point"}}},zo=ve([kr,Dt,DC,av,lr],YC);function _J(e){if(e!=null){if(e in ml)return ml[e]();var t="scale".concat(gc(e));if(t in ml)return ml[t]()}}function Nv(e,t,r,s){if(!(r==null||s==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(s);var n=_J(t);if(n!=null){var i=n.domain(r).range(s);return hG(i),i}}}var Sv=(e,t,r)=>{var s=bv(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&To(e))return ZX(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&To(e))return QX(e,t.tickCount,t.allowDecimals)}},Ev=ve([jv,Cc,zo],Sv),Tv=(e,t,r,s)=>{if(s!=="angleAxis"&&e?.type==="number"&&To(t)&&Array.isArray(r)&&r.length>0){var n=t[0],i=r[0],o=t[1],l=r[r.length-1];return[Math.min(n,i),Math.max(o,l)]}return t},kJ=ve([kr,jv,Ev,lr],Tv),PJ=ve(pm,kr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,s=Array.from(Yi(e.map(l=>l.value))).sort((l,c)=>l-c);if(s.length<2)return 1/0;var n=s[s.length-1]-s[0];if(n===0)return 1/0;for(var i=0;i<s.length-1;i++){var o=s[i+1]-s[i];r=Math.min(r,o)}return r/n}}),XC=ve(PJ,Dt,jC,zr,(e,t,r,s)=>s,(e,t,r,s,n)=>{if(!Qs(e))return 0;var i=t==="vertical"?s.height:s.width;if(n==="gap")return e*i/2;if(n==="no-gap"){var o=xs(r,e*i),l=e*i/2;return l-o-(l-o)/i*o}return 0}),OJ=(e,t)=>{var r=wn(e,t);return r==null||typeof r.padding!="string"?0:XC(e,"xAxis",t,r.padding)},DJ=(e,t)=>{var r=jn(e,t);return r==null||typeof r.padding!="string"?0:XC(e,"yAxis",t,r.padding)},IJ=ve(wn,OJ,(e,t)=>{var r,s;if(e==null)return{left:0,right:0};var{padding:n}=e;return typeof n=="string"?{left:t,right:t}:{left:((r=n.left)!==null&&r!==void 0?r:0)+t,right:((s=n.right)!==null&&s!==void 0?s:0)+t}}),RJ=ve(jn,DJ,(e,t)=>{var r,s;if(e==null)return{top:0,bottom:0};var{padding:n}=e;return typeof n=="string"?{top:t,bottom:t}:{top:((r=n.top)!==null&&r!==void 0?r:0)+t,bottom:((s=n.bottom)!==null&&s!==void 0?s:0)+t}}),FJ=ve([zr,IJ,rm,tm,(e,t,r)=>r],(e,t,r,s,n)=>{var{padding:i}=s;return n?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),LJ=ve([zr,Dt,RJ,rm,tm,(e,t,r)=>r],(e,t,r,s,n,i)=>{var{padding:o}=n;return i?[s.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),kc=(e,t,r,s)=>{var n;switch(t){case"xAxis":return FJ(e,r,s);case"yAxis":return LJ(e,r,s);case"zAxis":return(n=uv(e,r))===null||n===void 0?void 0:n.range;case"angleAxis":return TC(e);case"radiusAxis":return AC(e,r);default:return}},JC=ve([kr,kc],mm),Uo=ve([kr,zo,kJ,JC],Nv);ve([_c,xm,lr],zC);function ZC(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var gm=(e,t)=>t,vm=(e,t,r)=>r,MJ=ve(Qu,gm,vm,(e,t,r)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===r).sort(ZC)),BJ=ve(em,gm,vm,(e,t,r)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===r).sort(ZC)),QC=(e,t)=>({width:e.width,height:t.height}),$J=(e,t)=>{var r=typeof t.width=="number"?t.width:wc;return{width:r,height:e.height}},e_=ve(zr,wn,QC),zJ=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},UJ=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},WJ=ve(bn,zr,MJ,gm,vm,(e,t,r,s,n)=>{var i={},o;return r.forEach(l=>{var c=QC(t,l);o==null&&(o=zJ(t,s,e));var d=s==="top"&&!n||s==="bottom"&&n;i[l.id]=o-Number(d)*c.height,o+=(d?-1:1)*c.height}),i}),HJ=ve(vn,zr,BJ,gm,vm,(e,t,r,s,n)=>{var i={},o;return r.forEach(l=>{var c=$J(t,l);o==null&&(o=UJ(t,s,e));var d=s==="left"&&!n||s==="right"&&n;i[l.id]=o-Number(d)*c.width,o+=(d?-1:1)*c.width}),i}),VJ=(e,t)=>{var r=wn(e,t);if(r!=null)return WJ(e,r.orientation,r.mirror)},GJ=ve([zr,wn,VJ,(e,t)=>t],(e,t,r,s)=>{if(t!=null){var n=r?.[s];return n==null?{x:e.left,y:0}:{x:e.left,y:n}}}),qJ=(e,t)=>{var r=jn(e,t);if(r!=null)return HJ(e,r.orientation,r.mirror)},KJ=ve([zr,jn,qJ,(e,t)=>t],(e,t,r,s)=>{if(t!=null){var n=r?.[s];return n==null?{x:0,y:e.top}:{x:n,y:e.top}}}),t_=ve(zr,jn,(e,t)=>{var r=typeof t.width=="number"?t.width:wc;return{width:r,height:e.height}}),Sj=(e,t,r)=>{switch(t){case"xAxis":return e_(e,r).width;case"yAxis":return t_(e,r).height;default:return}},r_=(e,t,r,s)=>{if(r!=null){var{allowDuplicatedCategory:n,type:i,dataKey:o}=r,l=Vi(e,s),c=t.map(d=>d.value);if(o&&l&&i==="category"&&n&&eT(c))return c}},Av=ve([Dt,pm,kr,lr],r_),s_=(e,t,r,s)=>{if(!(r==null||r.dataKey==null)){var{type:n,scale:i}=r,o=Vi(e,s);if(o&&(n==="number"||i!=="auto"))return t.map(l=>l.value)}},Cv=ve([Dt,pm,Cc,lr],s_),Ej=ve([Dt,uJ,zo,Uo,Av,Cv,kc,Ev,lr],(e,t,r,s,n,i,o,l,c)=>{if(t==null)return null;var d=Vi(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:n,isCategorical:d,niceTicks:l,range:o,realScaleType:r,scale:s}}),YJ=(e,t,r,s,n,i,o,l,c)=>{if(!(t==null||s==null)){var d=Vi(e,c),{type:u,ticks:m,tickCount:f}=t,h=r==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,p=u==="category"&&s.bandwidth?s.bandwidth()/h:0;p=c==="angleAxis"&&i!=null&&i.length>=2?Kr(i[0]-i[1])*2*p:p;var x=m||n;if(x){var g=x.map((v,w)=>{var y=o?o.indexOf(v):v;return{index:w,coordinate:s(y)+p,value:v,offset:p}});return g.filter(v=>!Js(v.coordinate))}return d&&l?l.map((v,w)=>({coordinate:s(v)+p,value:v,index:w,offset:p})):s.ticks?s.ticks(f).map(v=>({coordinate:s(v)+p,value:v,offset:p})):s.domain().map((v,w)=>({coordinate:s(v)+p,value:o?o[v]:v,index:w,offset:p}))}},a_=ve([Dt,Cc,zo,Uo,Ev,kc,Av,Cv,lr],YJ),XJ=(e,t,r,s,n,i,o)=>{if(!(t==null||r==null||s==null||s[0]===s[1])){var l=Vi(e,o),{tickCount:c}=t,d=0;return d=o==="angleAxis"&&s?.length>=2?Kr(s[0]-s[1])*2*d:d,l&&i?i.map((u,m)=>({coordinate:r(u)+d,value:u,index:m,offset:d})):r.ticks?r.ticks(c).map(u=>({coordinate:r(u)+d,value:u,offset:d})):r.domain().map((u,m)=>({coordinate:r(u)+d,value:n?n[u]:u,index:m,offset:d}))}},Ao=ve([Dt,Cc,Uo,kc,Av,Cv,lr],XJ),Co=ve(kr,Uo,(e,t)=>{if(!(e==null||t==null))return uu(uu({},e),{},{scale:t})}),JJ=ve([kr,zo,jv,JC],Nv);ve((e,t,r)=>uv(e,r),JJ,(e,t)=>{if(!(e==null||t==null))return uu(uu({},e),{},{scale:t})});var ZJ=ve([Dt,Qu,em],(e,t,r)=>{switch(e){case"horizontal":return t.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),n_=e=>e.options.defaultTooltipEventType,i_=e=>e.options.validateTooltipEventTypes;function o_(e,t,r){if(e==null)return t;var s=e?"axis":"item";return r==null?t:r.includes(s)?s:t}function _v(e,t){var r=n_(e),s=i_(e);return o_(t,r,s)}function QJ(e){return Xe(t=>_v(t,e))}var l_=(e,t)=>{var r,s=Number(t);if(!(Js(s)||t==null))return s>=0?e==null||(r=e[s])===null||r===void 0?void 0:r.value:void 0},eZ=e=>e.tooltip.settings,_n={active:!1,index:null,dataKey:void 0,coordinate:void 0},tZ={itemInteraction:{click:_n,hover:_n},axisInteraction:{click:_n,hover:_n},keyboardInteraction:_n,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},c_=ea({name:"tooltip",initialState:tZ,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=an(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:rZ,removeTooltipEntrySettings:sZ,setTooltipSettingsState:aZ,setActiveMouseOverItemIndex:d_,mouseLeaveItem:nZ,mouseLeaveChart:u_,setActiveClickItemIndex:iZ,setMouseOverAxisIndex:m_,setMouseClickAxisIndex:oZ,setSyncInteraction:Wp,setKeyboardInteraction:Hp}=c_.actions,lZ=c_.reducer;function Tj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function cd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tj(Object(r),!0).forEach(function(s){cZ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function cZ(e,t,r){return(t=dZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dZ(e){var t=uZ(e,"string");return typeof t=="symbol"?t:t+""}function uZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mZ(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function fZ(e){return e.index!=null}var f_=(e,t,r,s)=>{if(t==null)return _n;var n=mZ(e,t,r);if(n==null)return _n;if(n.active)return n;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(fZ(n)){if(i)return cd(cd({},n),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s};return cd(cd({},_n),{},{coordinate:n.coordinate})},kv=(e,t)=>{var r=e?.index;if(r==null)return null;var s=Number(r);if(!Qs(s))return r;var n=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(n,Math.min(s,i)))},h_=(e,t,r,s,n,i,o,l)=>{if(!(i==null||l==null)){var c=o[0],d=c==null?void 0:l(c.positions,i);if(d!=null)return d;var u=n?.[Number(i)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(s.top+t)/2};default:return{x:(s.left+e)/2,y:u.coordinate}}}},p_=(e,t,r,s)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var n;return r==="hover"?n=e.itemInteraction.hover.dataKey:n=e.itemInteraction.click.dataKey,n==null&&s!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.dataKey)===n})},Pc=e=>e.options.tooltipPayloadSearcher,Wo=e=>e.tooltip;function Aj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Cj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Aj(Object(r),!0).forEach(function(s){hZ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Aj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function hZ(e,t,r){return(t=pZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pZ(e){var t=xZ(e,"string");return typeof t=="symbol"?t:t+""}function xZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gZ(e,t){return e??t}var x_=(e,t,r,s,n,i,o)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:d,dataEndIndex:u}=r,m=[];return e.reduce((f,h)=>{var p,{dataDefinedOnItem:x,settings:g}=h,v=gZ(x,l),w=Array.isArray(v)?iA(v,d,u):v,y=(p=g?.dataKey)!==null&&p!==void 0?p:s,S=g?.nameKey,E;if(s&&Array.isArray(w)&&!Array.isArray(w[0])&&o==="axis"?E=sW(w,s,n):E=i(w,t,c,S),Array.isArray(E))E.forEach(j=>{var T=Cj(Cj({},g),{},{name:j.name,unit:j.unit,color:void 0,fill:void 0});f.push(dw({tooltipEntrySettings:T,dataKey:j.dataKey,payload:j.payload,value:hr(j.payload,j.dataKey),name:j.name}))});else{var N;f.push(dw({tooltipEntrySettings:g,dataKey:y,payload:E,value:hr(E,y),name:(N=hr(E,S))!==null&&N!==void 0?N:g?.name}))}return f},m)}},Pv=ve([Jr,Dt,DC,av,Wr],YC),vZ=ve([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),bZ=ve([Wr,Bo],mv),Oc=ve([vZ,Jr,bZ],hv),yZ=ve([Oc],e=>e.filter(hm)),wZ=ve([Oc],pv),Ho=ve([wZ,Kn],xv),jZ=ve([yZ,Kn,Jr],kC),Ov=ve([Ho,Jr,Oc],vv),NZ=ve([Jr],bv),SZ=ve([Oc],e=>e.filter(hm)),EZ=ve([jZ,SZ,Tc],MC),TZ=ve([EZ,Kn,Wr],BC),AZ=ve([Oc],RC),CZ=ve([Ho,Jr,AZ,xm,Wr],$C),_Z=ve([UC,Wr,Bo],$o),kZ=ve([_Z,Wr],VC),PZ=ve([WC,Wr,Bo],$o),OZ=ve([PZ,Wr],GC),DZ=ve([HC,Wr,Bo],$o),IZ=ve([DZ,Wr],qC),RZ=ve([kZ,IZ,OZ],mu),FZ=ve([Jr,NZ,TZ,CZ,RZ,Dt,Wr],yv),g_=ve([Jr,Dt,Ho,Ov,Tc,Wr,FZ],wv),LZ=ve([g_,Jr,Pv],Sv),MZ=ve([Jr,g_,LZ,Wr],Tv),v_=e=>{var t=Wr(e),r=Bo(e),s=!1;return kc(e,t,r,s)},b_=ve([Jr,v_],mm),y_=ve([Jr,Pv,MZ,b_],Nv),BZ=ve([Dt,Ov,Jr,Wr],r_),$Z=ve([Dt,Ov,Jr,Wr],s_),zZ=(e,t,r,s,n,i,o,l)=>{if(t){var{type:c}=t,d=Vi(e,l);if(s){var u=r==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,m=c==="category"&&s.bandwidth?s.bandwidth()/u:0;return m=l==="angleAxis"&&n!=null&&n?.length>=2?Kr(n[0]-n[1])*2*m:m,d&&o?o.map((f,h)=>({coordinate:s(f)+m,value:f,index:h,offset:m})):s.domain().map((f,h)=>({coordinate:s(f)+m,value:i?i[f]:f,index:h,offset:m}))}}},Nn=ve([Dt,Jr,Pv,y_,v_,BZ,$Z,Wr],zZ),Dv=ve([n_,i_,eZ],(e,t,r)=>o_(r.shared,e,t)),w_=e=>e.tooltip.settings.trigger,Iv=e=>e.tooltip.settings.defaultIndex,bm=ve([Wo,Dv,w_,Iv],f_),Ii=ve([bm,Ho],kv),j_=ve([Nn,Ii],l_),N_=ve([bm],e=>{if(e)return e.dataKey}),S_=ve([Wo,Dv,w_,Iv],p_),UZ=ve([vn,bn,Dt,zr,Nn,Iv,S_,Pc],h_),WZ=ve([bm,UZ],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),HZ=ve([bm],e=>e.active),VZ=ve([S_,Ii,Kn,_C,j_,Pc,Dv],x_);ve([VZ],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function _j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function kj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_j(Object(r),!0).forEach(function(s){GZ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_j(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function GZ(e,t,r){return(t=qZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qZ(e){var t=KZ(e,"string");return typeof t=="symbol"?t:t+""}function KZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YZ=()=>Xe(Jr),XZ=()=>{var e=YZ(),t=Xe(Nn),r=Xe(y_);return Sg(kj(kj({},e),{},{scale:r}),t)},JZ=()=>Xe(av),Rv=(e,t)=>t,E_=(e,t,r)=>r,Fv=(e,t,r,s)=>s,ZZ=ve(Nn,e=>Gu(e,t=>t.coordinate)),Lv=ve([Wo,Rv,E_,Fv],f_),T_=ve([Lv,Ho],kv),QZ=(e,t,r)=>{if(t!=null){var s=Wo(e);return t==="axis"?r==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:r==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},A_=ve([Wo,Rv,E_,Fv],p_),fu=ve([vn,bn,Dt,zr,Nn,Fv,A_,Pc],h_),eQ=ve([Lv,fu],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),C_=ve(Nn,T_,l_),tQ=ve([A_,T_,Kn,_C,C_,Pc,Rv],x_),rQ=ve([Lv],e=>({isActive:e.active,activeIndex:e.index})),sQ=(e,t,r,s,n,i,o,l)=>{if(!(!e||!t||!s||!n||!i)){var c=EG(e.chartX,e.chartY,t,r,l);if(c){var d=AG(c,t),u=mG(d,o,i,s,n),m=TG(t,i,u,c);return{activeIndex:String(u),activeCoordinate:m}}}};function Vp(){return Vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Vp.apply(null,arguments)}function Pj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function dd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pj(Object(r),!0).forEach(function(s){aQ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function aQ(e,t,r){return(t=nQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nQ(e){var t=iQ(e,"string");return typeof t=="symbol"?t:t+""}function iQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oQ(e){var{coordinate:t,payload:r,index:s,offset:n,tooltipAxisBandSize:i,layout:o,cursor:l,tooltipEventType:c,chartName:d}=e,u=t,m=r,f=s;if(!l||!u||d!=="ScatterChart"&&c!=="axis")return null;var h,p;if(d==="ScatterChart")h=u,p=Aq;else if(d==="BarChart")h=Cq(o,u,n,i),p=jA;else if(o==="radial"){var{cx:x,cy:g,radius:v,startAngle:w,endAngle:y}=NA(u);h={cx:x,cy:g,startAngle:w,endAngle:y,innerRadius:v,outerRadius:v},p=EA}else h={points:oK(o,u,n)},p=gA;var S=typeof l=="object"&&"className"in l?l.className:void 0,E=dd(dd(dd(dd({stroke:"#ccc",pointerEvents:"none"},n),h),$r(l,!1)),{},{payload:m,payloadIndex:f,className:Et("recharts-tooltip-cursor",S)});return b.isValidElement(l)?b.cloneElement(l,E):b.createElement(p,E)}function lQ(e){var t=XZ(),r=mA(),s=_g(),n=JZ();return b.createElement(oQ,Vp({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:s,tooltipAxisBandSize:t,chartName:n}))}var __=b.createContext(null),cQ=()=>b.useContext(__),i0={exports:{}},Oj;function dQ(){return Oj||(Oj=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,m,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new n(u,m||c,f),p=r?r+d:d;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new s:delete c._events[d]}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,m;if(this._eventsCount===0)return d;for(m in u=this._events)t.call(u,m)&&d.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,m=this._events[u];if(!m)return[];if(m.fn)return[m.fn];for(var f=0,h=m.length,p=new Array(h);f<h;f++)p[f]=m[f].fn;return p},l.prototype.listenerCount=function(d){var u=r?r+d:d,m=this._events[u];return m?m.fn?1:m.length:0},l.prototype.emit=function(d,u,m,f,h,p){var x=r?r+d:d;if(!this._events[x])return!1;var g=this._events[x],v=arguments.length,w,y;if(g.fn){switch(g.once&&this.removeListener(d,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,m),!0;case 4:return g.fn.call(g.context,u,m,f),!0;case 5:return g.fn.call(g.context,u,m,f,h),!0;case 6:return g.fn.call(g.context,u,m,f,h,p),!0}for(y=1,w=new Array(v-1);y<v;y++)w[y-1]=arguments[y];g.fn.apply(g.context,w)}else{var S=g.length,E;for(y=0;y<S;y++)switch(g[y].once&&this.removeListener(d,g[y].fn,void 0,!0),v){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,u);break;case 3:g[y].fn.call(g[y].context,u,m);break;case 4:g[y].fn.call(g[y].context,u,m,f);break;default:if(!w)for(E=1,w=new Array(v-1);E<v;E++)w[E-1]=arguments[E];g[y].fn.apply(g[y].context,w)}}return!0},l.prototype.on=function(d,u,m){return i(this,d,u,m,!1)},l.prototype.once=function(d,u,m){return i(this,d,u,m,!0)},l.prototype.removeListener=function(d,u,m,f){var h=r?r+d:d;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!m||p.context===m)&&o(this,h);else{for(var x=0,g=[],v=p.length;x<v;x++)(p[x].fn!==u||f&&!p[x].once||m&&p[x].context!==m)&&g.push(p[x]);g.length?this._events[h]=g.length===1?g[0]:g:o(this,h)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(i0)),i0.exports}var uQ=dQ();const mQ=zn(uQ);var Ql=new mQ,Gp="recharts.syncEvent.tooltip",Dj="recharts.syncEvent.brush";function k_(e,t){if(t){var r=Number.parseInt(t,10);if(!Js(r))return e?.[r]}}var fQ={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},P_=ea({name:"options",initialState:fQ,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),hQ=P_.reducer,{createEventEmitter:pQ}=P_.actions;function xQ(e){return e.tooltip.syncInteraction}var gQ={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},O_=ea({name:"chartData",initialState:gQ,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:s}=t.payload;r!=null&&(e.dataStartIndex=r),s!=null&&(e.dataEndIndex=s)}}}),{setChartData:Ij,setDataStartEndIndexes:vQ,setComputedData:Nle}=O_.actions,bQ=O_.reducer,yQ=["x","y"];function Rj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ei(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rj(Object(r),!0).forEach(function(s){wQ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function wQ(e,t,r){return(t=jQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jQ(e){var t=NQ(e,"string");return typeof t=="symbol"?t:t+""}function NQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SQ(e,t){if(e==null)return{};var r,s,n=EQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function EQ(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var D_=()=>{};function TQ(){var e=Xe(nv),t=Xe(iv),r=gr(),s=Xe(NC),n=Xe(Nn),i=_g(),o=Tg(),l=Xe(c=>c.rootProps.className);b.useEffect(()=>{if(e==null)return D_;var c=(d,u,m)=>{if(t!==m&&e===d){if(s==="index"){var f;if(o&&u!==null&&u!==void 0&&(f=u.payload)!==null&&f!==void 0&&f.coordinate){var h=u.payload.coordinate,{x:p,y:x}=h,g=SQ(h,yQ),v=ei(ei(ei({},g),typeof p=="number"&&{x:Math.max(o.x,Math.min(p,o.x+o.width))}),typeof x=="number"&&{y:Math.max(o.y,Math.min(x,o.y+o.height))}),w=ei(ei({},u),{},{payload:ei(ei({},u.payload),{},{coordinate:v})});r(w)}else r(u);return}if(n!=null){var y;if(typeof s=="function"){var S={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},E=s(n,S);y=n[E]}else s==="value"&&(y=n.find(I=>String(I.value)===u.payload.label));var{coordinate:N}=u.payload;if(y==null||u.payload.active===!1||N==null||o==null){r(Wp({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:j,y:T}=N,C=Math.min(j,o.x+o.width),L=Math.min(T,o.y+o.height),A={x:i==="horizontal"?y.coordinate:C,y:i==="horizontal"?L:y.coordinate},P=Wp({active:u.payload.active,coordinate:A,dataKey:u.payload.dataKey,index:String(y.index),label:u.payload.label});r(P)}}};return Ql.on(Gp,c),()=>{Ql.off(Gp,c)}},[l,r,t,e,s,n,i,o])}function AQ(){var e=Xe(nv),t=Xe(iv),r=gr();b.useEffect(()=>{if(e==null)return D_;var s=(n,i,o)=>{t!==o&&e===n&&r(vQ(i))};return Ql.on(Dj,s),()=>{Ql.off(Dj,s)}},[r,t,e])}function CQ(){var e=gr();b.useEffect(()=>{e(pQ())},[e]),TQ(),AQ()}function _Q(e,t,r,s,n,i){var o=Xe(f=>QZ(f,e,t)),l=Xe(iv),c=Xe(nv),d=Xe(NC),u=Xe(xQ),m=u?.active;b.useEffect(()=>{if(!m&&c!=null&&l!=null){var f=Wp({active:i,coordinate:r,dataKey:o,index:n,label:typeof s=="number"?String(s):s});Ql.emit(Gp,c,f,l)}},[m,r,o,n,s,l,c,d,i])}function Fj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Lj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fj(Object(r),!0).forEach(function(s){kQ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function kQ(e,t,r){return(t=PQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PQ(e){var t=OQ(e,"string");return typeof t=="symbol"?t:t+""}function OQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DQ(e){return e.dataKey}function IQ(e,t){return b.isValidElement(e)?b.cloneElement(e,t):typeof e=="function"?b.createElement(e,t):b.createElement(nq,t)}var Mj=[],RQ={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Gi.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function ud(e){var t=ks(e,RQ),{active:r,allowEscapeViewBox:s,animationDuration:n,animationEasing:i,content:o,filterNull:l,isAnimationActive:c,offset:d,payloadUniqBy:u,position:m,reverseDirection:f,useTranslate3d:h,wrapperStyle:p,cursor:x,shared:g,trigger:v,defaultIndex:w,portal:y,axisId:S}=t,E=gr(),N=typeof w=="number"?String(w):w;b.useEffect(()=>{E(aZ({shared:g,trigger:v,axisId:S,active:r,defaultIndex:N}))},[E,g,v,S,r,N]);var j=Tg(),T=xA(),C=QJ(g),{activeIndex:L,isActive:A}=Xe(B=>rQ(B,C,v,N)),P=Xe(B=>tQ(B,C,v,N)),I=Xe(B=>C_(B,C,v,N)),_=Xe(B=>eQ(B,C,v,N)),D=P,W=cQ(),K=r??A,[J,F]=IT([D,K]),le=C==="axis"?I:void 0;_Q(C,v,_,le,L,K);var Ae=y??W;if(Ae==null)return null;var O=D??Mj;K||(O=Mj),l&&O.length&&(O=_T(D.filter(B=>B.value!=null&&(B.hide!==!0||t.includeHidden)),u,DQ));var G=O.length>0,U=b.createElement(mq,{allowEscapeViewBox:s,animationDuration:n,animationEasing:i,isAnimationActive:c,active:K,coordinate:_,hasPayload:G,offset:d,position:m,reverseDirection:f,useTranslate3d:h,viewBox:j,wrapperStyle:p,lastBoundingBox:J,innerRef:F,hasPortalFromProps:!!y},IQ(o,Lj(Lj({},t),{},{payload:O,label:le,active:K,coordinate:_,accessibilityLayer:T})));return b.createElement(b.Fragment,null,rx.createPortal(U,Ae),K&&b.createElement(lQ,{cursor:x,tooltipEventType:C,coordinate:_,payload:D,index:L}))}var o0={},l0={},c0={},Bj;function FQ(){return Bj||(Bj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s,{signal:n,edges:i}={}){let o,l=null;const c=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),u=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},m=()=>{d&&u(),x()};let f=null;const h=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,m()},s)},p=()=>{f!==null&&(clearTimeout(f),f=null)},x=()=>{p(),o=void 0,l=null},g=()=>{u()},v=function(...w){if(n?.aborted)return;o=this,l=w;const y=f==null;h(),c&&y&&u()};return v.schedule=h,v.cancel=x,v.flush=g,n?.addEventListener("abort",x,{once:!0}),v}e.debounce=t})(c0)),c0}var $j;function LQ(){return $j||($j=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FQ();function r(s,n=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:l=!0,maxWait:c}=i,d=Array(2);o&&(d[0]="leading"),l&&(d[1]="trailing");let u,m=null;const f=t.debounce(function(...x){u=s.apply(this,x),m=null},n,{edges:d}),h=function(...x){return c!=null&&(m===null&&(m=Date.now()),Date.now()-m>=c)?(u=s.apply(this,x),m=Date.now(),f.cancel(),f.schedule(),u):(f.apply(this,x),u)},p=()=>(f.flush(),u);return h.cancel=f.cancel,h.flush=p,h}e.debounce=r})(l0)),l0}var zj;function MQ(){return zj||(zj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LQ();function r(s,n=0,i={}){const{leading:o=!0,trailing:l=!0}=i;return t.debounce(s,n,{leading:o,maxWait:n,trailing:l})}e.throttle=r})(o0)),o0}var d0,Uj;function BQ(){return Uj||(Uj=1,d0=MQ().throttle),d0}var $Q=BQ();const zQ=zn($Q);var jl=function(t,r){for(var s=arguments.length,n=new Array(s>2?s-2:0),i=2;i<s;i++)n[i-2]=arguments[i]};function Wj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function u0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wj(Object(r),!0).forEach(function(s){UQ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function UQ(e,t,r){return(t=WQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WQ(e){var t=HQ(e,"string");return typeof t=="symbol"?t:t+""}function HQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var md=b.forwardRef((e,t)=>{var{aspect:r,initialDimension:s={width:-1,height:-1},width:n="100%",height:i="100%",minWidth:o=0,minHeight:l,maxHeight:c,children:d,debounce:u=0,id:m,className:f,onResize:h,style:p={}}=e,x=b.useRef(null),g=b.useRef();g.current=h,b.useImperativeHandle(t,()=>x.current);var[v,w]=b.useState({containerWidth:s.width,containerHeight:s.height}),y=b.useCallback((E,N)=>{w(j=>{var T=Math.round(E),C=Math.round(N);return j.containerWidth===T&&j.containerHeight===C?j:{containerWidth:T,containerHeight:C}})},[]);b.useEffect(()=>{var E=C=>{var L,{width:A,height:P}=C[0].contentRect;y(A,P),(L=g.current)===null||L===void 0||L.call(g,A,P)};u>0&&(E=zQ(E,u,{trailing:!0,leading:!1}));var N=new ResizeObserver(E),{width:j,height:T}=x.current.getBoundingClientRect();return y(j,T),N.observe(x.current),()=>{N.disconnect()}},[y,u]);var S=b.useMemo(()=>{var{containerWidth:E,containerHeight:N}=v;if(E<0||N<0)return null;jl(oi(n)||oi(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,n,i),jl(!r||r>0,"The aspect(%s) must be greater than zero.",r);var j=oi(n)?E:n,T=oi(i)?N:i;return r&&r>0&&(j?T=j/r:T&&(j=T*r),c&&T>c&&(T=c)),jl(j>0||T>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,T,n,i,o,l,r),b.Children.map(d,C=>b.cloneElement(C,{width:j,height:T,style:u0({width:j,height:T},C.props.style)}))},[r,d,i,c,l,o,v,n]);return b.createElement("div",{id:m?"".concat(m):void 0,className:Et("recharts-responsive-container",f),style:u0(u0({},p),{},{width:n,height:i,minWidth:o,minHeight:l,maxHeight:c}),ref:x},b.createElement("div",{style:{width:0,height:0,overflow:"visible"}},S))}),Dc=e=>null;Dc.displayName="Cell";function VQ(e,t,r){return(t=GQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GQ(e){var t=qQ(e,"string");return typeof t=="symbol"?t:t+""}function qQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class KQ{constructor(t){VQ(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function Hj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function YQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hj(Object(r),!0).forEach(function(s){XQ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function XQ(e,t,r){return(t=JQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JQ(e){var t=ZQ(e,"string");return typeof t=="symbol"?t:t+""}function ZQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QQ={cacheSize:2e3,enableCache:!0},I_=YQ({},QQ),Vj=new KQ(I_.cacheSize),eee={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Gj="recharts_measurement_span";function tee(e,t){var r=t.fontSize||"",s=t.fontFamily||"",n=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(s,"|").concat(n,"|").concat(i,"|").concat(o,"|").concat(l)}var qj=(e,t)=>{try{var r=document.getElementById(Gj);r||(r=document.createElement("span"),r.setAttribute("id",Gj),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,eee,t),r.textContent="".concat(e);var s=r.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},Nl=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Gi.isSsr)return{width:0,height:0};if(!I_.enableCache)return qj(t,r);var s=tee(t,r),n=Vj.get(s);if(n)return n;var i=qj(t,r);return Vj.set(s,i),i},Kj=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Yj=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ree=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,see=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,R_={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},aee=Object.keys(R_),ao="NaN";function nee(e,t){return e*R_[t]}class Os{static parse(t){var r,[,s,n]=(r=see.exec(t))!==null&&r!==void 0?r:[];return new Os(parseFloat(s),n??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Js(t)&&(this.unit=""),r!==""&&!ree.test(r)&&(this.num=NaN,this.unit=""),aee.includes(r)&&(this.num=nee(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Os(NaN,""):new Os(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Os(NaN,""):new Os(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Os(NaN,""):new Os(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Os(NaN,""):new Os(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Js(this.num)}}function F_(e){if(e.includes(ao))return ao;for(var t=e;t.includes("*")||t.includes("/");){var r,[,s,n,i]=(r=Kj.exec(t))!==null&&r!==void 0?r:[],o=Os.parse(s??""),l=Os.parse(i??""),c=n==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return ao;t=t.replace(Kj,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,u,m,f]=(d=Yj.exec(t))!==null&&d!==void 0?d:[],h=Os.parse(u??""),p=Os.parse(f??""),x=m==="+"?h.add(p):h.subtract(p);if(x.isNaN())return ao;t=t.replace(Yj,x.toString())}return t}var Xj=/\(([^()]*)\)/;function iee(e){for(var t=e,r;(r=Xj.exec(t))!=null;){var[,s]=r;t=t.replace(Xj,F_(s))}return t}function oee(e){var t=e.replace(/\s+/g,"");return t=iee(t),t=F_(t),t}function lee(e){try{return oee(e)}catch{return ao}}function m0(e){var t=lee(e.slice(5,-1));return t===ao?"":t}var cee=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],dee=["dx","dy","angle","className","breakAll"];function qp(){return qp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},qp.apply(null,arguments)}function Jj(e,t){if(e==null)return{};var r,s,n=uee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function uee(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var L_=/[ \f\n\r\t\v\u2028\u2029]+/,M_=e=>{var{children:t,breakAll:r,style:s}=e;try{var n=[];Yr(t)||(r?n=t.toString().split(""):n=t.toString().split(L_));var i=n.map(l=>({word:l,width:Nl(l,s).width})),o=r?0:Nl("",s).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}},mee=(e,t,r,s,n)=>{var{maxLines:i,children:o,style:l,breakAll:c}=e,d=tt(i),u=o,m=function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return A.reduce((P,I)=>{var{word:_,width:D}=I,W=P[P.length-1];if(W&&(s==null||n||W.width+D+r<Number(s)))W.words.push(_),W.width+=D+r;else{var K={words:[_],width:D};P.push(K)}return P},[])},f=m(t),h=L=>L.reduce((A,P)=>A.width>P.width?A:P);if(!d||n)return f;var p=f.length>i||h(f).width>Number(s);if(!p)return f;for(var x="",g=L=>{var A=u.slice(0,L),P=M_({breakAll:c,style:l,children:A+x}).wordsWithComputedWidth,I=m(P),_=I.length>i||h(I).width>Number(s);return[_,I]},v=0,w=u.length-1,y=0,S;v<=w&&y<=u.length-1;){var E=Math.floor((v+w)/2),N=E-1,[j,T]=g(N),[C]=g(E);if(!j&&!C&&(v=E+1),j&&C&&(w=E-1),!j&&C){S=T;break}y++}return S||f},Zj=e=>{var t=Yr(e)?[]:e.toString().split(L_);return[{words:t}]},fee=e=>{var{width:t,scaleToFit:r,children:s,style:n,breakAll:i,maxLines:o}=e;if((t||r)&&!Gi.isSsr){var l,c,d=M_({breakAll:i,children:s,style:n});if(d){var{wordsWithComputedWidth:u,spaceWidth:m}=d;l=u,c=m}else return Zj(s);return mee({breakAll:i,children:s,maxLines:o,style:n},l,c,t,r)}return Zj(s)},Qj="#808080",ym=b.forwardRef((e,t)=>{var{x:r=0,y:s=0,lineHeight:n="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:l="start",verticalAnchor:c="end",fill:d=Qj}=e,u=Jj(e,cee),m=b.useMemo(()=>fee({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:o,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,o,u.style,u.width]),{dx:f,dy:h,angle:p,className:x,breakAll:g}=u,v=Jj(u,dee);if(!Va(r)||!Va(s)||m.length===0)return null;var w=r+(tt(f)?f:0),y=s+(tt(h)?h:0),S;switch(c){case"start":S=m0("calc(".concat(i,")"));break;case"middle":S=m0("calc(".concat((m.length-1)/2," * -").concat(n," + (").concat(i," / 2))"));break;default:S=m0("calc(".concat(m.length-1," * -").concat(n,")"));break}var E=[];if(o){var N=m[0].width,{width:j}=u;E.push("scale(".concat(tt(j)?j/N:1,")"))}return p&&E.push("rotate(".concat(p,", ").concat(w,", ").concat(y,")")),E.length&&(v.transform=E.join(" ")),b.createElement("text",qp({},$r(v,!0),{ref:t,x:w,y,className:Et("recharts-text",x),textAnchor:l,fill:d.includes("url")?Qj:d}),m.map((T,C)=>{var L=T.words.join(g?"":" ");return b.createElement("tspan",{x:w,dy:C===0?S:n,key:"".concat(L,"-").concat(C)},L)}))});ym.displayName="Text";var hee=["labelRef"];function pee(e,t){if(e==null)return{};var r,s,n=xee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xee(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function e2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Tr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e2(Object(r),!0).forEach(function(s){gee(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function gee(e,t,r){return(t=vee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vee(e){var t=bee(e,"string");return typeof t=="symbol"?t:t+""}function bee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ja(){return Ja=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ja.apply(null,arguments)}var B_=b.createContext(null),yee=e=>{var{x:t,y:r,width:s,height:n,children:i}=e,o=b.useMemo(()=>({x:t,y:r,width:s,height:n}),[t,r,s,n]);return b.createElement(B_.Provider,{value:o},i)},$_=()=>{var e=b.useContext(B_),t=Tg();return e||t},wee=b.createContext(null),jee=()=>{var e=b.useContext(wee),t=Xe(CC);return e||t},Nee=e=>{var{value:t,formatter:r}=e,s=Yr(e.children)?t:e.children;return typeof r=="function"?r(s):s},Mv=e=>e!=null&&typeof e=="function",See=(e,t)=>{var r=Kr(t-e),s=Math.min(Math.abs(t-e),360);return r*s},Eee=(e,t,r,s,n)=>{var{offset:i,className:o}=e,{cx:l,cy:c,innerRadius:d,outerRadius:u,startAngle:m,endAngle:f,clockWise:h}=n,p=(d+u)/2,x=See(m,f),g=x>=0?1:-1,v,w;switch(t){case"insideStart":v=m+g*i,w=h;break;case"insideEnd":v=f-g*i,w=!h;break;case"end":v=f+g*i,w=h;break;default:throw new Error("Unsupported position ".concat(t))}w=x<=0?w:!w;var y=Ir(l,c,p,v),S=Ir(l,c,p,v+(w?1:-1)*359),E="M".concat(y.x,",").concat(y.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(w?0:1,`,
    `).concat(S.x,",").concat(S.y),N=Yr(e.id)?Hl("recharts-radial-line-"):e.id;return b.createElement("text",Ja({},s,{dominantBaseline:"central",className:Et("recharts-radial-bar-label",o)}),b.createElement("defs",null,b.createElement("path",{id:N,d:E})),b.createElement("textPath",{xlinkHref:"#".concat(N)},r))},Tee=(e,t,r)=>{var{cx:s,cy:n,innerRadius:i,outerRadius:o,startAngle:l,endAngle:c}=e,d=(l+c)/2;if(r==="outside"){var{x:u,y:m}=Ir(s,n,o+t,d);return{x:u,y:m,textAnchor:u>=s?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"end"};var f=(i+o)/2,{x:h,y:p}=Ir(s,n,f,d);return{x:h,y:p,textAnchor:"middle",verticalAnchor:"middle"}},z_=e=>"cx"in e&&tt(e.cx),Aee=(e,t)=>{var{parentViewBox:r,offset:s,position:n}=e,i;r!=null&&!z_(r)&&(i=r);var{x:o,y:l,width:c,height:d}=t,u=d>=0?1:-1,m=u*s,f=u>0?"end":"start",h=u>0?"start":"end",p=c>=0?1:-1,x=p*s,g=p>0?"end":"start",v=p>0?"start":"end";if(n==="top"){var w={x:o+c/2,y:l-u*s,textAnchor:"middle",verticalAnchor:f};return Tr(Tr({},w),i?{height:Math.max(l-i.y,0),width:c}:{})}if(n==="bottom"){var y={x:o+c/2,y:l+d+m,textAnchor:"middle",verticalAnchor:h};return Tr(Tr({},y),i?{height:Math.max(i.y+i.height-(l+d),0),width:c}:{})}if(n==="left"){var S={x:o-x,y:l+d/2,textAnchor:g,verticalAnchor:"middle"};return Tr(Tr({},S),i?{width:Math.max(S.x-i.x,0),height:d}:{})}if(n==="right"){var E={x:o+c+x,y:l+d/2,textAnchor:v,verticalAnchor:"middle"};return Tr(Tr({},E),i?{width:Math.max(i.x+i.width-E.x,0),height:d}:{})}var N=i?{width:c,height:d}:{};return n==="insideLeft"?Tr({x:o+x,y:l+d/2,textAnchor:v,verticalAnchor:"middle"},N):n==="insideRight"?Tr({x:o+c-x,y:l+d/2,textAnchor:g,verticalAnchor:"middle"},N):n==="insideTop"?Tr({x:o+c/2,y:l+m,textAnchor:"middle",verticalAnchor:h},N):n==="insideBottom"?Tr({x:o+c/2,y:l+d-m,textAnchor:"middle",verticalAnchor:f},N):n==="insideTopLeft"?Tr({x:o+x,y:l+m,textAnchor:v,verticalAnchor:h},N):n==="insideTopRight"?Tr({x:o+c-x,y:l+m,textAnchor:g,verticalAnchor:h},N):n==="insideBottomLeft"?Tr({x:o+x,y:l+d-m,textAnchor:v,verticalAnchor:f},N):n==="insideBottomRight"?Tr({x:o+c-x,y:l+d-m,textAnchor:g,verticalAnchor:f},N):n&&typeof n=="object"&&(tt(n.x)||oi(n.x))&&(tt(n.y)||oi(n.y))?Tr({x:o+xs(n.x,c),y:l+xs(n.y,d),textAnchor:"end",verticalAnchor:"end"},N):Tr({x:o+c/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},N)},Cee={offset:5};function Cn(e){var t=ks(e,Cee),{viewBox:r,position:s,value:n,children:i,content:o,className:l="",textBreakAll:c,labelRef:d}=t,u=jee(),m=$_(),f=s==="center"?m:u??m,h=r||f;if(!h||Yr(n)&&Yr(i)&&!b.isValidElement(o)&&typeof o!="function")return null;var p=Tr(Tr({},t),{},{viewBox:h});if(b.isValidElement(o)){var{labelRef:x}=p,g=pee(p,hee);return b.cloneElement(o,g)}var v;if(typeof o=="function"){if(v=b.createElement(o,p),b.isValidElement(v))return v}else v=Nee(t);var w=z_(h),y=$r(t,!0);if(w&&(s==="insideStart"||s==="insideEnd"||s==="end"))return Eee(t,s,v,y,h);var S=w?Tee(h,t.offset,t.position):Aee(t,h);return b.createElement(ym,Ja({ref:d,className:Et("recharts-label",l)},y,S,{breakAll:c}),v)}Cn.displayName="Label";var _ee=(e,t,r)=>{if(!e)return null;var s={viewBox:t,labelRef:r};return e===!0?b.createElement(Cn,Ja({key:"label-implicit"},s)):Va(e)?b.createElement(Cn,Ja({key:"label-implicit",value:e},s)):b.isValidElement(e)?e.type===Cn?b.cloneElement(e,Tr({key:"label-implicit"},s)):b.createElement(Cn,Ja({key:"label-implicit",content:e},s)):Mv(e)?b.createElement(Cn,Ja({key:"label-implicit",content:e},s)):e&&typeof e=="object"?b.createElement(Cn,Ja({},e,{key:"label-implicit"},s)):null};function kee(e){var{label:t}=e,r=$_();return _ee(t,r)||null}var f0={},h0={},t2;function Pee(){return t2||(t2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(h0)),h0}var p0={},r2;function Oee(){return r2||(r2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(p0)),p0}var s2;function Dee(){return s2||(s2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pee(),r=Oee(),s=xg();function n(i){if(s.isArrayLike(i))return t.last(r.toArray(i))}e.last=n})(f0)),f0}var x0,a2;function Iee(){return a2||(a2=1,x0=Dee().last),x0}var Ree=Iee();const Fee=zn(Ree);var Lee=["valueAccessor"],Mee=["dataKey","clockWise","id","textBreakAll"];function hu(){return hu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},hu.apply(null,arguments)}function n2(e,t){if(e==null)return{};var r,s,n=Bee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Bee(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var $ee=e=>Array.isArray(e.value)?Fee(e.value):e.value,U_=b.createContext(void 0),zee=U_.Provider,W_=b.createContext(void 0),Uee=W_.Provider;function Wee(){return b.useContext(U_)}function Hee(){return b.useContext(W_)}function bd(e){var{valueAccessor:t=$ee}=e,r=n2(e,Lee),{dataKey:s,clockWise:n,id:i,textBreakAll:o}=r,l=n2(r,Mee),c=Wee(),d=Hee(),u=c||d;return!u||!u.length?null:b.createElement(Bs,{className:"recharts-label-list"},u.map((m,f)=>{var h,p=Yr(s)?t(m,f):hr(m&&m.payload,s),x=Yr(i)?{}:{id:"".concat(i,"-").concat(f)};return b.createElement(Cn,hu({},$r(m,!0),l,x,{fill:(h=r.fill)!==null&&h!==void 0?h:m.fill,parentViewBox:m.parentViewBox,value:p,textBreakAll:o,viewBox:m.viewBox,key:"label-".concat(f),index:f}))}))}bd.displayName="LabelList";function H_(e){var{label:t}=e;return t?t===!0?b.createElement(bd,{key:"labelList-implicit"}):b.isValidElement(t)||Mv(t)?b.createElement(bd,{key:"labelList-implicit",content:t}):typeof t=="object"?b.createElement(bd,hu({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var V_=e=>e.graphicalItems.polarItems,Vee=ve([lr,Ac],mv),Bv=ve([V_,kr,Vee],hv),Gee=ve([Bv],pv),$v=ve([Gee,ev],xv),qee=ve([$v,kr,Bv],vv),Kee=ve([$v,kr,Bv],(e,t,r)=>r.length>0?e.flatMap(s=>r.flatMap(n=>{var i,o=hr(s,(i=t.dataKey)!==null&&i!==void 0?i:n.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(s=>({value:hr(s,t.dataKey),errorDomain:[]})):e.map(s=>({value:s,errorDomain:[]}))),i2=()=>{},Yee=ve([kr,KC,i2,Kee,i2,Dt,lr],yv),G_=ve([kr,Dt,$v,qee,Tc,lr,Yee],wv),Xee=ve([G_,kr,zo],Sv);ve([kr,G_,Xee,lr],Tv);var Jee={radiusAxis:{},angleAxis:{}},q_=ea({name:"polarAxis",initialState:Jee,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Sle,removeRadiusAxis:Ele,addAngleAxis:Tle,removeAngleAxis:Ale}=q_.actions,Zee=q_.reducer;function o2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function l2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o2(Object(r),!0).forEach(function(s){Qee(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Qee(e,t,r){return(t=ete(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ete(e){var t=tte(e,"string");return typeof t=="symbol"?t:t+""}function tte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rte=(e,t)=>t,zv=ve([V_,rte],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),ste=[],Uv=(e,t,r)=>r?.length===0?ste:r,K_=ve([ev,zv,Uv],(e,t,r)=>{var{chartData:s}=e;if(t!=null){var n;if(t?.data!=null&&t.data.length>0?n=t.data:n=s,(!n||!n.length)&&r!=null&&(n=r.map(i=>l2(l2({},t.presentationProps),i.props))),n!=null)return n}}),ate=ve([K_,zv,Uv],(e,t,r)=>{if(!(e==null||t==null))return e.map((s,n)=>{var i,o=hr(s,t.nameKey,t.name),l;return r!=null&&(i=r[n])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[n].props.fill:typeof s=="object"&&s!=null&&"fill"in s?l=s.fill:l=t.fill,{value:Zu(o,t.dataKey),color:l,payload:s,type:t.legendType}})}),nte=ve([K_,zv,Uv,zr],(e,t,r,s)=>{if(!(t==null||e==null))return are({offset:s,pieSettings:t,displayedData:e,cells:r})}),g0={},c2;function ite(){return c2||(c2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${n}]`}let s=r;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(r)===s}e.isPlainObject=t})(g0)),g0}var v0,d2;function ote(){return d2||(d2=1,v0=ite().isPlainObject),v0}var lte=ote();const cte=zn(lte);function u2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function m2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u2(Object(r),!0).forEach(function(s){dte(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function dte(e,t,r){return(t=ute(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ute(e){var t=mte(e,"string");return typeof t=="symbol"?t:t+""}function mte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pu(){return pu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},pu.apply(null,arguments)}var f2=(e,t,r,s,n)=>{var i=r-s,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-i/2,",").concat(t+n),o+="L ".concat(e+r-i/2-s,",").concat(t+n),o+="L ".concat(e,",").concat(t," Z"),o},fte={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hte=e=>{var t=ks(e,fte),{x:r,y:s,upperWidth:n,lowerWidth:i,height:o,className:l}=t,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:m}=t,f=b.useRef(),[h,p]=b.useState(-1),x=b.useRef(n),g=b.useRef(i),v=b.useRef(o),w=b.useRef(r),y=b.useRef(s),S=am(e,"trapezoid-");if(b.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var _=f.current.getTotalLength();_&&p(_)}catch{}},[]),r!==+r||s!==+s||n!==+n||i!==+i||o!==+o||n===0&&i===0||o===0)return null;var E=Et("recharts-trapezoid",l);if(!m)return b.createElement("g",null,b.createElement("path",pu({},$r(t,!0),{className:E,d:f2(r,s,n,i,o)})));var N=x.current,j=g.current,T=v.current,C=w.current,L=y.current,A="0px ".concat(h===-1?1:h,"px"),P="".concat(h,"px 0px"),I=vA(["strokeDasharray"],d,c);return b.createElement(sm,{animationId:S,key:S,canBegin:h>0,duration:d,easing:c,isActive:m,begin:u},_=>{var D=rs(N,n,_),W=rs(j,i,_),K=rs(T,o,_),J=rs(C,r,_),F=rs(L,s,_);f.current&&(x.current=D,g.current=W,v.current=K,w.current=J,y.current=F);var le=_>0?{transition:I,strokeDasharray:P}:{strokeDasharray:A};return b.createElement("path",pu({},$r(t,!0),{className:E,d:f2(J,F,D,W,K),ref:f,style:m2(m2({},le),t.style)}))})},pte=["option","shapeType","propTransformer","activeClassName","isActive"];function xte(e,t){if(e==null)return{};var r,s,n=gte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gte(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function h2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function xu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h2(Object(r),!0).forEach(function(s){vte(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function vte(e,t,r){return(t=bte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bte(e){var t=yte(e,"string");return typeof t=="symbol"?t:t+""}function yte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wte(e,t){return xu(xu({},t),e)}function jte(e,t){return e==="symbols"}function p2(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return b.createElement(jA,r);case"trapezoid":return b.createElement(hte,r);case"sector":return b.createElement(EA,r);case"symbols":if(jte(t))return b.createElement(fg,r);break;default:return null}}function Nte(e){return b.isValidElement(e)?e.props:e}function Y_(e){var{option:t,shapeType:r,propTransformer:s=wte,activeClassName:n="recharts-active-shape",isActive:i}=e,o=xte(e,pte),l;if(b.isValidElement(t))l=b.cloneElement(t,xu(xu({},o),Nte(t)));else if(typeof t=="function")l=t(o);else if(cte(t)&&typeof t!="boolean"){var c=s(t,o);l=b.createElement(p2,{shapeType:r,elementProps:c})}else{var d=o;l=b.createElement(p2,{shapeType:r,elementProps:d})}return i?b.createElement(Bs,{className:n},l):l}var Wv=(e,t)=>{var r=gr();return(s,n)=>i=>{e?.(s,n,i),r(d_({activeIndex:String(n),activeDataKey:t,activeCoordinate:s.tooltipPosition}))}},Hv=e=>{var t=gr();return(r,s)=>n=>{e?.(r,s,n),t(nZ())}},Vv=(e,t)=>{var r=gr();return(s,n)=>i=>{e?.(s,n,i),r(iZ({activeIndex:String(n),activeDataKey:t,activeCoordinate:s.tooltipPosition}))}};function X_(e){var{fn:t,args:r}=e,s=gr(),n=wa();return b.useEffect(()=>{if(!n){var i=t(r);return s(rZ(i)),()=>{s(sZ(i))}}},[t,r,s,n]),null}var J_=()=>{};function Ste(e){var{legendPayload:t}=e,r=gr(),s=wa();return b.useEffect(()=>s?J_:(r(hA(t)),()=>{r(pA(t))}),[r,s,t]),null}function Ete(e){var{legendPayload:t}=e,r=gr(),s=Xe(Dt);return b.useEffect(()=>s!=="centric"&&s!=="radial"?J_:(r(hA(t)),()=>{r(pA(t))}),[r,s,t]),null}var b0,Tte=()=>{var[e]=b.useState(()=>Hl("uid-"));return e},Ate=(b0=Vk.useId)!==null&&b0!==void 0?b0:Tte;function Cte(e,t){var r=Ate();return t||(e?"".concat(e,"-").concat(r):r)}var _te=b.createContext(void 0),Z_=e=>{var{id:t,type:r,children:s}=e,n=Cte("recharts-".concat(r),t);return b.createElement(_te.Provider,{value:n},s(n))},kte={cartesianItems:[],polarItems:[]},Q_=ea({name:"graphicalItems",initialState:kte,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:s}=t.payload,n=an(e).cartesianItems.indexOf(r);n>-1&&(e.cartesianItems[n]=s)},removeCartesianGraphicalItem(e,t){var r=an(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=an(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:Pte,replaceCartesianGraphicalItem:Ote,removeCartesianGraphicalItem:Dte,addPolarGraphicalItem:Ite,removePolarGraphicalItem:Rte}=Q_.actions,Fte=Q_.reducer;function Lte(e){var t=gr(),r=b.useRef(null);return b.useEffect(()=>{r.current===null?t(Pte(e)):r.current!==e&&t(Ote({prev:r.current,next:e})),r.current=e},[t,e]),b.useEffect(()=>()=>{r.current&&(t(Dte(r.current)),r.current=null)},[t]),null}function Mte(e){var t=gr();return b.useEffect(()=>(t(Ite(e)),()=>{t(Rte(e))}),[t,e]),null}var Bte=["onMouseEnter","onClick","onMouseLeave"],$te=["id"],zte=["id"];function Gv(e,t){if(e==null)return{};var r,s,n=Ute(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ute(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function x2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ar(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x2(Object(r),!0).forEach(function(s){Wte(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Wte(e,t,r){return(t=Hte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hte(e){var t=Vte(e,"string");return typeof t=="symbol"?t:t+""}function Vte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mn(){return Mn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Mn.apply(null,arguments)}function Gte(e){var t=b.useMemo(()=>lg(e.children,Dc),[e.children]),r=Xe(s=>ate(s,e.id,t));return r==null?null:b.createElement(Ete,{legendPayload:r})}function qte(e){var{dataKey:t,nameKey:r,sectors:s,stroke:n,strokeWidth:i,fill:o,name:l,hide:c,tooltipType:d}=e;return{dataDefinedOnItem:s.map(u=>u.tooltipPayload),positions:s.map(u=>u.tooltipPosition),settings:{stroke:n,strokeWidth:i,fill:o,dataKey:t,nameKey:r,name:Zu(l,t),hide:c,type:d,color:o,unit:""}}}var Kte=(e,t)=>e>t?"start":e<t?"end":"middle",Yte=(e,t,r)=>xs(typeof t=="function"?t(e):t,r,r*.8),Xte=(e,t,r)=>{var{top:s,left:n,width:i,height:o}=t,l=nA(i,o),c=n+xs(e.cx,i,i/2),d=s+xs(e.cy,o,o/2),u=xs(e.innerRadius,l,0),m=Yte(r,e.outerRadius,l),f=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:c,cy:d,innerRadius:u,outerRadius:m,maxRadius:f}},Jte=(e,t)=>{var r=Kr(t-e),s=Math.min(Math.abs(t-e),360);return r*s};function Zte(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var Qte=(e,t)=>{if(b.isValidElement(e))return b.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Et("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return b.createElement(gA,Mn({},t,{type:"linear",className:r}))},ere=(e,t,r)=>{if(b.isValidElement(e))return b.cloneElement(e,t);var s=r;if(typeof e=="function"&&(s=e(t),b.isValidElement(s)))return s;var n=Et("recharts-pie-label-text",Zte(e));return b.createElement(ym,Mn({},t,{alignmentBaseline:"middle",className:n}),s)};function tre(e){var{sectors:t,props:r,showLabels:s}=e,{label:n,labelLine:i,dataKey:o}=r;if(!s||!n||!t)return null;var l=Vn(r),c=$r(n,!1),d=$r(i,!1),u=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,m=t.map((f,h)=>{var p=(f.startAngle+f.endAngle)/2,x=Ir(f.cx,f.cy,f.outerRadius+u,p),g=ar(ar(ar(ar({},l),f),{},{stroke:"none"},c),{},{index:h,textAnchor:Kte(x.x,f.cx)},x),v=ar(ar(ar(ar({},l),f),{},{fill:"none",stroke:f.fill},d),{},{index:h,points:[Ir(f.cx,f.cy,f.outerRadius,p),x],key:"line"});return b.createElement(Bs,{key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(h)},i&&Qte(i,v),ere(n,g,hr(f,o)))});return b.createElement(Bs,{className:"recharts-pie-labels"},m)}function rre(e){var{sectors:t,props:r,showLabels:s}=e,{label:n}=r;return typeof n=="object"&&n!=null&&"position"in n?b.createElement(H_,{label:n}):b.createElement(tre,{sectors:t,props:r,showLabels:s})}function sre(e){var{sectors:t,activeShape:r,inactiveShape:s,allOtherPieProps:n}=e,i=Xe(Ii),{onMouseEnter:o,onClick:l,onMouseLeave:c}=n,d=Gv(n,Bte),u=Wv(o,n.dataKey),m=Hv(c),f=Vv(l,n.dataKey);return t==null||t.length===0?null:b.createElement(b.Fragment,null,t.map((h,p)=>{if(h?.startAngle===0&&h?.endAngle===0&&t.length!==1)return null;var x=r&&String(p)===i,g=i?s:null,v=x?r:g,w=ar(ar({},h),{},{stroke:h.stroke,tabIndex:-1,[dA]:p,[uA]:n.dataKey});return b.createElement(Bs,Mn({tabIndex:-1,className:"recharts-pie-sector"},vc(d,h,p),{onMouseEnter:u(h,p),onMouseLeave:m(h,p),onClick:f(h,p),key:"sector-".concat(h?.startAngle,"-").concat(h?.endAngle,"-").concat(h.midAngle,"-").concat(p)}),b.createElement(Y_,Mn({option:v,isActive:x,shapeType:"sector"},w)))}))}function are(e){var t,{pieSettings:r,displayedData:s,cells:n,offset:i}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:d,nameKey:u,tooltipType:m}=r,f=Math.abs(r.minAngle),h=Jte(l,c),p=Math.abs(h),x=s.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=s.filter(N=>hr(N,d,0)!==0).length,v=(p>=360?g:g-1)*x,w=p-g*f-v,y=s.reduce((N,j)=>{var T=hr(j,d,0);return N+(tt(T)?T:0)},0),S;if(y>0){var E;S=s.map((N,j)=>{var T=hr(N,d,0),C=hr(N,u,j),L=Xte(r,i,N),A=(tt(T)?T:0)/y,P,I=ar(ar({},N),n&&n[j]&&n[j].props);j?P=E.endAngle+Kr(h)*x*(T!==0?1:0):P=l;var _=P+Kr(h)*((T!==0?f:0)+A*w),D=(P+_)/2,W=(L.innerRadius+L.outerRadius)/2,K=[{name:C,value:T,payload:I,dataKey:d,type:m}],J=Ir(L.cx,L.cy,W,D);return E=ar(ar(ar(ar({},r.presentationProps),{},{percent:A,cornerRadius:o,name:C,tooltipPayload:K,midAngle:D,middleRadius:W,tooltipPosition:J},I),L),{},{value:T,startAngle:P,endAngle:_,payload:I,paddingAngle:Kr(h)*x}),E})}return S}function nre(e){var{showLabels:t,sectors:r,children:s}=e,n=b.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return b.createElement(Uee,{value:t?n:void 0},s)}function ire(e){var{props:t,previousSectorsRef:r}=e,{sectors:s,isAnimationActive:n,animationBegin:i,animationDuration:o,animationEasing:l,activeShape:c,inactiveShape:d,onAnimationStart:u,onAnimationEnd:m}=t,f=am(t,"recharts-pie-"),h=r.current,[p,x]=b.useState(!1),g=b.useCallback(()=>{typeof m=="function"&&m(),x(!1)},[m]),v=b.useCallback(()=>{typeof u=="function"&&u(),x(!0)},[u]);return b.createElement(nre,{showLabels:!p,sectors:s},b.createElement(sm,{animationId:f,begin:i,duration:o,isActive:n,easing:l,onAnimationStart:v,onAnimationEnd:g,key:f},w=>{var y=[],S=s&&s[0],E=S?.startAngle;return s?.forEach((N,j)=>{var T=h&&h[j],C=j>0?ki(N,"paddingAngle",0):0;if(T){var L=rs(T.endAngle-T.startAngle,N.endAngle-N.startAngle,w),A=ar(ar({},N),{},{startAngle:E+C,endAngle:E+L+C});y.push(A),E=A.endAngle}else{var{endAngle:P,startAngle:I}=N,_=rs(0,P-I,w),D=ar(ar({},N),{},{startAngle:E+C,endAngle:E+_+C});y.push(D),E=D.endAngle}}),r.current=y,b.createElement(Bs,null,b.createElement(sre,{sectors:y,activeShape:c,inactiveShape:d,allOtherPieProps:t}))}),b.createElement(rre,{showLabels:!p,sectors:s,props:t}),t.children)}var ore={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Gi.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function lre(e){var{id:t}=e,r=Gv(e,$te),{hide:s,className:n,rootTabIndex:i}=e,o=b.useMemo(()=>lg(e.children,Dc),[e.children]),l=Xe(u=>nte(u,t,o)),c=b.useRef(null),d=Et("recharts-pie",n);return s||l==null?(c.current=null,b.createElement(Bs,{tabIndex:i,className:d})):b.createElement(b.Fragment,null,b.createElement(X_,{fn:qte,args:ar(ar({},e),{},{sectors:l})}),b.createElement(Bs,{tabIndex:i,className:d},b.createElement(ire,{props:ar(ar({},r),{},{sectors:l}),previousSectorsRef:c})))}function ek(e){var t=ks(e,ore),{id:r}=t,s=Gv(t,zte),n=Vn(s);return b.createElement(Z_,{id:r,type:"pie"},i=>b.createElement(b.Fragment,null,b.createElement(Mte,{type:"pie",id:i,data:s.data,dataKey:s.dataKey,hide:s.hide,angleAxisId:0,radiusAxisId:0,name:s.name,nameKey:s.nameKey,tooltipType:s.tooltipType,legendType:s.legendType,fill:s.fill,cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,paddingAngle:s.paddingAngle,minAngle:s.minAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius,cornerRadius:s.cornerRadius,presentationProps:n,maxRadius:t.maxRadius}),b.createElement(Gte,Mn({},s,{id:i})),b.createElement(lre,Mn({},s,{id:i}))))}ek.displayName="Pie";function g2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function v2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g2(Object(r),!0).forEach(function(s){cre(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function cre(e,t,r){return(t=dre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dre(e){var t=ure(e,"string");return typeof t=="symbol"?t:t+""}function ure(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mre={xAxis:{},yAxis:{},zAxis:{}},tk=ea({name:"cartesianAxis",initialState:mre,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:s}=t.payload;e.yAxis[r]&&(e.yAxis[r]=v2(v2({},e.yAxis[r]),{},{width:s}))}}}),{addXAxis:fre,removeXAxis:hre,addYAxis:pre,removeYAxis:xre,addZAxis:Cle,removeZAxis:_le,updateYAxisWidth:gre}=tk.actions,vre=tk.reducer,bre=ve([zr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),yre=ve([bre,vn,bn],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),rk=()=>Xe(yre),wre="Invariant failed";function jre(e,t){throw new Error(wre)}var Nre=["x","y"];function Kp(){return Kp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Kp.apply(null,arguments)}function b2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ol(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b2(Object(r),!0).forEach(function(s){Sre(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Sre(e,t,r){return(t=Ere(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ere(e){var t=Tre(e,"string");return typeof t=="symbol"?t:t+""}function Tre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Are(e,t){if(e==null)return{};var r,s,n=Cre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Cre(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function _re(e,t){var{x:r,y:s}=e,n=Are(e,Nre),i="".concat(r),o=parseInt(i,10),l="".concat(s),c=parseInt(l,10),d="".concat(t.height||n.height),u=parseInt(d,10),m="".concat(t.width||n.width),f=parseInt(m,10);return ol(ol(ol(ol(ol({},t),n),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function qv(e){return b.createElement(Y_,Kp({shapeType:"rectangle",propTransformer:_re,activeClassName:"recharts-active-bar"},e))}var kre=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,n)=>{if(tt(t))return t;var i=tt(s)||Yr(s);return i?t(s,n):(i||jre(),r)}},Pre={},sk=ea({name:"errorBars",initialState:Pre,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:s}=t.payload;e[r]||(e[r]=[]),e[r].push(s)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:s,next:n}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===s.dataKey&&i.direction===s.direction?n:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:s}=t.payload;e[r]&&(e[r]=e[r].filter(n=>n.dataKey!==s.dataKey||n.direction!==s.direction))}}}),{addErrorBar:kle,replaceErrorBar:Ple,removeErrorBar:Ole}=sk.actions,Ore=sk.reducer,Dre=["children"];function Ire(e,t){if(e==null)return{};var r,s,n=Rre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Rre(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Fre={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Lre=b.createContext(Fre);function Mre(e){var{children:t}=e,r=Ire(e,Dre);return b.createElement(Lre.Provider,{value:r},t)}function ak(e,t){var r,s,n=Xe(d=>wn(d,e)),i=Xe(d=>jn(d,t)),o=(r=n?.allowDataOverflow)!==null&&r!==void 0?r:$s.allowDataOverflow,l=(s=i?.allowDataOverflow)!==null&&s!==void 0?s:zs.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function Bre(e){var{xAxisId:t,yAxisId:r,clipPathId:s}=e,n=rk(),{needClipX:i,needClipY:o,needClip:l}=ak(t,r);if(!l)return null;var{x:c,y:d,width:u,height:m}=n;return b.createElement("clipPath",{id:"clipPath-".concat(s)},b.createElement("rect",{x:i?c:c-u/2,y:o?d:d-m/2,width:i?u:u*2,height:o?m:m*2}))}var $re=["onMouseEnter","onMouseLeave","onClick"],zre=["value","background","tooltipPosition"],Ure=["id"],Wre=["onMouseEnter","onClick","onMouseLeave"];function Bn(){return Bn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Bn.apply(null,arguments)}function y2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Ns(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y2(Object(r),!0).forEach(function(s){Hre(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Hre(e,t,r){return(t=Vre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vre(e){var t=Gre(e,"string");return typeof t=="symbol"?t:t+""}function Gre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gu(e,t){if(e==null)return{};var r,s,n=qre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qre(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Kre=e=>{var{dataKey:t,name:r,fill:s,legendType:n,hide:i}=e;return[{inactive:i,dataKey:t,type:n,color:s,value:Zu(r,t),payload:e}]};function Yre(e){var{dataKey:t,stroke:r,strokeWidth:s,fill:n,name:i,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:n,dataKey:t,nameKey:void 0,name:Zu(i,t),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function Xre(e){var t=Xe(Ii),{data:r,dataKey:s,background:n,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=i,d=gu(i,$re),u=Wv(o,s),m=Hv(l),f=Vv(c,s);if(!n||r==null)return null;var h=$r(n,!1);return b.createElement(b.Fragment,null,r.map((p,x)=>{var{value:g,background:v,tooltipPosition:w}=p,y=gu(p,zre);if(!v)return null;var S=u(p,x),E=m(p,x),N=f(p,x),j=Ns(Ns(Ns(Ns(Ns({option:n,isActive:String(x)===t},y),{},{fill:"#eee"},v),h),vc(d,p,x)),{},{onMouseEnter:S,onMouseLeave:E,onClick:N,dataKey:s,index:x,className:"recharts-bar-background-rectangle"});return b.createElement(qv,Bn({key:"background-bar-".concat(j.index)},j))}))}function Jre(e){var{showLabels:t,children:r,rects:s}=e,n=s?.map(i=>{var o={x:i.x,y:i.y,width:i.width,height:i.height};return Ns(Ns({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return b.createElement(zee,{value:t?n:void 0},r)}function Zre(e){var{shape:t,activeBar:r,baseProps:s,entry:n,index:i,dataKey:o}=e,l=Xe(Ii),c=Xe(N_),d=r&&String(i)===l&&(c==null||o===c),u=d?r:t;return b.createElement(qv,Bn({},s,n,{isActive:d,option:u,index:i,dataKey:o}))}function Qre(e){var{shape:t,baseProps:r,entry:s,index:n,dataKey:i}=e;return b.createElement(qv,Bn({},r,s,{isActive:!1,option:t,index:n,dataKey:i}))}function ese(e){var{data:t,props:r}=e,s=Vn(r),{id:n}=s,i=gu(s,Ure),{shape:o,dataKey:l,activeBar:c}=r,{onMouseEnter:d,onClick:u,onMouseLeave:m}=r,f=gu(r,Wre),h=Wv(d,l),p=Hv(m),x=Vv(u,l);return t?b.createElement(b.Fragment,null,t.map((g,v)=>b.createElement(Bs,Bn({className:"recharts-bar-rectangle"},vc(f,g,v),{onMouseEnter:h(g,v),onMouseLeave:p(g,v),onClick:x(g,v),key:"rectangle-".concat(g?.x,"-").concat(g?.y,"-").concat(g?.value,"-").concat(v)}),c?b.createElement(Zre,{shape:o,activeBar:c,baseProps:i,entry:g,index:v,dataKey:l}):b.createElement(Qre,{shape:o,baseProps:i,entry:g,index:v,dataKey:l})))):null}function tse(e){var{props:t,previousRectanglesRef:r}=e,{data:s,layout:n,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,m=r.current,f=am(t,"recharts-bar-"),[h,p]=b.useState(!1),x=!h,g=b.useCallback(()=>{typeof d=="function"&&d(),p(!1)},[d]),v=b.useCallback(()=>{typeof u=="function"&&u(),p(!0)},[u]);return b.createElement(Jre,{showLabels:x,rects:s},b.createElement(sm,{animationId:f,begin:o,duration:l,isActive:i,easing:c,onAnimationEnd:g,onAnimationStart:v,key:f},w=>{var y=w===1?s:s?.map((S,E)=>{var N=m&&m[E];if(N)return Ns(Ns({},S),{},{x:rs(N.x,S.x,w),y:rs(N.y,S.y,w),width:rs(N.width,S.width,w),height:rs(N.height,S.height,w)});if(n==="horizontal"){var j=rs(0,S.height,w);return Ns(Ns({},S),{},{y:S.y+S.height-j,height:j})}var T=rs(0,S.width,w);return Ns(Ns({},S),{},{width:T})});return w>0&&(r.current=y??null),y==null?null:b.createElement(Bs,null,b.createElement(ese,{props:t,data:y}))}),b.createElement(H_,{label:t.label}),t.children)}function rse(e){var t=b.useRef(null);return b.createElement(tse,{previousRectanglesRef:t,props:e})}var nk=0,sse=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:hr(e,t)}};class ase extends b.PureComponent{render(){var{hide:t,data:r,dataKey:s,className:n,xAxisId:i,yAxisId:o,needClip:l,background:c,id:d}=this.props;if(t||r==null)return null;var u=Et("recharts-bar",n),m=d;return b.createElement(Bs,{className:u,id:d},l&&b.createElement("defs",null,b.createElement(Bre,{clipPathId:m,xAxisId:i,yAxisId:o})),b.createElement(Bs,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(m,")"):void 0},b.createElement(Xre,{data:r,dataKey:s,background:c,allOtherBarProps:this.props}),b.createElement(rse,this.props)))}}var nse={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Gi.isSsr,legendType:"rect",minPointSize:nk,xAxisId:0,yAxisId:0};function ise(e){var{xAxisId:t,yAxisId:r,hide:s,legendType:n,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u}=e,{needClip:m}=ak(t,r),f=_g(),h=wa(),p=lg(e.children,Dc),x=Xe(w=>Ise(w,t,r,h,e.id,p));if(f!=="vertical"&&f!=="horizontal")return null;var g,v=x?.[0];return v==null||v.height==null||v.width==null?g=0:g=f==="vertical"?v.height/2:v.width/2,b.createElement(Mre,{xAxisId:t,yAxisId:r,data:x,dataPointFormatter:sse,errorBarOffset:g},b.createElement(ase,Bn({},e,{layout:f,needClip:m,data:x,xAxisId:t,yAxisId:r,hide:s,legendType:n,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u})))}function ose(e){var{layout:t,barSettings:{dataKey:r,minPointSize:s},pos:n,bandSize:i,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:u,displayedData:m,offset:f,cells:h,parentViewBox:p}=e,x=t==="horizontal"?l:o,g=u?x.scale.domain():null,v=wG({numericAxis:x});return m.map((w,y)=>{var S,E,N,j,T,C;u?S=pG(u[y],g):(S=hr(w,r),Array.isArray(S)||(S=[v,S]));var L=kre(s,nk)(S[1],y);if(t==="horizontal"){var A,[P,I]=[l.scale(S[0]),l.scale(S[1])];E=ow({axis:o,ticks:c,bandSize:i,offset:n.offset,entry:w,index:y}),N=(A=I??P)!==null&&A!==void 0?A:void 0,j=n.size;var _=P-I;if(T=Js(_)?0:_,C={x:E,y:f.top,width:j,height:f.height},Math.abs(L)>0&&Math.abs(T)<Math.abs(L)){var D=Kr(T||L)*(Math.abs(L)-Math.abs(T));N-=D,T+=D}}else{var[W,K]=[o.scale(S[0]),o.scale(S[1])];if(E=W,N=ow({axis:l,ticks:d,bandSize:i,offset:n.offset,entry:w,index:y}),j=K-W,T=n.size,C={x:f.left,y:N,width:f.width,height:T},Math.abs(L)>0&&Math.abs(j)<Math.abs(L)){var J=Kr(j||L)*(Math.abs(L)-Math.abs(j));j+=J}}if(E==null||N==null||j==null||T==null)return null;var F=Ns(Ns({},w),{},{x:E,y:N,width:j,height:T,value:u?S:S[1],payload:w,background:C,tooltipPosition:{x:E+j/2,y:N+T/2},parentViewBox:p},h&&h[y]&&h[y].props);return F}).filter(Boolean)}function lse(e){var t=ks(e,nse),r=wa();return b.createElement(Z_,{id:t.id,type:"bar"},s=>b.createElement(b.Fragment,null,b.createElement(Ste,{legendPayload:Kre(t)}),b.createElement(X_,{fn:Yre,args:t}),b.createElement(Lte,{type:"bar",id:s,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:yG(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),b.createElement(ise,Bn({},t,{id:s}))))}var fl=b.memo(lse);fl.displayName="Bar";function w2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function fd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w2(Object(r),!0).forEach(function(s){cse(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function cse(e,t,r){return(t=dse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dse(e){var t=use(e,"string");return typeof t=="symbol"?t:t+""}function use(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mse=(e,t)=>t,fse=(e,t,r)=>r,hse=(e,t,r,s)=>s,pse=(e,t,r,s,n)=>n,Ic=ve([fv,pse],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),xse=ve([Ic],e=>e?.maxBarSize),gse=(e,t,r,s,n,i)=>i,j2=(e,t,r)=>{var s=r??e;if(!Yr(s))return xs(s,t,0)},vse=ve([Dt,fv,mse,fse,hse],(e,t,r,s,n)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===s).filter(i=>i.isPanorama===n).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),bse=(e,t,r,s)=>{var n=Dt(e);return n==="horizontal"?Up(e,"yAxis",r,s):Up(e,"xAxis",t,s)},yse=(e,t,r)=>{var s=Dt(e);return s==="horizontal"?Sj(e,"xAxis",t):Sj(e,"yAxis",r)},wse=(e,t,r)=>{var s={},n=e.filter(hm),i=e.filter(d=>d.stackId==null),o=n.reduce((d,u)=>(d[u.stackId]||(d[u.stackId]=[]),d[u.stackId].push(u),d),s),l=Object.entries(o).map(d=>{var[u,m]=d,f=m.map(p=>p.dataKey),h=j2(t,r,m[0].barSize);return{stackId:u,dataKeys:f,barSize:h}}),c=i.map(d=>{var u=[d.dataKey].filter(f=>f!=null),m=j2(t,r,d.barSize);return{stackId:void 0,dataKeys:u,barSize:m}});return[...l,...c]},jse=ve([vse,tJ,yse],wse),Nse=(e,t,r,s,n)=>{var i,o,l=Ic(e,t,r,s,n);if(l!=null){var c=Dt(e),d=wC(e),{maxBarSize:u}=l,m=Yr(u)?d:u,f,h;return c==="horizontal"?(f=Co(e,"xAxis",t,s),h=Ao(e,"xAxis",t,s)):(f=Co(e,"yAxis",r,s),h=Ao(e,"yAxis",r,s)),(i=(o=Sg(f,h,!0))!==null&&o!==void 0?o:m)!==null&&i!==void 0?i:0}},ik=(e,t,r,s)=>{var n=Dt(e),i,o;return n==="horizontal"?(i=Co(e,"xAxis",t,s),o=Ao(e,"xAxis",t,s)):(i=Co(e,"yAxis",r,s),o=Ao(e,"yAxis",r,s)),Sg(i,o)};function Sse(e,t,r,s,n){var i=s.length;if(!(i<1)){var o=xs(e,r,0,!0),l,c=[];if(Qs(s[0].barSize)){var d=!1,u=r/i,m=s.reduce((v,w)=>v+(w.barSize||0),0);m+=(i-1)*o,m>=r&&(m-=(i-1)*o,o=0),m>=r&&u>0&&(d=!0,u*=.9,m=i*u);var f=(r-m)/2>>0,h={offset:f-o,size:0};l=s.reduce((v,w)=>{var y,S={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:h.offset+h.size+o,size:d?u:(y=w.barSize)!==null&&y!==void 0?y:0}},E=[...v,S];return h=E[E.length-1].position,E},c)}else{var p=xs(t,r,0,!0);r-2*p-(i-1)*o<=0&&(o=0);var x=(r-2*p-(i-1)*o)/i;x>1&&(x>>=0);var g=Qs(n)?Math.min(x,n):x;l=s.reduce((v,w,y)=>[...v,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:p+(x+o)*y+(x-g)/2,size:g}}],c)}return l}}var Ese=(e,t,r,s,n,i,o)=>{var l=Yr(o)?t:o,c=Sse(r,s,n!==i?n:i,e,l);return n!==i&&c!=null&&(c=c.map(d=>fd(fd({},d),{},{position:fd(fd({},d.position),{},{offset:d.position.offset-n/2})}))),c},Tse=ve([jse,wC,eJ,jC,Nse,ik,xse],Ese),Ase=(e,t,r,s)=>Co(e,"xAxis",t,s),Cse=(e,t,r,s)=>Co(e,"yAxis",r,s),_se=(e,t,r,s)=>Ao(e,"xAxis",t,s),kse=(e,t,r,s)=>Ao(e,"yAxis",r,s),Pse=ve([Tse,Ic],(e,t)=>{if(!(e==null||t==null)){var r=e.find(s=>s.stackId===t.stackId&&t.dataKey!=null&&s.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),Ose=(e,t)=>{var r=dv(t);if(!(!e||r==null||t==null)){var{stackId:s}=t;if(s!=null){var n=e[s];if(n){var{stackedData:i}=n;if(i)return i.find(o=>o.key===r)}}}},Dse=ve([bse,Ic],Ose),Ise=ve([zr,Eg,Ase,Cse,_se,kse,Pse,Dt,tv,ik,Dse,Ic,gse],(e,t,r,s,n,i,o,l,c,d,u,m,f)=>{var{chartData:h,dataStartIndex:p,dataEndIndex:x}=c;if(!(m==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||s==null||n==null||i==null||d==null)){var{data:g}=m,v;if(g!=null&&g.length>0?v=g:v=h?.slice(p,x+1),v!=null)return ose({layout:l,barSettings:m,pos:o,parentViewBox:t,bandSize:d,xAxis:r,yAxis:s,xAxisTicks:n,yAxisTicks:i,stackedData:u,displayedData:v,offset:e,cells:f})}}),ok=e=>{var{chartData:t}=e,r=gr(),s=wa();return b.useEffect(()=>s?()=>{}:(r(Ij(t)),()=>{r(Ij(void 0))}),[t,r,s]),null},N2={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},lk=ea({name:"brush",initialState:N2,reducers:{setBrushSettings(e,t){return t.payload==null?N2:t.payload}}}),{setBrushSettings:Dle}=lk.actions,Rse=lk.reducer;function Fse(e,t,r){return(t=Lse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lse(e){var t=Mse(e,"string");return typeof t=="symbol"?t:t+""}function Mse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Kv{static create(t){return new Kv(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(s)switch(s){case"start":return this.scale(t);case"middle":{var n=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+n}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),s=r[0],n=r[r.length-1];return s<=n?t>=s&&t<=n:t>=n&&t<=s}}Fse(Kv,"EPS",1e-4);function Bse(e){return(e%180+180)%180}var $se=function(t){var{width:r,height:s}=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Bse(n),o=i*Math.PI/180,l=Math.atan(s/r),c=o>l&&o<Math.PI-l?s/Math.sin(o):r/Math.cos(o);return Math.abs(c)},zse={dots:[],areas:[],lines:[]},ck=ea({name:"referenceElements",initialState:zse,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=an(e).dots.findIndex(s=>s===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=an(e).areas.findIndex(s=>s===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=an(e).lines.findIndex(s=>s===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Ile,removeDot:Rle,addArea:Fle,removeArea:Lle,addLine:Mle,removeLine:Ble}=ck.actions,Use=ck.reducer,Wse=b.createContext(void 0),Hse=e=>{var{children:t}=e,[r]=b.useState("".concat(Hl("recharts"),"-clip")),s=rk();if(s==null)return null;var{x:n,y:i,width:o,height:l}=s;return b.createElement(Wse.Provider,{value:r},b.createElement("defs",null,b.createElement("clipPath",{id:r},b.createElement("rect",{x:n,y:i,height:l,width:o}))),t)};function _o(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var s in t)if({}.hasOwnProperty.call(t,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function dk(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var s=[],n=0;n<e.length;n+=t)s.push(e[n]);return s}function Vse(e,t,r){var s={width:e.width+t.width,height:e.height+t.height};return $se(s,r)}function Gse(e,t,r){var s=r==="width",{x:n,y:i,width:o,height:l}=e;return t===1?{start:s?n:i,end:s?n+o:i+l}:{start:s?n+o:i+l,end:s?n:i}}function vu(e,t,r,s,n){if(e*t<e*s||e*t>e*n)return!1;var i=r();return e*(t-e*i/2-s)>=0&&e*(t+e*i/2-n)<=0}function qse(e,t){return dk(e,t+1)}function Kse(e,t,r,s,n){for(var i=(s||[]).slice(),{start:o,end:l}=t,c=0,d=1,u=o,m=function(){var p=s?.[c];if(p===void 0)return{v:dk(s,d)};var x=c,g,v=()=>(g===void 0&&(g=r(p,x)),g),w=p.coordinate,y=c===0||vu(e,w,v,u,l);y||(c=0,u=o,d+=1),y&&(u=w+e*(v()/2+n),c+=d)},f;d<=i.length;)if(f=m(),f)return f.v;return[]}function S2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function os(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S2(Object(r),!0).forEach(function(s){Yse(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Yse(e,t,r){return(t=Xse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xse(e){var t=Jse(e,"string");return typeof t=="symbol"?t:t+""}function Jse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zse(e,t,r,s,n){for(var i=(s||[]).slice(),o=i.length,{start:l}=t,{end:c}=t,d=function(f){var h=i[f],p,x=()=>(p===void 0&&(p=r(h,f)),p);if(f===o-1){var g=e*(h.coordinate+e*x()/2-c);i[f]=h=os(os({},h),{},{tickCoord:g>0?h.coordinate-g*e:h.coordinate})}else i[f]=h=os(os({},h),{},{tickCoord:h.coordinate});var v=vu(e,h.tickCoord,x,l,c);v&&(c=h.tickCoord-e*(x()/2+n),i[f]=os(os({},h),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return i}function Qse(e,t,r,s,n,i){var o=(s||[]).slice(),l=o.length,{start:c,end:d}=t;if(i){var u=s[l-1],m=r(u,l-1),f=e*(u.coordinate+e*m/2-d);o[l-1]=u=os(os({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var h=vu(e,u.tickCoord,()=>m,c,d);h&&(d=u.tickCoord-e*(m/2+n),o[l-1]=os(os({},u),{},{isShow:!0}))}for(var p=i?l-1:l,x=function(w){var y=o[w],S,E=()=>(S===void 0&&(S=r(y,w)),S);if(w===0){var N=e*(y.coordinate-e*E()/2-c);o[w]=y=os(os({},y),{},{tickCoord:N<0?y.coordinate-N*e:y.coordinate})}else o[w]=y=os(os({},y),{},{tickCoord:y.coordinate});var j=vu(e,y.tickCoord,E,c,d);j&&(c=y.tickCoord+e*(E()/2+n),o[w]=os(os({},y),{},{isShow:!0}))},g=0;g<p;g++)x(g);return o}function Yv(e,t,r){var{tick:s,ticks:n,viewBox:i,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:m}=e;if(!n||!n.length||!s)return[];if(tt(c)||Gi.isSsr){var f;return(f=qse(n,tt(c)?c:0))!==null&&f!==void 0?f:[]}var h=[],p=l==="top"||l==="bottom"?"width":"height",x=u&&p==="width"?Nl(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(y,S)=>{var E=typeof d=="function"?d(y.value,S):y.value;return p==="width"?Vse(Nl(E,{fontSize:t,letterSpacing:r}),x,m):Nl(E,{fontSize:t,letterSpacing:r})[p]},v=n.length>=2?Kr(n[1].coordinate-n[0].coordinate):1,w=Gse(i,v,p);return c==="equidistantPreserveStart"?Kse(v,w,g,n,o):(c==="preserveStart"||c==="preserveStartEnd"?h=Qse(v,w,g,n,o,c==="preserveStartEnd"):h=Zse(v,w,g,n,o),h.filter(y=>y.isShow))}var eae=e=>{var{ticks:t,label:r,labelGapWithTick:s=5,tickSize:n=0,tickMargin:i=0}=e,o=0;if(t){t.forEach(u=>{if(u){var m=u.getBoundingClientRect();m.width>o&&(o=m.width)}});var l=r?r.getBoundingClientRect().width:0,c=n+i,d=o+c+l+(r?s:0);return Math.round(d)}return 0},tae=["axisLine","width","height","className","hide","ticks"],rae=["viewBox"],sae=["viewBox"];function Yp(e,t){if(e==null)return{};var r,s,n=aae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aae(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Ri(){return Ri=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ri.apply(null,arguments)}function E2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Fr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E2(Object(r),!0).forEach(function(s){nae(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function nae(e,t,r){return(t=iae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iae(e){var t=oae(e,"string");return typeof t=="symbol"?t:t+""}function oae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xv={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function lae(e){var{x:t,y:r,width:s,height:n,orientation:i,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var d=Fr(Fr(Fr({},c),$r(l,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var u=+(i==="top"&&!o||i==="bottom"&&o);d=Fr(Fr({},d),{},{x1:t,y1:r+u*n,x2:t+s,y2:r+u*n})}else{var m=+(i==="left"&&!o||i==="right"&&o);d=Fr(Fr({},d),{},{x1:t+m*s,y1:r,x2:t+m*s,y2:r+n})}return b.createElement("line",Ri({},d,{className:Et("recharts-cartesian-axis-line",ki(l,"className"))}))}function cae(e,t,r,s,n,i,o,l,c){var d,u,m,f,h,p,x=l?-1:1,g=e.tickSize||o,v=tt(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":d=u=e.coordinate,f=r+ +!l*n,m=f-x*g,p=m-x*c,h=v;break;case"left":m=f=e.coordinate,u=t+ +!l*s,d=u-x*g,h=d-x*c,p=v;break;case"right":m=f=e.coordinate,u=t+ +l*s,d=u+x*g,h=d+x*c,p=v;break;default:d=u=e.coordinate,f=r+ +l*n,m=f+x*g,p=m+x*c,h=v;break}return{line:{x1:d,y1:m,x2:u,y2:f},tick:{x:h,y:p}}}function dae(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function uae(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function mae(e){var{option:t,tickProps:r,value:s}=e,n,i=Et(r.className,"recharts-cartesian-axis-tick-value");if(b.isValidElement(t))n=b.cloneElement(t,Fr(Fr({},r),{},{className:i}));else if(typeof t=="function")n=t(Fr(Fr({},r),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=Et(o,t?.className)),n=b.createElement(ym,Ri({},r,{className:o}),s)}return n}function fae(e){var{ticks:t=[],tick:r,tickLine:s,stroke:n,tickFormatter:i,unit:o,padding:l,tickTextProps:c,orientation:d,mirror:u,x:m,y:f,width:h,height:p,tickSize:x,tickMargin:g,fontSize:v,letterSpacing:w,getTicksConfig:y,events:S}=e,E=Yv(Fr(Fr({},y),{},{ticks:t}),v,w),N=dae(d,u),j=uae(d,u),T=Vn(y),C=$r(r,!1),L=Fr(Fr({},T),{},{fill:"none"},$r(s,!1)),A=E.map((P,I)=>{var{line:_,tick:D}=cae(P,m,f,h,p,d,x,u,g),W=Fr(Fr(Fr(Fr({textAnchor:N,verticalAnchor:j},T),{},{stroke:"none",fill:n},C),D),{},{index:I,payload:P,visibleTicksCount:E.length,tickFormatter:i,padding:l},c);return b.createElement(Bs,Ri({className:"recharts-cartesian-axis-tick",key:"tick-".concat(P.value,"-").concat(P.coordinate,"-").concat(P.tickCoord)},vc(S,P,I)),s&&b.createElement("line",Ri({},L,_,{className:Et("recharts-cartesian-axis-tick-line",ki(s,"className"))})),r&&b.createElement(mae,{option:r,tickProps:W,value:"".concat(typeof i=="function"?i(P.value,I):P.value).concat(o||"")}))});return A.length>0?b.createElement("g",{className:"recharts-cartesian-axis-ticks"},A):null}var hae=b.forwardRef((e,t)=>{var{axisLine:r,width:s,height:n,className:i,hide:o,ticks:l}=e,c=Yp(e,tae),[d,u]=b.useState(""),[m,f]=b.useState(""),h=b.useRef([]);b.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var x;return eae({ticks:h.current,label:(x=e.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var p=b.useCallback(x=>{if(x){var g=x.getElementsByClassName("recharts-cartesian-axis-tick-value");h.current=Array.from(g);var v=g[0];if(v){var w=window.getComputedStyle(v),y=w.fontSize,S=w.letterSpacing;(y!==d||S!==m)&&(u(y),f(S))}}},[d,m]);return o||s!=null&&s<=0||n!=null&&n<=0?null:b.createElement(Bs,{className:Et("recharts-cartesian-axis",i),ref:p},b.createElement(lae,{x:e.x,y:e.y,width:s,height:n,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Vn(e)}),b.createElement(fae,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:d,letterSpacing:m,getTicksConfig:e,events:c}),b.createElement(yee,{x:e.x,y:e.y,width:e.width,height:e.height},b.createElement(kee,{label:e.label}),e.children))}),pae=b.memo(hae,(e,t)=>{var{viewBox:r}=e,s=Yp(e,rae),{viewBox:n}=t,i=Yp(t,sae);return _o(r,n)&&_o(s,i)}),Jv=b.forwardRef((e,t)=>{var r=ks(e,Xv);return b.createElement(pae,Ri({},r,{ref:t}))});Jv.displayName="CartesianAxis";var xae=["x1","y1","x2","y2","key"],gae=["offset"],vae=["xAxisId","yAxisId"],bae=["xAxisId","yAxisId"];function T2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ms(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T2(Object(r),!0).forEach(function(s){yae(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function yae(e,t,r){return(t=wae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wae(e){var t=jae(e,"string");return typeof t=="symbol"?t:t+""}function jae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ui(){return ui=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ui.apply(null,arguments)}function bu(e,t){if(e==null)return{};var r,s,n=Nae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Nae(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Sae=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:s,y:n,width:i,height:o,ry:l}=e;return b.createElement("rect",{x:s,y:n,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function uk(e,t){var r;if(b.isValidElement(e))r=b.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:s,y1:n,x2:i,y2:o,key:l}=t,c=bu(t,xae),d=Vn(c),{offset:u}=d,m=bu(d,gae);r=b.createElement("line",ui({},m,{x1:s,y1:n,x2:i,y2:o,fill:"none",key:l}))}return r}function Eae(e){var{x:t,width:r,horizontal:s=!0,horizontalPoints:n}=e;if(!s||!n||!n.length)return null;var{xAxisId:i,yAxisId:o}=e,l=bu(e,vae),c=n.map((d,u)=>{var m=ms(ms({},l),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(u),index:u});return uk(s,m)});return b.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function Tae(e){var{y:t,height:r,vertical:s=!0,verticalPoints:n}=e;if(!s||!n||!n.length)return null;var{xAxisId:i,yAxisId:o}=e,l=bu(e,bae),c=n.map((d,u)=>{var m=ms(ms({},l),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(u),index:u});return uk(s,m)});return b.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function Aae(e){var{horizontalFill:t,fillOpacity:r,x:s,y:n,width:i,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var d=l.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==d[0]&&d.unshift(0);var u=d.map((m,f)=>{var h=!d[f+1],p=h?n+o-m:d[f+1]-m;if(p<=0)return null;var x=f%t.length;return b.createElement("rect",{key:"react-".concat(f),y:m,x:s,height:p,width:i,stroke:"none",fill:t[x],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return b.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function Cae(e){var{vertical:t=!0,verticalFill:r,fillOpacity:s,x:n,y:i,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var d=c.map(m=>Math.round(m+n-n)).sort((m,f)=>m-f);n!==d[0]&&d.unshift(0);var u=d.map((m,f)=>{var h=!d[f+1],p=h?n+o-m:d[f+1]-m;if(p<=0)return null;var x=f%r.length;return b.createElement("rect",{key:"react-".concat(f),x:m,y:i,width:p,height:l,stroke:"none",fill:r[x],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return b.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var _ae=(e,t)=>{var{xAxis:r,width:s,height:n,offset:i}=e;return oA(Yv(ms(ms(ms({},Xv),r),{},{ticks:lA(r),viewBox:{x:0,y:0,width:s,height:n}})),i.left,i.left+i.width,t)},kae=(e,t)=>{var{yAxis:r,width:s,height:n,offset:i}=e;return oA(Yv(ms(ms(ms({},Xv),r),{},{ticks:lA(r),viewBox:{x:0,y:0,width:s,height:n}})),i.top,i.top+i.height,t)},Pae={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function yd(e){var t=Ag(),r=Cg(),s=mA(),n=ms(ms({},ks(e,Pae)),{},{x:tt(e.x)?e.x:s.left,y:tt(e.y)?e.y:s.top,width:tt(e.width)?e.width:s.width,height:tt(e.height)?e.height:s.height}),{xAxisId:i,yAxisId:o,x:l,y:c,width:d,height:u,syncWithTicks:m,horizontalValues:f,verticalValues:h}=n,p=wa(),x=Xe(C=>Ej(C,"xAxis",i,p)),g=Xe(C=>Ej(C,"yAxis",o,p));if(!tt(d)||d<=0||!tt(u)||u<=0||!tt(l)||l!==+l||!tt(c)||c!==+c)return null;var v=n.verticalCoordinatesGenerator||_ae,w=n.horizontalCoordinatesGenerator||kae,{horizontalPoints:y,verticalPoints:S}=n;if((!y||!y.length)&&typeof w=="function"){var E=f&&f.length,N=w({yAxis:g?ms(ms({},g),{},{ticks:E?f:g.ticks}):void 0,width:t,height:r,offset:s},E?!0:m);jl(Array.isArray(N),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof N,"]")),Array.isArray(N)&&(y=N)}if((!S||!S.length)&&typeof v=="function"){var j=h&&h.length,T=v({xAxis:x?ms(ms({},x),{},{ticks:j?h:x.ticks}):void 0,width:t,height:r,offset:s},j?!0:m);jl(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(S=T)}return b.createElement("g",{className:"recharts-cartesian-grid"},b.createElement(Sae,{fill:n.fill,fillOpacity:n.fillOpacity,x:n.x,y:n.y,width:n.width,height:n.height,ry:n.ry}),b.createElement(Aae,ui({},n,{horizontalPoints:y})),b.createElement(Cae,ui({},n,{verticalPoints:S})),b.createElement(Eae,ui({},n,{offset:s,horizontalPoints:y,xAxis:x,yAxis:g})),b.createElement(Tae,ui({},n,{offset:s,verticalPoints:S,xAxis:x,yAxis:g})))}yd.displayName="CartesianGrid";var Oae=["dangerouslySetInnerHTML","ticks"],Dae=["id"],Iae=["domain"],Rae=["domain"];function Xp(){return Xp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Xp.apply(null,arguments)}function yu(e,t){if(e==null)return{};var r,s,n=Fae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Fae(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Lae(e){var t=gr();return b.useEffect(()=>(t(fre(e)),()=>{t(hre(e))}),[e,t]),null}var Mae=e=>{var{xAxisId:t,className:r}=e,s=Xe(Eg),n=wa(),i="xAxis",o=Xe(g=>Uo(g,i,t,n)),l=Xe(g=>a_(g,i,t,n)),c=Xe(g=>e_(g,t)),d=Xe(g=>GJ(g,t)),u=Xe(g=>PC(g,t));if(c==null||d==null||u==null)return null;var{dangerouslySetInnerHTML:m,ticks:f}=e,h=yu(e,Oae),{id:p}=u,x=yu(u,Dae);return b.createElement(Jv,Xp({},h,x,{scale:o,x:d.x,y:d.y,width:c.width,height:c.height,className:Et("recharts-".concat(i," ").concat(i),r),viewBox:s,ticks:l}))},Bae={allowDataOverflow:$s.allowDataOverflow,allowDecimals:$s.allowDecimals,allowDuplicatedCategory:$s.allowDuplicatedCategory,height:$s.height,hide:!1,mirror:$s.mirror,orientation:$s.orientation,padding:$s.padding,reversed:$s.reversed,scale:$s.scale,tickCount:$s.tickCount,type:$s.type,xAxisId:0},$ae=e=>{var t,r,s,n,i,o=ks(e,Bae);return b.createElement(b.Fragment,null,b.createElement(Lae,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(s=o.angle)!==null&&s!==void 0?s:0,minTickGap:(n=o.minTickGap)!==null&&n!==void 0?n:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),b.createElement(Mae,o))},zae=(e,t)=>{var{domain:r}=e,s=yu(e,Iae),{domain:n}=t,i=yu(t,Rae);return _o(s,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:_o({domain:r},{domain:n}):!1},wd=b.memo($ae,zae);wd.displayName="XAxis";var Uae=["dangerouslySetInnerHTML","ticks"],Wae=["id"],Hae=["domain"],Vae=["domain"];function Jp(){return Jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Jp.apply(null,arguments)}function wu(e,t){if(e==null)return{};var r,s,n=Gae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Gae(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function qae(e){var t=gr();return b.useEffect(()=>(t(pre(e)),()=>{t(xre(e))}),[e,t]),null}var Kae=e=>{var{yAxisId:t,className:r,width:s,label:n}=e,i=b.useRef(null),o=b.useRef(null),l=Xe(Eg),c=wa(),d=gr(),u="yAxis",m=Xe(E=>Uo(E,u,t,c)),f=Xe(E=>t_(E,t)),h=Xe(E=>KJ(E,t)),p=Xe(E=>a_(E,u,t,c)),x=Xe(E=>OC(E,t));if(b.useLayoutEffect(()=>{if(!(s!=="auto"||!f||Mv(n)||b.isValidElement(n)||x==null)){var E=i.current;if(E){var N=E.getCalculatedWidth();Math.round(f.width)!==Math.round(N)&&d(gre({id:t,width:N}))}}},[p,f,d,n,t,s,x]),f==null||h==null||x==null)return null;var{dangerouslySetInnerHTML:g,ticks:v}=e,w=wu(e,Uae),{id:y}=x,S=wu(x,Wae);return b.createElement(Jv,Jp({},w,S,{ref:i,labelRef:o,scale:m,x:h.x,y:h.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:f.width,height:f.height,className:Et("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:p}))},Yae={allowDataOverflow:zs.allowDataOverflow,allowDecimals:zs.allowDecimals,allowDuplicatedCategory:zs.allowDuplicatedCategory,hide:!1,mirror:zs.mirror,orientation:zs.orientation,padding:zs.padding,reversed:zs.reversed,scale:zs.scale,tickCount:zs.tickCount,type:zs.type,width:zs.width,yAxisId:0},Xae=e=>{var t,r,s,n,i,o=ks(e,Yae);return b.createElement(b.Fragment,null,b.createElement(qae,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(s=o.angle)!==null&&s!==void 0?s:0,minTickGap:(n=o.minTickGap)!==null&&n!==void 0?n:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),b.createElement(Kae,o))},Jae=(e,t)=>{var{domain:r}=e,s=wu(e,Hae),{domain:n}=t,i=wu(t,Vae);return _o(s,i)?Array.isArray(r)&&r.length===2&&Array.isArray(n)&&n.length===2?r[0]===n[0]&&r[1]===n[1]:_o({domain:r},{domain:n}):!1},jd=b.memo(Xae,Jae);jd.displayName="YAxis";var y0={exports:{}},w0={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A2;function Zae(){if(A2)return w0;A2=1;var e=ax();function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,n=e.useRef,i=e.useEffect,o=e.useMemo,l=e.useDebugValue;return w0.useSyncExternalStoreWithSelector=function(c,d,u,m,f){var h=n(null);if(h.current===null){var p={hasValue:!1,value:null};h.current=p}else p=h.current;h=o(function(){function g(E){if(!v){if(v=!0,w=E,E=m(E),f!==void 0&&p.hasValue){var N=p.value;if(f(N,E))return y=N}return y=E}if(N=y,r(w,E))return N;var j=m(E);return f!==void 0&&f(N,j)?(w=E,N):(w=E,y=j)}var v=!1,w,y,S=u===void 0?null:u;return[function(){return g(d())},S===null?void 0:function(){return g(S())}]},[d,u,m,f]);var x=s(c,h[0],h[1]);return i(function(){p.hasValue=!0,p.value=x},[x]),l(x),x},w0}var C2;function Qae(){return C2||(C2=1,y0.exports=Zae()),y0.exports}Qae();function ene(e){e()}function tne(){let e=null,t=null;return{clear(){e=null,t=null},notify(){ene(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=e;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=t={callback:r,next:null,prev:t};return n.prev?n.prev.next=n:e=n,function(){!s||e===null||(s=!1,n.next?n.next.prev=n.prev:t=n.prev,n.prev?n.prev.next=n.next:e=n.next)}}}}var _2={notify(){},get:()=>[]};function rne(e,t){let r,s=_2,n=0,i=!1;function o(x){u();const g=s.subscribe(x);let v=!1;return()=>{v||(v=!0,g(),m())}}function l(){s.notify()}function c(){p.onStateChange&&p.onStateChange()}function d(){return i}function u(){n++,r||(r=e.subscribe(c),s=tne())}function m(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=_2)}function f(){i||(i=!0,u())}function h(){i&&(i=!1,m())}const p={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:f,tryUnsubscribe:h,getListeners:()=>s};return p}var sne=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ane=sne(),nne=()=>typeof navigator<"u"&&navigator.product==="ReactNative",ine=nne(),one=()=>ane||ine?b.useLayoutEffect:b.useEffect,lne=one(),cne=Symbol.for("react-redux-context"),dne=typeof globalThis<"u"?globalThis:{};function une(){if(!b.createContext)return{};const e=dne[cne]??=new Map;let t=e.get(b.createContext);return t||(t=b.createContext(null),e.set(b.createContext,t)),t}var mne=une();function fne(e){const{children:t,context:r,serverState:s,store:n}=e,i=b.useMemo(()=>{const c=rne(n);return{store:n,subscription:c,getServerState:s?()=>s:void 0}},[n,s]),o=b.useMemo(()=>n.getState(),[n]);lne(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==n.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=r||mne;return b.createElement(l.Provider,{value:i},t)}var hne=fne,pne=(e,t)=>t,Zv=ve([pne,Dt,CC,Wr,b_,Nn,ZZ,zr],sQ),Qv=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,s=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/s)}},mk=va("mouseClick"),fk=yc();fk.startListening({actionCreator:mk,effect:(e,t)=>{var r=e.payload,s=Zv(t.getState(),Qv(r));s?.activeIndex!=null&&t.dispatch(oZ({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var Zp=va("mouseMove"),hk=yc();hk.startListening({actionCreator:Zp,effect:(e,t)=>{var r=e.payload,s=t.getState(),n=_v(s,s.tooltip.settings.shared),i=Zv(s,Qv(r));n==="axis"&&(i?.activeIndex!=null?t.dispatch(m_({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(u_()))}});var k2={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},pk=ea({name:"rootProps",initialState:k2,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:k2.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),xne=pk.reducer,{updateOptions:gne}=pk.actions,xk=ea({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:vne}=xk.actions,bne=xk.reducer,gk=va("keyDown"),vk=va("focus"),e1=yc();e1.startListening({actionCreator:gk,effect:(e,t)=>{var r=t.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:n}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Number(kv(n,Ho(r))),l=Nn(r);if(i==="Enter"){var c=fu(r,"axis","hover",String(n.index));t.dispatch(Hp({active:!n.active,activeIndex:n.index,activeDataKey:n.dataKey,activeCoordinate:c}));return}var d=ZJ(r),u=d==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,f=o+m*u;if(!(l==null||f>=l.length||f<0)){var h=fu(r,"axis","hover",String(f));t.dispatch(Hp({active:!0,activeIndex:f.toString(),activeDataKey:void 0,activeCoordinate:h}))}}}}});e1.startListening({actionCreator:vk,effect:(e,t)=>{var r=t.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:n}=r.tooltip;if(!n.active&&n.index==null){var i="0",o=fu(r,"axis","hover",String(i));t.dispatch(Hp({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:o}))}}}});var la=va("externalEvent"),bk=yc();bk.startListening({actionCreator:la,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),s={activeCoordinate:WZ(r),activeDataKey:N_(r),activeIndex:Ii(r),activeLabel:j_(r),activeTooltipIndex:Ii(r),isTooltipActive:HZ(r)};e.payload.handler(s,e.payload.reactEvent)}}});var yne=ve([Wo],e=>e.tooltipItemPayloads),wne=ve([yne,Pc,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,s)=>{var n=e.find(l=>l.settings.dataKey===s);if(n!=null){var{positions:i}=n;if(i!=null){var o=t(i,r);return o}}}),yk=va("touchMove"),wk=yc();wk.startListening({actionCreator:yk,effect:(e,t)=>{var r=e.payload,s=t.getState(),n=_v(s,s.tooltip.settings.shared);if(n==="axis"){var i=Zv(s,Qv({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(m_({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(n==="item"){var o,l=r.touches[0],c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var d=c.getAttribute(dA),u=(o=c.getAttribute(uA))!==null&&o!==void 0?o:void 0,m=wne(t.getState(),d,u);t.dispatch(d_({activeDataKey:u,activeIndex:d,activeCoordinate:m}))}}});var jne=FT({brush:Rse,cartesianAxis:vre,chartData:bQ,errorBars:Ore,graphicalItems:Fte,layout:QV,legend:WG,options:hQ,polarAxis:Zee,polarOptions:bne,referenceElements:Use,rootProps:xne,tooltip:lZ}),Nne=function(t){return SV({reducer:jne,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([fk.middleware,hk.middleware,e1.middleware,bk.middleware,wk.middleware]),devTools:Gi.devToolsEnabled})};function jk(e){var{preloadedState:t,children:r,reduxStoreName:s}=e,n=wa(),i=b.useRef(null);if(n)return r;i.current==null&&(i.current=Nne(t));var o=vg;return b.createElement(hne,{context:o,store:i.current},r)}function Nk(e){var{layout:t,width:r,height:s,margin:n}=e,i=gr(),o=wa();return b.useEffect(()=>{o||(i(XV(t)),i(JV({width:r,height:s})),i(YV(n)))},[i,o,t,r,s,n]),null}function Sk(e){var t=gr();return b.useEffect(()=>{t(gne(e))},[t,e]),null}var Sne=["children"];function Ene(e,t){if(e==null)return{};var r,s,n=Tne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Tne(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function ju(){return ju=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ju.apply(null,arguments)}var Ane={width:"100%",height:"100%"},Cne=b.forwardRef((e,t)=>{var r=Ag(),s=Cg(),n=xA();if(!jo(r)||!jo(s))return null;var{children:i,otherAttributes:o,title:l,desc:c}=e,d,u;return typeof o.tabIndex=="number"?d=o.tabIndex:d=n?0:void 0,typeof o.role=="string"?u=o.role:u=n?"application":void 0,b.createElement(cg,ju({},o,{title:l,desc:c,role:u,tabIndex:d,width:r,height:s,style:Ane,ref:t}),i)}),_ne=e=>{var{children:t}=e,r=Xe(rm);if(!r)return null;var{width:s,height:n,y:i,x:o}=r;return b.createElement(cg,{width:s,height:n,x:o,y:i},t)},P2=b.forwardRef((e,t)=>{var{children:r}=e,s=Ene(e,Sne),n=wa();return n?b.createElement(_ne,null,r):b.createElement(Cne,ju({ref:t},s),r)});function kne(){var e=gr(),[t,r]=b.useState(null),s=Xe(CG);return b.useEffect(()=>{if(t!=null){var n=t.getBoundingClientRect(),i=n.width/t.offsetWidth;Qs(i)&&i!==s&&e(ZV(i))}},[t,e,s]),r}function O2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Pne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O2(Object(r),!0).forEach(function(s){One(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O2(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function One(e,t,r){return(t=Dne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dne(e){var t=Ine(e,"string");return typeof t=="symbol"?t:t+""}function Ine(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rne=b.forwardRef((e,t)=>{var{children:r,className:s,height:n,onClick:i,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:m,onMouseUp:f,onTouchEnd:h,onTouchMove:p,onTouchStart:x,style:g,width:v}=e,w=gr(),[y,S]=b.useState(null),[E,N]=b.useState(null);CQ();var j=kne(),T=b.useCallback(O=>{j(O),typeof t=="function"&&t(O),S(O),N(O)},[j,t,S,N]),C=b.useCallback(O=>{w(mk(O)),w(la({handler:i,reactEvent:O}))},[w,i]),L=b.useCallback(O=>{w(Zp(O)),w(la({handler:d,reactEvent:O}))},[w,d]),A=b.useCallback(O=>{w(u_()),w(la({handler:u,reactEvent:O}))},[w,u]),P=b.useCallback(O=>{w(Zp(O)),w(la({handler:m,reactEvent:O}))},[w,m]),I=b.useCallback(()=>{w(vk())},[w]),_=b.useCallback(O=>{w(gk(O.key))},[w]),D=b.useCallback(O=>{w(la({handler:o,reactEvent:O}))},[w,o]),W=b.useCallback(O=>{w(la({handler:l,reactEvent:O}))},[w,l]),K=b.useCallback(O=>{w(la({handler:c,reactEvent:O}))},[w,c]),J=b.useCallback(O=>{w(la({handler:f,reactEvent:O}))},[w,f]),F=b.useCallback(O=>{w(la({handler:x,reactEvent:O}))},[w,x]),le=b.useCallback(O=>{w(yk(O)),w(la({handler:p,reactEvent:O}))},[w,p]),Ae=b.useCallback(O=>{w(la({handler:h,reactEvent:O}))},[w,h]);return b.createElement(__.Provider,{value:y},b.createElement(sT.Provider,{value:E},b.createElement("div",{className:Et("recharts-wrapper",s),style:Pne({position:"relative",cursor:"default",width:v,height:n},g),onClick:C,onContextMenu:D,onDoubleClick:W,onFocus:I,onKeyDown:_,onMouseDown:K,onMouseEnter:L,onMouseLeave:A,onMouseMove:P,onMouseUp:J,onTouchEnd:Ae,onTouchMove:le,onTouchStart:F,ref:T},r)))}),Fne=["children","className","width","height","style","compact","title","desc"];function Lne(e,t){if(e==null)return{};var r,s,n=Mne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Mne(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Ek=b.forwardRef((e,t)=>{var{children:r,className:s,width:n,height:i,style:o,compact:l,title:c,desc:d}=e,u=Lne(e,Fne),m=Vn(u);return l?b.createElement(P2,{otherAttributes:m,title:c,desc:d},r):b.createElement(Rne,{className:s,style:o,width:n,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},b.createElement(P2,{otherAttributes:m,title:c,desc:d,ref:t},b.createElement(Hse,null,r)))}),Bne=["width","height"];function Qp(){return Qp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Qp.apply(null,arguments)}function $ne(e,t){if(e==null)return{};var r,s,n=zne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zne(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Une={top:5,right:5,bottom:5,left:5},Wne={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Une,reverseStackOrder:!1,syncMethod:"index"},Hne=b.forwardRef(function(t,r){var s,n=ks(t.categoricalChartProps,Wne),{width:i,height:o}=n,l=$ne(n,Bne);if(!jo(i)||!jo(o))return null;var{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:m,categoricalChartProps:f}=t,h={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:m,eventEmitter:void 0};return b.createElement(jk,{preloadedState:{options:h},reduxStoreName:(s=f.id)!==null&&s!==void 0?s:c},b.createElement(ok,{chartData:f.data}),b.createElement(Nk,{width:i,height:o,layout:n.layout,margin:n.margin}),b.createElement(Sk,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),b.createElement(Ek,Qp({},l,{width:i,height:o,ref:r})))}),Vne=["axis","item"],j0=b.forwardRef((e,t)=>b.createElement(Hne,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Vne,tooltipPayloadSearcher:k_,categoricalChartProps:e,ref:t}));function Gne(e){var t=gr();return b.useEffect(()=>{t(vne(e))},[t,e]),null}var qne=["width","height","layout"];function ex(){return ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ex.apply(null,arguments)}function Kne(e,t){if(e==null)return{};var r,s,n=Yne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Yne(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Xne={top:5,right:5,bottom:5,left:5},Jne={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Xne,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},Zne=b.forwardRef(function(t,r){var s,n=ks(t.categoricalChartProps,Jne),{width:i,height:o,layout:l}=n,c=Kne(n,qne);if(!jo(i)||!jo(o))return null;var{chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:m,tooltipPayloadSearcher:f}=t,h={chartName:d,defaultTooltipEventType:u,validateTooltipEventTypes:m,tooltipPayloadSearcher:f,eventEmitter:void 0};return b.createElement(jk,{preloadedState:{options:h},reduxStoreName:(s=n.id)!==null&&s!==void 0?s:d},b.createElement(ok,{chartData:n.data}),b.createElement(Nk,{width:i,height:o,layout:l,margin:n.margin}),b.createElement(Sk,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),b.createElement(Gne,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),b.createElement(Ek,ex({width:i,height:o},c,{ref:r})))}),Qne=["item"],eie={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},tie=b.forwardRef((e,t)=>{var r=ks(e,eie);return b.createElement(Zne,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Qne,tooltipPayloadSearcher:k_,categoricalChartProps:r,ref:t})});const rie=()=>{Qe();const[e,t]=b.useState(!1),r=[{title:"Create New Department",description:"Create a new academic department for course management",icon:ka,action:()=>{console.log("Create New Department")},color:"primary"}],[s,n]=b.useState({ongoingCourses:[],ongoingEnrollments:[],assessmentStatuses:[],passFailRate:[]});b.useEffect(()=>{(async()=>{t(!0);try{await new Promise(c=>setTimeout(c,1e3)),n({ongoingCourses:[{department:"Operations",count:15},{department:"Maintenance",count:12},{department:"Safety",count:8},{department:"Quality",count:10},{department:"Training",count:6}],ongoingEnrollments:[{department:"Operations",count:245},{department:"Maintenance",count:180},{department:"Safety",count:120},{department:"Quality",count:150},{department:"Training",count:95}],assessmentStatuses:[{status:"NOT_STARTED",count:150},{status:"DRAFT",count:30},{status:"SUBMITTED",count:45},{status:"APPROVED",count:85},{status:"REJECTED",count:12},{status:"CANCELLED",count:8}],passFailRate:[{department:"Operations",pass:120,fail:15},{department:"Maintenance",pass:95,fail:8},{department:"Safety",pass:80,fail:5},{department:"Quality",pass:100,fail:10},{department:"Training",pass:60,fail:3}]})}catch(c){console.error("Error fetching analytics data:",c)}finally{t(!1)}})()},[]);const i=["#1b3c53","#456882","#6a9fb8","#8fb6ce","#b4d3e4","#d9e9f2"],o={NOT_STARTED:"#6c757d",DRAFT:"#ffc107",SUBMITTED:"#0d6efd",APPROVED:"#28a745",REJECTED:"#dc3545",CANCELLED:"#6c757d"};return a.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:a.jsxs(_e,{className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{lg:12,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:a.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),a.jsx(M.Body,{children:a.jsx(oe,{children:r.map((l,c)=>a.jsx(H,{md:4,className:"mb-3",children:a.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:l.action,children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(l.icon,{size:24,className:`text-${l.color} me-2`}),a.jsx("h6",{className:"mb-0",children:l.title})]}),a.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:l.description}),a.jsx(on,{size:16,className:`text-${l.color} ms-auto`})]})},c))})})]})})}),e?a.jsx(oe,{children:a.jsx(H,{children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading analytics data..."})]})})}):a.jsxs(a.Fragment,{children:[a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{lg:6,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white border-0",children:a.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[a.jsx(hd,{className:"me-2",size:20}),"Ongoing Courses"]})}),a.jsx(M.Body,{children:a.jsx(md,{width:"100%",height:300,children:a.jsxs(j0,{data:s.ongoingCourses,children:[a.jsx(yd,{strokeDasharray:"3 3"}),a.jsx(wd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),a.jsx(jd,{}),a.jsx(ud,{}),a.jsx(li,{}),a.jsx(fl,{dataKey:"count",fill:"#1b3c53",name:"Number of Courses"})]})})})]})}),a.jsx(H,{lg:6,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white border-0",children:a.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[a.jsx(hd,{className:"me-2",size:20}),"Ongoing Trainees"]})}),a.jsx(M.Body,{children:a.jsx(md,{width:"100%",height:300,children:a.jsxs(j0,{data:s.ongoingEnrollments,children:[a.jsx(yd,{strokeDasharray:"3 3"}),a.jsx(wd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),a.jsx(jd,{}),a.jsx(ud,{}),a.jsx(li,{}),a.jsx(fl,{dataKey:"count",fill:"#456882",name:"Number of Trainees"})]})})})]})})]}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{lg:6,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white border-0",children:a.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[a.jsx(sN,{className:"me-2",size:20}),"Assessment Results"]})}),a.jsx(M.Body,{children:a.jsx(md,{width:"100%",height:300,children:a.jsxs(tie,{children:[a.jsx(ek,{data:s.assessmentStatuses,cx:"50%",cy:"50%",labelLine:!1,label:({name:l,percent:c})=>`${l}: ${(c*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:s.assessmentStatuses.map((l,c)=>a.jsx(Dc,{fill:o[l.status]||i[c%i.length]},`cell-${c}`))}),a.jsx(ud,{}),a.jsx(li,{})]})})})]})}),a.jsx(H,{lg:6,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white border-0",children:a.jsxs("h5",{className:"mb-0 text-white d-flex align-items-center",children:[a.jsx(hd,{className:"me-2",size:20}),"Training Effectiveness (Pass/Fail Rate)"]})}),a.jsx(M.Body,{children:a.jsx(md,{width:"100%",height:300,children:a.jsxs(j0,{data:s.passFailRate,children:[a.jsx(yd,{strokeDasharray:"3 3"}),a.jsx(wd,{dataKey:"department",angle:-45,textAnchor:"end",height:80,style:{fontSize:"12px"}}),a.jsx(jd,{}),a.jsx(ud,{}),a.jsx(li,{}),a.jsx(fl,{dataKey:"pass",stackId:"a",fill:"#28a745",name:"Pass"}),a.jsx(fl,{dataKey:"fail",stackId:"a",fill:"#dc3545",name:"Fail"})]})})})]})})]})]})]})})},sie=({courses:e,loading:t,actionsComponent:r,onView:s,onDisable:n,onRestore:i})=>{const{sortedData:o,sortConfig:l,handleSort:c}=Zt(e);if(t)return a.jsx(Wt,{rows:4,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No courses found"}),a.jsx("p",{children:"This department doesn't have any courses yet."})]})});const d=({columnKey:u,children:m,className:f=""})=>{const h=l.key===u,p=h?l.direction:null;return a.jsxs("th",{className:`fw-semibold ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",color:"white"},children:m}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:p,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"department-table-container",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",children:[a.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:a.jsxs("tr",{children:[a.jsx(d,{columnKey:"name",className:"show-mobile",children:"Course Name"}),a.jsx(d,{columnKey:"code",className:"show-mobile",children:"Code"}),a.jsx(d,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),a.jsx(d,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),a.jsx(d,{columnKey:"venue",className:"show-mobile",children:"Venue"}),a.jsx(d,{columnKey:"note",className:"show-mobile",children:"Note"}),a.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"})]})}),a.jsx("tbody",{children:o.map((u,m)=>a.jsxs("tr",{children:[a.jsx("td",{className:"show-mobile",children:a.jsx("div",{className:"fw-semibold text-primary cursor-pointer",onClick:()=>s(u.id),style:{cursor:"pointer"},children:u.name})}),a.jsx("td",{className:"show-mobile",children:a.jsx(Pe,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:u.code})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",children:u.startDate||"N/A"})]})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",children:u.endDate||"N/A"})]})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(tc,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",children:u.venue||"N/A"})]})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u.note||"N/A"})]})}),a.jsx("td",{className:"show-mobile",children:a.jsx(Pe,{bg:u.status==="ACTIVE"?"success":u.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:u.status||"N/A"})}),a.jsx("td",{className:"text-center show-mobile",children:a.jsx(r,{course:u,onView:s,onDisable:n,onRestore:i})})]},u.id))})]})})},aie=({course:e,onView:t,onDisable:r,onRestore:s})=>{const{hasPermission:n}=ku(),i=n(Ne.COURSES.VIEW_DETAIL),o=n(Ne.COURSES.ARCHIVE),l=n(Ne.COURSES.UPDATE),c=n(Ne.COURSES.RESTORE),d=o||l,u=e?.status==="ARCHIVED",m=()=>{t&&i&&t(e.id)},f=()=>{r&&d&&!u&&r(e.id)},h=()=>{s&&c&&u&&s(e.id)},p=[];return p.push({label:"View Details",icon:a.jsx(Nt,{}),onClick:m,disabled:!i}),p.push({type:"divider"}),u?p.push({label:"Restore Course",icon:a.jsx(V2,{}),className:"text-success",onClick:h,disabled:!c}):p.push({label:"Delete Course",icon:a.jsx(Ks,{}),className:"text-danger",onClick:f,disabled:!d}),a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:p})},nie=({show:e,onClose:t,onSave:r,loading:s=!1})=>{const[n,i]=b.useState({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),[o,l]=b.useState({});b.useEffect(()=>{e&&(i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}))},[e]);const c=()=>{i({name:"",code:"",description:"",maxNumTrainee:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"BEGINNER"}),l({}),t()},d=f=>{const{name:h,value:p}=f.target;if(i(x=>({...x,[h]:p})),o[h]&&l(x=>({...x,[h]:""})),h==="startDate"&&p){const x=new Date;x.setHours(0,0,0,0),new Date(p+"T00:00:00")<x&&l(v=>({...v,startDate:"Start date cannot be in the past"}))}if(h==="endDate"&&p){const x=new Date;x.setHours(0,0,0,0),new Date(p+"T00:00:00")<x&&l(v=>({...v,endDate:"End date cannot be in the past"}))}},u=()=>{const f={};if(n.name.trim()||(f.name="Course name is required"),n.code.trim()||(f.code="Course code is required"),n.description.trim()||(f.description="Description is required"),(!n.maxNumTrainee||isNaN(n.maxNumTrainee)||parseInt(n.maxNumTrainee)<=0)&&(f.maxNumTrainee="Max trainees must be a positive number"),n.venue.trim()||(f.venue="Venue is required"),(!n.passScore||isNaN(n.passScore)||!Number.isInteger(parseFloat(n.passScore))||parseInt(n.passScore)<0||parseInt(n.passScore)>100)&&(f.passScore="Pass score must be an integer between 0 and 100"),!n.startDate)f.startDate="Start date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(n.startDate+"T00:00:00")<h&&(f.startDate="Start date cannot be in the past")}if(!n.endDate)f.endDate="End date is required";else{const h=new Date;h.setHours(0,0,0,0),new Date(n.endDate+"T00:00:00")<h&&(f.endDate="End date cannot be in the past")}return n.startDate&&n.endDate&&new Date(n.startDate+"T00:00:00")>=new Date(n.endDate+"T00:00:00")&&(f.endDate="End date must be after start date"),l(f),Object.keys(f).length===0},m=async f=>{if(f.preventDefault(),!!u())try{await r(n),c()}catch{}};return a.jsxs(ue,{show:e,onHide:c,size:"lg",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Cs,{className:"me-2",size:20}),"Add New Course"]}),a.jsx(se,{variant:"link",onClick:c,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(k,{onSubmit:m,children:[a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto",paddingTop:"1.5rem"},children:[a.jsxs(oe,{className:"mb-5",children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Name *"}),a.jsx(k.Control,{type:"text",name:"name",value:n.name,onChange:d,isInvalid:!!o.name,disabled:s}),a.jsx(k.Control.Feedback,{type:"invalid",children:o.name})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Course Code *"}),a.jsx(k.Control,{type:"text",name:"code",value:n.code,onChange:d,isInvalid:!!o.code,disabled:s}),a.jsx(k.Control.Feedback,{type:"invalid",children:o.code})]})})]}),a.jsxs(oe,{className:"mb-5",children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Max Trainees *"}),a.jsx(k.Control,{type:"number",name:"maxNumTrainee",value:n.maxNumTrainee,onChange:d,isInvalid:!!o.maxNumTrainee,disabled:s,min:"1"}),a.jsx(k.Control.Feedback,{type:"invalid",children:o.maxNumTrainee})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Pass Score *"}),a.jsx(k.Control,{type:"number",name:"passScore",value:n.passScore,onChange:d,isInvalid:!!o.passScore,disabled:s,min:"0",max:"100",step:"1"}),a.jsx(k.Control.Feedback,{type:"invalid",children:o.passScore})]})})]}),a.jsxs(oe,{className:"mb-5",children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Level"}),a.jsxs(k.Select,{name:"level",value:n.level,onChange:d,disabled:s,children:[a.jsx("option",{value:"BEGINNER",children:"Beginner"}),a.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),a.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Venue *"}),a.jsx(k.Control,{type:"text",name:"venue",value:n.venue,onChange:d,isInvalid:!!o.venue,disabled:s}),a.jsx(k.Control.Feedback,{type:"invalid",children:o.venue})]})})]}),a.jsxs(oe,{className:"mb-5",children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Start Date *"}),a.jsx(k.Control,{type:"date",name:"startDate",value:n.startDate,onChange:d,isInvalid:!!o.startDate,disabled:s}),a.jsx(k.Control.Feedback,{type:"invalid",children:o.startDate})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"End Date *"}),a.jsx(k.Control,{type:"date",name:"endDate",value:n.endDate,onChange:d,isInvalid:!!o.endDate,disabled:s}),a.jsx(k.Control.Feedback,{type:"invalid",children:o.endDate})]})})]}),a.jsx(oe,{className:"mb-5",children:a.jsx(H,{children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Description *"}),a.jsx(k.Control,{as:"textarea",rows:3,name:"description",value:n.description,onChange:d,isInvalid:!!o.description,disabled:s}),a.jsx(k.Control.Feedback,{type:"invalid",children:o.description})]})})}),a.jsx(oe,{className:"mb-5",children:a.jsx(H,{children:a.jsxs(k.Group,{className:"mb-0",children:[a.jsx(k.Label,{className:"fw-bold mb-2 d-block",style:{marginTop:"0.5rem"},children:"Note"}),a.jsx(k.Control,{as:"textarea",rows:2,name:"note",value:n.note,onChange:d,disabled:s})]})})})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:c,disabled:s,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:"primary-custom",type:"submit",disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{className:"me-2",size:16}),"Create Course"]})})]})]})]})},iie=({show:e,onClose:t,onArchive:r,course:s,loading:n=!1})=>{const[i,o]=b.useState(""),[l,c]=b.useState(""),u=i==="ARCHIVE",m=()=>{o(""),c(""),t()},f=async()=>{if(!u){c('Please type "ARCHIVE" to confirm');return}try{await r(s?.id),m()}catch(p){c(p.message||"Failed to archive course. Please try again.")}},h=p=>{o(p.target.value),c("")};return a.jsxs(ue,{show:e,onHide:m,centered:!0,children:[a.jsxs(ue.Header,{className:"bg-warning text-dark border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(yr,{className:"me-2",size:20}),"Archive Course"]}),a.jsx(se,{variant:"link",onClick:m,className:"text-dark p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",children:[l&&a.jsx(Re,{variant:"danger",className:"mb-3",children:l}),a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"mb-2",children:"You are about to archive the following course:"}),a.jsxs("div",{className:"bg-light p-3 rounded",children:[a.jsx("strong",{children:"Course Code:"})," ",s?.code,a.jsx("br",{}),a.jsx("strong",{children:"Course Name:"})," ",s?.name,a.jsx("br",{}),s?.description&&a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Description:"})," ",s?.description,a.jsx("br",{})]}),s?.venue&&a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Venue:"})," ",s?.venue,a.jsx("br",{})]}),s?.startDate&&s?.endDate&&a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Duration:"})," ",s?.startDate," to ",s?.endDate]})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-warning mb-2",children:[a.jsx("strong",{children:"Warning:"})," This action will:"]}),a.jsxs("ul",{className:"text-warning mb-3",children:[a.jsx("li",{children:"Archive the course and make it unavailable for new enrollments"}),a.jsx("li",{children:"Remove the course from active course offerings"}),a.jsx("li",{children:"Affect any ongoing training sessions"}),a.jsx("li",{children:"Course data will be archived but can be restored if needed"})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",a.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),a.jsx("input",{type:"text",className:`form-control ${i&&!u?"is-invalid":""}`,id:"confirmText",value:i,onChange:h,placeholder:"Type ARCHIVE here",disabled:n}),i&&!u&&a.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:m,disabled:n,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:"warning",onClick:f,disabled:n||!u,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(yr,{className:"me-2",size:16}),"Archive Course"]})})]})]})},oie=({show:e,onClose:t,departmentHead:r,department:s})=>{if(!r)return null;const n=[r.firstName,r.middleName,r.lastName].filter(Boolean).join(" ");return a.jsxs(ue,{show:e,onHide:t,size:"lg",centered:!0,children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsxs(ue.Title,{children:[a.jsx(Lt,{className:"me-2"}),"Department Head Details"]})}),a.jsx(ue.Body,{children:a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:4,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3",style:{width:"80px",height:"80px"},children:a.jsx(Lt,{size:40,className:"text-white"})}),a.jsx("h5",{className:"mb-1",children:n}),a.jsx(Pe,{bg:"primary",className:"mb-2",children:r.role?.name||"Department Head"}),a.jsx("p",{className:"text-muted small mb-0",children:s?.name})]})}),a.jsx(H,{md:8,children:a.jsx(oe,{className:"g-4",children:a.jsx(H,{md:12,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(wi,{size:16,className:"me-2 text-primary"}),a.jsxs("div",{children:[a.jsx("small",{className:"text-muted",children:"Email"}),a.jsx("div",{className:"fw-semibold",children:r.email||"N/A"})]})]})})})})]})}),a.jsx(ue.Footer,{children:a.jsx(se,{variant:"secondary",onClick:t,children:"Close"})})]})},lie=({courseId:e})=>{const t=Qe(),[r,s]=b.useState(null),[n,i]=b.useState([]),[o,l]=b.useState(!0),[c,d]=b.useState(!1),[u,m]=b.useState("add"),[f,h]=b.useState(!1),[p,x]=b.useState(null),[g,v]=b.useState(null),[w,y]=b.useState(!1),[S,E]=b.useState(!1),N={1:{id:1,name:"Cabin Crew Training",code:"CCT",description:"Primarily responsible for training and developing flight attendants. The curriculum covers all skills required to work on board, including safety procedures, emergency response, first aid, and customer service.",duration:"6 months",status:"ACTIVE",totalSubjects:12,totalTrainers:8},2:{id:2,name:"Flight Crew Training",code:"FCTD",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"12 months",status:"ACTIVE",totalSubjects:18,totalTrainers:15},3:{id:3,name:"Ground Operations Training",code:"GOT",description:"A more specialized branch of Ground Training (GAT). It focuses on personnel working directly on the aircraft ramp/apron. Operations include marshalling aircraft into parking positions, operating passenger stairs and baggage vehicles, and carrying out cargo and baggage loading procedures.",duration:"4 months",status:"ACTIVE",totalSubjects:8,totalTrainers:6},4:{id:4,name:"Ground Affairs Training",code:"GAT",description:"Responsible for training staff in ground service departments. This area is broad and may include check-in agents, gate agents, baggage service staff, and more.",duration:"3 months",status:"ACTIVE",totalSubjects:6,totalTrainers:4},5:{id:5,name:"Technical & Aircraft Maintenance",code:"TAMT",description:"Training for pilots, including captains and first officers. Programs include simulator (SIM) training, type rating courses, and recurrent training to maintain and enhance flying skills.",duration:"18 months",status:"ACTIVE",totalSubjects:24,totalTrainers:20}},j=[{id:1,name:"Safety Procedures",code:"SAF001",startDate:"2024-01-15",endDate:"2024-01-29",venue:"Training Center A",note:"Basic safety protocols",status:"ACTIVE"},{id:2,name:"Emergency Response",code:"EMR001",startDate:"2024-02-01",endDate:"2024-02-22",venue:"Training Center B",note:"Emergency procedures training",status:"ACTIVE"},{id:3,name:"First Aid",code:"FAD001",startDate:"2024-01-20",endDate:"2024-01-27",venue:"Medical Center",note:"Basic first aid skills",status:"ACTIVE"},{id:4,name:"Customer Service",code:"CSV001",startDate:"2024-02-05",endDate:"2024-02-19",venue:"Training Center A",note:"Customer interaction skills",status:"ACTIVE"},{id:5,name:"Simulator Training",code:"SIM001",startDate:"2024-02-10",endDate:"2024-03-09",venue:"Simulator Complex",note:"Flight simulator training",status:"ACTIVE"},{id:6,name:"Type Rating",code:"TR001",startDate:"2024-03-01",endDate:"2024-04-12",venue:"Training Center C",note:"Aircraft type certification",status:"ACTIVE"},{id:7,name:"Recurrent Training",code:"RT001",startDate:"2024-01-25",endDate:"2024-02-08",venue:"Training Center A",note:"Refresher training",status:"ACTIVE"},{id:8,name:"Aircraft Marshalling",code:"AM001",startDate:"2024-02-15",endDate:"2024-02-22",venue:"Ramp Area",note:"Ground operations",status:"ACTIVE"},{id:9,name:"Baggage Handling",code:"BH001",startDate:"2024-02-20",endDate:"2024-02-27",venue:"Baggage Area",note:"Baggage operations",status:"ACTIVE"},{id:10,name:"Check-in Procedures",code:"CIP001",startDate:"2024-03-05",endDate:"2024-03-12",venue:"Terminal",note:"Passenger check-in",status:"ACTIVE"}];b.useEffect(()=>{e&&(async()=>{l(!0);try{const W=await Ds.getDepartmentById(e);if(!W)throw new Error(`Department with ID ${e} not found in API response`);const K={id:W.id,name:W.name,code:W.code,description:W.description,duration:"N/A",status:W.isActive,totalSubjects:W.courseCount||0,totalTrainers:W.trainerCount||0};s(K);const J=W.courses?.map(F=>({id:F.id,name:F.name,code:F.code,startDate:F.startDate?new Date(F.startDate).toISOString().split("T")[0]:"N/A",endDate:F.endDate?new Date(F.endDate).toISOString().split("T")[0]:"N/A",venue:F.venue||"N/A",note:F.note||"N/A",status:F.status,description:F.description,maxNumTrainee:F.maxNumTrainee,passScore:F.passScore,level:F.level,subjectCount:F.subjectCount||0}))||[];i(J),W.headUser&&v(W.headUser),l(!1)}catch{l(!1);const D=N[e];D&&(s(D),i(j))}})()},[e]);const T=()=>{m("add"),d(!0)},C=_=>{const D=n.find(W=>W.id===_);x(D),h(!0)},L=async _=>{try{await Ds.archiveCourse(_),ce.success("Course deleted successfully"),i(D=>D.filter(W=>W.id!==_)),h(!1),x(null)}catch(D){throw ce.error("Failed to delete course. Please try again."),D}},A=async _=>{try{await Ds.restoreCourse(_),ce.success("Course restored successfully"),i(D=>D.map(W=>W.id===_?{...W,status:"ACTIVE"}:W))}catch(D){ce.error(D.response?.data?.message||"Failed to restore course. Please try again.")}},P=_=>{t(`/academic/course-detail/${_}`,{state:{departmentId:r.id,departmentName:r?.name||"Department"}})},I=async _=>{try{E(!0);const D={departmentId:r.id,name:_.name,description:_.description,code:_.code,maxNumTrainee:Number(_.maxNumTrainee),venue:_.venue,note:_.note,passScore:Number(_.passScore),startDate:_.startDate?new Date(_.startDate).toISOString():null,endDate:_.endDate?new Date(_.endDate).toISOString():null,level:_.level},W=await Ds.createCourse(D);ce.success("Course created successfully");const K={id:W.id,name:W.name,code:W.code,startDate:W.startDate?new Date(W.startDate).toISOString().split("T")[0]:"N/A",endDate:W.endDate?new Date(W.endDate).toISOString().split("T")[0]:"N/A",venue:W.venue||"N/A",note:W.note||"N/A",status:W.status||"PLANNED",description:W.description,maxNumTrainee:W.maxNumTrainee,passScore:W.passScore,level:W.level,department:W.department};i(J=>[K,...J])}catch(D){throw D.response?.status,ce.error(D.response?.data?.message||"Failed to create course"),D}finally{E(!1)}};return o?a.jsx(_e,{className:"py-4",children:a.jsx("div",{className:"text-center",children:a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):r?a.jsxs(_e,{className:"d-flex flex-column",style:{padding:"0.5rem 1rem",overflowX:"hidden"},children:[a.jsx(oe,{className:"mb-1 flex-shrink-0",children:a.jsx(H,{children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsxs(M.Body,{className:"p-2",children:[a.jsx("div",{className:"d-flex justify-content-between align-items-start mb-1",children:a.jsxs("div",{children:[a.jsxs("h4",{className:"mb-1",children:[a.jsx(bt,{className:"me-2 text-primary"}),r.name]}),a.jsxs("p",{className:"text-muted mb-0 small",children:["Department Code: ",r.code]})]})}),a.jsx("p",{className:"text-muted mb-1 small",children:r.description}),a.jsxs(oe,{className:"g-2",children:[a.jsx(H,{md:4,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"me-2 text-primary",size:16}),a.jsxs("div",{children:[a.jsx("small",{className:"text-muted",children:"Total Subjects"}),a.jsx("div",{className:"fw-semibold small",children:r.totalSubjects})]})]})}),a.jsx(H,{md:4,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ar,{className:"me-2 text-primary",size:16}),a.jsxs("div",{children:[a.jsx("small",{className:"text-muted",children:"Total Trainers"}),a.jsx("div",{className:"fw-semibold small",children:r.totalTrainers})]})]})}),a.jsx(H,{md:4,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"me-2 text-primary",size:16}),a.jsxs("div",{children:[a.jsx("small",{className:"text-muted",children:"Department Head"}),a.jsx("div",{className:"fw-semibold small",children:g?a.jsx(se,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>y(!0),style:{fontSize:"inherit",fontWeight:"inherit",color:"#0d6efd"},children:[g.firstName,g.middleName,g.lastName].filter(Boolean).join(" ")}):"Not assigned"})]})]})})]})]})})})}),a.jsx(oe,{className:"mt-3",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"academic-course-section-header bg-primary text-white border-0 flex-shrink-0",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("h5",{className:"mb-0 text-white",children:[a.jsx(nr,{className:"me-2"}),"Courses (",n.length,")"]}),a.jsx(wr,{permission:Ne.COURSES.CREATE,children:a.jsxs(se,{variant:"light",size:"sm",onClick:T,className:"academic-course-add-btn",children:[a.jsx(Cs,{size:16,className:"me-1"}),"Add New Course"]})})]})}),a.jsx("div",{className:"p-0",children:a.jsx(sie,{courses:n,loading:!1,actionsComponent:aie,onView:P,onDisable:C,onRestore:A})})]})})}),a.jsx(nie,{show:c&&u==="add",onClose:()=>d(!1),onSave:I,loading:S}),a.jsx(iie,{show:f,onClose:()=>h(!1),onArchive:L,course:p}),a.jsx(oie,{show:w,onClose:()=>y(!1),departmentHead:g,department:r})]}):a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center text-muted",children:[a.jsx(bt,{size:48,className:"mb-3"}),a.jsx("h4",{children:"Department not found"}),a.jsx("p",{children:"The requested department could not be found."})]})})},cie=()=>{const{courseId:e}=Nr();return a.jsx(lie,{courseId:e})},die=({trainer:e,onEdit:t,onDelete:r})=>a.jsx(wr,{permissions:[Ne.SUBJECTS.UPDATE,Ne.SUBJECTS.REMOVE_INSTRUCTOR],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"Edit Trainer",icon:a.jsx(as,{}),onClick:()=>t(e.id),permission:Ne.SUBJECTS.UPDATE},{type:"divider"},{label:"Remove Trainer",icon:a.jsx(Mi,{}),className:"text-danger",onClick:()=>r(e.id),permission:Ne.SUBJECTS.REMOVE_INSTRUCTOR}]})}),Tk=({show:e,onClose:t,onDisable:r,subject:s,loading:n=!1})=>{const[i,o]=b.useState(""),[l,c]=b.useState(""),[d,u]=b.useState(0),[m,f]=b.useState(!1),p=i==="ARCHIVE";b.useEffect(()=>{e&&s?.id?x():(u(0),o(""),c(""))},[e,s?.id]);const x=async()=>{if(s?.id){f(!0);try{const y=await cs.getSubjectById(s.id);if(y?.enrollmentCount!==void 0)u(y.enrollmentCount);else if(y?.enrollments&&Array.isArray(y.enrollments))u(y.enrollments.length);else try{const S=await Ie.get(`/subjects/${s.id}/enrollments`);S?.data?.enrollments?u(S.data.enrollments.length):S?.data?.count!==void 0&&u(S.data.count)}catch{u(0)}}catch{u(0)}finally{f(!1)}}},g=()=>{o(""),c(""),u(0),t()},v=async()=>{if(!p){c('Please type "ARCHIVE" to confirm');return}try{await r(s?.id),g()}catch(y){c(y.message||"Failed to disable subject. Please try again.")}},w=y=>{o(y.target.value),c("")};return a.jsxs(ue,{show:e,onHide:g,centered:!0,children:[a.jsx(ue.Header,{className:"bg-warning text-dark border-0",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(yr,{className:"me-2",size:20}),"Archive Subject"]})}),a.jsxs(ue.Body,{className:"p-4",children:[l&&a.jsx(Re,{variant:"danger",className:"mb-3",children:l}),a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"mb-2",children:"You are about to archive the following subject:"}),a.jsxs("div",{className:"bg-light p-3 rounded",children:[a.jsx("strong",{children:"Subject Code:"})," ",s?.code,a.jsx("br",{}),a.jsx("strong",{children:"Subject Name:"})," ",s?.name,a.jsx("br",{}),s?.description&&a.jsxs(a.Fragment,{children:[a.jsx("strong",{children:"Description:"})," ",s?.description]})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-warning mb-2",children:[a.jsx("strong",{children:"Warning:"})," This action will:"]}),a.jsxs("ul",{className:"text-warning mb-3",children:[a.jsx("li",{children:"Make the subject unavailable for new enrollments"}),a.jsx("li",{children:"Remove the subject from active course offerings"}),a.jsx("li",{children:"Affect any ongoing training sessions"}),d>0&&a.jsxs("li",{className:"fw-bold",children:[a.jsxs("strong",{children:["Cascade cancel all ",d," enrollment",d>1?"s":""]})," associated with this subject"]})]}),d>0&&a.jsxs("div",{className:"alert alert-warning mb-0",children:[a.jsx("strong",{children:"Total Enrollments:"})," ",a.jsx(Pe,{bg:"warning",className:"text-dark ms-2",children:d}),d>0&&a.jsxs("p",{className:"mb-0 mt-2 small",children:["All ",d," enrollment",d>1?"s":""," will be automatically cancelled when this subject is archived."]})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("label",{htmlFor:"confirmText",className:"form-label",children:["To confirm, please type ",a.jsx("strong",{children:"ARCHIVE"})," in the box below:"]}),a.jsx("input",{type:"text",className:`form-control ${i&&!p?"is-invalid":""}`,id:"confirmText",value:i,onChange:w,placeholder:"Type ARCHIVE here",disabled:n}),i&&!p&&a.jsx("div",{className:"invalid-feedback",children:'Please type "ARCHIVE" exactly as shown'})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsx(se,{variant:"outline-secondary",onClick:g,disabled:n,children:"Cancel"}),a.jsx(se,{variant:"warning",onClick:v,disabled:n||!p||m,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Archiving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(yr,{className:"me-2",size:16}),"Archive Subject"]})})]})]})},uie=({show:e,onClose:t,onSave:r,subject:s,loading:n=!1})=>{const[i,o]=b.useState({name:"",code:"",description:"",duration:"",level:"Beginner"}),[l,c]=b.useState([]);b.useEffect(()=>{s&&e&&(o({name:s.name||"",code:s.code||"",description:s.description||"",duration:s.duration||"",level:s.level||"Beginner"}),c([]))},[s,e]);const d=h=>{const{name:p,value:x}=h.target;o(g=>({...g,[p]:x}))},u=()=>{const h=[];return i.name.trim()||h.push("Subject name is required"),i.code.trim()||h.push("Subject code is required"),i.description.trim()||h.push("Description is required"),i.duration.trim()||h.push("Duration is required"),c(h),h.length===0},m=async h=>{if(h.preventDefault(),!!u())try{await r(i),f()}catch{}},f=()=>{o({name:"",code:"",description:"",duration:"",level:"Beginner"}),c([]),t()};return a.jsxs(ue,{show:e,onHide:f,size:"lg",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(as,{className:"me-2",size:20}),"Edit Subject"]}),a.jsx(se,{variant:"link",onClick:f,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",children:[l.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:l.map((h,p)=>a.jsx("li",{children:h},p))})}),a.jsxs(k,{onSubmit:m,children:[a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Subject Name *"}),a.jsx(k.Control,{type:"text",name:"name",value:i.name,onChange:d,placeholder:"Enter subject name",disabled:n})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Subject Code *"}),a.jsx(k.Control,{type:"text",name:"code",value:i.code,onChange:d,placeholder:"Enter subject code",disabled:n})]})})]}),a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Duration *"}),a.jsx(k.Control,{type:"text",name:"duration",value:i.duration,onChange:d,placeholder:"e.g., 2 weeks, 1 month",disabled:n})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Level"}),a.jsxs(k.Select,{name:"level",value:i.level,onChange:d,disabled:n,children:[a.jsx("option",{value:"Beginner",children:"Beginner"}),a.jsx("option",{value:"Intermediate",children:"Intermediate"}),a.jsx("option",{value:"Advanced",children:"Advanced"})]})]})})]}),a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Description *"}),a.jsx(k.Control,{as:"textarea",rows:4,name:"description",value:i.description,onChange:d,placeholder:"Enter subject description",disabled:n})]})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:f,disabled:n,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:"primary",onClick:m,disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(as,{className:"me-2",size:16}),"Save Changes"]})})]})]})},mie=({show:e,onClose:t,onSave:r,trainer:s,loading:n=!1})=>{const[i,o]=b.useState({roleInSubject:"EXAMINER"}),[l,c]=b.useState([]);b.useEffect(()=>{if(s&&e){const h=s.role==="EXAMINER"||s.role==="ASSESSMENT_REVIEWER"?s.role:"EXAMINER";o({roleInSubject:h}),c([])}},[s,e]);const d=h=>{const{name:p,value:x}=h.target;o(g=>({...g,[p]:x}))},u=()=>{const h=[];return i.roleInSubject||h.push("Role in assessment is required"),c(h),h.length===0},m=async h=>{if(h.preventDefault(),!!u())try{await r(i),f()}catch{}},f=()=>{o({roleInSubject:"EXAMINER"}),c([]),t()};return a.jsxs(ue,{show:e,onHide:f,size:"lg",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(as,{className:"me-2",size:20}),"Edit Trainer"]}),a.jsx(se,{variant:"link",onClick:f,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",children:[l.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:l.map((h,p)=>a.jsx("li",{children:h},p))})}),a.jsxs(k,{onSubmit:m,children:[a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Trainer Name"}),a.jsx(k.Control,{type:"text",value:s?.name||"",disabled:!0,className:"bg-light"})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"EID"}),a.jsx(k.Control,{type:"text",value:s?.eid||"",disabled:!0,className:"bg-light"})]})})]}),a.jsx(oe,{children:a.jsx(H,{md:12,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Role in Assessment *"}),a.jsxs(k.Select,{name:"roleInSubject",value:i.roleInSubject,onChange:d,disabled:n,children:[a.jsx("option",{value:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),a.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]}),a.jsx(k.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:f,disabled:n,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:"primary",onClick:m,disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(as,{className:"me-2",size:16}),"Save Changes"]})})]})]})},fie=({show:e,onClose:t,onSave:r,loading:s=!1})=>{const[n,i]=b.useState({trainer_user_id:"",role_in_subject:"EXAMINER"}),[o,l]=b.useState([]),[c,d]=b.useState([]),[u,m]=b.useState(!1),f=async()=>{m(!0);try{const g=await bs.getTrainers();g&&g.data?d(g.data):d([])}catch{d([])}finally{m(!1)}};b.useEffect(()=>{e&&(i({trainer_user_id:"",role_in_subject:"EXAMINER"}),l([]),f())},[e]);const h=()=>{const g=[];return n.trainer_user_id||g.push("Please select a trainer"),n.role_in_subject||g.push("Role in assessment is required"),l(g),g.length===0},p=async g=>{if(g.preventDefault(),!!h())try{await r(n),x()}catch{}},x=()=>{i({trainer_user_id:"",role_in_subject:"EXAMINER"}),l([]),t()};return a.jsxs(ue,{show:e,onHide:x,size:"lg",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Cs,{className:"me-2",size:20}),"Add Trainer"]}),a.jsx(se,{variant:"link",onClick:x,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",children:[o.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:o.map((g,v)=>a.jsx("li",{children:g},v))})}),a.jsx(k,{onSubmit:p,children:a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Select Trainer *"}),a.jsxs($t,{onSelect:g=>{i(v=>({...v,trainer_user_id:g||""}))},children:[a.jsx($t.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:s||u,style:{border:"1px solid #ced4da",backgroundColor:s||u?"#e9ecef":"#fff",minWidth:0},children:a.jsx("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:n.trainer_user_id?c.find(g=>g.id===n.trainer_user_id)?`${c.find(g=>g.id===n.trainer_user_id).firstName} ${c.find(g=>g.id===n.trainer_user_id).lastName} - ${c.find(g=>g.id===n.trainer_user_id).department?.name||"General"}`:"Choose a trainer...":u?"Loading trainers...":"Choose a trainer..."})}),a.jsx($t.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:u?a.jsxs($t.Item,{disabled:!0,children:[a.jsx(Pt,{animation:"border",size:"sm",className:"me-2"}),"Loading trainers..."]}):c.length===0?a.jsx($t.Item,{disabled:!0,children:"No trainers available"}):c.map(g=>a.jsxs($t.Item,{eventKey:g.id,children:[g.firstName," ",g.lastName," - ",g.department?.name||"General"]},g.id))})]}),u&&a.jsxs("div",{className:"mt-2 text-center",children:[a.jsx(Pt,{animation:"border",size:"sm",className:"me-2"}),a.jsx("small",{className:"text-muted",children:"Loading trainers..."})]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Role in Assessment *"}),a.jsxs($t,{onSelect:g=>{i(v=>({...v,role_in_subject:g||"EXAMINER"}))},children:[a.jsx($t.Toggle,{variant:"outline-secondary",className:"w-100 text-start d-flex justify-content-between align-items-center",disabled:s,style:{border:"1px solid #ced4da",backgroundColor:s?"#e9ecef":"#fff",minWidth:0},children:a.jsxs("span",{className:"flex-grow-1 text-truncate",style:{minWidth:0,overflow:"hidden"},children:[n.role_in_subject==="EXAMINER"&&"Examiner - Conducts exams and assessments",n.role_in_subject==="ASSESSMENT_REVIEWER"&&"Assessment Reviewer - Reviews and grades assessments"]})}),a.jsxs($t.Menu,{align:"start",className:"w-100",style:{maxHeight:"250px",overflowY:"auto"},popperConfig:{modifiers:[{name:"preventOverflow",options:{boundary:"clippingParents",padding:8}},{name:"flip",options:{fallbackPlacements:[],boundary:"clippingParents",padding:8}},{name:"offset",options:{offset:[0,4]}}]},children:[a.jsx($t.Item,{eventKey:"EXAMINER",children:"Examiner - Conducts exams and assessments"}),a.jsx($t.Item,{eventKey:"ASSESSMENT_REVIEWER",children:"Assessment Reviewer - Reviews and grades assessments"})]})]}),a.jsx(k.Text,{className:"text-muted",children:"Select the appropriate role for this trainer in assessments (EXAMINER or ASSESSMENT_REVIEWER only)"})]})})]})})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:x,disabled:s,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:"primary",onClick:p,disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem"}}),"Adding..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Cs,{className:"me-2",size:16}),"Add Trainer"]})})]})]})},hie=({subjectId:e,courseId:t})=>{const r=Qe(),s=$n(),[n,i]=b.useState(null),[o,l]=b.useState([]),[c,d]=b.useState(!0),[u,m]=b.useState(!1),[f,h]=b.useState(!1),[p,x]=b.useState(!1),[g,v]=b.useState(!1),[w,y]=b.useState(null),[S,E]=b.useState(!1),[N,j]=b.useState(!1),[T,C]=b.useState(!1),[L,A]=b.useState(!1),[P,I]=b.useState("subject-info"),{sortedData:_}=Zt(o),D=G=>({PRIMARY_INSTRUCTOR:{text:"Primary Instructor",variant:"primary"},EXAMINER:{text:"Examiner",variant:"warning"},ASSESSMENT_REVIEWER:{text:"Assessment Reviewer",variant:"info"},ASSISTANT_INSTRUCTOR:{text:"Assistant Instructor",variant:"secondary"}})[G]||{text:G,variant:"light"},W=b.useCallback(G=>{if(G&&G.instructors){const U=G.instructors.map(B=>({id:B.id,eid:B.eid,name:`${B.firstName} ${B.lastName}`,role:B.roleInSubject,assignedAt:B.assignedAt}));l(U)}else l([])},[]);b.useEffect(()=>{e&&(async()=>{if(!e){i(null),d(!1);return}d(!0);try{const U=await cs.getSubjectById(e);U?(i(U),W(U)):i(null)}catch(U){let B=U.response?.data?.message||U.message||"Failed to load subject details";if(U.response?.data?.errors&&Array.isArray(U.response.data.errors)&&U.response.data.errors.length>0){const Y=U.response.data.errors[0];B=`${B}: ${Y.message||Y.field}`}ce.error(B),i(null)}finally{d(!1)}})()},[e,W]);const K=async G=>{j(!0);try{await new Promise(U=>setTimeout(U,1e3)),i(U=>({...U,...G})),ce.success("Subject updated successfully!"),h(!1)}catch{ce.error("Failed to update subject")}finally{j(!1)}},J=async()=>{E(!0);try{await new Promise(G=>setTimeout(G,1e3)),m(!1)}catch{}finally{E(!1)}},F=async G=>{C(!0);try{await cs.addTrainerToSubject(e,G);const U=await cs.getSubjectById(e);U&&(i(U),W(U)),ce.success("Trainer added successfully!"),x(!1)}catch(U){const B=U?.message||U?.error||"Failed to add trainer";ce.error(B)}finally{C(!1)}},le=async G=>{if(w){A(!0);try{await cs.updateTrainerRole(e,w.id,G);const U=await cs.getSubjectById(e);U&&(i(U),W(U)),ce.success("Trainer role updated successfully!"),v(!1)}catch(U){console.error("Error updating trainer role:",U);const B=U?.message||U?.error||"Failed to update trainer role";ce.error(B)}finally{A(!1)}}},Ae=async G=>{if(G)try{await cs.removeTrainerFromSubject(e,G);const U=await cs.getSubjectById(e);U&&(i(U),W(U)),ce.success("Trainer removed successfully!")}catch(U){console.error("Error removing trainer:",U);const B=U?.message||U?.error||"Failed to remove trainer";ce.error(B)}},O=()=>{if(t)r(`/academic/course-detail/${t}`);else if(s.state?.courseId)r(`/academic/course-detail/${s.state.courseId}`);else if(document.referrer){const G=document.referrer.match(/\/course-detail\/([^/]+)/);r(G?`/academic/course-detail/${G[1]}`:-1)}else n?.courseId?r(`/academic/course-detail/${n.courseId}`):r(-1)};return c?a.jsx(_e,{className:"py-4",children:a.jsx(Wt,{rows:4,columns:3})}):n?a.jsxs(_e,{className:"py-4 subject-details",children:[a.jsx("div",{className:"d-flex justify-content-between align-items-start mb-4",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs(se,{variant:"outline-secondary",onClick:O,className:"me-3",children:[a.jsx(Tt,{className:"me-2",size:16}),"Back to Course"]}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:n.name}),a.jsxs("p",{className:"text-muted mb-0",children:["Subject Code: ",n.code]})]})]})}),a.jsx(M,{className:"border-0 shadow-sm",children:a.jsxs(Vt.Container,{activeKey:P,onSelect:I,children:[a.jsx(M.Header,{className:"border-bottom py-2 bg-primary",children:a.jsxs(St,{variant:"tabs",className:"border-0",children:[a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"subject-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:P==="subject-info"?"600":"400",opacity:P==="subject-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(Z2,{className:"me-2",size:16}),"Subject Information"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"trainers",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:P==="trainers"?"600":"400",opacity:P==="trainers"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(rN,{className:"me-2",size:16}),"Trainers (",o.length,")"]})})]})}),a.jsx(M.Body,{className:"p-4",children:a.jsxs(Vt.Content,{children:[a.jsxs(Vt.Pane,{eventKey:"subject-info",children:[a.jsxs(oe,{children:[a.jsxs(H,{md:6,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Name:"})," ",n.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Code:"})," ",n.code]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Description:"})," ",n.description]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Method:"})," ",n.method]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Duration:"})," ",n.duration," days"]})]}),a.jsxs(H,{md:6,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Type:"})," ",n.type]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Pass Score:"})," ",n.passScore,"%"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Room:"})," ",n.roomName]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Time Slot:"})," ",n.timeSlot]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Start Date:"})," ",new Date(n.startDate).toLocaleDateString()]}),a.jsxs("p",{children:[a.jsx("strong",{children:"End Date:"})," ",new Date(n.endDate).toLocaleDateString()]})]})]}),n.remarkNote&&a.jsx(oe,{children:a.jsx(H,{xs:12,children:a.jsxs("p",{children:[a.jsx("strong",{children:"Remark Note:"})," ",n.remarkNote]})})})]}),a.jsxs(Vt.Pane,{eventKey:"trainers",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[a.jsxs("h6",{className:"mb-0",children:["Trainers (",o.length,")"]}),a.jsxs(se,{variant:"primary",size:"sm",onClick:()=>x(!0),children:[a.jsx(Cs,{size:14,className:"me-1"}),"Add Trainer"]})]}),a.jsxs(It,{hover:!0,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"EID"}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Assigned Date"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:_.map(G=>{const U=D(G.role);return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Pe,{bg:"secondary",className:"text-white",children:G.eid})}),a.jsx("td",{children:G.name}),a.jsx("td",{children:a.jsx(Pe,{bg:U.variant,children:U.text})}),a.jsx("td",{children:new Date(G.assignedAt).toLocaleDateString()}),a.jsx("td",{children:a.jsx(die,{trainer:G,onEdit:()=>{y(G),v(!0)},onDelete:Ae})})]},G.id)})})]})]})]})})]})}),a.jsx(Tk,{show:u,onClose:()=>m(!1),onConfirm:J,subject:n,loading:S}),a.jsx(uie,{show:f,onClose:()=>h(!1),onSave:K,subject:n,loading:N}),a.jsx(fie,{show:p,onClose:()=>x(!1),onSave:F,loading:T}),a.jsx(mie,{show:g,onClose:()=>v(!1),onSave:le,trainer:w,loading:L})]}):a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h3",{children:"Subject not found"}),a.jsx("p",{children:"The requested subject could not be found."}),a.jsxs(se,{variant:"primary",onClick:O,children:[a.jsx(Tt,{className:"me-2",size:16}),"Go Back"]})]})})},D2=()=>{const{subjectId:e,courseId:t}=Nr();return a.jsx(hie,{subjectId:e,courseId:t})},pie=({subject:e,onView:t,onEdit:r,onDelete:s})=>{const n=()=>{t&&t(e.id)},i=()=>{s&&s(e.id)};return a.jsx(wr,{permissions:[Ne.SUBJECTS.VIEW_DETAIL,Ne.SUBJECTS.DELETE],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Details",icon:a.jsx(Nt,{}),onClick:n,permission:Ne.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Archive Subject",icon:a.jsx(W2,{}),className:"text-warning",onClick:i,permission:Ne.SUBJECTS.ARCHIVE}]})})},xie=e=>({id:e.id,name:e.name,code:e.code,method:e.method,duration:vie(e.duration),startDate:I2(e.startDate||e.start_date),endDate:I2(e.endDate||e.end_date),roomName:e.roomName||e.room_name,trainees:e.enrollmentCount||e.enrollment_count||0,status:e.status||(e.deletedAt?"ARCHIVED":"PLANNED"),description:e.description,type:e.type,remarkNote:e.remarkNote||e.remark_note,timeSlot:e.timeSlot||e.time_slot,passScore:e.passScore||e.pass_score,isSIM:e.isSIM||e.is_sim,courseId:e.courseId||e.course_id,course:e.course,createdBy:e.createdBy||e.created_by,updatedBy:e.updatedBy||e.updated_by,instructorCount:e.instructorCount||e.instructor_count||0,source:"api_data"}),gie=e=>e.map(xie),vie=e=>{if(!e&&e!==0)return"N/A";if(e<1){const t=Math.round(e*24);return t===0?"< 1 hour":t===1?"1 hour":`${t} hours`}return e===1?"1 day":e<7?`${e} days`:e===7?"1 week":e<14?`${Math.round(e/7)} weeks`:e===14?"2 weeks":`${Math.round(e/7)} weeks`},I2=e=>{if(!e)return"N/A";try{return new Date(e).toISOString().split("T")[0]}catch{return"Invalid Date"}},bie=e=>{switch(e?.toUpperCase()){case"ACTIVE":case"ON-GOING":case"ONGOING":return"success";case"PLANNED":return"info";case"COMPLETED":return"primary";case"ARCHIVED":case"INACTIVE":return"secondary";default:return"secondary"}},yie=e=>{switch(e?.toUpperCase()){case"CLASSROOM":return"info";case"E_LEARNING":case"E-LEARNING":case"ELEARNING":return"primary";case"ERO":return"warning";case"PRACTICAL":return"warning";case"MIXED":return"primary";default:return"secondary"}},wie=({subjects:e=[],loading:t=!1,onView:r,onEdit:s,onDelete:n})=>{const i=gie(e),{sortedData:o,sortConfig:l,handleSort:c}=Zt(i);if(t)return a.jsx(Wt,{rows:4,columns:5});if(i.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No subjects found"}),a.jsx("p",{children:"This course doesn't have any subjects yet."})]})});const d=({columnKey:u,children:m,className:f=""})=>{const h=l.key===u,p=h?l.direction:null;return a.jsxs("th",{className:`fw-semibold text-start ${f}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",minWidth:"80px",maxWidth:"150px",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>c(u),onMouseEnter:x=>{x.target.style.backgroundColor="#214760",x.target.style.transform="translateY(-1px)",x.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:x=>{x.target.style.backgroundColor="var(--bs-primary)",x.target.style.transform="translateY(0)",x.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"},children:m}),a.jsx("div",{className:"d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center",flexShrink:0},children:a.jsx(ir,{direction:p,size:14,color:"white"})})]}),h&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx("div",{className:"department-table-container subject-table-scroll",style:{overflowX:"hidden"},children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{tableLayout:"fixed",width:"100%"},children:[a.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:a.jsxs("tr",{children:[a.jsx(d,{columnKey:"name",className:"show-mobile",children:"Name"}),a.jsx(d,{columnKey:"code",className:"show-mobile",children:"Code"}),a.jsx(d,{columnKey:"method",className:"show-mobile",children:"Method"}),a.jsx(d,{columnKey:"duration",className:"show-mobile",children:"Duration"}),a.jsx(d,{columnKey:"startDate",className:"show-mobile",children:"Start Date"}),a.jsx(d,{columnKey:"endDate",className:"show-mobile",children:"End Date"}),a.jsx(d,{columnKey:"roomName",className:"show-mobile",children:"Room Name"}),a.jsx(d,{columnKey:"trainees",className:"show-mobile",children:"Trainees"}),a.jsx(d,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-bold letter-spacing px-3 py-3 text-center show-mobile",style:{minWidth:"80px",maxWidth:"150px",textTransform:"uppercase",letterSpacing:"0.5px"},children:a.jsx("div",{className:"d-flex align-items-center justify-content-center position-relative w-100",children:a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"Actions"})})})]})}),a.jsx("tbody",{children:o.map(u=>a.jsxs("tr",{children:[a.jsx("td",{className:"show-mobile",children:a.jsx("div",{className:"fw-semibold text-primary-custom cursor-pointer",onClick:()=>r&&r(u.id),style:{cursor:"pointer"},children:u.name})}),a.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:a.jsx(Pe,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:u.code,children:u.code})}),a.jsx("td",{className:"show-mobile",style:{maxWidth:"120px",overflow:"hidden"},children:a.jsx(Pe,{bg:yie(u.method),className:"px-2 py-1",style:{fontSize:"0.75rem",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},title:u.method,children:u.method})}),a.jsx("td",{className:"show-mobile",children:a.jsx("span",{className:"text-dark",children:u.duration})}),a.jsx("td",{className:"show-mobile",children:a.jsx("span",{className:"text-dark",children:u.startDate})}),a.jsx("td",{className:"show-mobile",children:a.jsx("span",{className:"text-dark",children:u.endDate})}),a.jsx("td",{className:"show-mobile",children:a.jsx("span",{className:"text-dark",children:u.roomName})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ar,{size:14,className:"me-1 text-muted"}),a.jsx("span",{className:"text-dark",children:u.trainees||0})]})}),a.jsx("td",{className:"show-mobile",children:a.jsxs(Pe,{bg:bie(u.status),className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx("span",{className:"me-1",style:{fontSize:"0.8rem"},children:u.status==="ACTIVE"||u.status==="ON-GOING"||u.status==="ONGOING"?"":""}),u.status||"N/A"]})}),a.jsx("td",{className:"text-center show-mobile",children:a.jsx(pie,{subject:u,onView:r,onEdit:s,onDelete:n})})]},u.id))})]})})},jie=({trainee:e,onViewSubjects:t,onRemoveTrainee:r})=>a.jsx(wr,{permissions:[Ne.SUBJECTS.VIEW_DETAIL,Ne.SUBJECTS.DELETE],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Subject List",icon:a.jsx(Nt,{}),onClick:()=>t(e),permission:Ne.SUBJECTS.VIEW_DETAIL},{type:"divider"},{label:"Remove Trainee",icon:a.jsx(Mi,{}),className:"text-danger",onClick:()=>r(e.id),permission:Ne.SUBJECTS.DELETE}]})}),Nie=({show:e,onClose:t,onConfirm:r,trainee:s,subjectName:n=null,loading:i=!1})=>{const o=!n,l=o?"Remove Trainee from All Subjects":"Remove Trainee from Subject",c=o?"Remove from All Subjects":"Remove from Subject",d=()=>{r(),t()};return a.jsxs(ue,{show:e,onHide:t,centered:!0,children:[a.jsx(ue.Header,{className:"bg-danger text-white border-0",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(yr,{className:"me-2",size:20}),l]})}),a.jsxs(ue.Body,{className:"p-4",children:[a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"mb-3",children:["Are you sure you want to remove ",a.jsxs("strong",{children:['"',s?.name,'"']}),o?" from ALL subjects":` from "${n}"`,"?"]}),a.jsxs("div",{className:"bg-light p-3 rounded mb-3",children:[a.jsx("strong",{children:"Trainee:"})," ",s?.name,a.jsx("br",{}),a.jsx("strong",{children:"EID:"})," ",s?.eid,!o&&a.jsxs(a.Fragment,{children:[a.jsx("br",{}),a.jsx("strong",{children:"Subject:"})," ",n]})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-danger mb-2",children:[a.jsx("strong",{children:"Warning:"})," This action will:"]}),a.jsxs("ul",{className:"text-danger mb-3",children:[o?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Remove the trainee from all enrolled subjects"}),a.jsx("li",{children:"Cancel all ongoing training sessions for this trainee"}),a.jsx("li",{children:"Remove the trainee from the course completely"})]}):a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Remove the trainee from this specific subject only"}),a.jsx("li",{children:"Cancel any ongoing training sessions for this subject"}),a.jsx("li",{children:"Keep the trainee enrolled in other subjects"})]}),a.jsx("li",{children:a.jsx("strong",{children:"Cannot be undone"})})]})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsx(se,{variant:"outline-secondary",onClick:t,disabled:i,children:"Cancel"}),a.jsx(se,{variant:"danger",onClick:d,disabled:i,children:i?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Removing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Mi,{className:"me-2",size:16}),c]})})]})]})},Sie=({courseId:e,loading:t=!1,title:r="Enrolled Trainees"})=>{const[s,n]=b.useState([]),[i,o]=b.useState(!0),[l,c]=b.useState(!1),[d,u]=b.useState(null),[m,f]=b.useState(!1),[h,p]=b.useState(null),[x,g]=b.useState(null),[v,w]=b.useState(!1),{sortedData:y,sortConfig:S,handleSort:E}=Zt(s),N=b.useCallback(async()=>{o(!0);try{const I=await Al.getTraineesForEnrollment();if(!I||!I.data||!I.data.users||!Array.isArray(I.data.users)){n([]);return}const _=[];for(const D of I.data.users)try{const W=await Ds.getTraineeEnrollments(D.id);if(W&&W.enrollments&&W.enrollments.length>0){const K=W.enrollments.filter(J=>J.enrollment?.status==="ENROLLED");if(K.length>0){const J=K.map(le=>le.subject.id),F={id:D.id,eid:D.eid,name:`${D.firstName} ${D.lastName}`.trim(),subjects:J,userId:D.id,email:D.email,department:D.department};_.push(F)}}}catch{}n(_)}catch{n([])}finally{o(!1)}},[]);b.useEffect(()=>{e&&N()},[e,N]);const j=async I=>{try{const _=await Ds.getTraineeEnrollments(I.userId),D=_.enrollments?.filter(K=>K.enrollment?.status==="ENROLLED")||[],W={...I,enrollmentDetails:_,subjects:D.map(K=>({id:K.subject.id,name:K.subject.name,code:K.subject.code,status:K.subject.status,type:K.subject.type,method:K.subject.method,startDate:K.subject.startDate,endDate:K.subject.endDate,course:K.subject.course,enrollment:K.enrollment}))};u(W),c(!0)}catch{u(I),c(!0)}},T=I=>{const _=s.find(D=>D.id===I);_&&(p(_),g(null),f(!0))},C=async()=>{if(h){w(!0);try{const I=await Ds.getTraineeEnrollments(h.userId);if(I&&I.enrollments&&I.enrollments.length>0){const D=I.enrollments.map(async W=>{const K=W.subject.id,J=W.enrollment?.batchCode||"TEST0012025";return W.enrollment?.status!=="ENROLLED"?null:cs.removeTraineeFromSubject(K,h.userId,J)}).filter(W=>W!==null);D.length>0&&await Promise.all(D),await N(),ce.success(`Successfully removed ${h.name} from all subjects`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1)}else ce.warning(`No enrollments found for ${h.name}`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1)}catch(I){const _=I?.response?.data?.message||I?.message||"Failed to remove trainee from subjects";ce.error(`Error: ${_}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{w(!1)}}},L=(I,_)=>{const D=s.find(J=>J.id===I);if(!D)return;const W=d?.subjects?.find(J=>J.id===_),K=W?W.name:"Unknown Subject";p(D),g(K),f(!0)},A=async()=>{if(!h||!x)return;const I=d?.subjects?.find(_=>_.name===x);if(!I){ce.error("Subject not found",{autoClose:3e3,position:"top-right",icon:!1});return}w(!0);try{const _=I.enrollment?.batchCode||"TEST0012025";if(I.enrollment?.status!=="ENROLLED"){ce.warning(`Cannot remove trainee from ${x}. Enrollment status is not ENROLLED.`,{autoClose:4e3,position:"top-right",icon:!1}),w(!1);return}await cs.removeTraineeFromSubject(I.id,h.userId,_),await N(),ce.success(`Successfully removed ${h.name} from ${x}`,{autoClose:3e3,position:"top-right",icon:!1}),f(!1),c(!1)}catch(_){const D=_?.response?.data?.message||_?.message||"Failed to remove trainee from subject";ce.error(`Error: ${D}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{w(!1)}};if(t||i)return a.jsx(M,{style:{width:"100%"},children:a.jsx(M.Body,{className:"p-0",children:a.jsx(Wt,{rows:4,columns:4})})});if(s.length===0)return a.jsx(M,{style:{width:"100%"},children:a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No enrolled trainees"}),a.jsx("p",{children:"No trainees have been enrolled in any subjects yet."})]})})})});const P=({columnKey:I,children:_,className:D=""})=>{const W=S.key===I,K=W?S.direction:null;return a.jsxs("th",{className:`fw-semibold ${D}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>E(I),onMouseEnter:J=>{J.target.style.backgroundColor="#214760",J.target.style.transform="translateY(-1px)",J.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:J=>{J.target.style.backgroundColor="var(--bs-primary)",J.target.style.transform="translateY(0)",J.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:W?"700":"600",color:"white"},children:_}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:K,size:14,color:"white"})})]}),W&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs(a.Fragment,{children:[a.jsx(M,{className:"d-flex flex-column",style:{height:"400px",width:"100%"},children:a.jsx(M.Body,{className:"p-0",style:{flex:1,minHeight:0,overflow:"hidden"},children:a.jsx("div",{style:{height:"100%",overflowY:"auto"},children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",children:[a.jsx("thead",{className:"sticky-header bg-gradient-primary-custom",children:a.jsxs("tr",{children:[a.jsx(P,{columnKey:"name",className:"show-mobile",children:"Trainee"}),a.jsx(P,{columnKey:"eid",className:"show-mobile",children:"EID"}),a.jsx(P,{columnKey:"subjects",className:"show-mobile",children:"Total Subject"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:y.map(I=>a.jsxs("tr",{children:[a.jsx("td",{className:"show-mobile",children:a.jsx("div",{className:"fw-semibold text-primary-custom",children:I.name})}),a.jsx("td",{className:"show-mobile",children:a.jsx(Pe,{bg:"secondary",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:I.eid})}),a.jsx("td",{className:"show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ar,{size:14,className:"me-1 text-muted"}),a.jsxs(Pe,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",width:"fit-content"},children:[I.subjects.length," subjects"]})]})}),a.jsx("td",{className:"text-center show-mobile",children:a.jsx(jie,{trainee:I,onViewSubjects:j,onRemoveTrainee:T})})]},I.id))})]})})})}),a.jsxs(ue,{show:l,onHide:()=>c(!1),size:"lg",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-gradient-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center text-white",children:[a.jsx(Ar,{className:"me-2",size:20}),d?.name," - Enrolled Subjects"]}),a.jsx(se,{variant:"link",onClick:()=>c(!1),className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsx(ue.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:d&&a.jsxs("div",{children:[a.jsx("div",{className:"mb-4 p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:a.jsxs("div",{className:"row align-items-center",children:[a.jsxs("div",{className:"col-md-6",children:[a.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:"Trainee Information"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Pe,{bg:"primary-custom",className:"me-2 text-white",children:"EID"}),a.jsx("span",{className:"fw-semibold text-primary-custom",children:d.eid})]})]}),a.jsx("div",{className:"col-md-6 text-md-end",children:a.jsx("div",{className:"text-primary-custom small",children:a.jsxs("div",{children:["Total Subjects: ",a.jsx(Pe,{bg:"primary-custom",className:"text-white",children:d.subjects.length})]})})})]})}),a.jsx("div",{className:"row g-3",children:d.subjects.map(I=>a.jsx("div",{className:"col-12",children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsx(M.Body,{className:"p-3",children:a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-md-8",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 text-primary-custom fw-bold",children:I.name}),a.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[a.jsx(Pe,{bg:"primary-custom",className:"text-white",children:I.code}),a.jsx(Pe,{bg:I.status==="ACTIVE"?"success":"primary-custom",className:I.status==="ACTIVE"?"":"text-white",children:I.status})]})]}),a.jsx(se,{size:"sm",variant:"outline-danger",className:"ms-2",onClick:()=>{L(d.id,I.id)},children:a.jsx(Ze,{size:14})})]}),a.jsxs("div",{className:"row g-2 mb-3",children:[a.jsx("div",{className:"col-sm-6",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Type:"}),a.jsx(Pe,{bg:"primary-custom",className:"text-white",children:I.type})]})}),a.jsx("div",{className:"col-sm-6",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Method:"}),a.jsx(Pe,{bg:"primary-custom",className:"text-white",children:I.method})]})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("span",{className:"text-primary-custom small me-2 fw-semibold",children:"Course:"}),a.jsx("span",{className:"fw-medium text-primary-custom",children:I.course?.name})]})]}),I.enrollment&&a.jsx("div",{className:"col-md-4",children:a.jsxs("div",{className:"p-3 bg-primary bg-opacity-10 rounded border-start border-primary border-3",children:[a.jsx("h6",{className:"text-primary-custom mb-2 fw-bold",children:"Enrollment Details"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Status:"}),a.jsx(Pe,{bg:"primary-custom",className:"text-white",children:I.enrollment.status})]}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Batch:"}),a.jsx("span",{className:"fw-medium small text-primary-custom",children:I.enrollment.batchCode})]}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{className:"text-primary-custom small fw-semibold",children:"Enrolled:"}),a.jsx("span",{className:"fw-medium small text-primary-custom",children:new Date(I.enrollment.enrollmentDate).toLocaleDateString()})]})]})]})})]})})})},I.id))})]})}),a.jsx(ue.Footer,{className:"border-top",children:a.jsx(se,{variant:"primary-custom",className:"text-white",onClick:()=>c(!1),children:"Close"})})]}),a.jsx(Nie,{show:m,onClose:()=>{f(!1),p(null),g(null),w(!1)},onConfirm:x?A:C,trainee:h,subjectName:x,loading:v})]})},Eie=({show:e,onClose:t,onSave:r,loading:s=!1,courseId:n})=>{const[i,o]=b.useState({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),[l,c]=b.useState([]),[d,u]=b.useState(!1);b.useEffect(()=>{e&&n&&(o({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]))},[e,n]);const m=x=>{const{name:g,value:v,type:w,checked:y}=x.target;o(S=>({...S,[g]:w==="checkbox"?y:v}))},f=()=>{const x=[];return n||x.push("Course ID is required"),i.name.trim()||x.push("Subject name is required"),i.code.trim()||x.push("Subject code is required"),i.duration.trim()&&(isNaN(i.duration)||parseInt(i.duration)<=0)&&x.push("Duration must be a positive number"),i.passScore.trim()&&(isNaN(i.passScore)||parseFloat(i.passScore)<0||parseFloat(i.passScore)>100)&&x.push("Pass score must be between 0 and 100"),i.startDate.trim()||x.push("Start date is required"),i.endDate.trim()||x.push("End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&x.push("End date must be after start date"),c(x),x.length===0},h=async x=>{if(x.preventDefault(),!!f()){u(!0);try{const g={courseId:n,name:i.name.trim(),code:i.code.trim(),description:i.description.trim()||null,method:i.method,duration:i.duration.trim()?parseInt(i.duration):null,type:i.type,roomName:i.roomName.trim()||null,remarkNote:i.remarkNote.trim()||null,timeSlot:i.timeSlot.trim()||null,isSIM:i.isSIM,passScore:i.passScore.trim()?parseFloat(i.passScore):null,startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString()},v=await Ie.post("/subjects",g);ce.success("Subject created successfully!"),r&&await r(v.data||g),p()}catch(g){const v=g.response?.data?.message||g.message||"Failed to create subject";ce.error(`Error: ${v}`),c([v])}finally{u(!1)}}},p=()=>{o({name:"",code:"",description:"",method:"CLASSROOM",duration:"",type:"UNLIMIT",roomName:"",remarkNote:"",timeSlot:"",isSIM:!1,passScore:"",startDate:"",endDate:""}),c([]),u(!1),t()};return a.jsxs(ue,{show:e,onHide:p,size:"lg",centered:!0,style:{maxHeight:"90vh"},children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Cs,{className:"me-2",size:20}),"Add New Subject"]}),a.jsx(se,{variant:"link",onClick:p,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto",overflowX:"hidden"},children:[l.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:l.map((x,g)=>a.jsx("li",{children:x},g))})}),a.jsxs(k,{onSubmit:h,children:[a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Subject Name *"}),a.jsx(k.Control,{type:"text",name:"name",value:i.name,onChange:m,placeholder:"Enter subject name",required:!0})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Subject Code *"}),a.jsx(k.Control,{type:"text",name:"code",value:i.code,onChange:m,placeholder:"Enter subject code",required:!0})]})})]}),a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Description"}),a.jsx(k.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,placeholder:"Enter subject description"})]}),a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Method *"}),a.jsxs(k.Select,{name:"method",value:i.method,onChange:m,required:!0,children:[a.jsx("option",{value:"CLASSROOM",children:"CLASSROOM"}),a.jsx("option",{value:"E_LEARNING",children:"E_LEARNING"}),a.jsx("option",{value:"ERO",children:"ERO"})]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Duration (days)"}),a.jsx(k.Control,{type:"number",name:"duration",value:i.duration,onChange:m,placeholder:"Enter duration in days",min:"1"})]})})]}),a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Type *"}),a.jsxs(k.Select,{name:"type",value:i.type,onChange:m,required:!0,children:[a.jsx("option",{value:"UNLIMIT",children:"UNLIMIT"}),a.jsx("option",{value:"RECURRENT",children:"RECURRENT"})]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Room Name"}),a.jsx(k.Control,{type:"text",name:"roomName",value:i.roomName,onChange:m,placeholder:"Enter room name"})]})})]}),a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Time Slot"}),a.jsx(k.Control,{type:"text",name:"timeSlot",value:i.timeSlot,onChange:m,placeholder:"e.g., 09:00-11:00"})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Pass Score"}),a.jsx(k.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,placeholder:"Enter pass score (0-100)",min:"0",max:"100",step:"0.01"})]})})]}),a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Start Date *"}),a.jsx(k.Control,{type:"datetime-local",name:"startDate",value:i.startDate,onChange:m,required:!0})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"End Date *"}),a.jsx(k.Control,{type:"datetime-local",name:"endDate",value:i.endDate,onChange:m,required:!0})]})})]}),a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Remark Note"}),a.jsx(k.Control,{as:"textarea",rows:2,name:"remarkNote",value:i.remarkNote,onChange:m,placeholder:"Enter remark note"})]}),a.jsx(k.Group,{className:"mb-3",children:a.jsx(k.Check,{type:"checkbox",name:"isSIM",checked:i.isSIM,onChange:m,label:"Is Simulator"})})]})]}),a.jsxs(ue.Footer,{className:"border-0",children:[a.jsx(se,{variant:"secondary",onClick:p,children:"Cancel"}),a.jsx(se,{variant:"primary",onClick:h,disabled:d,children:d?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"16px",height:"16px"}}),"Creating..."]}):"Create Subject"})]})]})},Tie=({show:e,onClose:t,onImport:r,loading:s=!1,courseId:n})=>{const[i,o]=b.useState(!1),[l,c]=b.useState(null),[d,u]=b.useState([]),[m,f]=b.useState([]),[h,p]=b.useState([]),x=b.useRef(null),g=["code","name","course_id"],v=["code","name","course_id","description","method","duration","type","room_name","remark_note","time_slot","pass_score","start_date","end_date","is_sim"],w=A=>{A.preventDefault(),A.stopPropagation(),A.type==="dragenter"||A.type==="dragover"?o(!0):A.type==="dragleave"&&o(!1)},y=A=>{A.preventDefault(),A.stopPropagation(),o(!1),A.dataTransfer.files&&A.dataTransfer.files[0]&&E(A.dataTransfer.files[0])},S=A=>{A.target.files&&A.target.files[0]&&E(A.target.files[0])},E=A=>{if(!A.name.match(/\.(xlsx|xls)$/)){f(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(A.size>100*1024*1024){f(["File size must be less than 100MB"]);return}c(A),f([]),N(A)},N=A=>{const P=new FileReader;P.onload=I=>{try{const _=new Uint8Array(I.target.result),D=Ul(_,{type:"array"}),W=D.SheetNames[0],K=D.Sheets[W],J=fa.sheet_to_json(K,{header:1});if(J.length<2){f(["Excel file must contain at least a header row and one data row"]);return}const F=J[0].map(U=>U?.toString().toLowerCase().trim()),le=J.slice(1),O=(n?g.filter(U=>U!=="course_id"):g).filter(U=>!F.includes(U));if(O.length>0){f([`Missing required columns: ${O.join(", ")}`]);return}const G=le.map((U,B)=>{const Y=F.includes("course_id")?U[F.indexOf("course_id")]?.toString().trim()||"":n||"",te={id:`temp_${B}`,rowNumber:B+2,code:U[F.indexOf("code")]?.toString().trim()||"",name:U[F.indexOf("name")]?.toString().trim()||"",course_id:Y,description:U[F.indexOf("description")]?.toString().trim()||"",method:U[F.indexOf("method")]?.toString().trim()||"THEORY",duration:U[F.indexOf("duration")]?.toString().trim()||"",type:U[F.indexOf("type")]?.toString().trim()||"MANDATORY",room_name:U[F.indexOf("room_name")]?.toString().trim()||"",remark_note:U[F.indexOf("remark_note")]?.toString().trim()||"",time_slot:U[F.indexOf("time_slot")]?.toString().trim()||"",pass_score:U[F.indexOf("pass_score")]?.toString().trim()||"",start_date:(()=>{const ae=U[F.indexOf("start_date")];return ae?ae instanceof Date?ae.toISOString().split("T")[0]:typeof ae=="number"?ae:String(ae).trim():""})(),end_date:(()=>{const ae=U[F.indexOf("end_date")];return ae?ae instanceof Date?ae.toISOString().split("T")[0]:typeof ae=="number"?ae:String(ae).trim():""})(),is_sim:F.includes("is_sim")||F.includes("issim")?U[F.indexOf(F.includes("is_sim")?"is_sim":"issim")]:void 0,hasError:!1,errors:[]};if(te.code||(te.hasError=!0,te.errors.push("Subject code is required")),te.name||(te.hasError=!0,te.errors.push("Subject name is required")),!te.course_id&&!n?(te.hasError=!0,te.errors.push("Course ID is required (either in file or must be importing from course detail page)")):te.course_id&&(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(te.course_id)||(te.hasError=!0,te.errors.push("Course ID must be a valid UUID format"))),te.duration&&(isNaN(te.duration)||parseInt(te.duration)<=0)&&(te.hasError=!0,te.errors.push("Duration must be a positive number")),te.pass_score&&(isNaN(te.pass_score)||parseFloat(te.pass_score)<0||parseFloat(te.pass_score)>100)&&(te.hasError=!0,te.errors.push("Pass score must be between 0 and 100")),te.method){let ae=te.method.toUpperCase().trim();ae==="E-LEARNING"||ae==="E LEARNING"||ae==="ELEARNING"?ae="E_LEARNING":ae==="CLASSROOM"||ae==="CLASS ROOM"||ae==="CLASS-ROOM"?ae="CLASSROOM":ae==="ERO"&&(ae="ERO"),te.method=ae,["E_LEARNING","CLASSROOM","ERO"].includes(ae)||(te.hasError=!0,te.errors.push("Method must be E_LEARNING, CLASSROOM, or ERO"))}if(te.type&&!["UNLIMIT","RECURRENT"].includes(te.type.toUpperCase())&&(te.hasError=!0,te.errors.push("Type must be UNLIMIT or RECURRENT")),te.start_date)try{let ae;if(typeof te.start_date=="number"&&te.start_date>1e4){const ne=parseFloat(te.start_date);ae=new Date((ne-25569)*86400*1e3)}else{const ne=String(te.start_date).trim();ae=new Date(ne)}isNaN(ae.getTime())&&(te.hasError=!0,te.errors.push("Start date must be a valid date"))}catch{te.hasError=!0,te.errors.push("Start date must be a valid date")}if(te.end_date)try{let ae;if(typeof te.end_date=="number"&&te.end_date>1e4){const ne=parseFloat(te.end_date);ae=new Date((ne-25569)*86400*1e3)}else{const ne=String(te.end_date).trim();ae=new Date(ne)}isNaN(ae.getTime())&&(te.hasError=!0,te.errors.push("End date must be a valid date"))}catch{te.hasError=!0,te.errors.push("End date must be a valid date")}return te}).filter(U=>U.code||U.name);u(G),p([])}catch{f(["Failed to parse Excel file. Please check the file format."])}},P.readAsArrayBuffer(A)},j=async()=>{const A=d.filter(I=>!I.hasError);if(A.length===0){f(["No valid subjects to import"]);return}if(!n&&A.filter(_=>!_.course_id).length>0){f(["Course ID is required. Please ensure courseId is provided when importing from Course Detail page, or include course_id column in your Excel file."]);return}const P=A.map(I=>{let _=!1;const D=I.is_sim!==void 0?I.is_sim:void 0;if(D!=null&&D!=="")if(typeof D=="string"){const le=D.toLowerCase().trim();_=["true","1","yes","y"].includes(le)}else typeof D=="boolean"?_=D:typeof D=="number"&&(_=D!==0);const W=le=>{if(!le||le===""||le==="N/A")return null;try{let Ae;if(typeof le=="string"){const G=le.trim();if(/^\d+$/.test(G)){const U=parseInt(G);if(U>=1&&U<=1e5){const te=(U-25569)*86400*1e3;Ae=new Date(te);const ae=Ae.getFullYear();(ae<1900||ae>2100)&&(Ae=new Date(G))}else Ae=new Date(U<1e12?U*1e3:U)}else{if(G.includes("T")&&G.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/))return G;G.match(/^\d{4}-\d{2}-\d{2}$/)?Ae=new Date(G+"T00:00:00.000Z"):Ae=new Date(G)}}else typeof le=="number"?le>=1&&le<=1e5?Ae=new Date((le-25569)*86400*1e3):le>1e5&&le<1e12?Ae=new Date(le*1e3):Ae=new Date(le):Ae=new Date(le);if(isNaN(Ae.getTime()))return null;const O=Ae.getFullYear();return O<1900||O>2100?null:Ae.toISOString()}catch{return null}},K=W(I.start_date),J=W(I.end_date),F={code:I.code,name:I.name,courseId:String(n||I.course_id),description:I.description||"",method:I.method?I.method.toUpperCase():"CLASSROOM",duration:I.duration?parseInt(I.duration):1,type:I.type?I.type.toUpperCase():"UNLIMIT",roomName:I.room_name||"",remarkNote:I.remark_note||"",timeSlot:I.time_slot||"",passScore:I.pass_score?parseFloat(I.pass_score):70,isSIM:_};return K&&(F.startDate=K),J&&(F.endDate=J),F});try{const I=await r(P);let _=I;I&&I.data&&typeof I.data=="object"&&(_=I.data);const D=_?.summary?.created??_?.createdSubjects?.length??_?.summary?.createdCount??_?.subjects?.length??0,W=_?.summary?.failed??_?.failedSubjects?.length??_?.summary?.failedCount??0,K=_?.summary?.skipped??_?.skippedSubjects?.length??_?.summary?.skippedCount??0,J=_?.summary?.total??P.length;if(!(_?.summary||_?.createdSubjects!==void 0||_?.failedSubjects!==void 0)&&I!==null&&I!==void 0&&!I?.error&&!I?.message?.toLowerCase().includes("fail")){ce.success(`Imported ${J}/${J} subjects successfully.`,{icon:!1}),T();return}const Ae=(!_||D===0&&W===0&&K===0&&J===0)&&!I?.error&&_?.message?.toLowerCase().includes("exist");_?.failedSubjects&&Array.isArray(_.failedSubjects)&&_.failedSubjects.length>0&&_.failedSubjects.forEach(O=>{const G=O.subject?.name||"Unknown Subject",U=O.subject?.code||"N/A",B=O.error||"Unknown error";ce.error(`${G} (${U}): ${B}`,{autoClose:6e3,position:"top-right",icon:!1})}),Ae||K>0?K>0?ce.info(`${K} subject(s) already exist and were skipped. ${D>0?`${D} new subject(s) were imported.`:""}`,{icon:!1}):ce.info("All subjects already exist. No new subjects were imported.",{icon:!1}):D>0&&W===0?ce.success(`Imported ${D}/${J} subjects successfully.`,{icon:!1}):D>0&&W>0?ce.warn(`Imported ${D}/${J}. ${W} failed.`,{icon:!1}):D===0&&W>0?ce.error(`All ${W}/${J} subjects failed to import.`,{icon:!1}):ce.success(`Imported ${J}/${J} subjects successfully.`,{icon:!1}),T()}catch(I){I?.response?.status===304?(ce.info("All subjects already exist. No new subjects were imported.",{icon:!1}),T()):(ce.error(I?.response?.data?.message||I.message||"Failed to import subjects.",{icon:!1}),f([I?.response?.data?.message||I.message||"Failed to import subjects. Please try again."]))}},T=()=>{c(null),u([]),f([]),p([]),o(!1),t()},C=A=>A==="valid"?a.jsx(lt,{className:"text-success",size:16}):a.jsx(Ks,{className:"text-danger",size:16}),L=()=>{const A=[v,["MATH101","Mathematics",n||"550e8400-e29b-41d4-a716-446655440000","Basic mathematics course covering algebra and geometry","CLASSROOM","14","UNLIMIT","Room A101","This is a required course for all students","09:00-17:00","70.0","2025-01-15 09:00:00","2025-01-29 17:00:00"],["PHYS101","Physics",n||"550e8400-e29b-41d4-a716-446655440000","Introduction to physics concepts and principles","E_LEARNING","7","RECURRENT","Lab B201","Hands-on experiments and demonstrations","14:00-18:00","75.0","2025-02-01 14:00:00","2025-02-08 18:00:00"],["SAFETY301","Safety Procedures",n||"550e8400-e29b-41d4-a716-446655440000","Emergency response and safety protocols training","ERO","5","UNLIMIT","Training Hall B","Hands-on practical training required","08:00-16:00","80.0","2025-03-01 08:00:00","2025-03-06 16:00:00"]],P=fa.aoa_to_sheet(A),I=fa.book_new();fa.book_append_sheet(I,P,"Subjects"),eg(I,"Subject_Upload_Template.xlsx")};return a.jsxs(ue,{show:e,onHide:T,size:"xl",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Ts,{className:"me-2",size:20}),"Bulk Import Subjects"]}),a.jsx(se,{variant:"link",onClick:T,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[m.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:m.map((A,P)=>a.jsx("li",{children:A},P))})}),a.jsx(M,{className:"mb-4",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:`upload-area ${i?"drag-active":""}`,onDragEnter:w,onDragLeave:w,onDragOver:w,onDrop:y,onClick:()=>x.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:i?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[a.jsx(fo,{size:48,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),a.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),a.jsx("input",{ref:x,type:"file",accept:".xlsx,.xls",onChange:S,style:{display:"none"}})]}),a.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Required columns:"})," Code, Name",!n&&a.jsx("span",{children:", Course ID (UUID format)"})]}),a.jsx("br",{}),a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Optional columns:"})," Description, Method (E_LEARNING|CLASSROOM|ERO), Duration, Type (UNLIMIT|RECURRENT), Room Name, Remark Note, Time Slot, Pass Score, Start Date, End Date"]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:L,className:"d-flex align-items-center",children:[a.jsx(Fi,{className:"me-1",size:14}),"Download Template"]}),l&&a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(fo,{className:"text-success me-2",size:16}),a.jsx("span",{className:"text-success fw-semibold",children:l.name})]})]})]})]})}),d.length>0&&a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsxs("h6",{className:"mb-0",children:["Preview Data (",d.length," records)"]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:a.jsxs(It,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"1600px"},children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{style:{minWidth:"50px"},children:"NO."}),a.jsx("th",{style:{minWidth:"120px"},children:"CODE"}),a.jsx("th",{style:{minWidth:"200px"},children:"NAME"}),a.jsx("th",{style:{minWidth:"200px"},children:"COURSE ID"}),a.jsx("th",{style:{minWidth:"150px"},children:"METHOD"}),a.jsx("th",{style:{minWidth:"100px"},children:"DURATION"}),a.jsx("th",{style:{minWidth:"120px"},children:"TYPE"}),a.jsx("th",{style:{minWidth:"100px"},children:"PASS SCORE"}),a.jsx("th",{style:{minWidth:"150px"},children:"DESCRIPTION"}),a.jsx("th",{style:{minWidth:"150px"},children:"ROOM NAME"}),a.jsx("th",{style:{minWidth:"150px"},children:"TIME SLOT"}),a.jsx("th",{style:{minWidth:"150px"},children:"START DATE"}),a.jsx("th",{style:{minWidth:"150px"},children:"END DATE"}),a.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),a.jsx("th",{style:{minWidth:"200px"},children:"ERROR ENCOUNTERED"}),a.jsx("th",{style:{minWidth:"80px"},children:"ACTION"})]})}),a.jsx("tbody",{children:d.map((A,P)=>a.jsxs("tr",{className:A.hasError?"table-danger":"",children:[a.jsx("td",{children:A.rowNumber||P+1}),a.jsx("td",{children:A.code||"-"}),a.jsx("td",{children:A.name||"-"}),a.jsx("td",{children:A.course_id||"-"}),a.jsx("td",{children:A.method||"-"}),a.jsx("td",{children:A.duration||"-"}),a.jsx("td",{children:A.type||"-"}),a.jsx("td",{children:A.pass_score||"-"}),a.jsx("td",{children:A.description||"-"}),a.jsx("td",{children:A.room_name||"-"}),a.jsx("td",{children:A.time_slot||"-"}),a.jsx("td",{children:A.start_date||"-"}),a.jsx("td",{children:A.end_date||"-"}),a.jsx("td",{className:"text-center",children:C(A.hasError?"invalid":"valid")}),a.jsx("td",{children:A.errors.length>0&&a.jsx("small",{className:"text-danger",children:A.errors.length>1?`${A.errors[0]} (+${A.errors.length-1} more)`:A.errors[0]})}),a.jsx("td",{children:a.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{u(I=>I.filter(_=>_.id!==A.id))},children:a.jsx(Mi,{size:14})})})]},A.id))})]})})})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:T,disabled:s,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),d.length>0&&a.jsx($2,{placement:"top",overlay:a.jsxs(z2,{id:"import-tooltip",children:["Only ",d.filter(A=>!A.hasError).length,"/",d.length," subjects will be imported into DSFMS"]}),children:a.jsx(se,{variant:"primary",onClick:j,disabled:s||d.filter(A=>!A.hasError).length===0,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ts,{className:"me-2",size:16}),"Import All (",d.filter(A=>!A.hasError).length," subjects)"]})})})]})]})},Aie=({show:e,onClose:t,onSave:r,course:s,loading:n=!1})=>{const[i,o]=b.useState({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),[l,c]=b.useState({}),d=p=>{if(!p)return"";if(typeof p=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(p))return p;try{const x=new Date(p);return isNaN(x.getTime())?"":x.toISOString().split("T")[0]}catch{return""}};b.useEffect(()=>{e&&s?o({name:s.name||"",code:s.code||"",description:s.description||"",maxTrainees:s.maxNumTrainee||s.maxTrainees||"",venue:s.venue||"",note:s.note||"",passScore:s.passScore||"",startDate:d(s.startDate),endDate:d(s.endDate),level:s.level||"BEGINNER",status:s.status||"ACTIVE"}):e||(o({name:"",code:"",description:"",maxTrainees:"",venue:"",note:"",passScore:"",startDate:"",endDate:"",level:"Beginner",status:"ACTIVE"}),c({}))},[e,s]);const u=()=>{c({}),t()},m=p=>{const{name:x,value:g}=p.target;o(v=>({...v,[x]:g})),l[x]&&c(v=>({...v,[x]:""}))},f=()=>{const p={};if(i.name.trim()||(p.name="Course name is required"),i.code.trim()||(p.code="Course code is required"),i.description.trim()||(p.description="Description is required"),(!i.maxTrainees||isNaN(i.maxTrainees)||parseInt(i.maxTrainees)<=0)&&(p.maxTrainees="Max trainees must be a positive number"),i.venue.trim()||(p.venue="Venue is required"),(!i.passScore||isNaN(i.passScore)||parseInt(i.passScore)<0||parseInt(i.passScore)>100)&&(p.passScore="Pass score must be between 0 and 100"),!i.startDate)p.startDate="Start date is required";else{const x=new Date;x.setHours(0,0,0,0),new Date(i.startDate)<x&&(p.startDate="Start date cannot be in the past")}return i.endDate||(p.endDate="End date is required"),i.startDate&&i.endDate&&new Date(i.startDate)>=new Date(i.endDate)&&(p.endDate="End date must be after start date"),c(p),Object.keys(p).length===0},h=async p=>{if(p.preventDefault(),!!f())try{const x={name:i.name.trim(),description:i.description.trim(),code:i.code.trim(),maxNumTrainee:parseInt(i.maxTrainees),venue:i.venue.trim(),note:i.note.trim(),passScore:parseInt(i.passScore),startDate:new Date(i.startDate).toISOString(),endDate:new Date(i.endDate).toISOString(),level:i.level},g=await Ie.put(`/courses/${s.id}`,x);ce.success("Course updated successfully!"),r&&await r(g.data||x),u()}catch(x){const g=x.response?.data?.message||x.message||"Failed to update course";ce.error(`Error: ${g}`)}};return a.jsxs(ue,{show:e,onHide:u,size:"lg",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(as,{className:"me-2",size:20}),"Edit Course"]}),a.jsx(se,{variant:"link",onClick:u,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(k,{onSubmit:h,children:[a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"70vh",overflowY:"auto"},children:[a.jsxs(oe,{className:"mb-3",children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Course Name *"}),a.jsx(k.Control,{type:"text",name:"name",value:i.name,onChange:m,isInvalid:!!l.name,disabled:n}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.name})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Course Code *"}),a.jsx(k.Control,{type:"text",name:"code",value:i.code,onChange:m,isInvalid:!!l.code,disabled:n}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.code})]})})]}),a.jsxs(oe,{className:"mb-3",children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Max Trainees *"}),a.jsx(k.Control,{type:"number",name:"maxTrainees",value:i.maxTrainees,onChange:m,isInvalid:!!l.maxTrainees,disabled:n,min:"1"}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.maxTrainees})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Pass Score (%) *"}),a.jsx(k.Control,{type:"number",name:"passScore",value:i.passScore,onChange:m,isInvalid:!!l.passScore,disabled:n,min:"0",max:"100"}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.passScore})]})})]}),a.jsx(oe,{className:"mb-3",children:a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Level"}),a.jsxs(k.Select,{name:"level",value:i.level,onChange:m,disabled:n,children:[a.jsx("option",{value:"BEGINNER",children:"Beginner"}),a.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),a.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]})})}),a.jsxs(oe,{className:"mb-3",children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Start Date *"}),a.jsx(k.Control,{type:"date",name:"startDate",value:i.startDate,onChange:m,isInvalid:!!l.startDate,disabled:n}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.startDate})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"End Date *"}),a.jsx(k.Control,{type:"date",name:"endDate",value:i.endDate,onChange:m,isInvalid:!!l.endDate,disabled:n}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.endDate})]})})]}),a.jsx(oe,{className:"mb-3",children:a.jsx(H,{children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Venue *"}),a.jsx(k.Control,{type:"text",name:"venue",value:i.venue,onChange:m,isInvalid:!!l.venue,disabled:n}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.venue})]})})}),a.jsx(oe,{className:"mb-3",children:a.jsx(H,{children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Description *"}),a.jsx(k.Control,{as:"textarea",rows:3,name:"description",value:i.description,onChange:m,isInvalid:!!l.description,disabled:n}),a.jsx(k.Control.Feedback,{type:"invalid",children:l.description})]})})}),a.jsx(oe,{className:"mb-3",children:a.jsx(H,{children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Note"}),a.jsx(k.Control,{as:"textarea",rows:2,name:"note",value:i.note,onChange:m,disabled:n})]})})})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:u,disabled:n,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:"primary",type:"submit",disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{className:"me-2",size:16}),"Save Changes"]})})]})]})]})},Cie=({course:e,department:t})=>{const r=Qe(),{courseId:s}=Nr(),n=$n(),[i,o]=b.useState(!1),[l,c]=b.useState(!1),[d,u]=b.useState(!1),[m,f]=b.useState(!1),[h,p]=b.useState(null),[x,g]=b.useState(!1),[v,w]=b.useState(null),[y,S]=b.useState([]),[E,N]=b.useState(!0),[j,T]=b.useState(()=>n.state?.activeTab?n.state.activeTab:"course-info");b.useEffect(()=>{n.state?.activeTab&&(T(n.state.activeTab),window.history.replaceState({},document.title))},[n.state]),b.useEffect(()=>{s&&(async()=>{if(s){N(!0);try{const F=await Ds.getCourseById(s);if(!F)throw new Error("Invalid API response");const le={id:F.id||s,name:F.name,code:F.code,description:F.description,maxTrainees:F.maxNumTrainee,maxNumTrainee:F.maxNumTrainee,venue:F.venue,note:F.note,passScore:F.passScore,startDate:F.startDate?new Date(F.startDate).toISOString().split("T")[0]:"",endDate:F.endDate?new Date(F.endDate).toISOString().split("T")[0]:"",level:F.level,status:F.status,department:F.department,subjectCount:F.subjectCount||0,traineeCount:F.traineeCount||0,trainerCount:F.trainerCount||0};w(le),F.subjects&&Array.isArray(F.subjects)?S(F.subjects):F.subjectCount>0&&!F.subjects?S([]):S([]),N(!1)}catch{if(e&&e.id&&e.name){const F={id:e.id,name:e.name,code:e.code||"N/A",description:e.description||"Course information not available.",maxTrainees:e.maxNumTrainee||e.maxTrainees||50,maxNumTrainee:e.maxNumTrainee||e.maxTrainees||50,venue:e.venue||"N/A",note:e.note||"",passScore:e.passScore||80,startDate:e.startDate?typeof e.startDate=="string"?e.startDate.split("T")[0]:new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?typeof e.endDate=="string"?e.endDate.split("T")[0]:new Date(e.endDate).toISOString().split("T")[0]:"",level:e.level||"N/A",status:e.status||"ACTIVE",department:e.department||t,subjectCount:e.subjectCount||0,traineeCount:e.traineeCount||0,trainerCount:e.trainerCount||0};w(F),S([])}else w(null),S([]);N(!1)}}})()},[s,e,t]);const C=()=>{t?.id?r(`/academic/course/${t.id}`):r("/academic/departments")};if(E)return a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})});if(!v)return a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h5",{className:"text-muted",children:"Course not found"}),a.jsx("p",{className:"text-muted",children:"The requested course could not be loaded."}),a.jsxs(se,{variant:"primary",onClick:C,children:[a.jsx(Tt,{className:"me-2"}),"Back to Department"]})]})});const L=J=>{r(`/academic/course/${s}/subject/${J}`)},A=()=>{},P=J=>{const F=y.find(le=>le.id===J);F&&(p(F),f(!0))},I=async()=>{if(h){g(!0);try{await cs.archiveSubject(h.id),ce.success(`Successfully archived subject "${h.name}"`,{autoClose:3e3,position:"top-right",icon:!1});const J=await Ds.getCourseById(s);J.subjects&&Array.isArray(J.subjects)&&S(J.subjects),f(!1),p(null)}catch(J){const F=J?.response?.data?.message||J?.message||"Failed to archive subject";ce.error(`Error: ${F}`,{autoClose:4e3,position:"top-right",icon:!1})}finally{g(!1)}}},_=()=>{r(`/academic/course/${e.id}/enroll-trainees`)},D=async J=>{try{await cs.createSubject({...J,courseId:s});const F=await Ds.getCourseById(s);F.subjects&&Array.isArray(F.subjects)&&S(F.subjects),o(!1)}catch{}},W=async J=>{const F=await cs.bulkImportSubjects(J),le=await Ds.getCourseById(s);return le.subjects&&Array.isArray(le.subjects)&&S(le.subjects),c(!1),F},K=async J=>{try{await Ds.updateCourse(s,J);const F=await Ds.getCourseById(s),le={id:F.id||s,name:F.name,code:F.code,description:F.description,maxTrainees:F.maxNumTrainee,maxNumTrainee:F.maxNumTrainee,venue:F.venue,note:F.note,passScore:F.passScore,startDate:F.startDate?new Date(F.startDate).toISOString().split("T")[0]:"",endDate:F.endDate?new Date(F.endDate).toISOString().split("T")[0]:"",level:F.level,status:F.status,department:F.department,subjectCount:F.subjectCount||0,traineeCount:F.traineeCount||0,trainerCount:F.trainerCount||0,subjects:F.subjects||[]};w(le),u(!1)}catch{}};return a.jsxs(_e,{fluid:!0,className:"py-2 course-detail",children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:C,className:"me-3",children:[a.jsx(Tt,{size:16,className:"me-1"}),"Back"]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"mb-0 text-primary",children:[a.jsx("strong",{children:e.name}),"  ",e.code]}),a.jsx("small",{className:"text-muted",children:"Course Details"})]})]}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("div",{className:"d-flex",children:a.jsxs(se,{size:"sm",variant:"primary",onClick:_,children:[a.jsx(Ar,{size:14,className:"me-1"})," Enroll Trainees"]})}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsxs(se,{size:"sm",variant:"outline-secondary",onClick:()=>u(!0),children:[a.jsx(as,{size:14,className:"me-1"})," Edit Course"]}),a.jsx("div",{className:"vr",style:{height:"24px",margin:"0 8px"}}),a.jsxs(se,{size:"sm",variant:"primary",onClick:()=>o(!0),children:[a.jsx(Cs,{size:14,className:"me-1"})," Add Subject"]}),a.jsxs(se,{size:"sm",variant:"outline-primary",onClick:()=>c(!0),children:[a.jsx(Ts,{size:14,className:"me-1"})," Import Bulk Subjects"]})]})]}),a.jsx(M,{className:"border-0 shadow-sm mb-2",children:a.jsxs(Vt.Container,{activeKey:j,onSelect:T,children:[a.jsx(M.Header,{className:"border-bottom py-2 bg-primary",children:a.jsxs(St,{variant:"tabs",className:"border-0",children:[a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"course-info",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:j==="course-info"?"600":"400",opacity:j==="course-info"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(bt,{className:"me-2",size:16}),"Course Information"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"subjects",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:j==="subjects"?"600":"400",opacity:j==="subjects"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(nr,{className:"me-2",size:16}),"Subjects"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"trainees",className:"d-flex align-items-center",style:{border:"none",backgroundColor:"transparent",color:"#ffffff",fontWeight:j==="trainees"?"600":"400",opacity:j==="trainees"?"1":"0.7",borderRadius:"4px 4px 0 0"},children:[a.jsx(Ar,{className:"me-2",size:16}),"Trainees Roster"]})})]})}),a.jsx(M.Body,{className:"p-0",children:a.jsxs(Vt.Content,{children:[a.jsx(Vt.Pane,{eventKey:"course-info",children:a.jsxs("div",{className:"p-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-3",style:{color:"#1b3c53",fontWeight:"800",fontSize:"1.3rem",letterSpacing:"0.5px",textTransform:"uppercase",borderBottom:"2px solid #d2c1b6",paddingBottom:"0.5rem"},children:"Description"}),a.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.95rem"},children:v.description})]})})}),a.jsxs(oe,{className:"g-4",children:[a.jsxs(H,{md:6,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Name"}),a.jsx("p",{className:"mb-0 text-dark",style:{fontSize:"0.9rem"},children:v.name})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Course Code"}),a.jsx(Pe,{bg:"secondary",className:"px-2 py-1",children:v.code})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Level"}),a.jsx(Pe,{bg:"info",className:"px-2 py-1",children:v.level})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Start Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:v.startDate||"N/A"})]})]})]}),a.jsxs(H,{md:6,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Max Number of Trainees"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ma,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:v.maxTrainees})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Venue"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(tc,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:v.venue})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Pass Score"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nx,{size:16,className:"me-2 text-primary"}),a.jsxs("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:[v.passScore,"%"]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Status"}),a.jsx(Pe,{bg:v.status==="ACTIVE"?"success":v.status==="ARCHIVED"?"warning":"secondary",className:"px-2 py-1",children:v.status})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"mb-2",style:{color:"#456882",fontWeight:"800",fontSize:"1.15rem",letterSpacing:"0.5px",textTransform:"uppercase"},children:"End Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{size:16,className:"me-2 text-primary"}),a.jsx("span",{className:"text-dark",style:{fontSize:"0.9rem"},children:v.endDate||"N/A"})]})]})]})]})]})}),a.jsx(Vt.Pane,{eventKey:"subjects",children:a.jsx(wie,{subjects:y,loading:!1,onView:L,onEdit:A,onDelete:P})}),a.jsx(Vt.Pane,{eventKey:"trainees",style:{height:"100%"},children:a.jsx("div",{className:"p-4",children:a.jsx(Sie,{courseId:s,loading:!1,title:"Trainees Roster"})})})]})})]})}),a.jsx(Eie,{show:i,onClose:()=>o(!1),onSave:D,courseId:s}),a.jsx(Tie,{show:l,onClose:()=>c(!1),onImport:W,courseId:s}),a.jsx(Aie,{show:d,onClose:()=>u(!1),onSave:K,course:v||e}),a.jsx(Tk,{show:m,onClose:()=>{f(!1),p(null)},onDisable:I,subject:h,loading:x})]})},_ie=()=>{const{courseId:e}=Nr(),t=$n(),[r,s]=b.useState(null),[n,i]=b.useState(null),[o,l]=b.useState(!0);return b.useEffect(()=>{e&&(async()=>{try{l(!0);try{const d=await Ds.getCourseById(e);s(d),d.department&&i(d.department)}catch{const u={id:e,name:"Course Details",code:"COURSE-001",description:"Course information will be loaded from department data",status:"ACTIVE",startDate:"2026-01-12",endDate:"2026-01-26",venue:"Training Room",maxNumTrainee:16,passScore:80,level:"INTERMEDIATE"},m={id:t.state?.departmentId||null,name:t.state?.departmentName||"Default Department"};s(u),i(m)}l(!1)}catch{l(!1)}})()},[e]),o?a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):r?a.jsx(_e,{className:"py-3",children:a.jsx(Cie,{course:r,department:n})}):a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center text-muted",children:[a.jsx("h4",{children:"Course not found"}),a.jsx("p",{children:"The requested course could not be found."})]})})},kie=({selectedSubjects:e,onSelectionChange:t})=>{const[r,s]=b.useState(""),[n,i]=b.useState([]),[o,l]=b.useState(!0),[c,d]=b.useState(null);b.useEffect(()=>{(async()=>{try{l(!0),d(null);const x=await cs.getSubjects();if(x&&x.subjects){const g=x.subjects.map(v=>({id:v.id,name:v.name,code:v.code}));i(g)}else i([])}catch{d("Failed to load subjects"),i([])}finally{l(!1)}})()},[]);const u=n.filter(p=>p.name.toLowerCase().includes(r.toLowerCase())||p.code.toLowerCase().includes(r.toLowerCase())),m=()=>{e.length===u.length?t([]):t(u.map(p=>p.id))},f=p=>{e.includes(p)?t(e.filter(x=>x!==p)):t([...e,p])},h=u.length>0&&e.length===u.length;return a.jsxs(M,{className:"d-flex flex-column h-100 subject-selection-panel-card",style:{border:"1px solid #e9ecef",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",overflow:"visible",marginBottom:"1.5rem"},children:[a.jsx(M.Header,{className:"bg-gradient-primary-custom text-white border-0",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("h6",{className:"mb-0 text-white",children:"Select Subjects"}),a.jsx(se,{variant:"outline-light",size:"sm",onClick:m,children:h?"Deselect All":"Select All"})]})}),a.jsxs(M.Body,{className:"p-0 d-flex flex-column subject-selection-panel-body",style:{height:"500px",minHeight:0,display:"flex",flexDirection:"column"},children:[a.jsx("div",{className:"p-2 border-bottom flex-shrink-0",children:a.jsx(k.Control,{type:"text",placeholder:"Search subjects...",value:r,onChange:p=>s(p.target.value),size:"sm"})}),a.jsx("div",{className:"subject-list-scroll-container",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,maxHeight:"100%"},children:o?a.jsxs("div",{className:"p-3 text-center",children:[a.jsx(Pt,{animation:"border",size:"sm",className:"me-2"}),a.jsx("span",{className:"text-muted",children:"Loading subjects..."})]}):c?a.jsx("div",{className:"p-3 text-center text-danger",children:a.jsx("p",{className:"mb-0",children:c})}):u.length===0?a.jsx("div",{className:"p-3 text-center text-muted",children:a.jsx("p",{className:"mb-0",children:"No subjects found"})}):u.map(p=>a.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>f(p.id),children:[a.jsx("div",{className:"me-3 flex-shrink-0",children:e.includes(p.id)?a.jsx(q2,{size:20,className:"text-primary"}):a.jsx(oN,{size:20,className:"text-muted"})}),a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[a.jsx("div",{className:"fw-semibold text-truncate",title:p.name,children:p.name}),a.jsx("small",{className:"text-muted text-truncate d-block",title:p.code,children:p.code})]})]},p.id))}),a.jsx("div",{className:"p-2 bg-light border-top flex-shrink-0",children:a.jsxs("small",{className:"text-muted",children:[e.length," of ",u.length," subjects selected"]})})]})]})},Pie=({selectedTrainees:e,onSelectionChange:t})=>{const[r,s]=b.useState(""),[n,i]=b.useState(!1),[o,l]=b.useState([]),[c,d]=b.useState(!1),[u,m]=b.useState(null),f=b.useRef(null);b.useEffect(()=>{h()},[]),b.useEffect(()=>{const v=w=>{f.current&&!f.current.contains(w.target)&&i(!1)};return n&&document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[n]);const h=async()=>{d(!0),m(null);try{const v=await Al.getTraineesForEnrollment();if(v&&v.data&&v.data.users&&Array.isArray(v.data.users)){const w=v.data.users.map(y=>({id:y.id,eid:y.eid,name:`${y.firstName} ${y.lastName}`.trim(),firstName:y.firstName,lastName:y.lastName,email:y.email,status:y.status}));l(w)}else l([])}catch(v){console.error("Error loading trainees:",v),m("Failed to load trainees"),l([])}finally{d(!1)}},p=o.filter(v=>v.name.toLowerCase().includes(r.toLowerCase())||v.eid.toLowerCase().includes(r.toLowerCase()));b.useEffect(()=>{r.trim().length>0&&i(!0)},[r]);const x=v=>{e.find(w=>w.id===v.id)||t([...e,v])},g=v=>{t(e.filter(w=>w.id!==v))};return a.jsxs(M,{className:"d-flex flex-column h-100",style:{border:"1px solid #e9ecef",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",overflow:"hidden",marginBottom:"1.5rem"},children:[a.jsx(M.Header,{className:"bg-gradient-primary-custom text-white border-0",children:a.jsx("div",{className:"d-flex justify-content-between align-items-center",children:a.jsx("h6",{className:"mb-0 text-white",children:"Add Trainees"})})}),a.jsxs(M.Body,{className:"p-0 d-flex flex-column",style:{height:"500px"},children:[a.jsxs("div",{className:"flex-shrink-0",style:{position:"relative",paddingBottom:"1rem"},ref:f,children:[a.jsx("div",{className:"p-2 border-bottom",children:a.jsx(k.Control,{type:"text",placeholder:"Search by EID or name...",value:r,onChange:v=>s(v.target.value),size:"sm"})}),a.jsx("div",{className:"p-2",children:a.jsxs(se,{variant:"outline-primary",className:"w-100 d-flex align-items-center justify-content-between",size:"sm",onClick:()=>i(!n),disabled:c,children:[a.jsxs("span",{children:[a.jsx(Ar,{className:"me-2",size:16}),c?"Loading...":r.trim().length>0?`Available Trainees (${p.length})`:`Show All Available Trainees (${o.length})`]}),a.jsx(Ha,{size:16})]})}),n&&a.jsx("div",{className:"border bg-white",style:{position:"absolute",top:"calc(100% + 8px)",left:0,right:0,zIndex:1050,maxHeight:"350px",overflowY:"auto",borderRadius:"8px",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.15), 0 4px 8px rgba(0, 0, 0, 0.1)"},children:c?a.jsxs("div",{className:"p-3 text-center",children:[a.jsx(Pt,{animation:"border",size:"sm",className:"me-2"}),a.jsx("span",{className:"text-muted",children:"Loading trainees..."})]}):u?a.jsxs("div",{className:"p-3 text-center text-danger",children:[a.jsx("p",{className:"mb-0",children:u}),a.jsx(se,{size:"sm",variant:"outline-danger",onClick:h,className:"mt-2",children:"Retry"})]}):p.length===0?a.jsx("div",{className:"p-3 text-center text-muted",children:a.jsx("p",{className:"mb-0",children:"No trainees found"})}):p.map(v=>a.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between hover-bg-light",style:{cursor:"pointer",minWidth:0},onClick:()=>x(v),children:[a.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[a.jsx("div",{className:"fw-semibold text-truncate",title:v.name,children:v.name}),a.jsx("small",{className:"text-muted text-truncate d-block",title:v.eid,children:v.eid})]}),a.jsx(Cs,{size:14,className:"text-primary flex-shrink-0"})]},v.id))})]}),a.jsxs("div",{className:"border-top flex-grow-1 d-flex flex-column",style:{minHeight:0,marginTop:"1rem"},children:[a.jsx("div",{className:"p-2 bg-gradient-primary-custom text-white border-bottom",children:a.jsxs("small",{className:"text-white fw-semibold",children:["Selected Trainees (",e.length,")"]})}),a.jsx("div",{style:{overflowY:"auto",flex:1,minHeight:0},children:e.length===0?a.jsx("div",{className:"p-3 text-center text-muted",children:a.jsx("p",{className:"mb-0",children:"No trainees selected"})}):e.map(v=>a.jsxs("div",{className:"p-2 border-bottom d-flex align-items-center justify-content-between",style:{minWidth:0},children:[a.jsxs("div",{style:{minWidth:0,overflow:"hidden",flex:1},children:[a.jsx("div",{className:"fw-semibold text-truncate",title:v.name,children:v.name}),a.jsx("small",{className:"text-muted text-truncate d-block",title:v.eid,children:v.eid})]}),a.jsx(se,{size:"sm",variant:"outline-danger",className:"flex-shrink-0",onClick:()=>g(v.id),children:a.jsx(Ze,{size:14})})]},v.id))})]})]})]})},Oie=({show:e,onClose:t,onImport:r,loading:s=!1})=>{const[n,i]=b.useState(!1),[o,l]=b.useState(null),[c,d]=b.useState([]),[u,m]=b.useState(null),[f,h]=b.useState([]),[p,x]=b.useState([]),[g,v]=b.useState([]),[w,y]=b.useState(!1),S=b.useRef(null),E=["eid","email"],N=J=>{J.preventDefault(),J.stopPropagation(),J.type==="dragenter"||J.type==="dragover"?i(!0):J.type==="dragleave"&&i(!1)},j=J=>{J.preventDefault(),J.stopPropagation(),i(!1),J.dataTransfer.files&&J.dataTransfer.files[0]&&C(J.dataTransfer.files[0])},T=J=>{J.target.files&&J.target.files[0]&&C(J.target.files[0])},C=J=>{if(!J.name.match(/\.(xlsx|xls)$/)){x(["Please select a valid Excel file (.xlsx or .xls)"]);return}if(J.size>100*1024*1024){x(["File size must be less than 100MB"]);return}l(J),x([]),L(J)},L=J=>{const F=new FileReader;F.onload=le=>{try{const Ae=new Uint8Array(le.target.result),O=Ul(Ae,{type:"array"}),G=O.SheetNames[0],U=O.Sheets[G],B=fa.sheet_to_json(U,{header:1});if(B.length<2){x(["Excel file must contain at least a header row and one data row"]);return}const Y=B[0].map(je=>je?.toString().toLowerCase().trim()),te=B.slice(1),ae=E.filter(je=>!Y.includes(je));if(ae.length>0){x([`Missing required columns: ${ae.join(", ")}`]);return}const fe=te.map((je,z)=>{const me=je[Y.indexOf("eid")]?.toString().trim()||"",ie=je[Y.indexOf("email")]?.toString().trim()||"";return{id:`temp_${z}`,rowNumber:z+2,eid:me,email:ie,hasError:!1,errors:[]}}).filter(je=>je.eid||je.email).map(je=>(je.eid||(je.hasError=!0,je.errors.push("EID is required")),je.email?/\S+@\S+\.\S+/.test(je.email)||(je.hasError=!0,je.errors.push("Email format is invalid")):(je.hasError=!0,je.errors.push("Email is required")),je));d(fe),v([])}catch{x(["Failed to parse Excel file. Please check the file format."])}},F.readAsArrayBuffer(J)},A=async()=>{const J=c.filter(F=>!F.hasError);if(J.length===0){x(["No valid identifiers to lookup"]);return}y(!0),x([]);try{const F=J.map(B=>({eid:B.eid,email:B.email}));console.log("Sending lookup request with identifiers:",F);const le=await Al.lookupTrainees(F);console.log("Lookup response:",le),console.log("Found users:",le.foundUsers),console.log("Not found:",le.notFoundIdentifiers),le.foundUsers&&le.foundUsers.length>0&&(console.log(" First found user structure:",le.foundUsers[0]),console.log(" All found user IDs:",le.foundUsers.map(B=>({id:B.id,eid:B.eid,email:B.email}))));const Ae=(le.foundUsers||[]).filter(B=>F.some(Y=>Y.eid===B.eid&&Y.email===B.email)),O=F.filter(B=>!Ae.some(Y=>Y.eid===B.eid&&Y.email===B.email)),G=Ae.map(B=>{if(console.log(" Validating trainee:",{id:B.id,eid:B.eid,email:B.email,firstName:B.firstName,lastName:B.lastName}),!B.id||typeof B.id!="string"||B.id.length<10)throw new Error(`Trainee ${B.eid} has invalid UUID: ${B.id}`);if(!B.firstName||!B.lastName)throw new Error(`Trainee ${B.eid} has missing name fields`);return B}),U={foundUsers:G,notFoundIdentifiers:O,uploadedIdentifiers:F};console.log("Exact matches found:",G),console.log("Not found identifiers:",O),m(U),h(G),console.log("Set selected trainees (exact matches only):",G)}catch(F){console.error("Lookup error:",F),console.error("Error response:",F.response?.data),x([F.response?.data?.message||F.message||"Failed to lookup trainees. Please try again."])}finally{y(!1)}},P=(J,F)=>{h(F?le=>[...le,J]:le=>le.filter(Ae=>Ae.id!==J.id))},I=J=>{h(J?u?.foundUsers||[]:[])},_=async()=>{if(f.length===0){x(["Please select at least one trainee to import"]);return}try{r&&await r(f),D()}catch(J){x([J.message||"Failed to import selected trainees. Please try again."])}},D=()=>{l(null),d([]),m(null),h([]),x([]),v([]),i(!1),y(!1),t()},W=J=>J==="valid"?a.jsx(lt,{className:"text-success",size:16}):a.jsx(Ks,{className:"text-danger",size:16}),K=()=>{const J=[["eid","email"],["TE000001","john.doe@example.com"],["TE000002","trollergamehuydk+7@gmail.com"],["TE000003","bob.johnson@example.com"],["TE000004","alice.brown@example.com"],["TE000005","charlie.wilson@example.com"]],F=fa.book_new(),le=fa.aoa_to_sheet(J);le["!cols"]=[{wch:15},{wch:30}],fa.book_append_sheet(F,le,"Trainees Lookup Template"),eg(F,"Trainees_Lookup_Template.xlsx")};return a.jsxs(ue,{show:e,onHide:D,size:"xl",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Ts,{className:"me-2",size:20}),"Bulk Import Trainees"]}),a.jsx(se,{variant:"link",onClick:D,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[p.length>0&&a.jsx(Re,{variant:"danger",className:"mb-3",children:a.jsx("ul",{className:"mb-0",children:p.map((J,F)=>a.jsx("li",{children:J},F))})}),a.jsx(M,{className:"mb-4",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:`upload-area ${n?"drag-active":""}`,onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:j,onClick:()=>S.current?.click(),style:{border:"2px dashed #dee2e6",borderRadius:"8px",padding:"3rem",textAlign:"center",cursor:"pointer",backgroundColor:n?"#f8f9fa":"#fff",transition:"all 0.3s ease"},children:[a.jsx(fo,{size:48,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"Select or Drop your file here"}),a.jsx("p",{className:"text-muted mb-0",children:"File size up to 100MBs"}),a.jsx("input",{ref:S,type:"file",accept:".xlsx,.xls",onChange:T,style:{display:"none"}})]}),a.jsxs("div",{className:"mt-3 d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Required columns:"})," eid, email"]}),a.jsx("div",{className:"mt-1",children:a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:K,className:"d-flex align-items-center",children:[a.jsx(Fi,{className:"me-1",size:14}),"Download Template"]})})]}),o&&a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(fo,{className:"text-success me-2",size:16}),a.jsx("span",{className:"text-success fw-semibold",children:o.name})]})]})]})}),c.length>0&&a.jsxs(M,{className:"mb-4",children:[a.jsx(M.Header,{children:a.jsxs("h6",{className:"mb-0",children:["Preview Data (",c.length," records)"]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"bulk-import-preview",style:{maxHeight:"400px",overflowY:"auto",overflowX:"auto"},children:a.jsxs(It,{striped:!0,hover:!0,className:"mb-0",style:{minWidth:"800px"},children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{style:{minWidth:"50px"},children:"NO."}),a.jsx("th",{style:{minWidth:"150px"},children:"EID"}),a.jsx("th",{style:{minWidth:"250px"},children:"EMAIL"}),a.jsx("th",{style:{minWidth:"80px"},children:"STATUS"}),a.jsx("th",{style:{minWidth:"300px"},children:"ERROR ENCOUNTERED"})]})}),a.jsx("tbody",{children:c.map(J=>a.jsxs("tr",{className:J.hasError?"table-danger":"",children:[a.jsx("td",{children:J.rowNumber||J.id}),a.jsx("td",{children:J.eid||"-"}),a.jsx("td",{children:J.email||"-"}),a.jsx("td",{className:"text-center",children:W(J.hasError?"invalid":"valid")}),a.jsx("td",{children:J.errors.length>0&&a.jsx("small",{className:"text-danger",children:J.errors.length>1?`${J.errors[0]} (+${J.errors.length-1} more)`:J.errors[0]})})]},J.id))})]})})}),a.jsx(M.Footer,{className:"bg-light",children:a.jsx(se,{variant:"primary",onClick:A,disabled:w||c.filter(J=>!J.hasError).length===0,className:"d-flex align-items-center",children:w?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem",borderWidth:"0.15em"}}),"Looking up..."]}):a.jsxs(a.Fragment,{children:[a.jsx(cx,{className:"me-2",size:16}),"Lookup Existing Trainees (",c.filter(J=>!J.hasError).length," valid)"]})})})]}),u&&a.jsxs(M,{children:[a.jsx(M.Header,{className:"bg-light",children:a.jsxs("h6",{className:"mb-0",children:["Matched Trainees from Excel",a.jsxs("span",{className:"ms-2",children:[a.jsx(lt,{className:"text-success me-1",size:16}),u.foundUsers?.length||0," matched",a.jsx(Ks,{className:"text-danger ms-2 me-1",size:16}),u.notFoundIdentifiers?.length||0," not found"]})]})}),a.jsx(M.Body,{className:"p-0",children:u.foundUsers?.length>0?a.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:a.jsxs(It,{hover:!0,className:"mb-0",children:[a.jsx("thead",{className:"bg-light sticky-top",children:a.jsxs("tr",{children:[a.jsx("th",{children:a.jsx(k.Check,{type:"checkbox",checked:f.length===(u.foundUsers?.length||0)&&(u.foundUsers?.length||0)>0,onChange:J=>I(J.target.checked)})}),a.jsx("th",{children:"EID"}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Phone"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Matched From Excel"})]})}),a.jsx("tbody",{children:u.foundUsers?.map(J=>u.uploadedIdentifiers?.find(le=>le.eid===J.eid&&le.email===J.email)?a.jsxs("tr",{className:f.some(le=>le.id===J.id)?"table-success":"",children:[a.jsx("td",{children:a.jsx(k.Check,{type:"checkbox",checked:f.some(le=>le.id===J.id),onChange:le=>P(J,le.target.checked)})}),a.jsx("td",{children:J.eid}),a.jsxs("td",{children:[J.firstName," ",J.lastName]}),a.jsx("td",{children:J.email}),a.jsx("td",{children:J.phoneNumber}),a.jsx("td",{children:a.jsx(Pe,{bg:J.status==="ACTIVE"?"success":"secondary",children:J.status})}),a.jsx("td",{children:a.jsx(Pe,{bg:"success",children:" Exact Match"})})]},J.id):null).filter(Boolean)})]})}):a.jsxs("div",{className:"p-4 text-center",children:[a.jsx(Ks,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No matching trainees found"}),a.jsx("p",{className:"text-muted mb-0",children:"None of the uploaded identifiers match existing trainees with TRAINEE role in the system."})]})}),u.notFoundIdentifiers?.length>0&&a.jsx(M.Footer,{className:"bg-warning bg-opacity-10",children:a.jsxs(Re,{variant:"warning",className:"mb-0",children:[a.jsxs("strong",{children:["Identifiers Not Found in System (",u.notFoundIdentifiers.length,"):"]}),a.jsx("p",{className:"mb-2 mt-2",children:"These identifiers from your Excel file do not exist in the system:"}),a.jsx("ul",{className:"mb-0",children:u.notFoundIdentifiers.map((J,F)=>a.jsxs("li",{children:[a.jsx("strong",{children:J.eid})," - ",J.email]},F))})]})})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:D,disabled:s,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),u&&u.foundUsers?.length>0&&f.length>0&&a.jsx(se,{variant:"primary",onClick:_,disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"1rem",height:"1rem"}}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ts,{className:"me-2",size:16}),"Import Selected (",f.length," matched trainees)"]})})]})]})},Die=({show:e,onClose:t,onConfirm:r,loading:s=!1})=>{const[n,i]=b.useState(""),[o,l]=b.useState("");b.useEffect(()=>{e&&(i(""),l(""))},[e]);const c=f=>!f||f.trim()===""?"Batch code is required":f.length<3?"Batch code must be at least 3 characters long":f.length>20?"Batch code must be no more than 20 characters long":/[^a-zA-Z0-9_]/.test(f)?"Batch code can only contain letters, numbers, and underscores":null,d=f=>{const h=f.target.value;i(h),o&&l("")},u=()=>{const f=c(n);if(f){l(f);return}r(n.trim())},m=f=>{f.key==="Enter"&&(f.preventDefault(),u())};return a.jsxs(ue,{show:e,onHide:t,centered:!0,backdrop:"static",children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsxs(ue.Title,{children:[a.jsx(yr,{className:"me-2 text-warning",size:20}),"Enter Batch Code"]})}),a.jsxs(ue.Body,{children:[a.jsx(k,{children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsxs(k.Label,{children:["Batch Code ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"Enter batch code (e.g., SAF0012025, CCT_BATCH_01)",value:n,onChange:d,onKeyPress:m,isInvalid:!!o,disabled:s,autoFocus:!0}),a.jsx(k.Text,{className:"text-muted",children:"Only letters, numbers, and underscores are allowed. 3-20 characters."}),o&&a.jsx(k.Control.Feedback,{type:"invalid",children:o})]})}),a.jsx(Re,{variant:"info",className:"mb-0",children:a.jsxs("small",{children:[a.jsx("strong",{children:"Note:"})," This batch code will be used to identify the enrollment group. Make sure it's unique and descriptive for your course."]})})]}),a.jsxs(ue.Footer,{children:[a.jsx(se,{variant:"secondary",onClick:t,disabled:s,children:"Cancel"}),a.jsx(se,{variant:"primary",onClick:u,disabled:s||!n.trim(),children:s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem"}}),"Enrolling..."]}):"Confirm & Enroll"})]})]})},Iie=()=>{const e=Qe(),{courseId:t}=Nr(),r={name:"Safety Procedures",code:"SAF001",description:"Basic safety procedures training course"},[s,n]=b.useState([]),[i,o]=b.useState([]),[l,c]=b.useState(!1),[d,u]=b.useState(!1),[m,f]=b.useState(!1),[h,p]=b.useState(!1),[x,g]=b.useState({});b.useEffect(()=>{(async()=>{try{const j=await cs.getSubjects();if(j&&j.subjects){const T={};j.subjects.forEach(C=>{T[C.id]={name:C.name,code:C.code}}),g(T)}}catch{}})()},[]);const v=()=>{e(`/academic/course-detail/${t}`)},w=()=>{c(!0)},y=async N=>{if(!m){f(!0);try{const j=N.map(T=>({id:T.id,eid:T.eid,name:`${T.firstName} ${T.lastName}`.trim(),firstName:T.firstName,lastName:T.lastName,email:T.email,phoneNumber:T.phoneNumber,status:T.status,subjects:[]}));o(T=>{const C=new Set(T.map(A=>A.id)),L=j.filter(A=>!C.has(A.id));return L.length===0&&j.length>0?setTimeout(()=>{ce.error("All selected trainees are already in the list!",{autoClose:3e3,position:"top-right",toastId:"duplicate-trainees",closeButton:!1})},100):L.length<j.length&&L.length>0?setTimeout(()=>{ce.warning(`Added ${L.length} new trainees. ${j.length-L.length} were already selected.`,{autoClose:4e3,position:"top-right",toastId:"partial-duplicates",closeButton:!1})},100):L.length===j.length&&L.length>0&&setTimeout(()=>{ce.success(`Successfully added ${L.length} trainee${L.length>1?"s":""} to the selection!`,{autoClose:3e3,position:"top-right",toastId:"bulk-import-success",closeButton:!1})},100),[...T,...L]}),await new Promise(T=>setTimeout(T,1e3))}catch(j){throw j}finally{f(!1)}}},S=()=>{if(s.length===0||i.length===0){ce.warning("Please select both subjects and trainees to enroll");return}u(!0)},E=async N=>{p(!0),u(!1);try{const j=i.map(I=>{if(!I.id)throw new Error(`Trainee ${I.eid} (${I.firstName} ${I.lastName}) is missing UUID`);return I.id}),T={batchCode:String(N).trim(),traineeUserIds:j},C=s.map(async I=>{if(!I){const _=x[I]||{name:"Unknown",code:"N/A"};throw new Error(`Invalid subject ID: ${I} (${_.name})`)}try{const _=await cs.assignTrainees(I,T);return{subjectId:I,response:_,status:"success",subjectName:x[I]?.name||"Unknown Subject",subjectCode:x[I]?.code||"N/A"}}catch(_){const D=x[I]||{name:"Unknown Subject",code:"N/A"};return{subjectId:I,status:"error",error:_,subjectName:D.name,subjectCode:D.code,errorMessage:_.response?.data?.message||_.message||"Unknown error",errorDetails:_.response?.data}}}),L=await Promise.allSettled(C),A=[],P=[];if(L.forEach((I,_)=>{if(I.status==="fulfilled"){const D=I.value;D.status==="success"?A.push(D):P.push(D)}else{const D=s[_],W=x[D]||{name:"Unknown Subject",code:"N/A"};P.push({subjectId:D,status:"error",subjectName:W.name,subjectCode:W.code,errorMessage:I.reason?.message||"Unknown error",errorDetails:I.reason})}}),P.length>0&&P.forEach(I=>{const _=I.errorMessage||"Unknown error",D=`${I.subjectName} (${I.subjectCode})`;let W=_;I.errorDetails?.message?W=I.errorDetails.message:I.errorDetails?.errors&&Array.isArray(I.errorDetails.errors)&&(W=I.errorDetails.errors.map(K=>K.message||K).join(", ")),ce.error(`${D}: ${W}`,{autoClose:5e3,position:"top-right",icon:!1})}),A.length>0){const I=i.length;if(ce.success(`Successfully enrolled ${I} trainee(s) to ${A.length} subject(s): ${A.map(_=>_.subjectName).join(", ")}`,{autoClose:4e3,position:"top-right",icon:!1}),P.length===0)o([]),n([]);else{const _=new Set(A.map(D=>D.subjectId));n(D=>D.filter(W=>!_.has(W)))}setTimeout(()=>{e(`/academic/course-detail/${t}`,{state:{activeTab:"trainees"}})},1e3)}}catch(j){let T="Failed to enroll trainees. Please try again.";j.response?.data?.message?T=j.response.data.message:j.message&&(T=j.message),ce.error(T)}finally{p(!1)}};return a.jsxs(_e,{fluid:!0,className:"py-4 px-4 enroll-page",style:{minHeight:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{className:"mb-3 flex-shrink-0",children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:v,className:"me-3",children:[a.jsx(Tt,{size:16,className:"me-1"}),"Back"]}),a.jsx("div",{children:a.jsxs("h5",{className:"mb-0 text-primary",children:["Enroll Trainees - ",a.jsx("strong",{children:r.name})," (",r.code,")"]})})]}),a.jsx(M,{className:"mb-2",children:a.jsx(M.Body,{className:"py-3 px-3",children:a.jsxs(oe,{children:[a.jsx(H,{md:8,children:a.jsx("p",{className:"mb-0 text-muted",children:r.description})}),a.jsxs(H,{md:4,className:"text-end d-flex justify-content-end align-items-center gap-2",children:[a.jsx(se,{size:"sm",variant:"primary",onClick:S,disabled:s.length===0||i.length===0||h,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:h?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true",style:{width:"0.5rem",height:"0.5rem"}}),"Enrolling..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Cs,{size:12,className:"me-1"})," Enroll"]})}),a.jsxs(se,{size:"sm",variant:"outline-primary",onClick:w,style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem"},children:[a.jsx(Ts,{size:12,className:"me-1"})," Bulk Import Trainees"]})]})]})})})]}),a.jsx("div",{className:"mb-4 flex-shrink-0 main-content-section",style:{position:"relative",zIndex:1,marginBottom:"3rem"},children:a.jsxs(oe,{className:"g-4",children:[a.jsx(H,{lg:6,children:a.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"visible"},children:a.jsx(kie,{selectedSubjects:s,onSelectionChange:n})})}),a.jsx(H,{lg:6,children:a.jsx("div",{style:{height:"500px",position:"relative",zIndex:1,overflow:"visible"},children:a.jsx(Pie,{selectedTrainees:i,onSelectionChange:o})})})]})}),a.jsx(Oie,{show:l,onClose:()=>c(!1),onImport:y,loading:m}),a.jsx(Die,{show:d,onClose:()=>u(!1),onConfirm:E,loading:h})]})},Rie=({traineeId:e,courseId:t})=>{const r=Qe(),[s,n]=b.useState([]),[i,o]=b.useState(!0);b.useEffect(()=>{e&&t&&l()},[e,t]);const l=async()=>{try{o(!0);const m=[{id:"1",name:"Basic Safety Protocols",code:"BSP",description:"Introduction to basic safety procedures and protocols",status:"COMPLETED",progress:100,startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-01-30T17:00:00.000Z",instructor:"Sarah Johnson",score:95},{id:"2",name:"Emergency Procedures",code:"EP",description:"Emergency response procedures and protocols",status:"IN_PROGRESS",progress:75,startDate:"2024-02-01T09:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",instructor:"Mike Chen",score:null},{id:"3",name:"Equipment Handling",code:"EH",description:"Proper handling and maintenance of safety equipment",status:"PENDING",progress:0,startDate:"2024-02-16T09:00:00.000Z",endDate:"2024-03-01T17:00:00.000Z",instructor:"Lisa Wang",score:null}];await new Promise(f=>setTimeout(f,300)),n(m)}catch(m){console.error("Error loading trainee subjects:",m),ce.error("Failed to load subjects")}finally{o(!1)}},c=m=>{const h={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[m]||{variant:"secondary",text:m};return a.jsx(Pe,{bg:h.variant,children:h.text})},d=m=>{const h={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[m]||{variant:"secondary",text:m};return a.jsx(Pe,{bg:h.variant,children:h.text})},u=m=>{r(`/trainee/${e}/course/${t}/subject/${m}`)};return i?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Pt,{animation:"border",variant:"primary",size:"sm"}),a.jsx("p",{className:"mt-2 text-muted small",children:"Loading subjects..."})]}):s.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(bt,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No subjects found"})]}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject Code"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject Name"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Level"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Duration"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Method"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Progress"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:s.map((m,f)=>a.jsxs("tr",{className:`${f%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor=f%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx(Pe,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:m.code})}),a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:m.name}),a.jsx("small",{className:"text-muted",children:m.description})]}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:d(m.level)}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsxs("span",{className:"text-dark",children:[m.duration," hours"]})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx(Pe,{bg:"info",className:"fw-normal",children:m.method||"Classroom"})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(m.status)}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${m.progress||0}%`}})}),a.jsxs("small",{className:"text-muted",children:[m.progress||0,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>u(m.id),children:a.jsx(Nt,{size:14})})})]},m.id))})]})})},Ak=({traineeId:e,courseId:t})=>{const r=Qe(),[s,n]=b.useState([]),[i,o]=b.useState(!0);b.useEffect(()=>{e&&l()},[e,t]);const l=async()=>{try{o(!0),n([{id:"1",name:"Emergency Procedures Test",type:"Written",subject:"Emergency Procedures",dueDate:"2024-02-15T10:00:00.000Z",status:"UPCOMING",priority:"HIGH"},{id:"2",name:"Flight Simulation Practical",type:"Practical",subject:"Flight Operations",dueDate:"2024-02-18T14:00:00.000Z",status:"UPCOMING",priority:"MEDIUM"},{id:"3",name:"Safety Protocol Review",type:"Oral",subject:"Safety Protocols",dueDate:"2024-02-20T09:00:00.000Z",status:"UPCOMING",priority:"LOW"}])}catch(m){console.error("Error loading upcoming assessments:",m),ce.error("Failed to load upcoming assessments")}finally{o(!1)}},c=m=>{const h={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[m]||{variant:"secondary",text:m};return a.jsx(Pe,{bg:h.variant,children:h.text})},d=m=>{const h={WRITTEN:{variant:"primary",text:"Written"},PRACTICAL:{variant:"success",text:"Practical"},ORAL:{variant:"info",text:"Oral"},ONLINE:{variant:"secondary",text:"Online"}}[m?.toUpperCase()]||{variant:"secondary",text:m};return a.jsx(Pe,{bg:h.variant,children:h.text})},u=async m=>{try{r(`/trainee/${e}/assessment/${m}?action=start`)}catch(f){console.error("Error starting assessment:",f),ce.error("Failed to start assessment")}};return i?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Pt,{animation:"border",variant:"primary",size:"sm"}),a.jsx("p",{className:"mt-2 text-muted small",children:"Loading upcoming assessments..."})]}):s.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(pr,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No upcoming assessments"})]}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Assessment"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Subject"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Type"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Priority"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:"Due Date"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:s.map((m,f)=>a.jsxs("tr",{className:`${f%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:h=>{h.currentTarget.style.backgroundColor=f%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx("div",{className:"fw-medium text-dark",children:m.name})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:m.subject})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:d(m.type)}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:c(m.priority)}),a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{className:"text-muted me-1",size:14}),a.jsx("span",{className:"text-dark",children:new Date(m.dueDate).toLocaleDateString()})]}),a.jsx("small",{className:"text-muted",children:new Date(m.dueDate).toLocaleTimeString()})]}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsxs(se,{variant:"primary",size:"sm",onClick:()=>u(m.id),children:[a.jsx(At,{className:"me-1",size:14}),"Start"]})})]},m.id))})]})})},tr=({title:e,sortKey:t,sortConfig:r,onSort:s})=>{const n=()=>{s(t)},i=()=>r.key===t?r.direction==="asc"?a.jsx(Y2,{size:12,className:"ms-1"}):a.jsx(Ha,{size:12,className:"ms-1"}):a.jsx(ir,{size:12,className:"ms-1"});return a.jsxs("div",{className:"d-flex align-items-center cursor-pointer user-select-none",onClick:n,style:{cursor:"pointer",whiteSpace:"nowrap"},children:[a.jsx("span",{className:"me-1",children:e}),i()]})},Fie=`
  .completed-assessments-table-no-borders .table,
  .completed-assessments-table-no-borders .table td,
  .completed-assessments-table-no-borders .table th,
  .completed-assessments-table-no-borders .table tbody tr,
  .completed-assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .completed-assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .completed-assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Fie,document.head.appendChild(e)}const t1=({traineeId:e,courseId:t,subjectId:r})=>{const s=Qe(),[n,i]=b.useState([]),[o,l]=b.useState(!0),{sortedData:c,sortConfig:d,handleSort:u}=Zt(n);b.useEffect(()=>{m()},[e,t,r]);const m=async()=>{try{l(!0);let g=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",completedDate:"2024-01-20T14:30:00.000Z",score:85,status:"COMPLETED",maxScore:100},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",completedDate:"2024-01-18T10:15:00.000Z",score:92,status:"COMPLETED",maxScore:100},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",completedDate:"2024-01-15T16:45:00.000Z",score:78,status:"COMPLETED",maxScore:100}];t&&(g=g.filter(v=>v.course?.code==="SAF001")),r&&(g=g.filter(v=>v.subject?.code==="BSP")),await new Promise(v=>setTimeout(v,300)),i(g)}catch(x){console.error("Error loading completed assessments:",x),ce.error("Failed to load completed assessments")}finally{l(!1)}},f=x=>{const v={COMPLETED:{variant:"success",text:"Completed",icon:lt},PASSED:{variant:"success",text:"Passed",icon:lt},FAILED:{variant:"danger",text:"Failed",icon:yr}}[x]||{variant:"secondary",text:x,icon:lt},w=v.icon;return a.jsxs(Pe,{bg:v.variant,className:"d-flex align-items-center",children:[a.jsx(w,{size:12,className:"me-1"}),v.text]})},h=(x,g)=>{const v=x/g*100;let w="success";return v<60?w="danger":v<80&&(w="warning"),a.jsxs(Pe,{bg:w,children:[x,"/",g," (",v.toFixed(0),"%)"]})},p=x=>{s(`/trainee/${e}/assessment/${x.id}`)};return o?a.jsx("div",{className:"text-center py-4",children:a.jsx(Wt,{count:5})}):n.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(lt,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No completed assessments"})]}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(tr,{title:"Assessment",sortKey:"name",sortConfig:d,onSort:u})}),!r&&a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(tr,{title:"Subject",sortKey:"subject",sortConfig:d,onSort:u})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(tr,{title:"Type",sortKey:"type",sortConfig:d,onSort:u})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(tr,{title:"Score",sortKey:"score",sortConfig:d,onSort:u})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(tr,{title:"Completed Date",sortKey:"completedDate",sortConfig:d,onSort:u})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold show-mobile",children:a.jsx(tr,{title:"Status",sortKey:"status",sortConfig:d,onSort:u})}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:c.map((x,g)=>a.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:v=>{v.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:v=>{v.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:x.name}),a.jsx("small",{className:"text-muted",children:x.description})]}),!r&&a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:x.subject?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:x.subject?.code||""})]}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx(Pe,{bg:"primary",className:"fw-normal",children:x.type||"Assessment"})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:h(x.score,x.maxScore)}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:x.completedDate?new Date(x.completedDate).toLocaleDateString():"N/A"})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:f(x.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Results",icon:a.jsx(lt,{}),onClick:()=>p(x)}]})})]},x.id))})]})})},Lie=({traineeId:e,courseId:t})=>{const r=Qe(),[s,n]=b.useState(null),[i,o]=b.useState(null),[l,c]=b.useState(!0),[d,u]=b.useState("");b.useEffect(()=>{e&&t&&m()},[e,t]);const m=async()=>{try{c(!0),u(""),o({id:e,firstName:"John",lastName:"Doe",eid:"EMP001",email:"john.doe@company.com"}),n({id:t,name:"Advanced Flight Training",code:"AFT2024",description:"Comprehensive flight training program covering advanced maneuvers and emergency procedures.",level:"ADVANCED",status:"ACTIVE",startDate:"2024-01-15T08:00:00.000Z",endDate:"2024-06-15T17:00:00.000Z",venue:"Training Center A",maxNumTrainee:25,passScore:80,progress:65,department:{name:"Flight Crew Training Department",code:"FCTD"}})}catch(x){console.error("Error loading course details:",x),u("Failed to load course details"),ce.error("Failed to load course details")}finally{c(!1)}},f=()=>{r("/trainee/enrolled-courses")},h=x=>{const v={ACTIVE:{variant:"success",text:"Active"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[x]||{variant:"secondary",text:x};return a.jsx(Pe,{bg:v.variant,className:"fs-6",children:v.text})},p=x=>{const v={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[x]||{variant:"secondary",text:x};return a.jsx(Pe,{bg:v.variant,children:v.text})};return l?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):d||!s?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:d||"Course not found"}),a.jsxs(se,{variant:"outline-danger",onClick:f,children:[a.jsx(Tt,{className:"me-2",size:16}),"Back to Trainee"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(se,{variant:"outline-secondary",onClick:f,className:"me-3",children:a.jsx(Tt,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(bt,{className:"me-2",size:28}),s.name]}),a.jsxs("p",{className:"text-muted mb-0",children:[s.code,"  ",i?.firstName," ",i?.lastName]})]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[h(s.status),p(s.level)]})]})})}),a.jsxs(oe,{children:[a.jsxs(H,{lg:8,className:"mb-4",children:[a.jsx(oe,{children:a.jsx(H,{className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(bt,{className:"me-2",size:20}),"Subject List"]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx(Rie,{traineeId:e,courseId:t})})]})})}),a.jsx(oe,{children:a.jsx(H,{className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(At,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx(Ak,{traineeId:e,courseId:t})})]})})}),a.jsx(oe,{children:a.jsx(H,{children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(lt,{className:"me-2",size:20}),"Completed Assessments"]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx(t1,{traineeId:e,courseId:t})})]})})})]}),a.jsx(H,{lg:4,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(bt,{className:"me-2",size:20}),"Enrolled Course Details"]})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Start Date"}),a.jsx("div",{className:"text-muted",children:new Date(s.startDate).toLocaleDateString()})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"End Date"}),a.jsx("div",{className:"text-muted",children:new Date(s.endDate).toLocaleDateString()})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(tc,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Venue"}),a.jsx("div",{className:"text-muted",children:s.venue})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ar,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Max Trainees"}),a.jsx("div",{className:"text-muted",children:s.maxNumTrainee})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Pass Score"}),a.jsxs("div",{className:"text-muted",children:[s.passScore,"%"]})]})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("span",{className:"fw-semibold",children:"Progress"}),a.jsxs("span",{className:"text-muted",children:[s.progress,"%"]})]}),a.jsx("div",{className:"progress",children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${s.progress}%`}})})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("h6",{children:"Description"}),a.jsx("p",{className:"text-muted",children:s.description})]})]})]})})]})]})},Mie=()=>{const{traineeId:e,courseId:t}=Nr();return a.jsx(_e,{className:"py-3",children:a.jsx(Lie,{traineeId:e,courseId:t})})},Bie=({traineeId:e,courseId:t,subjectId:r})=>{const s=Qe(),[n,i]=b.useState(null),[o,l]=b.useState(null),[c,d]=b.useState(!0),[u,m]=b.useState("");b.useEffect(()=>{e&&t&&r&&f()},[e,t,r]);const f=async()=>{try{d(!0),m("");const g={id:r,name:"Emergency Procedures",code:"EP101",description:"Comprehensive training on emergency procedures and safety protocols for flight operations.",level:"INTERMEDIATE",status:"ACTIVE",duration:40,method:"Simulator",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-02-15T17:00:00.000Z",roomName:"Simulator Room A",progress:75,trainer:{name:"Captain John Smith",email:"john.smith@instructor.com"},assessments:[{id:"1",name:"Emergency Evacuation Drill",type:"Practical",dueDate:"2024-02-10T14:00:00.000Z",status:"COMPLETED",score:85},{id:"2",name:"Safety Protocol Test",type:"Written",dueDate:"2024-02-12T10:00:00.000Z",status:"PENDING",score:null}]},v={id:e,firstName:"John",lastName:"Doe",eid:"TR001"};i(g),l(v)}catch(g){console.error("Error loading subject details:",g),m("Failed to load subject details"),ce.error("Failed to load subject details")}finally{d(!1)}},h=()=>{s(`/trainee/${e}/course/${t}`)},p=g=>{const w={ACTIVE:{variant:"success",text:"Active"},COMPLETED:{variant:"primary",text:"Completed"},PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"info",text:"In Progress"}}[g]||{variant:"secondary",text:g};return a.jsx(Pe,{bg:w.variant,className:"fs-6",children:w.text})},x=g=>{const w={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[g]||{variant:"secondary",text:g};return a.jsx(Pe,{bg:w.variant,children:w.text})};return c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading subject details..."})]})}):u||!n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:u||"Subject not found"}),a.jsxs(se,{variant:"outline-danger",onClick:h,children:[a.jsx(Tt,{className:"me-2",size:16}),"Back to Course"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(se,{variant:"outline-secondary",onClick:h,className:"me-3",children:a.jsx(Tt,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(bt,{className:"me-2",size:28}),n.name]}),a.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",o?.firstName," ",o?.lastName]})]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[p(n.status),x(n.level)]})]})})}),a.jsxs(oe,{children:[a.jsxs(H,{lg:8,className:"mb-4",children:[a.jsx(oe,{children:a.jsx(H,{className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(At,{className:"me-2",size:20}),"Upcoming Assessment Events"]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx(Ak,{traineeId:e,courseId:t,subjectId:r})})]})})}),a.jsx(oe,{children:a.jsx(H,{children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(lt,{className:"me-2",size:20}),"Completed Assessments"]})}),a.jsx(M.Body,{className:"p-0",children:a.jsx(t1,{traineeId:e,courseId:t,subjectId:r})})]})})})]}),a.jsx(H,{lg:4,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(bt,{className:"me-2",size:20}),"Enrolled Subject Details"]})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Start Date"}),a.jsx("div",{className:"text-muted",children:new Date(n.startDate).toLocaleDateString()})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"End Date"}),a.jsx("div",{className:"text-muted",children:new Date(n.endDate).toLocaleDateString()})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Duration"}),a.jsxs("div",{className:"text-muted",children:[n.duration," hours"]})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(tc,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Room"}),a.jsx("div",{className:"text-muted",children:n.roomName})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Trainer"}),a.jsx("div",{className:"text-muted",children:n.trainer?.name})]})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("span",{className:"fw-semibold",children:"Progress"}),a.jsxs("span",{className:"text-muted",children:[n.progress,"%"]})]}),a.jsx("div",{className:"progress",children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${n.progress}%`}})})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("h6",{children:"Description"}),a.jsx("p",{className:"text-muted",children:n.description})]})]})]})})]})]})},$ie=()=>{const{traineeId:e,courseId:t,subjectId:r}=Nr();return a.jsx(_e,{className:"py-3",children:a.jsx(Bie,{traineeId:e,courseId:t,subjectId:r})})},zie=({traineeId:e})=>{const t=Qe(),[r,s]=b.useState(null),[n,i]=b.useState([]),[o,l]=b.useState([]),[c,d]=b.useState([]),[u,m]=b.useState(!0),[f,h]=b.useState("");b.useEffect(()=>{e&&p()},[e]);const p=async()=>{try{m(!0),h("");const N=await Al.getTraineeById(e);s(N);const j=await Al.getTraineeAssessments(e);i(j.assessments||j.data||[]);const T=[{id:"1",name:"Safety Protocol Agreement",course:"Emergency Procedures",subject:"Safety Protocols",dueDate:"2024-02-15T17:00:00.000Z",status:"PENDING"},{id:"2",name:"Training Completion Certificate",course:"Advanced Flight Training",subject:"Flight Operations",dueDate:"2024-02-20T17:00:00.000Z",status:"PENDING"}],C=[{id:"1",name:"Emergency Evacuation Procedures",course:"Emergency Procedures",subject:"Safety Protocols",section:"Practical Assessment",dueDate:"2024-02-12T14:00:00.000Z",status:"IN_PROGRESS",progress:60},{id:"2",name:"Flight Navigation Systems",course:"Advanced Flight Training",subject:"Navigation",section:"Written Test",dueDate:"2024-02-18T10:00:00.000Z",status:"PENDING",progress:0}];l(T),d(C)}catch(N){console.error("Error loading assessment data:",N),h("Failed to load assessment data"),ce.error("Failed to load assessment data")}finally{m(!1)}},x=()=>{t("/trainee/your-assessments")},g=N=>{const T={PENDING:{variant:"warning",text:"Pending",icon:it},IN_PROGRESS:{variant:"info",text:"In Progress",icon:At},COMPLETED:{variant:"success",text:"Completed",icon:lt},OVERDUE:{variant:"danger",text:"Overdue",icon:yr}}[N]||{variant:"secondary",text:N,icon:At},C=T.icon;return a.jsxs(Pe,{bg:T.variant,className:"d-flex align-items-center",children:[a.jsx(C,{size:12,className:"me-1"}),T.text]})},v=N=>{const T={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[N]||{variant:"secondary",text:N};return a.jsx(Pe,{bg:T.variant,children:T.text})},w=N=>{t(`/trainee/${e}/assessment/${N}`)},y=N=>{t(`/trainee/${e}/assessment/${N}`)},S=N=>{t(`/trainee/${e}/signature-pad/${N}`)},E=N=>{t(`/trainee/${e}/assessment-section/${N}`)};return u?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment data..."})]})}):f||!r?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:f||"Trainee not found"}),a.jsxs(se,{variant:"outline-danger",onClick:x,children:[a.jsx(Tt,{className:"me-2",size:16}),"Back to Trainee"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsx("div",{className:"d-flex justify-content-between align-items-center",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(se,{variant:"outline-secondary",onClick:x,className:"me-3",children:a.jsx(Tt,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(At,{className:"me-2",size:28}),"Assessment Management"]}),a.jsxs("p",{className:"text-muted mb-0",children:[r.firstName," ",r.lastName,"  ",r.eid]})]})]})})})}),a.jsx(oe,{children:a.jsx(H,{children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsx(M.Body,{className:"p-0",children:a.jsxs(tx,{defaultActiveKey:"pending",className:"border-bottom",children:[a.jsx(Vt,{eventKey:"pending",title:"Pending Assessments",children:a.jsx("div",{className:"p-4",children:n.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(At,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No pending assessments"})]}):a.jsx("div",{className:"trainee-assessments-table",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:"Assessment"}),a.jsx("th",{className:"text-start",children:"Course"}),a.jsx("th",{className:"text-start",children:"Subject"}),a.jsx("th",{className:"text-start",children:"Type"}),a.jsx("th",{className:"text-start",children:"Priority"}),a.jsx("th",{className:"text-start",children:"Due Date"}),a.jsx("th",{className:"text-start",children:"Status"}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(N=>a.jsxs("tr",{children:[a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:N.name}),a.jsx("small",{className:"text-muted",children:N.description})]}),a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:N.course?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:N.course?.code||""})]}),a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:N.subject?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:N.subject?.code||""})]}),a.jsx("td",{children:a.jsx(Pe,{bg:"info",className:"fw-normal",children:N.type||"Assessment"})}),a.jsx("td",{children:v(N.priority)}),a.jsx("td",{children:N.dueDate?new Date(N.dueDate).toLocaleDateString():"N/A"}),a.jsx("td",{children:g(N.status)}),a.jsx("td",{children:a.jsx("div",{className:"d-flex gap-1",children:N.status==="PENDING"||N.status==="IN_PROGRESS"?a.jsx(se,{variant:"primary",size:"sm",onClick:()=>w(N.id),children:"Start"}):a.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>y(N.id),children:"View"})})})]},N.id))})]})})})}),a.jsx(Vt,{eventKey:"signature",title:"Signature Required",children:a.jsx("div",{className:"p-4",children:o.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ln,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):a.jsx("div",{className:"trainee-assessments-table",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:"Document"}),a.jsx("th",{className:"text-start",children:"Course"}),a.jsx("th",{className:"text-start",children:"Subject"}),a.jsx("th",{className:"text-start",children:"Due Date"}),a.jsx("th",{className:"text-start",children:"Status"}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:o.map(N=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:N.name})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:N.course})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:N.subject})}),a.jsx("td",{children:new Date(N.dueDate).toLocaleDateString()}),a.jsx("td",{children:g(N.status)}),a.jsx("td",{children:a.jsxs(se,{variant:"primary",size:"sm",onClick:()=>S(N.id),children:[a.jsx(ln,{className:"me-1",size:14}),"Sign"]})})]},N.id))})]})})})}),a.jsx(Vt,{eventKey:"completion",title:"Section Completion",children:a.jsx("div",{className:"p-4",children:c.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(lt,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):a.jsx("div",{className:"trainee-assessments-table",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:"Section"}),a.jsx("th",{className:"text-start",children:"Course"}),a.jsx("th",{className:"text-start",children:"Subject"}),a.jsx("th",{className:"text-start",children:"Type"}),a.jsx("th",{className:"text-start",children:"Due Date"}),a.jsx("th",{className:"text-start",children:"Progress"}),a.jsx("th",{className:"text-start",children:"Status"}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:c.map(N=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:N.name})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:N.course})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:N.subject})}),a.jsx("td",{children:a.jsx(Pe,{bg:"info",className:"fw-normal",children:N.section})}),a.jsx("td",{children:new Date(N.dueDate).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${N.progress}%`}})}),a.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),a.jsx("td",{children:g(N.status)}),a.jsx("td",{children:a.jsx(se,{variant:"primary",size:"sm",onClick:()=>E(N.id),children:N.status==="COMPLETED"?"View":"Complete"})})]},N.id))})]})})})})]})})})})})]})},Uie=()=>{const{traineeId:e}=Nr();return a.jsx(_e,{className:"py-3",children:a.jsx(zie,{traineeId:e})})},Wie=()=>{const{traineeId:e,assessmentId:t}=Nr(),r=Qe(),[s,n]=sx(),[i,o]=b.useState(null),[l,c]=b.useState(!0),[d,u]=b.useState("");b.useEffect(()=>{t&&m()},[t]),b.useEffect(()=>{if(i&&s.get("action")==="start"){n({});const S=i.sections?.find(E=>E.status!=="COMPLETED");S&&r(`/trainee/${e}/assessment-section/${S.id}`)}},[i,s,r,e,n]);const m=async()=>{try{c(!0),u(""),o({id:t,name:"Emergency Procedures Assessment",description:"Comprehensive assessment covering emergency evacuation procedures, safety protocols, and equipment handling.",course:{id:"course-1",name:"Emergency Procedures Training",code:"EPT2024"},subject:{id:"subject-1",name:"Safety Protocols",code:"SP101"},type:"PRACTICAL",status:"IN_PROGRESS",priority:"HIGH",dueDate:"2024-02-15T17:00:00.000Z",startDate:"2024-02-10T08:00:00.000Z",timeLimit:120,progress:60,score:null,maxScore:100,completedDate:null,sections:[{id:"section-1",name:"Emergency Evacuation Procedures",status:"COMPLETED",progress:100},{id:"section-2",name:"Safety Protocol Review",status:"IN_PROGRESS",progress:60},{id:"section-3",name:"Equipment Handling",status:"PENDING",progress:0}],requiresSignature:!0,signatureStatus:"PENDING",instructions:["Read each question carefully before answering","You have 120 minutes to complete this assessment","Save your progress regularly","Ensure all required sections are completed","Signature will be required upon completion"]})}catch(S){console.error("Error loading assessment details:",S),u("Failed to load assessment details"),ce.error("Failed to load assessment details")}finally{c(!1)}},f=()=>{r(-1)},h=()=>{const S=i.sections.find(E=>E.status!=="COMPLETED");S?r(`/trainee/${e}/assessment-section/${S.id}`):ce.info("Starting assessment...")},p=()=>{const S=i.sections.find(E=>E.status==="IN_PROGRESS");S?r(`/trainee/${e}/assessment-section/${S.id}`):h()},x=S=>{r(`/trainee/${e}/assessment-section/${S}`)},g=()=>{r(`/trainee/${e}/signature-pad/${t}`)},v=()=>{r("/trainee/create-incident-feedback-report",{state:{assessmentId:t,assessmentName:i.name}})},w=S=>{const N={PENDING:{variant:"warning",text:"Pending",icon:it},IN_PROGRESS:{variant:"info",text:"In Progress",icon:At},COMPLETED:{variant:"success",text:"Completed",icon:lt},OVERDUE:{variant:"danger",text:"Overdue",icon:yr}}[S]||{variant:"secondary",text:S,icon:At},j=N.icon;return a.jsxs(Pe,{bg:N.variant,className:"d-flex align-items-center",children:[a.jsx(j,{size:12,className:"me-1"}),N.text]})},y=S=>{const N={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"info",text:"Low"}}[S]||{variant:"secondary",text:S};return a.jsx(Pe,{bg:N.variant,children:N.text})};return l?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment details..."})]})}):d||!i?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:d||"Assessment not found"}),a.jsxs(se,{variant:"outline-danger",onClick:f,children:[a.jsx(Tt,{className:"me-2",size:16}),"Back"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(se,{variant:"outline-secondary",onClick:f,className:"me-3",children:a.jsx(Tt,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(At,{className:"me-2",size:28}),i.name]}),a.jsxs("p",{className:"text-muted mb-0",children:[i.course?.name||"Course","  ",i.subject?.name||"Subject"]})]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[w(i.status),y(i.priority)]})]})})}),a.jsxs(oe,{children:[a.jsx(H,{lg:8,className:"mb-4",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsx(M.Body,{className:"p-0",children:a.jsxs(tx,{defaultActiveKey:i.status==="COMPLETED"?"results":"overview",className:"border-bottom",children:[a.jsx(Vt,{eventKey:"overview",title:"Overview",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Description"}),a.jsx("p",{className:"text-muted",children:i.description})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Instructions"}),a.jsx("ul",{className:"list-unstyled",children:i.instructions.map((S,E)=>a.jsxs("li",{className:"mb-2",children:[a.jsx("span",{className:"text-primary me-2",children:""}),S]},E))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Assessment Sections"}),a.jsx("div",{className:"row",children:i.sections.map((S,E)=>a.jsx("div",{className:"col-md-6 mb-3",children:a.jsx(M,{className:`${S.status==="COMPLETED"?"bg-light":""}`,children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("span",{className:"fw-semibold",children:["Section ",E+1]}),w(S.status)]}),a.jsx("h6",{className:"mb-2",children:S.name}),a.jsx("div",{className:"progress mb-2",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${S.progress}%`}})}),a.jsx(se,{variant:S.status==="COMPLETED"?"outline-success":"primary",size:"sm",onClick:()=>x(S.id),children:S.status==="COMPLETED"?"View":S.status==="IN_PROGRESS"?"Continue":"Start"})]})})},S.id))})]}),a.jsxs("div",{className:"d-flex gap-2",children:[i.status==="PENDING"?a.jsxs(se,{variant:"primary",size:"lg",onClick:h,children:[a.jsx(At,{className:"me-2",size:20}),"Start Assessment"]}):i.status==="IN_PROGRESS"?a.jsxs(se,{variant:"primary",size:"lg",onClick:p,children:[a.jsx(At,{className:"me-2",size:20}),"Continue Assessment"]}):null,i.requiresSignature&&i.signatureStatus==="PENDING"&&a.jsxs(se,{variant:"outline-primary",size:"lg",onClick:g,children:[a.jsx(ln,{className:"me-2",size:20}),"Sign Document"]})]})]})}),a.jsx(Vt,{eventKey:"progress",title:"Progress",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Overall Progress"}),a.jsx("div",{className:"progress mb-2",style:{height:"20px"},children:a.jsxs("div",{className:"progress-bar bg-primary",style:{width:`${i.progress}%`},children:[i.progress,"%"]})}),a.jsxs("small",{className:"text-muted",children:[i.sections.filter(S=>S.status==="COMPLETED").length," of ",i.sections.length," sections completed"]})]}),a.jsx("h5",{children:"Section Progress"}),i.sections.map((S,E)=>a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("span",{className:"fw-semibold",children:["Section ",E+1,": ",S.name]}),a.jsxs("span",{className:"text-muted",children:[S.progress,"%"]})]}),a.jsx("div",{className:"progress",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${S.progress}%`}})})]},S.id))]})}),i.status==="COMPLETED"&&a.jsx(Vt,{eventKey:"results",title:"Results",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Assessment Score"}),i.score!==null?a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsxs("div",{className:"display-4 fw-bold text-primary me-3",children:[i.score," / ",i.maxScore]}),a.jsx("div",{children:a.jsxs(Pe,{bg:i.score>=i.maxScore*.8?"success":i.score>=i.maxScore*.6?"warning":"danger",className:"fs-6",children:[Math.round(i.score/i.maxScore*100),"%"]})})]}):a.jsx("p",{className:"text-muted",children:"Score pending review"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{children:"Section Results"}),i.sections?.map((S,E)=>a.jsx(M,{className:"mb-2",children:a.jsx(M.Body,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"fw-semibold",children:["Section ",E+1,": ",S.name]}),a.jsx(Pe,{bg:"success",className:"ms-2",children:"Completed"})]}),S.score!==void 0&&a.jsxs("div",{className:"text-end",children:[a.jsxs("div",{className:"fw-bold",children:[S.score," / ",S.maxScore||100]}),a.jsxs("small",{className:"text-muted",children:[Math.round(S.score/(S.maxScore||100)*100),"%"]})]})]})})},S.id))]})]})})]})})})}),a.jsx(H,{lg:4,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(nr,{className:"me-2",size:20}),"Assessment Information"]})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bt,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Course"}),a.jsx("div",{className:"text-muted",children:i.course?.name||"N/A"})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bt,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Subject"}),a.jsx("div",{className:"text-muted",children:i.subject?.name||"N/A"})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Due Date"}),a.jsx("div",{className:"text-muted",children:i.dueDate?new Date(i.dueDate).toLocaleDateString():"N/A"})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Time Limit"}),a.jsxs("div",{className:"text-muted",children:[i.timeLimit," minutes"]})]})]}),i.score!==null&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(lt,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Score"}),a.jsxs("div",{className:"text-muted",children:[i.score," / ",i.maxScore]})]})]}),i.completedDate&&a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Completed Date"}),a.jsx("div",{className:"text-muted",children:new Date(i.completedDate).toLocaleDateString()})]})]})]})]}),i.requiresSignature&&a.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[a.jsx("h6",{className:"mb-2",children:"Signature Required"}),a.jsx("p",{className:"small text-muted mb-2",children:"This assessment requires a digital signature upon completion."}),i.signatureStatus==="PENDING"&&a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:g,children:[a.jsx(ln,{className:"me-2",size:14}),"Sign Now"]}),i.signatureStatus==="COMPLETED"&&a.jsx(Pe,{bg:"success",children:"Signed"})]}),a.jsx("div",{className:"mt-4",children:a.jsxs(se,{variant:"outline-secondary",className:"w-100",onClick:v,children:[a.jsx(yr,{className:"me-2",size:16}),"Report Issue / Feedback"]})})]})]})})]})]})},Hie=({show:e,onClose:t,onSave:r,documentName:s,loading:n=!1})=>{const i=b.useRef(null),[o,l]=b.useState(!1),[c,d]=b.useState(!1),[u,m]=b.useState("");b.useEffect(()=>{e&&(d(!1),m(""),f())},[e]);const f=()=>{const w=i.current;w&&(w.getContext("2d").clearRect(0,0,w.width,w.height),d(!1))},h=w=>{l(!0);const y=i.current,S=y.getBoundingClientRect(),E=y.getContext("2d");E.beginPath(),E.moveTo(w.clientX-S.left,w.clientY-S.top)},p=w=>{if(!o)return;const y=i.current,S=y.getBoundingClientRect(),E=y.getContext("2d");E.lineTo(w.clientX-S.left,w.clientY-S.top),E.stroke(),d(!0)},x=()=>{l(!1)},g=async()=>{if(!c){m("Please provide your signature before saving");return}try{const y=i.current.toDataURL("image/png");await r({documentName:s,signature:y,timestamp:new Date().toISOString()}),t()}catch{m("Failed to save signature. Please try again.")}},v=()=>{f(),m(""),t()};return a.jsxs(ue,{show:e,onHide:v,size:"lg",centered:!0,children:[a.jsxs(ue.Header,{className:"bg-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(ln,{className:"me-2",size:20}),"Digital Signature"]}),a.jsx(se,{variant:"link",onClick:v,className:"text-white p-0",children:a.jsx(Ze,{size:24})})]}),a.jsxs(ue.Body,{className:"p-4",children:[u&&a.jsx(Re,{variant:"danger",className:"mb-3",children:u}),a.jsxs("div",{className:"text-center mb-4",children:[a.jsxs("h5",{children:["Sign Document: ",s]}),a.jsx("p",{className:"text-muted",children:"Please sign in the box below using your mouse or touch device"})]}),a.jsx("div",{className:"signature-container border rounded p-3 mb-3",children:a.jsx("canvas",{ref:i,width:600,height:200,className:"border rounded w-100",style:{cursor:"crosshair",touchAction:"none"},onMouseDown:h,onMouseMove:p,onMouseUp:x,onMouseLeave:x,onTouchStart:w=>{w.preventDefault();const y=w.touches[0],S=new MouseEvent("mousedown",{clientX:y.clientX,clientY:y.clientY});h(S)},onTouchMove:w=>{w.preventDefault();const y=w.touches[0],S=new MouseEvent("mousemove",{clientX:y.clientX,clientY:y.clientY});p(S)},onTouchEnd:w=>{w.preventDefault(),x()}})}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs(se,{variant:"outline-secondary",onClick:f,disabled:n,children:[a.jsx(H2,{className:"me-2",size:16}),"Clear"]}),a.jsx("div",{className:"text-muted small",children:c?a.jsx("span",{className:"text-success",children:" Signature captured"}):a.jsx("span",{children:"Please sign above"})})]}),a.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[a.jsx("h6",{className:"mb-2",children:"Signature Guidelines:"}),a.jsxs("ul",{className:"mb-0 small text-muted",children:[a.jsx("li",{children:"Sign within the designated area"}),a.jsx("li",{children:"Use your full legal signature"}),a.jsx("li",{children:"Ensure the signature is clear and readable"}),a.jsx("li",{children:'Click "Clear" to start over if needed'})]})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-4",children:[a.jsxs(se,{variant:"outline-secondary",onClick:v,disabled:n,children:[a.jsx(Ze,{className:"me-2",size:16}),"Cancel"]}),a.jsx(se,{variant:"primary",onClick:g,disabled:n||!c,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{className:"me-2",size:16}),"Save Signature"]})})]})]})},Vie=()=>{const{traineeId:e,documentId:t}=Nr(),r=Qe(),s=async i=>{try{console.log("Signature saved:",i),ce.success("Signature saved successfully"),r(`/trainee/${e}/assessment/${t}`,{replace:!0})}catch(o){console.error("Error saving signature:",o),ce.error("Failed to save signature")}},n=()=>{r(`/trainee/${e}/assessment/${t}`,{replace:!0})};return a.jsx(_e,{className:"py-3",children:a.jsx(Hie,{show:!0,documentName:`Document ${t}`,onClose:n,onSave:s})})},Gie=({traineeId:e,sectionId:t})=>{const r=Qe(),[s,n]=b.useState(null),[i,o]=b.useState(!0),[l,c]=b.useState("");b.useEffect(()=>{t&&d()},[t]);const d=async()=>{try{o(!0),c(""),n({id:t,name:"Emergency Evacuation Procedures",description:"Complete the emergency evacuation procedures assessment including both theoretical knowledge and practical demonstration.",course:"Emergency Procedures",subject:"Safety Protocols",type:"Practical Assessment",status:"IN_PROGRESS",progress:60,dueDate:"2024-02-12T14:00:00.000Z",timeLimit:120,questions:[{id:"1",type:"multiple_choice",question:"What is the first step in an emergency evacuation?",options:["Sound the alarm","Assess the situation","Call emergency services","Evacuate immediately"],correctAnswer:1,userAnswer:1,isAnswered:!0},{id:"2",type:"multiple_choice",question:"How many emergency exits should be available in a training facility?",options:["At least 1","At least 2","At least 3","At least 4"],correctAnswer:1,userAnswer:null,isAnswered:!1},{id:"3",type:"practical",question:"Demonstrate the proper use of emergency equipment",description:"Show how to properly use fire extinguisher and emergency lighting",isCompleted:!1,score:null}],instructions:["Read each question carefully before answering","For practical assessments, ensure you have the required equipment","You have 120 minutes to complete this assessment","Save your progress regularly","Contact your instructor if you encounter any technical issues"]})}catch(p){console.error("Error loading section details:",p),c("Failed to load assessment section details"),ce.error("Failed to load assessment section details")}finally{o(!1)}},u=()=>{r("/trainee/your-assessments")},m=p=>{const g={PENDING:{variant:"warning",text:"Pending",icon:it},IN_PROGRESS:{variant:"info",text:"In Progress",icon:At},COMPLETED:{variant:"success",text:"Completed",icon:lt},OVERDUE:{variant:"danger",text:"Overdue",icon:yr}}[p]||{variant:"secondary",text:p,icon:At},v=g.icon;return a.jsxs(Pe,{bg:g.variant,className:"d-flex align-items-center",children:[a.jsx(v,{size:12,className:"me-1"}),g.text]})},f=()=>{ce.info("Starting assessment section...")},h=()=>{ce.info("Continuing assessment section...")};return i?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading assessment section..."})]})}):l||!s?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:l||"Assessment section not found"}),a.jsxs(se,{variant:"outline-danger",onClick:u,children:[a.jsx(Tt,{className:"me-2",size:16}),"Back to Assessments"]})]})}):a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(se,{variant:"outline-secondary",onClick:u,className:"me-3",children:a.jsx(Tt,{size:16})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-1 d-flex align-items-center",children:[a.jsx(At,{className:"me-2",size:28}),s.name]}),a.jsxs("p",{className:"text-muted mb-0",children:[s.course,"  ",s.subject]})]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[m(s.status),a.jsx(Pe,{bg:"info",className:"fw-normal",children:s.type})]})]})})}),a.jsxs(oe,{children:[a.jsx(H,{lg:8,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(At,{className:"me-2",size:20}),"Assessment Section Details"]})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{children:"Description"}),a.jsx("p",{className:"text-muted",children:s.description})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{children:"Instructions"}),a.jsx("ul",{className:"list-unstyled",children:s.instructions.map((p,x)=>a.jsxs("li",{className:"mb-2",children:[a.jsx("span",{className:"text-primary me-2",children:""}),p]},x))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{children:"Questions Overview"}),a.jsx("div",{className:"row",children:s.questions.map((p,x)=>a.jsx("div",{className:"col-md-6 mb-3",children:a.jsxs("div",{className:`p-3 border rounded ${p.isAnswered||p.isCompleted?"bg-light":""}`,children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("span",{className:"fw-semibold",children:["Question ",x+1]}),p.isAnswered||p.isCompleted?a.jsx(Pe,{bg:"success",className:"small",children:"Completed"}):a.jsx(Pe,{bg:"warning",className:"small",children:"Pending"})]}),a.jsx("p",{className:"mb-0 small text-muted",children:p.type==="practical"?"Practical Assessment":"Multiple Choice"})]})},p.id))})]}),a.jsx("div",{className:"d-flex justify-content-center",children:s.status==="PENDING"?a.jsxs(se,{variant:"primary",size:"lg",onClick:f,children:[a.jsx(lx,{className:"me-2",size:20}),"Start Assessment"]}):a.jsxs(se,{variant:"primary",size:"lg",onClick:h,children:[a.jsx(At,{className:"me-2",size:20}),"Continue Assessment"]})})]})]})}),a.jsx(H,{lg:4,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-white border-bottom",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(it,{className:"me-2",size:20}),"Assessment Information"]})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Time Limit"}),a.jsxs("div",{className:"text-muted",children:[s.timeLimit," minutes"]})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Due Date"}),a.jsx("div",{className:"text-muted",children:new Date(s.dueDate).toLocaleDateString()})]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(At,{className:"text-muted me-3",size:18}),a.jsxs("div",{children:[a.jsx("div",{className:"fw-semibold",children:"Total Questions"}),a.jsx("div",{className:"text-muted",children:s.questions.length})]})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("span",{className:"fw-semibold",children:"Progress"}),a.jsxs("span",{className:"text-muted",children:[s.progress,"%"]})]}),a.jsx(N0,{now:s.progress,variant:"primary",className:"mb-3"}),a.jsx("div",{className:"text-center",children:a.jsxs("small",{className:"text-muted",children:[s.questions.filter(p=>p.isAnswered||p.isCompleted).length," of ",s.questions.length," questions completed"]})})]}),a.jsxs("div",{className:"mt-4 p-3 bg-light rounded",children:[a.jsx("h6",{className:"mb-2",children:"Assessment Tips:"}),a.jsxs("ul",{className:"mb-0 small text-muted",children:[a.jsx("li",{children:"Read questions carefully"}),a.jsx("li",{children:"Manage your time wisely"}),a.jsx("li",{children:"Save progress regularly"}),a.jsx("li",{children:"Review answers before submitting"})]})]})]})]})})]})]})},qie=()=>{const{traineeId:e,sectionId:t}=Nr();return a.jsx(_e,{className:"py-3",children:a.jsx(Gie,{traineeId:e,sectionId:t})})},Kie=`
  .training-progress-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .training-progress-card .card-header h5 {
    color: #ffffff !important;
  }
  .assessments-card .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .assessments-card .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Kie,document.head.appendChild(e)}const R2=()=>{const e=Qe(),t=[{title:"Academic Details",description:"Track your learning progress and achievements",icon:Lt,path:"/trainee/academic-details",color:"primary"},{title:"Your Courses",description:"Check your enrolled courses and progress",icon:bt,path:"/trainee/enrolled-courses",color:"success"},{title:"All Assessments",description:"View pending assessments and tasks",icon:At,path:"/trainee/your-assessments",color:"warning"},{title:"Create Issue Report",description:"Report issues or provide feedback",icon:yr,path:"/trainee/create-incident-feedback-report",color:"danger"}];return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsx("h3",{className:"mb-3",children:"Quick Actions"})})}),a.jsx(oe,{children:t.map((r,s)=>{const n=r.icon;return a.jsx(H,{lg:6,xl:3,className:"mb-4",children:a.jsx(M,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(r.path),onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-5px)",i.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:a.jsxs(M.Body,{className:"p-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:`bg-${r.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:a.jsx(n,{size:24})}),a.jsx("div",{className:"flex-grow-1",children:a.jsx("h5",{className:"mb-1",children:r.title})}),a.jsx(on,{size:20,className:"text-muted"})]}),a.jsx("p",{className:"text-muted mb-0",children:r.description})]})})},s)})}),a.jsxs(oe,{className:"mt-4",children:[a.jsx(H,{lg:6,className:"d-flex",children:a.jsxs(M,{className:"border-0 shadow-sm w-100 training-progress-card",children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Training Progress"})}),a.jsx(M.Body,{className:"d-flex flex-column justify-content-center",children:a.jsxs("div",{className:"text-center py-4",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:"display-4 text-primary fw-bold",children:"0%"}),a.jsx("p",{className:"text-muted mb-0",children:"Overall Progress"})]}),a.jsx("div",{className:"progress mb-3",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:"0%"}})}),a.jsx("p",{className:"text-muted small mb-0",children:"Complete your enrolled courses to see progress."})]})})]})}),a.jsx(H,{lg:6,className:"d-flex",children:a.jsxs(M,{className:"border-0 shadow-sm w-100 assessments-card",children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Assessments Required Confirmations"})}),a.jsx(M.Body,{className:"d-flex flex-column justify-content-center",children:a.jsxs("div",{className:"text-center py-4",children:[a.jsx(At,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No assessments pending"}),a.jsx("p",{className:"text-muted small mb-3",children:"View and complete signature required assessments."}),a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>e("/trainee/signature-required"),className:"d-flex align-items-center justify-content-center mx-auto",children:[a.jsx(At,{size:16,className:"me-2"}),"Go to Assessments",a.jsx(on,{size:16,className:"ms-2"})]})]})})]})})]})]})},Yie=()=>{const e=Qe(),{user:t}=_s(),[r,s]=b.useState(!0),[n,i]=b.useState(null);b.useEffect(()=>{o()},[]);const o=async()=>{try{s(!0);const d={totalCourses:8,completedCourses:3,inProgressCourses:2,pendingCourses:3,totalAssessments:15,completedAssessments:8,pendingAssessments:7,overallProgress:65,courses:[{id:1,name:"Safety Procedures Training",code:"SAF001",progress:100,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations",code:"FLT002",progress:75,status:"in-progress",startDate:"2024-01-20"},{id:3,name:"Emergency Response",code:"EMG003",progress:45,status:"in-progress",startDate:"2024-02-01"},{id:4,name:"Technical Systems",code:"TECH004",progress:0,status:"pending",startDate:"2024-02-15"}],recentAssessments:[{id:1,name:"Safety Training Assessment",course:"Safety Procedures Training",score:95,status:"completed",completedDate:"2024-01-15"},{id:2,name:"Flight Operations Quiz",course:"Flight Operations",score:88,status:"completed",completedDate:"2024-01-25"},{id:3,name:"Emergency Response Test",course:"Emergency Response",score:null,status:"pending",dueDate:"2024-02-10"}]};await new Promise(u=>setTimeout(u,500)),i(d)}catch(d){console.error("Error loading academic data:",d)}finally{s(!1)}},l=d=>{switch(d){case"completed":return"success";case"in-progress":return"warning";case"pending":return"secondary";default:return"secondary"}},c=d=>{switch(d){case"completed":return a.jsx(lt,{className:"text-success"});case"in-progress":return a.jsx(it,{className:"text-warning"});case"pending":return a.jsx(it,{className:"text-muted"});default:return a.jsx(it,{className:"text-muted"})}};return r?a.jsx(_e,{className:"py-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading academic details..."})]})}):n?a.jsxs(_e,{className:"py-4 academic-details",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(se,{variant:"outline-secondary",size:"sm",className:"me-3",onClick:()=>e(-1),children:a.jsx(Tt,{size:16})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"Academic Details"}),a.jsx("p",{className:"text-muted mb-0",children:"Track your learning progress and achievements"})]})]})})}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{lg:3,md:6,className:"mb-3",children:a.jsx(M,{className:"border-0 shadow-sm h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(bt,{size:32,className:"text-primary mb-2"}),a.jsx("h4",{className:"mb-1",children:n.totalCourses}),a.jsx("p",{className:"text-muted mb-0",children:"Total Courses"})]})})}),a.jsx(H,{lg:3,md:6,className:"mb-3",children:a.jsx(M,{className:"border-0 shadow-sm h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(cN,{size:32,className:"text-success mb-2"}),a.jsx("h4",{className:"mb-1",children:n.completedCourses}),a.jsx("p",{className:"text-muted mb-0",children:"Completed"})]})})}),a.jsx(H,{lg:3,md:6,className:"mb-3",children:a.jsx(M,{className:"border-0 shadow-sm h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(it,{size:32,className:"text-warning mb-2"}),a.jsx("h4",{className:"mb-1",children:n.inProgressCourses}),a.jsx("p",{className:"text-muted mb-0",children:"In Progress"})]})})}),a.jsx(H,{lg:3,md:6,className:"mb-3",children:a.jsx(M,{className:"border-0 shadow-sm h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(At,{size:32,className:"text-info mb-2"}),a.jsx("h4",{className:"mb-1",children:n.completedAssessments}),a.jsx("p",{className:"text-muted mb-0",children:"Assessments Done"})]})})})]}),a.jsx(oe,{className:"mb-5",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Overall Learning Progress"})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"text-center mb-3",children:[a.jsxs("h2",{className:"text-primary mb-1",children:[n.overallProgress,"%"]}),a.jsx("p",{className:"text-muted mb-0",children:"Complete your courses to improve progress"})]}),a.jsx(N0,{now:n.overallProgress,variant:"primary",style:{height:"12px"},className:"mb-3"}),a.jsx(oe,{className:"text-center",children:a.jsx(H,{children:a.jsxs("small",{className:"text-muted",children:[n.completedCourses," of ",n.totalCourses," courses completed"]})})})]})]})})}),a.jsxs(oe,{className:"mt-4",children:[a.jsx(H,{lg:8,className:"mb-4 pe-3",children:a.jsxs(M,{className:"border-0 shadow-sm h-100",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(bt,{className:"me-2"}),"Course Progress"]})}),a.jsx(M.Body,{children:n.courses.map(d=>a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1",children:d.name}),a.jsx("small",{className:"text-muted",children:d.code})]}),a.jsx("div",{className:"d-flex align-items-center",children:a.jsx(Pe,{variant:l(d.status),children:d.status.replace("-"," ")})})]}),a.jsx(N0,{now:d.progress,variant:d.progress===100?"success":"primary",style:{height:"8px"}}),a.jsxs("div",{className:"d-flex justify-content-between mt-1",children:[a.jsxs("small",{className:"text-muted",children:[d.progress,"% complete"]}),d.status==="completed"&&a.jsxs("small",{className:"text-success",children:["Completed: ",new Date(d.completedDate).toLocaleDateString()]})]})]},d.id))})]})}),a.jsx(H,{lg:4,className:"mb-4 ps-3",children:a.jsxs(M,{className:"border-0 shadow-sm h-100",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(At,{className:"me-2"}),"Recent Assessments"]})}),a.jsx(M.Body,{children:n.recentAssessments.map(d=>a.jsxs("div",{className:"mb-3 pb-3 border-bottom",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[a.jsx("h6",{className:"mb-1",children:d.name}),c(d.status)]}),a.jsx("small",{className:"text-muted d-block mb-1",children:d.course}),d.status==="completed"?a.jsxs("div",{className:"d-flex justify-content-between",children:[a.jsxs(Pe,{variant:"success",children:["Score: ",d.score]}),a.jsx("small",{className:"text-muted",children:new Date(d.completedDate).toLocaleDateString()})]}):a.jsxs("div",{className:"d-flex justify-content-between",children:[a.jsx(Pe,{variant:"warning",children:"Pending"}),a.jsxs("small",{className:"text-muted",children:["Due: ",new Date(d.dueDate).toLocaleDateString()]})]})]},d.id))})]})})]})]}):a.jsx(_e,{className:"py-4",children:a.jsx(Re,{variant:"danger",children:"Failed to load academic details. Please try again later."})})},Xie=()=>{const{user:e}=_s();return e?a.jsx(_e,{className:"py-3",children:a.jsx(Yie,{})}):a.jsx(_e,{className:"py-3",children:a.jsx("div",{className:"text-center",children:a.jsx("p",{children:"Please log in to view your academic details."})})})},F2=({uniqueLevels:e,uniqueStatuses:t,selectedLevels:r,selectedStatuses:s,onLevelToggle:n,onStatusToggle:i,onClearFilters:o,className:l=""})=>{const c=r.length>0||s.length>0;return a.jsxs($t,{className:`filter-panel-dropdown course-filter-dropdown ${l}`,children:[a.jsx($t.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Li,{size:14,className:"me-2"}),"Filters",c&&a.jsx("span",{className:"badge bg-primary ms-2",children:r.length+s.length})]})}),a.jsxs($t.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Levels"}),r.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>n("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(d=>a.jsx(k.Check,{type:"checkbox",id:`level-${d}`,label:d,checked:r.includes(d),onChange:()=>n(d),className:"mb-1"},d))})]}),a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Statuses"}),s.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>i("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(d=>a.jsx(k.Check,{type:"checkbox",id:`status-${d}`,label:d,checked:s.includes(d),onChange:()=>i(d),className:"mb-1"},d))})]}),c&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:o,children:[a.jsx(Ze,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},Ck=document.createElement("style");Ck.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(Ck);const Jie=`
  .course-list-table-no-borders .table,
  .course-list-table-no-borders .table td,
  .course-list-table-no-borders .table th,
  .course-list-table-no-borders .table tbody tr,
  .course-list-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .course-list-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .course-list-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=Jie,document.head.appendChild(e)}const Zie=({traineeId:e})=>{const t=Qe(),[r,s]=b.useState([]),[n,i]=b.useState(!0),[o,l]=b.useState(""),[c,d]=b.useState([]),[u,m]=b.useState([]),[f,h]=b.useState("upcoming"),p=[...new Set(r.map(_=>_.level).filter(Boolean))],x=[...new Set(r.map(_=>_.status).filter(Boolean))],g=_=>r.filter(D=>{switch(_){case"upcoming":return D.status==="PLANNED";case"ongoing":return D.status==="ON-GOING";case"completed":return D.status==="COMPLETED";default:return!0}}),v=g(f),w=b.useMemo(()=>v.filter(_=>{const D=!o||_.name.toLowerCase().includes(o.toLowerCase())||_.code.toLowerCase().includes(o.toLowerCase())||_.description.toLowerCase().includes(o.toLowerCase()),W=c.length===0||c.includes(_.level),K=u.length===0||u.includes(_.status);return D&&W&&K}),[v,o,c,u]),{sortedData:y,sortConfig:S,handleSort:E}=Zt(w);b.useEffect(()=>{e&&N()},[e]);const N=async()=>{try{i(!0);const _=[{id:"1",code:"SAF001",name:"Safety Procedures Training",description:"Basic safety procedures and emergency protocols",level:"BEGINNER",status:"ON-GOING",startDate:"2024-01-15T09:00:00.000Z",endDate:"2024-03-15T17:00:00.000Z",progress:75,department:{id:1,name:"Safety Department",code:"SAF"}},{id:"2",code:"FLT002",name:"Flight Operations",description:"Advanced flight operations and navigation",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-02-01T08:00:00.000Z",endDate:"2024-04-01T16:00:00.000Z",progress:45,department:{id:2,name:"Flight Operations",code:"FO"}},{id:"3",code:"EMG003",name:"Emergency Response",description:"Emergency response and crisis management",level:"ADVANCED",status:"COMPLETED",startDate:"2023-11-01T09:00:00.000Z",endDate:"2023-12-15T17:00:00.000Z",progress:100,department:{id:3,name:"Emergency Services",code:"EMG"}},{id:"4",code:"TECH004",name:"Technical Systems",description:"Aircraft technical systems and maintenance",level:"INTERMEDIATE",status:"PLANNED",startDate:"2024-03-01T09:00:00.000Z",endDate:"2024-05-01T17:00:00.000Z",progress:0,department:{id:4,name:"Technical Department",code:"TECH"}},{id:"5",code:"NAV005",name:"Navigation Systems",description:"Advanced navigation and GPS systems",level:"ADVANCED",status:"COMPLETED",startDate:"2023-09-01T09:00:00.000Z",endDate:"2023-10-15T17:00:00.000Z",progress:100,department:{id:5,name:"Navigation Department",code:"NAV"}},{id:"6",code:"COMM006",name:"Communication Protocols",description:"Radio communication and protocols",level:"BEGINNER",status:"PLANNED",startDate:"2024-04-01T09:00:00.000Z",endDate:"2024-06-01T17:00:00.000Z",progress:0,department:{id:6,name:"Communication Department",code:"COMM"}},{id:"7",code:"MAINT007",name:"Aircraft Maintenance",description:"Routine maintenance procedures",level:"INTERMEDIATE",status:"ON-GOING",startDate:"2024-01-20T08:00:00.000Z",endDate:"2024-03-20T16:00:00.000Z",progress:60,department:{id:7,name:"Maintenance Department",code:"MAINT"}},{id:"8",code:"ARCH008",name:"Archived Course",description:"This course has been archived",level:"BEGINNER",status:"ARCHIVED",startDate:"2023-06-01T09:00:00.000Z",endDate:"2023-08-01T17:00:00.000Z",progress:100,department:{id:8,name:"Archived Department",code:"ARCH"}}];await new Promise(D=>setTimeout(D,300)),s(_)}catch(_){console.error("Error loading trainee courses:",_),ce.error("Failed to load enrolled courses")}finally{i(!1)}},j=_=>{const W={"ON-GOING":{variant:"success",text:"On-going"},ARCHIVED:{variant:"secondary",text:"Archived"},PLANNED:{variant:"info",text:"Planned"},COMPLETED:{variant:"primary",text:"Completed"}}[_]||{variant:"secondary",text:_};return a.jsx(Pe,{bg:W.variant,children:W.text})},T=_=>{const W={BEGINNER:{variant:"success",text:"Beginner"},INTERMEDIATE:{variant:"warning",text:"Intermediate"},ADVANCED:{variant:"danger",text:"Advanced"}}[_]||{variant:"secondary",text:_};return a.jsx(Pe,{bg:W.variant,children:W.text})},C=_=>{t(`/trainee/${e}/course/${_.id}`)},L=_=>{d(_==="clear"?[]:D=>D.includes(_)?D.filter(W=>W!==_):[...D,_])},A=_=>{m(_==="clear"?[]:D=>D.includes(_)?D.filter(W=>W!==_):[...D,_])},P=()=>{d([]),m([]),l("")},I=({columnKey:_,children:D,className:W=""})=>{const K=S.key===_,J=K?S.direction:null;return a.jsxs("th",{className:`fw-semibold ${W}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>E(_),onMouseEnter:F=>{F.target.style.backgroundColor="#214760",F.target.style.transform="translateY(-1px)",F.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:F=>{F.target.style.backgroundColor="var(--bs-primary)",F.target.style.transform="translateY(0)",F.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:K?"600":"500",color:"white"},children:D}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:J,size:14,color:"white"})})]}),K&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return n?a.jsx(Wt,{rows:5,columns:8}):r.length===0?a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No enrolled courses"}),a.jsx("p",{children:"You are not enrolled in any courses yet."})]})}):w.length===0&&(o||c.length>0||u.length>0)?a.jsx("div",{children:a.jsxs(Vt.Container,{activeKey:f,onSelect:h,children:[a.jsxs(St,{variant:"tabs",className:"mb-3",children:[a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"upcoming",className:"d-flex align-items-center",children:[a.jsx(it,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"ongoing",className:"d-flex align-items-center",children:[a.jsx(Eh,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"completed",className:"d-flex align-items-center",children:[a.jsx(lt,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]}),a.jsx(Vt.Content,{children:a.jsxs(Vt.Pane,{eventKey:f,children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(F2,{uniqueLevels:p,uniqueStatuses:x,selectedLevels:c,selectedStatuses:u,onLevelToggle:L,onStatusToggle:A,onClearFilters:P,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No courses found"}),a.jsx("p",{children:"Try adjusting your search criteria or filters."}),a.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:P,children:"Clear Filters"})]})})]})})]})}):a.jsx("div",{children:a.jsxs(Vt.Container,{activeKey:f,onSelect:h,children:[a.jsxs(St,{variant:"tabs",className:"mb-3",children:[a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"upcoming",className:"d-flex align-items-center",children:[a.jsx(it,{className:"me-2",size:16}),"Upcoming (",g("upcoming").length,")"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"ongoing",className:"d-flex align-items-center",children:[a.jsx(Eh,{className:"me-2",size:16}),"On-going (",g("ongoing").length,")"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"completed",className:"d-flex align-items-center",children:[a.jsx(lt,{className:"me-2",size:16}),"Completed (",g("completed").length,")"]})})]}),a.jsx(Vt.Content,{children:a.jsxs(Vt.Pane,{eventKey:f,children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search courses by name, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(F2,{uniqueLevels:p,uniqueStatuses:x,selectedLevels:c,selectedStatuses:u,onLevelToggle:L,onStatusToggle:A,onClearFilters:P,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[w.length," course",w.length!==1?"s":""]})})})]}),a.jsx("div",{className:"scrollable-table-container admin-table course-list-table-no-borders",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(I,{columnKey:"code",className:"show-mobile",children:"Course Code"}),a.jsx(I,{columnKey:"name",className:"show-mobile",children:"Course Name"}),a.jsx(I,{columnKey:"level",className:"show-mobile",children:"Level"}),a.jsx(I,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(I,{columnKey:"startDate",className:"hide-mobile",children:"Start Date"}),a.jsx(I,{columnKey:"endDate",className:"hide-mobile",children:"End Date"}),a.jsx(I,{columnKey:"progress",className:"show-mobile",children:"Progress"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:y.map((_,D)=>a.jsxs("tr",{className:`${D%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:W=>{W.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:W=>{W.currentTarget.style.backgroundColor=D%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsx(Pe,{bg:"primary",className:"px-2 py-1",style:{fontSize:"0.75rem"},children:_.code})}),a.jsxs("td",{className:"border-neutral-200 align-middle show-mobile",children:[a.jsx("div",{className:"fw-medium text-dark",children:_.name}),a.jsx("small",{className:"text-muted",children:_.description})]}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:T(_.level)}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:j(_.status)}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:_.startDate?new Date(_.startDate).toLocaleDateString():"N/A"})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-dark",children:_.endDate?new Date(_.endDate).toLocaleDateString():"N/A"})}),a.jsx("td",{className:"border-neutral-200 align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${_.progress||0}%`}})}),a.jsxs("small",{className:"text-muted",children:[_.progress||0,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.COURSES.VIEW_DETAIL],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Course Details",icon:a.jsx(Nt,{}),onClick:()=>C(_),permission:Ne.COURSES.VIEW_DETAIL}]})})})]},_.id))})]})})]})})]})})},Qie=()=>{const{user:e}=_s();return e?a.jsx(_e,{className:"py-3",children:a.jsx(Zie,{traineeId:e.id})}):a.jsx(_e,{className:"py-3",children:a.jsx("div",{className:"text-center",children:a.jsx("p",{children:"Please log in to view your enrolled courses."})})})},eoe=({show:e,onHide:t,onImportSuccess:r,onImportError:s})=>{const n=Qe(),[i,o]=b.useState("with-fields"),[l,c]=b.useState(null),[d,u]=b.useState(!1),[m,f]=b.useState({name:"",description:"",departmentId:""}),[h,p]=b.useState([]),[x,g]=b.useState(!1),v=b.useRef(null);b.useEffect(()=>{e&&w()},[e]);const w=async()=>{try{g(!0);const N=await Ft.getDepartments(),j=N.departments||N.data||[];p(j)}catch(N){console.error("Error loading departments:",N),ce.error("Failed to load departments"),p([])}finally{g(!1)}},y=N=>{const j=N.target.files[0];if(j){const T=[".docx"],C=j.name.toLowerCase().substring(j.name.lastIndexOf("."));if(!T.includes(C)){ce.error("Please select a valid Word document file (.docx)");return}if(j.size>10*1024*1024){ce.error("File size must be less than 10MB");return}c(j)}},S=async()=>{if(!l){ce.error("Please select a file to import");return}u(!0);try{const N=Ed.getDocsType(l.name),j=await Ed.uploadDocument(l,N);let T;if(j.data&&j.data.length>0&&j.data[0].url)T=j.data[0].url,console.log(` Form Template Upload Success! Document URL: ${T}`);else throw new Error("Invalid response format from upload API");if(i==="with-fields")n("/admin/forms/editor",{state:{documentUrl:T,fileName:l.name.replace(".docx",""),importType:"File with fields"}}),E(),r("File with fields",l.name);else{const C={name:m.name,description:m.description,departmentId:m.departmentId,templateContent:T,fileName:l.name.replace(".docx",""),importType:"File without fields",createdAt:new Date().toISOString()};localStorage.setItem("templateInfo",JSON.stringify(C)),console.log(" Template info saved to localStorage:",C),n("/admin/forms/editor",{state:{documentUrl:T,fileName:C.fileName,importType:"File without fields",templateInfo:C}}),E(),r("File without fields",l.name)}}catch(N){s(N.message||"Import failed")}finally{u(!1)}},E=()=>{c(null),o("with-fields"),f({name:"",description:"",departmentId:""}),v.current&&(v.current.value=""),t()};return a.jsxs(ue,{show:e,onHide:E,size:"lg",centered:!0,className:"import-file-modal",dialogClassName:"import-file-modal-dialog",children:[a.jsx(ue.Header,{className:"bg-primary-custom text-white border-0",closeButton:!0,closeVariant:"white",children:a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Ts,{className:"me-2",size:20}),"Import Form File"]})}),a.jsxs(ue.Body,{className:"p-3 p-md-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"text-primary-custom mb-3",children:"Select Import Type"}),a.jsxs(oe,{className:"g-3 import-type-row",children:[a.jsx(H,{xs:12,sm:12,md:6,className:"import-type-col",children:a.jsx(M,{className:`import-type-card ${i==="with-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("with-fields"),style:{cursor:"pointer"},children:a.jsx(M.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:a.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[a.jsx(Su,{size:48,className:"text-primary mb-3"}),a.jsx("h6",{className:"text-primary mb-2",children:"File with Fields"}),a.jsx("p",{className:"text-muted small mb-0",children:"Import a Word document that already contains predefined form fields and structure. The system will automatically parse and create form templates."})]})})})}),a.jsx(H,{xs:12,sm:12,md:6,className:"import-type-col",children:a.jsx(M,{className:`import-type-card ${i==="without-fields"?"border-primary bg-light":"border-secondary"}`,onClick:()=>o("without-fields"),style:{cursor:"pointer"},children:a.jsx(M.Body,{className:"text-center p-3 p-md-4 d-flex flex-column",children:a.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center",children:[a.jsx(Nd,{size:48,className:"text-success mb-3"}),a.jsx("h6",{className:"text-success mb-2",children:"File without Fields"}),a.jsx("p",{className:"text-muted small mb-0",children:"Import a raw Word document without predefined structure. You will manually define form fields and mapping after import."})]})})})})]})]}),!i&&a.jsxs(Re,{variant:"info",className:"mb-4",children:[a.jsx("h6",{className:"text-primary-custom mb-2",children:"Please select an import type"}),a.jsx("p",{className:"mb-0 small",children:'Choose between "File with Fields" or "File without Fields" above to continue with the import process.'})]}),i==="without-fields"&&a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"text-primary-custom mb-3",children:"Fill in Basic Template Information"}),a.jsx(k,{children:a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Template Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"e.g., Flight Training Assessment Form",value:m.name,onChange:N=>f(j=>({...j,name:N.target.value})),required:!0})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Description ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{as:"textarea",rows:3,placeholder:"e.g., Comprehensive flight training evaluation form with competency assessment",value:m.description,onChange:N=>f(j=>({...j,description:N.target.value})),required:!0})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Department ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(k.Select,{value:m.departmentId,onChange:N=>f(j=>({...j,departmentId:N.target.value})),required:!0,disabled:x,children:[a.jsx("option",{value:"",children:"Select Department"}),h.map(N=>a.jsx("option",{value:N.id,children:N.name},N.id))]}),x&&a.jsx(k.Text,{className:"text-muted",children:"Loading departments..."}),m.templateContent&&a.jsxs(k.Text,{className:"text-muted",children:["Template Content: ",m.templateContent]})]})})]})})]}),i&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h6",{className:"text-primary-custom mb-3",children:"Select File"}),a.jsxs(k.Group,{children:[a.jsx(k.Control,{ref:v,type:"file",accept:".docx",onChange:y,className:"mb-2"}),a.jsx(k.Text,{className:"text-muted",children:"Supported format: Word document (.docx). Maximum file size: 10MB"})]})]}),l&&a.jsx(Re,{variant:"info",className:"mb-4",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Nd,{className:"me-2",size:20}),a.jsxs("div",{children:[a.jsx("strong",{children:"Selected File:"})," ",l.name,a.jsx("br",{}),a.jsxs("small",{className:"text-muted",children:["Size: ",(l.size/1024/1024).toFixed(2)," MB"]})]})]})})]})]}),a.jsxs(ue.Footer,{className:"border-0 p-3 p-md-3 d-flex flex-column flex-md-row gap-2 gap-md-2 justify-content-end",children:[a.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:E,disabled:d,className:"w-100 w-md-auto order-2 order-md-1",children:[a.jsx(Ze,{className:"me-2",size:14}),"Cancel"]}),i==="with-fields"&&a.jsx(se,{variant:"primary-custom",size:"sm",onClick:S,disabled:!l||d,className:"w-100 w-md-auto order-1 order-md-2",children:d?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.875rem",height:"0.875rem"}}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ts,{className:"me-2",size:14}),"Import File"]})}),i==="without-fields"&&a.jsx(se,{variant:"primary-custom",size:"sm",onClick:S,disabled:!l||!m.name||!m.description||!m.departmentId||d,className:"w-100 w-md-auto order-1 order-md-2",children:d?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.875rem",height:"0.875rem"}}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ts,{className:"me-2",size:14}),"Import File"]})})]})]})},toe=({show:e,onHide:t,template:r})=>{const[s,n]=b.useState("overview");if(!r)return null;const i=u=>{if(!u)return"N/A";try{return new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return u}},o=u=>{const m={PENDING:{variant:"warning",icon:it,text:"PENDING"},PUBLISHED:{variant:"success",icon:lt,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:nr,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:nr,text:"ARCHIVED"}},f=m[u]||m.DRAFT,h=f.icon;return a.jsxs(Pe,{bg:f.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[a.jsx(h,{size:12}),f.text]})},l=()=>r.templateSchema?a.jsx("div",{className:"schema-preview",children:a.jsx("pre",{className:"bg-light p-3 rounded",style:{fontSize:"0.85rem",maxHeight:"400px",overflow:"auto"},children:JSON.stringify(r.templateSchema,null,2)})}):a.jsx("p",{className:"text-muted",children:"No schema data available"}),c=()=>a.jsxs("div",{className:"template-overview",children:[a.jsxs(oe,{className:"g-3 mb-4",children:[a.jsx(H,{md:6,children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(nr,{className:"text-primary-custom me-2",size:20}),a.jsx("h6",{className:"mb-0",children:"Template Name"})]}),a.jsx("p",{className:"mb-0 fw-bold",children:r.name})]})})}),a.jsx(H,{md:6,children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(ka,{className:"text-primary-custom me-2",size:20}),a.jsx("h6",{className:"mb-0",children:"Department"})]}),a.jsx("p",{className:"mb-0",children:r.department?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:r.department?.code||""})]})})})]}),a.jsx(M,{className:"border-0 shadow-sm mb-3",children:a.jsxs(M.Body,{children:[a.jsx("h6",{className:"mb-3",children:"Description"}),a.jsx("p",{className:"text-muted mb-0",children:r.description||"No description provided"})]})}),a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:4,children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(lt,{className:"text-primary-custom me-2",size:20}),a.jsx("h6",{className:"mb-0",children:"Status"})]}),o(r.status)]})})}),a.jsx(H,{md:4,children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(nr,{className:"text-primary-custom me-2",size:20}),a.jsx("h6",{className:"mb-0",children:"Version"})]}),a.jsxs("p",{className:"mb-0 fw-bold",children:["v",r.version]})]})})}),a.jsx(H,{md:4,children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(nr,{className:"text-primary-custom me-2",size:20}),a.jsx("h6",{className:"mb-0",children:"Sections"})]}),a.jsx("p",{className:"mb-0 fw-bold",children:r._count?.sections||0})]})})})]}),a.jsxs(oe,{className:"g-3 mt-3",children:[a.jsx(H,{md:6,children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(Lt,{className:"text-primary-custom me-2",size:20}),a.jsx("h6",{className:"mb-0",children:"Created By"})]}),a.jsxs("p",{className:"mb-0",children:[r.createdByUser?.firstName," ",r.createdByUser?.lastName]}),a.jsx("small",{className:"text-muted",children:i(r.createdAt)})]})})}),r.reviewedByUserId&&a.jsx(H,{md:6,children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsxs(M.Body,{children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(lt,{className:"text-primary-custom me-2",size:20}),a.jsx("h6",{className:"mb-0",children:"Reviewed"})]}),a.jsx("p",{className:"mb-0",children:i(r.reviewedAt)})]})})})]})]}),d=()=>r.templateContent&&r.templateContent.startsWith("http")?a.jsxs("div",{className:"content-preview",children:[a.jsxs("div",{className:"alert alert-info",children:[a.jsx(Nu,{className:"me-2"}),"Template content is stored as a file.",a.jsx("a",{href:r.templateContent,target:"_blank",rel:"noopener noreferrer",className:"ms-2",children:"View/Download File"})]}),a.jsx("iframe",{src:r.templateContent,style:{width:"100%",height:"600px",border:"1px solid #ddd",borderRadius:"4px"},title:"Template Content Preview"})]}):a.jsx("div",{className:"content-preview",children:a.jsx("div",{className:"border rounded p-4 bg-white",style:{minHeight:"400px"},dangerouslySetInnerHTML:{__html:r.templateContent||'<p class="text-muted">No content available</p>'}})});return a.jsxs(ue,{show:e,onHide:t,size:"xl",centered:!0,className:"template-preview-modal",children:[a.jsxs(ue.Header,{className:"bg-gradient-primary-custom text-white border-0",children:[a.jsxs(ue.Title,{className:"d-flex align-items-center",children:[a.jsx(Nt,{className:"me-2",size:20}),"Template Preview: ",r.name]}),a.jsx(se,{variant:"link",onClick:t,className:"text-white p-0 ms-auto",style:{border:"none",background:"none"},children:a.jsx(Ze,{size:24})})]}),a.jsx(ue.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:a.jsxs(Vt.Container,{activeKey:s,onSelect:n,children:[a.jsxs(St,{variant:"tabs",className:"mb-3",children:[a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"overview",children:[a.jsx(nr,{className:"me-2",size:16}),"Overview"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"content",children:[a.jsx(Nt,{className:"me-2",size:16}),"Content Preview"]})}),a.jsx(St.Item,{children:a.jsxs(St.Link,{eventKey:"schema",children:[a.jsx(X2,{className:"me-2",size:16}),"Schema"]})})]}),a.jsxs(Vt.Content,{children:[a.jsx(Vt.Pane,{eventKey:"overview",children:c()}),a.jsx(Vt.Pane,{eventKey:"content",children:d()}),a.jsx(Vt.Pane,{eventKey:"schema",children:l()})]})]})}),a.jsxs(ue.Footer,{className:"bg-light border-0",children:[a.jsx(se,{variant:"outline-secondary",onClick:t,children:"Close"}),r.templateContent&&r.templateContent.startsWith("http")&&a.jsxs(se,{variant:"primary-custom",href:r.templateContent,target:"_blank",rel:"noopener noreferrer",children:[a.jsx(Fi,{className:"me-2",size:16}),"Download File"]})]})]})},roe=()=>{const[e,t]=b.useState(!1),[r,s]=b.useState([]),[n,i]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState(!1);b.useEffect(()=>{u()},[]);const u=async()=>{try{i(!0);const v=await jD.getTemplates();v.success&&v.data?s(v.data):Array.isArray(v)?s(v):v.data&&Array.isArray(v.data)?s(v.data):s([])}catch(v){console.error("Error loading templates:",v),ce.error("Failed to load templates"),s([])}finally{i(!1)}},m=()=>{t(!0)},f=(v,w)=>{t(!1),u()},h=v=>{ce.error(`Import failed: ${v}`,{icon:!1})},p=v=>{l(v),d(!0)},x=v=>{const w={PENDING:{variant:"warning",icon:it,text:"PENDING"},PUBLISHED:{variant:"success",icon:lt,text:"PUBLISHED"},DRAFT:{variant:"secondary",icon:nr,text:"DRAFT"},ARCHIVED:{variant:"dark",icon:nr,text:"ARCHIVED"}},y=w[v]||w.DRAFT,S=y.icon;return a.jsxs(Pe,{bg:y.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[a.jsx(S,{size:12}),y.text]})},g=v=>{if(!v)return"N/A";try{return new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return v}};return a.jsx(_e,{fluid:!0,className:"py-4 forms-page form-component",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"border-neutral-200 forms-page-header",style:{backgroundColor:"#1b3c53"},children:a.jsxs(oe,{className:"align-items-center",children:[a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"me-2 text-white",size:24}),a.jsx("h4",{className:"mb-0 text-white",children:"Form Templates"})]})}),a.jsx(H,{xs:"auto",children:a.jsx(wr,{permission:Ne.TEMPLATES.CREATE,fallback:null,children:a.jsxs(se,{variant:"primary-custom",onClick:m,className:"d-flex align-items-center",size:"sm",children:[a.jsx(Ts,{className:"me-2",size:16}),"Create New Template"]})})})]})}),a.jsxs(M.Body,{children:[n?a.jsx(Wt,{}):r.length===0?a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Nd,{size:64,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No form templates found"}),a.jsx("p",{className:"text-muted mb-4",children:"Get started by creating a new form or importing an existing file."})]})})}):a.jsx(oe,{className:"g-4",children:r.map(v=>a.jsx(H,{xs:12,sm:6,md:4,lg:3,children:a.jsx(M,{className:"h-100 border-0 shadow-sm template-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>p(v),onMouseEnter:w=>{w.currentTarget.style.transform="translateY(-5px)",w.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:w=>{w.currentTarget.style.transform="translateY(0)",w.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:a.jsxs(M.Body,{className:"p-3",children:[a.jsx("div",{className:"d-flex align-items-start justify-content-between mb-2",children:a.jsxs("div",{className:"d-flex align-items-center flex-grow-1",children:[a.jsx("div",{className:"bg-primary-custom text-white rounded d-flex align-items-center justify-content-center me-2",style:{width:"40px",height:"40px",minWidth:"40px"},children:a.jsx(nr,{size:20})}),a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0},children:[a.jsx("h6",{className:"mb-0 fw-bold text-truncate",style:{fontSize:"0.95rem"},title:v.name,children:v.name}),a.jsxs("small",{className:"text-muted",children:["v",v.version]})]})]})}),a.jsx("p",{className:"text-muted mb-2",style:{fontSize:"0.85rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",minHeight:"2.5em"},title:v.description,children:v.description||"No description"}),a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(ka,{size:12,className:"text-muted me-1"}),a.jsx("small",{className:"text-muted",children:v.department?.code||"N/A"})]}),x(v.status)]}),a.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:12,className:"text-muted me-1"}),a.jsxs("small",{className:"text-muted",children:[v.createdByUser?.firstName," ",v.createdByUser?.lastName]})]}),a.jsx("small",{className:"text-muted",children:g(v.createdAt)})]}),a.jsx("div",{className:"mt-2 pt-2 border-top",children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[a.jsxs("small",{className:"text-muted",children:[a.jsx(nr,{size:12,className:"me-1"}),v._count?.sections||0," sections"]}),a.jsxs(se,{variant:"link",size:"sm",className:"p-0 text-primary-custom",onClick:w=>{w.stopPropagation(),p(v)},children:[a.jsx(Nt,{size:14,className:"me-1"}),"Preview"]})]})})]})})},v.id))}),a.jsx(eoe,{show:e,onHide:()=>t(!1),onImportSuccess:f,onImportError:h}),a.jsx(toe,{show:c,onHide:()=>{d(!1),l(null)},template:o})]})]})})};function soe(){try{const e=localStorage.getItem("templateInfo");if(e){const t=JSON.parse(e);return{name:t.name||"",description:t.description||"",departmentId:t.departmentId||"",templateContent:t.templateContent||""}}}catch{}return{name:localStorage.getItem("templateName")||"",description:localStorage.getItem("templateDesc")||"",departmentId:localStorage.getItem("departmentId")||"",templateContent:localStorage.getItem("templateContent")||""}}function aoe(e,t){const r=(t||[]).map((s,n)=>{const i=s.fields||[],o={};for(const f of i)if(String(f.fieldType||"").toUpperCase()==="PART"){const h=f.fieldName||"",p=f.tempId||(h?`${h}-parent`:void 0);p&&(o[h]=p)}const c=i.map(f=>{const h=f.parentTempId;return h&&o[h]?{...f,parentTempId:o[h]}:f}).map((f,h)=>({...f,__idx:h})),d=c.filter(f=>!f.parentTempId).sort((f,h)=>f.__idx-h.__idx),u=[];for(const f of d){u.push(f);const h=String(f.fieldType||"").toUpperCase()==="PART"?f.tempId||o[f.fieldName]||(f.fieldName?`${f.fieldName}-parent`:void 0):null;if(h){const p=c.filter(x=>x.parentTempId===h).sort((x,g)=>x.__idx-g.__idx);u.push(...p)}}if(u.length!==c.length){const f=new Set(u.map(h=>h.__idx));c.filter(h=>!f.has(h.__idx)).sort((h,p)=>h.__idx-p.__idx).forEach(h=>u.push(h))}const m=u.map((f,h)=>{const p=String(f.fieldType||"").toUpperCase().startsWith("SIGNATURE"),x={label:f.label,fieldName:f.fieldName,fieldType:f.fieldType,displayOrder:h+1,parentTempId:f.parentTempId?f.parentTempId:null};if(p&&(x.roleRequired=f.roleRequired||"TRAINER"),String(f.fieldType||"").toUpperCase()==="PART"){const g=f.fieldName||"";x.tempId=f.tempId||(g?`${g}-parent`:void 0)}return x});return{name:s.name,label:s.label,displayOrder:n+1,editBy:s.editBy||"TRAINER",roleInSubject:s.roleInSubject?s.roleInSubject:null,isSubmittable:!!s.isSubmittable,isToggleDependent:!!s.isToggleDependent,fields:m}});return{name:e.name,description:e.description,departmentId:e.departmentId,templateContent:e.templateContent,templateConfig:e.templateConfig||null,sections:r}}const noe=({customFields:e=[],onAddField:t,onRemoveField:r,onInsertField:s,exportEditedDoc:n,exportAndUploadEditedDoc:i,forceSaveAndPoll:o,getDocumentKey:l,readOnly:c=!1,className:d=""})=>{const[u,m]=b.useState([]),[f,h]=b.useState({}),[p,x]=b.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),[g,v]=b.useState({fromIndex:null,overIndex:null,position:"above"}),[w,y]=b.useState(!1),[S,E]=b.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[N,j]=b.useState(["TRAINER","TRAINEE"]),[T,C]=b.useState(!1),[L,A]=b.useState(!1),[P,I]=b.useState(null),[_,D]=b.useState(null),[W,K]=b.useState({label:"",fieldName:"",fieldType:"TEXT",roleRequired:"TRAINER",parentTempId:null});b.useEffect(()=>{e&&e.length>0&&u.length===0&&m([{name:"Default",label:"Default",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[...e]}])},[]);const J=()=>{E({name:"",label:"",displayOrder:u.length+1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),y(!0)},F=be=>{h(Se=>({...Se,[be]:!Se[be]}))},le=(be,Se,De)=>{Se===null||De===null||Se===De||m(st=>{const ut=[...st],Ye=[...ut[be]?.fields||[]],[Ht]=Ye.splice(Se,1);if(Ye.splice(De,0,Ht),ut[be]={...ut[be],fields:Ye},t){const Ce=ut.flatMap(pt=>pt.fields||[]);t(Ce,{silent:!0})}return ut})},Ae=(be,Se)=>{be===null||Se===null||be===Se||m(De=>{const st=[...De],[ut]=st.splice(be,1);return st.splice(Se,0,ut),st})},O=()=>{if(!S.label){ce.warning("Please fill in section label");return}const be={...S,name:S.label,roleInSubject:S.editBy==="TRAINEE"?null:S.roleInSubject||null};m(Se=>[...Se,be]),y(!1)};b.useEffect(()=>{w&&(async()=>{try{const Se=await ys.getRoles(),st=(Array.isArray(Se?.roles)?Se.roles:Array.isArray(Se)?Se:[]).map(Ye=>typeof Ye=="string"?Ye:Ye.name||Ye.code||Ye.roleName||"").filter(Ye=>typeof Ye=="string").map(Ye=>Ye.toUpperCase()).filter(Ye=>Ye.includes("TRAINER")||Ye.includes("TRAINEE")).map(Ye=>Ye.includes("TRAINER")?"TRAINER":"TRAINEE"),ut=Array.from(new Set(st));ut.length>0&&j(ut)}catch{}})()},[w]);const G=be=>{const De=u[be]?.editBy||"TRAINER";K({label:"",fieldName:"",fieldType:"TEXT",roleRequired:De,displayOrder:1,parentTempId:null}),I(be),C(!0)},U=(be,Se)=>{if(!be)return{valid:!1,message:"Field name is required"};const De=String(Se||"").toUpperCase();return De==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(be)?be.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:De==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(be)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(be)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},B=()=>{if(!W.label||!W.fieldName){ce.warning("Please fill in all required fields");return}const be=U(W.fieldName,W.fieldType);if(!be.valid){ce.warning(be.message);return}if(P===null||P<0||P>=u.length){ce.warning("Please choose a section");return}const Se=u[P].fields||[];if((_!==null?Se.filter((ut,Ye)=>Ye!==_):Se).some(ut=>ut.fieldName===W.fieldName)){ce.warning("Field name must be unique");return}const st=[...u];if(_!==null?st[P].fields=[...Se.slice(0,_),W,...Se.slice(_+1)]:st[P].fields=[...Se,{...W}],m(st),t){const ut=st.flatMap(Ye=>Ye.fields||[]);t(ut)}C(!1),A(!1),I(null),D(null)},Y=(be,Se)=>{const De=u[be]?.fields?.[Se];De&&(K({...De}),I(be),D(Se),A(!0))},te=()=>{C(!1),A(!1),y(!1),I(null),D(null)},[ae,ne]=b.useState(!1),fe=async()=>{try{ne(!0);const be=soe(),Se=l?l():null;console.log(" DocumentKey for this session:",Se);let De=null;const st=be.templateContent;if(console.log(" Original templateContent (file import):",st),console.log(" Callback URL configured:",`${$a.BASE_URL}/media/docs/onlyoffice/callback`),console.log(""),console.log(""),console.log(" CALLBACK BODY INFO (for backend comparison):"),console.log(""),console.log(" LU : y l body MONG I, khng phi body thc t!"),console.log(" Body thc t ch c th thy trong Backend logs"),console.log(""),Se){const Ce={key:Se,status:6,url:"https://documentserver/url-to-edited-document.docx"};console.log(" Expected Callback Body (JSON format -  tham kho):"),console.log(JSON.stringify(Ce,null,2)),console.log(""),console.log(" Expected Callback Body (One-line - copy  so snh vi Backend logs):"),console.log(JSON.stringify(Ce)),console.log(""),console.log(" Gii thch:"),console.log("   - key:",Se," DocumentKey ny s c gi trong callback"),console.log("   - status: 6  Mong i status ny (6 = Document saved)"),console.log('   - url: "https://documentserver/..."  PLACEHOLDER, OnlyOffice s thay bng URL thc t'),console.log(""),console.log(" Backend s nhn POST request vi body structure tng t"),console.log(" So snh body trong Backend logs vi expected body  trn  verify")}else console.log(" DocumentKey not available");if(console.log(""),console.log(""),o)try{console.log(""),console.log(" STEP 1: TRIGGER CALLBACK FLOW"),console.log(""),console.log(" Step 1.1: Starting callback flow (trigger save only, polling disabled)..."),console.log(" Step 1.2: Calling forceSaveAndPoll()..."),console.log(" Step 1.3: OnlyOffice will send POST callback to backend with documentKey:",Se),console.log(" NOTE: Polling is temporarily disabled - check backend logs to verify callback"),De=await o(),De?(console.log(" Step 1.4: Callback flow SUCCESS!"),console.log(" templateConfig URL (file  chnh sa t backend):",De),console.log(" Callback flow status:  HOT NG")):(console.log(" Step 1.4: Polling disabled - templateConfig will be null"),console.log(" Callback flow status:  POLLING DISABLED"),console.log(" Check backend logs to verify if POST callback was received")),console.log(""),console.log(" STEP 2: WAITING FOR CALLBACK TO BE SENT"),console.log(""),console.log(" Waiting 10 seconds for OnlyOffice to send POST callback to backend..."),console.log(" This gives OnlyOffice Server time to process and send callback"),console.log(" Expected callback URL:",`${$a.BASE_URL}/media/docs/onlyoffice/callback`),console.log(" Expected documentKey in callback:",Se),ce.info("Waiting 10 seconds for callback... Please check backend logs"),await new Promise(Ce=>setTimeout(Ce,1e4)),console.log(" Wait completed!"),console.log(" IMPORTANT: Check backend logs NOW to verify if callback was received"),console.log(" Look for POST request to /media/docs/onlyoffice/callback"),console.log(" Compare backend received body with expected body shown above"),console.log(""),console.log("")}catch(Ce){console.error(" Callback flow failed:",Ce),console.log(" Callback flow status:  KHNG HOT NG - Using fallback"),ce.warning("Could not get edited document from backend, templateConfig will be null"),De=null}else console.log(" forceSaveAndPoll function not available"),console.log(" Callback flow status:  FUNCTION KHNG TN TI"),De=null;console.log(""),console.log(" STEP 3: SUBMITTING TEMPLATE TO BACKEND"),console.log(""),console.log(" Now proceeding to submit template..."),console.log(" This will call POST /templates API"),console.log(""),console.log("");const ut={...be,templateContent:st,templateConfig:De},Ye=aoe(ut,u);console.log(" Template payload built:"),console.log("   templateContent (file import):",Ye.templateContent),console.log("   templateConfig (file  chnh sa):",Ye.templateConfig||"null"),console.log("   documentKey:",Se),console.log(` Full payload:
`,JSON.stringify(Ye,null,2));const Ht=await Ie.post("/templates",Ye);ce.success("Template submitted successfully"),console.log(" Backend response:",Ht?.data??Ht)}catch(be){console.error(" Submit template failed:",be),ce.error("Failed to submit template: "+(be.message||"Unknown error"))}finally{ne(!1)}},je=be=>{const Se=be.fieldName;if(!Se)return"";switch((be.fieldType||"TEXT").toUpperCase()){case"TOGGLE":return`{#${Se}}{/`+Se+`} {^${Se}}{/`+Se+"}";case"PART":return`{#${Se}} {test_field} {/${Se}}`;case"TEXT":default:return`{${Se}}`}},[z,me]=b.useState(!1),[ie,ke]=b.useState(null),[Fe,he]=b.useState(null),[Me,de]=b.useState(""),[We,et]=b.useState("TEXT"),[ht,Ke]=b.useState(""),[Je,ft]=b.useState("TRAINER"),nt=(be,Se,De)=>{he(be),ke(De),de(""),et("TEXT"),Ke(""),ft("TRAINER"),me(!0)},qe=()=>{if(!ht||!Me||!/^[a-z][a-z0-9_]*$/.test(Me)){ce.warning("Please enter label and snake_case field name, e.g., focus_item");return}if(!ie?.fieldName){ce.error("Invalid PART field");return}if(Fe===null||Fe<0||Fe>=u.length){ce.error("Invalid section");return}const De=u[Fe].fields||[];if(De.some(pt=>pt.fieldName===Me)){ce.warning("Field name must be unique within section");return}const st={label:ht,fieldName:Me,fieldType:We,roleRequired:Je,parentTempId:ie?.tempId||ie?.fieldName||null},ut=[...u];if(ut[Fe].fields=[...De,st],m(ut),t){const pt=ut.flatMap(cr=>cr.fields||[]);t(pt)}let Ye=`{${Me}}`;const Ht=String(We).toUpperCase();Ht==="TOGGLE"?Ye=`{#${Me}}{/${Me}} {^${Me}}{/${Me}}`:Ht==="IMAGE"&&(Ye=`{${Me}}`);const Ce=` ${Ye}`;setTimeout(()=>s(Ce),0),me(!1),ke(null),he(null),de(""),et("TEXT"),Ke(""),ft("TRAINER")};return a.jsxs(a.Fragment,{children:[a.jsx("style",{children:`
          .insert-field-btn {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
          }
          .insert-field-btn:hover:not(:disabled) {
            background-color: #007bff !important;
            border-color: #007bff !important;
            color: white !important;
          }
          .insert-field-btn:focus {
            background-color: transparent !important;
            border-color: #007bff !important;
            color: #007bff !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
          }
          /* Visual grouping for PART and its children */
          .bg-part { background-color: rgba(var(--bs-primary-rgb), .06); border-color: rgba(var(--bs-primary-rgb), .35) !important; }
          .part-badge { font-size: 0.65rem; background: var(--bs-primary); }
          .part-children { border-left: 3px dashed rgba(var(--bs-primary-rgb), .35); margin-left: .5rem; padding-left: .75rem; }
          .child-row { background: #ffffff; }
          .field-title { display: flex; align-items: center; gap: .5rem; }
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: .5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-neutral-200); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-toggle { color: var(--bs-primary); border-color: var(--bs-primary); background: rgba(var(--bs-primary-rgb), .08); }
          .section-toggle:hover { background: rgba(var(--bs-primary-rgb), .15); }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display:flex; align-items:center; gap:.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight:600; border:1px solid rgba(var(--bs-primary-rgb), .25); }
          .draggable-item { transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease; }
          .draggable-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background:#fff; }
          .drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
          .section-card { transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease; }
          .section-card.section-dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.15); transform: scale(.98); opacity: 0.7; }
          .section-card.section-drop-target-above { border-top: 4px solid var(--bs-primary) !important; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }
          .section-card.section-drop-target-below { border-bottom: 4px solid var(--bs-primary) !important; border-bottom-left-radius: 0.5rem; border-bottom-right-radius: 0.5rem; }
        `}),a.jsxs("div",{className:`p-3 bg-light custom-fields-panel ${d}`,style:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[a.jsx("h6",{className:"mb-0 text-muted",children:"Custom Fields"}),a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:J,disabled:c,children:[a.jsx(Cs,{className:"me-1",size:14}),"Add Section"]})]}),a.jsx("div",{className:"flex-grow-1",style:{overflowY:"auto",minHeight:"0"},children:a.jsx("div",{className:"d-grid gap-2",children:u.length>0?u.map((be,Se)=>a.jsxs(M,{className:`border section-card ${g.fromIndex===Se?"section-dragging":""} ${g.overIndex===Se?g.position==="above"?"section-drop-target-above":"section-drop-target-below":""}`,draggable:!c,onDragStart:De=>{if(c){De.preventDefault();return}v({fromIndex:Se,overIndex:Se,position:"above"}),De.dataTransfer.effectAllowed="move"},onDragOver:De=>{if(c||g.fromIndex===null)return;De.preventDefault();const st=De.currentTarget.getBoundingClientRect(),ut=st.top+st.height/2,Ye=De.clientY<ut?"above":"below";let Ht=Se;Ye==="below"&&g.fromIndex<Se?Ht=Se+1:Ye==="above"&&g.fromIndex>Se?Ht=Se:Ye==="below"&&g.fromIndex>Se?Ht=Se+1:Ye==="above"&&g.fromIndex<Se&&(Ht=Se),(g.overIndex!==Ht||g.position!==Ye)&&v(Ce=>({...Ce,overIndex:Ht,position:Ye}))},onDrop:De=>{if(c||g.fromIndex===null)return;De.preventDefault();const st=Math.max(0,Math.min(g.overIndex,u.length));Ae(g.fromIndex,st),v({fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>{v({fromIndex:null,overIndex:null,position:"above"})},style:{cursor:c?"default":"grab"},children:[a.jsxs(M.Header,{className:"d-flex justify-content-between align-items-center section-header",onClick:()=>F(Se),"aria-expanded":!f[Se],onDragStart:De=>De.stopPropagation(),children:[a.jsxs("div",{className:"d-flex flex-column",children:[a.jsxs("div",{className:"section-title fw-bold",children:[f[Se]?a.jsx(ec,{size:16}):a.jsx(Ha,{size:16}),be.label,a.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge",children:be.fields?.length||0})]}),a.jsxs("small",{className:"text-muted",children:["Edit by: ",be.editBy]})]}),a.jsx("div",{onClick:De=>De.stopPropagation(),children:a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>G(Se),disabled:c,children:[a.jsx(Cs,{className:"me-1",size:14}),"Add Field"]})})]}),!f[Se]&&a.jsx(M.Body,{className:"section-body",children:be.fields&&be.fields.length>0?(()=>{const De=[...be.fields].sort((Ce,pt)=>Ce.displayOrder-pt.displayOrder),st=Ce=>Ce?.tempId||Ce?.fieldName||null,ut=Ce=>!!Ce.parentTempId,Ye=De.filter(Ce=>!ut(Ce)),Ht=(Ce,pt)=>{const cr=String(Ce.fieldType).toUpperCase()==="PART";return a.jsxs("div",{className:`p-2 rounded border mb-2 draggable-item ${cr?"bg-part part-card":"bg-white child-row"} ${p.sectionIndex===Se&&p.overIndex===pt?"border-primary":""} ${p.sectionIndex===Se&&p.overIndex===pt&&p.position==="above"?"drop-target-above":""} ${p.sectionIndex===Se&&p.overIndex===pt&&p.position==="below"?"drop-target-below":""} ${p.sectionIndex===Se&&p.fromIndex===pt?"dragging":""}`,draggable:!0,onDragStart:at=>{x({sectionIndex:Se,fromIndex:pt,overIndex:pt,position:"above"}),at.dataTransfer.effectAllowed="move"},onDragOver:at=>{at.preventDefault();const Kt=at.currentTarget.getBoundingClientRect(),Sr=Kt.top+Kt.height/2,Xn=at.clientY<Sr?"above":"below";let Vo=pt;Xn==="below"&&(Vo=pt+1),p.sectionIndex===Se&&(p.overIndex!==Vo||p.position!==Xn)&&x(Xi=>({...Xi,overIndex:Vo,position:Xn}))},onDrop:at=>{if(at.preventDefault(),p.sectionIndex===Se){const Kt=Math.max(0,Math.min(p.overIndex,u[Se]?.fields?.length||0));le(Se,p.fromIndex,Kt)}x({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>x({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),style:{cursor:"grab"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("div",{className:"flex-grow-1",children:[a.jsxs("div",{className:"fw-bold field-title",children:[Ce.label," ",cr&&a.jsx("span",{className:"badge part-badge",children:"PART"})," "]}),a.jsxs("small",{className:"text-muted",children:[Ce.fieldName," (",Ce.fieldType,")",Ce.roleRequired?` - ${Ce.roleRequired}`:""]})]}),a.jsxs("div",{className:"d-flex gap-1",children:[a.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>Y(Se,pt),disabled:c,title:"Edit Field",className:"text-primary border-primary",children:a.jsx(as,{size:14})}),a.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{const at=[...u];if(at[Se].fields=at[Se].fields.filter((Kt,Sr)=>Sr!==pt),m(at),r){const Kt=at.flatMap(Sr=>Sr.fields||[]);r(Kt)}},disabled:c,title:"Remove Field",className:"text-danger border-danger",children:a.jsx(Ze,{size:14})})]})]}),a.jsxs("div",{className:"d-grid",children:[a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>s(je(Ce)),disabled:c,className:"d-flex align-items-center justify-content-center text-primary border-primary insert-field-btn",style:{transition:"all 0.2s ease-in-out"},children:[a.jsx(Sl,{className:"me-1",size:14}),"Insert Field"]}),String(Ce.fieldType).toUpperCase()==="PART"&&a.jsxs(se,{variant:"outline-primary",size:"sm",className:"mt-2 text-primary border-primary",onClick:()=>nt(Se,pt,Ce),disabled:c,children:[a.jsx(Sl,{className:"me-1",size:14}),"Add Field to PART"]})]}),String(Ce.fieldType).toUpperCase()==="PART"&&(()=>{const at=st(Ce),Kt=De.filter(Sr=>Sr.parentTempId===at);return Kt.length?a.jsx("div",{className:"mt-2 part-children",children:Kt.map(Sr=>{const Xn=be.fields.indexOf(Sr);return Ht(Sr,Xn)})}):null})()]},`${Se}-${pt}`)};return a.jsx(a.Fragment,{children:Ye.map(Ce=>{const pt=be.fields.indexOf(Ce);return Ht(Ce,pt)})})})():a.jsx(Re,{variant:"light",className:"mb-0",children:a.jsx("small",{children:'No fields in this section. Click "Add Field".'})})})]},Se)):a.jsx(Re,{variant:"light",className:"mb-0",children:a.jsx("small",{children:'No sections yet. Click "Add Section" to start.'})})})}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[a.jsxs(Re,{variant:"info",className:"mb-0",style:{fontSize:"0.8rem"},children:[a.jsx("strong",{children:"Tip:"})," Create sections first, then add fields inside each section."]}),a.jsx(se,{variant:"primary",size:"sm",onClick:fe,disabled:ae,children:ae?"Submitting...":"Submit Template"})]}),a.jsxs(ue,{show:w,onHide:te,centered:!0,size:"lg",children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsx(ue.Title,{children:"Add New Section"})}),a.jsx(ue.Body,{children:a.jsx(k,{children:a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"Display label",value:S.label,onChange:be=>E(Se=>({...Se,label:be.target.value})),required:!0})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{className:"text-primary-custom",children:"Edit By"}),a.jsx(k.Select,{value:S.editBy,onChange:be=>{const Se=be.target.value;E(De=>({...De,editBy:Se,roleInSubject:Se==="TRAINEE"?"":De.roleInSubject}))},children:N.map(be=>a.jsx("option",{value:be,children:be},be))})]})}),S.editBy==="TRAINER"&&a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{className:"text-primary-custom",children:"Role In Subject"}),a.jsxs(k.Select,{value:S.roleInSubject||"ASSESSMENT_REVIEWER",onChange:be=>E(Se=>({...Se,roleInSubject:be.target.value})),style:{minWidth:"200px"},children:[a.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT_REVIEWER"}),a.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{className:"d-flex flex-row align-items-center gap-4",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(k.Check,{type:"checkbox",checked:S.isSubmittable,onChange:be=>E(Se=>({...Se,isSubmittable:be.target.checked})),id:"section-submittable"}),a.jsx(k.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(k.Check,{type:"checkbox",checked:S.isToggleDependent,onChange:be=>E(Se=>({...Se,isToggleDependent:be.target.checked})),id:"section-toggle-dependent"}),a.jsx(k.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),a.jsxs(ue.Footer,{children:[a.jsx(se,{variant:"outline-secondary",onClick:te,children:"Cancel"}),a.jsx(se,{variant:"primary",onClick:O,children:"Save Section"})]})]}),a.jsxs(ue,{show:T,onHide:te,size:"lg",children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsx(ue.Title,{children:"Add New Field"})}),a.jsx(ue.Body,{children:a.jsx(k,{children:a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:12,children:a.jsxs(Re,{variant:"light",className:"py-2",children:["Adding field to section: ",a.jsx("strong",{children:P!==null?u[P]?.label:"N/A"})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"e.g., Crew Communication",value:W.label,onChange:be=>K(Se=>({...Se,label:be.target.value})),required:!0}),a.jsx(k.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"e.g., crew_communication",value:W.fieldName,onChange:be=>K(Se=>({...Se,fieldName:be.target.value})),required:!0}),a.jsxs(k.Text,{className:"text-muted",children:["The variable name used in the docxtemplate (e.g., ","{crew_communication}","). Must be unique within a template."]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Field Type ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(k.Select,{value:W.fieldType,onChange:be=>K(Se=>({...Se,fieldType:be.target.value})),required:!0,children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"PART",children:"PART"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),a.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Role Required ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",value:P!==null&&u[P]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),a.jsx(k.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{className:"text-primary-custom",children:"Parent Template ID"}),a.jsx(k.Control,{type:"text",placeholder:"Leave empty for root level",value:W.parentTempId||"",onChange:be=>K(Se=>({...Se,parentTempId:be.target.value||null}))})]})})]})})}),a.jsxs(ue.Footer,{children:[a.jsx(se,{variant:"outline-secondary",onClick:te,children:"Cancel"}),a.jsx(se,{variant:"primary",onClick:B,children:"Save Field"})]})]}),a.jsxs(ue,{show:L,onHide:te,size:"lg",children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsx(ue.Title,{children:"Edit Field"})}),a.jsx(ue.Body,{children:a.jsx(k,{children:a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"e.g., Crew Communication",value:W.label,onChange:be=>K(Se=>({...Se,label:be.target.value})),required:!0}),a.jsx(k.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Field Type ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(k.Select,{value:W.fieldType,onChange:be=>K(Se=>({...Se,fieldType:be.target.value})),required:!0,children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"PART",children:"PART"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),a.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Role Required ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",value:P!==null&&u[P]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},required:!0}),a.jsx(k.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:W.fieldType==="PART"?"e.g., Assessment_Items":W.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:W.fieldName,onChange:be=>K(Se=>({...Se,fieldName:be.target.value})),required:!0}),a.jsx(k.Text,{className:"text-muted",children:W.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':W.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{className:"text-primary-custom",children:"Parent Template ID"}),a.jsx(k.Control,{type:"text",placeholder:"Leave empty for root level",value:W.parentTempId||"",onChange:be=>K(Se=>({...Se,parentTempId:be.target.value||null}))})]})})]})})}),a.jsxs(ue.Footer,{children:[a.jsx(se,{variant:"outline-secondary",onClick:te,children:"Cancel"}),a.jsx(se,{variant:"primary",onClick:B,children:"Update Field"})]})]}),a.jsxs(ue,{show:z,onHide:()=>me(!1),children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsx(ue.Title,{children:"Insert Part Field"})}),a.jsx(ue.Body,{children:a.jsx(k,{children:a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:12,children:a.jsxs(Re,{variant:"light",className:"py-2",children:["Insert field into PART: ",a.jsxs("strong",{children:[ie?.label," (",ie?.fieldName,")"]})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"e.g., Focus Item",value:ht,onChange:be=>Ke(be.target.value)})]})}),a.jsx(H,{md:8,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{className:"text-primary-custom",children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"e.g., focus_item",value:Me,onChange:be=>de(be.target.value)}),a.jsx(k.Text,{className:"text-muted",children:"snake_case only"})]})}),a.jsx(H,{md:4,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{className:"text-primary-custom",children:"Type"}),a.jsxs(k.Select,{value:We,onChange:be=>et(be.target.value),children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"IMAGE",children:"IMAGE"})]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{className:"text-primary-custom",children:"Role Required"}),a.jsx(k.Select,{value:Je,onChange:be=>ft(be.target.value),children:N.map(be=>a.jsx("option",{value:be,children:be},be))})]})}),a.jsx(H,{md:12,children:a.jsx(k.Text,{className:"text-muted",children:"Display order is assigned automatically by creation order."})})]})})}),a.jsxs(ue.Footer,{children:[a.jsx(se,{variant:"outline-secondary",onClick:()=>me(!1),children:"Cancel"}),a.jsx(se,{variant:"primary",onClick:qe,children:"Insert"})]})]})]})]})},ioe=({customFields:e,onAddField:t,onRemoveField:r,onInsertField:s,exportEditedDoc:n,exportAndUploadEditedDoc:i,forceSaveAndPoll:o,getDocumentKey:l,readOnly:c=!1,className:d=""})=>a.jsx(noe,{customFields:e,onAddField:t,onRemoveField:r,onInsertField:s,exportEditedDoc:n,exportAndUploadEditedDoc:i,forceSaveAndPoll:o,getDocumentKey:l,readOnly:c,className:d}),ooe=({onInsertField:e,exportEditedDoc:t,initialUrl:r,readOnly:s=!1,className:n=""})=>{const[i,o]=b.useState([]),[l,c]=b.useState([]),[d,u]=b.useState({}),[m,f]=b.useState(!1),[h,p]=b.useState(!1),[x,g]=b.useState(!1),[v,w]=b.useState(null),[y,S]=b.useState(null),[E,N]=b.useState(null),[j,T]=b.useState({name:"",label:"",displayOrder:1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),[C,L]=b.useState(["TRAINER","TRAINEE"]),A=b.useRef(null),[P,I]=b.useState({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),[_,D]=b.useState({fromIndex:null,overIndex:null,position:"above"}),W=me=>{u(ie=>({...ie,[me]:!ie[me]}))},K=(me,ie,ke)=>{ie===null||ke===null||ie===ke||c(Fe=>{const he=[...Fe],Me=[...he[me]?.fields||[]],de=Me[ie];if(F(de)){const et=J(de),ht=[],Ke=[];Me.forEach((nt,qe)=>{qe===ie||nt.parentTempId===et&&(ht.push(qe),Ke.push(nt))});const Je=[ie,...ht].sort((nt,qe)=>qe-nt);Je.forEach(nt=>Me.splice(nt,1));let ft=ke;Je.forEach(nt=>{nt<ke&&ft--}),Me.splice(ft,0,de,...Ke)}else{const[et]=Me.splice(ie,1);let ht=ke;ie<ke&&ht--,Me.splice(ht,0,et)}return he[me]={...he[me],fields:Me},he})},J=me=>me.tempId||me.name,F=me=>String(me.fieldType).toUpperCase()==="PART",le=(me,ie)=>{if(F(ie)){const ke=J(ie),Fe=i.filter(Me=>Me.parentTempId===ke),he=[ie,...Fe];me.dataTransfer.setData("text/plain",JSON.stringify(he))}else me.dataTransfer.setData("text/plain",JSON.stringify(ie))},Ae=(me,ie)=>{me.preventDefault();try{const ke=JSON.parse(me.dataTransfer.getData("text/plain"));let he=Array.isArray(ke)?ke:[ke];c(Me=>{const de=[...Me],We=de[ie]?.fields||[],et=he.filter(F);if(et.some(Ke=>We.some(Je=>F(Je)&&Je.name===Ke.name))){const Ke=new Set(et.map(nt=>nt.name)),Je=new Set;et.forEach(nt=>{const qe=J(nt);Je.add(qe)});const ft=We.filter(nt=>!(F(nt)&&Ke.has(nt.name)||nt.parentTempId&&Je.has(nt.parentTempId)));de[ie]={...de[ie],fields:[...ft,...he]}}else{for(const qe of he)if(qe.parentTempId&&We.some(Se=>{const De=J(Se);return F(Se)&&De===qe.parentTempId}))return ce.warning(`Cannot add field "${qe.name}": Fields cannot be dragged into existing PART fields.`),de;const Ke=qe=>F(qe)?qe.name:qe.parentTempId?`${qe.name}:${qe.parentTempId}`:qe.name,Je=new Set(We.map(Ke)),ft=new Map,nt=he.filter(qe=>{if(F(qe))return!We.some(De=>F(De)&&De.name===qe.name);const be=Ke(qe);return!Je.has(be)}).map(qe=>{const be={...qe};if(F(be)){console.log(` Adding PART field to section: ${be.name}`,{before:{parentTempId:be.parentTempId,tempId:be.tempId},existingFields:We.map(ut=>({name:ut.name,fieldType:ut.fieldType,tempId:ut.tempId,parentTempId:ut.parentTempId}))});const Se=be.parentTempId;be.parentTempId=null;const De=be.tempId||be.name,st=be.tempId;be.tempId||(be.tempId=`${be.name}-parent`),ft.set(De,be.tempId),console.log(` PART field normalized: ${be.name}`,{before:{parentTempId:Se,tempId:st},after:{parentTempId:be.parentTempId,tempId:be.tempId},oldId:De,mapping:`${De} -> ${be.tempId}`})}return be});console.log(" PartTempIdMapping:",Array.from(ft.entries())),console.log(" NewFields before update:",nt.map(qe=>({name:qe.name,fieldType:qe.fieldType,parentTempId:qe.parentTempId,isPart:F(qe)}))),nt.forEach(qe=>{if(qe.parentTempId&&!F(qe)){let be=null;if(ft.has(qe.parentTempId))be=ft.get(qe.parentTempId),console.log(` Updating child ${qe.name}: parentTempId ${qe.parentTempId} -> ${be}`),qe.parentTempId=be;else{const Se=nt.find(De=>F(De)&&(De.tempId===qe.parentTempId||De.name===qe.parentTempId));Se&&Se.tempId?(be=Se.tempId,console.log(` Updating child ${qe.name} (fallback): parentTempId ${qe.parentTempId} -> ${be}`),qe.parentTempId=be):console.warn(` Could not find parent for child ${qe.name} with parentTempId: ${qe.parentTempId}`,{partTempIdMapping:Array.from(ft.entries()),availableParts:nt.filter(F).map(De=>({name:De.name,tempId:De.tempId}))})}}}),console.log(" NewFields after update:",nt.map(qe=>({name:qe.name,fieldType:qe.fieldType,parentTempId:qe.parentTempId,isPart:F(qe)}))),de[ie]={...de[ie],fields:[...We,...nt]}}return de})}catch{}},O=me=>{me.preventDefault()},G=(me,ie)=>{me===null||ie===null||me===ie||c(ke=>{const Fe=[...ke],[he]=Fe.splice(me,1);return Fe.splice(ie,0,he),Fe})},U=()=>{const me=l.length+1;T({name:"",label:"",displayOrder:me,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]}),g(!0)},B=()=>{if(!j.label){ce.warning("Please fill in section label");return}const me={...j,name:j.label,roleInSubject:j.editBy==="TRAINEE"?null:j.roleInSubject||null};c(ie=>[...ie,me]),g(!1)},Y=()=>{g(!1),T({name:"",label:"",displayOrder:l.length+1,editBy:"TRAINER",roleInSubject:"",isSubmittable:!0,isToggleDependent:!1,fields:[]})};b.useEffect(()=>{x&&(async()=>{try{const ie=await ys.getRoles(),Fe=(Array.isArray(ie?.roles)?ie.roles:Array.isArray(ie)?ie:[]).map(Me=>typeof Me=="string"?Me:Me.name||Me.code||Me.roleName||"").filter(Me=>typeof Me=="string").map(Me=>Me.toUpperCase()).filter(Me=>Me.includes("TRAINER")||Me.includes("TRAINEE")).map(Me=>Me.includes("TRAINER")?"TRAINER":"TRAINEE"),he=Array.from(new Set(Fe));he.length>0&&L(he)}catch{}})()},[x]);const te=me=>{c(ie=>ie.filter((ke,Fe)=>Fe!==me))},ae=(me,ie)=>{const ke=l[me]?.fields?.[ie];ke&&(N({...ke}),w(me),S(ie),p(!0))},ne=(me,ie)=>{if(!me)return{valid:!1,message:"Field name is required"};const ke=String(ie||"").toUpperCase();return ke==="PART"?/^[A-Z][A-Za-z0-9_]*$/.test(me)?me.toLowerCase().startsWith("section")?{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:{valid:!0,message:""}:{valid:!1,message:'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).'}:ke==="TOGGLE"?/^[a-z]+[A-Z][a-zA-Z0-9]*$/.test(me)?{valid:!0,message:""}:{valid:!1,message:"The tag name should use camelCase (e.g., isGroundCourse)."}:/^[a-z][a-z0-9_]*$/.test(me)?{valid:!0,message:""}:{valid:!1,message:"Field name must be in snake_case format (e.g., crew_communication)."}},fe=()=>{if(!E||!E.label||!E.name){ce.warning("Please fill in all required fields");return}const me=ne(E.name,E.fieldType);if(!me.valid){ce.warning(me.message);return}if(v===null||v<0||v>=l.length){ce.warning("Invalid section");return}const ie=[...l],ke=ie[v].fields||[];if(ke.filter((We,et)=>et!==y).some(We=>We.name===E.name)){ce.warning("Field name must be unique within the section");return}const Me=ie[v]?.editBy||"TRAINER",de={...E,roleRequired:Me};ie[v].fields=[...ke.slice(0,y),de,...ke.slice(y+1)],c(ie),p(!1),N(null),w(null),S(null),ce.success("Field updated successfully")},je=()=>{p(!1),N(null),w(null),S(null)},z=async()=>{try{f(!0);let me=r;if(t&&!me)try{const he=await t();he&&(me=he)}catch{}if(!me)try{const he=localStorage.getItem("templateInfo");if(he){const Me=JSON.parse(he);Me.templateContent&&(me=Me.templateContent)}}catch{}if(!me){ce.error("No document URL available"),f(!1);return}const{data:ie}=await Ie.post("/templates/extract-fields-from-url",{url:me}),Fe=(ie?.fields||ie||[]).map((he,Me)=>({name:he.fieldName||he.name||`field_${Me}`,label:`{${he.fieldName||he.name}}`,fieldType:he.fieldType,displayOrder:he.displayOrder,parentTempId:he.parentTempId||null,tempId:he.tempId}));o(Fe)}catch{ce.error("Failed to extract fields")}finally{f(!1)}};return b.useEffect(()=>{r&&r!==A.current&&(A.current=r,z())},[r]),a.jsxs("div",{className:`h-100 d-flex flex-column editor-merge-fields-wrapper ${n}`,style:{width:"100%",maxWidth:"100%",overflow:"hidden",boxSizing:"border-box"},children:[a.jsx("div",{className:"p-2 border-bottom bg-white",style:{flexShrink:0},children:a.jsx("div",{className:"d-flex align-items-center gap-2",children:a.jsx(se,{size:"sm",variant:"outline-primary",onClick:U,disabled:m,children:"+ Add Section"})})}),a.jsxs("div",{className:"flex-grow-1 d-flex flex-column",style:{overflow:"hidden",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[a.jsx("style",{children:`
          .editor-merge-fields-wrapper {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
          }
          
          .bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
          .part-badge { background-color: rgba(13, 110, 253, 0.15); color: #0d6efd; font-size: 0.7rem; padding: 2px 6px; }
          /* Force margin-left = 0 for non-child fields to prevent CSS cascade issues */
          .section-field-non-child {
            margin-left: 0 !important;
          }
          .section-field-child {
            margin-left: 1rem !important;
          }
          
          /* Prevent text overflow in field items */
          .section-field-non-child > div:first-child,
          .section-field-child > div:first-child {
            min-width: 0 !important;
            flex: 1 !important;
            overflow: hidden !important;
          }
          
          .section-field-non-child .fw-bold,
          .section-field-child .fw-bold {
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
          }
          
          .section-field-non-child .text-muted,
          .section-field-child .text-muted {
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
          }
          
          .section-field-non-child > div:last-child,
          .section-field-child > div:last-child {
            flex-shrink: 0 !important;
          }
          
          /* Match CustomFieldsPanel styling */
          .section-card { border: 1px solid var(--bs-primary) !important; border-left: 4px solid var(--bs-primary) !important; border-radius: 0.5rem; }
          .section-header { background: #f8fafc; border-bottom: 1px solid var(--bs-border-color); cursor: pointer; }
          .section-body { background: #fbfdff; }
          .section-card:hover { box-shadow: 0 2px 8px rgba(13,110,253,.08); }
          .section-title { display: flex; align-items: center; gap: 0.5rem; }
          .field-count-badge { background: rgba(var(--bs-primary-rgb), .08); color: var(--bs-primary); font-weight: 600; border: 1px solid rgba(var(--bs-primary-rgb), .25); }
          .field-card-item { padding: 0.5rem; border-radius: 0.25rem; border: 1px solid #dee2e6; margin-bottom: 0.5rem; background: white; }
          .field-card-item.bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
          .field-title { display: flex; align-items: center; gap: 0.5rem; }
          .field-card-item.dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.08); transform: scale(.995); background: #fff; }
          .field-card-item.drop-target-above { border-top: 3px solid var(--bs-primary) !important; }
          .field-card-item.drop-target-below { border-bottom: 3px solid var(--bs-primary) !important; }
          .section-card { transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease; }
          .section-card.section-dragging { cursor: grabbing; box-shadow: 0 8px 18px rgba(0,0,0,.15); transform: scale(.98); opacity: 0.7; }
          .section-card.section-drop-target-above { border-top: 4px solid var(--bs-primary) !important; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }
          .section-card.section-drop-target-below { border-bottom: 4px solid var(--bs-primary) !important; border-bottom-left-radius: 0.5rem; border-bottom-right-radius: 0.5rem; }
        `}),a.jsx("div",{className:"flex-shrink-0",style:{maxHeight:"60%",overflowY:"auto",borderBottom:"1px solid #eee",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:a.jsxs("div",{className:"p-3",style:{width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[l.length===0&&a.jsx(Re,{variant:"light",className:"mb-0",children:a.jsx("small",{children:'No sections yet. Click "+ Add Section" to start.'})}),l.length>0&&a.jsx("div",{className:"d-grid gap-2",children:l.map((me,ie)=>a.jsxs(M,{className:`border section-card ${_.fromIndex===ie?"section-dragging":""} ${_.overIndex===ie?_.position==="above"?"section-drop-target-above":"section-drop-target-below":""}`,draggable:!s,onDragStart:ke=>{if(s){ke.preventDefault();return}D({fromIndex:ie,overIndex:ie,position:"above"}),ke.dataTransfer.effectAllowed="move"},onDragOver:ke=>{if(s||_.fromIndex===null){O(ke);return}ke.preventDefault();const Fe=ke.currentTarget.getBoundingClientRect(),he=Fe.top+Fe.height/2,Me=ke.clientY<he?"above":"below";let de=ie;Me==="below"&&_.fromIndex<ie?de=ie+1:Me==="above"&&_.fromIndex>ie?de=ie:Me==="below"&&_.fromIndex>ie?de=ie+1:Me==="above"&&_.fromIndex<ie&&(de=ie),(_.overIndex!==de||_.position!==Me)&&D(We=>({...We,overIndex:de,position:Me}))},onDrop:ke=>{if(s||_.fromIndex===null){Ae(ke,ie);return}ke.preventDefault();const Fe=Math.max(0,Math.min(_.overIndex,l.length));G(_.fromIndex,Fe),D({fromIndex:null,overIndex:null,position:"above"})},onDragEnd:()=>{D({fromIndex:null,overIndex:null,position:"above"})},style:{cursor:s?"default":"grab"},children:[a.jsxs(M.Header,{className:"d-flex justify-content-between align-items-center section-header",onClick:()=>W(ie),"aria-expanded":!d[ie],onDragStart:ke=>ke.stopPropagation(),children:[a.jsxs("div",{className:"d-flex flex-column",children:[a.jsxs("div",{className:"section-title fw-bold",children:[d[ie]?a.jsx(ec,{size:16}):a.jsx(Ha,{size:16}),me.label,a.jsx("span",{className:"badge rounded-pill ms-1 field-count-badge",children:me.fields?.length||0})]}),a.jsxs("small",{className:"text-muted",children:["Edit by: ",me.editBy||"TRAINER"]})]}),a.jsx("div",{onClick:ke=>ke.stopPropagation(),children:a.jsx(se,{size:"sm",variant:"outline-danger",onClick:()=>te(ie),disabled:s,children:"Remove"})})]}),!d[ie]&&a.jsx(M.Body,{className:"section-body",children:me.fields&&me.fields.length>0?(()=>{const ke=[...me.fields],Fe=ke.filter(de=>F(de)?(de.parentTempId&&console.error(` PART field ${de.name} has parentTempId: ${de.parentTempId} - This should be null!`),!0):!de.parentTempId||de.parentTempId===null||de.parentTempId==="");console.log(` Section ${ie} fields analysis:`,{totalFields:ke.length,topLevelCount:Fe.length,topLevelFields:Fe.map(de=>({name:de.name,fieldType:de.fieldType,tempId:de.tempId,parentTempId:de.parentTempId,isPart:F(de)})),allFields:ke.map(de=>({name:de.name,fieldType:de.fieldType,tempId:de.tempId,parentTempId:de.parentTempId,isPart:F(de)}))}),Fe.forEach(de=>{F(de)&&de.parentTempId&&console.error(` CRITICAL BUG: PART field ${de.name} in topLevel has parentTempId: ${de.parentTempId}`,de)});const he=ke.filter(F);he.forEach((de,We)=>{he.forEach((et,ht)=>{We!==ht&&de.parentTempId&&et.tempId&&de.parentTempId===et.tempId&&console.error(` CRITICAL: PART field ${de.name} has parentTempId "${de.parentTempId}" matching PART ${et.name}'s tempId "${et.tempId}"`,{part1:{name:de.name,fieldType:de.fieldType,tempId:de.tempId,parentTempId:de.parentTempId},part2:{name:et.name,fieldType:et.fieldType,tempId:et.tempId,parentTempId:et.parentTempId}})})});const Me=(de,We,et=null)=>{const ht=F(de);console.log(` renderRow: ${de.name} (${de.fieldType}), realIndex: ${We}, topLevelIdx: ${et}, isPart: ${ht}, parentTempId: ${de.parentTempId}, tempId: ${de.tempId}`),ht&&de.parentTempId&&(console.error(` CRITICAL: PART field ${de.name} has parentTempId ${de.parentTempId} - resetting to null!`,de),de.parentTempId=null);const Ke=de.tempId,Je=de.name;ht&&console.log(` PART field ${de.name} searching with tempId: "${Ke}", fieldName: "${Je}"`);let ft=[];if(ht){if(console.log(` PART field ${de.name} (tempId: ${Ke}, realIndex: ${We}) searching for children in ${ke.length} total fields:`,{allFields:ke.map(Ce=>({name:Ce.name,fieldType:Ce.fieldType,isPart:F(Ce),parentTempId:Ce.parentTempId,tempId:Ce.tempId}))}),ft=ke.filter(Ce=>{if(F(Ce))return Ke&&Ce.parentTempId===Ke&&console.error(` CRITICAL: PART field ${Ce.name} has parentTempId "${Ce.parentTempId}" matching PART ${de.name}'s tempId "${Ke}" - BLOCKED from children!`,{childField:{name:Ce.name,fieldType:Ce.fieldType,tempId:Ce.tempId,parentTempId:Ce.parentTempId},parentField:{name:de.name,fieldType:de.fieldType,tempId:de.tempId}}),!1;if(!Ce.parentTempId||Ce.parentTempId===null||Ce.parentTempId==="")return!1;if(Ke){const cr=Ce.parentTempId===Ke;return cr&&console.log(`   Child match: ${Ce.name} (parentTempId: ${Ce.parentTempId}) matches PART ${de.name} (tempId: ${Ke})`),cr}const pt=Ce.parentTempId===Je&&!Ce.parentTempId?.includes("-parent");return pt&&console.log(`   Child match by name: ${Ce.name} (parentTempId: ${Ce.parentTempId}) matches PART ${de.name} (name: ${Je})`),pt}),ht&&ft.length===0&&ke.length>0){const Ce=ke.filter(at=>!F(at)),pt=Ce.filter(at=>at.parentTempId),cr=pt.filter(at=>at.parentTempId===Ke);console.warn(` PART field ${de.name} (tempId: ${Ke}) has NO children. Debug info:`,{totalFields:ke.length,totalNonPartFields:Ce.length,fieldsWithParent:pt.length,fieldsMatchingThisPart:cr.length,fieldsWithParentDetails:pt.map(at=>({name:at.name,fieldType:at.fieldType,parentTempId:at.parentTempId,expected:Ke,matches:at.parentTempId===Ke,duplicateNames:ke.filter(Kt=>!F(Kt)&&Kt.name===at.name&&Kt!==at).map(Kt=>({name:Kt.name,parentTempId:Kt.parentTempId,belongsTo:ke.find(Sr=>F(Sr)&&(Sr.tempId===Kt.parentTempId||Sr.name===Kt.parentTempId))?.name||"unknown"}))})),allFieldsInSection:me.fields.map(at=>({name:at.name,fieldType:at.fieldType,tempId:at.tempId,parentTempId:at.parentTempId,isPart:F(at)}))}),cr.length>0&&console.error(` CRITICAL: Found ${cr.length} fields with parentTempId="${Ke}" but filter returned 0!`,{matchingFields:cr,fieldTempId:Ke,fieldName:Je})}ft.length>0?console.log(` PART field ${de.name} (tempId: ${Ke}, realIndex: ${We}) has ${ft.length} children:`,ft.map(Ce=>({name:Ce.name,fieldType:Ce.fieldType,parentTempId:Ce.parentTempId,expectedParentTempId:Ke,matches:Ce.parentTempId===Ke}))):ht&&console.log(` PART field ${de.name} (tempId: ${Ke}, realIndex: ${We}) has NO children`)}const nt=!ht&&de.parentTempId&&de.parentTempId!==null&&de.parentTempId!=="";ht&&nt&&console.error(` CRITICAL BUG: PART field ${de.name} is marked as child! parentTempId: ${de.parentTempId}`,de);const qe=ht?!0:!nt,be=Ce=>{if(nt){Ce.preventDefault();return}if(I({sectionIndex:ie,fromIndex:We,overIndex:We,position:"above"}),ht){const pt=ke.filter(at=>F(at)?!1:Ke?at.parentTempId===Ke:at.parentTempId===Je&&!at.parentTempId?.includes("-parent")),cr=[de,...pt];Ce.dataTransfer.setData("text/plain",JSON.stringify(cr)),Ce.dataTransfer.effectAllowed="move"}else Ce.dataTransfer.setData("text/plain",JSON.stringify(de)),Ce.dataTransfer.effectAllowed="move"},Se=Ce=>{if(P.sectionIndex!==ie||P.fromIndex===null)return;Ce.preventDefault(),Ce.stopPropagation();const pt=Ce.currentTarget.getBoundingClientRect(),cr=pt.top+pt.height/2,at=Ce.clientY<cr?"above":"below";let Kt=We;at==="below"&&(Kt=We+1),(P.overIndex!==Kt||P.position!==at)&&I(Sr=>({...Sr,overIndex:Kt,position:at}))},De=Ce=>{if(P.sectionIndex!==ie||P.fromIndex===null)return;Ce.preventDefault(),Ce.stopPropagation();const pt=Math.max(0,Math.min(P.overIndex,me.fields.length||0));K(ie,P.fromIndex,pt),I({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"})},st=P.sectionIndex===ie&&P.fromIndex===We,ut=P.sectionIndex===ie&&P.overIndex===We,Ye=ut&&P.position==="above"?"drop-target-above":ut&&P.position==="below"?"drop-target-below":"",Ht=`${ie}-topLevel-${de.name}-${de.tempId||de.name||We}`;return ht&&console.log(` Key for PART field ${de.name}: ${Ht}`),a.jsxs("div",{className:`p-2 rounded border mb-2 field-card-item ${ht?"bg-part part-field-top-level":""} ${nt?"field-child":""} ${st?"dragging":""} ${Ye}`,"data-field-name":de.name,"data-field-type":de.fieldType,"data-is-part":ht,"data-is-child":nt,"data-parent-temp-id":de.parentTempId||"","data-render-index":We,"data-top-level-index":et!==null?et:-1,style:{marginLeft:ht?"0px":nt?"1rem":"0px",cursor:qe?"grab":"default",opacity:st?.5:qe?1:.8,transition:"all 0.12s ease"},draggable:qe,onDragStart:qe?be:void 0,onDragOver:qe?Se:void 0,onDrop:qe?De:void 0,onDragEnd:()=>I({sectionIndex:null,fromIndex:null,overIndex:null,position:"above"}),children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[a.jsxs("div",{className:"fw-bold field-title",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[de.label," ",ht&&a.jsx("span",{className:"badge part-badge",children:"PART"})]}),a.jsxs("small",{className:"text-muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:[de.name," (",de.fieldType,")",de.roleRequired?` - ${de.roleRequired}`:""]})]}),a.jsxs("div",{className:"d-flex gap-1",style:{flexShrink:0},children:[a.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>ae(ie,We),disabled:s,title:"Edit Field",className:"text-primary border-primary",children:a.jsx(as,{size:14})}),a.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{const Ce=[...l];Ce[ie].fields=Ce[ie].fields.filter((pt,cr)=>cr!==We),c(Ce)},disabled:s,title:"Remove Field",className:"text-danger border-danger",children:a.jsx(Ze,{size:14})})]})]}),a.jsx("div",{className:"d-grid",children:a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>e(de.name),disabled:s,className:"d-flex align-items-center justify-content-center text-primary border-primary",style:{transition:"all 0.2s ease-in-out"},children:[a.jsx(Sl,{className:"me-1",size:14}),"Insert Field"]})}),ht&&ft.length>0&&a.jsx("div",{className:"mt-2 part-children",style:{borderLeft:"3px dashed rgba(13, 110, 253, 0.35)",marginLeft:"0.5rem",paddingLeft:"0.75rem"},"data-part-parent":de.name,"data-part-tempid":de.tempId,"data-part-render-index":We,children:(console.log(` Rendering ${ft.length} children for PART ${de.name} (tempId: ${de.tempId}, realIndex: ${We}):`,ft.map(Ce=>({name:Ce.name,fieldType:Ce.fieldType,parentTempId:Ce.parentTempId,isPart:F(Ce)}))),ft.map(Ce=>{if(F(Ce))return console.error(` CRITICAL BUG: Attempted to render PART field ${Ce.name} (${Ce.fieldType}) as child of PART field ${de.name} (${de.fieldType})!`,{child:{name:Ce.name,fieldType:Ce.fieldType,tempId:Ce.tempId,parentTempId:Ce.parentTempId},parent:{name:de.name,fieldType:de.fieldType,tempId:de.tempId},childrenArray:ft.map(at=>({name:at.name,fieldType:at.fieldType,isPart:F(at)}))}),null;console.log(`   Rendering child: ${Ce.name} (${Ce.fieldType}) inside PART ${de.name}`);const pt=me.fields.indexOf(Ce),cr=`${ie}-child-${de.tempId||de.name}-${Ce.name}-${Ce.tempId||pt}`;return console.log(`   Key for child ${Ce.name} of PART ${de.name}: ${cr}`),a.jsxs("div",{className:"p-2 rounded border mb-2 field-card-item","data-child-parent":de.name,"data-child-parent-tempid":de.tempId,"data-child-name":Ce.name,style:{marginLeft:"0",cursor:"default",opacity:.8},draggable:!1,children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[a.jsx("div",{className:"fw-bold field-title",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Ce.label}),a.jsxs("small",{className:"text-muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:[Ce.name," (",Ce.fieldType,")",Ce.roleRequired?` - ${Ce.roleRequired}`:""]})]}),a.jsxs("div",{className:"d-flex gap-1",style:{flexShrink:0},children:[a.jsx(se,{variant:"outline-primary",size:"sm",onClick:()=>ae(ie,pt),disabled:s,title:"Edit Field",className:"text-primary border-primary",children:a.jsx(as,{size:14})}),a.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>{const at=[...l];at[ie].fields=at[ie].fields.filter((Kt,Sr)=>Sr!==pt),c(at)},disabled:s,title:"Remove Field",className:"text-danger border-danger",children:a.jsx(Ze,{size:14})})]})]}),a.jsx("div",{className:"d-grid",children:a.jsxs(se,{variant:"outline-primary",size:"sm",onClick:()=>e(Ce.name),disabled:s,className:"d-flex align-items-center justify-content-center text-primary border-primary",style:{transition:"all 0.2s ease-in-out"},children:[a.jsx(Sl,{className:"me-1",size:14}),"Insert Field"]})})]},cr)}))},`${ie}-part-children-${de.tempId||de.name}-${We}`)]},Ht)};return console.log(` Rendering ${Fe.length} topLevel fields for section ${ie}:`,Fe.map(de=>({name:de.name,fieldType:de.fieldType,tempId:de.tempId,parentTempId:de.parentTempId}))),a.jsx(a.Fragment,{children:Fe.map((de,We)=>{const et=me.fields.indexOf(de);return F(de)&&de.parentTempId&&console.error(` CRITICAL BUG: Rendering PART field ${de.name} with parentTempId ${de.parentTempId} as topLevel!`,de),console.log(` Rendering topLevel[${We}]: ${de.name} (${de.fieldType}), tempId: ${de.tempId}, parentTempId: ${de.parentTempId}, isPart: ${F(de)}`),Me(de,et,We)})})})():a.jsx(Re,{variant:"light",className:"mb-0",children:a.jsx("small",{children:"No fields in this section. Drag fields here."})})})]},ie))})]})}),a.jsx("div",{className:"flex-grow-1",style:{overflowY:"auto",minHeight:0,width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:a.jsxs("div",{className:"p-2",style:{width:"100%",maxWidth:"100%",boxSizing:"border-box"},children:[a.jsx("style",{children:`
              .bg-part { background-color: rgba(13, 110, 253, 0.06); border-color: rgba(13, 110, 253, 0.35) !important; }
              .part-badge { background-color: rgba(13, 110, 253, 0.15); color: #0d6efd; font-size: 0.7rem; padding: 2px 6px; }
              .part-children { border-left: 3px dashed rgba(13, 110, 253, 0.35); margin-left: 0.5rem; padding-left: 0.75rem; }
              /* CRITICAL: Force PART fields to have no margin - they are always top-level */
              .part-field-top-level { margin-left: 0 !important; padding-left: 0 !important; }
              .part-field-top-level::before { display: none !important; }
              /* Ensure children have proper indentation */
              .field-child { margin-left: 1rem !important; }
            `}),a.jsx("div",{className:"text-muted small mb-2",children:"Fields"}),i?.length?(()=>{const me=[...i].sort((he,Me)=>(he.displayOrder||0)-(Me.displayOrder||0)),ie=he=>!!he.parentTempId,ke=me.filter(he=>!ie(he)),Fe=he=>{const Me=F(he),de=J(he),We=me.filter(Ke=>Ke.parentTempId===de),ht=!(!Me&&he.parentTempId&&he.parentTempId!==null&&he.parentTempId!=="");return a.jsxs("div",{className:"mb-2",children:[a.jsx(M,{className:`mb-2 ${Me?"bg-part":""}`,draggable:ht,onDragStart:ht?Ke=>le(Ke,he):void 0,style:{cursor:ht?"grab":"default",opacity:ht?1:.8},children:a.jsxs(M.Body,{className:"py-2 px-2",children:[a.jsx("div",{className:"d-flex justify-content-between align-items-start mb-2",children:a.jsxs("div",{className:"flex-grow-1",style:{minWidth:0,overflow:"hidden",marginRight:"0.5rem"},children:[a.jsxs("div",{className:"fw-bold",style:{fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[he.label," ",Me&&a.jsx("span",{className:"badge part-badge ms-1",children:"PART"})]}),a.jsxs("div",{className:"text-muted",style:{fontSize:"0.8rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[he.name," (",he.fieldType,")"]})]})}),a.jsx("div",{className:"d-grid",children:a.jsx(se,{size:"sm",variant:"outline-primary",onClick:()=>e(he.name),disabled:s,className:"insert-field-btn",children:"Insert Field"})})]})}),Me&&We.length>0&&a.jsx("div",{className:"part-children",children:We.map(Ke=>Fe(Ke))})]},he.name)};return ke.map(he=>Fe(he))})():a.jsx(Re,{variant:"light",className:"m-0",children:"No extracted fields."})]})})]}),a.jsxs(ue,{show:x,onHide:Y,centered:!0,size:"lg",children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsx(ue.Title,{children:"Add New Section"})}),a.jsx(ue.Body,{children:a.jsx(k,{children:a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"Display label",value:j.label,onChange:me=>T(ie=>({...ie,label:me.target.value})),required:!0})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Edit By"}),a.jsx(k.Select,{value:j.editBy,onChange:me=>{const ie=me.target.value;T(ke=>({...ke,editBy:ie,roleInSubject:ie==="TRAINEE"?"":ke.roleInSubject}))},children:C.map(me=>a.jsx("option",{value:me,children:me},me))})]})}),j.editBy==="TRAINER"&&a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Role In Subject"}),a.jsxs(k.Select,{value:j.roleInSubject||"ASSESSMENT_REVIEWER",onChange:me=>T(ie=>({...ie,roleInSubject:me.target.value})),style:{minWidth:"200px"},children:[a.jsx("option",{value:"ASSESSMENT_REVIEWER",children:"ASSESSMENT_REVIEWER"}),a.jsx("option",{value:"EXAMINER",children:"EXAMINER"})]})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{className:"d-flex flex-row align-items-center gap-4",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(k.Check,{type:"checkbox",checked:j.isSubmittable,onChange:me=>T(ie=>({...ie,isSubmittable:me.target.checked})),id:"section-submittable"}),a.jsx(k.Label,{htmlFor:"section-submittable",className:"mb-0 ms-2",children:"Submittable"})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(k.Check,{type:"checkbox",checked:j.isToggleDependent,onChange:me=>T(ie=>({...ie,isToggleDependent:me.target.checked})),id:"section-toggle-dependent"}),a.jsx(k.Label,{htmlFor:"section-toggle-dependent",className:"mb-0 ms-2",children:"Toggle Dependent"})]})]})})]})})}),a.jsxs(ue.Footer,{children:[a.jsx(se,{variant:"outline-secondary",onClick:Y,children:"Cancel"}),a.jsx(se,{variant:"primary",onClick:B,children:"Save Section"})]})]}),a.jsxs(ue,{show:h,onHide:je,size:"lg",children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsx(ue.Title,{children:"Edit Field"})}),a.jsx(ue.Body,{style:{maxHeight:"400px",overflowY:"auto"},children:E&&a.jsx(k,{children:a.jsxs(oe,{className:"g-3",children:[a.jsx(H,{md:12,children:a.jsxs(Re,{variant:"light",className:"py-2",children:["Editing field in section: ",a.jsx("strong",{children:v!==null?l[v]?.label:"N/A"})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{children:["Label ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:"e.g., Crew Communication",value:E.label||"",onChange:me=>N(ie=>({...ie,label:me.target.value})),required:!0}),a.jsx(k.Text,{className:"text-muted",children:'The question or label displayed to the user (e.g., "Crew Communication").'})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{children:["Field Name ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(k.Control,{type:"text",placeholder:E.fieldType==="PART"?"e.g., Assessment_Items":E.fieldType==="TOGGLE"?"e.g., isGroundCourse":"e.g., crew_communication",value:E.name||"",onChange:me=>N(ie=>({...ie,name:me.target.value})),required:!0}),a.jsx(k.Text,{className:"text-muted",children:E.fieldType==="PART"?'The tag name should use underscores, should not start with the word "section" and the first letter always have to be capitalized. (e.g., Assessment_Items).':E.fieldType==="TOGGLE"?"The tag name should use camelCase (e.g., isGroundCourse).":"The variable name used in the docxtemplate (e.g., {crew_communication}). Must be unique within a template."})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsxs(k.Label,{children:["Field Type ",a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(k.Select,{value:E.fieldType||"TEXT",onChange:me=>N(ie=>({...ie,fieldType:me.target.value})),required:!0,children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"PART",children:"PART"}),a.jsx("option",{value:"TOGGLE",children:"TOGGLE"}),a.jsx("option",{value:"SECTION_CONTROL_TOGGLE",children:"SECTION_CONTROL_TOGGLE"}),a.jsx("option",{value:"VALUE_LIST",children:"VALUE_LIST"})]})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Role Required"}),a.jsx(k.Control,{type:"text",value:v!==null&&l[v]?.editBy||"TRAINER",readOnly:!0,disabled:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"}}),a.jsx(k.Text,{className:"text-muted",children:`Automatically set from section's "Edit By" value.`})]})}),a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Parent Template ID"}),a.jsx(k.Control,{type:"text",placeholder:"Leave empty for root level",value:E.parentTempId||"",onChange:me=>N(ie=>({...ie,parentTempId:me.target.value||null}))})]})}),E.tempId&&a.jsx(H,{md:12,children:a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Template ID (read-only)"}),a.jsx(k.Control,{type:"text",value:E.tempId,readOnly:!0,disabled:!0}),a.jsx(k.Text,{className:"text-muted",children:"This is the unique identifier for PART fields. It cannot be changed."})]})})]})})}),a.jsxs(ue.Footer,{children:[a.jsx(se,{variant:"outline-secondary",onClick:je,children:"Cancel"}),a.jsx(se,{variant:"primary",onClick:fe,children:"Save Changes"})]})]})]})},loe=({initialContent:e="",fileName:t="Untitled Document",readOnly:r=!1,showMergeFields:s=!0,importType:n="",className:i=""})=>{const[o,l]=b.useState(!0),[c,d]=b.useState(null),[u,m]=b.useState(!1),[f,h]=b.useState([]),[p]=b.useState(!0),x=b.useRef(!1),g=b.useRef(null),v=b.useRef(null),w=b.useRef(null),y=b.useCallback(()=>{if(x.current=!1,g.current)try{typeof g.current.destroy=="function"&&g.current.destroy()}catch(I){console.warn("Error destroying editor:",I)}},[]);b.useEffect(()=>{console.log(" initialContent changed:",e)},[e]);const S="bd9aaaaddaf94061b51e976a8fd335ce",E=async I=>{try{const D=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),W=btoa(JSON.stringify(I)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),K=`${D}.${W}`,J=new TextEncoder,F=await crypto.subtle.importKey("raw",J.encode(S),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),le=await crypto.subtle.sign("HMAC",F,J.encode(K)),Ae=btoa(String.fromCharCode(...new Uint8Array(le))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),O=`${D}.${W}.${Ae}`;return console.log(" Generated JWT Token (Hardcoded):",O),O}catch(_){return console.error("Error generating JWT token:",_),null}};b.useEffect(()=>{if(!e||e.trim()===""){console.log(" No content provided, setting loading to false"),l(!1);return}if(x.current){console.log(" Editor already initialized, skipping...");return}return x.current=!0,(async()=>{try{let _=0;const D=10;await new Promise((B,Y)=>{const te=()=>{typeof window.DocsAPI<"u"?B():_<D?(_++,console.log(` Waiting for OnlyOffice API... (${_}/${D})`),setTimeout(te,500)):Y(new Error("OnlyOffice API failed to load after 5 seconds"))};te()}),console.log(" OnlyOffice API loaded successfully"),console.log(" DocsAPI structure:",{DocsAPI:typeof window.DocsAPI,DocEditor:typeof window.DocsAPI?.DocEditor,hasEvents:typeof window.DocsAPI?.DocEditor?.prototype?.events});const K=`doc-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;w.current=K,console.log(" Generated documentKey for callback:",K);const F=await E({document:{key:K,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1},url:e},editorConfig:{mode:"edit",user:{id:"test-user",name:"Test User"}}}),le=!0,Ae=`${$a.BASE_URL}/media/docs/onlyoffice/callback`;le&&console.log(" Adding callbackUrl:",Ae);const O={document:{fileType:"docx",key:K,title:t,url:e,permissions:{comment:!1,copy:!0,download:!0,edit:!0,fillForms:!0,modifyContentControl:!0,modifyFilter:!0,print:!0,review:!1}},documentType:"word",editorConfig:{user:{id:"test-user",name:"Test User"},customization:{autosave:!1,forcesave:!0,comments:!1,help:!1,hideRightMenu:!1},mode:"edit"},...le&&{callbackUrl:Ae},token:F,events:{onAppReady:()=>{console.log(" OnlyOffice Document Editor is ready"),m(!0)},onDocumentReady:()=>{console.log(" Document is loaded")},onError:B=>{console.error(" OnlyOffice Error:",B),console.error(" Error details:",{errorCode:B.data?.errorCode,errorDescription:B.data?.errorDescription,error:B.data?.error,fullEvent:B}),ce.error("Error loading document: "+(B.data?.errorDescription||B.data?.error||"Unknown error"))},onDocumentStateChange:B=>{console.log(" Document state changed:",B)},onInfo:B=>{console.log(" OnlyOffice opened in mode:",B.data?.mode)},onRequestSaveAs:async B=>{try{const Y=B?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSaveAs"),console.log(""),console.log(" Event data received:",JSON.stringify(Y,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server");const te=Y.url||Y.downloadUrl||Y.fileUrl||(Array.isArray(Y.files)?Y.files[0]?.url:void 0)||Y.file&&Y.file.url;console.log(" Extracted temporary DOCX URL:",te),te||(console.warn(" onRequestSaveAs received but no URL found in payload"),console.warn(" Full event data:",JSON.stringify(Y,null,2))),v.current&&(te?v.current.resolve(te):v.current.reject(new Error("onRequestSaveAs event received but no URL found")),v.current=null),console.log("")}catch(Y){console.error(" Error in onRequestSaveAs handler:",Y),v.current&&(v.current.reject(Y),v.current=null)}},onRequestSave:B=>{try{const Y=B?.data||{};console.log(""),console.log(" OnlyOffice Event: onRequestSave"),console.log(""),console.log(" Event data received:",JSON.stringify(Y,null,2)),console.log(" This event is triggered when user saves document"),console.log(" NOTE: This is a FRONTEND event, NOT the POST callback to backend"),console.log(" POST callback to backend happens separately from OnlyOffice Server");const te=Y.url||Y.downloadUrl||Y.fileUrl;te&&v.current&&(console.log(" Using URL from onRequestSave:",te),v.current.resolve(te),v.current=null),console.log("")}catch(Y){console.error(" Error in onRequestSave handler:",Y)}}}},G=new window.DocsAPI.DocEditor("onlyoffice-editor",O);d(G),g.current=G,l(!1);const U=B=>{B.data&&B.data.type==="insertText"&&console.log(" Received insert text message:",B.data)};return window.addEventListener("message",U,{passive:!0}),()=>{window.removeEventListener("message",U)}}catch(_){console.error("Error initializing OnlyOffice editor:",_),ce.error("Failed to initialize editor"),l(!1)}})(),y},[e,t,y]);const N=I=>{if(c&&u)try{if(typeof c.createConnector=="function")try{const _=c.createConnector();if(typeof c.asc_enableKeyEvents=="function")try{c.asc_enableKeyEvents(!0)}catch{}if(_&&_.isConnected)try{Asc.scope.__templateText=typeof I=="string"&&I.includes("{")?I:`{${I}}`,_.callCommand(function(){try{const D=Api.GetDocument();console.log(" DEBUG: Starting insert field with style preservation");let W=null;try{const J=D.GetCurrentSentence();console.log(" DEBUG: Current sentence text:",JSON.stringify(J));const F=J&&typeof J=="string"?J.trim():"";if(F&&F.length>0)try{const le=D.Search(F);if(console.log(" DEBUG: Search results count:",le?.length),le&&le.length>0&&le.length<10){const Ae=le[0];console.log(" DEBUG: Got range from search");try{const O=Ae.GetParagraph(0);console.log(" DEBUG: Got paragraph from range");try{W=Ae.GetTextPr(),console.log(" DEBUG: Got TextPr from range");try{const G=Api.CreateRun();G.SetTextPr(W);const U=G.GetBold();console.log(" DEBUG: TextPr has bold:",U)}catch{}}catch(G){console.warn(" DEBUG: GetTextPr() from range failed:",G);try{const U=O.GetElementsCount();if(console.log(" DEBUG: Paragraph has",U,"elements"),U>0){const B=O.GetElement(U-1);console.log(" DEBUG: Got last run from paragraph"),B&&B.GetTextPr&&(W=B.GetTextPr(),console.log(" DEBUG: Got TextPr from last run"))}}catch(U){console.warn(" DEBUG: GetElement() from paragraph failed:",U)}}}catch(O){console.warn(" DEBUG: GetParagraph() from range failed:",O)}}else console.warn(" DEBUG: Too many search results or no results, skipping style copy")}catch(le){console.warn(" DEBUG: Search() failed:",le)}else console.log(" DEBUG: Sentence text is empty or only spaces, will not copy style"),console.log(" DEBUG: Will use default style (no bold)");W||console.warn(" DEBUG: Could not find TextPr, will insert without style")}catch(J){console.warn(" DEBUG: Error getting style:",J)}const K=Api.CreateParagraph();if(W){console.log(" DEBUG: Using copied TextPr for style");const J=Api.CreateRun();J.AddText(Asc.scope.__templateText),J.SetTextPr(W),K.AddElement(J)}else{console.log(" DEBUG: No TextPr found, creating default TextPr (no bold)");const J=Api.CreateTextPr();J.SetBold(!1);const F=Api.CreateRun();F.AddText(Asc.scope.__templateText),F.SetTextPr(J),K.AddElement(F),console.log(" DEBUG: Created run with default style (no bold)")}console.log(" DEBUG: Inserting content with isInline=true"),D.InsertContent([K],!0),console.log(" DEBUG: Insert completed")}catch(D){console.error(" DEBUG: Error inside callCommand:",D),console.error(" DEBUG: Error details:",{message:D.message,stack:D.stack,name:D.name});try{console.log(" DEBUG: Trying fallback method...");const W=Api.GetDocument(),K=Api.CreateParagraph();K.AddText(Asc.scope.__templateText),W.InsertContent([K],!0),console.log(" DEBUG: Fallback method succeeded")}catch(W){throw console.error(" DEBUG: All methods failed:",W),W}}},function(){},function(D){console.error(" DEBUG: callCommand error callback:",D),ce.error("Failed to insert field: "+(D?.message||"Unknown error"))});return}catch{ce.error("Failed to insert field using OnlyOffice Automation API")}}catch{}}catch(_){console.error("Error inserting field:",_),ce.error("Failed to insert field: "+_.message)}else c?u||ce.warning("Editor is still loading, please wait..."):ce.warning("Editor not initialized yet")},j=b.useCallback(()=>w.current,[]),T=b.useCallback(async()=>{try{if(!g.current||!u)throw new Error("Editor not ready");const I=w.current;if(!I)throw new Error("Document key not found");console.log(""),console.log(" CALLBACK FLOW STARTED"),console.log(""),console.log(" Step 1: Triggering document save to send callback..."),console.log(" Step 2: OnlyOffice will send POST callback to backend:"),console.log("   URL:",`${$a.BASE_URL}/media/docs/onlyoffice/callback`),console.log("   Method: POST"),console.log("   Content-Type: application/json"),console.log(""),console.log(" EXPECTED CALLBACK BODY (for reference only):"),console.log(""),console.log(" QUAN TRNG: y l body MONG I, KHNG PHI body thc t!"),console.log(" Frontend KHNG TH thy body thc t v POST callback i trc tip t OnlyOffice  Backend"),console.log(" Body thc t ch c th thy trong Backend logs"),console.log("");const _={key:I,status:6,url:"https://documentserver/url-to-edited-document.docx"};console.log(" Expected Body Structure (Frontend to ra  tham kho):"),console.log(JSON.stringify(_,null,2)),console.log(""),console.log(" Expected Body (One-line JSON - copy  so snh vi Backend logs):"),console.log(JSON.stringify(_)),console.log(""),console.log(" Gii thch cc fields:"),console.log("   - key:",I," DocumentKey ca session ny (Backend s nhn key ny)"),console.log("   - status: 6  Status code (6 = Document saved, OnlyOffice s gi status thc t)"),console.log('   - url: "https://documentserver/..."  PLACEHOLDER, OnlyOffice s thay bng URL thc t'),console.log(""),console.log(" Status Codes c th nhn c t OnlyOffice:"),console.log("   - 0: No errors, document is being edited"),console.log("   - 1: Document is being saved"),console.log("   - 2: Document is saved with errors"),console.log("   - 3: Document saving error has occurred"),console.log("   - 4: Document is closed with no changes"),console.log("   - 6: Document is being saved, document state is saved  Mong i status ny"),console.log("   - 7: Error has occurred while force saving the document"),console.log(""),console.log(" Cch verify callback hot ng:"),console.log("   1. Check Backend logs sau khi click Submit"),console.log("   2. Tm POST request n /media/docs/onlyoffice/callback"),console.log("   3. So snh body trong Backend logs vi expected body  trn"),console.log("   4. Nu key khp v status l 6 hoc 2  Callback  hot ng!"),console.log(""),console.log(" DocumentKey for this session:",I),console.log(" LU : POST callback c gi TRC TIP t OnlyOffice Server  Backend"),console.log(" Frontend KHNG TH thy POST request ny (khng c trong Network tab)"),console.log(" Ch c th verify bng cch check Backend logs"),console.log("");let D=!1;if(typeof g.current.downloadAs=="function")try{console.log(' Attempting to trigger save via downloadAs("docx")...'),console.log("    This will trigger OnlyOffice to save document"),console.log("    OnlyOffice will then send POST callback to backend"),g.current.downloadAs("docx"),D=!0,console.log(' downloadAs("docx") called successfully'),console.log("    Waiting for OnlyOffice to process and send POST callback..."),console.log("    POST callback will be sent to:",`${$a.BASE_URL}/media/docs/onlyoffice/callback`),console.log("    Frontend cannot see this POST request (it goes directly to backend)")}catch(W){console.warn(" downloadAs() failed:",W)}if(!D&&typeof g.current.save=="function")try{console.log(" Attempting to trigger save via save()..."),g.current.save(),D=!0,console.log(" save() called successfully")}catch(W){console.warn(" save() failed:",W)}if(!D&&typeof g.current.downloadDocument=="function")try{console.log(" Attempting to trigger save via downloadDocument()..."),g.current.downloadDocument(),D=!0,console.log(" downloadDocument() called successfully")}catch(W){console.warn(" downloadDocument() failed:",W)}if(!D)throw new Error("No save method available. Tried: downloadAs(), save(), downloadDocument()");return console.log(" Save method triggered successfully!"),console.log(" Step 3: OnlyOffice will send POST callback to backend..."),console.log("    OnlyOffice will POST to:",`${$a.BASE_URL}/media/docs/onlyoffice/callback`),console.log("    Backend should receive callback with documentKey:",I),console.log("    After backend processes, it will store the edited file URL"),console.log(""),console.log(" POLLING DISABLED - Check backend logs to verify callback"),console.log(""),console.log(" To verify callback:"),console.log("   1. Check backend logs for POST /media/docs/onlyoffice/callback"),console.log("   2. Verify backend received callback with documentKey:",I),console.log("   3. Check if backend processed and uploaded file to S3"),console.log(""),ce.info("Document save triggered. Check backend logs to verify callback."),null}catch(I){throw console.error(" Force save and poll failed:",I),ce.error(`Failed: ${I.message}`),I}},[u]),C=b.useCallback(()=>new Promise((I,_)=>{try{if(!g.current){_(new Error("Editor not initialized"));return}if(v.current={resolve:I,reject:_},typeof g.current.downloadDocument=="function"){console.log(" Attempting export via downloadDocument()...");try{g.current.downloadDocument()}catch(D){console.warn("downloadDocument() failed, trying downloadAs()...",D)}}if(typeof g.current.downloadAs=="function"){console.log(' Attempting export via downloadAs("docx")...');try{g.current.downloadAs("docx")}catch(D){console.warn("downloadAs() failed:",D)}}if(typeof g.current.save=="function"){console.log(" Attempting export via save()...");try{g.current.save()}catch(D){console.warn("save() failed:",D)}}setTimeout(()=>{if(v.current){const D=new Error("Export timeout: onRequestSaveAs not received after 20s. OnlyOffice Cloud may not support this method without callbackUrl.");v.current.reject(D),v.current=null}},2e4)}catch(D){v.current?(v.current.reject(D),v.current=null):_(D)}}),[]),L=b.useCallback(async()=>{try{if(!g.current||!u)throw new Error("Editor not ready");ce.info("Exporting document...");const I=await C();if(!I)throw new Error("No temporary URL received from OnlyOffice");console.log(" Got temp URL:",I),ce.info("Downloading file...");const _=await fetch(I);if(!_.ok)throw new Error(`Failed to fetch file: ${_.statusText}`);const D=await _.blob();console.log(" Downloaded blob:",D.size,"bytes");const W=t.endsWith(".docx")?t:`${t}.docx`,K=new File([D],W,{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});ce.info("Uploading to S3...");const J=Ed.getDocsType(W)||"tem",F=await Ed.uploadDocument(K,J);console.log(" Upload API response:",F);let le=null;if(F?.data?.[0]?.url?(le=F.data[0].url,console.log(" Found S3 URL in uploadResult.data[0].url:",le)):F?.data?.url?(le=F.data.url,console.log(" Found S3 URL in uploadResult.data.url:",le)):F?.url?(le=F.url,console.log(" Found S3 URL in uploadResult.url:",le)):F?.fileUrl?(le=F.fileUrl,console.log(" Found S3 URL in uploadResult.fileUrl:",le)):F?.path&&(le=F.path,console.log(" Found S3 URL in uploadResult.path:",le)),!le)throw console.error(" Upload response structure:",JSON.stringify(F,null,2)),new Error("No S3 URL returned from upload API");return console.log(" Final S3 URL to be used in templateContent:",le),console.log(" Full S3 URL:",le),ce.success(`Document uploaded successfully!
URL: ${le}`),le}catch(I){throw console.error(" Export and upload failed:",I),ce.error(`Failed: ${I.message}`),I}},[C,t,u]);if(o)return a.jsx(M,{className:`border-neutral-200 shadow-sm ${i}`,children:a.jsx(M.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:a.jsxs("div",{className:"text-center",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-2 text-muted",children:"Loading OnlyOffice Editor..."}),a.jsx("small",{className:"text-muted",children:"Loading document from S3..."}),a.jsx("br",{}),a.jsxs("small",{className:"text-muted",children:["Content: ",e?"Available":"Not available"]})]})})});if(!e)return a.jsx(M,{className:`border-neutral-200 shadow-sm ${i}`,children:a.jsx(M.Body,{className:"d-flex justify-content-center align-items-center",style:{height:"600px"},children:a.jsx("div",{className:"text-center",children:a.jsxs(Re,{variant:"warning",children:[a.jsx("strong",{children:"No Document URL"}),a.jsx("br",{}),"Please upload a document first to use the editor."]})})})});const A=(I,_)=>{Array.isArray(I)?(h(I),_?.silent||ce.success("Fields updated successfully")):(h(D=>[...D,I]),_?.silent||ce.success(`Added field: ${I.label}`))},P=I=>{h(_=>_.filter((D,W)=>W!==I)),ce.success("Field removed")};return a.jsx("div",{className:`onlyoffice-form-editor ${i}`,children:a.jsx("div",{className:"p-0",children:a.jsxs(oe,{className:"g-0",style:{minHeight:"90vh"},children:[a.jsx(H,{md:s&&(n==="File without fields"&&p||n!=="File without fields")?9:12,children:a.jsxs("div",{className:"p-3",style:{height:"90vh"},children:[a.jsx("div",{className:"d-flex justify-content-end mb-2"}),a.jsx("div",{id:"onlyoffice-editor",style:{width:"100%",height:"100%",border:"1px solid #ddd",borderRadius:"4px"}})]})}),s&&n!=="File without fields"&&a.jsx(H,{md:3,className:"border-start",style:{overflow:"hidden"},children:a.jsx("div",{style:{height:"90vh",overflowY:"auto"},children:a.jsx(ooe,{onInsertField:N,exportEditedDoc:C,initialUrl:e,readOnly:r,className:"h-100"})})}),s&&n==="File without fields"&&p&&a.jsx(H,{md:3,className:"border-start",children:a.jsx("div",{style:{height:"90vh",overflowY:"auto"},children:a.jsx(ioe,{customFields:f,onAddField:A,onRemoveField:P,onInsertField:N,exportEditedDoc:C,exportAndUploadEditedDoc:L,forceSaveAndPoll:T,getDocumentKey:j,readOnly:r,className:"h-100"})})})]})})})},coe=()=>{const e=Qe(),t=$n(),[r,s]=b.useState(""),[n,i]=b.useState("Untitled Document"),[o,l]=b.useState("");b.useEffect(()=>{if(t.state){const{content:d,documentUrl:u,fileName:m,importType:f}=t.state,h=u||d||"";s(h),i(m||"Untitled Document"),l(f||""),console.log(" FormEditorPage received:",{documentUrl:u,content:d,fileName:m,finalContent:h})}},[t.state]);const c=()=>{e("/admin/forms")};return a.jsx(wr,{permission:Ne.TEMPLATES.CREATE,fallback:a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center text-muted",children:[a.jsx("h4",{children:"Access Denied"}),a.jsx("p",{children:"You don't have permission to edit form templates."})]})}),children:a.jsx(_e,{fluid:!0,className:"py-4 form-editor-page form-component",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"border-neutral-200 form-editor-header bg-primary",children:a.jsx(oe,{className:"align-items-center",children:a.jsx(H,{xs:12,md:8,children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(se,{variant:"outline-secondary",onClick:c,className:"me-3",size:"sm",children:a.jsx(Tt,{size:16})}),a.jsxs("div",{children:[a.jsx("h4",{className:"mb-0 text-white",children:n}),o&&a.jsxs("small",{className:"text-white",style:{opacity:.9},children:["Import Type: ",o]})]})]})})})}),a.jsx(M.Body,{className:"p-0",children:a.jsx(loe,{initialContent:r,fileName:n,showImportInfo:!!o,importType:o})})]})})})},doe=()=>{const e=Qe(),t=[{id:"add-template",title:"Add New Template",description:"Create a new form template",icon:aN,path:"/admin/forms",permission:Ne.TEMPLATES.CREATE,color:"primary",action:()=>{e("/admin/forms")}},{id:"add-department",title:"Add New Department",description:"Create a new department",icon:ka,path:"/admin/departments",permission:Ne.DEPARTMENTS.CREATE,color:"primary",action:()=>{e("/admin/departments")}},{id:"bulk-import-user",title:"Bulk Import User",description:"Import multiple users from Excel file",icon:Ts,path:"/admin/users?action=bulk-import",permission:Ne.USERS.BULK_CREATE,color:"primary",action:()=>{e("/admin/users?action=bulk-import")}}];return a.jsx("div",{className:"academic-dashboard-page",style:{paddingBottom:"2rem"},children:a.jsx(_e,{className:"py-4",children:a.jsx(oe,{className:"mb-4",children:a.jsx(H,{lg:12,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"academic-dashboard-section-header bg-primary text-white border-0",children:a.jsx("h5",{className:"mb-0 text-white",children:"Quick Actions"})}),a.jsx(M.Body,{children:a.jsx(oe,{children:t.map((r,s)=>{const n=r.icon;return a.jsx(wr,{permission:r.permission,fallback:null,children:a.jsx(H,{md:4,className:"mb-3",children:a.jsxs("div",{className:"p-3 border rounded cursor-pointer h-100 d-flex flex-column",style:{cursor:"pointer"},onClick:r.action,children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx(n,{size:24,className:`text-${r.color} me-2`}),a.jsx("h6",{className:"mb-0",children:r.title})]}),a.jsx("p",{className:"text-muted small mb-2 flex-grow-1",children:r.description}),a.jsx(on,{size:16,className:`text-${r.color} ms-auto`})]})},s)},r.id)})})})]})})})})})},uoe=`
  .signature-required-table-no-borders .table,
  .signature-required-table-no-borders .table td,
  .signature-required-table-no-borders .table th,
  .signature-required-table-no-borders .table tbody tr,
  .signature-required-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .signature-required-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .signature-required-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=uoe,document.head.appendChild(e)}const moe=({traineeId:e})=>{const t=Qe(),[r,s]=b.useState([]),[n,i]=b.useState(!0),{sortedData:o,sortConfig:l,handleSort:c}=Zt(r);b.useEffect(()=>{d()},[e]);const d=async()=>{try{i(!0);const f=[{id:"1",name:"Safety Training Acknowledgment",course:"Safety Procedures Training",subject:"Basic Safety Protocols",dueDate:"2024-01-25T23:59:59.000Z",status:"PENDING"},{id:"2",name:"Equipment Usage Agreement",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",dueDate:"2024-01-30T23:59:59.000Z",status:"PENDING"},{id:"3",name:"Confidentiality Agreement",course:"Company Policies Training",subject:"Data Protection Guidelines",dueDate:"2024-02-05T23:59:59.000Z",status:"COMPLETED"}];await new Promise(h=>setTimeout(h,300)),s(f)}catch(f){console.error("Error loading signature required:",f),ce.error("Failed to load signature requirements")}finally{i(!1)}},u=f=>{const p={PENDING:{variant:"warning",text:"Pending"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return a.jsx(Pe,{bg:p.variant,children:p.text})},m=f=>{e?t(`/trainee/${e}/signature-pad/${f}`):ce.error("Unable to open signature pad: Trainee ID not found")};return n?a.jsx("div",{className:"text-center py-4",children:a.jsx(Wt,{count:5})}):r.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ln,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No signature requirements"})]}):a.jsx("div",{className:"scrollable-table-container admin-table signature-required-table-no-borders",children:a.jsxs(It,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Document",sortKey:"name",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Course",sortKey:"course",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Subject",sortKey:"subject",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Due Date",sortKey:"dueDate",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Status",sortKey:"status",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:o.map(f=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.name})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.course})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.subject})}),a.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),a.jsx("td",{children:u(f.status)}),a.jsx("td",{children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"Sign Document",icon:a.jsx(ln,{}),onClick:()=>m(f.id)}]})})]},f.id))})]})})},foe=()=>{const{user:e}=_s();return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(moe,{traineeId:e?.id})})},hoe=`
  .section-completion-table-no-borders .table,
  .section-completion-table-no-borders .table td,
  .section-completion-table-no-borders .table th,
  .section-completion-table-no-borders .table tbody tr,
  .section-completion-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .section-completion-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .section-completion-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=hoe,document.head.appendChild(e)}const poe=({traineeId:e})=>{const t=Qe(),[r,s]=b.useState([]),[n,i]=b.useState(!0),{sortedData:o,sortConfig:l,handleSort:c}=Zt(r);b.useEffect(()=>{d()},[e]);const d=async()=>{try{i(!0);const f=[{id:"1",name:"Introduction to Safety Protocols",course:"Safety Procedures Training",subject:"Basic Safety Protocols",section:"Theory",dueDate:"2024-01-25T23:59:59.000Z",progress:75,status:"IN_PROGRESS"},{id:"2",name:"Practical Equipment Handling",course:"Equipment Handling Course",subject:"Heavy Machinery Operation",section:"Practical",dueDate:"2024-01-30T23:59:59.000Z",progress:100,status:"COMPLETED"},{id:"3",name:"Data Protection Guidelines",course:"Company Policies Training",subject:"Data Protection Guidelines",section:"Assessment",dueDate:"2024-02-05T23:59:59.000Z",progress:0,status:"PENDING"}];await new Promise(h=>setTimeout(h,300)),s(f)}catch(f){console.error("Error loading section completion:",f),ce.error("Failed to load section completion requirements")}finally{i(!1)}},u=f=>{const p={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[f]||{variant:"secondary",text:f};return a.jsx(Pe,{bg:p.variant,children:p.text})},m=f=>{e?t(`/trainee/${e}/assessment-section/${f}`):ce.error("Unable to open section: Trainee ID not found")};return n?a.jsx("div",{className:"text-center py-4",children:a.jsx(Wt,{count:5})}):r.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(lt,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:"No sections requiring completion"})]}):a.jsx("div",{className:"scrollable-table-container admin-table section-completion-table-no-borders",children:a.jsxs(It,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Section",sortKey:"name",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Course",sortKey:"course",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Subject",sortKey:"subject",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Type",sortKey:"section",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Due Date",sortKey:"dueDate",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Progress",sortKey:"progress",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Status",sortKey:"status",sortConfig:l,onSort:c})}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:o.map(f=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.name})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.course})}),a.jsx("td",{children:a.jsx("div",{className:"fw-semibold",children:f.subject})}),a.jsx("td",{children:a.jsx(Pe,{bg:"primary",className:"fw-normal",children:f.section})}),a.jsx("td",{children:new Date(f.dueDate).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-primary",style:{width:`${f.progress}%`}})}),a.jsxs("small",{className:"text-muted",children:[f.progress,"%"]})]})}),a.jsx("td",{children:u(f.status)}),a.jsx("td",{children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:f.status==="COMPLETED"?"View Section":"Complete Section",icon:f.status==="COMPLETED"?a.jsx(Nt,{}):a.jsx(lt,{}),onClick:()=>m(f.id)}]})})]},f.id))})]})})},L2=()=>{const{user:e}=_s();return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(poe,{traineeId:e?.id})})},xoe=({uniqueTypes:e,uniqueStatuses:t,uniquePriorities:r,selectedTypes:s,selectedStatuses:n,selectedPriorities:i,onTypeToggle:o,onStatusToggle:l,onPriorityToggle:c,onClearFilters:d,className:u=""})=>{const m=s.length>0||n.length>0||i.length>0;return a.jsxs($t,{className:`filter-panel-dropdown course-filter-dropdown ${u}`,children:[a.jsx($t.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Li,{size:14,className:"me-2"}),"Filters",m&&a.jsx("span",{className:"badge bg-primary ms-2",children:s.length+n.length+i.length})]})}),a.jsxs($t.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px !important",top:"100% !important",transform:"none !important",position:"absolute !important",left:"auto !important",right:"0 !important"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem",paddingTop:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Types"}),s.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>o("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(f=>a.jsx(k.Check,{type:"checkbox",id:`type-${f}`,label:f,checked:s.includes(f),onChange:()=>o(f),className:"mb-1"},f))})]}),a.jsxs("div",{className:"mb-4",style:{paddingLeft:"1.5rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),n.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>l("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:t.map(f=>a.jsx(k.Check,{type:"checkbox",id:`status-${f}`,label:f,checked:n.includes(f),onChange:()=>l(f),className:"mb-1"},f))})]}),a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Priority"}),i.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>c("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:r.map(f=>a.jsx(k.Check,{type:"checkbox",id:`priority-${f}`,label:f,checked:i.includes(f),onChange:()=>c(f),className:"mb-1"},f))})]}),m&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:d,children:[a.jsx(Ze,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},_k=document.createElement("style");_k.textContent=`
  .course-filter-dropdown .course-filter-menu {
    margin-top: 0px !important;
    top: 100% !important;
    transform: none !important;
    position: absolute !important;
  }
`;document.head.appendChild(_k);const goe=`
  .assessments-table-no-borders .table,
  .assessments-table-no-borders .table td,
  .assessments-table-no-borders .table th,
  .assessments-table-no-borders .table tbody tr,
  .assessments-table-no-borders .table thead tr {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
  }
  .assessments-table-no-borders .table tbody tr {
    border-bottom: 1px solid #f0f0f0 !important;
  }
  .assessments-table-no-borders .table tbody tr:last-child {
    border-bottom: none !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=goe,document.head.appendChild(e)}const voe=({traineeId:e})=>{const t=Qe(),[r,s]=b.useState([]),[n,i]=b.useState(!0),[o,l]=b.useState(""),[c,d]=b.useState([]),[u,m]=b.useState([]),[f,h]=b.useState([]),{sortedData:p,sortConfig:x,handleSort:g}=Zt(r);b.useEffect(()=>{v()},[e]);const v=async()=>{try{i(!0);const D=[{id:"1",name:"Safety Procedures Final Exam",description:"Comprehensive final examination covering all safety procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Basic Safety Protocols",code:"BSP"},type:"Written Test",priority:"HIGH",dueDate:"2024-01-25T14:30:00.000Z",status:"PENDING"},{id:"2",name:"Emergency Response Practical",description:"Hands-on assessment of emergency response procedures",course:{name:"Safety Procedures Training",code:"SAF001"},subject:{name:"Emergency Procedures",code:"EP"},type:"Practical Assessment",priority:"HIGH",dueDate:"2024-01-28T10:15:00.000Z",status:"IN_PROGRESS"},{id:"3",name:"Equipment Handling Quiz",description:"Short quiz on proper equipment handling procedures",course:{name:"Equipment Handling Course",code:"EHC001"},subject:{name:"Equipment Handling",code:"EH"},type:"Quiz",priority:"MEDIUM",dueDate:"2024-02-01T16:45:00.000Z",status:"PENDING"}];await new Promise(W=>setTimeout(W,300)),s(D)}catch(D){console.error("Error loading assessments:",D),ce.error("Failed to load assessments")}finally{i(!1)}},w=b.useMemo(()=>r.filter(D=>{const W=o===""||D.name.toLowerCase().includes(o.toLowerCase())||D.description.toLowerCase().includes(o.toLowerCase())||D.course?.name.toLowerCase().includes(o.toLowerCase())||D.subject?.name.toLowerCase().includes(o.toLowerCase()),K=c.length===0||c.includes(D.type),J=u.length===0||u.includes(D.status),F=f.length===0||f.includes(D.priority);return W&&K&&J&&F}),[r,o,c,u,f]),y=b.useMemo(()=>[...new Set(r.map(W=>W.type))].filter(Boolean),[r]),S=b.useMemo(()=>[...new Set(r.map(W=>W.status))].filter(Boolean),[r]),E=b.useMemo(()=>[...new Set(r.map(W=>W.priority))].filter(Boolean),[r]),N=D=>{l(D.target.value)},j=D=>{d(W=>W.includes(D)?W.filter(K=>K!==D):[...W,D])},T=D=>{m(W=>W.includes(D)?W.filter(K=>K!==D):[...W,D])},C=D=>{h(W=>W.includes(D)?W.filter(K=>K!==D):[...W,D])},L=()=>{d([]),m([]),h([]),l("")},A=D=>{const K={PENDING:{variant:"warning",text:"Pending"},IN_PROGRESS:{variant:"primary",text:"In Progress"},COMPLETED:{variant:"success",text:"Completed"},OVERDUE:{variant:"danger",text:"Overdue"}}[D]||{variant:"secondary",text:D};return a.jsx(Pe,{bg:K.variant,children:K.text})},P=D=>{const K={HIGH:{variant:"danger",text:"High"},MEDIUM:{variant:"warning",text:"Medium"},LOW:{variant:"success",text:"Low"}}[D]||{variant:"secondary",text:D};return a.jsx(Pe,{bg:K.variant,children:K.text})},I=D=>{t(`/trainee/${e}/assessment/${D.id}`)},_=D=>{t(`/trainee/${e}/assessment/${D.id}`)};return n?a.jsx("div",{className:"text-center py-4",children:a.jsx(Wt,{count:8})}):a.jsx("div",{className:"trainee-your-assessments",children:a.jsx(M,{className:"shadow-sm",children:a.jsx(M.Body,{className:"p-0",children:a.jsxs(tx,{defaultActiveKey:"upcoming",className:"border-bottom",children:[a.jsx(Vt,{eventKey:"upcoming",title:"Upcoming Assessments",children:a.jsxs("div",{className:"p-3",children:[a.jsx("div",{style:{marginBottom:"3rem"},children:a.jsxs(oe,{className:"form-mobile-stack",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search assessments by name, description, course, or subject...",value:o,onChange:N,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(xoe,{uniqueTypes:y,uniqueStatuses:S,uniquePriorities:E,selectedTypes:c,selectedStatuses:u,selectedPriorities:f,onTypeToggle:j,onStatusToggle:T,onPriorityToggle:C,onClearFilters:L,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[w.length," assessment",w.length!==1?"s":""]})})})]})}),w.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(At,{size:32,className:"text-muted mb-2"}),a.jsx("p",{className:"text-muted mb-0",children:r.length===0?"No upcoming assessments":"No assessments match your filters"})]}):a.jsx("div",{className:"scrollable-table-container admin-table assessments-table-no-borders",children:a.jsxs(It,{hover:!0,className:"mb-0 table-hover",borderless:!0,children:[a.jsx("thead",{className:"table-light",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Assessment",sortKey:"name",sortConfig:x,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Course",sortKey:"course",sortConfig:x,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Subject",sortKey:"subject",sortConfig:x,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Type",sortKey:"type",sortConfig:x,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Priority",sortKey:"priority",sortConfig:x,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Due Date",sortKey:"dueDate",sortConfig:x,onSort:g})}),a.jsx("th",{className:"text-start",children:a.jsx(tr,{title:"Status",sortKey:"status",sortConfig:x,onSort:g})}),a.jsx("th",{className:"text-start",children:"Actions"})]})}),a.jsx("tbody",{children:p.map(D=>a.jsxs("tr",{children:[a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:D.name}),a.jsx("small",{className:"text-muted",children:D.description})]}),a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:D.course?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:D.course?.code||""})]}),a.jsxs("td",{children:[a.jsx("div",{className:"fw-semibold",children:D.subject?.name||"N/A"}),a.jsx("small",{className:"text-muted",children:D.subject?.code||""})]}),a.jsx("td",{children:a.jsx(Pe,{bg:"primary",className:"fw-normal",children:D.type||"Assessment"})}),a.jsx("td",{children:P(D.priority)}),a.jsx("td",{children:D.dueDate?new Date(D.dueDate).toLocaleDateString():"N/A"}),a.jsx("td",{children:A(D.status)}),a.jsx("td",{children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:D.status==="PENDING"||D.status==="IN_PROGRESS"?"Start Assessment":"View Assessment",icon:D.status==="PENDING"||D.status==="IN_PROGRESS"?a.jsx(lx,{}):a.jsx(Nt,{}),onClick:()=>D.status==="PENDING"||D.status==="IN_PROGRESS"?I(D):_(D)}]})})]},D.id))})]})})]})}),a.jsx(Vt,{eventKey:"completed",title:"Completed Assessments",children:a.jsx("div",{className:"p-3",children:a.jsx(t1,{traineeId:e})})})]})})})})},M2=()=>{const{user:e}=_s();return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(voe,{traineeId:e?.id})})},boe=`
  .create-issue-form .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-form .card-header h5 {
    color: #ffffff !important;
  }
  .create-issue-form .card-header svg {
    color: #ffffff !important;
  }
  .create-issue-guidelines .card-header {
    background-color: #1b3c53 !important;
    color: #ffffff !important;
    border-bottom: 1px solid #dee2e6 !important;
  }
  .create-issue-guidelines .card-header h5 {
    color: #ffffff !important;
  }
`;if(typeof document<"u"){const e=document.createElement("style");e.type="text/css",e.innerText=boe,document.head.appendChild(e)}const yoe=()=>{const[e,t]=b.useState({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1}),[r,s]=b.useState(!1),n=o=>{const{name:l,value:c,type:d,checked:u}=o.target;t(m=>({...m,[l]:d==="checkbox"?u:c}))},i=async o=>{o.preventDefault(),s(!0);try{console.log("Submitting incident/feedback report:",e),await new Promise(l=>setTimeout(l,1e3)),ce.success("Incident/Feedback report submitted successfully!"),t({request_type:"",severity:"MEDIUM",title:"",description:"",actions_taken:"",is_anonymous:!1})}catch(l){console.error("Error submitting incident/feedback report:",l),ce.error("Failed to submit incident/feedback report. Please try again.")}finally{s(!1)}};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsx("div",{className:"d-flex align-items-center",children:a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"Create Incident/Feedback Report"}),a.jsx("p",{className:"text-muted mb-0",children:"Report incidents or provide feedback about your training experience"})]})})})}),a.jsxs(oe,{className:"mt-4",children:[a.jsx(H,{lg:8,children:a.jsxs(M,{className:"border-0 shadow-sm create-issue-form",children:[a.jsx(M.Header,{children:a.jsxs("h5",{className:"mb-0 d-flex align-items-center",children:[a.jsx(nr,{className:"me-2",size:20}),"Incident/Feedback Report Form"]})}),a.jsx(M.Body,{children:a.jsxs(k,{onSubmit:i,children:[a.jsxs(oe,{children:[a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Title"}),a.jsx(k.Control,{type:"text",name:"title",value:e.title,onChange:n,placeholder:"Brief description of the incident or feedback"})]})}),a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Request Type *"}),a.jsxs(k.Select,{name:"request_type",value:e.request_type,onChange:n,required:!0,children:[a.jsx("option",{value:"",children:"Select request type"}),a.jsx("option",{value:"SAFETY_REPORT",children:"Safety Report"}),a.jsx("option",{value:"INSTRUCTOR_REPORT",children:"Instructor Report"}),a.jsx("option",{value:"FATIGUE_REPORT",children:"Fatigue Report"}),a.jsx("option",{value:"TRAINING_PROGRAM_REPORT",children:"Training Program Report"}),a.jsx("option",{value:"FACILITIES_REPORT",children:"Facilities Report"}),a.jsx("option",{value:"COURSE_ORGANIZATION_REPORT",children:"Course Organization Report"}),a.jsx("option",{value:"ASSESSMENT_APPROVAL_REQUEST",children:"Assessment Approval Request"}),a.jsx("option",{value:"OTHER",children:"Other"})]})]})})]}),a.jsx(oe,{children:a.jsx(H,{md:6,children:a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Severity"}),a.jsxs(k.Select,{name:"severity",value:e.severity,onChange:n,children:[a.jsx("option",{value:"LOW",children:"Low"}),a.jsx("option",{value:"MEDIUM",children:"Medium"}),a.jsx("option",{value:"HIGH",children:"High"}),a.jsx("option",{value:"CRITICAL",children:"Critical"})]})]})})}),a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Description"}),a.jsx(k.Control,{as:"textarea",rows:4,name:"description",value:e.description,onChange:n,placeholder:"Please provide detailed information about the incident or feedback..."})]}),a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Actions Taken"}),a.jsx(k.Control,{as:"textarea",rows:3,name:"actions_taken",value:e.actions_taken,onChange:n,placeholder:"Describe any actions you have already taken regarding this incident..."})]}),a.jsx(k.Group,{className:"mb-4",children:a.jsx(k.Check,{type:"checkbox",name:"is_anonymous",checked:e.is_anonymous,onChange:n,label:"Submit anonymously (your identity will be kept confidential)"})}),a.jsx("div",{className:"d-flex justify-content-end",children:a.jsx(se,{type:"submit",variant:"primary",disabled:r,children:r?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(nN,{className:"me-2",size:16}),"Submit Incident/Feedback Report"]})})})]})})]})}),a.jsx(H,{lg:4,children:a.jsxs(M,{className:"border-0 shadow-sm create-issue-guidelines",children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Guidelines"})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{children:"Before submitting:"}),a.jsxs("ul",{className:"small text-muted mb-0",children:[a.jsx("li",{children:"Check if the incident has already been reported"}),a.jsx("li",{children:"Provide clear and specific details"}),a.jsx("li",{children:"Include steps to reproduce the incident"}),a.jsx("li",{children:"Attach screenshots if applicable"})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{children:"Response time:"}),a.jsxs("ul",{className:"small text-muted mb-0",children:[a.jsx("li",{children:"High priority: Within 24 hours"}),a.jsx("li",{children:"Medium priority: Within 2-3 days"}),a.jsx("li",{children:"Low priority: Within 1 week"})]})]}),a.jsxs(Re,{variant:"info",className:"small",children:[a.jsx("strong",{children:"Note:"})," All incident/feedback reports are reviewed by our support team. You will receive a response via email."]})]})]})})]})]})},woe=()=>{const e=Qe(),[t,r]=b.useState([]),[s,n]=b.useState(!0),[i,o]=b.useState(""),[l,c]=b.useState("all");Zt(),b.useEffect(()=>{const p=[{id:1,title:"Safety Procedure Issue",description:"Reported safety concern in training module",reporter:"John Smith",reporterEmail:"john.smith@company.com",status:"open",priority:"high",createdAt:"2024-01-15T10:30:00Z",updatedAt:"2024-01-15T14:20:00Z"},{id:2,title:"Training Material Error",description:"Incorrect information in assessment template",reporter:"Sarah Johnson",reporterEmail:"sarah.johnson@company.com",status:"in_progress",priority:"medium",createdAt:"2024-01-14T09:15:00Z",updatedAt:"2024-01-15T11:45:00Z"},{id:3,title:"System Performance Issue",description:"Slow loading times during assessment",reporter:"Mike Wilson",reporterEmail:"mike.wilson@company.com",status:"resolved",priority:"low",createdAt:"2024-01-13T16:20:00Z",updatedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{r(p),n(!1)},1e3)},[]);const d=p=>{const x={open:{variant:"danger",icon:yr},in_progress:{variant:"warning",icon:it},resolved:{variant:"success",icon:lt},closed:{variant:"secondary",icon:Ks}},g=x[p]||x.open,v=g.icon;return a.jsxs(Pe,{bg:g.variant,className:"d-flex align-items-center",children:[a.jsx(v,{size:12,className:"me-1"}),p.replace("_"," ").toUpperCase()]})},u=p=>{const x={high:"danger",medium:"warning",low:"info"};return a.jsx(Pe,{bg:x[p]||"secondary",children:p.toUpperCase()})},m=t.filter(p=>{const x=p.title.toLowerCase().includes(i.toLowerCase())||p.description.toLowerCase().includes(i.toLowerCase())||p.reporter.toLowerCase().includes(i.toLowerCase()),g=l==="all"||p.status===l;return x&&g}),f=p=>{e(`/sqa/issues/${p}`)},h=p=>[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>f(p.id),permission:Ne.SQA.VIEW_TEMPLATES}];return s?a.jsx(_e,{className:"py-4",children:a.jsx(Wt,{})}):a.jsx(_e,{fluid:!0,className:"py-4 issue-list-page",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(oe,{className:"align-items-center",children:a.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsx("div",{className:"d-flex justify-content-end gap-2",children:a.jsx(se,{variant:"outline-primary",size:"sm",children:"Export Issues"})})})})}),a.jsxs(M.Body,{children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search issues by title, description, or reporter...",value:i,onChange:o,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsxs("select",{className:"form-select filter-panel-mobile",value:l,onChange:p=>c(p.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"open",children:"Open"}),a.jsx("option",{value:"in_progress",children:"In Progress"}),a.jsx("option",{value:"resolved",children:"Resolved"}),a.jsx("option",{value:"closed",children:"Closed"})]})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[m.length," issue",m.length!==1?"s":""]})})})]}),a.jsx(po,{data:m,loading:s,columns:[{key:"title",title:"Issue Title",className:"show-mobile",sortable:!0},{key:"reporter",title:"Reporter",className:"hide-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"priority",title:"Priority",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"Created Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(p,x)=>a.jsxs("tr",{className:`${x%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor=x%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:p.title}),a.jsx("small",{className:"text-muted",children:p.description})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:p.reporter}),a.jsx("small",{className:"text-muted",children:p.reporterEmail})]})}),a.jsx("td",{className:"align-middle show-mobile",children:d(p.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:u(p.priority)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(p.createdAt).toLocaleDateString()})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.SQA.VIEW_TEMPLATES],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:h(p)})})})]},p.id),emptyMessage:"No issues found",emptyDescription:"Try adjusting your search criteria."})]})]})})},joe=()=>{const e=Qe(),[t,r]=b.useState([]),[s,n]=b.useState(!0),[i,o]=b.useState(""),[l,c]=b.useState("all");Zt(),b.useEffect(()=>{const x=[{id:1,title:"Training Course Feedback",description:"Positive feedback about the safety training course",submitter:"Sarah Johnson",submitterEmail:"sarah.johnson@company.com",status:"acknowledged",category:"training",rating:5,createdAt:"2024-01-15T10:30:00Z",acknowledgedAt:"2024-01-15T14:20:00Z"},{id:2,title:"System Usability Feedback",description:"Suggestions for improving the assessment interface",submitter:"Mike Wilson",submitterEmail:"mike.wilson@company.com",status:"pending",category:"system",rating:4,createdAt:"2024-01-14T09:15:00Z",acknowledgedAt:null},{id:3,title:"Content Quality Feedback",description:"Feedback about the quality of training materials",submitter:"John Smith",submitterEmail:"john.smith@company.com",status:"acknowledged",category:"content",rating:3,createdAt:"2024-01-13T16:20:00Z",acknowledgedAt:"2024-01-14T09:30:00Z"}];setTimeout(()=>{r(x),n(!1)},1e3)},[]);const d=x=>{const g={pending:{variant:"warning",icon:it},acknowledged:{variant:"success",icon:lt},reviewed:{variant:"info",icon:J2}},v=g[x]||g.pending,w=v.icon;return a.jsxs(Pe,{bg:v.variant,className:"d-flex align-items-center",children:[a.jsx(w,{size:12,className:"me-1"}),x.toUpperCase()]})},u=x=>{const g={training:"primary",system:"info",content:"success",general:"secondary"};return a.jsx(Pe,{bg:g[x]||"secondary",children:x.toUpperCase()})},m=t.filter(x=>{const g=x.title.toLowerCase().includes(i.toLowerCase())||x.description.toLowerCase().includes(i.toLowerCase())||x.submitter.toLowerCase().includes(i.toLowerCase()),v=l==="all"||x.status===l;return g&&v}),f=x=>{e(`/sqa/feedback/${x}`)},h=x=>{e(`/sqa/feedback/${x}/acknowledge`)},p=x=>[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>f(x.id),permission:Ne.SQA.VIEW_TEMPLATES},{label:"Acknowledge",icon:a.jsx(lt,{}),onClick:()=>h(x.id),disabled:x.status==="acknowledged"||x.status==="reviewed",permission:Ne.SQA.VIEW_TEMPLATES}];return s?a.jsx(_e,{className:"py-4",children:a.jsx(Wt,{})}):a.jsx(_e,{fluid:!0,className:"py-4 feedback-list-page",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(oe,{className:"align-items-center",children:a.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsx("div",{className:"d-flex justify-content-end gap-2",children:a.jsx(se,{variant:"outline-primary",size:"sm",children:"Export Feedback"})})})})}),a.jsxs(M.Body,{children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search feedback by title, description, or submitter...",value:i,onChange:o,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsxs("select",{className:"form-select filter-panel-mobile",value:l,onChange:x=>c(x.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"acknowledged",children:"Acknowledged"}),a.jsx("option",{value:"reviewed",children:"Reviewed"})]})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[m.length," feedback",(m.length!==1,"")]})})})]}),a.jsx(po,{data:m,loading:s,columns:[{key:"title",title:"Feedback Title",className:"show-mobile",sortable:!0},{key:"submitter",title:"Submitter",className:"hide-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"category",title:"Category",className:"hide-mobile",sortable:!0},{key:"createdAt",title:"Created Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(x,g)=>a.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:v=>{v.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:v=>{v.currentTarget.style.backgroundColor=g%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:x.title}),a.jsx("small",{className:"text-muted",children:x.description})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:x.submitter}),a.jsx("small",{className:"text-muted",children:x.submitterEmail})]})}),a.jsx("td",{className:"align-middle show-mobile",children:d(x.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:u(x.category)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(x.createdAt).toLocaleDateString()})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.SQA.VIEW_TEMPLATES],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:p(x)})})})]},x.id),emptyMessage:"No feedback found",emptyDescription:"Try adjusting your search criteria."})]})]})})},Noe=()=>{const e=Qe(),[t,r]=b.useState([]),[s,n]=b.useState(!0),[i,o]=b.useState(""),[l,c]=b.useState(""),{sortConfig:d,handleSort:u}=Zt();b.useEffect(()=>{m()},[]);const m=async()=>{try{n(!0);const v=[{id:"1",name:"Safety Assessment Template",description:"Comprehensive safety assessment template for training courses",version:"v2.1",category:"SAFETY",sections:5,fields:23,status:"ACTIVE",createdBy:"John Smith",createdAt:"2024-01-15T00:00:00.000Z"},{id:"2",name:"Technical Skills Evaluation",description:"Template for evaluating technical skills and competencies",version:"v1.5",category:"TECHNICAL",sections:3,fields:15,status:"DRAFT",createdBy:"Sarah Johnson",createdAt:"2024-01-14T00:00:00.000Z"},{id:"3",name:"Compliance Assessment",description:"Template for compliance and regulatory assessments",version:"v3.0",category:"COMPLIANCE",sections:7,fields:31,status:"ACTIVE",createdBy:"Mike Wilson",createdAt:"2024-01-13T00:00:00.000Z"}];await new Promise(w=>setTimeout(w,1e3)),r(v)}catch(v){console.error("Error loading templates:",v)}finally{n(!1)}},f=v=>{switch(v){case"ACTIVE":return{variant:"success",icon:lt,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:it,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:it,text:"INACTIVE"};default:return{variant:"secondary",icon:it,text:v}}},h=v=>{console.log("View detail for template:",v),e(`/sqa/templates/${v}`)},p=v=>{console.log("Disable template:",v)},x=t.filter(v=>{const w=v.name.toLowerCase().includes(i.toLowerCase())||v.description.toLowerCase().includes(i.toLowerCase())||v.createdBy.toLowerCase().includes(i.toLowerCase()),y=!l||v.status===l;return w&&y});if(s)return a.jsx(_e,{fluid:!0,className:"p-4",children:a.jsx(Wt,{})});const g=({columnKey:v,children:w,className:y=""})=>{const S=d.key===v,E=S?d.direction:null;return a.jsxs("th",{className:`fw-semibold ${y}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>u(v),onMouseEnter:N=>{N.target.style.backgroundColor="#214760",N.target.style.transform="translateY(-1px)",N.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:N=>{N.target.style.backgroundColor="var(--bs-primary)",N.target.style.transform="translateY(0)",N.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:S?"600":"500",color:"white"},children:w}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:E,size:14,color:"white"})})]}),S&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsx(_e,{fluid:!0,className:"py-4 template-list-page",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"bg-light-custom border-neutral-200",children:a.jsxs(oe,{className:"align-items-center",children:[a.jsx(H,{xs:12,md:6,children:a.jsx("div",{})}),a.jsx(H,{xs:12,md:6,className:"mt-2 mt-md-0",children:a.jsx("div",{className:"d-flex justify-content-end gap-2",children:a.jsxs(se,{variant:"outline-primary",size:"sm",className:"d-flex align-items-center",children:[a.jsx(Nu,{className:"me-1",size:16}),"Export Templates"]})})})]})}),a.jsxs(M.Body,{children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search templates by name, description, or creator...",value:i,onChange:o,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0",children:a.jsxs(k.Select,{value:l,onChange:v=>c(v.target.value),className:"filter-panel-mobile",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"ACTIVE",children:"Active"}),a.jsx("option",{value:"DRAFT",children:"Draft"}),a.jsx("option",{value:"INACTIVE",children:"Inactive"})]})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[x.length," template",x.length!==1?"s":""]})})})]}),a.jsxs("div",{className:"position-relative",children:[a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(g,{columnKey:"name",className:"show-mobile",children:"Template Name"}),a.jsx(g,{columnKey:"version",className:"hide-mobile",children:"Version"}),a.jsx("th",{className:"text-primary-custom fw-semibold hide-mobile",children:"Sections/Fields"}),a.jsx(g,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(g,{columnKey:"createdBy",className:"hide-mobile",children:"Created By"}),a.jsx(g,{columnKey:"createdAt",className:"hide-mobile",children:"Created Date"}),a.jsx("th",{className:"text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:x.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:"7",className:"text-center py-5",children:[a.jsx(nr,{size:48,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No templates found"}),a.jsx("p",{className:"text-muted",children:"No templates match your current filters."})]})}):x.map((v,w)=>{const y=f(v.status),S=y.icon;return a.jsxs("tr",{className:`${w%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:E=>{E.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:E=>{E.currentTarget.style.backgroundColor=w%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium text-dark",children:v.name}),a.jsx("div",{className:"text-muted small",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:v.description})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx(Pe,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:v.version})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{className:"text-muted small",children:[a.jsxs("div",{children:[v.sections," sections"]}),a.jsxs("div",{children:[v.fields," fields"]})]})}),a.jsx("td",{className:"align-middle",children:a.jsxs(Pe,{bg:y.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx(S,{className:"me-1",size:12}),y.text]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:v.createdBy})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(v.createdAt).toLocaleDateString()})}),a.jsx("td",{className:"align-middle text-center",children:a.jsx(wr,{permissions:[Ne.SQA.VIEW_TEMPLATES,Ne.SQA.VIEW_TEMPLATE_DETAIL],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Detail",icon:a.jsx(Nt,{}),onClick:()=>h(v.id),permission:Ne.SQA.VIEW_TEMPLATE_DETAIL},{label:"Disable Template",icon:a.jsx(Ks,{}),onClick:()=>p(v.id),permission:Ne.SQA.VIEW_TEMPLATES}]})})})]},v.id)})})]})}),x.length>8&&a.jsxs("div",{className:"scroll-indicator",children:[a.jsx(Ha,{size:12,className:"me-1"}),"Scroll to see more templates"]})]})]})]})})},Soe=()=>{const{templateId:e}=Nr(),t=Qe(),[r,s]=b.useState(null),[n,i]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState("overview");b.useEffect(()=>{u()},[e]);const u=async()=>{try{i(!0),l(null);const g={id:e,name:"Safety Assessment Template",description:"Comprehensive safety assessment template for training courses. This template covers all essential safety protocols and procedures required for workplace safety training.",version:"v2.1",category:"SAFETY",totalSections:5,totalFields:23,status:"ACTIVE",createdBy:"John Smith",createdAt:"2024-01-15T00:00:00.000Z",lastModified:"2024-01-20T00:00:00.000Z",lastModifiedBy:"Sarah Johnson",sections:[{id:"1",name:"Personal Protective Equipment",fields:8,order:1},{id:"2",name:"Emergency Procedures",fields:6,order:2},{id:"3",name:"Hazard Identification",fields:5,order:3},{id:"4",name:"Safety Training Records",fields:3,order:4},{id:"5",name:"Compliance Verification",fields:1,order:5}],history:[{version:"v2.1",date:"2024-01-20T00:00:00.000Z",modifiedBy:"Sarah Johnson",changes:"Updated emergency procedures section"},{version:"v2.0",date:"2024-01-15T00:00:00.000Z",modifiedBy:"John Smith",changes:"Initial creation of template"}]};await new Promise(v=>setTimeout(v,1e3)),s(g)}catch(g){console.error("Error loading template detail:",g),l("Failed to load template details")}finally{i(!1)}},m=g=>{switch(g){case"ACTIVE":return{variant:"success",icon:lt,text:"ACTIVE"};case"DRAFT":return{variant:"warning",icon:it,text:"DRAFT"};case"INACTIVE":return{variant:"secondary",icon:it,text:"INACTIVE"};default:return{variant:"secondary",icon:it,text:g}}},f=()=>{console.log("Export PDF for template:",e),alert("PDF export functionality will be implemented")},h=()=>{t("/sqa/templates")};if(n)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading template details..."})]})});if(o)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o}),a.jsxs(se,{variant:"outline-danger",onClick:h,children:[a.jsx(Tt,{className:"me-2"}),"Back to Template List"]})]})});if(!r)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Template Not Found"}),a.jsx("p",{children:"The requested template could not be found."}),a.jsxs(se,{variant:"outline-warning",onClick:h,children:[a.jsx(Tt,{className:"me-2"}),"Back to Template List"]})]})});const p=m(r.status),x=p.icon;return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{xs:12,children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:h,className:"me-3",children:[a.jsx(Tt,{className:"me-1",size:16}),"Back to List"]}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1 text-dark",children:r.name}),a.jsx("p",{className:"text-muted mb-0",children:r.description})]})]}),a.jsx(wr,{permissions:[Ne.SQA.VIEW_TEMPLATES],fallback:null,children:a.jsxs(se,{variant:"primary",size:"sm",onClick:f,className:"d-flex align-items-center",children:[a.jsx(Nu,{className:"me-1",size:16}),"Export PDF"]})})]})})}),a.jsx(oe,{children:a.jsx(H,{xs:12,children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary-custom border-neutral-200 p-0",children:a.jsxs("div",{className:"custom-tabs",children:[a.jsx("button",{className:`custom-tab ${c==="overview"?"active":""}`,onClick:()=>d("overview"),children:"Template Overview"}),a.jsx("button",{className:`custom-tab ${c==="sections"?"active":""}`,onClick:()=>d("sections"),children:"Sections"}),a.jsx("button",{className:`custom-tab ${c==="history"?"active":""}`,onClick:()=>d("history"),children:"Version History"})]})}),a.jsxs(M.Body,{className:"p-0",children:[c==="overview"&&a.jsx("div",{className:"p-4",children:a.jsxs(oe,{children:[a.jsxs(H,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Version"}),a.jsx("div",{children:a.jsx(Pe,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:r.version})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Status"}),a.jsx("div",{children:a.jsxs(Pe,{bg:p.variant,className:"px-2 py-1 d-flex align-items-center",style:{fontSize:"0.75rem",width:"fit-content"},children:[a.jsx(x,{className:"me-1",size:12}),p.text]})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Total Sections"}),a.jsxs("div",{className:"fw-medium",children:[r.totalSections," sections"]})]})]}),a.jsxs(H,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Created By"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"me-2",size:16}),a.jsx("span",{children:r.createdBy})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Created Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{className:"me-2",size:16}),a.jsx("span",{children:new Date(r.createdAt).toLocaleDateString()})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"text-muted small",children:"Last Modified"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{className:"me-2",size:16}),a.jsx("span",{children:new Date(r.lastModified).toLocaleDateString()})]})]})]})]})}),c==="sections"&&a.jsx("div",{className:"p-4",children:a.jsx(po,{data:r.sections||[],loading:!1,columns:[{key:"name",title:"Section Name",className:"show-mobile",sortable:!0},{key:"fields",title:"Fields",className:"show-mobile",sortable:!0},{key:"order",title:"Order",className:"show-mobile",sortable:!0}],renderRow:(g,v)=>a.jsxs("tr",{className:`${v%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:w=>{w.currentTarget.style.backgroundColor=v%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(nr,{className:"me-2 text-primary",size:16}),a.jsx("span",{className:"fw-medium",children:g.name})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs(Pe,{bg:"secondary",className:"px-2 py-1",children:[g.fields," fields"]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-muted",children:g.order})})]},g.id),emptyMessage:"No sections found",emptyDescription:"This template has no sections."})}),c==="history"&&a.jsx("div",{className:"p-4",children:a.jsx(po,{data:r.history||[],loading:!1,columns:[{key:"version",title:"Version",className:"show-mobile",sortable:!0},{key:"modifiedBy",title:"Modified By",className:"show-mobile",sortable:!0},{key:"date",title:"Date",className:"show-mobile",sortable:!0},{key:"changes",title:"Changes",className:"show-mobile",sortable:!0}],renderRow:(g,v)=>a.jsxs("tr",{className:`${v%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:w=>{w.currentTarget.style.backgroundColor=v%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsx(Pe,{bg:"info",className:"px-2 py-1",style:{fontSize:"0.75rem",backgroundColor:"#e3f2fd",color:"#1976d2"},children:g.version})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{className:"me-2",size:16}),a.jsx("span",{children:g.modifiedBy})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{className:"me-2",size:16}),a.jsx("span",{children:new Date(g.date).toLocaleDateString()})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-muted",children:g.changes})})]},v),emptyMessage:"No version history found",emptyDescription:"This template has no version history."})})]})]})})})]})},Eoe=()=>{const e=Qe(),[t,r]=b.useState("upcoming-assessments"),s=[{id:"upcoming-assessments",title:"List Upcoming Assessment",icon:no,description:"View and manage upcoming assessments",color:"primary"},{id:"assessment-results",title:"List Assessment Result",icon:lt,description:"Review completed assessment results",color:"success"},{id:"instructed-courses",title:"List Instructed Course",icon:bt,description:"Manage your instructed courses",color:"info"}],n=[{title:"Configure Signature",description:"Set up your digital signature for assessments",icon:ma,path:"/trainer/configure-signature",color:"warning"},{title:"Section Required Completion",description:"Review sections that require completion",icon:At,path:"/trainer/section-completion",color:"danger"},{title:"Assessment Result Details",description:"View detailed assessment results",icon:Su,path:"/trainer/assessment-details",color:"secondary"},{title:"Result Approval Note",description:"Manage result approval notes",icon:lt,path:"/trainer/approval-notes",color:"success"}],i=()=>{switch(t){case"upcoming-assessments":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Upcoming Assessments"}),a.jsxs(oe,{children:[a.jsx(H,{md:6,className:"mb-3",children:a.jsxs(M,{className:"h-100",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Assessment Schedule"})}),a.jsx(M.Body,{children:a.jsxs("div",{className:"text-center py-4",children:[a.jsx(no,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No upcoming assessments"}),a.jsx("p",{className:"text-muted small",children:"You don't have any upcoming assessments scheduled."})]})})]})}),a.jsx(H,{md:6,className:"mb-3",children:a.jsxs(M,{className:"h-100",children:[a.jsx(M.Header,{className:"bg-success text-white",children:a.jsx("h6",{className:"mb-0",children:"Quick Actions"})}),a.jsx(M.Body,{children:a.jsxs("div",{className:"d-grid gap-2",children:[a.jsxs(se,{variant:"outline-primary",size:"sm",children:[a.jsx(no,{size:16,className:"me-2"}),"Schedule Assessment"]}),a.jsxs(se,{variant:"outline-success",size:"sm",children:[a.jsx(At,{size:16,className:"me-2"}),"View All Assessments"]})]})})]})})]})]});case"assessment-results":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Assessment Results"}),a.jsxs(oe,{children:[a.jsx(H,{md:6,className:"mb-3",children:a.jsxs(M,{className:"h-100",children:[a.jsx(M.Header,{className:"bg-success text-white",children:a.jsx("h6",{className:"mb-0",children:"Recent Results"})}),a.jsx(M.Body,{children:a.jsxs("div",{className:"text-center py-4",children:[a.jsx(lt,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No recent results"}),a.jsx("p",{className:"text-muted small",children:"Assessment results will appear here once completed."})]})})]})}),a.jsx(H,{md:6,className:"mb-3",children:a.jsxs(M,{className:"h-100",children:[a.jsx(M.Header,{className:"bg-info text-white",children:a.jsx("h6",{className:"mb-0",children:"Statistics"})}),a.jsx(M.Body,{children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"row text-center",children:[a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"h4 text-primary",children:"0"}),a.jsx("small",{className:"text-muted",children:"Completed"})]}),a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"h4 text-warning",children:"0"}),a.jsx("small",{className:"text-muted",children:"Pending"})]}),a.jsxs("div",{className:"col-4",children:[a.jsx("div",{className:"h4 text-success",children:"0"}),a.jsx("small",{className:"text-muted",children:"Approved"})]})]})})})]})})]})]});case"instructed-courses":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Instructed Courses"}),a.jsxs(oe,{children:[a.jsx(H,{md:6,className:"mb-3",children:a.jsxs(M,{className:"h-100",children:[a.jsx(M.Header,{className:"bg-info text-white",children:a.jsx("h6",{className:"mb-0",children:"My Courses"})}),a.jsx(M.Body,{children:a.jsxs("div",{className:"text-center py-4",children:[a.jsx(bt,{size:48,className:"text-muted mb-3"}),a.jsx("h6",{className:"text-muted",children:"No courses assigned"}),a.jsx("p",{className:"text-muted small",children:"You haven't been assigned to instruct any courses yet."})]})})]})}),a.jsx(H,{md:6,className:"mb-3",children:a.jsxs(M,{className:"h-100",children:[a.jsx(M.Header,{className:"bg-warning text-white",children:a.jsx("h6",{className:"mb-0",children:"Course Management"})}),a.jsx(M.Body,{children:a.jsxs("div",{className:"d-grid gap-2",children:[a.jsxs(se,{variant:"outline-primary",size:"sm",children:[a.jsx(bt,{size:16,className:"me-2"}),"View All Courses"]}),a.jsxs(se,{variant:"outline-info",size:"sm",children:[a.jsx(it,{size:16,className:"me-2"}),"Course Schedule"]})]})})]})})]})]});default:return null}};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsxs(H,{children:[a.jsx("h2",{className:"mb-2",children:"Trainer Dashboard"}),a.jsx("p",{className:"text-muted",children:"Manage your assessments, courses, and training activities"})]})}),a.jsxs(oe,{children:[a.jsx(H,{lg:3,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Navigation"})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"list-group list-group-flush",children:s.map(o=>{const l=o.icon;return a.jsx("button",{className:`list-group-item list-group-item-action border-0 ${t===o.id?"active":""}`,onClick:()=>r(o.id),style:{backgroundColor:t===o.id?"#0d6efd":"transparent",color:t===o.id?"white":"inherit",border:"none",borderRadius:0},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(l,{size:20,className:"me-3",style:{color:t===o.id?"white":`var(--bs-${o.color})`}}),a.jsxs("div",{className:"flex-grow-1 text-start",children:[a.jsx("h6",{className:"mb-1",children:o.title}),a.jsx("small",{className:"text-muted",children:o.description})]}),a.jsx(on,{size:16})]})},o.id)})})})]})}),a.jsx(H,{lg:9,children:a.jsx(M,{className:"border-0 shadow-sm",children:a.jsx(M.Body,{className:"p-4",children:i()})})})]}),a.jsx(oe,{className:"mt-4",children:a.jsx(H,{children:a.jsx("h4",{className:"mb-3",children:"Quick Actions"})})}),a.jsx(oe,{children:n.map((o,l)=>{const c=o.icon;return a.jsx(H,{lg:6,xl:3,className:"mb-4",children:a.jsx(M,{className:"h-100 border-0 shadow-sm hover-card",style:{cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>e(o.path),onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-5px)",d.currentTarget.style.boxShadow="0 8px 25px rgba(0,0,0,0.15)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)"},children:a.jsxs(M.Body,{className:"p-4",children:[a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:`bg-${o.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"48px",height:"48px"},children:a.jsx(c,{size:24})}),a.jsx("div",{className:"flex-grow-1",children:a.jsx("h5",{className:"mb-1",children:o.title})}),a.jsx(on,{size:20,className:"text-muted"})]}),a.jsx("p",{className:"text-muted mb-0",children:o.description})]})})},l)})})]})},Yn=({uniqueStatuses:e,selectedStatuses:t,onStatusToggle:r,onClearFilters:s,className:n=""})=>{const i=t.length>0;return a.jsxs($t,{className:`filter-panel-dropdown ${n}`,children:[a.jsx($t.Toggle,{variant:"outline-secondary",className:"w-100 d-flex align-items-center justify-content-between position-relative",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Li,{size:14,className:"me-2"}),"Filters",i&&a.jsx("span",{className:"badge bg-primary ms-2",children:t.length})]})}),a.jsxs($t.Menu,{className:"course-filter-menu",style:{width:window.innerWidth<=768?"calc(100vw - 2rem)":"320px",maxWidth:"90vw",maxHeight:window.innerWidth<=768?"50vh":"70vh",overflowY:"auto",marginTop:"0px",top:"100%",transform:"none",position:"absolute"},align:"end",flip:!0,popperConfig:{modifiers:[{name:"offset",options:{offset:[0,0]}},{name:"preventOverflow",options:{boundary:"viewport",padding:16}},{name:"flip",options:{fallbackPlacements:["top-end","bottom-end","top-start"]}}]},children:[a.jsxs("div",{className:"mb-3",style:{paddingLeft:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"},children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("label",{className:"form-label small fw-semibold mb-0",children:"Status"}),t.length>0&&a.jsx(se,{variant:"link",size:"sm",className:"p-0 text-danger",onClick:()=>r("clear"),children:a.jsx(Ze,{size:12})})]}),a.jsx("div",{className:"max-height-150 overflow-auto",children:e.map(o=>a.jsx(k.Check,{type:"checkbox",id:`status-${o}`,label:o,checked:t.includes(o),onChange:()=>r(o),className:"mb-1"},o))})]}),i&&a.jsx("div",{className:"border-top pt-3",style:{paddingLeft:"1.5rem",paddingRight:"1.5rem"},children:a.jsxs(se,{variant:"outline-danger",size:"sm",className:"w-100",onClick:s,children:[a.jsx(Ze,{className:"me-1",size:12}),"Clear All Filters"]})})]})]})},Toe=()=>{const e=Qe(),[t,r]=b.useState([]),[s,n]=b.useState(!0),[i,o]=b.useState(null),[l,c]=b.useState(""),[d,u]=b.useState([]);b.useEffect(()=>{(async()=>{try{n(!0),await new Promise(T=>setTimeout(T,1e3)),r([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",scheduledDate:"2024-01-15",scheduledTime:"09:00",status:"scheduled",duration:"120 minutes",location:"Training Room A"},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",scheduledDate:"2024-01-16",scheduledTime:"14:00",status:"scheduled",duration:"90 minutes",location:"Lab B"},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",scheduledDate:"2024-01-17",scheduledTime:"10:30",status:"pending",duration:"150 minutes",location:"Simulator Room"}])}catch{o("Failed to load upcoming assessments")}finally{n(!1)}})()},[]);const m=N=>{const T={scheduled:{variant:"primary",text:"Scheduled"},pending:{variant:"warning",text:"Pending"},inProgress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[N]||{variant:"secondary",text:N};return a.jsx(Pe,{bg:T.variant,children:T.text})},f=N=>{e(`/trainer/assessments/${N}`)},h=N=>{e(`/trainer/assessments/${N}/edit`)},p=[...new Set(t.map(N=>N.status))],x=t.filter(N=>{const j=d.length===0||d.includes(N.status),T=N.title.toLowerCase().includes(l.toLowerCase())||N.course.toLowerCase().includes(l.toLowerCase())||N.trainee.toLowerCase().includes(l.toLowerCase());return j&&T}),g=N=>{u(N==="clear"?[]:j=>j.includes(N)?j.filter(T=>T!==N):[...j,N])},v=()=>{u([]),c("")},{sortedData:w,sortConfig:y,handleSort:S}=Zt(x);if(s)return a.jsx(Wt,{rows:5,columns:7});if(i)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:i}),a.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(x.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No upcoming assessments found"}),a.jsx("p",{children:"Try adjusting your search criteria or schedule a new assessment."})]})});const E=({columnKey:N,children:j,className:T=""})=>{const C=y.key===N,L=C?y.direction:null;return a.jsxs("th",{className:`fw-semibold ${T}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(N),onMouseEnter:A=>{A.target.style.backgroundColor="#214760",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="var(--bs-primary)",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:C?"600":"500",color:"white"},children:j}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:L,size:14,color:"white"})})]}),C&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search assessments, courses, or trainees...",value:l,onChange:c,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(Yn,{uniqueStatuses:p,selectedStatuses:d,onStatusToggle:g,onClearFilters:v,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(E,{columnKey:"title",className:"show-mobile",children:"Assessment"}),a.jsx(E,{columnKey:"course",className:"show-mobile",children:"Course"}),a.jsx(E,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),a.jsx(E,{columnKey:"scheduledDate",className:"show-mobile",children:"Date & Time"}),a.jsx(E,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),a.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:w.map(N=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:N.title}),a.jsxs("small",{className:"text-muted",children:[a.jsx(it,{size:12,className:"me-1"}),N.location]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:N.course})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:N.trainee})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:N.scheduledDate}),a.jsx("small",{className:"text-muted",children:N.scheduledTime})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-muted",children:N.duration})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:m(N.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>f(N.id)},{label:"Edit Assessment",icon:a.jsx(ox,{}),onClick:()=>h(N.id)}]})})]},N.id))})]})})]})},Aoe=()=>{const[e,t]=b.useState([]),[r,s]=b.useState(!0),[n,i]=b.useState(null),[o,l]=b.useState("all"),[c,d]=b.useState(""),[u,m]=b.useState([]),{sortedData:f,sortConfig:h,handleSort:p}=Zt(e);b.useEffect(()=>{(async()=>{try{s(!0),await new Promise(C=>setTimeout(C,1e3)),t([{id:1,title:"Safety Procedures - Module 1",course:"Aviation Safety Management",trainee:"John Doe",dueDate:"2024-01-20",status:"pending",priority:"high",progress:65,instructor:"Dr. Smith",lastActivity:"2024-01-15",estimatedTime:"2 hours"},{id:2,title:"Engine Maintenance - Part A",course:"Aircraft Maintenance",trainee:"Jane Smith",dueDate:"2024-01-18",status:"in_progress",priority:"medium",progress:30,instructor:"Jane Doe",lastActivity:"2024-01-16",estimatedTime:"3 hours"},{id:3,title:"Navigation Systems - Theory",course:"Flight Operations",trainee:"Mike Johnson",dueDate:"2024-01-22",status:"completed",priority:"low",progress:100,instructor:"Mike Johnson",lastActivity:"2024-01-17",estimatedTime:"1.5 hours"},{id:4,title:"Regulatory Compliance - Section 2",course:"Aviation Regulations",trainee:"Sarah Wilson",dueDate:"2024-01-19",status:"overdue",priority:"high",progress:45,instructor:"Sarah Wilson",lastActivity:"2024-01-14",estimatedTime:"2.5 hours"},{id:5,title:"Emergency Response - Practical",course:"Crisis Management",trainee:"David Brown",dueDate:"2024-01-25",status:"pending",priority:"medium",progress:0,instructor:"David Brown",lastActivity:"2024-01-12",estimatedTime:"4 hours"}])}catch(T){i("Failed to fetch section completion data"),console.error("Error fetching sections:",T)}finally{s(!1)}})()},[]);const x=j=>{const C={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},overdue:{variant:"danger",text:"Overdue"}}[j]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:C.variant,children:C.text})},g=j=>{const C={high:{variant:"danger",text:"High"},medium:{variant:"warning",text:"Medium"},low:{variant:"success",text:"Low"}}[j]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:C.variant,className:"me-1",children:C.text})},v=[...new Set(e.map(j=>j.status))],w=f.filter(j=>{const T=u.length===0||u.includes(j.status),C=c===""||j.title.toLowerCase().includes(c.toLowerCase())||j.course.toLowerCase().includes(c.toLowerCase())||j.trainee.toLowerCase().includes(c.toLowerCase());return T&&C}),y=j=>{m(j==="clear"?[]:T=>T.includes(j)?T.filter(C=>C!==j):[...T,j])},S=()=>{m([]),d("")},E=j=>{console.log("View details for section:",j)},N=j=>{console.log("Mark complete for section:",j)};return r?a.jsx(Wt,{}):n?a.jsxs(Re,{variant:"danger",className:"m-4",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:n})]}):a.jsxs("div",{className:"p-4",children:[a.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search sections, trainees, or courses...",value:c,onChange:d,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(Yn,{uniqueStatuses:v,selectedStatuses:u,onStatusToggle:y,onClearFilters:S,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:()=>p("title"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Section ",a.jsx(ir,{sortConfig:h,columnKey:"title"})]}),a.jsxs("th",{onClick:()=>p("course"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Course ",a.jsx(ir,{sortConfig:h,columnKey:"course"})]}),a.jsxs("th",{onClick:()=>p("trainee"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Trainee ",a.jsx(ir,{sortConfig:h,columnKey:"trainee"})]}),a.jsxs("th",{onClick:()=>p("dueDate"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Due Date ",a.jsx(ir,{sortConfig:h,columnKey:"dueDate"})]}),a.jsxs("th",{onClick:()=>p("status"),className:"sortable border-neutral-200 text-primary-custom fw-semibold",children:["Status ",a.jsx(ir,{sortConfig:h,columnKey:"status"})]}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center",children:"Actions"})]})}),a.jsx("tbody",{children:w.map(j=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:j.title}),a.jsxs("small",{className:"text-muted",children:[a.jsx(it,{size:12,className:"me-1"}),"Est. ",j.estimatedTime]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:j.course}),a.jsxs("small",{className:"text-muted",children:[a.jsx(Lt,{size:12,className:"me-1"}),j.instructor]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:j.trainee}),a.jsxs("small",{className:"text-muted",children:["Last activity: ",j.lastActivity]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-bold",children:j.dueDate}),a.jsx("small",{className:"text-muted",children:g(j.priority)})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[x(j.status),a.jsx("div",{className:"mt-1",children:a.jsxs("small",{className:"text-muted",children:["Progress: ",j.progress,"%"]})})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>E(j.id)},{label:"Mark Complete",icon:a.jsx(lt,{}),onClick:()=>N(j.id)}]})})]},j.id))})]})})]})},Coe=()=>{const[e,t]=b.useState("upcoming-assessments"),r=[{id:"upcoming-assessments",title:"Upcoming Assessments",icon:no,component:a.jsx(Toe,{})},{id:"section-completion",title:"Section Required Completion",icon:At,component:a.jsx(Aoe,{})}],s=r.find(n=>n.id===e);return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0",children:[a.jsx(M.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:r.map(n=>{const i=n.icon,o=e===n.id;return a.jsxs("button",{className:`custom-tab ${o?"active":""}`,onClick:()=>t(n.id),children:[a.jsx(i,{size:16,className:"me-2"}),n.title]},n.id)})})}),a.jsx(M.Body,{className:"p-0",children:s&&s.component})]})})})})},_oe=()=>{const e=Qe(),[t,r]=b.useState([]),[s,n]=b.useState(!0),[i,o]=b.useState(null),[l,c]=b.useState("all"),[d,u]=b.useState(""),[m,f]=b.useState([]),{sortedData:h,sortConfig:p,handleSort:x}=Zt(t);b.useEffect(()=>{(async()=>{try{n(!0),await new Promise(P=>setTimeout(P,1e3)),r([{id:1,title:"Safety Assessment - Module 1",course:"Aviation Safety Management",trainee:"John Doe",completedDate:"2024-01-10",score:85,maxScore:100,status:"completed",grade:"B+",duration:"115 minutes",attempts:1},{id:2,title:"Technical Assessment - Engine Systems",course:"Aircraft Maintenance",trainee:"Jane Smith",completedDate:"2024-01-09",score:92,maxScore:100,status:"completed",grade:"A-",duration:"88 minutes",attempts:1},{id:3,title:"Practical Assessment - Navigation",course:"Flight Operations",trainee:"Mike Johnson",completedDate:"2024-01-08",score:78,maxScore:100,status:"completed",grade:"C+",duration:"142 minutes",attempts:2},{id:4,title:"Regulatory Assessment - Part 121",course:"Aviation Regulations",trainee:"Sarah Wilson",completedDate:"2024-01-07",score:95,maxScore:100,status:"completed",grade:"A",duration:"95 minutes",attempts:1},{id:5,title:"Emergency Procedures Assessment",course:"Crisis Management",trainee:"David Brown",completedDate:"2024-01-06",score:65,maxScore:100,status:"failed",grade:"D",duration:"120 minutes",attempts:1}])}catch{o("Failed to load assessment results")}finally{n(!1)}})()},[]);const g=L=>{const P={completed:{variant:"success",text:"Completed",icon:lt},failed:{variant:"danger",text:"Failed",icon:Ks},inProgress:{variant:"warning",text:"In Progress",icon:it},pending:{variant:"info",text:"Pending Review",icon:it}}[L]||{variant:"secondary",text:L,icon:it},I=P.icon;return a.jsxs(Pe,{bg:P.variant,className:"d-flex align-items-center",children:[a.jsx(I,{size:12,className:"me-1"}),P.text]})},v=L=>L.startsWith("A")?"success":L.startsWith("B")?"primary":L.startsWith("C")?"warning":L.startsWith("D")?"danger":"secondary",w=(L,A)=>{const P=L/A*100;return P>=90?"success":P>=80?"primary":P>=70?"warning":"danger"},y=[...new Set(t.map(L=>L.status))],S=t.filter(L=>{const A=m.length===0||m.includes(L.status),P=L.title.toLowerCase().includes(d.toLowerCase())||L.trainee.toLowerCase().includes(d.toLowerCase())||L.course.toLowerCase().includes(d.toLowerCase());return A&&P}),E=L=>{f(L==="clear"?[]:A=>A.includes(L)?A.filter(P=>P!==L):[...A,L])},N=()=>{f([]),u("")},j=L=>{e(`/trainer/assessment-details/${L}`)},T=L=>{console.log("Downloading result:",L)};if(s)return a.jsx(Wt,{rows:5,columns:7});if(i)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:i}),a.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No assessment results found"}),a.jsx("p",{children:"Try adjusting your search criteria or check back later."})]})});const C=({columnKey:L,children:A,className:P=""})=>{const I=p.key===L,_=I?p.direction:null;return a.jsxs("th",{className:`fw-semibold ${P}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>x(L),onMouseEnter:D=>{D.target.style.backgroundColor="#214760",D.target.style.transform="translateY(-1px)",D.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:D=>{D.target.style.backgroundColor="var(--bs-primary)",D.target.style.transform="translateY(0)",D.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:I?"600":"500",color:"white"},children:A}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:_,size:14,color:"white"})})]}),I&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search assessments, trainees, or courses...",value:d,onChange:u,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(Yn,{uniqueStatuses:y,selectedStatuses:m,onStatusToggle:E,onClearFilters:N,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[S.length," result",S.length!==1?"s":""]})})})]}),S.length===0?a.jsx(M,{className:"text-center py-5",children:a.jsxs(M.Body,{children:[a.jsx(lt,{size:64,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No Results Found"}),a.jsx("p",{className:"text-muted",children:d||l!=="all"?"No assessment results match your current filters.":"No assessment results available yet."}),(d||l!=="all")&&a.jsx(se,{variant:"outline-primary",onClick:()=>{u(""),c("all")},children:"Clear Filters"})]})}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(C,{columnKey:"title",className:"show-mobile",children:"Assessment"}),a.jsx(C,{columnKey:"course",className:"show-mobile",children:"Course"}),a.jsx(C,{columnKey:"trainee",className:"show-mobile",children:"Trainee"}),a.jsx(C,{columnKey:"score",className:"show-mobile",children:"Score"}),a.jsx(C,{columnKey:"grade",className:"hide-mobile",children:"Grade"}),a.jsx(C,{columnKey:"completedDate",className:"show-mobile",children:"Completed"}),a.jsx(C,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(L=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:L.title}),a.jsxs("small",{className:"text-muted",children:["Attempt ",L.attempts,"  ",L.duration]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:L.course})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:L.trainee})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs("span",{className:`fw-bold text-${w(L.score,L.maxScore)}`,children:[L.score,"/",L.maxScore]}),a.jsxs("small",{className:"text-muted ms-2",children:["(",Math.round(L.score/L.maxScore*100),"%)"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx(Pe,{bg:v(L.grade),className:"fs-6",children:L.grade})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsx("div",{children:a.jsx("div",{className:"fw-medium",children:L.completedDate})})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:g(L.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>j(L.id)},{label:"Download Report",icon:a.jsx(Fi,{}),onClick:()=>T(L.id)}]})})]},L.id))})]})})]})},koe=()=>a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(_oe,{})}),Poe=()=>{const e=Qe(),[t,r]=b.useState([]),[s,n]=b.useState(!0),[i,o]=b.useState(null),[l,c]=b.useState("all"),[d,u]=b.useState(""),[m,f]=b.useState([]),{sortedData:h,sortConfig:p,handleSort:x}=Zt(t);b.useEffect(()=>{(async()=>{try{n(!0),await new Promise(A=>setTimeout(A,1e3)),r([{id:1,title:"Aviation Safety Management",code:"ASM-101",department:"Safety & Security",status:"active",startDate:"2024-01-15",endDate:"2024-03-15",enrolledTrainees:25,maxTrainees:30,totalSubjects:8,completedSubjects:3,instructor:"Dr. John Smith",location:"Training Center A",schedule:"Mon, Wed, Fri 9:00-12:00"},{id:2,title:"Aircraft Maintenance Fundamentals",code:"AMF-201",department:"Maintenance",status:"active",startDate:"2024-01-20",endDate:"2024-04-20",enrolledTrainees:18,maxTrainees:20,totalSubjects:12,completedSubjects:5,instructor:"Jane Doe",location:"Lab B",schedule:"Tue, Thu 14:00-17:00"},{id:3,title:"Flight Operations Management",code:"FOM-301",department:"Operations",status:"scheduled",startDate:"2024-02-01",endDate:"2024-05-01",enrolledTrainees:0,maxTrainees:15,totalSubjects:10,completedSubjects:0,instructor:"Mike Johnson",location:"Simulator Room",schedule:"Mon-Fri 8:00-16:00"},{id:4,title:"Aviation Regulations & Compliance",code:"ARC-401",department:"Compliance",status:"completed",startDate:"2023-10-01",endDate:"2023-12-15",enrolledTrainees:22,maxTrainees:25,totalSubjects:6,completedSubjects:6,instructor:"Sarah Wilson",location:"Conference Room C",schedule:"Sat 9:00-17:00"},{id:5,title:"Emergency Response Procedures",code:"ERP-501",department:"Safety & Security",status:"paused",startDate:"2024-01-10",endDate:"2024-02-28",enrolledTrainees:12,maxTrainees:20,totalSubjects:4,completedSubjects:1,instructor:"David Brown",location:"Training Center B",schedule:"Wed, Fri 10:00-14:00"}])}catch{o("Failed to load instructed courses")}finally{n(!1)}})()},[]);const g=C=>{const A={active:{variant:"success",text:"Active"},scheduled:{variant:"primary",text:"Scheduled"},completed:{variant:"secondary",text:"Completed"},paused:{variant:"warning",text:"Paused"},cancelled:{variant:"danger",text:"Cancelled"}}[C]||{variant:"secondary",text:C};return a.jsx(Pe,{bg:A.variant,children:A.text})},v=(C,L)=>L>0?Math.round(C/L*100):0,w=(C,L)=>L>0?Math.round(C/L*100):0,y=[...new Set(t.map(C=>C.status))],S=t.filter(C=>{const L=m.length===0||m.includes(C.status),A=C.title.toLowerCase().includes(d.toLowerCase())||C.code.toLowerCase().includes(d.toLowerCase())||C.department.toLowerCase().includes(d.toLowerCase());return L&&A}),E=C=>{f(C==="clear"?[]:L=>L.includes(C)?L.filter(A=>A!==C):[...L,C])},N=()=>{f([]),u("")},j=C=>{e(`/trainer/courses/${C}`)};if(s)return a.jsx(Wt,{rows:5,columns:7});if(i)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:i}),a.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(t.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No instructed courses found"}),a.jsx("p",{children:"Try adjusting your search criteria or create a new course."})]})});const T=({columnKey:C,children:L,className:A=""})=>{const P=p.key===C,I=P?p.direction:null;return a.jsxs("th",{className:`fw-semibold ${A}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>x(C),onMouseEnter:_=>{_.target.style.backgroundColor="#214760",_.target.style.transform="translateY(-1px)",_.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:_=>{_.target.style.backgroundColor="var(--bs-primary)",_.target.style.transform="translateY(0)",_.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:P?"600":"500",color:"white"},children:L}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:I,size:14,color:"white"})})]}),P&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search courses, codes, or departments...",value:d,onChange:u,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(Yn,{uniqueStatuses:y,selectedStatuses:m,onStatusToggle:E,onClearFilters:N,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[S.length," course",S.length!==1?"s":""]})})})]}),S.length===0?a.jsx(M,{className:"text-center py-5",children:a.jsxs(M.Body,{children:[a.jsx(bt,{size:64,className:"text-muted mb-3"}),a.jsx("h5",{className:"text-muted",children:"No Courses Found"}),a.jsx("p",{className:"text-muted",children:d||l!=="all"?"No courses match your current filters.":"You haven't been assigned to instruct any courses yet."}),d||m.length>0?a.jsx(se,{variant:"outline-primary",onClick:N,children:"Clear Filters"}):null]})}):a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(T,{columnKey:"title",className:"show-mobile",children:"Course"}),a.jsx(T,{columnKey:"department",className:"show-mobile",children:"Department"}),a.jsx(T,{columnKey:"schedule",className:"hide-mobile",children:"Schedule"}),a.jsx(T,{columnKey:"enrollment",className:"show-mobile",children:"Enrollment"}),a.jsx(T,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),a.jsx(T,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(C=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:C.title}),a.jsxs("small",{className:"text-muted",children:[C.code,"  ",C.location]}),a.jsx("br",{}),a.jsxs("small",{className:"text-muted",children:[a.jsx(pr,{size:12,className:"me-1"}),C.startDate," - ",C.endDate]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsx("span",{className:"text-muted",children:C.department})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:C.schedule}),a.jsx("small",{className:"text-muted",children:C.instructor})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ar,{size:16,className:"me-2 text-muted"}),a.jsxs("span",{className:"fw-medium",children:[C.enrolledTrainees,"/",C.maxTrainees]})]}),a.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:a.jsx("div",{className:"progress-bar bg-info",style:{width:`${w(C.enrolledTrainees,C.maxTrainees)}%`}})}),a.jsxs("small",{className:"text-muted",children:[w(C.enrolledTrainees,C.maxTrainees),"% full"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bt,{size:16,className:"me-2 text-muted"}),a.jsxs("span",{className:"fw-medium",children:[C.completedSubjects,"/",C.totalSubjects]})]}),a.jsx("div",{className:"progress mt-1",style:{height:"4px"},children:a.jsx("div",{className:"progress-bar bg-success",style:{width:`${v(C.completedSubjects,C.totalSubjects)}%`}})}),a.jsxs("small",{className:"text-muted",children:[v(C.completedSubjects,C.totalSubjects),"% complete"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:g(C.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Course Detail",icon:a.jsx(Nt,{}),onClick:()=>j(C.id)}]})})]},C.id))})]})})]})},Ooe=()=>a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(Poe,{})}),Doe=({courseId:e})=>{const t=Qe(),[r,s]=b.useState([]),[n,i]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState(""),[u,m]=b.useState([]);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(T=>setTimeout(T,1e3)),s([{id:1,title:"Safety Procedures - Module 1",code:"SP-101",duration:"2 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-20",progress:100,description:"Introduction to aviation safety procedures and protocols"},{id:2,title:"Risk Assessment Fundamentals",code:"RAF-102",duration:"3 hours",status:"completed",instructor:"Dr. Smith",completionDate:"2024-01-25",progress:100,description:"Understanding risk assessment methodologies in aviation"},{id:3,title:"Emergency Response Protocols",code:"ERP-103",duration:"2.5 hours",status:"in_progress",instructor:"Dr. Smith",completionDate:null,progress:65,description:"Emergency response procedures and communication protocols"},{id:4,title:"Regulatory Compliance",code:"RC-104",duration:"4 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Understanding aviation regulations and compliance requirements"},{id:5,title:"Safety Management Systems",code:"SMS-105",duration:"3.5 hours",status:"pending",instructor:"Dr. Smith",completionDate:null,progress:0,description:"Implementation and management of safety management systems"}])}catch(j){l("Failed to load subjects"),console.error("Error fetching subjects:",j)}finally{i(!1)}})()},[e]);const f=N=>{const T={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[N]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:T.variant,children:T.text})},h=N=>{t(`/trainer/subjects/${N}`)},p=[...new Set(r.map(N=>N.status))],x=r.filter(N=>{const j=u.length===0||u.includes(N.status),T=N.title.toLowerCase().includes(c.toLowerCase())||N.code.toLowerCase().includes(c.toLowerCase())||N.description.toLowerCase().includes(c.toLowerCase());return j&&T}),g=N=>{m(N==="clear"?[]:j=>j.includes(N)?j.filter(T=>T!==N):[...j,N])},v=()=>{m([]),d("")},{sortedData:w,sortConfig:y,handleSort:S}=Zt(x);if(n)return a.jsx(Wt,{rows:5,columns:6});if(o)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o}),a.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(x.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No subjects found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})});const E=({columnKey:N,children:j,className:T=""})=>{const C=y.key===N,L=C?y.direction:null;return a.jsxs("th",{className:`fw-semibold ${T}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(N),onMouseEnter:A=>{A.target.style.backgroundColor="#214760",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="var(--bs-primary)",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:C?"600":"500",color:"white"},children:j}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:L,size:14,color:"white"})})]}),C&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search subjects...",value:c,onChange:d,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(Yn,{uniqueStatuses:p,selectedStatuses:u,onStatusToggle:g,onClearFilters:v,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(E,{columnKey:"title",className:"show-mobile",children:"Subject"}),a.jsx(E,{columnKey:"code",className:"show-mobile",children:"Code"}),a.jsx(E,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),a.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(E,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:w.map(N=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:N.title}),a.jsx("small",{className:"text-muted",children:N.description})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:N.code})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:N.duration})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:f(N.status)}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${N.progress}%`},"aria-valuenow":N.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),a.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>h(N.id)}]})})]},N.id))})]})})]})},Ioe=({courseId:e})=>{const t=Qe(),[r,s]=b.useState([]),[n,i]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState(""),[u,m]=b.useState([]);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(T=>setTimeout(T,1e3)),s([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"active",progress:75,lastActivity:"2024-01-20",completedSubjects:6,totalSubjects:8},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"active",progress:60,lastActivity:"2024-01-19",completedSubjects:5,totalSubjects:8},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"completed",progress:100,lastActivity:"2024-01-25",completedSubjects:8,totalSubjects:8},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"inactive",progress:25,lastActivity:"2024-01-22",completedSubjects:2,totalSubjects:8},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"active",progress:40,lastActivity:"2024-01-23",completedSubjects:3,totalSubjects:8}])}catch(j){l("Failed to load trainees"),console.error("Error fetching trainees:",j)}finally{i(!1)}})()},[e]);const f=N=>{const T={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[N]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:T.variant,children:T.text})},h=N=>{t(`/trainer/trainees/${N}`)},p=[...new Set(r.map(N=>N.status))],x=r.filter(N=>{const j=u.length===0||u.includes(N.status),T=N.name.toLowerCase().includes(c.toLowerCase())||N.email.toLowerCase().includes(c.toLowerCase())||N.employeeId.toLowerCase().includes(c.toLowerCase())||N.department.toLowerCase().includes(c.toLowerCase());return j&&T}),g=N=>{m(N==="clear"?[]:j=>j.includes(N)?j.filter(T=>T!==N):[...j,N])},v=()=>{m([]),d("")},{sortedData:w,sortConfig:y,handleSort:S}=Zt(x);if(n)return a.jsx(Wt,{rows:5,columns:7});if(o)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o}),a.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(x.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No trainees found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})});const E=({columnKey:N,children:j,className:T=""})=>{const C=y.key===N,L=C?y.direction:null;return a.jsxs("th",{className:`fw-semibold ${T}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>S(N),onMouseEnter:A=>{A.target.style.backgroundColor="#214760",A.target.style.transform="translateY(-1px)",A.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:A=>{A.target.style.backgroundColor="var(--bs-primary)",A.target.style.transform="translateY(0)",A.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:C?"600":"500",color:"white"},children:j}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:L,size:14,color:"white"})})]}),C&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search trainees...",value:c,onChange:d,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(Yn,{uniqueStatuses:p,selectedStatuses:u,onStatusToggle:g,onClearFilters:v,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(E,{columnKey:"name",className:"show-mobile",children:"Trainee"}),a.jsx(E,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),a.jsx(E,{columnKey:"department",className:"hide-mobile",children:"Department"}),a.jsx(E,{columnKey:"enrollmentDate",className:"show-mobile",children:"Enrollment Date"}),a.jsx(E,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(E,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:w.map(N=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:N.name}),a.jsx("small",{className:"text-muted",children:N.email})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:N.employeeId})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-muted",children:N.department})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:N.enrollmentDate}),a.jsxs("small",{className:"text-muted",children:["Last activity: ",N.lastActivity]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:f(N.status)}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${N.progress}%`},"aria-valuenow":N.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),a.jsxs("small",{className:"text-muted",children:[N.progress,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Profile",icon:a.jsx(Nt,{}),onClick:()=>h(N.id)}]})})]},N.id))})]})})]})},Roe=()=>{const{courseId:e}=Nr(),t=Qe(),[r,s]=b.useState("subjects"),[n,i]=b.useState(null),[o,l]=b.useState(!0),[c,d]=b.useState(null);b.useEffect(()=>{(async()=>{try{l(!0),await new Promise(p=>setTimeout(p,1e3)),i({id:e,title:"Aviation Safety Management",code:"ASM-101",department:"Aviation Department",instructor:"Dr. Smith",startDate:"2024-01-15",endDate:"2024-03-15",status:"active",location:"Training Room A",schedule:"Mon, Wed, Fri 09:00-12:00",description:"Comprehensive course covering aviation safety management systems, risk assessment, and regulatory compliance.",maxEnrollment:30,currentEnrollment:25,completedSubjects:8,totalSubjects:12})}catch(h){d("Failed to load course details"),console.error("Error fetching course:",h)}finally{l(!1)}})()},[e]);const u=[{id:"subjects",title:"Subject List",icon:bt,component:a.jsx(Doe,{courseId:e})},{id:"trainees",title:"Trainee List",icon:Ar,component:a.jsx(Ioe,{courseId:e})}],m=u.find(f=>f.id===r);return o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:c})]})}):n?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t("/trainer/instructed-courses"),children:a.jsx(Tt,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:n.title}),a.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.department]})]})]})})}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0",children:[a.jsx(M.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:u.map(f=>{const h=f.icon,p=r===f.id;return a.jsxs("button",{className:`custom-tab ${p?"active":""}`,onClick:()=>s(f.id),children:[a.jsx(h,{size:16,className:"me-2"}),f.title]},f.id)})})}),a.jsx(M.Body,{className:"p-0",children:m&&m.component})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Course Not Found"}),a.jsx("p",{children:"The requested course could not be found."})]})})},Foe=()=>{const{traineeId:e}=Nr(),t=Qe(),[r,s]=b.useState(null),[n,i]=b.useState(!0),[o,l]=b.useState(null);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(m=>setTimeout(m,1e3)),s({id:e,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",position:"Operations Manager",phone:"+1-555-0123",enrollmentDate:"2024-01-15",status:"active",lastActivity:"2024-01-20",completedCourses:3,totalCourses:5,completedSubjects:12,totalSubjects:20,averageScore:85,certifications:[{name:"Aviation Safety Management",date:"2024-01-20",status:"completed"},{name:"Risk Assessment",date:"2024-01-25",status:"completed"},{name:"Emergency Response",date:"2024-02-01",status:"in_progress"}],currentCourses:[{id:1,name:"Aviation Safety Management",progress:75,instructor:"Dr. Smith"},{id:2,name:"Aircraft Maintenance",progress:45,instructor:"Jane Doe"}]})}catch(u){l("Failed to load trainee details"),console.error("Error fetching trainee:",u)}finally{i(!1)}})()},[e]);const c=d=>{const m={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"}}[d]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:m.variant,children:m.text})};return n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o})]})}):r?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:a.jsx(Tt,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:r.name}),a.jsxs("p",{className:"text-muted mb-0",children:[r.employeeId,"  ",r.department]})]})]})})}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(Lt,{size:24,className:"text-primary mb-2"}),a.jsx("h6",{className:"mb-1",children:"Status"}),c(r.status)]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(bt,{size:24,className:"text-success mb-2"}),a.jsx("h6",{className:"mb-1",children:"Courses"}),a.jsxs("h4",{className:"mb-0 text-success",children:[r.completedCourses,"/",r.totalCourses]}),a.jsx("small",{className:"text-muted",children:"Completed"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"text-info mb-2",children:a.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),a.jsx("h6",{className:"mb-1",children:"Average Score"}),a.jsxs("h4",{className:"mb-0 text-info",children:[r.averageScore,"%"]}),a.jsx("small",{className:"text-muted",children:"Performance"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(pr,{size:24,className:"text-warning mb-2"}),a.jsx("h6",{className:"mb-1",children:"Enrolled"}),a.jsx("h4",{className:"mb-0 text-warning",children:r.enrollmentDate}),a.jsx("small",{className:"text-muted",children:"Start Date"})]})})})]}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:6,children:a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Contact Information"})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(wi,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Email:"})," ",r.email]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Position:"})," ",r.position]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(pr,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Last Activity:"})," ",r.lastActivity]})]})]})}),a.jsx(H,{md:6,children:a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Current Courses"})}),a.jsx(M.Body,{children:r.currentCourses.map(d=>a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[a.jsx("h6",{className:"mb-0",children:d.name}),a.jsxs("small",{className:"text-muted",children:[d.progress,"%"]})]}),a.jsx("div",{className:"progress mb-1",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${d.progress}%`}})}),a.jsxs("small",{className:"text-muted",children:["Instructor: ",d.instructor]})]},d.id))})]})})]}),a.jsx(oe,{children:a.jsx(H,{children:a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Certifications"})}),a.jsx(M.Body,{children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-hover",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Certification"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Status"})]})}),a.jsx("tbody",{children:r.certifications.map((d,u)=>a.jsxs("tr",{children:[a.jsx("td",{children:d.name}),a.jsx("td",{children:d.date}),a.jsx("td",{children:c(d.status)})]},u))})]})})})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Trainee Not Found"}),a.jsx("p",{children:"The requested trainee could not be found."})]})})},Loe=({subjectId:e})=>{const t=Qe(),[r,s]=b.useState([]),[n,i]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState(""),[u,m]=b.useState([]);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(C=>setTimeout(C,1e3)),s([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"EMP001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"EMP002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"EMP003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"EMP004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"EMP005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(T){l("Failed to load trainees in subject"),console.error("Error fetching trainees:",T)}finally{i(!1)}})()},[e]);const f=j=>{const C={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[j]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:C.variant,children:C.text})},h=j=>{t(`/trainer/trainees/${j}`)},p=j=>{console.log("Send message to trainee:",j)},x=[...new Set(r.map(j=>j.status))],g=r.filter(j=>{const T=u.length===0||u.includes(j.status),C=j.name.toLowerCase().includes(c.toLowerCase())||j.email.toLowerCase().includes(c.toLowerCase())||j.employeeId.toLowerCase().includes(c.toLowerCase())||j.department.toLowerCase().includes(c.toLowerCase());return T&&C}),v=j=>{m(j==="clear"?[]:T=>T.includes(j)?T.filter(C=>C!==j):[...T,j])},w=()=>{m([]),d("")},{sortedData:y,sortConfig:S,handleSort:E}=Zt(g);if(n)return a.jsx(Wt,{rows:5,columns:7});if(o)return a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o}),a.jsx(se,{variant:"outline-danger",onClick:()=>window.location.reload(),children:"Try Again"})]});if(g.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No trainees found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})});const N=({columnKey:j,children:T,className:C=""})=>{const L=S.key===j,A=L?S.direction:null;return a.jsxs("th",{className:`fw-semibold ${C}`,style:{cursor:"pointer",userSelect:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},onClick:()=>E(j),onMouseEnter:P=>{P.target.style.backgroundColor="#214760",P.target.style.transform="translateY(-1px)",P.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:P=>{P.target.style.backgroundColor="var(--bs-primary)",P.target.style.transform="translateY(0)",P.target.style.boxShadow="none"},children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative",children:[a.jsx("span",{style:{transition:"all 0.3s ease",fontWeight:L?"600":"500",color:"white"},children:T}),a.jsx("div",{className:"ms-2 d-flex align-items-center",style:{minWidth:"20px",justifyContent:"center"},children:a.jsx(ir,{direction:A,size:14,color:"white"})})]}),L&&a.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"rgba(255, 255, 255, 0.5)",animation:"slideIn 0.3s ease-out"}})]})};return a.jsxs("div",{children:[a.jsxs(oe,{className:"mb-3 mt-4 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search trainees in this subject...",value:c,onChange:d,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(Yn,{uniqueStatuses:x,selectedStatuses:u,onStatusToggle:v,onClearFilters:w,className:"filter-panel-mobile"})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(N,{columnKey:"name",className:"show-mobile",children:"Trainee"}),a.jsx(N,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),a.jsx(N,{columnKey:"department",className:"hide-mobile",children:"Department"}),a.jsx(N,{columnKey:"progress",className:"show-mobile",children:"Progress"}),a.jsx(N,{columnKey:"score",className:"hide-mobile",children:"Score"}),a.jsx(N,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:y.map(j=>a.jsxs("tr",{children:[a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:j.name}),a.jsxs("small",{className:"text-muted",children:[a.jsx(wi,{size:12,className:"me-1"}),j.email]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:j.employeeId})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:a.jsx("span",{className:"text-muted",children:j.department})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"progress flex-grow-1 me-2",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${j.progress}%`},"aria-valuenow":j.progress,"aria-valuemin":"0","aria-valuemax":"100"})}),a.jsxs("small",{className:"text-muted",children:[j.progress,"%"]})]})}),a.jsx("td",{className:"border-neutral-200 align-middle hide-mobile",children:j.score?a.jsxs(Pe,{bg:j.score>=80?"success":j.score>=60?"warning":"danger",children:[j.score,"%"]}):a.jsx("span",{className:"text-muted",children:"-"})}),a.jsx("td",{className:"border-neutral-200 align-middle",children:f(j.status)}),a.jsx("td",{className:"border-neutral-200 align-middle text-center",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Trainee Details",icon:a.jsx(Nt,{}),onClick:()=>h(j.id)},{label:"Send Message",icon:a.jsx(wi,{}),onClick:()=>p(j.id)}]})})]},j.id))})]})})]})},Moe=()=>{const{subjectId:e}=Nr(),t=Qe(),[r,s]=b.useState("trainees"),[n,i]=b.useState(null),[o,l]=b.useState(!0),[c,d]=b.useState(null);b.useEffect(()=>{(async()=>{try{l(!0),await new Promise(x=>setTimeout(x,1e3)),i({id:e,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols",duration:"2 hours",status:"completed",instructor:"Dr. Smith",course:"Aviation Safety Management",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(p){d("Failed to load subject details"),console.error("Error fetching subject:",p)}finally{l(!1)}})()},[e]);const u=h=>{const x={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"}}[h]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:x.variant,children:x.text})},m=[{id:"trainees",title:"Trainee List",icon:Lt,component:a.jsx(Loe,{subjectId:e})}],f=m.find(h=>h.id===r);return o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:c})]})}):n?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:a.jsx(Tt,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:n.title}),a.jsxs("p",{className:"text-muted mb-0",children:[n.code,"  ",n.course]})]})]})})}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(it,{size:24,className:"text-primary mb-2"}),a.jsx("h6",{className:"mb-1",children:"Duration"}),a.jsx("h4",{className:"mb-0 text-primary",children:n.duration}),a.jsx("small",{className:"text-muted",children:"Estimated Time"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(Lt,{size:24,className:"text-success mb-2"}),a.jsx("h6",{className:"mb-1",children:"Trainees"}),a.jsxs("h4",{className:"mb-0 text-success",children:[n.completedTrainees,"/",n.totalTrainees]}),a.jsx("small",{className:"text-muted",children:"Completed"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"text-info mb-2",children:a.jsx("i",{className:"bi bi-graph-up",style:{fontSize:"24px"}})}),a.jsx("h6",{className:"mb-1",children:"Average Score"}),a.jsxs("h4",{className:"mb-0 text-info",children:[n.averageScore,"%"]}),a.jsx("small",{className:"text-muted",children:"Performance"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(lt,{size:24,className:"text-warning mb-2"}),a.jsx("h6",{className:"mb-1",children:"Status"}),u(n.status)]})})})]}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:6,children:a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Subject Information"})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(bt,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Description:"})," ",n.description]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Instructor:"})," ",n.instructor]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(it,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Completion Date:"})," ",n.completionDate]})]})]})}),a.jsx(H,{md:6,children:a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Materials"})}),a.jsx(M.Body,{children:n.materials.map((h,p)=>a.jsxs("div",{className:"mb-2 d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsx("span",{className:"fw-medium",children:h.name}),a.jsx("small",{className:"text-muted d-block",children:h.type})]}),a.jsx("small",{className:"text-muted",children:h.size})]},p))})]})})]}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{children:[a.jsx(M.Header,{children:a.jsx("h5",{className:"mb-0",children:"Assessments"})}),a.jsx(M.Body,{children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-hover",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Assessment"}),a.jsx("th",{children:"Type"}),a.jsx("th",{children:"Max Score"}),a.jsx("th",{children:"Average Score"})]})}),a.jsx("tbody",{children:n.assessments.map((h,p)=>a.jsxs("tr",{children:[a.jsx("td",{children:h.name}),a.jsx("td",{children:h.type}),a.jsx("td",{children:h.maxScore}),a.jsx("td",{children:h.averageScore})]},p))})]})})})]})})}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0",children:[a.jsx(M.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:m.map(h=>{const p=h.icon,x=r===h.id;return a.jsxs("button",{className:`custom-tab ${x?"active":""}`,onClick:()=>s(h.id),children:[a.jsx(p,{size:16,className:"me-2"}),h.title]},h.id)})})}),a.jsx(M.Body,{className:"p-0",children:f&&f.component})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Subject Not Found"}),a.jsx("p",{children:"The requested subject could not be found."})]})})},Boe=()=>{const e=Qe(),[t,r]=b.useState(null),[s,n]=b.useState(null),[i,o]=b.useState(!1),[l,c]=b.useState(!1),[d,u]=b.useState({type:"",text:""}),m=x=>{const g=x.target.files[0];if(g)if(g.type.startsWith("image/")){const v=new FileReader;v.onload=w=>{r(g),n(w.target.result)},v.readAsDataURL(g)}else u({type:"danger",text:"Please upload an image file."})},f=async()=>{if(!t){u({type:"warning",text:"Please upload a signature first."});return}c(!0);try{await new Promise(x=>setTimeout(x,2e3)),u({type:"success",text:"Signature saved successfully!"})}catch{u({type:"danger",text:"Failed to save signature. Please try again."})}finally{c(!1)}},h=()=>{r(null),n(null),u({type:"info",text:"Signature removed."})},p=()=>{e("/profile")};return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsxs(H,{children:[a.jsx("div",{className:"d-flex align-items-center mb-3",children:a.jsxs(se,{variant:"outline-secondary",onClick:p,className:"me-3",children:[a.jsx(Tt,{size:16,className:"me-2"}),"Back to Profile"]})}),a.jsx("h2",{className:"mb-2",children:"Configure Signature"}),a.jsx("p",{className:"text-muted",children:"Upload and manage your digital signature for assessments"})]})}),d.text&&a.jsx(Re,{variant:d.type,className:"mb-4",children:d.text}),a.jsxs(oe,{children:[a.jsx(H,{lg:8,children:a.jsxs(M,{children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0",children:[a.jsx(ma,{size:20,className:"me-2"}),"Digital Signature"]})}),a.jsx(M.Body,{className:"p-4",children:a.jsxs(k,{children:[a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{children:"Upload Signature Image"}),a.jsx(k.Control,{type:"file",accept:"image/*",onChange:m,className:"mb-3"}),a.jsx(k.Text,{className:"text-muted",children:"Supported formats: JPG, PNG, GIF. Maximum size: 2MB"})]}),s&&a.jsxs(k.Group,{className:"mb-4",children:[a.jsx(k.Label,{children:"Signature Preview"}),a.jsx("div",{className:"border rounded p-3 text-center bg-light",children:a.jsx("img",{src:s,alt:"Signature Preview",style:{maxWidth:"100%",maxHeight:"200px"},className:"img-fluid"})})]}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsx(se,{variant:"primary",onClick:f,disabled:!t||l,children:l?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true",style:{width:"0.75rem",height:"0.75rem",borderWidth:"0.15em"}}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{size:16,className:"me-2"}),"Save Signature"]})}),s&&a.jsxs(a.Fragment,{children:[a.jsxs(se,{variant:"outline-info",onClick:()=>o(!0),children:[a.jsx(Nt,{size:16,className:"me-2"}),"Preview"]}),a.jsxs(se,{variant:"outline-danger",onClick:h,children:[a.jsx(Mi,{size:16,className:"me-2"}),"Remove"]})]})]})]})})]})}),a.jsxs(H,{lg:4,children:[a.jsxs(M,{children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Signature Guidelines"})}),a.jsx(M.Body,{children:a.jsxs("ul",{className:"list-unstyled mb-0",children:[a.jsx("li",{className:"mb-2",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Format:"})," Use clear, high-contrast signature"]})}),a.jsx("li",{className:"mb-2",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Size:"})," Recommended 300x100 pixels"]})}),a.jsx("li",{className:"mb-2",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Background:"})," White or transparent background"]})}),a.jsx("li",{className:"mb-2",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Quality:"})," High resolution for clarity"]})}),a.jsx("li",{className:"mb-0",children:a.jsxs("small",{className:"text-muted",children:[a.jsx("strong",{children:"Usage:"})," Will be used on all assessment documents"]})})]})})]}),a.jsxs(M,{className:"mt-3",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Current Status"})}),a.jsx(M.Body,{children:a.jsx("div",{className:"text-center",children:t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-success mb-2",children:a.jsx(ma,{size:32})}),a.jsx("h6",{className:"text-success",children:"Signature Configured"}),a.jsx("small",{className:"text-muted",children:"Your signature is ready for use"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-muted mb-2",children:a.jsx(ma,{size:32})}),a.jsx("h6",{className:"text-muted",children:"No Signature"}),a.jsx("small",{className:"text-muted",children:"Upload a signature to get started"})]})})})]})]})]}),a.jsxs(ue,{show:i,onHide:()=>o(!1),size:"lg",children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsx(ue.Title,{children:"Signature Preview"})}),a.jsx(ue.Body,{className:"text-center",children:s&&a.jsx("div",{className:"border rounded p-4 bg-light",children:a.jsx("img",{src:s,alt:"Signature Preview",style:{maxWidth:"100%",maxHeight:"300px"},className:"img-fluid"})})}),a.jsx(ue.Footer,{children:a.jsx(se,{variant:"secondary",onClick:()=>o(!1),children:"Close"})})]})]})},$oe=()=>{const{resultId:e}=Nr(),t=Qe(),[r,s]=b.useState(null),[n,i]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState("overview");b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(y=>setTimeout(y,1e3)),s({id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",duration:"45 minutes",attempts:1,sections:[{id:1,name:"React Fundamentals",score:20,maxScore:25,status:"completed",timeSpent:"15 minutes"},{id:2,name:"Component Lifecycle",score:18,maxScore:20,status:"completed",timeSpent:"12 minutes"},{id:3,name:"State Management",score:22,maxScore:25,status:"completed",timeSpent:"10 minutes"},{id:4,name:"Advanced Patterns",score:25,maxScore:30,status:"completed",timeSpent:"8 minutes"}],approvalStatus:"pending",approvalNotes:"Waiting for final review from lead trainer."})}catch(w){l("Failed to fetch assessment details."),console.error(w)}finally{i(!1)}})()},[e]);const u=(v,w)=>{const y=v/w*100;return y>=80?"success":y>=60?"warning":"danger"},m=v=>v.includes("A")?"success":v.includes("B")?"info":v.includes("C")?"warning":"danger",f=v=>{const w={completed:{bg:"success",text:"Completed"},in_progress:{bg:"warning",text:"In Progress"},pending:{bg:"secondary",text:"Pending"},failed:{bg:"danger",text:"Failed"}},y=w[v]||w.pending;return a.jsx(Pe,{bg:y.bg,children:y.text})},h=()=>{console.log("Downloading report for result:",e)},p=()=>{t(`/trainer/approval-notes/${e}`)};if(n)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(oe,{children:a.jsx(H,{children:a.jsx(Wt,{height:400})})})});if(o)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(oe,{children:a.jsx(H,{children:a.jsx(Re,{variant:"danger",children:o})})})});if(!r)return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(oe,{children:a.jsx(H,{children:a.jsx(Re,{variant:"info",children:"Assessment result not found"})})})});const x=[{id:"overview",title:"Assessment Overview",icon:nr,component:a.jsx("div",{className:"p-4",children:a.jsxs(oe,{children:[a.jsxs(H,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),a.jsx("h5",{className:"mb-0",children:r.title})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Course"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.course})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.trainee})]})]})]}),a.jsxs(H,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Score"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs("span",{className:`h4 mb-0 text-${u(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),a.jsx(Pe,{bg:m(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Status"}),f(r.status)]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.completedDate})]})]})]})]})})},{id:"sections",title:"Section Breakdown",icon:lN,component:a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Section"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Time Spent"})]})}),a.jsx("tbody",{children:r.sections.map(v=>a.jsxs("tr",{children:[a.jsx("td",{className:"fw-bold",children:v.name}),a.jsx("td",{children:a.jsxs("span",{className:`fw-bold text-${u(v.score,v.maxScore)}`,children:[v.score,"/",v.maxScore]})}),a.jsx("td",{children:f(v.status)}),a.jsx("td",{children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(it,{size:14,className:"me-1 text-muted"}),a.jsx("span",{children:v.timeSpent})]})})]},v.id))})]})})}],g=x.find(v=>v.id===c);return a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[a.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:()=>t("/trainer/assessment-results"),children:[a.jsx(Tt,{size:16,className:"me-2"}),"Back to Results"]}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsxs(se,{variant:"outline-primary",onClick:h,children:[a.jsx(Fi,{size:16,className:"me-2"}),"Download Report"]}),a.jsxs(se,{variant:"outline-secondary",onClick:p,children:[a.jsx(Nt,{size:16,className:"me-2"}),"View Approval Notes"]})]})]})})}),a.jsx(oe,{children:a.jsx(H,{children:a.jsxs(M,{className:"border-0",children:[a.jsx(M.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:x.map(v=>{const w=v.icon,y=c===v.id;return a.jsxs("button",{className:`custom-tab ${y?"active":""}`,onClick:()=>d(v.id),children:[a.jsx(w,{size:16,className:"me-2"}),v.title]},v.id)})})}),a.jsx(M.Body,{className:"p-0",children:g&&g.component})]})})})]})},zoe=()=>{const{resultId:e}=Nr(),t=Qe(),[r,s]=b.useState(null),[n,i]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState(!1),[u,m]=b.useState(!1),[f,h]=b.useState({status:"pending",notes:"",approvedBy:"",approvedDate:""});b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(j=>setTimeout(j,1e3));const N={id:e,title:"Advanced React Assessment",course:"React Development Course",trainee:"John Doe",score:85,maxScore:100,grade:"B+",status:"completed",completedDate:"2024-01-15",approvalStatus:"pending",approvalNotes:"",trainerNotes:"Student shows solid foundation but should focus more on advanced state management techniques.",previousApprovals:[{id:1,status:"approved",notes:"Good performance overall",approvedBy:"Dr. Smith",approvedDate:"2024-01-10",type:"initial"}]};s(N),h({status:N.approvalStatus,notes:N.approvalNotes,approvedBy:"",approvedDate:""})}catch(N){l("Failed to load assessment result data"),console.error("Error fetching result data:",N)}finally{i(!1)}})()},[e]);const p=(E,N)=>{const j=E/N*100;return j>=80?"success":j>=60?"warning":"danger"},x=E=>E.includes("A")?"success":E.includes("B")?"info":E.includes("C")?"warning":"danger",g=E=>{const N={approved:{bg:"success",text:"Approved"},pending:{bg:"warning",text:"Pending Approval"},rejected:{bg:"danger",text:"Rejected"}},j=N[E]||N.pending;return a.jsx(Pe,{bg:j.bg,children:j.text})},v=(E,N)=>{h(j=>({...j,[E]:N}))},w=async()=>{try{d(!0),await new Promise(E=>setTimeout(E,1500)),s(E=>({...E,approvalStatus:f.status,approvalNotes:f.notes})),m(!1),console.log("Approval saved successfully")}catch(E){console.error("Error saving approval:",E)}finally{d(!1)}},y=()=>{h(E=>({...E,status:"approved",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)},S=()=>{h(E=>({...E,status:"rejected",approvedBy:"Current Trainer",approvedDate:new Date().toISOString().split("T")[0]})),m(!0)};return n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(oe,{children:a.jsx(H,{children:a.jsx(Wt,{height:400})})})}):o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(oe,{children:a.jsx(H,{children:a.jsx(Re,{variant:"danger",children:o})})})}):r?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsxs(se,{variant:"outline-secondary",size:"sm",onClick:()=>t(`/trainer/assessment-details/${e}`),className:"me-3",children:[a.jsx(Tt,{size:16,className:"me-2"}),"Back to Details"]}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"Result Approval Note"}),a.jsx("p",{className:"text-muted mb-0",children:"Review and approve assessment results"})]})]})})}),a.jsxs(oe,{children:[a.jsxs(H,{lg:8,children:[a.jsxs(M,{className:"mb-4",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0",children:[a.jsx(nr,{size:20,className:"me-2"}),"Assessment Summary"]})}),a.jsx(M.Body,{children:a.jsxs(oe,{children:[a.jsxs(H,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Assessment Title"}),a.jsx("h5",{className:"mb-0",children:r.title})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Course"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(bt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.course})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Trainee"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.trainee})]})]})]}),a.jsxs(H,{md:6,children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Score"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsxs("span",{className:`h4 mb-0 text-${p(r.score,r.maxScore)}`,children:[r.score,"/",r.maxScore]}),a.jsx(Pe,{bg:x(r.grade),className:"ms-2 fs-6",children:r.grade})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Current Status"}),g(r.approvalStatus)]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h6",{className:"text-muted mb-1",children:"Completed Date"}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(pr,{size:16,className:"me-2 text-muted"}),a.jsx("span",{children:r.completedDate})]})]})]})]})})]}),a.jsxs(M,{className:"mb-4",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0",children:[a.jsx(ox,{size:20,className:"me-2"}),"Trainer Notes"]})}),a.jsx(M.Body,{children:a.jsx("p",{className:"mb-0",children:r.trainerNotes})})]}),r.previousApprovals&&r.previousApprovals.length>0&&a.jsxs(M,{className:"mb-4",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsxs("h5",{className:"mb-0",children:[a.jsx(it,{size:20,className:"me-2"}),"Approval History"]})}),a.jsx(M.Body,{children:r.previousApprovals.map(E=>a.jsxs("div",{className:"border-bottom pb-3 mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[a.jsxs("div",{children:[a.jsxs("h6",{className:"mb-1",children:[E.type.charAt(0).toUpperCase()+E.type.slice(1)," Approval"]}),a.jsxs("small",{className:"text-muted",children:["Approved by ",E.approvedBy," on ",E.approvedDate]})]}),g(E.status)]}),E.notes&&a.jsx("p",{className:"mb-0 text-muted",children:E.notes})]},E.id))})]})]}),a.jsxs(H,{lg:4,children:[a.jsxs(M,{className:"mb-4",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Current Status"})}),a.jsx(M.Body,{children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mb-3",children:g(r.approvalStatus)}),r.approvalNotes&&a.jsxs("div",{children:[a.jsx("h6",{className:"text-muted mb-2",children:"Current Notes"}),a.jsx("p",{className:"small text-muted",children:r.approvalNotes})]})]})})]}),a.jsxs(M,{children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h6",{className:"mb-0",children:"Approval Actions"})}),a.jsx(M.Body,{children:a.jsxs("div",{className:"d-grid gap-2",children:[a.jsxs(se,{variant:"success",onClick:y,className:"d-flex align-items-center justify-content-center",children:[a.jsx(lt,{size:16,className:"me-2"}),"Approve Result"]}),a.jsxs(se,{variant:"danger",onClick:S,className:"d-flex align-items-center justify-content-center",children:[a.jsx(Ks,{size:16,className:"me-2"}),"Reject Result"]})]})})]})]})]}),a.jsxs(ue,{show:u,onHide:()=>m(!1),size:"lg",children:[a.jsx(ue.Header,{closeButton:!0,children:a.jsx(ue.Title,{children:f.status==="approved"?"Approve Assessment Result":"Reject Assessment Result"})}),a.jsx(ue.Body,{children:a.jsxs(k,{children:[a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Approval Notes"}),a.jsx(k.Control,{as:"textarea",rows:4,value:f.notes,onChange:E=>v("notes",E.target.value),placeholder:"Enter your approval notes..."})]}),a.jsxs(k.Group,{className:"mb-3",children:[a.jsx(k.Label,{children:"Approved By"}),a.jsx(k.Control,{type:"text",value:f.approvedBy,onChange:E=>v("approvedBy",E.target.value),placeholder:"Enter your name"})]}),a.jsxs(k.Group,{children:[a.jsx(k.Label,{children:"Approval Date"}),a.jsx(k.Control,{type:"date",value:f.approvedDate,onChange:E=>v("approvedDate",E.target.value)})]})]})}),a.jsxs(ue.Footer,{children:[a.jsx(se,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),a.jsx(se,{variant:f.status==="approved"?"success":"danger",onClick:w,disabled:c,children:c?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{size:16,className:"me-2"}),f.status==="approved"?"Approve":"Reject"]})})]})]})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsx(oe,{children:a.jsx(H,{children:a.jsx(Re,{variant:"info",children:"Assessment result not found"})})})})},Uoe=()=>{const e=Qe(),[t,r]=b.useState("department-dashboard"),s=[{id:"department-dashboard",title:"Department Dashboard",icon:ka,description:"Overview of department activities and statistics",color:"primary"},{id:"my-department-details",title:"My Department Details",icon:bt,description:"Manage courses, subjects, and trainees in your department",color:"info"},{id:"assessment-review-requests",title:"List Assessment Review Requests",icon:At,description:"Review and approve/deny assessment requests",color:"warning"}],n=[{title:"View Course Details",description:"Access detailed course information and management",icon:bt,path:"/department-head/my-department-details",color:"primary"},{title:"Review Assessment Requests",description:"Process pending assessment review requests",icon:At,path:"/department-head/assessment-review-requests",color:"warning"},{title:"Department Statistics",description:"View department performance metrics",icon:Ar,path:"/department-head/statistics",color:"info"},{title:"Trainee Management",description:"Manage trainee enrollments and progress",icon:Ar,path:"/department-head/trainee-management",color:"success"}],i=()=>{switch(t){case"department-dashboard":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Department Dashboard"}),a.jsxs(oe,{children:[a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(bt,{size:24,className:"text-primary"})}),a.jsx("h5",{className:"mb-1",children:"12"}),a.jsx("p",{className:"text-muted mb-0",children:"Active Courses"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(Ar,{size:24,className:"text-success"})}),a.jsx("h5",{className:"mb-1",children:"156"}),a.jsx("p",{className:"text-muted mb-0",children:"Enrolled Trainees"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(At,{size:24,className:"text-warning"})}),a.jsx("h5",{className:"mb-1",children:"8"}),a.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(no,{size:24,className:"text-info"})}),a.jsx("h5",{className:"mb-1",children:"24"}),a.jsx("p",{className:"text-muted mb-0",children:"Upcoming Assessments"})]})})})]})]});case"my-department-details":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"My Department Details"}),a.jsx("p",{className:"text-muted",children:"Access course management, subject lists, and trainee information for your department."}),a.jsxs(se,{variant:"primary",onClick:()=>e("/department-head/my-department-details"),className:"me-2",children:[a.jsx(bt,{className:"me-2"}),"View Course List"]})]});case"assessment-review-requests":return a.jsxs("div",{children:[a.jsx("h4",{className:"mb-4",children:"Assessment Review Requests"}),a.jsx("p",{className:"text-muted",children:"Review and approve or deny assessment requests from your department."}),a.jsxs(se,{variant:"warning",onClick:()=>e("/department-head/assessment-review-requests"),className:"me-2",children:[a.jsx(At,{className:"me-2"}),"View Review Requests"]})]});default:return null}};return a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(oe,{children:[a.jsx(H,{lg:3,className:"mb-4",children:a.jsxs(M,{className:"h-100 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Department Head Portal"})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"list-group list-group-flush",children:s.map(o=>{const l=o.icon,c=t===o.id;return a.jsx("button",{className:`list-group-item list-group-item-action border-0 ${c?"bg-primary text-white":""}`,onClick:()=>r(o.id),style:{border:"none",borderRadius:0,padding:"1rem"},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(l,{size:20,className:`me-3 ${c?"text-white":"text-primary"}`}),a.jsxs("div",{className:"flex-grow-1 text-start",children:[a.jsx("h6",{className:`mb-1 ${c?"text-white":"text-dark"}`,children:o.title}),a.jsx("small",{className:`${c?"text-white-50":"text-muted"}`,children:o.description})]}),c&&a.jsx(on,{size:16,className:"text-white"})]})},o.id)})})})]})}),a.jsxs(H,{lg:9,children:[a.jsx(M,{className:"border-0 shadow-sm",children:a.jsx(M.Body,{children:i()})}),a.jsxs(M,{className:"mt-4 border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-light",children:a.jsx("h5",{className:"mb-0",children:"Quick Actions"})}),a.jsx(M.Body,{children:a.jsx(oe,{children:n.map((o,l)=>{const c=o.icon;return a.jsx(H,{md:6,className:"mb-3",children:a.jsx(se,{variant:"outline-primary",className:"w-100 h-100 p-3 text-start",onClick:()=>e(o.path),style:{minHeight:"80px"},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:`bg-${o.color} bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center me-3`,style:{width:"40px",height:"40px"},children:a.jsx(c,{size:20,className:`text-${o.color}`})}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("h6",{className:"mb-1",children:o.title}),a.jsx("small",{className:"text-muted",children:o.description})]})]})})},l)})})})]})]})]})})},Woe=({course:e,index:t,onView:r,onEdit:s})=>{const n=o=>{const l={active:{variant:"success",icon:lt},inactive:{variant:"secondary",icon:it},pending:{variant:"warning",icon:it}},c=l[o]||l.pending,d=c.icon;return a.jsxs(Pe,{bg:c.variant,className:"d-flex align-items-center",children:[a.jsx(d,{size:12,className:"me-1"}),o.toUpperCase()]})},i=o=>[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>r(o),permission:Ne.COURSES.VIEW_DETAIL},{label:"Edit Course",icon:a.jsx(as,{}),onClick:()=>s(o),permission:Ne.COURSES.UPDATE}];return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:e.title}),a.jsx("small",{className:"text-muted",children:e.description})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark fw-medium",children:e.code})}),a.jsx("td",{className:"align-middle show-mobile",children:n(e.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ar,{size:16,className:"me-1 text-muted"}),a.jsx("span",{children:e.enrolledCount})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(e.startDate).toLocaleDateString()})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.COURSES.VIEW_DETAIL,Ne.COURSES.UPDATE],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:i(e)})})})]})},Hoe=()=>{const e=Qe(),{courseId:t}=Nr(),[r,s]=b.useState([]),[n,i]=b.useState(!0),[o,l]=b.useState(""),[c,d]=b.useState("all"),[u,m]=b.useState(null),[f,h]=b.useState("subjects");b.useEffect(()=>{const w=[{id:1,title:"Software Development Fundamentals",code:"SDF-001",description:"Introduction to software development principles and practices",status:"active",enrolledCount:25,startDate:"2024-01-15T09:00:00Z",department:"IT Department"},{id:2,title:"Database Management Systems",code:"DMS-002",description:"Comprehensive course on database design and management",status:"active",enrolledCount:18,startDate:"2024-01-20T10:00:00Z",department:"IT Department"},{id:3,title:"Web Development Advanced",code:"WDA-003",description:"Advanced web development techniques and frameworks",status:"pending",enrolledCount:12,startDate:"2024-02-01T09:00:00Z",department:"IT Department"}];setTimeout(()=>{s(w),i(!1)},1e3)},[]);const p=r.filter(w=>{const y=w.title.toLowerCase().includes(o.toLowerCase())||w.code.toLowerCase().includes(o.toLowerCase())||w.description.toLowerCase().includes(o.toLowerCase()),S=c==="all"||w.status===c;return y&&S}),x=w=>{m(w),e(`/department-head/my-department-details/${w.id}`)},g=w=>{console.log("Edit course:",w)};return[{id:"subjects",title:"Subject List",icon:bt,component:a.jsx("div",{children:"Subject List Component"})},{id:"trainees",title:"Trainee List",icon:Ar,component:a.jsx("div",{children:"Trainee List Component"})}].find(w=>w.id===f),n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading department details..."})]})}):a.jsx(_e,{fluid:!0,className:"py-4 my-department-details-page",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(oe,{className:"align-items-center",children:a.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e("/department-head/dashboard"),children:a.jsx(Tt,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"My Department Details"}),a.jsx("p",{className:"text-muted mb-0",children:"Manage courses, subjects, and trainees in your department"})]})]})})})}),a.jsx(M.Body,{children:a.jsxs(M,{className:"border-0 shadow-sm mb-0",children:[a.jsx(M.Header,{className:"department-head-section-header bg-primary text-white border-0",children:a.jsx("div",{className:"d-flex justify-content-between align-items-center",children:a.jsxs("h5",{className:"mb-0 text-white",children:[a.jsx(bt,{className:"me-2"}),"Courses (",p.length,")"]})})}),a.jsxs(M.Body,{children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search courses by title, code, or description...",value:o,onChange:l,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsxs("select",{className:"form-select filter-panel-mobile",value:c,onChange:w=>d(w.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"}),a.jsx("option",{value:"pending",children:"Pending"})]})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[p.length," course",p.length!==1?"s":""]})})})]}),a.jsx(po,{data:p,loading:n,columns:[{key:"title",title:"Course Title",className:"show-mobile",sortable:!0},{key:"code",title:"Course Code",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"enrolledCount",title:"Enrolled",className:"hide-mobile",sortable:!0},{key:"startDate",title:"Start Date",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(w,y)=>a.jsx(Woe,{course:w,index:y,onView:x,onEdit:g},w.id),emptyMessage:"No courses found",emptyDescription:"Try adjusting your search criteria."})]})]})})]})})},Voe=({request:e,index:t,onView:r,onApprove:s,onDeny:n})=>{const i=l=>{const c={pending:{variant:"warning",icon:it},approved:{variant:"success",icon:lt},denied:{variant:"danger",icon:Ks}},d=c[l]||c.pending,u=d.icon;return a.jsxs(Pe,{bg:d.variant,className:"d-flex align-items-center",children:[a.jsx(u,{size:12,className:"me-1"}),l.toUpperCase()]})},o=l=>{const c=[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>r(l),permission:Ne.ASSESSMENTS.VIEW_DETAIL}];return l.status==="pending"&&c.push({type:"divider"},{label:"Approve Results",icon:a.jsx(K2,{}),className:"text-success",onClick:()=>s(l),permission:Ne.ASSESSMENTS.APPROVE},{label:"Deny Results",icon:a.jsx(Ze,{}),className:"text-danger",onClick:()=>n(l),permission:Ne.ASSESSMENTS.APPROVE}),c};return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:e.traineeName}),a.jsx("small",{className:"text-muted",children:e.traineeEmail})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:e.courseTitle}),a.jsx("small",{className:"text-muted",children:e.courseCode})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"fw-medium",children:e.assessmentTitle}),a.jsx("small",{className:"text-muted",children:e.assessmentType})]})}),a.jsx("td",{className:"align-middle show-mobile",children:i(e.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(e.submittedDate).toLocaleDateString()})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"fw-medium",children:e.score?`${e.score}%`:"N/A"})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.ASSESSMENTS.VIEW_DETAIL,Ne.ASSESSMENTS.APPROVE],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:o(e)})})})]})},B2=()=>{const e=Qe(),[t,r]=b.useState([]),[s,n]=b.useState(!0),[i,o]=b.useState(""),[l,c]=b.useState("all");b.useEffect(()=>{const x=[{id:1,traineeName:"John Smith",traineeEmail:"john.smith@company.com",courseTitle:"Software Development Fundamentals",courseCode:"SDF-001",assessmentTitle:"Final Assessment",assessmentType:"Practical Exam",status:"pending",submittedDate:"2024-01-15T14:30:00Z",score:85,department:"IT Department"},{id:2,traineeName:"Sarah Johnson",traineeEmail:"sarah.johnson@company.com",courseTitle:"Database Management Systems",courseCode:"DMS-002",assessmentTitle:"Database Design Project",assessmentType:"Project",status:"pending",submittedDate:"2024-01-14T16:45:00Z",score:92,department:"IT Department"},{id:3,traineeName:"Mike Wilson",traineeEmail:"mike.wilson@company.com",courseTitle:"Web Development Advanced",courseCode:"WDA-003",assessmentTitle:"Frontend Development Test",assessmentType:"Written Exam",status:"approved",submittedDate:"2024-01-13T10:20:00Z",score:78,department:"IT Department"},{id:4,traineeName:"Emily Davis",traineeEmail:"emily.davis@company.com",courseTitle:"Software Development Fundamentals",courseCode:"SDF-001",assessmentTitle:"Midterm Assessment",assessmentType:"Practical Exam",status:"denied",submittedDate:"2024-01-12T09:15:00Z",score:45,department:"IT Department"}];setTimeout(()=>{r(x),n(!1)},1e3)},[]);const d=t.filter(x=>{const g=x.traineeName.toLowerCase().includes(i.toLowerCase())||x.courseTitle.toLowerCase().includes(i.toLowerCase())||x.assessmentTitle.toLowerCase().includes(i.toLowerCase()),v=l==="all"||x.status===l;return g&&v}),u=x=>{e(`/department-head/assessment-review-requests/${x.id}`)},m=x=>{console.log("Approve request:",x),r(g=>g.map(v=>v.id===x.id?{...v,status:"approved"}:v))},f=x=>{console.log("Deny request:",x),r(g=>g.map(v=>v.id===x.id?{...v,status:"denied"}:v))},p=(()=>{const x=t.reduce((g,v)=>(g[v.status]=(g[v.status]||0)+1,g),{});return{pending:x.pending||0,approved:x.approved||0,denied:x.denied||0,total:t.length}})();return s?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading assessment review requests..."})]})}):a.jsx(_e,{fluid:!0,className:"py-4 assessment-review-requests-page",children:a.jsxs(M,{className:"border-neutral-200 shadow-sm",children:[a.jsx(M.Header,{className:"bg-light-custom border-neutral-200",children:a.jsx(oe,{className:"align-items-center",children:a.jsx(H,{xs:12,className:"mt-2 mt-md-0 mb-3",children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e("/department-head/dashboard"),children:a.jsx(Tt,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:"Assessment Review Requests"}),a.jsx("p",{className:"text-muted mb-0",children:"Review and approve/deny assessment requests from your department"})]})]})})})}),a.jsxs(M.Body,{children:[a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(it,{size:24,className:"text-warning"})}),a.jsx("h5",{className:"mb-1",children:p.pending}),a.jsx("p",{className:"text-muted mb-0",children:"Pending Reviews"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(lt,{size:24,className:"text-success"})}),a.jsx("h5",{className:"mb-1",children:p.approved}),a.jsx("p",{className:"text-muted mb-0",children:"Approved"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-danger bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(Ks,{size:24,className:"text-danger"})}),a.jsx("h5",{className:"mb-1",children:p.denied}),a.jsx("p",{className:"text-muted mb-0",children:"Denied"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px"},children:a.jsx(At,{size:24,className:"text-primary"})}),a.jsx("h5",{className:"mb-1",children:p.total}),a.jsx("p",{className:"text-muted mb-0",children:"Total Requests"})]})})})]}),a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search requests by trainee name, course, or assessment...",value:i,onChange:o,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsxs("select",{className:"form-select filter-panel-mobile",value:l,onChange:x=>c(x.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"denied",children:"Denied"})]})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[d.length," request",d.length!==1?"s":""]})})})]}),a.jsx(po,{data:d,loading:s,columns:[{key:"traineeName",title:"Trainee Name",className:"show-mobile",sortable:!0},{key:"courseTitle",title:"Course",className:"show-mobile",sortable:!0},{key:"assessmentTitle",title:"Assessment",className:"show-mobile",sortable:!0},{key:"status",title:"Status",className:"show-mobile",sortable:!0},{key:"submittedDate",title:"Submitted Date",className:"hide-mobile",sortable:!0},{key:"score",title:"Score",className:"hide-mobile",sortable:!0},{title:"Actions",className:"text-center show-mobile",sortable:!1}],renderRow:(x,g)=>a.jsx(Voe,{request:x,index:g,onView:u,onApprove:m,onDeny:f},x.id),emptyMessage:"No assessment requests found",emptyDescription:"Try adjusting your search criteria."})]})]})})},Goe=({subjects:e,loading:t,onView:r,onEdit:s})=>{const{sortedData:n,sortConfig:i,handleSort:o}=Zt(e);if(t)return a.jsx(Wt,{rows:5,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No subjects found"}),a.jsx("p",{children:"No subjects are available in this course."})]})});const l=({columnKey:c,children:d,className:u=""})=>{const f=i.key===c?i.direction:null;return a.jsx("th",{className:`fw-semibold ${u}`,onClick:()=>o(c),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{style:{color:"white"},children:d}),a.jsx(ir,{direction:f,className:"ms-1",color:"white"})]})})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(l,{columnKey:"title",className:"show-mobile",children:"Subject Title"}),a.jsx(l,{columnKey:"code",className:"show-mobile",children:"Subject Code"}),a.jsx(l,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(l,{columnKey:"enrolledCount",className:"hide-mobile",children:"Enrolled"}),a.jsx(l,{columnKey:"duration",className:"hide-mobile",children:"Duration"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:n.map((c,d)=>a.jsx(qoe,{subject:c,index:d,onView:r,onEdit:s},c.id))})]})})},qoe=({subject:e,index:t,onView:r,onEdit:s})=>{const n=o=>{const l={active:{variant:"success",icon:lt},inactive:{variant:"secondary",icon:it},pending:{variant:"warning",icon:it}},c=l[o]||l.pending,d=c.icon;return a.jsxs(Pe,{bg:c.variant,className:"d-flex align-items-center",children:[a.jsx(d,{size:12,className:"me-1"}),o.toUpperCase()]})},i=o=>[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>r(o),permission:Ne.SUBJECTS.VIEW_DETAIL},{label:"Edit Subject",icon:a.jsx(as,{}),onClick:()=>s(o),permission:Ne.SUBJECTS.UPDATE}];return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:e.title}),a.jsx("small",{className:"text-muted",children:e.description})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark fw-medium",children:e.code})}),a.jsx("td",{className:"align-middle show-mobile",children:n(e.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Ar,{size:16,className:"me-1 text-muted"}),a.jsx("span",{children:e.enrolledCount})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{className:"text-muted small",children:[e.duration," hours"]})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.SUBJECTS.VIEW_DETAIL,Ne.SUBJECTS.UPDATE],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:i(e)})})})]})},Koe=({trainees:e,loading:t,onView:r,onEdit:s})=>{const{sortedData:n,sortConfig:i,handleSort:o}=Zt(e);if(t)return a.jsx(Wt,{rows:5,columns:6});if(e.length===0)return a.jsx("div",{className:"text-center py-5",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No trainees found"}),a.jsx("p",{children:"No trainees are enrolled in this course."})]})});const l=({columnKey:c,children:d,className:u=""})=>{const f=i.key===c?i.direction:null;return a.jsx("th",{className:`fw-semibold ${u}`,onClick:()=>o(c),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{style:{color:"white"},children:d}),a.jsx(ir,{direction:f,className:"ms-1",color:"white"})]})})};return a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs("table",{className:"table table-hover mb-0 table-mobile-responsive",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(l,{columnKey:"name",className:"show-mobile",children:"Trainee Name"}),a.jsx(l,{columnKey:"email",className:"show-mobile",children:"Email"}),a.jsx(l,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx(l,{columnKey:"enrollmentDate",className:"hide-mobile",children:"Enrollment Date"}),a.jsx(l,{columnKey:"progress",className:"hide-mobile",children:"Progress"}),a.jsx("th",{className:"fw-semibold text-center show-mobile",style:{backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:"Actions"})]})}),a.jsx("tbody",{children:n.map((c,d)=>a.jsx(Yoe,{trainee:c,index:d,onView:r,onEdit:s},c.id))})]})})},Yoe=({trainee:e,index:t,onView:r,onEdit:s})=>{const n=o=>{const l={active:{variant:"success",icon:lt},inactive:{variant:"secondary",icon:it},pending:{variant:"warning",icon:it}},c=l[o]||l.pending,d=c.icon;return a.jsxs(Pe,{bg:c.variant,className:"d-flex align-items-center",children:[a.jsx(d,{size:12,className:"me-1"}),o.toUpperCase()]})},i=o=>[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>r(o),permission:Ne.TRAINEES.VIEW_DETAIL},{label:"Edit Trainee",icon:a.jsx(as,{}),onClick:()=>s(o),permission:Ne.TRAINEES.UPDATE}];return a.jsxs("tr",{className:`${t%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=t%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-1 fw-medium",children:e.name}),a.jsx("small",{className:"text-muted",children:e.department})]})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsx("span",{className:"text-dark",children:e.email})}),a.jsx("td",{className:"align-middle show-mobile",children:n(e.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("div",{className:"text-muted small",children:new Date(e.enrollmentDate).toLocaleDateString()})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("div",{className:"fw-medium",children:[e.progress,"%"]})}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(wr,{permissions:[Ne.TRAINEES.VIEW_DETAIL,Ne.TRAINEES.UPDATE],fallback:null,children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:i(e)})})})]})},Xoe=()=>{const e=Qe(),{courseId:t}=Nr(),[r,s]=b.useState(null),[n,i]=b.useState([]),[o,l]=b.useState([]),[c,d]=b.useState(!0),[u,m]=b.useState("subjects");b.useEffect(()=>{const w={id:t,title:"Software Development Fundamentals",code:"SDF-001",description:"Introduction to software development principles and practices",status:"active",enrolledCount:25,startDate:"2024-01-15T09:00:00Z",department:"IT Department"},y=[{id:1,title:"Programming Basics",code:"PB-001",description:"Introduction to programming concepts",status:"active",enrolledCount:25,duration:40},{id:2,title:"Data Structures",code:"DS-002",description:"Understanding data structures and algorithms",status:"active",enrolledCount:25,duration:60},{id:3,title:"Database Design",code:"DD-003",description:"Database design principles and SQL",status:"pending",enrolledCount:25,duration:50}],S=[{id:1,name:"John Smith",email:"john.smith@company.com",department:"IT Department",status:"active",enrollmentDate:"2024-01-15T09:00:00Z",progress:75},{id:2,name:"Sarah Johnson",email:"sarah.johnson@company.com",department:"IT Department",status:"active",enrollmentDate:"2024-01-15T09:00:00Z",progress:60},{id:3,name:"Mike Wilson",email:"mike.wilson@company.com",department:"IT Department",status:"active",enrollmentDate:"2024-01-16T10:00:00Z",progress:45}];setTimeout(()=>{s(w),i(y),l(S),d(!1)},1e3)},[t]);const f=w=>{e(`/department-head/courses/${t}/subjects/${w.id}`)},h=w=>{console.log("Edit subject:",w)},p=w=>{e(`/department-head/trainees/${w.id}`)},x=w=>{console.log("Edit trainee:",w)},g=[{id:"subjects",title:"Subject List",icon:bt,component:a.jsx(Goe,{subjects:n,loading:c,onView:f,onEdit:h})},{id:"trainees",title:"Trainee List",icon:Ar,component:a.jsx(Koe,{trainees:o,loading:c,onView:p,onEdit:x})}],v=g.find(w=>w.id===u);return c?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading course details..."})]})}):r?a.jsxs(_e,{fluid:!0,className:"py-4 course-details-page",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>e("/department-head/my-department-details"),children:a.jsx(Tt,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:r.title}),a.jsxs("p",{className:"text-muted mb-0",children:[r.code,"  ",r.department]})]})]})})}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0",children:[a.jsx(M.Header,{className:"department-head-section-header bg-primary text-white border-0 p-0",children:a.jsx("div",{className:"custom-tabs-container",children:g.map(w=>{const y=w.icon,S=u===w.id;return a.jsxs("button",{className:`custom-tab ${S?"active":""}`,onClick:()=>m(w.id),children:[a.jsx(y,{size:16,className:"me-2"}),w.title]},w.id)})})}),a.jsx(M.Body,{className:"p-0",children:v&&v.component})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Course Not Found"}),a.jsx("p",{children:"The requested course could not be found."})]})})},Joe=({subjectId:e,courseId:t})=>{const r=Qe(),[s,n]=b.useState([]),[i,o]=b.useState(!0),[l,c]=b.useState(null),[d,u]=b.useState(""),[m,f]=b.useState([]);b.useEffect(()=>{(async()=>{try{o(!0),await new Promise(C=>setTimeout(C,1e3)),n([{id:1,name:"John Doe",email:"john.doe@email.com",employeeId:"TE001",department:"Operations",enrollmentDate:"2024-01-15",status:"completed",progress:100,lastActivity:"2024-01-20",score:95,completionDate:"2024-01-20",attempts:1},{id:2,name:"Jane Smith",email:"jane.smith@email.com",employeeId:"TE002",department:"Maintenance",enrollmentDate:"2024-01-16",status:"completed",progress:100,lastActivity:"2024-01-19",score:87,completionDate:"2024-01-19",attempts:2},{id:3,name:"Mike Johnson",email:"mike.johnson@email.com",employeeId:"TE003",department:"Safety",enrollmentDate:"2024-01-17",status:"in_progress",progress:75,lastActivity:"2024-01-25",score:null,completionDate:null,attempts:1},{id:4,name:"Sarah Wilson",email:"sarah.wilson@email.com",employeeId:"TE004",department:"Quality",enrollmentDate:"2024-01-18",status:"pending",progress:25,lastActivity:"2024-01-22",score:null,completionDate:null,attempts:0},{id:5,name:"David Brown",email:"david.brown@email.com",employeeId:"TE005",department:"Training",enrollmentDate:"2024-01-19",status:"in_progress",progress:60,lastActivity:"2024-01-23",score:null,completionDate:null,attempts:1}])}catch(T){c("Failed to load trainees in subject"),console.error("Error fetching trainees:",T)}finally{o(!1)}})()},[e]);const h=j=>{const C={pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},failed:{variant:"danger",text:"Failed"}}[j]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:C.variant,children:C.text})},p=j=>{r(`/department-head/trainees/${j}`)},x=[...new Set(s.map(j=>j.status))],g=s.filter(j=>{const T=m.length===0||m.includes(j.status),C=j.name.toLowerCase().includes(d.toLowerCase())||j.email.toLowerCase().includes(d.toLowerCase())||j.employeeId.toLowerCase().includes(d.toLowerCase())||j.department.toLowerCase().includes(d.toLowerCase());return T&&C}),v=j=>{f(j==="clear"?[]:T=>T.includes(j)?T.filter(C=>C!==j):[...T,j])},w=()=>{f([]),u("")},{sortedData:y,sortConfig:S,handleSort:E}=Zt(g),N=({columnKey:j,children:T,className:C=""})=>{const A=S.key===j?S.direction:null;return a.jsx("th",{className:`fw-semibold ${C}`,onClick:()=>E(j),style:{cursor:"pointer",backgroundColor:"var(--bs-primary)",color:"white",borderColor:"var(--bs-primary)"},children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{style:{color:"white"},children:T}),a.jsx(ir,{direction:A,className:"ms-1",color:"white"})]})})};return i?a.jsx(Wt,{rows:5,columns:7}):l?a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:l})]}):g.length===0?a.jsx("div",{className:"text-center py-5 p-4",children:a.jsxs("div",{className:"text-muted",children:[a.jsx("h5",{children:"No trainees found"}),a.jsx("p",{children:"Try adjusting your search criteria."})]})}):a.jsxs("div",{className:"p-4",children:[a.jsxs(oe,{className:"mb-3 form-mobile-stack search-filter-section",children:[a.jsx(H,{xs:12,lg:6,md:5,className:"mb-2 mb-lg-0",children:a.jsx(Mr,{placeholder:"Search trainees in this subject...",value:d,onChange:u,className:"search-bar-mobile"})}),a.jsx(H,{xs:12,lg:3,md:4,className:"mb-2 mb-lg-0 position-relative",children:a.jsx(Yn,{uniqueStatuses:x,selectedStatuses:m,onStatusToggle:v,onClearFilters:w,className:"filter-panel-mobile"})}),a.jsx(H,{xs:12,lg:3,md:3,children:a.jsx("div",{className:"text-end text-mobile-center",children:a.jsxs("small",{className:"text-muted",children:[g.length," trainee",g.length!==1?"s":""]})})})]}),a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx(N,{columnKey:"name",className:"show-mobile",children:"Trainee"}),a.jsx(N,{columnKey:"employeeId",className:"hide-mobile",children:"Employee ID"}),a.jsx(N,{columnKey:"department",className:"hide-mobile",children:"Department"}),a.jsx(N,{columnKey:"progress",className:"show-mobile",children:"Progress"}),a.jsx(N,{columnKey:"score",className:"hide-mobile",children:"Score"}),a.jsx(N,{columnKey:"status",className:"show-mobile",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold text-center show-mobile",children:"Actions"})]})}),a.jsx("tbody",{children:y.map((j,T)=>a.jsxs("tr",{className:`${T%2===0?"bg-white":"bg-neutral-50"} transition-all`,style:{transition:"background-color 0.2s ease"},onMouseEnter:C=>{C.currentTarget.style.backgroundColor="var(--bs-neutral-100)"},onMouseLeave:C=>{C.currentTarget.style.backgroundColor=T%2===0?"white":"var(--bs-neutral-50)"},children:[a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx(Lt,{size:18,className:"me-2 text-primary"}),a.jsxs("div",{children:[a.jsx("h6",{className:"mb-0 fw-medium",children:j.name}),a.jsx("small",{className:"text-muted",children:j.email})]})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{className:"text-dark fw-medium",children:j.employeeId})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{children:j.department})}),a.jsx("td",{className:"align-middle show-mobile",children:a.jsxs("div",{children:[a.jsx("div",{className:"d-flex justify-content-between mb-1",children:a.jsxs("span",{className:"fw-medium",children:[j.progress,"%"]})}),a.jsx("div",{className:"progress",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${j.progress}%`}})})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:j.score?a.jsx("span",{className:"fw-bold text-success",children:j.score}):a.jsx("span",{className:"text-muted",children:"-"})}),a.jsx("td",{className:"align-middle show-mobile",children:h(j.status)}),a.jsx("td",{className:"align-middle text-center show-mobile",children:a.jsx(Xt,{align:"end",className:"table-dropdown",placement:"bottom-end",trigger:{variant:"link",className:"btn btn-link p-0 text-primary-custom",style:{border:"none",background:"transparent"},children:a.jsx(qt,{size:16})},items:[{label:"View Details",icon:a.jsx(Nt,{}),onClick:()=>p(j.id)}]})})]},j.id))})]})})]})},Zoe=()=>{const{courseId:e,subjectId:t}=Nr(),r=Qe(),[s,n]=b.useState("trainees"),[i,o]=b.useState(null),[l,c]=b.useState(!0),[d,u]=b.useState(null);b.useEffect(()=>{(async()=>{try{c(!0),await new Promise(g=>setTimeout(g,1e3)),o({id:t,title:"Safety Procedures - Module 1",code:"SP-101",description:"Introduction to aviation safety procedures and protocols. This module covers essential safety protocols, emergency procedures, and compliance requirements for aviation operations.",duration:2,status:"active",instructor:"Dr. Smith",course:"Aviation Safety Management",courseCode:"ASM-101",startDate:"2024-01-15",endDate:"2024-03-15",completionDate:"2024-01-20",progress:100,totalTrainees:25,completedTrainees:20,inProgressTrainees:3,pendingTrainees:2,averageScore:87,materials:[{name:"Safety Manual v2.1",type:"PDF",size:"2.3 MB"},{name:"Video Tutorial",type:"MP4",size:"45 MB"},{name:"Assessment Quiz",type:"Quiz",size:"N/A"}],assessments:[{name:"Safety Procedures Quiz",type:"Quiz",maxScore:100,averageScore:87},{name:"Practical Assessment",type:"Practical",maxScore:100,averageScore:89}]})}catch(x){u("Failed to load subject details"),console.error("Error fetching subject:",x)}finally{c(!1)}})()},[t]);const m=p=>{const g={active:{variant:"success",text:"Active"},pending:{variant:"warning",text:"Pending"},in_progress:{variant:"info",text:"In Progress"},completed:{variant:"success",text:"Completed"},archived:{variant:"secondary",text:"Archived"}}[p]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:g.variant,children:g.text})},f=[{id:"trainees",title:"Trainee List",icon:Lt,component:a.jsx(Joe,{subjectId:t,courseId:e})}],h=f.find(p=>p.id===s);return l?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading subject details..."})]})}):d?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:d})]})}):i?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>r(`/department-head/my-department-details/${e}`),children:a.jsx(Tt,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:i.title}),a.jsxs("p",{className:"text-muted mb-0",children:[i.code,"  ",i.course," (",i.courseCode,")"]})]})]})})}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(it,{size:24,className:"text-primary mb-2"}),a.jsx("h6",{className:"mb-1 text-muted",children:"Duration"}),a.jsxs("h4",{className:"mb-0 text-primary",children:[i.duration," hours"]}),a.jsx("small",{className:"text-muted",children:"Estimated Time"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(Lt,{size:24,className:"text-success mb-2"}),a.jsx("h6",{className:"mb-1 text-muted",children:"Trainees"}),a.jsxs("h4",{className:"mb-0 text-success",children:[i.completedTrainees,"/",i.totalTrainees]}),a.jsx("small",{className:"text-muted",children:"Completed"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"text-info mb-2",children:a.jsx(nr,{size:24})}),a.jsx("h6",{className:"mb-1 text-muted",children:"Average Score"}),a.jsxs("h4",{className:"mb-0 text-info",children:[i.averageScore,"%"]}),a.jsx("small",{className:"text-muted",children:"Performance"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(lt,{size:24,className:"text-warning mb-2"}),a.jsx("h6",{className:"mb-1 text-muted",children:"Status"}),a.jsx("div",{className:"mt-2",children:m(i.status)})]})})})]}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:6,children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Subject Information"})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(bt,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Description:"}),a.jsx("p",{className:"mt-1 mb-0",children:i.description})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Instructor:"})," ",i.instructor]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(pr,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Schedule:"})," ",i.startDate," - ",i.endDate]}),a.jsxs("div",{className:"mb-0",children:[a.jsx(it,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Completion Date:"})," ",i.completionDate||"N/A"]})]})]})}),a.jsx(H,{md:6,children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Enrollment Statistics"})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[a.jsx("span",{children:"Completed"}),a.jsx("span",{className:"fw-bold text-success",children:i.completedTrainees})]}),a.jsx("div",{className:"progress",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-success",role:"progressbar",style:{width:`${i.completedTrainees/i.totalTrainees*100}%`}})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[a.jsx("span",{children:"In Progress"}),a.jsx("span",{className:"fw-bold text-info",children:i.inProgressTrainees})]}),a.jsx("div",{className:"progress",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-info",role:"progressbar",style:{width:`${i.inProgressTrainees/i.totalTrainees*100}%`}})})]}),a.jsxs("div",{className:"mb-0",children:[a.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[a.jsx("span",{children:"Pending"}),a.jsx("span",{className:"fw-bold text-warning",children:i.pendingTrainees})]}),a.jsx("div",{className:"progress",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-warning",role:"progressbar",style:{width:`${i.pendingTrainees/i.totalTrainees*100}%`}})})]})]})]})})]}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Materials"})}),a.jsx(M.Body,{children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Material Name"}),a.jsx("th",{children:"Type"}),a.jsx("th",{children:"Size"})]})}),a.jsx("tbody",{children:i.materials.map((p,x)=>a.jsxs("tr",{children:[a.jsx("td",{className:"fw-medium",children:p.name}),a.jsx("td",{children:a.jsx(Pe,{bg:"secondary",children:p.type})}),a.jsx("td",{className:"text-muted",children:p.size})]},x))})]})})})]})})}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Assessments"})}),a.jsx(M.Body,{children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-hover mb-0",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Assessment"}),a.jsx("th",{children:"Type"}),a.jsx("th",{children:"Max Score"}),a.jsx("th",{children:"Average Score"})]})}),a.jsx("tbody",{children:i.assessments.map((p,x)=>a.jsxs("tr",{children:[a.jsx("td",{className:"fw-medium",children:p.name}),a.jsx("td",{children:a.jsx(Pe,{bg:"info",children:p.type})}),a.jsx("td",{children:p.maxScore}),a.jsx("td",{children:a.jsx("span",{className:"fw-bold text-success",children:p.averageScore})})]},x))})]})})})]})})}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white p-0",children:a.jsx("div",{className:"custom-tabs-container",children:f.map(p=>{const x=p.icon,g=s===p.id;return a.jsxs("button",{className:`custom-tab ${g?"active":""}`,onClick:()=>n(p.id),children:[a.jsx(x,{size:16,className:"me-2"}),p.title]},p.id)})})}),a.jsx(M.Body,{className:"p-0",children:h&&h.component})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Subject Not Found"}),a.jsx("p",{children:"The requested subject could not be found."})]})})},Qoe=()=>{const{traineeId:e}=Nr(),t=Qe(),[r,s]=b.useState(null),[n,i]=b.useState(!0),[o,l]=b.useState(null);b.useEffect(()=>{(async()=>{try{i(!0),await new Promise(m=>setTimeout(m,1e3)),s({id:e,name:"John Doe",email:"john.doe@email.com",employeeId:"TE001",department:"Operations",position:"Operations Manager",phone:"+1-555-0123",enrollmentDate:"2024-01-15",status:"active",lastActivity:"2024-01-20",completedCourses:3,totalCourses:5,completedSubjects:12,totalSubjects:20,averageScore:85,overallProgress:65,enrolledCourses:[{id:1,name:"Aviation Safety Management",code:"ASM-101",progress:75,instructor:"Dr. Smith",enrolledDate:"2024-01-15",status:"in_progress",completedSubjects:6,totalSubjects:8},{id:2,name:"Aircraft Maintenance",code:"AM-201",progress:45,instructor:"Jane Doe",enrolledDate:"2024-01-16",status:"in_progress",completedSubjects:4,totalSubjects:9},{id:3,name:"Emergency Response Training",code:"ERT-301",progress:100,instructor:"Mike Johnson",enrolledDate:"2024-01-10",status:"completed",completedSubjects:10,totalSubjects:10}],assessments:[{id:1,name:"Safety Procedures Quiz",course:"Aviation Safety Management",score:95,maxScore:100,status:"approved",completedDate:"2024-01-20",submittedBy:"Dr. Smith"},{id:2,name:"Maintenance Practical Assessment",course:"Aircraft Maintenance",score:87,maxScore:100,status:"approved",completedDate:"2024-01-19",submittedBy:"Jane Doe"},{id:3,name:"Emergency Procedures Test",course:"Emergency Response Training",score:92,maxScore:100,status:"pending",completedDate:"2024-01-25",submittedBy:"Mike Johnson"}],certifications:[{name:"Aviation Safety Management",date:"2024-01-20",status:"completed",issuedBy:"Training Department"},{name:"Risk Assessment",date:"2024-01-25",status:"completed",issuedBy:"Quality Department"},{name:"Emergency Response",date:"2024-02-01",status:"in_progress",issuedBy:"Training Department"}]})}catch(u){l("Failed to load trainee details"),console.error("Error fetching trainee:",u)}finally{i(!1)}})()},[e]);const c=d=>{const m={active:{variant:"success",text:"Active"},completed:{variant:"primary",text:"Completed"},in_progress:{variant:"info",text:"In Progress"},inactive:{variant:"warning",text:"Inactive"},suspended:{variant:"danger",text:"Suspended"},approved:{variant:"success",text:"Approved"},pending:{variant:"warning",text:"Pending"},rejected:{variant:"danger",text:"Rejected"}}[d]||{variant:"secondary",text:"Unknown"};return a.jsx(Pe,{bg:m.variant,children:m.text})};return n?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs("div",{className:"text-center py-5",children:[a.jsx(Pt,{animation:"border",variant:"primary"}),a.jsx("p",{className:"mt-3 text-muted",children:"Loading trainee details..."})]})}):o?a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"danger",children:[a.jsx(Re.Heading,{children:"Error"}),a.jsx("p",{children:o})]})}):r?a.jsxs(_e,{fluid:!0,className:"py-4",children:[a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("button",{className:"btn btn-link p-0 me-3",onClick:()=>t(-1),children:a.jsx(Tt,{size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"mb-1",children:r.name}),a.jsxs("p",{className:"text-muted mb-0",children:[r.employeeId,"  ",r.department]})]})]})})}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(Lt,{size:24,className:"text-primary mb-2"}),a.jsx("h6",{className:"mb-1 text-muted",children:"Status"}),a.jsx("div",{className:"mt-2",children:c(r.status)})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(bt,{size:24,className:"text-success mb-2"}),a.jsx("h6",{className:"mb-1 text-muted",children:"Courses"}),a.jsxs("h4",{className:"mb-0 text-success",children:[r.completedCourses,"/",r.totalCourses]}),a.jsx("small",{className:"text-muted",children:"Completed"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx("div",{className:"text-info mb-2",children:a.jsx(nx,{size:24})}),a.jsx("h6",{className:"mb-1 text-muted",children:"Average Score"}),a.jsxs("h4",{className:"mb-0 text-info",children:[r.averageScore,"%"]}),a.jsx("small",{className:"text-muted",children:"Performance"})]})})}),a.jsx(H,{md:3,className:"mb-3",children:a.jsx(M,{className:"h-100 border-0 shadow-sm",children:a.jsxs(M.Body,{className:"text-center",children:[a.jsx(pr,{size:24,className:"text-warning mb-2"}),a.jsx("h6",{className:"mb-1 text-muted",children:"Enrolled"}),a.jsx("h4",{className:"mb-0 text-warning",children:new Date(r.enrollmentDate).toLocaleDateString()}),a.jsx("small",{className:"text-muted",children:"Start Date"})]})})})]}),a.jsxs(oe,{className:"mb-4",children:[a.jsx(H,{md:6,children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Contact Information"})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(wi,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Email:"})," ",r.email]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(Lt,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Position:"})," ",r.position]}),a.jsxs("div",{className:"mb-3",children:[a.jsx(pr,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Last Activity:"})," ",new Date(r.lastActivity).toLocaleDateString()]}),a.jsxs("div",{className:"mb-0",children:[a.jsx(it,{size:16,className:"me-2 text-muted"}),a.jsx("strong",{children:"Overall Progress:"})," ",r.overallProgress,"%"]})]})]})}),a.jsx(H,{md:6,children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Progress Overview"})}),a.jsxs(M.Body,{children:[a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[a.jsx("span",{children:"Courses Progress"}),a.jsxs("span",{className:"fw-bold",children:[r.completedCourses,"/",r.totalCourses]})]}),a.jsx("div",{className:"progress",style:{height:"10px"},children:a.jsx("div",{className:"progress-bar bg-success",role:"progressbar",style:{width:`${r.completedCourses/r.totalCourses*100}%`}})})]}),a.jsxs("div",{className:"mb-0",children:[a.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[a.jsx("span",{children:"Subjects Progress"}),a.jsxs("span",{className:"fw-bold",children:[r.completedSubjects,"/",r.totalSubjects]})]}),a.jsx("div",{className:"progress",style:{height:"10px"},children:a.jsx("div",{className:"progress-bar bg-info",role:"progressbar",style:{width:`${r.completedSubjects/r.totalSubjects*100}%`}})})]})]})]})})]}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Enrolled Courses"})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Course"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Code"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Progress"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Subjects"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"})]})}),a.jsx("tbody",{children:r.enrolledCourses.map((d,u)=>a.jsxs("tr",{className:`${u%2===0?"bg-white":"bg-neutral-50"}`,children:[a.jsx("td",{className:"align-middle",children:a.jsxs("div",{children:[a.jsx("h6",{className:"mb-0 fw-medium",children:d.name}),a.jsxs("small",{className:"text-muted",children:["Instructor: ",d.instructor]})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx(Pe,{bg:"secondary",children:d.code})}),a.jsx("td",{className:"align-middle",children:a.jsxs("div",{children:[a.jsx("div",{className:"d-flex justify-content-between mb-1",children:a.jsxs("span",{className:"fw-medium",children:[d.progress,"%"]})}),a.jsx("div",{className:"progress",style:{height:"6px"},children:a.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${d.progress}%`}})})]})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsxs("span",{children:[d.completedSubjects,"/",d.totalSubjects]})}),a.jsx("td",{className:"align-middle",children:c(d.status)})]},d.id))})]})})})]})})}),a.jsx(oe,{className:"mb-4",children:a.jsx(H,{children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Assessment History"})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Assessment"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Course"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Score"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Submitted By"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Completed Date"})]})}),a.jsx("tbody",{children:r.assessments.map((d,u)=>a.jsxs("tr",{className:`${u%2===0?"bg-white":"bg-neutral-50"}`,children:[a.jsx("td",{className:"align-middle",children:a.jsx("div",{children:a.jsx("h6",{className:"mb-0 fw-medium",children:d.name})})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{children:d.course})}),a.jsx("td",{className:"align-middle",children:d.score?a.jsxs("span",{className:"fw-bold text-success",children:[d.score,"/",d.maxScore]}):a.jsx("span",{className:"text-muted",children:"-"})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{className:"text-muted",children:d.submittedBy})}),a.jsx("td",{className:"align-middle",children:c(d.status)}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{children:new Date(d.completedDate).toLocaleDateString()})})]},d.id))})]})})})]})})}),a.jsx(oe,{children:a.jsx(H,{children:a.jsxs(M,{className:"border-0 shadow-sm",children:[a.jsx(M.Header,{className:"bg-primary text-white",children:a.jsx("h5",{className:"mb-0",children:"Certifications"})}),a.jsx(M.Body,{className:"p-0",children:a.jsx("div",{className:"scrollable-table-container admin-table",children:a.jsxs(It,{hover:!0,className:"mb-0 table-mobile-responsive sticky-header border-neutral-200 align-middle",style:{fontSize:"0.875rem"},children:[a.jsx("thead",{className:"sticky-header",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Certification"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Date"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold hide-mobile",children:"Issued By"}),a.jsx("th",{className:"border-neutral-200 text-primary-custom fw-semibold",children:"Status"})]})}),a.jsx("tbody",{children:r.certifications.map((d,u)=>a.jsxs("tr",{className:`${u%2===0?"bg-white":"bg-neutral-50"}`,children:[a.jsx("td",{className:"align-middle",children:a.jsx("div",{children:a.jsx("h6",{className:"mb-0 fw-medium",children:d.name})})}),a.jsx("td",{className:"align-middle",children:a.jsx("span",{children:new Date(d.date).toLocaleDateString()})}),a.jsx("td",{className:"align-middle hide-mobile",children:a.jsx("span",{className:"text-muted",children:d.issuedBy})}),a.jsx("td",{className:"align-middle",children:c(d.status)})]},u))})]})})})]})})})]}):a.jsx(_e,{fluid:!0,className:"py-4",children:a.jsxs(Re,{variant:"warning",children:[a.jsx(Re.Heading,{children:"Trainee Not Found"}),a.jsx("p",{children:"The requested trainee could not be found."})]})})},ele=Gk([{path:"/",element:a.jsx(_m,{}),errorElement:a.jsx(Na,{})},{path:"/login",element:a.jsx(_m,{}),errorElement:a.jsx(Na,{})},{path:"/reset-password",element:a.jsx(hI,{}),errorElement:a.jsx(Na,{})},{path:"/profile",element:a.jsx(Qn,{children:a.jsx(Zn,{})}),errorElement:a.jsx(Na,{}),children:[{path:"",element:a.jsx(mt,{permission:Ne.PROFILES.VIEW,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access your profile."}),children:a.jsx(qU,{})})}]},{path:"/admin",element:a.jsx(Qn,{children:a.jsx(Zn,{})}),errorElement:a.jsx(Na,{}),children:[{path:"",element:a.jsx(Jo,{})},{path:"main-menu",element:a.jsx(mt,{permission:null,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access main menu."}),children:a.jsx(doe,{})})},{path:"users",element:a.jsx(mt,{permission:Ne.USERS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access user management."}),children:a.jsx(NU,{})})},{path:"roles",element:a.jsx(mt,{permission:Ne.ROLES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access role management."}),children:a.jsx(kU,{})})},{path:"departments",element:a.jsx(mt,{permission:Ne.DEPARTMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department management."}),children:a.jsx(LU,{})})},{path:"departments/:id",element:a.jsx(mt,{permission:Ne.DEPARTMENTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view department details."}),children:a.jsx(WU,{})})},{path:"forms",element:a.jsx(mt,{permission:Ne.TEMPLATES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access form templates."}),children:a.jsx(roe,{})})},{path:"forms/editor",element:a.jsx(mt,{permission:Ne.TEMPLATES.CREATE,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to edit form templates."}),children:a.jsx(coe,{})})},{path:"system-config",element:a.jsx(mt,{permission:Ne.GLOBAL_FIELDS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access system configuration."}),children:a.jsx("div",{children:"System Configuration Page"})})}]},{path:"/academic",element:a.jsx(Qn,{children:a.jsx(Zn,{})}),errorElement:a.jsx(Na,{}),children:[{path:"",element:a.jsx(Jo,{})},{path:"dashboard",element:a.jsx(rie,{})},{path:"departments",element:a.jsx(KU,{})},{path:"course/:courseId",element:a.jsx(cie,{})},{path:"course-detail/:courseId",element:a.jsx(_ie,{})},{path:"course/:courseId/enroll-trainees",element:a.jsx(Iie,{})},{path:"subject/:subjectId",element:a.jsx(D2,{})},{path:"course/:courseId/subject/:subjectId",element:a.jsx(D2,{})}]},{path:"/trainee",element:a.jsx(Qn,{children:a.jsx(Zn,{})}),errorElement:a.jsx(Na,{}),children:[{path:"",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee portal."}),children:a.jsx(R2,{})})},{path:"dashboard",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainee dashboard."}),children:a.jsx(R2,{})})},{path:":traineeId/course/:courseId",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_COURSES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee courses."}),children:a.jsx(Mie,{})})},{path:":traineeId/course/:courseId/subject/:subjectId",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_SUBJECTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee subjects."}),children:a.jsx($ie,{})})},{path:":traineeId/assessments",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee assessments."}),children:a.jsx(Uie,{})})},{path:":traineeId/assessment/:assessmentId",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment details."}),children:a.jsx(Wie,{})})},{path:":traineeId/signature-pad/:documentId",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access signature pad."}),children:a.jsx(Vie,{})})},{path:":traineeId/assessment-section/:sectionId",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment sections."}),children:a.jsx(qie,{})})},{path:"academic-details",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view academic details."}),children:a.jsx(Xie,{})})},{path:"enrolled-courses",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_COURSES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view enrolled courses."}),children:a.jsx(Qie,{})})},{path:"signature-required",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view signature required list."}),children:a.jsx(foe,{})})},{path:"completion-required",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:a.jsx(L2,{})})},{path:"your-assessments",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view your assessments."}),children:a.jsx(M2,{})})},{path:"create-incident-feedback-report",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to create incident/feedback reports."}),children:a.jsx(yoe,{})})},{path:"assessment-pending",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment pending list."}),children:a.jsx(M2,{})})},{path:"assessment-pending/section-completion",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_ASSESSMENTS,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view section completion list."}),children:a.jsx(L2,{})})}]},{path:"/sqa",element:a.jsx(Qn,{children:a.jsx(Zn,{})}),errorElement:a.jsx(Na,{}),children:[{path:"",element:a.jsx(Jo,{})},{path:"issues",element:a.jsx(mt,{permission:Ne.SQA.VIEW_TEMPLATES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access issue list."}),children:a.jsx(woe,{})})},{path:"feedback",element:a.jsx(mt,{permission:Ne.SQA.VIEW_TEMPLATES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access feedback list."}),children:a.jsx(joe,{})})},{path:"templates",element:a.jsx(mt,{permission:Ne.SQA.VIEW_TEMPLATES,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template list."}),children:a.jsx(Noe,{})})},{path:"templates/:templateId",element:a.jsx(mt,{permission:Ne.SQA.VIEW_TEMPLATE_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access template details."}),children:a.jsx(Soe,{})})}]},{path:"/trainer",element:a.jsx(Qn,{children:a.jsx(Zn,{})}),errorElement:a.jsx(Na,{}),children:[{path:"",element:a.jsx(Jo,{})},{path:"dashboard",element:a.jsx(mt,{permission:Ne.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access trainer portal."}),children:a.jsx(Eoe,{})})},{path:"upcoming-assessments",element:a.jsx(mt,{permission:Ne.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view upcoming assessments."}),children:a.jsx(Coe,{})})},{path:"assessment-results",element:a.jsx(mt,{permission:Ne.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment results."}),children:a.jsx(koe,{})})},{path:"instructed-courses",element:a.jsx(mt,{permission:Ne.COURSES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view instructed courses."}),children:a.jsx(Ooe,{})})},{path:"configure-signature",element:a.jsx(mt,{permission:Ne.PROFILES.VIEW,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to configure signature."}),children:a.jsx(Boe,{})})},{path:"assessment-details/:resultId",element:a.jsx(mt,{permission:Ne.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment details."}),children:a.jsx($oe,{})})},{path:"approval-notes/:resultId",element:a.jsx(mt,{permission:Ne.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view approval notes."}),children:a.jsx(zoe,{})})},{path:"courses/:courseId",element:a.jsx(mt,{permission:Ne.COURSES.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:a.jsx(Roe,{})})},{path:"trainees/:traineeId",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:a.jsx(Foe,{})})},{path:"subjects/:subjectId",element:a.jsx(mt,{permission:Ne.SUBJECTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:a.jsx(Moe,{})})}]},{path:"/department-head",element:a.jsx(Qn,{children:a.jsx(Zn,{})}),errorElement:a.jsx(Na,{}),children:[{path:"",element:a.jsx(Jo,{})},{path:"dashboard",element:a.jsx(mt,{permission:Ne.DASHBOARD.VIEW,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department head dashboard."}),children:a.jsx(Uoe,{})})},{path:"my-department-details",element:a.jsx(mt,{permission:Ne.DEPARTMENTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access department details."}),children:a.jsx(Hoe,{})})},{path:"my-department-details/:courseId",element:a.jsx(mt,{permission:Ne.COURSES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view course details."}),children:a.jsx(Xoe,{})})},{path:"assessment-review-requests",element:a.jsx(mt,{permission:Ne.ASSESSMENTS.VIEW_ALL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to access assessment review requests."}),children:a.jsx(B2,{})})},{path:"assessment-review-requests/:requestId",element:a.jsx(mt,{permission:Ne.ASSESSMENTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view assessment request details."}),children:a.jsx(B2,{})})},{path:"courses/:courseId/subjects/:subjectId",element:a.jsx(mt,{permission:Ne.SUBJECTS.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view subject details."}),children:a.jsx(Zoe,{})})},{path:"trainees/:traineeId",element:a.jsx(mt,{permission:Ne.TRAINEES.VIEW_DETAIL,fallback:a.jsx("div",{className:"p-4 text-center text-muted",children:"You don't have permission to view trainee details."}),children:a.jsx(Qoe,{})})}]},{path:"*",element:a.jsx(_m,{}),errorElement:a.jsx(Na,{})}],{basename:hx()});function tle(){return b.useEffect(()=>{(()=>{const t=window.location;if(t.hostname.includes("github.io")&&t.search.includes("?/")){const r=t.search,s=t.hash,n=r.match(/\?\/(.+?)(?:&|$)/);if(n){const o=`/${n[1].replace(/~and~/g,"&")}${s}`;window.history.replaceState(null,"",o)}}})()},[]),a.jsxs(mI,{children:[a.jsx(qk,{router:ele}),a.jsx(oI,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}Xk.createRoot(document.getElementById("root")).render(a.jsx(b.StrictMode,{children:a.jsx(tle,{})}));
